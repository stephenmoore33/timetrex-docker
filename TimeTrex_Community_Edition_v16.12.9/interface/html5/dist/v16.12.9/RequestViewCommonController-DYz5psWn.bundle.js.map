{"version":3,"file":"RequestViewCommonController-DYz5psWn.bundle.js","sources":["../../views/common/RequestViewCommonController.js"],"sourcesContent":["import { Global } from '@/global/Global';\n\nexport class RequestViewCommonController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tauthorization_history: null,\n\t\t\tselected_absence_policy_record: null,\n\t\t\tenable_edit_view_ui: false\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tsetGridCellBackGround() {\n\t\t//Error: Unable to get property 'getGridParam' of undefined or null reference\n\t\tif ( !this.grid ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar data = this.grid.getGridParam( 'data' );\n\t\t//Error: TypeError: data is undefined in /interface/html5/framework/jquery.min.js?v=7.4.6-20141027-074127 line 2 > eval line 70\n\t\tif ( !data ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar len = data.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar item = data[i];\n\n\t\t\tif ( item.status_id == 30 ) {\n\t\t\t\t$( 'tr#' + item.id ).addClass( 'bolder-request' );\n\t\t\t}\n\t\t}\n\t}\n\n\tonCancelClick( force, cancel_all, callback ) {\n\t\tTTPromise.add( 'base', 'onCancelClick' );\n\t\tvar $this = this;\n\n\t\t//#2571 - Unable to get property 'id' of undefined or null reference\n\t\tif ( this.current_edit_record && this.current_edit_record.id ) {\n\t\t\tvar $record_id = this.current_edit_record.id;\n\t\t}\n\n\t\tLocalCacheData.current_doing_context_action = 'cancel';\n\t\tif ( this.is_changed && !force ) {\n\t\t\tTAlertManager.showConfirmAlert( Global.modify_alert_message, null, function( flag ) {\n\n\t\t\t\tif ( flag === true ) {\n\t\t\t\t\tdoNext();\n\t\t\t\t}\n\n\t\t\t} );\n\t\t} else {\n\t\t\tdoNext();\n\t\t}\n\n\t\tfunction doNext() {\n\t\t\tif ( !$this.edit_view && $this.parent_view_controller && $this.sub_view_mode ) {\n\t\t\t\t$this.parent_view_controller.is_changed = false;\n\t\t\t\t$this.parent_view_controller.buildContextMenu( true );\n\t\t\t\t$this.parent_view_controller.onCancelClick();\n\n\t\t\t} else {\n\t\t\t\tif ( $this.is_edit && $record_id ) {\n\t\t\t\t\tContextMenuManager.unmountContextMenu( $this.determineContextMenuMountAttributes().id );\n\t\t\t\t\t$this.setCurrentEditViewState( 'view' );\n\t\t\t\t\t$this.onViewClick( $record_id, true );\n\t\t\t\t\t$this.setEditMenu();\n\t\t\t\t} else {\n\t\t\t\t\t$this.removeEditView();\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tif ( callback ) {\n\t\t\t\tcallback();\n\t\t\t}\n\n\t\t\t$this.search( false ); //Refresh the grid, as we don't do that during authorize/decline clicks anymore.\n\n\t\t\tGlobal.setUIInitComplete();\n\t\t\tProgressBar.closeOverlay();\n\n\t\t\tTTPromise.resolve( 'base', 'onCancelClick' );\n\n\t\t}\n\n\t}\n\n\toverlappingShiftUIValidate() {\n\t\t//Same permissions as APISchedule->getOverlappingShifts()\n\t\tif ( !PermissionManager.validate( 'schedule', 'enabled' )\n\t\t\t|| !( PermissionManager.validate( 'schedule', 'view' ) || PermissionManager.validate( 'schedule', 'view_own' ) || PermissionManager.validate( 'schedule', 'view_child' ) ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tonCloseIconClick() {\n\t\tthis.onCancelClick();\n\t}\n\n\tbuildDataForAPI( data ) {\n\t\tvar afn = this.getAdvancedFieldNames();\n\n\t\tif ( this.viewId == 'RequestAuthorization' && ( !TTUUID.isUUID( data.request_schedule_id ) || data.request_schedule_id == TTUUID.zero_id ) ) {\n\t\t\t//Make sure we clear any advanced request fields so data from previous records doesn't mistakenly get carried over.\n\t\t\tafn.forEach( key => {\n\t\t\t\tif ( data.hasOwnProperty( key ) ) {\n\t\t\t\t\tdelete data[key];\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\treturn data;\n\t\t}\n\n\t\tvar user_id = LocalCacheData.loginUser.id;\n\t\tif ( Global.isSet( this.current_edit_record.user_id ) ) {\n\t\t\tuser_id = this.current_edit_record.user_id;\n\t\t}\n\t\tvar data_for_api = { 'user_id': user_id };\n\t\tvar request_schedule = {};\n\n\t\tvar request_schedule_keys = '';\n\n\t\tfor ( var key in this.current_edit_record ) {\n\t\t\tif ( key == 'start_date' && this.edit_view_ui_dic[key] ) {\n\t\t\t\tdata_for_api.date_stamp = this.edit_view_ui_dic[key].getValue();\n\t\t\t}\n\n\t\t\tif ( afn.indexOf( key ) > -1 ) {\n\t\t\t\tif ( key == 'request_schedule_id' ) {\n\t\t\t\t\trequest_schedule['id'] = this.current_edit_record.request_schedule_id;\n\t\t\t\t} else if ( key == 'request_schedule_status_id' ) {\n\t\t\t\t\t//this case is for when asking for default data\n\t\t\t\t\trequest_schedule['status_id'] = this.edit_view_ui_dic.request_schedule_status_id.getValue();\n\t\t\t\t} else if ( this.edit_view_ui_dic[key] ) {\n\t\t\t\t\trequest_schedule[key] = this.edit_view_ui_dic[key].getValue();\n\t\t\t\t}\n\t\t\t} else if ( key == 'available_balance' || key == 'job_item_quick_search' || key == 'job_quick_search' ) {\n\t\t\t\t//ignore. these fields do not need to be saved and break the insert sql.\n\t\t\t} else {\n\t\t\t\tdata_for_api[key] = this.current_edit_record[key];\n\t\t\t}\n\t\t}\n\n\t\t//There is a case where a regular employee has access to submit advanced requests, but the supervisor does not.\n\t\t// In that case we still need to allow advanced requests for authorization.\n\t\tif ( Global.getProductEdition() >= 15 && ( PermissionManager.validate( 'request', 'add_advanced' ) || Global.isEmpty( request_schedule ) == false ) && ( this.current_edit_record.type_id == 30 || this.current_edit_record.type_id == 40 ) ) {\n\t\t\tdata_for_api.request_schedule = request_schedule;\n\t\t}\n\t\treturn data_for_api;\n\t}\n\n\tbuildDataFromAPI( data ) {\n\t\tif ( Global.isSet( data ) && Global.isSet( data.request_schedule ) ) {\n\t\t\tfor ( var key in data.request_schedule ) {\n\t\t\t\tif ( key == 'id' ) {\n\t\t\t\t\tdata['request_schedule_id'] = data.request_schedule.id;\n\t\t\t\t} else if ( key == 'status_id' ) {\n\t\t\t\t\tdata['request_schedule_status_id'] = data.request_schedule.status_id;\n\t\t\t\t} else if ( typeof ( data[key] ) == 'undefined' ) {\n\t\t\t\t\tdata[key] = data.request_schedule[key];\n\t\t\t\t} else {\n\t\t\t\t\t//Debug.Text('Not overwriting: '+key+' request_schedule: '+data.request_schedule[key]+' request: '+data[key], 'RequestViewCommonController.js', 'RequestViewCommonController','buildDataFromAPI' ,10)\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tdelete data.request_schedule;\n\t\t\tthis.pre_request_schedule = false; //is this a request from before request schedule was added? we need to know if this is an \"old version\" request\n\t\t} else {\n\t\t\tthis.pre_request_schedule = true;\n\t\t}\n\n\t\t//var retval = $.extend( this.current_edit_record, data ); //current_edit_record can only be data from the previous record at this point when switching between records. Why do we want to append new data to it rather than replace it entirely? We need to keep separation from records.\n\t\tvar retval = data;\n\n\t\treturn retval;\n\t}\n\n\tshowAdvancedFields( update_schedule_total_time ) {\n\t\tif (\n\t\t\tGlobal.getProductEdition() >= 15 &&\n\t\t\t( PermissionManager.validate( 'request', 'add_advanced' )\n\t\t\t\t|| ( TTUUID.isUUID( this.current_edit_record.request_schedule_id ) && this.current_edit_record.request_schedule_id != TTUUID.zero_id && this.current_edit_record.request_schedule_id != TTUUID.not_exist_id ) )\n\t\t\t&& ( this.current_edit_record.type_id == 30 || this.current_edit_record.type_id == 40 ) && ( !this.pre_request_schedule || this.is_add )\n\t\t) {\n\t\t\tvar advanced_field_names = this.getAdvancedFieldNames();\n\t\t\tif ( this.edit_view_ui_dic ) {\n\t\t\t\tfor ( var i = 0; i < advanced_field_names.length; i++ ) {\n\t\t\t\t\tif ( advanced_field_names[i] == 'absence_policy_id' && this.edit_view_ui_dic.request_schedule_status_id && this.edit_view_ui_dic.request_schedule_status_id.getValue() != 20 ) {\n\t\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif ( this.edit_view_ui_dic[advanced_field_names[i]] ) {\n\t\t\t\t\t\tif ( advanced_field_names[i] == 'branch_id' && !this.show_branch_ui ) {\n\t\t\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\t} else if ( advanced_field_names[i] == 'department_id' && !this.show_department_ui ) {\n\t\t\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\t} else if ( advanced_field_names[i] == 'job_id' && !this.show_job_ui ) {\n\t\t\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\t} else if ( advanced_field_names[i] == 'job_item_id' && !this.show_job_item_ui ) {\n\t\t\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\t} else if ( advanced_field_names[i] == 'punch_tag_id' && !this.show_punch_tag_ui ) {\n\t\t\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\t} else if ( advanced_field_names[i] == 'available_balance' && !this.is_viewing ) {\n\t\t\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).show();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( this.edit_view_ui_dic.date ) {\n\t\t\t\t\tthis.edit_view_ui_dic.date_stamp.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t}\n\n\t\t\t\tif ( this.edit_view_ui_dic.available_balance ) {\n\t\t\t\t\tif ( this.is_viewing == true && this.viewId == 'Request' ) {\n\t\t\t\t\t\tthis.edit_view_ui_dic.available_balance.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( this.current_edit_record.type_id != 30 && this.current_edit_record.type_id != 40 ) {\n\t\t\t\t\tif ( this.edit_view_ui_dic.total_time ) {\n\t\t\t\t\t\tthis.edit_view_ui_dic.total_time.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\tthis.edit_view_ui_dic.overlap_type_id.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\tthis.edit_view_ui_dic.is_replace_with_open_shift.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ( update_schedule_total_time != false ) {\n\t\t\t\t\t\tthis.getScheduleTotalTime();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif ( this.edit_view_ui_dic.date_stamp ) {\n\t\t\t\tthis.edit_view_ui_dic.date_stamp.parents( '.edit-view-form-item-div' ).show();\n\t\t\t}\n\t\t\tthis.hideAdvancedFields();\n\t\t}\n\t}\n\n\thideAdvancedFields() {\n\t\tvar advanced_field_names = this.getAdvancedFieldNames();\n\t\tif ( this.edit_view_ui_dic ) {\n\t\t\tif ( this.edit_view_ui_dic.request_schedule_status_id ) {\n\t\t\t\tthis.edit_view_ui_dic.request_schedule_status_id.setValue( 10 ); //Force to 10=Working, so the absence policy field doesn't appear. Important for request authorization when switching from a advanced request to a basic request.\n\t\t\t}\n\n\t\t\tfor ( var i = 0; i < advanced_field_names.length; i++ ) {\n\t\t\t\tif ( this.edit_view_ui_dic[advanced_field_names[i]] ) {\n\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( this.edit_view_ui_dic.date ) {\n\t\t\t\tthis.edit_view_ui_dic.date.parents( '.edit-view-form-item-div' ).show();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAdvancedFieldNames() {\n\t\treturn [\n\t\t\t'request_id',\n\t\t\t'request_schedule_status_id',\n\t\t\t'request_schedule_id',\n\t\t\t'start_date',\n\t\t\t'end_date',\n\n\t\t\t'sun',\n\t\t\t'mon',\n\t\t\t'tue',\n\t\t\t'wed',\n\t\t\t'thu',\n\t\t\t'fri',\n\t\t\t'sat',\n\n\t\t\t'start_time',\n\t\t\t'end_time',\n\t\t\t'total_time',\n\n\t\t\t'schedule_policy_id',\n\t\t\t'absence_policy_id',\n\t\t\t'branch_id',\n\t\t\t'department_id',\n\t\t\t'job_id',\n\t\t\t'job_item_id',\n\t\t\t'punch_tag_id',\n\n\t\t\t'schedule_policy',\n\t\t\t'absence_policy',\n\t\t\t'branch',\n\t\t\t'department',\n\t\t\t'job',\n\t\t\t'job_item',\n\t\t\t'available_balance',\n\n\t\t\t'overlap_type_id',\n\t\t\t'is_replace_with_open_shift'\n\t\t];\n\t}\n\n\tgetScheduleTotalTime() {\n\t\tif ( Global.getProductEdition() >= 15\n\t\t\t&& ( this.current_edit_record.type_id == 30 || this.current_edit_record.type_id == 40 )\n\t\t\t&& ( this.edit_view_ui_dic && this.edit_view_ui_dic['total_time'] )\n\t\t) {\n\n\t\t\tvar start_time = false;\n\t\t\tif ( this.current_edit_record['start_date'] && this.current_edit_record['start_time'] ) {\n\t\t\t\tstart_time = this.current_edit_record['start_date'] + ' ' + this.current_edit_record['start_time'];\n\t\t\t}\n\n\t\t\tvar end_time = false;\n\t\t\tif ( this.current_edit_record['start_date'] && this.current_edit_record['end_time'] ) {\n\t\t\t\tend_time = this.current_edit_record['start_date'] + ' ' + this.current_edit_record['end_time'];\n\t\t\t}\n\n\t\t\tvar schedulePolicyId = ( this.current_edit_record['schedule_policy_id'] ) ? this.current_edit_record['schedule_policy_id'] : null;\n\t\t\tvar user_id = this.current_edit_record.user_id;\n\n\t\t\tif ( typeof user_id == 'undefined' && LocalCacheData.getLoginUser().id ) {\n\t\t\t\tuser_id = LocalCacheData.getLoginUser().id;\n\t\t\t}\n\n\t\t\tif ( start_time && end_time ) {\n\t\t\t\tvar schedule_api = TTAPI.APISchedule;\n\t\t\t\tvar result = schedule_api.getScheduleTotalTime( start_time, end_time, schedulePolicyId, user_id, { async: false } );\n\t\t\t\tif ( result && result.isValid() && result.getResult() ) {\n\t\t\t\t\tthis.total_time = result.getResult();\n\t\t\t\t} else {\n\t\t\t\t\tthis.total_time = 0;\n\t\t\t\t}\n\n\t\t\t\tvar days = 1;\n\t\t\t\tif ( this.current_edit_record.start_date != this.current_edit_record.end_date ) {\n\t\t\t\t\tdays = Global.getDaysInSpan( this.current_edit_record.start_date, this.current_edit_record.end_date, this.current_edit_record.sun, this.current_edit_record.mon, this.current_edit_record.tue, this.current_edit_record.wed, this.current_edit_record.thu, this.current_edit_record.fri, this.current_edit_record.sat );\n\t\t\t\t}\n\n\t\t\t\tvar overall_total_time = this.total_time * days;\n\t\t\t\t$('#total_info').text( $.i18n._( 'x %s Day(s) = %s', days, Global.getTimeUnit( overall_total_time ) ) );\n\n\t\t\t\tthis.current_edit_record['total_time'] = this.total_time;\n\t\t\t\tvar total_time = Global.getTimeUnit( this.total_time );\n\t\t\t\tthis.edit_view_ui_dic['total_time'].setValue( total_time );\n\t\t\t\tthis.edit_view_ui_dic.total_time.parents( '.edit-view-form-item-div' ).show();\n\t\t\t} else {\n\t\t\t\tif ( this.edit_view_ui_dic.total_time ) {\n\t\t\t\t\tthis.edit_view_ui_dic.total_time.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif ( this.edit_view_ui_dic.total_time ) {\n\t\t\t\tthis.edit_view_ui_dic.total_time.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t}\n\t\t}\n\n\t\tthis.onAvailableBalanceChange();\n\t}\n\n\tonWorkingStatusChanged() {\n\t\tif ( Global.getProductEdition() >= 15 ) {\n\t\t\tthis.showAbsencePolicyField();\n\t\t\tthis.showCreateOpenShift();\n\t\t}\n\t}\n\n\tshowCreateOpenShift() {\n\t\tif ( PermissionManager.checkTopLevelPermission( 'RequestAuthorization' ) && this.current_edit_record && this.current_edit_record.request_schedule_status_id == 20 ) {\n\t\t\tthis.attachElement( 'is_replace_with_open_shift' );\n\t\t} else {\n\t\t\tthis.detachElement( 'is_replace_with_open_shift' );\n\t\t}\n\t}\n\n\tshowAbsencePolicyField( type_id ) {\n\t\tif ( this.edit_view_ui_dic.request_schedule_status_id && this.edit_view_ui_dic.absence_policy_id ) {\n\t\t\tvar type_id = this.edit_view_ui_dic.type_id ? this.edit_view_ui_dic.type_id.getValue() : this.current_edit_record.type_id;\n\t\t\tvar request_schedule_status_id = this.edit_view_ui_dic.request_schedule_status_id.getValue()\n\n\t\t\tif ( request_schedule_status_id == 20 && ( type_id == 30 || type_id == 40 ) ) {\n\t\t\t\tthis.edit_view_ui_dic.absence_policy_id.parents( '.edit-view-form-item-div' ).show();\n\t\t\t\tif ( ( this.viewId == 'Request' && this.is_viewing ) == false ) {\n\t\t\t\t\tthis.onAvailableBalanceChange();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.edit_view_ui_dic.absence_policy_id.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\tthis.edit_view_ui_dic.available_balance.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t}\n\t\t}\n\t}\n\n\tonDateStampChanged() {\n\t\tif ( Global.getProductEdition() >= 15 && PermissionManager.validate( 'request', 'add_advanced' ) ) {\n\t\t\tthis.edit_view_ui_dic.start_date.setValue( this.current_edit_record.date_stamp );\n\t\t\tthis.current_edit_record.start_date = this.current_edit_record.date_stamp;\n\t\t}\n\t}\n\n\tonStartDateChanged() {\n\t\tthis.edit_view_ui_dic.date_stamp.setValue( this.current_edit_record.start_date );\n\t\tthis.current_edit_record.date_stamp = this.current_edit_record.start_date;\n\t}\n\n\tgetAvailableBalance() {\n\t\tif ( ( this.is_viewing && this.viewId == 'Request' ) || Global.isSet( this.current_edit_record ) == false ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( ( this.viewId != 'Request' || this.is_viewing == false ) &&\n\t\t\tthis.current_edit_record.absence_policy_id &&\n\t\t\t( PermissionManager.validate( 'request', 'add_advanced' ) || ( TTUUID.isUUID( this.current_edit_record.request_schedule_id ) && this.current_edit_record.request_schedule_id != TTUUID.zero_id && this.current_edit_record.request_schedule_id != TTUUID.not_exist_id ) ) &&\n\t\t\tLocalCacheData.loginUser.id &&\n\t\t\tthis.current_edit_record.total_time &&\n\t\t\tthis.current_edit_record.total_time != 0 &&\n\t\t\tthis.current_edit_record.start_date ) {\n\n\t\t\tvar days = 1;\n\t\t\tif ( this.current_edit_record.start_date != this.current_edit_record.end_date ) {\n\t\t\t\tdays = Global.getDaysInSpan( this.current_edit_record.start_date, this.current_edit_record.end_date, this.current_edit_record.sun, this.current_edit_record.mon, this.current_edit_record.tue, this.current_edit_record.wed, this.current_edit_record.thu, this.current_edit_record.fri, this.current_edit_record.sat );\n\t\t\t}\n\n\t\t\tvar $this = this;\n\t\t\tvar user_id = this.current_edit_record.user_id;\n\t\t\tvar total_time = this.current_edit_record.total_time * days;\n\t\t\tvar date_stamp = this.current_edit_record.date_stamp;\n\t\t\tvar policy_id = this.current_edit_record.absence_policy_id ? this.current_edit_record.absence_policy_id : TTUUID.zero_id;\n\n\t\t\tif ( user_id && date_stamp && total_time ) {\n\t\t\t\tthis.api_absence_policy.getProjectedAbsencePolicyBalance(\n\t\t\t\t\tpolicy_id,\n\t\t\t\t\tuser_id,\n\t\t\t\t\tdate_stamp,\n\t\t\t\t\ttotal_time,\n\t\t\t\t\t{\n\t\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t\tif ( $this.edit_view_ui_dic && $this.edit_view_ui_dic.available_balance ) {\n\t\t\t\t\t\t\t\t$this.getBalanceHandler( result, date_stamp );\n\t\t\t\t\t\t\t\tif ( result && $this.selected_absence_policy_record ) {\n\t\t\t\t\t\t\t\t\t$this.edit_view_ui_dic.available_balance.parents( '.edit-view-form-item-div' ).show();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t$this.edit_view_ui_dic.available_balance.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\t// If unset or set to --None--...\n\t\t} else if ( this.current_edit_record.absence_policy_id == false || this.current_edit_record.absence_policy_id == TTUUID.zero_id ) {\n\t\t\tif ( this.edit_view_ui_dic.available_balance ) {\n\t\t\t\tthis.edit_view_ui_dic.available_balance.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetFilterColumnsFromDisplayColumns( authorization_history ) {\n\t\t// Error: Unable to get property 'getGridParam' of undefined or null reference\n\t\tvar display_columns = [];\n\t\tif ( authorization_history ) {\n\t\t\tif ( this.authorization_history.authorization_history_grid ) {\n\t\t\t\tdisplay_columns = AuthorizationHistory.getAuthorizationHistoryDefaultDisplayColumns();\n\t\t\t}\n\t\t} else {\n\t\t\tif ( this.grid ) {\n\t\t\t\tdisplay_columns = this.grid.getGridParam( 'colModel' );\n\t\t\t}\n\t\t}\n\t\tvar column_filter = {};\n\t\tcolumn_filter.is_owner = true;\n\t\tcolumn_filter.id = true;\n\t\tcolumn_filter.is_child = true;\n\t\tcolumn_filter.in_use = true;\n\t\tcolumn_filter.first_name = true;\n\t\tcolumn_filter.last_name = true;\n\t\tcolumn_filter.user_id = true;\n\t\tcolumn_filter.status_id = true;\n\n\t\tif ( display_columns ) {\n\t\t\tvar len = display_columns.length;\n\n\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\tvar column_info = display_columns[i];\n\t\t\t\tcolumn_filter[column_info.name] = true;\n\t\t\t}\n\t\t}\n\n\t\treturn column_filter;\n\t}\n\n\tjobUIValidate() {\n\t\t//use punch permission section rather than schedule permission section as that's what they can see when they're creating punches\n\t\tif ( PermissionManager.validate( 'job', 'enabled' ) &&\n\t\t\tPermissionManager.validate( 'punch', 'edit_job' ) ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tjobItemUIValidate() {\n\t\t//use punch permission section rather than schedule permission section as that's what they can see when they're creating punches\n\t\tif ( PermissionManager.validate( 'punch', 'edit_job_item' ) ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tpunchTagUIValidate() {\n\t\t//use punch permission section rather than schedule permission section as that's what they can see when they're creating punches\n\t\tif ( PermissionManager.validate( 'punch', 'edit_punch_tag' ) ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tbranchUIValidate() {\n\t\t//use punch permission section rather than schedule permission section as that's what they can see when they're creating punches\n\t\tif ( PermissionManager.validate( 'punch', 'edit_branch' ) ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tdepartmentUIValidate() {\n\t\t//use punch permission section rather than schedule permission section as that's what they can see when they're creating punches\n\t\tif ( PermissionManager.validate( 'punch', 'edit_department' ) ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprocessAPICallbackResult( result_data ) {\n\t\tthis.current_edit_record = this.buildDataFromAPI( result_data[0] );\n\t\tif ( this.current_edit_record && this.current_edit_record.total_time ) {\n\t\t\tthis.current_edit_record.total_time = Global.getTimeUnit( this.current_edit_record.total_time );\n\t\t}\n\n\t\treturn result_data;\n\t}\n\n\tdoViewClickResult( result_data ) {\n\t\tif ( Global.isSet( this.current_edit_record.start_date ) && this.edit_view_tab ) {\n\t\t\tthis.edit_view_tab.find( '#tab_request' ).find( '.third-column' ).show();\n\t\t}\n\n\t\tthis.initEditView();\n\t\tthis.initViewingView();\n\n\t\t//This line is required to avoid problems with the absence policy box not showing properly on initial load.\n\t\tthis.onWorkingStatusChanged();\n\n\t\tvar $this = this;\n\t\tEmbeddedMessage.init( this.current_edit_record.id, 50, this, this.edit_view, this.edit_view_tab, this.edit_view_ui_dic, function() {\n\t\t\t$this.authorization_history = AuthorizationHistory.init( $this );\n\t\t\t$this.setEditMenu();\n\t\t} );\n\t\treturn this.clearCurrentSelectedRecord();\n\t}\n\n\tonViewClick( edit_record, clear_edit_view ) {\n\t\tif ( clear_edit_view ) {\n\t\t\tthis.clearEditView();\n\t\t}\n\t\tsuper.onViewClick( edit_record );\n\t}\n\n\tsetSubLogViewFilter() {\n\t\tif ( !this.sub_log_view_controller ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.sub_log_view_controller.getSubViewFilter = function( filter ) {\n\t\t\tfilter['table_name_object_id'] = {\n\t\t\t\t'request': [this.parent_edit_record.id],\n\t\t\t\t'request_schedule': [this.parent_edit_record.request_schedule_id]\n\t\t\t};\n\n\t\t\treturn filter;\n\t\t};\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * This function exists because the edit form is not actually an edit mode form, so we need to do some\n\t * stuff differently in view mode than in edit mode.\n\t */\n\tinitViewingView() {\n\t\tthis.showAdvancedFields();\n\t}\n\n\tinitEditViewUI( view_id, edit_view_file_name ) {\n\t\tGlobal.setUINotready();\n\t\tTTPromise.add( 'init', 'init' );\n\t\tTTPromise.wait();\n\t\tvar $this = this;\n\n\t\tif ( this.edit_view ) {\n\t\t\tthis.edit_view.remove();\n\t\t}\n\n\t\tthis.edit_view = $( Global.loadViewSource( view_id, edit_view_file_name, null, true ) );\n\t\tthis.edit_view_tab = $( this.edit_view.find( '.edit-view-tab-bar' ) );\n\n\t\t//Give edt view tab a id, so we can load it when put right click menu on it\n\t\tthis.edit_view_tab.attr( 'id', this.ui_id + '_edit_view_tab' );\n\n\t\t// Moved into generic BaseView.initEditViewTabs\n\t\t// this.setTabOVisibility( false );\n\t\t// this.edit_view_tab = this.edit_view_tab.tabs( {\n\t\t// \tactivate: function( e, ui ) {\n\t\t// \t\t$this.onTabShow( e, ui );\n\t\t// \t}\n\t\t// } );\n\t\t// Note: Check the 'tabsselect' replaced with generic 'click' in baseview does not cause issue.\n\t\t// this.edit_view_tab.bind( 'tabsselect', function( e, ui ) {\n\t\t// \t$this.onTabIndexChange( e, ui );\n\t\t// } );\n\n\t\tGlobal.contentContainer().append( this.edit_view );\n\t\tthis.initRightClickMenu( RightClickMenuType.EDITVIEW );\n\n\t\tif ( this.is_viewing ) {\n\t\t\tLocalCacheData.current_doing_context_action = 'view';\n\t\t\tthis.buildViewUI();\n\t\t} else if ( this.is_edit ) {\n\t\t\tLocalCacheData.current_doing_context_action = 'edit';\n\t\t\tthis.buildEditViewUI();\n\t\t\tContextMenuManager.unmountContextMenu( this.determineContextMenuMountAttributes().id );\n\t\t\tthis.buildContextMenu( true );\n\t\t}\n\n\t\t$this.setEditViewTabHeight();\n\t}\n\n\tinitEditViewTabs() {\n\t\tvar $this = this;\n\t\tvar tab_options = {\n\t\t\tactivate: function( e, ui ) {\n\t\t\t\t$this.onTabShow( e, ui );\n\t\t\t}\n\t\t};\n\n\t\tsuper.initEditViewTabs( tab_options );\n\t}\n\n\tonEditClick( editId, noRefreshUI ) {\n\t\tthis.setCurrentEditViewState( 'edit' );\n\t\tthis.initEditViewUI( this.viewId, this.edit_view_tpl );\n\t\tthis.initEditView();\n\t\t//Clear last sent message body value.\n\t\tthis.edit_view_ui_dic.body.setValue( '' );\n\t\t//ensure send button is available\n\t\tthis.setEditMenu();\n\t}\n\n\tbuildViewUI() {\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_request': {\n\t\t\t\t'label': $.i18n._( 'Request' ),\n\t\t\t\t'html_template': this.getRequestTabHtml()\n\t\t\t},\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIRequest,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_request',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\tvar form_item_input;\n\t\tvar widgetContainer;\n\t\tvar label;\n\n\t\t//Tab 0 first column start\n\t\tvar tab_request = this.edit_view_tab.find( '#tab_request' );\n\t\tvar tab_request_column1 = tab_request.find( '.first-column' );\n\t\tthis.edit_view_tabs[0] = [];\n\t\tthis.edit_view_tabs[0].push( tab_request_column1 );\n\n\t\t// Employee\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( { field: 'full_name' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Employee' ), form_item_input, tab_request_column1 );\n\n\t\t// Type\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( { field: 'type', set_empty: false } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Type' ), form_item_input, tab_request_column1 );\n\n\t\t// Date\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( { field: 'date_stamp' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Date' ), form_item_input, tab_request_column1 );\n\n\t\tif ( Global.getProductEdition() >= 15 ) {\n\n\t\t\t//Working Status\n\t\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\t\tform_item_input.TComboBox( { field: 'request_schedule_status_id', set_empty: false } );\n\t\t\tform_item_input.setSourceData( { 10: 'Working', 20: 'Absent' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_request_column1 );\n\t\t\tform_item_input.bind( 'change', function( e ) {\n\t\t\t\t$this.onWorkingStatusChanged();\n\t\t\t} );\n\n\t\t\t//Absence Policy\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIAbsencePolicy,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_absences',\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'absence_policy_id',\n\t\t\t\tcustomSearchFilter: function( filter ) {\n\t\t\t\t\treturn $this.setAbsencePolicyFilter( filter );\n\t\t\t\t},\n\t\t\t\tsetRealValueCallBack: function( value ) {\n\t\t\t\t\t// #2135 fix for cases where user is removed from absence policies between creating request and approval\n\t\t\t\t\t$this.selected_absence_policy_record = value;\n\t\t\t\t\t$this.onAvailableBalanceChange();\n\t\t\t\t}\n\t\t\t} );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Absence Policy' ), form_item_input, tab_request_column1 );\n\n\t\t\t//Available Balance\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\tform_item_input.TText( { field: 'available_balance' } );\n\t\t\twidgetContainer = $( '<div class=\\'widget-h-box available-balance-h-box\\'></div>' );\n\t\t\tthis.available_balance_info = $( '<span class=\"available-balance-info tticon tticon-info_black_24dp\"></span>' );\n\t\t\twidgetContainer.append( form_item_input );\n\t\t\twidgetContainer.append( this.available_balance_info );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Available Balance' ), form_item_input, tab_request_column1, '', widgetContainer, true );\n\n\t\t\t//Start Date\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\t\tform_item_input.TDatePicker( { field: 'start_date' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Start Date' ), form_item_input, tab_request_column1, '' );\n\n\t\t\t//End  Date\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\t\tform_item_input.TDatePicker( { field: 'end_date' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'End Date' ), form_item_input, tab_request_column1, '' );\n\n\t\t\t// Effective Days\n\t\t\tvar form_item_sun_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_sun_checkbox.TCheckbox( { field: 'sun' } );\n\n\t\t\tvar form_item_mon_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_mon_checkbox.TCheckbox( { field: 'mon' } );\n\n\t\t\tvar form_item_tue_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_tue_checkbox.TCheckbox( { field: 'tue' } );\n\n\t\t\tvar form_item_wed_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_wed_checkbox.TCheckbox( { field: 'wed' } );\n\n\t\t\tvar form_item_thu_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_thu_checkbox.TCheckbox( { field: 'thu' } );\n\n\t\t\tvar form_item_fri_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_fri_checkbox.TCheckbox( { field: 'fri' } );\n\n\t\t\tvar form_item_sat_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_sat_checkbox.TCheckbox( { field: 'sat' } );\n\n\t\t\twidgetContainer = $( '<div></div>' );\n\n\t\t\tvar sun = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Sun' ) + ' <br> ' + ' </span>' );\n\t\t\tvar mon = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Mon' ) + ' <br> ' + ' </span>' );\n\t\t\tvar tue = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Tue' ) + ' <br> ' + ' </span>' );\n\t\t\tvar wed = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Wed' ) + ' <br> ' + ' </span>' );\n\t\t\tvar thu = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Thu' ) + ' <br> ' + ' </span>' );\n\t\t\tvar fri = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Fri' ) + ' <br> ' + ' </span>' );\n\t\t\tvar sat = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Sat' ) + ' <br> ' + ' </span>' );\n\n\t\t\tsun.append( form_item_sun_checkbox );\n\t\t\tmon.append( form_item_mon_checkbox );\n\t\t\ttue.append( form_item_tue_checkbox );\n\t\t\twed.append( form_item_wed_checkbox );\n\t\t\tthu.append( form_item_thu_checkbox );\n\t\t\tfri.append( form_item_fri_checkbox );\n\t\t\tsat.append( form_item_sat_checkbox );\n\n\t\t\twidgetContainer.append( sun );\n\t\t\twidgetContainer.append( mon );\n\t\t\twidgetContainer.append( tue );\n\t\t\twidgetContainer.append( wed );\n\t\t\twidgetContainer.append( thu );\n\t\t\twidgetContainer.append( fri );\n\t\t\twidgetContainer.append( sat );\n\n\t\t\twidgetContainer.addClass( 'request_edit_view_effective_days' );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Effective Days' ), [form_item_sun_checkbox, form_item_mon_checkbox, form_item_tue_checkbox, form_item_wed_checkbox, form_item_thu_checkbox, form_item_fri_checkbox, form_item_sat_checkbox], tab_request_column1, '', widgetContainer, false, true );\n\n\t\t\t//Start time\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TIME_PICKER );\n\t\t\tform_item_input.TTimePicker( { field: 'start_time' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'In' ), form_item_input, tab_request_column1 );\n\n\t\t\t//End  time\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TIME_PICKER );\n\t\t\tform_item_input.TTimePicker( { field: 'end_time' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Out' ), form_item_input, tab_request_column1 );\n\n\t\t\t// Total\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\tform_item_input.TText( { field: 'total_time' } );\n\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\t\tlabel = $( '<span class=\\'widget-right-label\\' id=\\'total_info\\'></span>' );\n\t\t\twidgetContainer.append( form_item_input );\n\t\t\twidgetContainer.append( label );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Total' ), form_item_input, tab_request_column1, '', widgetContainer );\n\n\t\t\tif ( ( Global.getProductEdition() >= 15 ) && this.overlappingShiftUIValidate() == true ) {\n\t\t\t\t//Override / Split shift\n\t\t\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\t\t\tform_item_input.TComboBox( { field: 'overlap_type_id', set_empty: false } );\n\t\t\t\tform_item_input.setSourceData( this.overlap_type_array );\n\t\t\t\twidgetContainer = $( '<div class=\\'widget-h-box overlapping-shift-h-box\\'></div>' );\n\t\t\t\tthis.overlapping_shift_info = $( '<span style=\"position: relative; top: -3px; left: 3px;\" id=\"overlapping-shift-total\"></span><span id=\"overlapping-shift-icon\" class=\"overlapping-shift-info tticon tticon-info_black_24dp\"></span>' );\n\t\t\t\twidgetContainer.append( form_item_input );\n\t\t\t\twidgetContainer.append( this.overlapping_shift_info );\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Overlapping Shift(s)' ), form_item_input, tab_request_column1, '', widgetContainer, true );\n\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\t\tform_item_input.TCheckbox( { field: 'is_replace_with_open_shift' } );\n\n\t\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\t\t\tlabel = $( '<span class=\\'widget-right-label\\'>( ' + $.i18n._( 'For Absences' ) + ' )</span>' );\n\t\t\t\twidgetContainer.append( form_item_input );\n\t\t\t\twidgetContainer.append( label );\n\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Create Open Shift' ), form_item_input, tab_request_column1, '', widgetContainer, true );\n\n\t\t\t}\n\n\t\t\t//Schedule Policy\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APISchedulePolicy,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_schedule',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'schedule_policy_id'\n\t\t\t} );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Schedule Policy' ), form_item_input, tab_request_column1 );\n\n\t\t\t//Branch\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIBranch,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_branch',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'branch_id'\n\t\t\t} );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Branch' ), form_item_input, tab_request_column1 );\n\t\t\tif ( !this.show_branch_ui ) {\n\t\t\t\tthis.detachElement( 'branch_id' );\n\t\t\t}\n\n\t\t\t//Department\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIDepartment,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_department',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'department_id'\n\t\t\t} );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Department' ), form_item_input, tab_request_column1 );\n\t\t\tif ( !this.show_department_ui ) {\n\t\t\t\tthis.detachElement( 'department_id' );\n\t\t\t}\n\n\t\t\tif ( Global.getProductEdition() >= 20 ) {\n\t\t\t\t//Job\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\t\t\tform_item_input.AComboBox( {\n\t\t\t\t\tapi_class: TTAPI.APIJob,\n\t\t\t\t\tallow_multiple_selection: false,\n\t\t\t\t\tlayout_name: 'global_job',\n\t\t\t\t\tshow_search_inputs: true,\n\t\t\t\t\tset_empty: true,\n\t\t\t\t\tsetRealValueCallBack: ( function( val ) {\n\n\t\t\t\t\t\tif ( val ) {\n\t\t\t\t\t\t\tjob_coder.setValue( val.manual_id );\n\t\t\t\t\t\t}\n\t\t\t\t\t} ),\n\t\t\t\t\tfield: 'job_id',\n\t\t\t\t\tadded_items: [\n\t\t\t\t\t\t{ value: '-1', label: Global.default_item },\n\t\t\t\t\t\t{ value: '-2', label: Global.selected_item }\n\t\t\t\t\t]\n\t\t\t\t} );\n\n\t\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\t\t\tvar job_coder = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tjob_coder.TTextInput( { field: 'job_quick_search', disable_keyup_event: true } );\n\t\t\t\tjob_coder.addClass( 'job-coder' );\n\n\t\t\t\twidgetContainer.append( job_coder );\n\t\t\t\twidgetContainer.append( form_item_input );\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Job' ), [form_item_input, job_coder], tab_request_column1, '', widgetContainer, true );\n\n\t\t\t\tif ( !this.show_job_ui ) {\n\t\t\t\t\tthis.detachElement( 'job_id' );\n\t\t\t\t}\n\n\t\t\t\t//Job Item\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\t\t\tform_item_input.AComboBox( {\n\t\t\t\t\tapi_class: TTAPI.APIJobItem,\n\t\t\t\t\tallow_multiple_selection: false,\n\t\t\t\t\tlayout_name: 'global_job_item',\n\t\t\t\t\tshow_search_inputs: true,\n\t\t\t\t\tset_empty: true,\n\t\t\t\t\tsetRealValueCallBack: ( function( val ) {\n\n\t\t\t\t\t\tif ( val ) {\n\t\t\t\t\t\t\tjob_item_coder.setValue( val.manual_id );\n\t\t\t\t\t\t}\n\t\t\t\t\t} ),\n\t\t\t\t\tfield: 'job_item_id',\n\t\t\t\t\tadded_items: [\n\t\t\t\t\t\t{ value: '-1', label: Global.default_item },\n\t\t\t\t\t\t{ value: '-2', label: Global.selected_item }\n\t\t\t\t\t]\n\t\t\t\t} );\n\n\t\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\t\t\tvar job_item_coder = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tjob_item_coder.TTextInput( { field: 'job_item_quick_search', disable_keyup_event: true } );\n\t\t\t\tjob_item_coder.addClass( 'job-coder' );\n\n\t\t\t\twidgetContainer.append( job_item_coder );\n\t\t\t\twidgetContainer.append( form_item_input );\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Task' ), [form_item_input, job_item_coder], tab_request_column1, '', widgetContainer, true );\n\n\t\t\t\tif ( !this.show_job_item_ui ) {\n\t\t\t\t\tthis.detachElement( 'job_item_id' );\n\t\t\t\t}\n\n\t\t\t\t//Punch Tag\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\t\t\tform_item_input.AComboBox( {\n\t\t\t\t\tapi_class: TTAPI.APIPunchTag,\n\t\t\t\t\tallow_multiple_selection: true,\n\t\t\t\t\tlayout_name: 'global_punch_tag',\n\t\t\t\t\tshow_search_inputs: true,\n\t\t\t\t\tset_empty: true,\n\t\t\t\t\tsetRealValueCallBack: ( ( punch_tags ) => {\n\t\t\t\t\t\tif ( punch_tags ) {\n\t\t\t\t\t\t\tthis.setPunchTagQuickSearchManualIds( punch_tags );\n\t\t\t\t\t\t}\n\t\t\t\t\t} ),\n\t\t\t\t\tfield: 'punch_tag_id'\n\t\t\t\t} );\n\n\t\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\t\t\tvar punch_tag_coder = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tpunch_tag_coder.TTextInput( { field: 'punch_tag_quick_search', disable_keyup_event: true } );\n\t\t\t\tpunch_tag_coder.addClass( 'job-coder' );\n\n\t\t\t\twidgetContainer.append( punch_tag_coder );\n\t\t\t\twidgetContainer.append( form_item_input );\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Punch Tags' ), [form_item_input, punch_tag_coder], tab_request_column1, '', widgetContainer, true );\n\n\t\t\t\tif ( !this.show_punch_tag_ui ) {\n\t\t\t\t\tthis.detachElement( 'punch_tag_id' );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tEmbeddedMessage.initUI( this, tab_request );\n\t}\n\n\tsetAbsencePolicyFilter( filter ) {\n\t\tif ( !filter.filter_data ) {\n\t\t\tfilter.filter_data = {};\n\t\t}\n\t\tfilter.filter_data.user_id = this.current_edit_record.user_id;\n\n\t\tif ( filter.filter_columns ) {\n\t\t\tfilter.filter_columns.absence_policy = true;\n\t\t}\n\t\treturn filter;\n\t}\n\n\tneedShowNavigation() {\n\t\tif ( this.is_viewing && this.current_edit_record && Global.isSet( this.current_edit_record.id ) && this.current_edit_record.id ) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tonNavigationClick( iconName ) {\n\n\t\tvar $this = this;\n\t\tvar filter;\n\t\tvar temp_filter;\n\t\tvar grid_selected_id_array;\n\t\tvar grid_selected_length;\n\n\t\tvar selectedId;\n\t\t/* jshint ignore:start */\n\t\tswitch ( iconName ) {\n\t\t\tcase 'timesheet':\n\t\t\t\tfilter = { filter_data: {} };\n\t\t\t\tif ( Global.isSet( this.current_edit_record ) ) {\n\n\t\t\t\t\tfilter.user_id = this.current_edit_record.user_id ? this.current_edit_record.user_id : LocalCacheData.loginUser.id;\n\t\t\t\t\tfilter.base_date = this.current_edit_record.date_stamp;\n\n\t\t\t\t\tGlobal.addViewTab( $this.viewId, $.i18n._( 'Authorization - Request' ), window.location.href );\n\t\t\t\t\tIndexViewController.goToView( 'TimeSheet', filter );\n\n\t\t\t\t} else {\n\t\t\t\t\ttemp_filter = {};\n\t\t\t\t\tgrid_selected_id_array = this.getGridSelectIdArray();\n\t\t\t\t\tgrid_selected_length = grid_selected_id_array.length;\n\n\t\t\t\t\tif ( grid_selected_length > 0 ) {\n\t\t\t\t\t\tselectedId = grid_selected_id_array[0];\n\n\t\t\t\t\t\ttemp_filter.filter_data = {};\n\t\t\t\t\t\ttemp_filter.filter_columns = { user_id: true, date_stamp: true };\n\t\t\t\t\t\ttemp_filter.filter_data.id = [selectedId];\n\n\t\t\t\t\t\tthis.api['get' + this.api.key_name]( temp_filter, {\n\t\t\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\t\t\t\t\tif ( !result_data ) {\n\t\t\t\t\t\t\t\t\tresult_data = [];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tresult_data = result_data[0];\n\n\t\t\t\t\t\t\t\tfilter.user_id = result_data.user_id;\n\t\t\t\t\t\t\t\tfilter.base_date = result_data.date_stamp;\n\t\t\t\t\t\t\t\tGlobal.addViewTab( $this.viewId, $.i18n._( 'Authorization - Request' ), window.location.href );\n\t\t\t\t\t\t\t\tIndexViewController.goToView( 'TimeSheet', filter );\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'edit_employee':\n\t\t\t\tfilter = { filter_data: {} };\n\t\t\t\tif ( Global.isSet( this.current_edit_record ) ) {\n\t\t\t\t\tIndexViewController.openEditView( this, 'Employee', this.current_edit_record.user_id ? this.current_edit_record.user_id : LocalCacheData.loginUser.id );\n\t\t\t\t} else {\n\t\t\t\t\ttemp_filter = {};\n\t\t\t\t\tgrid_selected_id_array = this.getGridSelectIdArray();\n\t\t\t\t\tgrid_selected_length = grid_selected_id_array.length;\n\n\t\t\t\t\tif ( grid_selected_length > 0 ) {\n\t\t\t\t\t\tselectedId = grid_selected_id_array[0];\n\n\t\t\t\t\t\ttemp_filter.filter_data = {};\n\t\t\t\t\t\ttemp_filter.filter_columns = { user_id: true };\n\t\t\t\t\t\ttemp_filter.filter_data.id = [selectedId];\n\n\t\t\t\t\t\tthis.api['get' + this.api.key_name]( temp_filter, {\n\t\t\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\t\t\t\t\tif ( !result_data ) {\n\t\t\t\t\t\t\t\t\tresult_data = [];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tresult_data = result_data[0];\n\n\t\t\t\t\t\t\t\tIndexViewController.openEditView( $this, 'Employee', result_data.user_id );\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'schedule':\n\n\t\t\t\tfilter = { filter_data: {} };\n\n\t\t\t\tvar include_users = null;\n\n\t\t\t\tif ( Global.isSet( this.current_edit_record ) ) {\n\n\t\t\t\t\tinclude_users = [this.current_edit_record.user_id ? this.current_edit_record.user_id : LocalCacheData.loginUser.id];\n\t\t\t\t\tfilter.filter_data.include_user_ids = { value: include_users };\n\t\t\t\t\tfilter.select_date = this.current_edit_record.date_stamp;\n\n\t\t\t\t\tGlobal.addViewTab( $this.viewId, $.i18n._( 'Authorization - Request' ), window.location.href );\n\t\t\t\t\tIndexViewController.goToView( 'Schedule', filter );\n\n\t\t\t\t} else {\n\t\t\t\t\ttemp_filter = {};\n\t\t\t\t\tgrid_selected_id_array = this.getGridSelectIdArray();\n\t\t\t\t\tgrid_selected_length = grid_selected_id_array.length;\n\n\t\t\t\t\tif ( grid_selected_length > 0 ) {\n\t\t\t\t\t\tselectedId = grid_selected_id_array[0];\n\n\t\t\t\t\t\ttemp_filter.filter_data = {};\n\t\t\t\t\t\ttemp_filter.filter_columns = { user_id: true, date_stamp: true };\n\t\t\t\t\t\ttemp_filter.filter_data.id = [selectedId];\n\n\t\t\t\t\t\tthis.api['get' + this.api.key_name]( temp_filter, {\n\t\t\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\t\t\t\t\tif ( !result_data ) {\n\t\t\t\t\t\t\t\t\tresult_data = [];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tresult_data = result_data[0];\n\n\t\t\t\t\t\t\t\tinclude_users = [result_data.user_id];\n\n\t\t\t\t\t\t\t\tfilter.filter_data.include_user_ids = include_users;\n\t\t\t\t\t\t\t\tfilter.select_date = result_data.date_stamp;\n\n\t\t\t\t\t\t\t\tGlobal.addViewTab( $this.viewId, $.i18n._( 'Authorization - Request' ), window.location.href );\n\t\t\t\t\t\t\t\tIndexViewController.goToView( 'Schedule', filter );\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\t/* jshint ignore:end */\n\t}\n\n\tinitPermission() {\n\t\tif ( PermissionManager.validate( this.permission_id, 'view' ) || PermissionManager.validate( this.permission_id, 'view_child' ) ) {\n\t\t\tthis.show_search_tab = true;\n\t\t} else {\n\t\t\tthis.show_search_tab = false;\n\t\t}\n\n\t\tif ( this.jobUIValidate() ) {\n\t\t\tthis.show_job_ui = true;\n\t\t} else {\n\t\t\tthis.show_job_ui = false;\n\t\t}\n\n\t\tif ( this.jobItemUIValidate() ) {\n\t\t\tthis.show_job_item_ui = true;\n\t\t} else {\n\t\t\tthis.show_job_item_ui = false;\n\t\t}\n\n\t\tif ( this.punchTagUIValidate() ) {\n\t\t\tthis.show_punch_tag_ui = true;\n\t\t} else {\n\t\t\tthis.show_punch_tag_ui = false;\n\t\t}\n\n\t\tif ( this.branchUIValidate() ) {\n\t\t\tthis.show_branch_ui = true;\n\t\t} else {\n\t\t\tthis.show_branch_ui = false;\n\t\t}\n\n\t\tif ( this.departmentUIValidate() ) {\n\t\t\tthis.show_department_ui = true;\n\t\t} else {\n\t\t\tthis.show_department_ui = false;\n\t\t}\n\n\t\t// Error: Uncaught TypeError: (intermediate value).isBranchAndDepartmentAndJobAndJobItemAndPunchTagEnabled is not a function on line 207\n\t\tvar company_api = TTAPI.APICompany;\n\t\tif ( company_api && _.isFunction( company_api.isBranchAndDepartmentAndJobAndJobItemAndPunchTagEnabled ) ) {\n\t\t\tvar result = company_api.isBranchAndDepartmentAndJobAndJobItemAndPunchTagEnabled( { async: false } );\n\t\t}\n\n\t\tif ( !result ) {\n\t\t\tthis.show_branch_ui = false;\n\t\t\tthis.show_department_ui = false;\n\t\t\tthis.show_job_ui = false;\n\t\t\tthis.show_job_item_ui = false;\n\t\t\tthis.show_punch_tag_ui = false;\n\t\t} else {\n\t\t\tresult = result.getResult();\n\t\t\tif ( !result.branch ) {\n\t\t\t\tthis.show_branch_ui = false;\n\t\t\t}\n\n\t\t\tif ( !result.department ) {\n\t\t\t\tthis.show_department_ui = false;\n\t\t\t}\n\n\t\t\tif ( !result.job ) {\n\t\t\t\tthis.show_job_ui = false;\n\t\t\t}\n\n\t\t\tif ( !result.job_item ) {\n\t\t\t\tthis.show_job_item_ui = false;\n\t\t\t}\n\n\t\t\tif ( !result.punch_tag ) {\n\t\t\t\tthis.show_punch_tag_ui = false;\n\t\t\t}\n\t\t}\n\n\t}\n\n\tsetEditMenuEditIcon( context_btn ) {\n\t\tif ( !this.editPermissionValidate( 'request' ) ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\t//If edit_child is FALSE and this is a child record, inputs should be read-only.\n\t\tif ( this.editOwnerOrChildPermissionValidate( 'request' ) ) {\n\t\t\tthis.enable_edit_view_ui = true;\n\t\t} else {\n\t\t\tthis.enable_edit_view_ui = false;\n\t\t}\n\n\t\tif ( !this.editOwnerOrChildPermissionValidate( 'request' ) || this.is_add || this.is_edit ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tgetOverlappingShifts() {\n\t\tlet $this = this;\n\n\t\tif ( !this.current_edit_record || !this.current_edit_record.type_id ) {\n\t\t\treturn;\n\t\t}\n\n\t\t//Do not get overlapping shifts if user does not have schedule permissions, is on a lower product edition or request is not a schedule change.\n\t\tif ( this.overlappingShiftUIValidate() == false || ( Global.getProductEdition() < 15 ) || ( this.current_edit_record.type_id == 30 || this.current_edit_record.type_id == 40 ) == false ) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet data = {};\n\t\tdata.start_date = this.current_edit_record.start_date;\n\t\tdata.end_date = this.current_edit_record.end_date;\n\t\tdata.user_id = this.current_edit_record.user_id;\n\t\tdata.start_time = this.current_edit_record.start_time;\n\t\tdata.end_time = this.current_edit_record.end_time;\n\n\t\tdata.overlap_type_id = this.current_edit_record.overlap_type_id;\n\n\t\tdata.schedule_policy_id = this.current_edit_record.schedule_policy_id;\n\t\tdata.absence_policy_id = this.current_edit_record.absence_policy_id;\n\t\tdata.request_schedule_status_id = this.current_edit_record.request_schedule_status_id;\n\n\t\tdata.requested_days = {};\n\n\t\tdata.requested_days[0] = this.current_edit_record.sun;\n\t\tdata.requested_days[1] = this.current_edit_record.mon;\n\t\tdata.requested_days[2] = this.current_edit_record.tue;\n\t\tdata.requested_days[3] = this.current_edit_record.wed;\n\t\tdata.requested_days[4] = this.current_edit_record.thu;\n\t\tdata.requested_days[5] = this.current_edit_record.fri;\n\t\tdata.requested_days[6] = this.current_edit_record.sat;\n\n\t\tdata.is_replace_with_open_shift = this.current_edit_record.is_replace_with_open_shift;\n\n\t\tthis.schedule_api.getOverlappingShifts( data, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tlet result_data = result.getResult();\n\n\t\t\t\tif ( !result_data || !result_data.split ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t$this.overlapping_shift_data = result_data;\n\n\t\t\t\t$this.buildOverlappingShiftInfo();\n\t\t\t}\n\t\t} );\n\t}\n\n\tbuildOverlappingShiftInfo() {\n\t\tlet $this = this;\n\n\t\tif ( !this.current_edit_record ) {\n\t\t\t//Issue #3216 - Error: Uncaught TypeError: Cannot read properties of null (reading 'overlap_type_id')\n\t\t\t//This could happen under race conditions or opening a request and then quickly closing it when experiencing latency.\n\t\t\treturn;\n\t\t}\n\n\t\tlet overlapping_shifts_html = '';\n\t\tlet split_shifts = this.overlapping_shift_data['split'];\n\t\tlet shifts_after = 0;\n\t\tlet shifts_before = 0;\n\t\tlet shifts_after_total_time = 0;\n\t\tlet shifts_before_total_time = 0;\n\n\t\tlet suggested_overlap_type_id = 10; //Replace\n\n\t\tshifts_after = this.overlapping_shift_data['no_overlap'].length;\n\t\tshifts_after_total_time += this.overlapping_shift_data['no_overlap'].reduce( ( a, b ) => parseFloat( a ) + parseFloat( b.total_time ), 0 );\n\t\tif ( this.current_edit_record.overlap_type_id == 10 ) { //Replace\n\t\t\tshifts_after += this.overlapping_shift_data['open_replaced'].length;\n\t\t\tshifts_after_total_time += this.overlapping_shift_data['open_replaced'].reduce( ( a, b ) => parseFloat( a ) + parseFloat( b.total_time ), 0 );\n\t\t} else if ( this.current_edit_record.overlap_type_id == 20 ) { //Split\n\t\t\tshifts_after += split_shifts.length;\n\t\t\tshifts_after_total_time += split_shifts.reduce( ( a, b ) => a + b.total_time, 0 );\n\t\t}\n\t\tif ( this.current_edit_record.is_replace_with_open_shift == true ) {\n\t\t\tshifts_after += this.overlapping_shift_data['open_replaced'].length;\n\t\t\tshifts_after_total_time += this.overlapping_shift_data['open_replaced'].reduce( ( a, b ) => parseFloat( a ) + parseFloat( b.total_time ), 0 );\n\t\t}\n\t\tshifts_before = this.overlapping_shift_data['original'].filter( shift => !shift.not_unique && !shift.do_not_split ).length;\n\t\tshifts_before_total_time = this.overlapping_shift_data['original'].filter( shift => !shift.not_unique && !shift.do_not_split ).reduce( ( a, b ) => parseFloat( a ) + parseFloat( b.total_time ), 0 );\n\t\t$( '#overlapping-shift-total' ).text( '( ' + shifts_before + ' / ' + shifts_after + ' )' );\n\t\t//Group modified shifts by parent (specific starting shift)\n\t\tif ( Array.isArray( split_shifts ) ) {\n\t\t\tlet shift_data_map = {};\n\t\t\tfor ( let i = 0; i < split_shifts.length; i++ ) {\n\t\t\t\tif ( split_shifts[i].split_state === 'no_split' ) {\n\t\t\t\t\t//No change to this shift.\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif ( !shift_data_map[split_shifts[i].split_parent] ) {\n\t\t\t\t\tshift_data_map[split_shifts[i].split_parent] = [];\n\t\t\t\t}\n\t\t\t\tshift_data_map[split_shifts[i].split_parent].push( split_shifts[i] );\n\n\t\t\t\t//Check if split overlaps < 50% of parent (original) shift. Only check if split is not already suggested.\n\t\t\t\tif ( suggested_overlap_type_id == 10 ) { //Replace\n\t\t\t\t\tlet parent_shift = this.overlapping_shift_data['original'].find( shift => shift.id === split_shifts[i].split_parent );\n\t\t\t\t\tif ( parent_shift ) {\n\t\t\t\t\t\tlet split_shift_percent = ( parseFloat( split_shifts[i].total_time ) / parseFloat( parent_shift.total_time ) ) * 100;\n\t\t\t\t\t\tif ( split_shift_percent < 50 ) {\n\t\t\t\t\t\t\tsuggested_overlap_type_id = 20; //Split\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\toverlapping_shifts_html += '<table class=\"overlapping-info-table\">';\n\n\t\t\tif ( this.current_edit_record.overlap_type_id != suggested_overlap_type_id ) {\n\t\t\t\tlet suggested_overlap_label = suggested_overlap_type_id == 10 ? $.i18n._( 'Replace' ) : $.i18n._( 'Split' );\n\t\t\t\toverlapping_shifts_html += '<tr><th colspan=\"3\" style=\"text-align: center; color: red;\">' + $.i18n._( 'Suggested Overlapping Shift(s) Mode' ) + ': <strong>' + suggested_overlap_label + '</strong></th></tr>';\n\t\t\t\t//Make the overlapping icon red if the suggested overlap type is different from the current selected overlap type.\n\t\t\t\t//This is to draw the users' attention.\n\t\t\t\t$( '#overlapping-shift-icon' ).css( 'color', 'red' );\n\t\t\t} else {\n\t\t\t\t$( '#overlapping-shift-icon' ).css( 'color', '' );\n\t\t\t}\n\n\t\t\tif ( this.current_edit_record.overlap_type_id == 20 && split_shifts.length > 0 ) {\n\t\t\t\toverlapping_shifts_html += '<th colspan=\"3\" style=\"text-align: center\">' + $.i18n._( 'Overlapping Shifts' ) + '</th></tr>';\n\t\t\t} else if ( this.current_edit_record.overlap_type_id == 10 && this.overlapping_shift_data['open_replaced'].length > 0 ) {\n\t\t\t\toverlapping_shifts_html += '<tr><th colspan=\"3\" style=\"text-align: center\">' + $.i18n._( 'Replaced Shifts' ) + '</th></tr>';\n\t\t\t}\n\n\t\t\tif ( _.size( shift_data_map ) > 0 ) {\n\t\t\t\toverlapping_shifts_html += this.getOverlappingShiftHeaderHtml();\n\t\t\t}\n\n\t\t\tfor ( let shift_data in shift_data_map ) {\n\t\t\t\tlet parent_data = this.overlapping_shift_data['original'].find( shift => shift.id === shift_data_map[shift_data][0].split_parent );\n\t\t\t\toverlapping_shifts_html += '<tr>';\n\t\t\t\toverlapping_shifts_html += '<td>' + parent_data.start_date + '</td>';\n\t\t\t\toverlapping_shifts_html += '<td>' + parent_data.start_time + ' - ' + parent_data.end_time + ' = ' + Global.getTimeUnit( parent_data.total_time ) + '</td>';\n\n\t\t\t\tlet table_row_break = false;\n\t\t\t\tfor ( let i = 0; i < shift_data_map[shift_data].length; i++ ) {\n\t\t\t\t\tif ( this.current_edit_record.overlap_type_id == 20 || ( shift_data_map[shift_data][i].split_state === 'new' || shift_data_map[shift_data][i].split_state === 'replaced' ) ) { //Split\n\t\t\t\t\t\tif ( table_row_break === true ) {\n\t\t\t\t\t\t\toverlapping_shifts_html += '</tr>';\n\t\t\t\t\t\t\toverlapping_shifts_html += '<tr>';\n\t\t\t\t\t\t\toverlapping_shifts_html += '<td>' + shift_data_map[shift_data][i].start_date + '</td>';\n\t\t\t\t\t\t\toverlapping_shifts_html += '<td></td>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlet modified_label = shift_data_map[shift_data][i].split_state === 'new' ? $.i18n._( 'New' ) : $.i18n._( 'Modified' );\n\t\t\t\t\t\tlet cell_class = shift_data_map[shift_data][i].is_absence ? 'overlap-absence' : '';\n\t\t\t\t\t\toverlapping_shifts_html += '<td class =\"' + cell_class + '\">' + shift_data_map[shift_data][i].start_time + ' - ' + shift_data_map[shift_data][i].end_time + ' = ' + Global.getTimeUnit( shift_data_map[shift_data][i].total_time ) + ' [' + modified_label + '] </td>';\n\t\t\t\t\t\tif ( table_row_break === true ) {\n\t\t\t\t\t\t\toverlapping_shifts_html += '</tr>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttable_row_break = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\toverlapping_shifts_html += '</tr>';\n\t\t\t}\n\n\t\t\tif ( Array.isArray( this.overlapping_shift_data['no_overlap'] ) && this.overlapping_shift_data['no_overlap'].length > 0 ) {\n\t\t\t\toverlapping_shifts_html += '<tr style=\"border-bottom: 15px solid transparent;\"></tr>'; //blank row for spacing\n\t\t\t\toverlapping_shifts_html += '<tr><th colspan=\"3\" style=\"text-align: center\">' + $.i18n._( 'New Shifts (Not Overlapping)' ) + '</th></tr>';\n\n\t\t\t\tif ( _.size( shift_data_map ) === 0 ) {\n\t\t\t\t\toverlapping_shifts_html += this.getOverlappingShiftHeaderHtml();\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0; i < this.overlapping_shift_data['no_overlap'].length; i++ ) {\n\t\t\t\t\tlet tr_class = this.current_edit_record.request_schedule_status_id == 20 ? 'overlap-absence' : '';\n\t\t\t\t\toverlapping_shifts_html += '<tr class=\"' + tr_class + '\">';\n\t\t\t\t\toverlapping_shifts_html += '<td>' + this.overlapping_shift_data['no_overlap'][i].start_date + '</td>';\n\t\t\t\t\toverlapping_shifts_html += '<td></td>';\n\t\t\t\t\toverlapping_shifts_html += '<td>' + this.overlapping_shift_data['no_overlap'][i].start_time + ' - ' + this.overlapping_shift_data['no_overlap'][i].end_time + ' = ' + Global.getTimeUnit( this.overlapping_shift_data['no_overlap'][i].total_time ) + '</td>';\n\t\t\t\t\toverlapping_shifts_html += '<tr>';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( this.current_edit_record.is_replace_with_open_shift == true && Array.isArray( this.overlapping_shift_data['open_replaced'] ) && this.overlapping_shift_data['open_replaced'].length > 0 ) {\n\t\t\t\toverlapping_shifts_html += '<tr style=\"border-bottom: 15px solid transparent;\"></tr>'; //blank row for spacing\n\t\t\t\toverlapping_shifts_html += '<tr><th colspan=\"3\" style=\"text-align: center\">' + $.i18n._( 'New Open Shifts' ) + '</th></tr>';\n\t\t\t\tfor ( let i = 0; i < this.overlapping_shift_data['open_replaced'].length; i++ ) {\n\t\t\t\t\toverlapping_shifts_html += '<tr>';\n\t\t\t\t\toverlapping_shifts_html += '<td>' + this.overlapping_shift_data['open_replaced'][i].start_date + '</td>';\n\t\t\t\t\toverlapping_shifts_html += '<td></td>';\n\t\t\t\t\toverlapping_shifts_html += '<td>' + this.overlapping_shift_data['open_replaced'][i].start_time + ' - ' + this.overlapping_shift_data['open_replaced'][i].end_time + ' = ' + Global.getTimeUnit( this.overlapping_shift_data['open_replaced'][i].total_time ) + '</td>';\n\t\t\t\t\toverlapping_shifts_html += '<tr>';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( this.overlapping_shift_data['original'].length > 0 || this.overlapping_shift_data['no_overlap'].length > 0 ) {\n\t\t\t\toverlapping_shifts_html += '<tr style=\"border-bottom: 15px solid transparent;\"></tr>'; //blank row for spacing\n\t\t\t\toverlapping_shifts_html += '<tr style=\"text-align: center\"> <th>' + $.i18n._( 'Total Shifts' ) + '</th><th>' + shifts_before + ' = ' + Global.getTimeUnit( shifts_before_total_time ) + '</th> <th>' + shifts_after + ' = ' + Global.getTimeUnit( shifts_after_total_time ) + '</th></tr>';\n\t\t\t} else {\n\t\t\t\toverlapping_shifts_html += '<tr><th colspan=\"3\" style=\"text-align: center\">' + $.i18n._( 'No New or Overlapping Shifts' ) + '</th>' + overlapping_shifts_html + '</tr>';\n\t\t\t}\n\n\t\t\toverlapping_shifts_html += '</table>';\n\t\t}\n\n\t\tif ( $this.overlapping_shift_info ) {\n\t\t\t$this.overlapping_shift_info.qtip( {\n\t\t\t\tshow: {\n\t\t\t\t\tevent: 'click',\n\t\t\t\t\tdelay: 10,\n\t\t\t\t\teffect: true\n\t\t\t\t},\n\t\t\t\thide: {\n\t\t\t\t\tevent: ['unfocus click'],\n\t\t\t\t},\n\t\t\t\tstyle: {\n\t\t\t\t\twidth: 525, //Dynamically changing the width causes display bugs when switching between Absence Policies and thereby widths.\n\t\t\t\t\tclasses: 'overlapping-info-display'\n\t\t\t\t},\n\t\t\t\tcontent: overlapping_shifts_html,\n\t\t\t} );\n\t\t}\n\t}\n\n\tgetOverlappingShiftHeaderHtml() {\n\t\treturn `<tr>\n\t\t\t\t\t<th style=\"text-align: center\">` + $.i18n._( 'Date' ) + `</th>\n\t\t\t\t\t<th style=\"text-align: center\">` + $.i18n._( 'Before' ) + `</th>\n\t\t\t\t\t<th style=\"text-align: center\">` + $.i18n._( 'After' ) + `</th>\n\t\t\t\t</tr>\n\t\t\t\t`;\n\t}\n\n\t// Creates the record shipped to the API at setMesssage\n\tuniformMessageVariable( records ) {\n\t\tvar msg = {};\n\n\t\tmsg.subject = this.edit_view_ui_dic['subject'].getValue();\n\t\tmsg.body = this.edit_view_ui_dic['body'].getValue();\n\t\tmsg.object_id = this.current_edit_record['id'];\n\t\tmsg.object_type_id = 50;\n\n\t\treturn msg;\n\t}\n\n\tgetRequestTabHtml() {\n\t\treturn `\n\t\t<div id=\"tab_request\" class=\"edit-view-tab-outside\">\n\t\t\t<div class=\"edit-view-tab\" id=\"tab_request_content_div\">\n\t\t\t\t<div class=\"first-column full-width-column\"></div>\n\t\t\t\t<div class=\"authorization-grid-div inside-grid full-width-column\">\n\t\t\t\t\t<div class=\"grid-top-border\"></div>\n\t\t\t\t\t<div class=\"grid-title separated-box\"></div>\n\t\t\t\t\t<table id=\"grid\"></table>\n\t\t\t\t\t<div class=\"bottom-div\">\n\t\t\t\t\t\t<div class=\"grid-bottom-border\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"separate full-width-column\"></div>\n\t\t\t\t<div class=\"second-column embedded-message-template full-width-column\" style=\"margin-left: 0\"></div>\n\t\t\t</div>\n\t\t</div>`;\n\t}\n}\n"],"names":["RequestViewCommonController","options","_","data","len","i","item","$","force","cancel_all","callback","$this","$record_id","Global","flag","doNext","afn","key","user_id","data_for_api","request_schedule","retval","update_schedule_total_time","advanced_field_names","start_time","end_time","schedulePolicyId","schedule_api","result","days","overall_total_time","total_time","type_id","request_schedule_status_id","date_stamp","policy_id","authorization_history","display_columns","column_filter","column_info","result_data","edit_record","clear_edit_view","filter","view_id","edit_view_file_name","tab_options","e","ui","editId","noRefreshUI","tab_model","form_item_input","widgetContainer","label","tab_request","tab_request_column1","value","form_item_sun_checkbox","form_item_mon_checkbox","form_item_tue_checkbox","form_item_wed_checkbox","form_item_thu_checkbox","form_item_fri_checkbox","form_item_sat_checkbox","sun","mon","tue","wed","thu","fri","sat","val","job_coder","job_item_coder","punch_tags","punch_tag_coder","iconName","temp_filter","grid_selected_id_array","grid_selected_length","selectedId","include_users","company_api","context_btn","overlapping_shifts_html","split_shifts","shifts_after","shifts_before","shifts_after_total_time","shifts_before_total_time","suggested_overlap_type_id","a","b","shift","shift_data_map","parent_shift","suggested_overlap_label","shift_data","parent_data","table_row_break","modified_label","cell_class","tr_class","records","msg"],"mappings":"8GAEO,MAAMA,UAAoC,kBAAmB,CACnE,YAAaC,EAAU,GAAK,CAC3BC,EAAE,SAAUD,EAAS,CACpB,sBAAuB,KACvB,+BAAgC,KAChC,oBAAqB,EACxB,GAEE,MAAOA,CAAO,CACd,CAED,uBAAwB,CAEvB,GAAM,KAAK,KAIX,KAAIE,EAAO,KAAK,KAAK,aAAc,MAAM,EAEzC,GAAMA,EAKN,QADIC,EAAMD,EAAK,OACLE,EAAI,EAAGA,EAAID,EAAKC,IAAM,CAC/B,IAAIC,EAAOH,EAAKE,CAAC,EAEZC,EAAK,WAAa,IACtBC,EAAG,MAAQD,EAAK,EAAE,EAAG,SAAU,iBAEhC,EACD,CAED,cAAeE,EAAOC,EAAYC,EAAW,CAC5C,UAAU,IAAK,OAAQ,iBACvB,IAAIC,EAAQ,KAGZ,GAAK,KAAK,qBAAuB,KAAK,oBAAoB,GACzD,IAAIC,EAAa,KAAK,oBAAoB,GAG3C,eAAe,6BAA+B,SACzC,KAAK,YAAc,CAACJ,EACxB,cAAc,iBAAkBK,EAAO,qBAAsB,KAAM,SAAUC,EAAO,CAE9EA,IAAS,IACbC,GAGL,GAEGA,IAGD,SAASA,GAAS,CACZ,CAACJ,EAAM,WAAaA,EAAM,wBAA0BA,EAAM,eAC9DA,EAAM,uBAAuB,WAAa,GAC1CA,EAAM,uBAAuB,iBAAkB,IAC/CA,EAAM,uBAAuB,iBAGxBA,EAAM,SAAWC,GACrB,mBAAmB,mBAAoBD,EAAM,oCAAqC,EAAC,EAAE,EACrFA,EAAM,wBAAyB,QAC/BA,EAAM,YAAaC,EAAY,IAC/BD,EAAM,YAAW,GAEjBA,EAAM,eAAc,EAIjBD,GACJA,IAGDC,EAAM,OAAQ,IAEdE,EAAO,kBAAiB,EACxB,YAAY,aAAY,EAExB,UAAU,QAAS,OAAQ,gBAE3B,CAED,CAED,4BAA6B,CAE5B,MAAK,GAAC,kBAAkB,SAAU,WAAY,SAAW,GACrD,EAAG,kBAAkB,SAAU,WAAY,MAAQ,GAAI,kBAAkB,SAAU,WAAY,UAAU,GAAM,kBAAkB,SAAU,WAAY,YAAc,GAKzK,CAED,kBAAmB,CAClB,KAAK,cAAa,CAClB,CAED,gBAAiBV,EAAO,CACvB,IAAIa,EAAM,KAAK,wBAEf,GAAK,KAAK,QAAU,yBAA4B,CAAC,OAAO,OAAQb,EAAK,mBAAqB,GAAIA,EAAK,qBAAuB,OAAO,SAEhI,OAAAa,EAAI,QAASC,GAAO,CACdd,EAAK,eAAgBc,IACzB,OAAOd,EAAKc,CAAG,CAEpB,GAEUd,EAGR,IAAIe,EAAU,eAAe,UAAU,GAClCL,EAAO,MAAO,KAAK,oBAAoB,OAAO,IAClDK,EAAU,KAAK,oBAAoB,SAEpC,IAAIC,EAAe,CAAE,QAAWD,GAC5BE,EAAmB,CAAA,EAIvB,QAAUH,KAAO,KAAK,oBAChBA,GAAO,cAAgB,KAAK,iBAAiBA,CAAG,IACpDE,EAAa,WAAa,KAAK,iBAAiBF,CAAG,EAAE,YAGjDD,EAAI,QAASC,CAAK,EAAG,GACpBA,GAAO,sBACXG,EAAiB,GAAQ,KAAK,oBAAoB,oBACvCH,GAAO,6BAElBG,EAAiB,UAAe,KAAK,iBAAiB,2BAA2B,WACtE,KAAK,iBAAiBH,CAAG,IACpCG,EAAiBH,CAAG,EAAI,KAAK,iBAAiBA,CAAG,EAAE,YAEzCA,GAAO,qBAAuBA,GAAO,yBAA2BA,GAAO,qBAGlFE,EAAaF,CAAG,EAAI,KAAK,oBAAoBA,CAAG,GAMlD,OAAKJ,EAAO,kBAAmB,GAAI,KAAQ,kBAAkB,SAAU,UAAW,iBAAoBA,EAAO,QAASO,CAAkB,GAAI,MAAa,KAAK,oBAAoB,SAAW,IAAM,KAAK,oBAAoB,SAAW,MACtOD,EAAa,iBAAmBC,GAE1BD,CACP,CAED,iBAAkBhB,EAAO,CACxB,GAAKU,EAAO,MAAOV,CAAM,GAAIU,EAAO,MAAOV,EAAK,kBAAqB,CACpE,QAAUc,KAAOd,EAAK,iBAChBc,GAAO,KACXd,EAAK,oBAAyBA,EAAK,iBAAiB,GACzCc,GAAO,YAClBd,EAAK,2BAAgCA,EAAK,iBAAiB,UAChD,OAASA,EAAKc,CAAG,EAAO,MACnCd,EAAKc,CAAG,EAAId,EAAK,iBAAiBc,CAAG,GAMvC,OAAOd,EAAK,iBACZ,KAAK,qBAAuB,EAC/B,MACG,KAAK,qBAAuB,GAI7B,IAAIkB,EAASlB,EAEb,OAAOkB,CACP,CAED,mBAAoBC,EAA6B,CAChD,GACCT,EAAO,kBAAiB,GAAM,KAC5B,kBAAkB,SAAU,UAAW,cAAgB,GACnD,OAAO,OAAQ,KAAK,oBAAoB,mBAAmB,GAAM,KAAK,oBAAoB,qBAAuB,OAAO,SAAW,KAAK,oBAAoB,qBAAuB,OAAO,gBAC3L,KAAK,oBAAoB,SAAW,IAAM,KAAK,oBAAoB,SAAW,MAAU,CAAC,KAAK,sBAAwB,KAAK,QAC/H,CACD,IAAIU,EAAuB,KAAK,wBAChC,GAAK,KAAK,iBAAmB,CAC5B,QAAUlB,EAAI,EAAGA,EAAIkB,EAAqB,OAAQlB,IAAM,CACvD,GAAKkB,EAAqBlB,CAAC,GAAK,qBAAuB,KAAK,iBAAiB,4BAA8B,KAAK,iBAAiB,2BAA2B,SAAQ,GAAM,GAAK,CAC9K,KAAK,iBAAiBkB,EAAqBlB,CAAC,CAAC,EAAE,QAAS,4BAA6B,OACrF,QACA,CACI,KAAK,iBAAiBkB,EAAqBlB,CAAC,CAAC,IAC5CkB,EAAqBlB,CAAC,GAAK,aAAe,CAAC,KAAK,eACpD,KAAK,iBAAiBkB,EAAqBlB,CAAC,CAAC,EAAE,QAAS,4BAA6B,OAC1EkB,EAAqBlB,CAAC,GAAK,iBAAmB,CAAC,KAAK,mBAC/D,KAAK,iBAAiBkB,EAAqBlB,CAAC,CAAC,EAAE,QAAS,4BAA6B,OAC1EkB,EAAqBlB,CAAC,GAAK,UAAY,CAAC,KAAK,YACxD,KAAK,iBAAiBkB,EAAqBlB,CAAC,CAAC,EAAE,QAAS,4BAA6B,OAC1EkB,EAAqBlB,CAAC,GAAK,eAAiB,CAAC,KAAK,iBAC7D,KAAK,iBAAiBkB,EAAqBlB,CAAC,CAAC,EAAE,QAAS,4BAA6B,OAC1EkB,EAAqBlB,CAAC,GAAK,gBAAkB,CAAC,KAAK,kBAC9D,KAAK,iBAAiBkB,EAAqBlB,CAAC,CAAC,EAAE,QAAS,4BAA6B,OAC1EkB,EAAqBlB,CAAC,GAAK,qBAAuB,CAAC,KAAK,WACnE,KAAK,iBAAiBkB,EAAqBlB,CAAC,CAAC,EAAE,QAAS,4BAA6B,OAErF,KAAK,iBAAiBkB,EAAqBlB,CAAC,CAAC,EAAE,QAAS,4BAA6B,OAGvF,CAEI,KAAK,iBAAiB,MAC1B,KAAK,iBAAiB,WAAW,QAAS,0BAA0B,EAAG,OAGnE,KAAK,iBAAiB,mBACrB,KAAK,YAAc,IAAQ,KAAK,QAAU,WAC9C,KAAK,iBAAiB,kBAAkB,QAAS,0BAA0B,EAAG,OAI3E,KAAK,oBAAoB,SAAW,IAAM,KAAK,oBAAoB,SAAW,GAC7E,KAAK,iBAAiB,aAC1B,KAAK,iBAAiB,WAAW,QAAS,0BAA0B,EAAG,OACvE,KAAK,iBAAiB,gBAAgB,QAAS,0BAA0B,EAAG,OAC5E,KAAK,iBAAiB,2BAA2B,QAAS,0BAA0B,EAAG,QAGnFiB,GAA8B,IAClC,KAAK,qBAAoB,CAG3B,CACJ,MACQ,KAAK,iBAAiB,YAC1B,KAAK,iBAAiB,WAAW,QAAS,0BAA0B,EAAG,OAExE,KAAK,mBAAkB,CAExB,CAED,oBAAqB,CACpB,IAAIC,EAAuB,KAAK,wBAChC,GAAK,KAAK,iBAAmB,CACvB,KAAK,iBAAiB,4BAC1B,KAAK,iBAAiB,2BAA2B,SAAU,EAAE,EAG9D,QAAUlB,EAAI,EAAGA,EAAIkB,EAAqB,OAAQlB,IAC5C,KAAK,iBAAiBkB,EAAqBlB,CAAC,CAAC,GACjD,KAAK,iBAAiBkB,EAAqBlB,CAAC,CAAC,EAAE,QAAS,4BAA6B,OAGlF,KAAK,iBAAiB,MAC1B,KAAK,iBAAiB,KAAK,QAAS,0BAA0B,EAAG,MAElE,CACD,CAED,uBAAwB,CACvB,MAAO,CACN,aACA,6BACA,sBACA,aACA,WAEA,MACA,MACA,MACA,MACA,MACA,MACA,MAEA,aACA,WACA,aAEA,qBACA,oBACA,YACA,gBACA,SACA,cACA,eAEA,kBACA,iBACA,SACA,aACA,MACA,WACA,oBAEA,kBACA,4BACH,CACE,CAED,sBAAuB,CACtB,GAAKQ,EAAO,kBAAiB,GAAM,KAC7B,KAAK,oBAAoB,SAAW,IAAM,KAAK,oBAAoB,SAAW,KAC9E,KAAK,kBAAoB,KAAK,iBAAiB,WACnD,CAED,IAAIW,EAAa,GACZ,KAAK,oBAAoB,YAAiB,KAAK,oBAAoB,aACvEA,EAAa,KAAK,oBAAoB,WAAgB,IAAM,KAAK,oBAAoB,YAGtF,IAAIC,EAAW,GACV,KAAK,oBAAoB,YAAiB,KAAK,oBAAoB,WACvEA,EAAW,KAAK,oBAAoB,WAAgB,IAAM,KAAK,oBAAoB,UAGpF,IAAIC,EAAqB,KAAK,oBAAoB,mBAA0B,KAAK,oBAAoB,mBAAwB,KACzHR,EAAU,KAAK,oBAAoB,QAMvC,GAJK,OAAOA,EAAW,KAAe,eAAe,aAAY,EAAG,KACnEA,EAAU,eAAe,aAAc,EAAC,IAGpCM,GAAcC,EAAW,CAC7B,IAAIE,EAAe,MAAM,YACrBC,EAASD,EAAa,qBAAsBH,EAAYC,EAAUC,EAAkBR,EAAS,CAAE,MAAO,EAAO,CAAA,EAC5GU,GAAUA,EAAO,QAAS,GAAIA,EAAO,UAAS,EAClD,KAAK,WAAaA,EAAO,YAEzB,KAAK,WAAa,EAGnB,IAAIC,EAAO,EACN,KAAK,oBAAoB,YAAc,KAAK,oBAAoB,WACpEA,EAAOhB,EAAO,cAAe,KAAK,oBAAoB,WAAY,KAAK,oBAAoB,SAAU,KAAK,oBAAoB,IAAK,KAAK,oBAAoB,IAAK,KAAK,oBAAoB,IAAK,KAAK,oBAAoB,IAAK,KAAK,oBAAoB,IAAK,KAAK,oBAAoB,IAAK,KAAK,oBAAoB,GAAG,GAGtT,IAAIiB,EAAqB,KAAK,WAAaD,EAC3CtB,EAAE,aAAa,EAAE,KAAMA,EAAE,KAAK,EAAG,mBAAoBsB,EAAMhB,EAAO,YAAaiB,CAAkB,CAAI,CAAA,EAErG,KAAK,oBAAoB,WAAgB,KAAK,WAC9C,IAAIC,EAAalB,EAAO,YAAa,KAAK,UAAU,EACpD,KAAK,iBAAiB,WAAc,SAAUkB,CAAU,EACxD,KAAK,iBAAiB,WAAW,QAAS,0BAA0B,EAAG,MAC3E,MACS,KAAK,iBAAiB,YAC1B,KAAK,iBAAiB,WAAW,QAAS,0BAA0B,EAAG,MAG5E,MACQ,KAAK,iBAAiB,YAC1B,KAAK,iBAAiB,WAAW,QAAS,0BAA0B,EAAG,OAIzE,KAAK,yBAAwB,CAC7B,CAED,wBAAyB,CACnBlB,EAAO,kBAAmB,GAAI,KAClC,KAAK,uBAAsB,EAC3B,KAAK,oBAAmB,EAEzB,CAED,qBAAsB,CAChB,kBAAkB,wBAAyB,yBAA4B,KAAK,qBAAuB,KAAK,oBAAoB,4BAA8B,GAC9J,KAAK,cAAe,8BAEpB,KAAK,cAAe,6BAErB,CAED,uBAAwBmB,EAAU,CACjC,GAAK,KAAK,iBAAiB,4BAA8B,KAAK,iBAAiB,kBAAoB,CAClG,IAAIA,EAAU,KAAK,iBAAiB,QAAU,KAAK,iBAAiB,QAAQ,SAAU,EAAG,KAAK,oBAAoB,QAC9GC,EAA6B,KAAK,iBAAiB,2BAA2B,SAAU,EAEvFA,GAA8B,KAAQD,GAAW,IAAMA,GAAW,KACtE,KAAK,iBAAiB,kBAAkB,QAAS,0BAA0B,EAAG,QACvE,KAAK,QAAU,WAAa,KAAK,aAAgB,IACvD,KAAK,yBAAwB,IAG9B,KAAK,iBAAiB,kBAAkB,QAAS,0BAA0B,EAAG,OAC9E,KAAK,iBAAiB,kBAAkB,QAAS,0BAA0B,EAAG,OAE/E,CACD,CAED,oBAAqB,CACfnB,EAAO,kBAAiB,GAAM,IAAM,kBAAkB,SAAU,UAAW,kBAC/E,KAAK,iBAAiB,WAAW,SAAU,KAAK,oBAAoB,YACpE,KAAK,oBAAoB,WAAa,KAAK,oBAAoB,WAEhE,CAED,oBAAqB,CACpB,KAAK,iBAAiB,WAAW,SAAU,KAAK,oBAAoB,YACpE,KAAK,oBAAoB,WAAa,KAAK,oBAAoB,UAC/D,CAED,qBAAsB,CACrB,GAAO,OAAK,YAAc,KAAK,QAAU,WAAeA,EAAO,MAAO,KAAK,mBAAmB,GAAM,IAIpG,IAAO,KAAK,QAAU,WAAa,KAAK,YAAc,KACrD,KAAK,oBAAoB,oBACvB,kBAAkB,SAAU,UAAW,cAAgB,GAAM,OAAO,OAAQ,KAAK,oBAAoB,mBAAqB,GAAI,KAAK,oBAAoB,qBAAuB,OAAO,SAAW,KAAK,oBAAoB,qBAAuB,OAAO,eACzP,eAAe,UAAU,IACzB,KAAK,oBAAoB,YACzB,KAAK,oBAAoB,YAAc,GACvC,KAAK,oBAAoB,WAAa,CAEtC,IAAIgB,EAAO,EACN,KAAK,oBAAoB,YAAc,KAAK,oBAAoB,WACpEA,EAAOhB,EAAO,cAAe,KAAK,oBAAoB,WAAY,KAAK,oBAAoB,SAAU,KAAK,oBAAoB,IAAK,KAAK,oBAAoB,IAAK,KAAK,oBAAoB,IAAK,KAAK,oBAAoB,IAAK,KAAK,oBAAoB,IAAK,KAAK,oBAAoB,IAAK,KAAK,oBAAoB,GAAG,GAGtT,IAAIF,EAAQ,KACRO,EAAU,KAAK,oBAAoB,QACnCa,EAAa,KAAK,oBAAoB,WAAaF,EACnDK,EAAa,KAAK,oBAAoB,WACtCC,EAAY,KAAK,oBAAoB,kBAAoB,KAAK,oBAAoB,kBAAoB,OAAO,QAE5GjB,GAAWgB,GAAcH,GAC7B,KAAK,mBAAmB,iCACvBI,EACAjB,EACAgB,EACAH,EACA,CACC,SAAU,SAAUH,EAAS,CACvBjB,EAAM,kBAAoBA,EAAM,iBAAiB,oBACrDA,EAAM,kBAAmBiB,EAAQM,GAC5BN,GAAUjB,EAAM,+BACpBA,EAAM,iBAAiB,kBAAkB,QAAS,0BAA0B,EAAG,OAE/EA,EAAM,iBAAiB,kBAAkB,QAAS,0BAA0B,EAAG,OAGjF,CACD,CACN,CAGA,MAAc,KAAK,oBAAoB,mBAAqB,IAAS,KAAK,oBAAoB,mBAAqB,OAAO,UAClH,KAAK,iBAAiB,mBAC1B,KAAK,iBAAiB,kBAAkB,QAAS,0BAA0B,EAAG,MAGhF,CAED,mCAAoCyB,EAAwB,CAE3D,IAAIC,EAAkB,CAAA,EACjBD,EACC,KAAK,sBAAsB,6BAC/BC,EAAkB,qBAAqB,gDAGnC,KAAK,OACTA,EAAkB,KAAK,KAAK,aAAc,UAAU,GAGtD,IAAIC,EAAgB,CAAA,EAUpB,GATAA,EAAc,SAAW,GACzBA,EAAc,GAAK,GACnBA,EAAc,SAAW,GACzBA,EAAc,OAAS,GACvBA,EAAc,WAAa,GAC3BA,EAAc,UAAY,GAC1BA,EAAc,QAAU,GACxBA,EAAc,UAAY,GAErBD,EAGJ,QAFIjC,EAAMiC,EAAgB,OAEhBhC,EAAI,EAAGA,EAAID,EAAKC,IAAM,CAC/B,IAAIkC,EAAcF,EAAgBhC,CAAC,EACnCiC,EAAcC,EAAY,IAAI,EAAI,EAClC,CAGF,OAAOD,CACP,CAED,eAAgB,CAEf,MAAK,qBAAkB,SAAU,MAAO,SAAW,GAClD,kBAAkB,SAAU,QAAS,YAItC,CAED,mBAAoB,CAEnB,MAAK,oBAAkB,SAAU,QAAS,eAAe,CAIzD,CAED,oBAAqB,CAEpB,MAAK,oBAAkB,SAAU,QAAS,gBAAgB,CAI1D,CAED,kBAAmB,CAElB,MAAK,oBAAkB,SAAU,QAAS,aAAa,CAIvD,CAED,sBAAuB,CAEtB,MAAK,oBAAkB,SAAU,QAAS,iBAAiB,CAI3D,CAED,yBAA0BE,EAAc,CACvC,YAAK,oBAAsB,KAAK,iBAAkBA,EAAY,CAAC,GAC1D,KAAK,qBAAuB,KAAK,oBAAoB,aACzD,KAAK,oBAAoB,WAAa3B,EAAO,YAAa,KAAK,oBAAoB,aAG7E2B,CACP,CAED,kBAAmBA,EAAc,CAC3B3B,EAAO,MAAO,KAAK,oBAAoB,UAAY,GAAI,KAAK,eAChE,KAAK,cAAc,KAAM,cAAc,EAAG,KAAM,eAAe,EAAG,OAGnE,KAAK,aAAY,EACjB,KAAK,gBAAe,EAGpB,KAAK,uBAAsB,EAE3B,IAAIF,EAAQ,KACZ,uBAAgB,KAAM,KAAK,oBAAoB,GAAI,GAAI,KAAM,KAAK,UAAW,KAAK,cAAe,KAAK,iBAAkB,UAAW,CAClIA,EAAM,sBAAwB,qBAAqB,KAAMA,CAAK,EAC9DA,EAAM,YAAW,CACpB,GACS,KAAK,4BACZ,CAED,YAAa8B,EAAaC,EAAkB,CACtCA,GACJ,KAAK,cAAa,EAEnB,MAAM,YAAaD,EACnB,CAED,qBAAsB,CACrB,OAAM,KAAK,yBAIX,KAAK,wBAAwB,iBAAmB,SAAUE,EAAS,CAClE,OAAAA,EAAO,qBAA0B,CAChC,QAAW,CAAC,KAAK,mBAAmB,EAAE,EACtC,iBAAoB,CAAC,KAAK,mBAAmB,mBAAmB,CACpE,EAEUA,CACV,EAES,IAZC,EAaR,CAMD,iBAAkB,CACjB,KAAK,mBAAkB,CACvB,CAED,eAAgBC,EAASC,EAAsB,CAC9ChC,EAAO,cAAa,EACpB,UAAU,IAAK,OAAQ,QACvB,UAAU,KAAI,EACd,IAAIF,EAAQ,KAEP,KAAK,WACT,KAAK,UAAU,SAGhB,KAAK,UAAYJ,EAAGM,EAAO,eAAgB+B,EAASC,EAAqB,KAAM,EAAI,GACnF,KAAK,cAAgBtC,EAAG,KAAK,UAAU,KAAM,oBAAoB,GAGjE,KAAK,cAAc,KAAM,KAAM,KAAK,MAAQ,kBAc5CM,EAAO,iBAAkB,EAAC,OAAQ,KAAK,SAAS,EAChD,KAAK,mBAAoB,mBAAmB,UAEvC,KAAK,YACT,eAAe,6BAA+B,OAC9C,KAAK,YAAW,GACL,KAAK,UAChB,eAAe,6BAA+B,OAC9C,KAAK,gBAAe,EACpB,mBAAmB,mBAAoB,KAAK,oCAAqC,EAAC,EAAE,EACpF,KAAK,iBAAkB,KAGxBF,EAAM,qBAAoB,CAC1B,CAED,kBAAmB,CAClB,IAAIA,EAAQ,KACRmC,EAAc,CACjB,SAAU,SAAUC,EAAGC,EAAK,CAC3BrC,EAAM,UAAWoC,EAAGC,EACpB,CACJ,EAEE,MAAM,iBAAkBF,EACxB,CAED,YAAaG,EAAQC,EAAc,CAClC,KAAK,wBAAyB,QAC9B,KAAK,eAAgB,KAAK,OAAQ,KAAK,aAAa,EACpD,KAAK,aAAY,EAEjB,KAAK,iBAAiB,KAAK,SAAU,EAAE,EAEvC,KAAK,YAAW,CAChB,CAED,aAAc,CACb,MAAM,gBAAe,EAErB,IAAIvC,EAAQ,KAERwC,EAAY,CACf,YAAe,CACd,MAAS5C,EAAE,KAAK,EAAG,SAAW,EAC9B,cAAiB,KAAK,kBAAmB,CACzC,EACD,UAAa,EAChB,EACE,KAAK,YAAa4C,GAElB,KAAK,WAAW,UAAW,CAC1B,UAAW,MAAM,WACjB,GAAI,KAAK,YAAc,cACvB,yBAA0B,GAC1B,YAAa,iBACb,gBAAiB,GACjB,mBAAoB,EACvB,GAEE,KAAK,cAAa,EAElB,IAAIC,EACAC,EACAC,EAGAC,EAAc,KAAK,cAAc,KAAM,cAAc,EACrDC,EAAsBD,EAAY,KAAM,eAAe,EAC3D,KAAK,eAAe,CAAC,EAAI,GACzB,KAAK,eAAe,CAAC,EAAE,KAAMC,CAAmB,EAGhDJ,EAAkBvC,EAAO,iBAAkB,aAAa,IAAI,EAC5DuC,EAAgB,MAAO,CAAE,MAAO,WAAa,CAAA,EAC7C,KAAK,qBAAsB7C,EAAE,KAAK,EAAG,UAAY,EAAE6C,EAAiBI,GAGpE,IAAIJ,EAAkBvC,EAAO,iBAAkB,aAAa,IAAI,EAChEuC,EAAgB,MAAO,CAAE,MAAO,OAAQ,UAAW,EAAK,GACxD,KAAK,qBAAsB7C,EAAE,KAAK,EAAG,MAAQ,EAAE6C,EAAiBI,GAGhE,IAAIJ,EAAkBvC,EAAO,iBAAkB,aAAa,IAAI,EAIhE,GAHAuC,EAAgB,MAAO,CAAE,MAAO,YAAc,CAAA,EAC9C,KAAK,qBAAsB7C,EAAE,KAAK,EAAG,MAAQ,EAAE6C,EAAiBI,GAE3D3C,EAAO,kBAAmB,GAAI,GAAK,CAGvC,IAAIuC,EAAkBvC,EAAO,iBAAkB,aAAa,SAAS,EACrEuC,EAAgB,UAAW,CAAE,MAAO,6BAA8B,UAAW,EAAK,GAClFA,EAAgB,cAAe,CAAE,GAAI,UAAW,GAAI,QAAQ,GAC5D,KAAK,qBAAsB7C,EAAE,KAAK,EAAG,QAAU,EAAE6C,EAAiBI,GAClEJ,EAAgB,KAAM,SAAU,SAAUL,EAAI,CAC7CpC,EAAM,uBAAsB,CAChC,GAGGyC,EAAkBvC,EAAO,iBAAkB,aAAa,WAAW,EACnEuC,EAAgB,UAAW,CAC1B,UAAW,MAAM,iBACjB,yBAA0B,GAC1B,YAAa,kBACb,UAAW,GACX,MAAO,oBACP,mBAAoB,SAAUT,EAAS,CACtC,OAAOhC,EAAM,uBAAwBgC,EACrC,EACD,qBAAsB,SAAUc,EAAQ,CAEvC9C,EAAM,+BAAiC8C,EACvC9C,EAAM,yBAAwB,CAC9B,CACL,GACG,KAAK,qBAAsBJ,EAAE,KAAK,EAAG,gBAAkB,EAAE6C,EAAiBI,GAG1EJ,EAAkBvC,EAAO,iBAAkB,aAAa,IAAI,EAC5DuC,EAAgB,MAAO,CAAE,MAAO,mBAAqB,CAAA,EACrDC,EAAkB9C,EAAG,4DACrB,KAAK,uBAAyBA,EAAG,8EACjC8C,EAAgB,OAAQD,GACxBC,EAAgB,OAAQ,KAAK,wBAC7B,KAAK,qBAAsB9C,EAAE,KAAK,EAAG,qBAAuB6C,EAAiBI,EAAqB,GAAIH,EAAiB,EAAI,EAG3HD,EAAkBvC,EAAO,iBAAkB,aAAa,WAAW,EACnEuC,EAAgB,YAAa,CAAE,MAAO,YAAc,CAAA,EACpD,KAAK,qBAAsB7C,EAAE,KAAK,EAAG,YAAY,EAAI6C,EAAiBI,EAAqB,IAG3FJ,EAAkBvC,EAAO,iBAAkB,aAAa,WAAW,EACnEuC,EAAgB,YAAa,CAAE,MAAO,UAAY,CAAA,EAClD,KAAK,qBAAsB7C,EAAE,KAAK,EAAG,UAAU,EAAI6C,EAAiBI,EAAqB,IAGzF,IAAIE,EAAyB7C,EAAO,iBAAkB,aAAa,QAAQ,EAC3E6C,EAAuB,UAAW,CAAE,MAAO,KAAO,CAAA,EAElD,IAAIC,EAAyB9C,EAAO,iBAAkB,aAAa,QAAQ,EAC3E8C,EAAuB,UAAW,CAAE,MAAO,KAAO,CAAA,EAElD,IAAIC,EAAyB/C,EAAO,iBAAkB,aAAa,QAAQ,EAC3E+C,EAAuB,UAAW,CAAE,MAAO,KAAO,CAAA,EAElD,IAAIC,EAAyBhD,EAAO,iBAAkB,aAAa,QAAQ,EAC3EgD,EAAuB,UAAW,CAAE,MAAO,KAAO,CAAA,EAElD,IAAIC,EAAyBjD,EAAO,iBAAkB,aAAa,QAAQ,EAC3EiD,EAAuB,UAAW,CAAE,MAAO,KAAO,CAAA,EAElD,IAAIC,EAAyBlD,EAAO,iBAAkB,aAAa,QAAQ,EAC3EkD,EAAuB,UAAW,CAAE,MAAO,KAAO,CAAA,EAElD,IAAIC,EAAyBnD,EAAO,iBAAkB,aAAa,QAAQ,EAC3EmD,EAAuB,UAAW,CAAE,MAAO,KAAO,CAAA,EAElDX,EAAkB9C,EAAG,eAErB,IAAI0D,EAAM1D,EAAG,mCAAuCA,EAAE,KAAK,EAAG,KAAO,EAAG,kBACpE2D,EAAM3D,EAAG,mCAAuCA,EAAE,KAAK,EAAG,KAAO,EAAG,kBACpE4D,EAAM5D,EAAG,mCAAuCA,EAAE,KAAK,EAAG,KAAO,EAAG,kBACpE6D,EAAM7D,EAAG,mCAAuCA,EAAE,KAAK,EAAG,KAAO,EAAG,kBACpE8D,EAAM9D,EAAG,mCAAuCA,EAAE,KAAK,EAAG,KAAO,EAAG,kBACpE+D,EAAM/D,EAAG,mCAAuCA,EAAE,KAAK,EAAG,KAAO,EAAG,kBACpEgE,EAAMhE,EAAG,mCAAuCA,EAAE,KAAK,EAAG,KAAO,EAAG,kBAwCxE,GAtCA0D,EAAI,OAAQP,GACZQ,EAAI,OAAQP,GACZQ,EAAI,OAAQP,GACZQ,EAAI,OAAQP,GACZQ,EAAI,OAAQP,GACZQ,EAAI,OAAQP,GACZQ,EAAI,OAAQP,GAEZX,EAAgB,OAAQY,GACxBZ,EAAgB,OAAQa,GACxBb,EAAgB,OAAQc,GACxBd,EAAgB,OAAQe,GACxBf,EAAgB,OAAQgB,GACxBhB,EAAgB,OAAQiB,GACxBjB,EAAgB,OAAQkB,GAExBlB,EAAgB,SAAU,oCAC1B,KAAK,qBAAsB9C,EAAE,KAAK,EAAG,gBAAkB,EAAE,CAACmD,EAAwBC,EAAwBC,EAAwBC,EAAwBC,EAAwBC,EAAwBC,CAAsB,EAAGR,EAAqB,GAAIH,EAAiB,GAAO,IAGpRD,EAAkBvC,EAAO,iBAAkB,aAAa,WAAW,EACnEuC,EAAgB,YAAa,CAAE,MAAO,YAAc,CAAA,EACpD,KAAK,qBAAsB7C,EAAE,KAAK,EAAG,IAAM,EAAE6C,EAAiBI,GAG9DJ,EAAkBvC,EAAO,iBAAkB,aAAa,WAAW,EACnEuC,EAAgB,YAAa,CAAE,MAAO,UAAY,CAAA,EAClD,KAAK,qBAAsB7C,EAAE,KAAK,EAAG,KAAO,EAAE6C,EAAiBI,GAG/DJ,EAAkBvC,EAAO,iBAAkB,aAAa,IAAI,EAC5DuC,EAAgB,MAAO,CAAE,MAAO,YAAc,CAAA,EAC9CC,EAAkB9C,EAAG,oCACrB+C,EAAQ/C,EAAG,4DACX8C,EAAgB,OAAQD,GACxBC,EAAgB,OAAQC,GACxB,KAAK,qBAAsB/C,EAAE,KAAK,EAAG,OAAS,EAAE6C,EAAiBI,EAAqB,GAAIH,CAAe,EAElGxC,EAAO,kBAAmB,GAAI,IAAQ,KAAK,2BAA4B,GAAI,GAAO,CAExF,IAAIuC,EAAkBvC,EAAO,iBAAkB,aAAa,SAAS,EACrEuC,EAAgB,UAAW,CAAE,MAAO,kBAAmB,UAAW,EAAK,GACvEA,EAAgB,cAAe,KAAK,oBACpCC,EAAkB9C,EAAG,4DACrB,KAAK,uBAAyBA,EAAG,sMACjC8C,EAAgB,OAAQD,GACxBC,EAAgB,OAAQ,KAAK,wBAC7B,KAAK,qBAAsB9C,EAAE,KAAK,EAAG,wBAA0B6C,EAAiBI,EAAqB,GAAIH,EAAiB,EAAI,EAE9HD,EAAkBvC,EAAO,iBAAkB,aAAa,QAAQ,EAChEuC,EAAgB,UAAW,CAAE,MAAO,4BAA8B,CAAA,EAElEC,EAAkB9C,EAAG,oCACrB+C,EAAQ/C,EAAG,sCAA0CA,EAAE,KAAK,EAAG,gBAAmB,aAClF8C,EAAgB,OAAQD,GACxBC,EAAgB,OAAQC,GAExB,KAAK,qBAAsB/C,EAAE,KAAK,EAAG,qBAAuB6C,EAAiBI,EAAqB,GAAIH,EAAiB,EAAI,CAE3H,CA4CD,GAzCAD,EAAkBvC,EAAO,iBAAkB,aAAa,WAAW,EACnEuC,EAAgB,UAAW,CAC1B,UAAW,MAAM,kBACjB,yBAA0B,GAC1B,YAAa,kBACb,mBAAoB,GACpB,UAAW,GACX,MAAO,oBACX,GACG,KAAK,qBAAsB7C,EAAE,KAAK,EAAG,iBAAmB,EAAE6C,EAAiBI,GAG3EJ,EAAkBvC,EAAO,iBAAkB,aAAa,WAAW,EACnEuC,EAAgB,UAAW,CAC1B,UAAW,MAAM,UACjB,yBAA0B,GAC1B,YAAa,gBACb,mBAAoB,GACpB,UAAW,GACX,MAAO,WACX,GACG,KAAK,qBAAsB7C,EAAE,KAAK,EAAG,QAAU,EAAE6C,EAAiBI,GAC5D,KAAK,gBACV,KAAK,cAAe,aAIrBJ,EAAkBvC,EAAO,iBAAkB,aAAa,WAAW,EACnEuC,EAAgB,UAAW,CAC1B,UAAW,MAAM,cACjB,yBAA0B,GAC1B,YAAa,oBACb,mBAAoB,GACpB,UAAW,GACX,MAAO,eACX,GACG,KAAK,qBAAsB7C,EAAE,KAAK,EAAG,YAAc,EAAE6C,EAAiBI,GAChE,KAAK,oBACV,KAAK,cAAe,iBAGhB3C,EAAO,kBAAmB,GAAI,GAAK,CAEvCuC,EAAkBvC,EAAO,iBAAkB,aAAa,WAAW,EAEnEuC,EAAgB,UAAW,CAC1B,UAAW,MAAM,OACjB,yBAA0B,GAC1B,YAAa,aACb,mBAAoB,GACpB,UAAW,GACX,qBAAwB,SAAUoB,EAAM,CAElCA,GACJC,EAAU,SAAUD,EAAI,UAE/B,EACK,MAAO,SACP,YAAa,CACZ,CAAE,MAAO,KAAM,MAAO3D,EAAO,YAAc,EAC3C,CAAE,MAAO,KAAM,MAAOA,EAAO,aAAe,CAC5C,CACN,GAEIwC,EAAkB9C,EAAG,oCAErB,IAAIkE,EAAY5D,EAAO,iBAAkB,aAAa,UAAU,EAChE4D,EAAU,WAAY,CAAE,MAAO,mBAAoB,oBAAqB,EAAI,GAC5EA,EAAU,SAAU,aAEpBpB,EAAgB,OAAQoB,GACxBpB,EAAgB,OAAQD,GACxB,KAAK,qBAAsB7C,EAAE,KAAK,EAAG,KAAO,EAAE,CAAC6C,EAAiBqB,CAAS,EAAGjB,EAAqB,GAAIH,EAAiB,EAAI,EAEpH,KAAK,aACV,KAAK,cAAe,UAIrBD,EAAkBvC,EAAO,iBAAkB,aAAa,WAAW,EAEnEuC,EAAgB,UAAW,CAC1B,UAAW,MAAM,WACjB,yBAA0B,GAC1B,YAAa,kBACb,mBAAoB,GACpB,UAAW,GACX,qBAAwB,SAAUoB,EAAM,CAElCA,GACJE,EAAe,SAAUF,EAAI,UAEpC,EACK,MAAO,cACP,YAAa,CACZ,CAAE,MAAO,KAAM,MAAO3D,EAAO,YAAc,EAC3C,CAAE,MAAO,KAAM,MAAOA,EAAO,aAAe,CAC5C,CACN,GAEIwC,EAAkB9C,EAAG,oCAErB,IAAImE,EAAiB7D,EAAO,iBAAkB,aAAa,UAAU,EACrE6D,EAAe,WAAY,CAAE,MAAO,wBAAyB,oBAAqB,EAAI,GACtFA,EAAe,SAAU,aAEzBrB,EAAgB,OAAQqB,GACxBrB,EAAgB,OAAQD,GACxB,KAAK,qBAAsB7C,EAAE,KAAK,EAAG,MAAQ,EAAE,CAAC6C,EAAiBsB,CAAc,EAAGlB,EAAqB,GAAIH,EAAiB,EAAI,EAE1H,KAAK,kBACV,KAAK,cAAe,eAIrBD,EAAkBvC,EAAO,iBAAkB,aAAa,WAAW,EAEnEuC,EAAgB,UAAW,CAC1B,UAAW,MAAM,YACjB,yBAA0B,GAC1B,YAAa,mBACb,mBAAoB,GACpB,UAAW,GACX,qBAA0BuB,GAAgB,CACpCA,GACJ,KAAK,gCAAiCA,EAE7C,EACK,MAAO,cACZ,GAEItB,EAAkB9C,EAAG,oCAErB,IAAIqE,EAAkB/D,EAAO,iBAAkB,aAAa,UAAU,EACtE+D,EAAgB,WAAY,CAAE,MAAO,yBAA0B,oBAAqB,EAAI,GACxFA,EAAgB,SAAU,aAE1BvB,EAAgB,OAAQuB,GACxBvB,EAAgB,OAAQD,GACxB,KAAK,qBAAsB7C,EAAE,KAAK,EAAG,YAAc,EAAE,CAAC6C,EAAiBwB,CAAe,EAAGpB,EAAqB,GAAIH,EAAiB,EAAI,EAEjI,KAAK,mBACV,KAAK,cAAe,eAErB,CACD,CAED,gBAAgB,OAAQ,KAAME,EAC9B,CAED,uBAAwBZ,EAAS,CAChC,OAAMA,EAAO,cACZA,EAAO,YAAc,IAEtBA,EAAO,YAAY,QAAU,KAAK,oBAAoB,QAEjDA,EAAO,iBACXA,EAAO,eAAe,eAAiB,IAEjCA,CACP,CAED,oBAAqB,CACpB,MAAK,QAAK,YAAc,KAAK,qBAAuB9B,EAAO,MAAO,KAAK,oBAAoB,EAAE,GAAM,KAAK,oBAAoB,GAK5H,CAED,kBAAmBgE,EAAW,CAE7B,IAAIlE,EAAQ,KACRgC,EACAmC,EACAC,EACAC,EAEAC,EAEJ,OAASJ,EAAQ,CAChB,IAAK,YACJlC,EAAS,CAAE,YAAa,CAAA,GACnB9B,EAAO,MAAO,KAAK,mBAAmB,GAE1C8B,EAAO,QAAU,KAAK,oBAAoB,QAAU,KAAK,oBAAoB,QAAU,eAAe,UAAU,GAChHA,EAAO,UAAY,KAAK,oBAAoB,WAE5C9B,EAAO,WAAYF,EAAM,OAAQJ,EAAE,KAAK,EAAG,yBAAyB,EAAI,OAAO,SAAS,IAAI,EAC5F,oBAAoB,SAAU,YAAaoC,KAG3CmC,EAAc,CAAA,EACdC,EAAyB,KAAK,uBAC9BC,EAAuBD,EAAuB,OAEzCC,EAAuB,IAC3BC,EAAaF,EAAuB,CAAC,EAErCD,EAAY,YAAc,GAC1BA,EAAY,eAAiB,CAAE,QAAS,GAAM,WAAY,IAC1DA,EAAY,YAAY,GAAK,CAACG,CAAU,EAExC,KAAK,IAAI,MAAQ,KAAK,IAAI,QAAQ,EAAGH,EAAa,CACjD,SAAU,SAAUlD,EAAS,CAC5B,IAAIY,EAAcZ,EAAO,YAEnBY,IACLA,EAAc,CAAA,GAGfA,EAAcA,EAAY,CAAC,EAE3BG,EAAO,QAAUH,EAAY,QAC7BG,EAAO,UAAYH,EAAY,WAC/B3B,EAAO,WAAYF,EAAM,OAAQJ,EAAE,KAAK,EAAG,yBAAyB,EAAI,OAAO,SAAS,IAAI,EAC5F,oBAAoB,SAAU,YAAaoC,EAE3C,CACR,KAKI,MAED,IAAK,gBACJA,EAAS,CAAE,YAAa,CAAA,GACnB9B,EAAO,MAAO,KAAK,mBAAmB,EAC1C,oBAAoB,aAAc,KAAM,WAAY,KAAK,oBAAoB,QAAU,KAAK,oBAAoB,QAAU,eAAe,UAAU,EAAE,GAErJiE,EAAc,CAAA,EACdC,EAAyB,KAAK,uBAC9BC,EAAuBD,EAAuB,OAEzCC,EAAuB,IAC3BC,EAAaF,EAAuB,CAAC,EAErCD,EAAY,YAAc,GAC1BA,EAAY,eAAiB,CAAE,QAAS,EAAI,EAC5CA,EAAY,YAAY,GAAK,CAACG,CAAU,EAExC,KAAK,IAAI,MAAQ,KAAK,IAAI,QAAQ,EAAGH,EAAa,CACjD,SAAU,SAAUlD,EAAS,CAC5B,IAAIY,EAAcZ,EAAO,YAEnBY,IACLA,EAAc,CAAA,GAGfA,EAAcA,EAAY,CAAC,EAE3B,oBAAoB,aAAc7B,EAAO,WAAY6B,EAAY,OAAO,CAExE,CACR,KAII,MACD,IAAK,WAEJG,EAAS,CAAE,YAAa,CAAA,GAExB,IAAIuC,EAAgB,KAEfrE,EAAO,MAAO,KAAK,mBAAmB,GAE1CqE,EAAgB,CAAC,KAAK,oBAAoB,QAAU,KAAK,oBAAoB,QAAU,eAAe,UAAU,EAAE,EAClHvC,EAAO,YAAY,iBAAmB,CAAE,MAAOuC,CAAa,EAC5DvC,EAAO,YAAc,KAAK,oBAAoB,WAE9C9B,EAAO,WAAYF,EAAM,OAAQJ,EAAE,KAAK,EAAG,yBAAyB,EAAI,OAAO,SAAS,IAAI,EAC5F,oBAAoB,SAAU,WAAYoC,KAG1CmC,EAAc,CAAA,EACdC,EAAyB,KAAK,uBAC9BC,EAAuBD,EAAuB,OAEzCC,EAAuB,IAC3BC,EAAaF,EAAuB,CAAC,EAErCD,EAAY,YAAc,GAC1BA,EAAY,eAAiB,CAAE,QAAS,GAAM,WAAY,IAC1DA,EAAY,YAAY,GAAK,CAACG,CAAU,EAExC,KAAK,IAAI,MAAQ,KAAK,IAAI,QAAQ,EAAGH,EAAa,CACjD,SAAU,SAAUlD,EAAS,CAC5B,IAAIY,EAAcZ,EAAO,YAEnBY,IACLA,EAAc,CAAA,GAGfA,EAAcA,EAAY,CAAC,EAE3B0C,EAAgB,CAAC1C,EAAY,OAAO,EAEpCG,EAAO,YAAY,iBAAmBuC,EACtCvC,EAAO,YAAcH,EAAY,WAEjC3B,EAAO,WAAYF,EAAM,OAAQJ,EAAE,KAAK,EAAG,yBAAyB,EAAI,OAAO,SAAS,IAAI,EAC5F,oBAAoB,SAAU,WAAYoC,EAE1C,CACR,KAII,KACD,CAGD,CAED,gBAAiB,CACX,kBAAkB,SAAU,KAAK,cAAe,MAAM,GAAM,kBAAkB,SAAU,KAAK,cAAe,YAAY,EAC5H,KAAK,gBAAkB,GAEvB,KAAK,gBAAkB,GAGnB,KAAK,gBACT,KAAK,YAAc,GAEnB,KAAK,YAAc,GAGf,KAAK,oBACT,KAAK,iBAAmB,GAExB,KAAK,iBAAmB,GAGpB,KAAK,qBACT,KAAK,kBAAoB,GAEzB,KAAK,kBAAoB,GAGrB,KAAK,mBACT,KAAK,eAAiB,GAEtB,KAAK,eAAiB,GAGlB,KAAK,uBACT,KAAK,mBAAqB,GAE1B,KAAK,mBAAqB,GAI3B,IAAIwC,EAAc,MAAM,WACxB,GAAKA,GAAejF,EAAE,WAAYiF,EAAY,uDAAuD,EACpG,IAAIvD,EAASuD,EAAY,wDAAyD,CAAE,MAAO,EAAK,GAG3FvD,GAOLA,EAASA,EAAO,YACVA,EAAO,SACZ,KAAK,eAAiB,IAGjBA,EAAO,aACZ,KAAK,mBAAqB,IAGrBA,EAAO,MACZ,KAAK,YAAc,IAGdA,EAAO,WACZ,KAAK,iBAAmB,IAGnBA,EAAO,YACZ,KAAK,kBAAoB,MAxB1B,KAAK,eAAiB,GACtB,KAAK,mBAAqB,GAC1B,KAAK,YAAc,GACnB,KAAK,iBAAmB,GACxB,KAAK,kBAAoB,GAwB1B,CAED,oBAAqBwD,EAAc,CAC5B,KAAK,uBAAwB,YAClC,mBAAmB,aAAc,KAAK,oCAAmC,EAAG,GAAIA,EAAY,GAAI,EAAO,EAInG,KAAK,mCAAoC,WAC7C,KAAK,oBAAsB,GAE3B,KAAK,oBAAsB,IAGvB,CAAC,KAAK,mCAAoC,SAAS,GAAM,KAAK,QAAU,KAAK,UACjF,mBAAmB,gBAAiB,KAAK,oCAAmC,EAAG,GAAIA,EAAY,GAAI,GAEpG,CAED,sBAAuB,CACtB,IAAIzE,EAAQ,KAOZ,GALK,CAAC,KAAK,qBAAuB,CAAC,KAAK,oBAAoB,SAKvD,KAAK,8BAAgC,IAAWE,EAAO,kBAAiB,EAAK,IAAU,OAAK,oBAAoB,SAAW,IAAM,KAAK,oBAAoB,SAAW,IACzK,OAGD,IAAIV,EAAO,CAAA,EACXA,EAAK,WAAa,KAAK,oBAAoB,WAC3CA,EAAK,SAAW,KAAK,oBAAoB,SACzCA,EAAK,QAAU,KAAK,oBAAoB,QACxCA,EAAK,WAAa,KAAK,oBAAoB,WAC3CA,EAAK,SAAW,KAAK,oBAAoB,SAEzCA,EAAK,gBAAkB,KAAK,oBAAoB,gBAEhDA,EAAK,mBAAqB,KAAK,oBAAoB,mBACnDA,EAAK,kBAAoB,KAAK,oBAAoB,kBAClDA,EAAK,2BAA6B,KAAK,oBAAoB,2BAE3DA,EAAK,eAAiB,GAEtBA,EAAK,eAAe,CAAC,EAAI,KAAK,oBAAoB,IAClDA,EAAK,eAAe,CAAC,EAAI,KAAK,oBAAoB,IAClDA,EAAK,eAAe,CAAC,EAAI,KAAK,oBAAoB,IAClDA,EAAK,eAAe,CAAC,EAAI,KAAK,oBAAoB,IAClDA,EAAK,eAAe,CAAC,EAAI,KAAK,oBAAoB,IAClDA,EAAK,eAAe,CAAC,EAAI,KAAK,oBAAoB,IAClDA,EAAK,eAAe,CAAC,EAAI,KAAK,oBAAoB,IAElDA,EAAK,2BAA6B,KAAK,oBAAoB,2BAE3D,KAAK,aAAa,qBAAsBA,EAAM,CAC7C,SAAU,SAAUyB,EAAS,CAC5B,IAAIY,EAAcZ,EAAO,YAEpB,CAACY,GAAe,CAACA,EAAY,QAIlC7B,EAAM,uBAAyB6B,EAE/B7B,EAAM,0BAAyB,EAC/B,CACJ,EACE,CAED,2BAA4B,CAC3B,IAAIA,EAAQ,KAEZ,GAAK,CAAC,KAAK,oBAGV,OAGD,IAAI0E,EAA0B,GAC1BC,EAAe,KAAK,uBAAuB,MAC3CC,EAAe,EACfC,EAAgB,EAChBC,EAA0B,EAC1BC,EAA2B,EAE3BC,EAA4B,GAmBhC,GAjBAJ,EAAe,KAAK,uBAAuB,WAAc,OACzDE,GAA2B,KAAK,uBAAuB,WAAc,OAAQ,CAAEG,EAAGC,IAAO,WAAYD,CAAG,EAAG,WAAYC,EAAE,UAAU,EAAI,GAClI,KAAK,oBAAoB,iBAAmB,IAChDN,GAAgB,KAAK,uBAAuB,cAAiB,OAC7DE,GAA2B,KAAK,uBAAuB,cAAiB,OAAQ,CAAEG,EAAGC,IAAO,WAAYD,CAAG,EAAG,WAAYC,EAAE,UAAU,EAAI,IAC/H,KAAK,oBAAoB,iBAAmB,KACvDN,GAAgBD,EAAa,OAC7BG,GAA2BH,EAAa,OAAQ,CAAEM,EAAGC,IAAOD,EAAIC,EAAE,WAAY,IAE1E,KAAK,oBAAoB,4BAA8B,KAC3DN,GAAgB,KAAK,uBAAuB,cAAiB,OAC7DE,GAA2B,KAAK,uBAAuB,cAAiB,OAAQ,CAAEG,EAAGC,IAAO,WAAYD,CAAG,EAAG,WAAYC,EAAE,UAAU,EAAI,IAE3IL,EAAgB,KAAK,uBAAuB,SAAY,OAAQM,GAAS,CAACA,EAAM,YAAc,CAACA,EAAM,YAAY,EAAG,OACpHJ,EAA2B,KAAK,uBAAuB,SAAY,OAAQI,GAAS,CAACA,EAAM,YAAc,CAACA,EAAM,cAAe,OAAQ,CAAEF,EAAGC,IAAO,WAAYD,GAAM,WAAYC,EAAE,UAAY,EAAE,CAAC,EAClMtF,EAAG,0BAA4B,EAAC,KAAM,KAAOiF,EAAgB,MAAQD,EAAe,MAE/E,MAAM,QAASD,GAAiB,CACpC,IAAIS,EAAiB,CAAA,EACrB,QAAU1F,EAAI,EAAGA,EAAIiF,EAAa,OAAQjF,IACzC,GAAKiF,EAAajF,CAAC,EAAE,cAAgB,aAI/B0F,EAAeT,EAAajF,CAAC,EAAE,YAAY,IAChD0F,EAAeT,EAAajF,CAAC,EAAE,YAAY,EAAI,CAAA,GAEhD0F,EAAeT,EAAajF,CAAC,EAAE,YAAY,EAAE,KAAMiF,EAAajF,CAAC,GAG5DsF,GAA6B,IAAK,CACtC,IAAIK,EAAe,KAAK,uBAAuB,SAAY,KAAMF,GAASA,EAAM,KAAOR,EAAajF,CAAC,EAAE,YAAY,EAC9G2F,GACwB,WAAYV,EAAajF,CAAC,EAAE,UAAY,EAAG,WAAY2F,EAAa,UAAU,EAAO,IACtF,KAC1BL,EAA4B,GAG9B,CAKF,GAFAN,GAA2B,yCAEtB,KAAK,oBAAoB,iBAAmBM,EAA4B,CAC5E,IAAIM,EAA0BN,GAA6B,GAAKpF,EAAE,KAAK,EAAG,SAAS,EAAKA,EAAE,KAAK,EAAG,OAAO,EACzG8E,GAA2B,+DAAiE9E,EAAE,KAAK,EAAG,uCAA0C,aAAe0F,EAA0B,sBAGzL1F,EAAG,yBAA2B,EAAC,IAAK,QAAS,KAAK,CACtD,MACIA,EAAG,yBAA2B,EAAC,IAAK,QAAS,EAAE,EAG3C,KAAK,oBAAoB,iBAAmB,IAAM+E,EAAa,OAAS,EAC5ED,GAA2B,8CAAgD9E,EAAE,KAAK,EAAG,oBAAsB,EAAG,aACnG,KAAK,oBAAoB,iBAAmB,IAAM,KAAK,uBAAuB,cAAiB,OAAS,IACnH8E,GAA2B,kDAAoD9E,EAAE,KAAK,EAAG,iBAAmB,EAAG,cAG3GL,EAAE,KAAM6F,CAAc,EAAK,IAC/BV,GAA2B,KAAK,iCAGjC,QAAUa,KAAcH,EAAiB,CACxC,IAAII,EAAc,KAAK,uBAAuB,SAAY,KAAML,GAASA,EAAM,KAAOC,EAAeG,CAAU,EAAE,CAAC,EAAE,YAAY,EAChIb,GAA2B,OAC3BA,GAA2B,OAASc,EAAY,WAAa,QAC7Dd,GAA2B,OAASc,EAAY,WAAa,MAAQA,EAAY,SAAW,MAAQtF,EAAO,YAAasF,EAAY,UAAU,EAAK,QAEnJ,IAAIC,EAAkB,GACtB,QAAU/F,EAAI,EAAGA,EAAI0F,EAAeG,CAAU,EAAE,OAAQ7F,IACvD,GAAK,KAAK,oBAAoB,iBAAmB,IAAQ0F,EAAeG,CAAU,EAAE7F,CAAC,EAAE,cAAgB,OAAS0F,EAAeG,CAAU,EAAE7F,CAAC,EAAE,cAAgB,WAAe,CACvK+F,IAAoB,KACxBf,GAA2B,QAC3BA,GAA2B,OAC3BA,GAA2B,OAASU,EAAeG,CAAU,EAAE7F,CAAC,EAAE,WAAa,QAC/EgF,GAA2B,aAE5B,IAAIgB,EAAiBN,EAAeG,CAAU,EAAE7F,CAAC,EAAE,cAAgB,MAAQE,EAAE,KAAK,EAAG,OAAUA,EAAE,KAAK,EAAG,YACrG+F,EAAaP,EAAeG,CAAU,EAAE7F,CAAC,EAAE,WAAa,kBAAoB,GAChFgF,GAA2B,eAAiBiB,EAAa,KAAOP,EAAeG,CAAU,EAAE7F,CAAC,EAAE,WAAa,MAAQ0F,EAAeG,CAAU,EAAE7F,CAAC,EAAE,SAAW,MAAQQ,EAAO,YAAakF,EAAeG,CAAU,EAAE7F,CAAC,EAAE,UAAY,EAAG,KAAOgG,EAAiB,UACxPD,IAAoB,KACxBf,GAA2B,SAE5Be,EAAkB,EAClB,CAEFf,GAA2B,OAC3B,CAED,GAAK,MAAM,QAAS,KAAK,uBAAuB,aAAmB,KAAK,uBAAuB,WAAc,OAAS,EAAI,CACzHA,GAA2B,2DAC3BA,GAA2B,kDAAoD9E,EAAE,KAAK,EAAG,8BAAgC,EAAG,aAEvHL,EAAE,KAAM6F,CAAc,IAAO,IACjCV,GAA2B,KAAK,iCAGjC,QAAUhF,EAAI,EAAGA,EAAI,KAAK,uBAAuB,WAAc,OAAQA,IAAM,CAC5E,IAAIkG,EAAW,KAAK,oBAAoB,4BAA8B,GAAK,kBAAoB,GAC/FlB,GAA2B,cAAgBkB,EAAW,KACtDlB,GAA2B,OAAS,KAAK,uBAAuB,WAAchF,CAAC,EAAE,WAAa,QAC9FgF,GAA2B,YAC3BA,GAA2B,OAAS,KAAK,uBAAuB,WAAchF,CAAC,EAAE,WAAa,MAAQ,KAAK,uBAAuB,WAAcA,CAAC,EAAE,SAAW,MAAQQ,EAAO,YAAa,KAAK,uBAAuB,WAAcR,CAAC,EAAE,UAAU,EAAK,QACtPgF,GAA2B,MAC3B,CACD,CAED,GAAK,KAAK,oBAAoB,4BAA8B,IAAQ,MAAM,QAAS,KAAK,uBAAuB,aAAkB,GAAI,KAAK,uBAAuB,cAAiB,OAAS,EAAI,CAC9LA,GAA2B,2DAC3BA,GAA2B,kDAAoD9E,EAAE,KAAK,EAAG,iBAAmB,EAAG,aAC/G,QAAUF,EAAI,EAAGA,EAAI,KAAK,uBAAuB,cAAiB,OAAQA,IACzEgF,GAA2B,OAC3BA,GAA2B,OAAS,KAAK,uBAAuB,cAAiBhF,CAAC,EAAE,WAAa,QACjGgF,GAA2B,YAC3BA,GAA2B,OAAS,KAAK,uBAAuB,cAAiBhF,CAAC,EAAE,WAAa,MAAQ,KAAK,uBAAuB,cAAiBA,CAAC,EAAE,SAAW,MAAQQ,EAAO,YAAa,KAAK,uBAAuB,cAAiBR,CAAC,EAAE,UAAU,EAAK,QAC/PgF,GAA2B,MAE5B,CAEI,KAAK,uBAAuB,SAAY,OAAS,GAAK,KAAK,uBAAuB,WAAc,OAAS,GAC7GA,GAA2B,2DAC3BA,GAA2B,uCAAyC9E,EAAE,KAAK,EAAG,gBAAmB,YAAciF,EAAgB,MAAQ3E,EAAO,YAAa6E,CAAwB,EAAK,aAAeH,EAAe,MAAQ1E,EAAO,YAAa4E,CAAyB,EAAG,cAE9QJ,GAA2B,kDAAoD9E,EAAE,KAAK,EAAG,gCAAmC,QAAU8E,EAA0B,QAGjKA,GAA2B,UAC3B,CAEI1E,EAAM,wBACVA,EAAM,uBAAuB,KAAM,CAClC,KAAM,CACL,MAAO,QACP,MAAO,GACP,OAAQ,EACR,EACD,KAAM,CACL,MAAO,CAAC,eAAe,CACvB,EACD,MAAO,CACN,MAAO,IACP,QAAS,0BACT,EACD,QAAS0E,CACb,EAEE,CAED,+BAAgC,CAC/B,MAAO;AAAA,sCAC+B9E,EAAE,KAAK,EAAG,MAAQ,EAAG;AAAA,sCACrBA,EAAE,KAAK,EAAG,QAAU,EAAG;AAAA,sCACvBA,EAAE,KAAK,EAAG,OAAS,EAAG;AAAA;AAAA,KAG5D,CAGD,uBAAwBiG,EAAU,CACjC,IAAIC,EAAM,CAAA,EAEV,OAAAA,EAAI,QAAU,KAAK,iBAAiB,QAAW,WAC/CA,EAAI,KAAO,KAAK,iBAAiB,KAAQ,WACzCA,EAAI,UAAY,KAAK,oBAAoB,GACzCA,EAAI,eAAiB,GAEdA,CACP,CAED,mBAAoB,CACnB,MAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAgBP,CACF"}