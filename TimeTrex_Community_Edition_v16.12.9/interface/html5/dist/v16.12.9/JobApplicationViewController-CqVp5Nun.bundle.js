const __vite__fileDeps=["./main_ui-CaF8IcSp.css","./leaflet-timetrex-DIHfnHxo.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
var Bi=Object.defineProperty;var qt=me=>{throw TypeError(me)};var ji=(me,P,Z)=>P in me?Bi(me,P,{enumerable:!0,configurable:!0,writable:!0,value:Z}):me[P]=Z;var Fe=(me,P,Z)=>ji(me,typeof P!="symbol"?P+"":P,Z),dt=(me,P,Z)=>P.has(me)||qt("Cannot "+Z);var E=(me,P,Z)=>(dt(me,P,"read from private field"),Z?Z.call(me):P.get(me)),de=(me,P,Z)=>P.has(me)?qt("Cannot add the same private member more than once"):P instanceof WeakSet?P.add(me):P.set(me,Z),pe=(me,P,Z,x)=>(dt(me,P,"write to private field"),x?x.call(me,Z):P.set(me,Z),Z),te=(me,P,Z)=>(dt(me,P,"access private method"),Z);var et=(me,P,Z,x)=>({set _(V){pe(me,P,V,Z)},get _(){return E(me,P,x)}});import{m as commonjsRequire,_ as __vitePreload}from"./main_ui-z76rxVqJ.entry.bundle.js";import{L as getAugmentedNamespace,j as jQuery,_}from"./vendor-tTApdY0Y.bundle.js";var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(P,Z){module.exports=Z()})(globalThis,()=>(()=>{var __webpack_modules__=[,(me,P)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.VerbosityLevel=P.Util=P.UnknownErrorException=P.UnexpectedResponseException=P.UNSUPPORTED_FEATURES=P.TextRenderingMode=P.RenderingIntentFlag=P.PermissionFlag=P.PasswordResponses=P.PasswordException=P.PageActionEventType=P.OPS=P.MissingPDFException=P.LINE_FACTOR=P.LINE_DESCENT_FACTOR=P.InvalidPDFException=P.ImageKind=P.IDENTITY_MATRIX=P.FormatError=P.FeatureTest=P.FONT_IDENTITY_MATRIX=P.DocumentActionEventType=P.CMapCompressionType=P.BaseException=P.BASELINE_FACTOR=P.AnnotationType=P.AnnotationStateModelType=P.AnnotationReviewState=P.AnnotationReplyType=P.AnnotationMode=P.AnnotationMarkedState=P.AnnotationFlag=P.AnnotationFieldFlag=P.AnnotationEditorType=P.AnnotationEditorPrefix=P.AnnotationEditorParamsType=P.AnnotationBorderStyleType=P.AnnotationActionEventType=P.AbortException=void 0,P.arrayByteLength=w,P.arraysToBytes=A,P.assert=y,P.bytesToString=i,P.createPromiseCapability=Ee,P.createValidAbsoluteUrl=g,P.getModificationDate=Pe,P.getVerbosityLevel=$,P.info=k,P.isArrayBuffer=Ae,P.isArrayEqual=ve,P.objectFromMap=G,P.objectSize=j,P.setVerbosityLevel=K,P.shadow=M,P.string32=I,P.stringToBytes=b,P.stringToPDFString=fe,P.stringToUTF8String=ge,P.unreachable=re,P.utf8StringToString=be,P.warn=le;const Z=[1,0,0,1,0,0];P.IDENTITY_MATRIX=Z;const x=[.001,0,0,.001,0,0];P.FONT_IDENTITY_MATRIX=x;const V=1.35;P.LINE_FACTOR=V;const ne=.35;P.LINE_DESCENT_FACTOR=ne;const B=ne/V;P.BASELINE_FACTOR=B;const R={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};P.RenderingIntentFlag=R;const N={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};P.AnnotationMode=N;const h="pdfjs_internal_editor_";P.AnnotationEditorPrefix=h;const m={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};P.AnnotationEditorType=m;const L={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};P.AnnotationEditorParamsType=L;const C={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};P.PermissionFlag=C;const u={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};P.TextRenderingMode=u;const l={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};P.ImageKind=l;const d={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};P.AnnotationType=d;const s={MARKED:"Marked",REVIEW:"Review"};P.AnnotationStateModelType=s;const e={MARKED:"Marked",UNMARKED:"Unmarked"};P.AnnotationMarkedState=e;const r={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};P.AnnotationReviewState=r;const c={GROUP:"Group",REPLY:"R"};P.AnnotationReplyType=c;const o={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};P.AnnotationFlag=o;const t={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};P.AnnotationFieldFlag=t;const n={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};P.AnnotationBorderStyleType=n;const f={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};P.AnnotationActionEventType=f;const a={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};P.DocumentActionEventType=a;const T={O:"PageOpen",C:"PageClose"};P.PageActionEventType=T;const O={ERRORS:0,WARNINGS:1,INFOS:5};P.VerbosityLevel=O;const X={NONE:0,BINARY:1};P.CMapCompressionType=X;const Y={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};P.OPS=Y;const _e={forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};P.UNSUPPORTED_FEATURES=_e;const ue={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};P.PasswordResponses=ue;let J=O.WARNINGS;function K(ce){Number.isInteger(ce)&&(J=ce)}function $(){return J}function k(ce){J>=O.INFOS&&console.log(`Info: ${ce}`)}function le(ce){J>=O.WARNINGS&&console.log(`Warning: ${ce}`)}function re(ce){throw new Error(ce)}function y(ce,se){ce||re(se)}function p(ce){if(!ce)return!1;switch(ce.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function g(ce,se=null,ae=null){if(!ce)return null;try{if(ae&&typeof ce=="string"){if(ae.addDefaultProtocol&&ce.startsWith("www.")){const Se=ce.match(/\./g);Se&&Se.length>=2&&(ce=`http://${ce}`)}if(ae.tryConvertEncoding)try{ce=ge(ce)}catch{}}const ye=se?new URL(ce,se):new URL(ce);if(p(ye))return ye}catch{}return null}function M(ce,se,ae,ye=!1){return Object.defineProperty(ce,se,{value:ae,enumerable:!ye,configurable:!0,writable:!1}),ae}const W=function(){function se(ae,ye){this.constructor===se&&re("Cannot initialize BaseException."),this.message=ae,this.name=ye}return se.prototype=new Error,se.constructor=se,se}();P.BaseException=W;class z extends W{constructor(se,ae){super(se,"PasswordException"),this.code=ae}}P.PasswordException=z;class U extends W{constructor(se,ae){super(se,"UnknownErrorException"),this.details=ae}}P.UnknownErrorException=U;class Q extends W{constructor(se){super(se,"InvalidPDFException")}}P.InvalidPDFException=Q;class ee extends W{constructor(se){super(se,"MissingPDFException")}}P.MissingPDFException=ee;class he extends W{constructor(se,ae){super(se,"UnexpectedResponseException"),this.status=ae}}P.UnexpectedResponseException=he;class ie extends W{constructor(se){super(se,"FormatError")}}P.FormatError=ie;class v extends W{constructor(se){super(se,"AbortException")}}P.AbortException=v;function i(ce){(typeof ce!="object"||ce===null||ce.length===void 0)&&re("Invalid argument for bytesToString");const se=ce.length,ae=8192;if(se<ae)return String.fromCharCode.apply(null,ce);const ye=[];for(let Se=0;Se<se;Se+=ae){const xe=Math.min(Se+ae,se),Ce=ce.subarray(Se,xe);ye.push(String.fromCharCode.apply(null,Ce))}return ye.join("")}function b(ce){typeof ce!="string"&&re("Invalid argument for stringToBytes");const se=ce.length,ae=new Uint8Array(se);for(let ye=0;ye<se;++ye)ae[ye]=ce.charCodeAt(ye)&255;return ae}function w(ce){if(ce.length!==void 0)return ce.length;if(ce.byteLength!==void 0)return ce.byteLength;re("Invalid argument for arrayByteLength")}function A(ce){const se=ce.length;if(se===1&&ce[0]instanceof Uint8Array)return ce[0];let ae=0;for(let xe=0;xe<se;xe++)ae+=w(ce[xe]);let ye=0;const Se=new Uint8Array(ae);for(let xe=0;xe<se;xe++){let Ce=ce[xe];Ce instanceof Uint8Array||(typeof Ce=="string"?Ce=b(Ce):Ce=new Uint8Array(Ce));const we=Ce.byteLength;Se.set(Ce,ye),ye+=we}return Se}function I(ce){return String.fromCharCode(ce>>24&255,ce>>16&255,ce>>8&255,ce&255)}function j(ce){return Object.keys(ce).length}function G(ce){const se=Object.create(null);for(const[ae,ye]of ce)se[ae]=ye;return se}function H(){const ce=new Uint8Array(4);return ce[0]=1,new Uint32Array(ce.buffer,0,1)[0]===1}function S(){try{return new Function(""),!0}catch{return!1}}class F{static get isLittleEndian(){return M(this,"isLittleEndian",H())}static get isEvalSupported(){return M(this,"isEvalSupported",S())}static get isOffscreenCanvasSupported(){return M(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?M(this,"platform",{isWin:!1,isMac:!1}):M(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}P.FeatureTest=F;const D=[...Array(256).keys()].map(ce=>ce.toString(16).padStart(2,"0"));class q{static makeHexColor(se,ae,ye){return`#${D[se]}${D[ae]}${D[ye]}`}static scaleMinMax(se,ae){let ye;se[0]?(se[0]<0&&(ye=ae[0],ae[0]=ae[1],ae[1]=ye),ae[0]*=se[0],ae[1]*=se[0],se[3]<0&&(ye=ae[2],ae[2]=ae[3],ae[3]=ye),ae[2]*=se[3],ae[3]*=se[3]):(ye=ae[0],ae[0]=ae[2],ae[2]=ye,ye=ae[1],ae[1]=ae[3],ae[3]=ye,se[1]<0&&(ye=ae[2],ae[2]=ae[3],ae[3]=ye),ae[2]*=se[1],ae[3]*=se[1],se[2]<0&&(ye=ae[0],ae[0]=ae[1],ae[1]=ye),ae[0]*=se[2],ae[1]*=se[2]),ae[0]+=se[4],ae[1]+=se[4],ae[2]+=se[5],ae[3]+=se[5]}static transform(se,ae){return[se[0]*ae[0]+se[2]*ae[1],se[1]*ae[0]+se[3]*ae[1],se[0]*ae[2]+se[2]*ae[3],se[1]*ae[2]+se[3]*ae[3],se[0]*ae[4]+se[2]*ae[5]+se[4],se[1]*ae[4]+se[3]*ae[5]+se[5]]}static applyTransform(se,ae){const ye=se[0]*ae[0]+se[1]*ae[2]+ae[4],Se=se[0]*ae[1]+se[1]*ae[3]+ae[5];return[ye,Se]}static applyInverseTransform(se,ae){const ye=ae[0]*ae[3]-ae[1]*ae[2],Se=(se[0]*ae[3]-se[1]*ae[2]+ae[2]*ae[5]-ae[4]*ae[3])/ye,xe=(-se[0]*ae[1]+se[1]*ae[0]+ae[4]*ae[1]-ae[5]*ae[0])/ye;return[Se,xe]}static getAxialAlignedBoundingBox(se,ae){const ye=q.applyTransform(se,ae),Se=q.applyTransform(se.slice(2,4),ae),xe=q.applyTransform([se[0],se[3]],ae),Ce=q.applyTransform([se[2],se[1]],ae);return[Math.min(ye[0],Se[0],xe[0],Ce[0]),Math.min(ye[1],Se[1],xe[1],Ce[1]),Math.max(ye[0],Se[0],xe[0],Ce[0]),Math.max(ye[1],Se[1],xe[1],Ce[1])]}static inverseTransform(se){const ae=se[0]*se[3]-se[1]*se[2];return[se[3]/ae,-se[1]/ae,-se[2]/ae,se[0]/ae,(se[2]*se[5]-se[4]*se[3])/ae,(se[4]*se[1]-se[5]*se[0])/ae]}static singularValueDecompose2dScale(se){const ae=[se[0],se[2],se[1],se[3]],ye=se[0]*ae[0]+se[1]*ae[2],Se=se[0]*ae[1]+se[1]*ae[3],xe=se[2]*ae[0]+se[3]*ae[2],Ce=se[2]*ae[1]+se[3]*ae[3],we=(ye+Ce)/2,Re=Math.sqrt((ye+Ce)**2-4*(ye*Ce-xe*Se))/2,Ie=we+Re||1,Te=we-Re||1;return[Math.sqrt(Ie),Math.sqrt(Te)]}static normalizeRect(se){const ae=se.slice(0);return se[0]>se[2]&&(ae[0]=se[2],ae[2]=se[0]),se[1]>se[3]&&(ae[1]=se[3],ae[3]=se[1]),ae}static intersect(se,ae){const ye=Math.max(Math.min(se[0],se[2]),Math.min(ae[0],ae[2])),Se=Math.min(Math.max(se[0],se[2]),Math.max(ae[0],ae[2]));if(ye>Se)return null;const xe=Math.max(Math.min(se[1],se[3]),Math.min(ae[1],ae[3])),Ce=Math.min(Math.max(se[1],se[3]),Math.max(ae[1],ae[3]));return xe>Ce?null:[ye,xe,Se,Ce]}static bezierBoundingBox(se,ae,ye,Se,xe,Ce,we,Re){const Ie=[],Te=[[],[]];let ke,Me,Oe,Le,Ve,He,$e,We;for(let ht=0;ht<2;++ht){if(ht===0?(Me=6*se-12*ye+6*xe,ke=-3*se+9*ye-9*xe+3*we,Oe=3*ye-3*se):(Me=6*ae-12*Se+6*Ce,ke=-3*ae+9*Se-9*Ce+3*Re,Oe=3*Se-3*ae),Math.abs(ke)<1e-12){if(Math.abs(Me)<1e-12)continue;Le=-Oe/Me,0<Le&&Le<1&&Ie.push(Le);continue}$e=Me*Me-4*Oe*ke,We=Math.sqrt($e),!($e<0)&&(Ve=(-Me+We)/(2*ke),0<Ve&&Ve<1&&Ie.push(Ve),He=(-Me-We)/(2*ke),0<He&&He<1&&Ie.push(He))}let je=Ie.length,De;const qe=je;for(;je--;)Le=Ie[je],De=1-Le,Te[0][je]=De*De*De*se+3*De*De*Le*ye+3*De*Le*Le*xe+Le*Le*Le*we,Te[1][je]=De*De*De*ae+3*De*De*Le*Se+3*De*Le*Le*Ce+Le*Le*Le*Re;return Te[0][qe]=se,Te[1][qe]=ae,Te[0][qe+1]=we,Te[1][qe+1]=Re,Te[0].length=Te[1].length=qe+2,[Math.min(...Te[0]),Math.min(...Te[1]),Math.max(...Te[0]),Math.max(...Te[1])]}}P.Util=q;const oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function fe(ce){if(ce[0]>="ï"){let ae;if(ce[0]==="þ"&&ce[1]==="ÿ"?ae="utf-16be":ce[0]==="ÿ"&&ce[1]==="þ"?ae="utf-16le":ce[0]==="ï"&&ce[1]==="»"&&ce[2]==="¿"&&(ae="utf-8"),ae)try{const ye=new TextDecoder(ae,{fatal:!0}),Se=b(ce);return ye.decode(Se)}catch(ye){le(`stringToPDFString: "${ye}".`)}}const se=[];for(let ae=0,ye=ce.length;ae<ye;ae++){const Se=oe[ce.charCodeAt(ae)];se.push(Se?String.fromCharCode(Se):ce.charAt(ae))}return se.join("")}function ge(ce){return decodeURIComponent(escape(ce))}function be(ce){return unescape(encodeURIComponent(ce))}function Ae(ce){return typeof ce=="object"&&ce!==null&&ce.byteLength!==void 0}function ve(ce,se){if(ce.length!==se.length)return!1;for(let ae=0,ye=ce.length;ae<ye;ae++)if(ce[ae]!==se[ae])return!1;return!0}function Pe(ce=new Date){return[ce.getUTCFullYear().toString(),(ce.getUTCMonth()+1).toString().padStart(2,"0"),ce.getUTCDate().toString().padStart(2,"0"),ce.getUTCHours().toString().padStart(2,"0"),ce.getUTCMinutes().toString().padStart(2,"0"),ce.getUTCSeconds().toString().padStart(2,"0")].join("")}function Ee(){const ce=Object.create(null);let se=!1;return Object.defineProperty(ce,"settled",{get(){return se}}),ce.promise=new Promise(function(ae,ye){ce.resolve=function(Se){se=!0,ae(Se)},ce.reject=function(Se){se=!0,ye(Se)}}),ce}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var me,P,x,V,ne,B,R,N,h,m,L,ut,u,l;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:s,NodeCMapReaderFactory:e,NodeStandardFontDataFactory:r}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=s,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=e,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=r}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:s}=__w_pdfjs_require__(21);createPDFNetworkStream=e=>new s(e)}else{const{PDFNetworkStream:s}=__w_pdfjs_require__(24),{PDFFetchStream:e}=__w_pdfjs_require__(25);createPDFNetworkStream=r=>(0,_display_utils.isValidFetchUrl)(r.url)?new e(r):new s(r)}function getDocument(s){if(typeof s=="string"||s instanceof URL)s={url:s};else if((0,_util.isArrayBuffer)(s))s={data:s};else if(s instanceof PDFDataRangeTransport)(0,_display_utils.deprecated)("`PDFDataRangeTransport`-instance, please use a parameter object with `range`-property instead."),s={range:s};else if(typeof s!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!s.url&&!s.data&&!s.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const e=new PDFDocumentLoadingTask,r=Object.create(null);let c=null,o=null;for(const n in s){const f=s[n];switch(n){case"url":if(f instanceof URL){r[n]=f.href;continue}try{r[n]=new URL(f,window.location).href;continue}catch{if(_is_node.isNodeJS&&typeof f=="string")break}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":c=f;continue;case"worker":o=f;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&f instanceof Buffer)r[n]=new Uint8Array(f);else{if(f instanceof Uint8Array&&f.byteLength===f.buffer.byteLength)break;if(typeof f=="string")r[n]=(0,_util.stringToBytes)(f);else if(typeof f=="object"&&f!==null&&!isNaN(f.length)||(0,_util.isArrayBuffer)(f))r[n]=new Uint8Array(f);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}r[n]=f}if(r.CMapReaderFactory=r.CMapReaderFactory||DefaultCMapReaderFactory,r.StandardFontDataFactory=r.StandardFontDataFactory||DefaultStandardFontDataFactory,r.ignoreErrors=r.stopAtErrors!==!0,r.fontExtraProperties=r.fontExtraProperties===!0,r.pdfBug=r.pdfBug===!0,r.enableXfa=r.enableXfa===!0,(!Number.isInteger(r.rangeChunkSize)||r.rangeChunkSize<1)&&(r.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof r.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(r.docBaseUrl))&&(r.docBaseUrl=null),(!Number.isInteger(r.maxImageSize)||r.maxImageSize<-1)&&(r.maxImageSize=-1),typeof r.cMapUrl!="string"&&(r.cMapUrl=null),typeof r.standardFontDataUrl!="string"&&(r.standardFontDataUrl=null),typeof r.useWorkerFetch!="boolean"&&(r.useWorkerFetch=r.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&r.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(r.cMapUrl,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(r.standardFontDataUrl,document.baseURI)),typeof r.isEvalSupported!="boolean"&&(r.isEvalSupported=!0),typeof r.isOffscreenCanvasSupported!="boolean"&&(r.isOffscreenCanvasSupported=!_is_node.isNodeJS),typeof r.disableFontFace!="boolean"&&(r.disableFontFace=_is_node.isNodeJS),typeof r.useSystemFonts!="boolean"&&(r.useSystemFonts=!_is_node.isNodeJS&&!r.disableFontFace),(typeof r.ownerDocument!="object"||r.ownerDocument===null)&&(r.ownerDocument=globalThis.document),typeof r.disableRange!="boolean"&&(r.disableRange=!1),typeof r.disableStream!="boolean"&&(r.disableStream=!1),typeof r.disableAutoFetch!="boolean"&&(r.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(r.verbosity),!o){const n={verbosity:r.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};o=n.port?PDFWorker.fromPort(n):new PDFWorker(n),e._worker=o}const t=e.docId;return o.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");const n=_fetchDocument(o,r,c,t),f=new Promise(function(a){let T;c?T=new _transport_stream.PDFDataTransportStream({length:r.length,initialData:r.initialData,progressiveDone:r.progressiveDone,contentDispositionFilename:r.contentDispositionFilename,disableRange:r.disableRange,disableStream:r.disableStream},c):r.data||(T=createPDFNetworkStream({url:r.url,length:r.length,httpHeaders:r.httpHeaders,withCredentials:r.withCredentials,rangeChunkSize:r.rangeChunkSize,disableRange:r.disableRange,disableStream:r.disableStream})),a(T)});return Promise.all([n,f]).then(function([a,T]){if(e.destroyed)throw new Error("Loading aborted");const O=new _message_handler.MessageHandler(t,a,o.port),X=new WorkerTransport(O,e,T,r);e._transport=X,O.send("Ready",null)})}).catch(e._capability.reject),e}async function _fetchDocument(s,e,r,c){if(s.destroyed)throw new Error("Worker was destroyed");r&&(e.length=r.length,e.initialData=r.initialData,e.progressiveDone=r.progressiveDone,e.contentDispositionFilename=r.contentDispositionFilename);const o=e.data?[e.data.buffer]:null,t=await s.messageHandler.sendWithPromise("GetDocRequest",{docId:c,apiVersion:"3.3.122",data:e.data,password:e.password,disableAutoFetch:e.disableAutoFetch,rangeChunkSize:e.rangeChunkSize,length:e.length,docBaseUrl:e.docBaseUrl,enableXfa:e.enableXfa,evaluatorOptions:{maxImageSize:e.maxImageSize,disableFontFace:e.disableFontFace,ignoreErrors:e.ignoreErrors,isEvalSupported:e.isEvalSupported,isOffscreenCanvasSupported:e.isOffscreenCanvasSupported,fontExtraProperties:e.fontExtraProperties,useSystemFonts:e.useSystemFonts,cMapUrl:e.useWorkerFetch?e.cMapUrl:null,standardFontDataUrl:e.useWorkerFetch?e.standardFontDataUrl:null}},o);if(s.destroyed)throw new Error("Worker was destroyed");return t}const Z=class Z{constructor(){de(this,P,null);this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${et(Z,me)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get onUnsupportedFeature(){return E(this,P)}set onUnsupportedFeature(e){(0,_display_utils.deprecated)("The PDFDocumentLoadingTask onUnsupportedFeature property will be removed in the future."),pe(this,P,e)}get promise(){return this._capability.promise}async destroy(){var e;this.destroyed=!0,await((e=this._transport)==null?void 0:e.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};me=new WeakMap,P=new WeakMap,de(Z,me,0);let PDFDocumentLoadingTask=Z;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,r,c=!1,o=null){this.length=e,this.initialData=r,this.progressiveDone=c,this.contentDispositionFilename=o,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,r){for(const c of this._rangeListeners)c(e,r)}onDataProgress(e,r){this._readyCapability.promise.then(()=>{for(const c of this._progressListeners)c(e,r)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const r of this._progressiveReadListeners)r(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,r){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,r){this._pdfInfo=e,this._transport=r}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(e,r,c,o,t=!1){this._pageIndex=e,this._pageInfo=r,this._ownerDocument=o,this._transport=c,this._stats=t?new _display_utils.StatTimer:null,this._pdfBug=t,this.commonObjs=c.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:r=this.rotate,offsetX:c=0,offsetY:o=0,dontFlip:t=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:r,offsetX:c,offsetY:o,dontFlip:t})}getAnnotations({intent:e="display"}={}){const r=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,r.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:r,intent:c="display",annotationMode:o=_util.AnnotationMode.ENABLE,transform:t=null,canvasFactory:n=null,background:f=null,optionalContentConfigPromise:a=null,annotationCanvasMap:T=null,pageColors:O=null,printAnnotationStorage:X=null}){var le,re;(le=this._stats)==null||le.time("Overall");const Y=this._transport.getRenderingIntent(c,o,X);this.pendingCleanup=!1,a||(a=this._transport.getOptionalContentConfig());let _e=this._intentStates.get(Y.cacheKey);_e||(_e=Object.create(null),this._intentStates.set(Y.cacheKey,_e)),_e.streamReaderCancelTimeout&&(clearTimeout(_e.streamReaderCancelTimeout),_e.streamReaderCancelTimeout=null);const ue=n||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),J=!!(Y.renderingIntent&_util.RenderingIntentFlag.PRINT);_e.displayReadyCapability||(_e.displayReadyCapability=(0,_util.createPromiseCapability)(),_e.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(re=this._stats)==null||re.time("Page Request"),this._pumpOperatorList(Y));const K=y=>{var p,g;_e.renderTasks.delete($),(this.cleanupAfterRender||J)&&(this.pendingCleanup=!0),this._tryCleanup(),y?($.capability.reject(y),this._abortOperatorList({intentState:_e,reason:y instanceof Error?y:new Error(y)})):$.capability.resolve(),(p=this._stats)==null||p.timeEnd("Rendering"),(g=this._stats)==null||g.timeEnd("Overall")},$=new InternalRenderTask({callback:K,params:{canvasContext:e,viewport:r,transform:t,background:f},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:T,operatorList:_e.operatorList,pageIndex:this._pageIndex,canvasFactory:ue,useRequestAnimationFrame:!J,pdfBug:this._pdfBug,pageColors:O});(_e.renderTasks||(_e.renderTasks=new Set)).add($);const k=$.task;return Promise.all([_e.displayReadyCapability.promise,a]).then(([y,p])=>{var g;if(this.pendingCleanup){K();return}(g=this._stats)==null||g.time("Rendering"),$.initializeGraphics({transparency:y,optionalContentConfig:p}),$.operatorListChanged()}).catch(K),k}getOperatorList({intent:e="display",annotationMode:r=_util.AnnotationMode.ENABLE,printAnnotationStorage:c=null}={}){var a;function o(){n.operatorList.lastChunk&&(n.opListReadCapability.resolve(n.operatorList),n.renderTasks.delete(f))}const t=this._transport.getRenderingIntent(e,r,c,!0);let n=this._intentStates.get(t.cacheKey);n||(n=Object.create(null),this._intentStates.set(t.cacheKey,n));let f;return n.opListReadCapability||(f=Object.create(null),f.operatorListChanged=o,n.opListReadCapability=(0,_util.createPromiseCapability)(),(n.renderTasks||(n.renderTasks=new Set)).add(f),n.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(a=this._stats)==null||a.time("Page Request"),this._pumpOperatorList(t)),n.opListReadCapability.promise}streamTextContent({disableCombineTextItems:e=!1,includeMarkedContent:r=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:e!==!0,includeMarkedContent:r===!0},{highWaterMark:100,size(o){return o.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(c=>_xfa_text.XfaText.textContent(c));const r=this.streamTextContent(e);return new Promise(function(c,o){function t(){n.read().then(function({value:a,done:T}){if(T){c(f);return}Object.assign(f.styles,a.styles),f.items.push(...a.items),t()},o)}const n=r.getReader(),f={items:[],styles:Object.create(null)};t()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const r of this._intentStates.values())if(this._abortOperatorList({intentState:r,reason:new Error("Page was destroyed."),force:!0}),!r.opListReadCapability)for(const c of r.renderTasks)e.push(c.completed),c.cancel();this.objs.clear();for(const r of this._bitmaps)r.close();return this._bitmaps.clear(),this.pendingCleanup=!1,Promise.all(e)}cleanup(e=!1){return this.pendingCleanup=!0,this._tryCleanup(e)}_tryCleanup(e=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:r,operatorList:c}of this._intentStates.values())if(r.size>0||!c.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),e&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const r of this._bitmaps)r.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(e,r){var o,t;const c=this._intentStates.get(r);c&&((o=this._stats)==null||o.timeEnd("Page Request"),(t=c.displayReadyCapability)==null||t.resolve(e))}_renderPageChunk(e,r){for(let c=0,o=e.length;c<o;c++)r.operatorList.fnArray.push(e.fnArray[c]),r.operatorList.argsArray.push(e.argsArray[c]);r.operatorList.lastChunk=e.lastChunk,r.operatorList.separateAnnots=e.separateAnnots;for(const c of r.renderTasks)c.operatorListChanged();e.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:e,cacheKey:r,annotationStorageMap:c}){const t=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:r,annotationStorage:c}).getReader(),n=this._intentStates.get(r);n.streamReader=t;const f=()=>{t.read().then(({value:a,done:T})=>{if(T){n.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(a,n),f())},a=>{if(n.streamReader=null,!this._transport.destroyed){if(n.operatorList){n.operatorList.lastChunk=!0;for(const T of n.renderTasks)T.operatorListChanged();this._tryCleanup()}if(n.displayReadyCapability)n.displayReadyCapability.reject(a);else if(n.opListReadCapability)n.opListReadCapability.reject(a);else throw a}})};f()}_abortOperatorList({intentState:e,reason:r,force:c=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!c){if(e.renderTasks.size>0)return;if(r instanceof _display_utils.RenderingCancelledException){let o=RENDERING_CANCELLED_TIMEOUT;r.extraDelay>0&&r.extraDelay<1e3&&(o+=r.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:r,force:!0})},o);return}}if(e.streamReader.cancel(new _util.AbortException(r.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[o,t]of this._intentStates)if(t===e){this._intentStates.delete(o);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){de(this,x,[]);de(this,V,Promise.resolve())}postMessage(e,r){const c={data:structuredClone(e,r)};E(this,V).then(()=>{for(const o of E(this,x))o.call(this,c)})}addEventListener(e,r){E(this,x).push(r)}removeEventListener(e,r){const c=E(this,x).indexOf(r);E(this,x).splice(c,1)}terminate(){E(this,x).length=0}}x=new WeakMap,V=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const s=(ne=document==null?void 0:document.currentScript)==null?void 0:ne.src;s&&(PDFWorkerUtil.fallbackWorkerSrc=s.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(s,e){let r;try{if(r=new URL(s),!r.origin||r.origin==="null")return!1}catch{return!1}const c=new URL(e,r);return r.origin===c.origin},PDFWorkerUtil.createCDNWrapper=function(s){const e=`importScripts("${s}");`;return URL.createObjectURL(new Blob([e]))}}const _PDFWorker=class _PDFWorker{constructor({name:s=null,port:e=null,verbosity:r=(0,_util.getVerbosityLevel)()}={}){if(e&&E(_PDFWorker,B).has(e))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=s,this.destroyed=!1,this.verbosity=r,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,e){E(_PDFWorker,B).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(s){this._port=s,this._messageHandler=new _message_handler.MessageHandler("main","worker",s),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:s}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,s)||(s=PDFWorkerUtil.createCDNWrapper(new URL(s,window.location).href));const e=new Worker(s),r=new _message_handler.MessageHandler("main","worker",e),c=()=>{e.removeEventListener("error",o),r.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},o=()=>{this._webWorker||c()};e.addEventListener("error",o),r.on("test",n=>{if(e.removeEventListener("error",o),this.destroyed){c();return}n?(this._messageHandler=r,this._port=e,this._webWorker=e,this._readyCapability.resolve(),r.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),r.destroy(),e.terminate())}),r.on("ready",n=>{if(e.removeEventListener("error",o),this.destroyed){c();return}try{t()}catch{this._setupFakeWorker()}});const t=()=>{const n=new Uint8Array;r.send("test",n,[n.buffer])};t();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(s=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new LoopbackPort;this._port=e;const r=`fake${PDFWorkerUtil.fakeWorkerId++}`,c=new _message_handler.MessageHandler(r+"_worker",r,e);s.setup(c,e);const o=new _message_handler.MessageHandler(r,r+"_worker",e);this._messageHandler=o,this._readyCapability.resolve(),o.send("configure",{verbosity:this.verbosity})}).catch(s=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${s.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),E(_PDFWorker,B).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(s){if(!(s!=null&&s.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return E(this,B).has(s.port)?E(this,B).get(s.port):new _PDFWorker(s)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var s;try{return((s=globalThis.pdfjsWorker)==null?void 0:s.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};B=new WeakMap,de(_PDFWorker,B,new WeakMap);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(e,r,c,o){de(this,R,new Map);de(this,N,new Map);de(this,h,null);this.messageHandler=e,this.loadingTask=r,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:o.ownerDocument,styleElement:o.styleElement}),this._params=o,o.useWorkerFetch||(this.CMapReaderFactory=new o.CMapReaderFactory({baseUrl:o.cMapUrl,isCompressed:o.cMapPacked}),this.StandardFontDataFactory=new o.StandardFontDataFactory({baseUrl:o.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=c,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(e,r=_util.AnnotationMode.ENABLE,c=null,o=!1){let t=_util.RenderingIntentFlag.DISPLAY,n=null;switch(e){case"any":t=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":t=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${e}`)}switch(r){case _util.AnnotationMode.DISABLE:t+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:t+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:t+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,n=(t&_util.RenderingIntentFlag.PRINT&&c instanceof _annotation_storage.PrintAnnotationStorage?c:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${r}`)}return o&&(t+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:t,cacheKey:`${t}_${_annotation_storage.AnnotationStorage.getHash(n)}`,annotationStorageMap:n}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const c of E(this,R).values())e.push(c._destroy());E(this,R).clear(),E(this,N).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const r=this.messageHandler.sendWithPromise("Terminate",null);return e.push(r),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),pe(this,h,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:r}=this;e.on("GetReader",(c,o)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=t=>{this._lastProgress={loaded:t.loaded,total:t.total}},o.onPull=()=>{this._fullReader.read().then(function({value:t,done:n}){if(n){o.close();return}(0,_util.assert)(t instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),o.enqueue(new Uint8Array(t),1,[t])}).catch(t=>{o.error(t)})},o.onCancel=t=>{this._fullReader.cancel(t),o.ready.catch(n=>{if(!this.destroyed)throw n})}}),e.on("ReaderHeadersReady",c=>{const o=(0,_util.createPromiseCapability)(),t=this._fullReader;return t.headersReady.then(()=>{var n;(!t.isStreamingSupported||!t.isRangeSupported)&&(this._lastProgress&&((n=r.onProgress)==null||n.call(r,this._lastProgress)),t.onProgress=f=>{var a;(a=r.onProgress)==null||a.call(r,{loaded:f.loaded,total:f.total})}),o.resolve({isStreamingSupported:t.isStreamingSupported,isRangeSupported:t.isRangeSupported,contentLength:t.contentLength})},o.reject),o.promise}),e.on("GetRangeReader",(c,o)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const t=this._networkStream.getRangeReader(c.begin,c.end);if(!t){o.close();return}o.onPull=()=>{t.read().then(function({value:n,done:f}){if(f){o.close();return}(0,_util.assert)(n instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),o.enqueue(new Uint8Array(n),1,[n])}).catch(n=>{o.error(n)})},o.onCancel=n=>{t.cancel(n),o.ready.catch(f=>{if(!this.destroyed)throw f})}}),e.on("GetDoc",({pdfInfo:c})=>{this._numPages=c.numPages,this._htmlForXfa=c.htmlForXfa,delete c.htmlForXfa,r._capability.resolve(new PDFDocumentProxy(c,this))}),e.on("DocException",function(c){let o;switch(c.name){case"PasswordException":o=new _util.PasswordException(c.message,c.code);break;case"InvalidPDFException":o=new _util.InvalidPDFException(c.message);break;case"MissingPDFException":o=new _util.MissingPDFException(c.message);break;case"UnexpectedResponseException":o=new _util.UnexpectedResponseException(c.message,c.status);break;case"UnknownErrorException":o=new _util.UnknownErrorException(c.message,c.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}r._capability.reject(o)}),e.on("PasswordRequest",c=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),r.onPassword){const o=t=>{t instanceof Error?this._passwordCapability.reject(t):this._passwordCapability.resolve({password:t})};try{r.onPassword(o,c.code)}catch(t){this._passwordCapability.reject(t)}}else this._passwordCapability.reject(new _util.PasswordException(c.message,c.code));return this._passwordCapability.promise}),e.on("DataLoaded",c=>{var o;(o=r.onProgress)==null||o.call(r,{loaded:c.length,total:c.length}),this.downloadInfoCapability.resolve(c)}),e.on("StartRenderPage",c=>{if(this.destroyed)return;E(this,R).get(c.pageIndex)._startRenderPage(c.transparency,c.cacheKey)}),e.on("commonobj",([c,o,t])=>{var n;if(!this.destroyed&&!this.commonObjs.has(c))switch(o){case"Font":const f=this._params;if("error"in t){const O=t.error;(0,_util.warn)(`Error during font loading: ${O}`),this.commonObjs.resolve(c,O);break}let a=null;f.pdfBug&&((n=globalThis.FontInspector)!=null&&n.enabled)&&(a={registerFont(O,X){globalThis.FontInspector.fontAdded(O,X)}});const T=new _font_loader.FontFaceObject(t,{isEvalSupported:f.isEvalSupported,disableFontFace:f.disableFontFace,ignoreErrors:f.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:a});this.fontLoader.bind(T).catch(O=>e.sendWithPromise("FontFallback",{id:c})).finally(()=>{!f.fontExtraProperties&&T.data&&(T.data=null),this.commonObjs.resolve(c,T)});break;case"FontPath":case"Image":this.commonObjs.resolve(c,t);break;default:throw new Error(`Got unknown common object type ${o}`)}}),e.on("obj",([c,o,t,n])=>{var a;if(this.destroyed)return;const f=E(this,R).get(o);if(!f.objs.has(c))switch(t){case"Image":f.objs.resolve(c,n);const T=8e6;if(n){let O;if(n.bitmap){const{bitmap:X,width:Y,height:_e}=n;O=Y*_e*4,f._bitmaps.add(X)}else O=((a=n.data)==null?void 0:a.length)||0;O>T&&(f.cleanupAfterRender=!0)}break;case"Pattern":f.objs.resolve(c,n);break;default:throw new Error(`Got unknown object type ${t}`)}}),e.on("DocProgress",c=>{var o;this.destroyed||(o=r.onProgress)==null||o.call(r,{loaded:c.loaded,total:c.total})}),e.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),e.on("FetchBuiltInCMap",c=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(c):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",c=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(c):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:e}){var r,c;this.destroyed||(c=(r=this.loadingTask).onUnsupportedFeature)==null||c.call(r,e)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var e;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((e=this._fullReader)==null?void 0:e.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const r=e-1,c=E(this,N).get(r);if(c)return c;const o=this.messageHandler.sendWithPromise("GetPage",{pageIndex:r}).then(t=>{if(this.destroyed)throw new Error("Transport destroyed");const n=new PDFPageProxy(r,t,this,this._params.ownerDocument,this._params.pdfBug);return E(this,R).set(r,n),n});return E(this,N).set(r,o),o}getPageIndex(e){return typeof e!="object"||e===null||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,r){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:r})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return E(this,h)||pe(this,h,this.messageHandler.sendWithPromise("GetMetadata",null).then(e=>{var r,c;return{info:e[0],metadata:e[1]?new _metadata.Metadata(e[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((c=this._fullReader)==null?void 0:c.contentLength)??null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const r of E(this,R).values())if(!r.cleanup())throw new Error(`startCleanup: Page ${r.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),pe(this,h,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const e=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e.disableAutoFetch,enableXfa:e.enableXfa})}}R=new WeakMap,N=new WeakMap,h=new WeakMap;class PDFObjects{constructor(){de(this,L);de(this,m,Object.create(null))}get(e,r=null){if(r){const o=te(this,L,ut).call(this,e);return o.capability.promise.then(()=>r(o.data)),null}const c=E(this,m)[e];if(!(c!=null&&c.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${e}.`);return c.data}has(e){const r=E(this,m)[e];return(r==null?void 0:r.capability.settled)||!1}resolve(e,r=null){const c=te(this,L,ut).call(this,e);c.data=r,c.capability.resolve()}clear(){pe(this,m,Object.create(null))}}m=new WeakMap,L=new WeakSet,ut=function(e){const r=E(this,m)[e];return r||(E(this,m)[e]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(e){de(this,u,null);pe(this,u,e),this.onContinue=null}get promise(){return E(this,u).capability.promise}cancel(e=0){E(this,u).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=E(this,u).operatorList;if(!e)return!1;const{annotationCanvasMap:r}=E(this,u);return e.form||e.canvas&&(r==null?void 0:r.size)>0}}u=new WeakMap,exports.RenderTask=RenderTask;const d=class d{constructor({callback:e,params:r,objs:c,commonObjs:o,annotationCanvasMap:t,operatorList:n,pageIndex:f,canvasFactory:a,useRequestAnimationFrame:T=!1,pdfBug:O=!1,pageColors:X=null}){this.callback=e,this.params=r,this.objs=c,this.commonObjs=o,this.annotationCanvasMap=t,this.operatorListIdx=null,this.operatorList=n,this._pageIndex=f,this.canvasFactory=a,this._pdfBug=O,this.pageColors=X,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=T===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=r.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:r}){var f,a;if(this.cancelled)return;if(this._canvas){if(E(d,l).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");E(d,l).add(this._canvas)}this._pdfBug&&((f=globalThis.StepperManager)!=null&&f.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:c,viewport:o,transform:t,background:n}=this.params;this.gfx=new _canvas.CanvasGraphics(c,this.commonObjs,this.objs,this.canvasFactory,{optionalContentConfig:r},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:t,viewport:o,transparency:e,background:n}),this.operatorListIdx=0,this.graphicsReady=!0,(a=this.graphicsReadyCallback)==null||a.call(this)}cancel(e=null,r=0){var c;this.running=!1,this.cancelled=!0,(c=this.gfx)==null||c.endDrawing(),this._canvas&&E(d,l).delete(this._canvas),this.callback(e||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",r))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&E(d,l).delete(this._canvas),this.callback())))}};l=new WeakMap,de(d,l,new WeakSet);let InternalRenderTask=d;const version="3.3.122";exports.version=version;const build="562045607";exports.build=build},(me,P,Z)=>{var N,h,m,Kt,C;Object.defineProperty(P,"__esModule",{value:!0}),P.PrintAnnotationStorage=P.AnnotationStorage=void 0;var x=Z(1),V=Z(4),ne=Z(8);class B{constructor(){de(this,m);de(this,N,!1);de(this,h,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(l,d){const s=E(this,h).get(l);return s===void 0?d:Object.assign(d,s)}getRawValue(l){return E(this,h).get(l)}remove(l){if(E(this,h).delete(l),E(this,h).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const d of E(this,h).values())if(d instanceof V.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(l,d){const s=E(this,h).get(l);let e=!1;if(s!==void 0)for(const[r,c]of Object.entries(d))s[r]!==c&&(e=!0,s[r]=c);else e=!0,E(this,h).set(l,d);e&&te(this,m,Kt).call(this),d instanceof V.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(d.constructor._type)}has(l){return E(this,h).has(l)}getAll(){return E(this,h).size>0?(0,x.objectFromMap)(E(this,h)):null}get size(){return E(this,h).size}resetModified(){E(this,N)&&(pe(this,N,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new R(this)}get serializable(){if(E(this,h).size===0)return null;const l=new Map;for(const[d,s]of E(this,h)){const e=s instanceof V.AnnotationEditor?s.serialize():s;e&&l.set(d,e)}return l}static getHash(l){if(!l)return"";const d=new ne.MurmurHash3_64;for(const[s,e]of l)d.update(`${s}:${JSON.stringify(e)}`);return d.hexdigest()}}N=new WeakMap,h=new WeakMap,m=new WeakSet,Kt=function(){E(this,N)||(pe(this,N,!0),typeof this.onSetModified=="function"&&this.onSetModified())},P.AnnotationStorage=B;class R extends B{constructor(d){super();de(this,C,null);pe(this,C,structuredClone(d.serializable))}get print(){(0,x.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return E(this,C)}}C=new WeakMap,P.PrintAnnotationStorage=R},(me,P,Z)=>{var B,R,N,h,m,L;Object.defineProperty(P,"__esModule",{value:!0}),P.AnnotationEditor=void 0;var x=Z(5),V=Z(1);const C=class C{constructor(l){de(this,B,this.focusin.bind(this));de(this,R,this.focusout.bind(this));de(this,N,!1);de(this,h,!1);de(this,m,!1);Fe(this,"_uiManager",null);de(this,L,C._zIndex++);this.constructor===C&&(0,V.unreachable)("Cannot initialize AnnotationEditor."),this.parent=l.parent,this.id=l.id,this.width=this.height=null,this.pageIndex=l.parent.pageIndex,this.name=l.name,this.div=null,this._uiManager=l.uiManager;const{rotation:d,rawDims:{pageWidth:s,pageHeight:e,pageX:r,pageY:c}}=this.parent.viewport;this.rotation=d,this.pageDimensions=[s,e],this.pageTranslation=[r,c];const[o,t]=this.parentDimensions;this.x=l.x/o,this.y=l.y/t,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,V.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(l){this._uiManager.addCommands(l)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=E(this,L)}setParent(l){l!==null&&(this.pageIndex=l.pageIndex,this.pageDimensions=l.pageDimensions),this.parent=l}focusin(l){E(this,N)?pe(this,N,!1):this.parent.setSelected(this)}focusout(l){var s;if(!this.isAttachedToDOM)return;const d=l.relatedTarget;d!=null&&d.closest(`#${this.id}`)||(l.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(l){const d=this.parent.div.getBoundingClientRect();this.startX=l.clientX-d.x,this.startY=l.clientY-d.y,l.dataTransfer.setData("text/plain",this.id),l.dataTransfer.effectAllowed="move"}setAt(l,d,s,e){const[r,c]=this.parentDimensions;[s,e]=this.screenToPageTranslation(s,e),this.x=(l+s)/r,this.y=(d+e)/c,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(l,d){const[s,e]=this.parentDimensions;[l,d]=this.screenToPageTranslation(l,d),this.x+=l/s,this.y+=d/e,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(l,d){switch(this.parentRotation){case 90:return[d,-l];case 180:return[-l,-d];case 270:return[-d,l];default:return[l,d]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return this._uiManager.viewParameters.rotation}get parentDimensions(){const{realScale:l}=this._uiManager.viewParameters,[d,s]=this.pageDimensions;return[d*l,s*l]}setDims(l,d){const[s,e]=this.parentDimensions;this.div.style.width=`${100*l/s}%`,this.div.style.height=`${100*d/e}%`}fixDims(){const{style:l}=this.div,{height:d,width:s}=l,e=s.endsWith("%"),r=d.endsWith("%");if(e&&r)return;const[c,o]=this.parentDimensions;e||(l.width=`${100*parseFloat(s)/c}%`),r||(l.height=`${100*parseFloat(d)/o}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",E(this,B)),this.div.addEventListener("focusout",E(this,R));const[l,d]=this.getInitialTranslation();return this.translate(l,d),(0,x.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(l){const{isMac:d}=V.FeatureTest.platform;if(l.button!==0||l.ctrlKey&&d){l.preventDefault();return}l.ctrlKey&&!d||l.shiftKey||l.metaKey&&d?this.parent.toggleSelected(this):this.parent.setSelected(this),pe(this,N,!0)}getRect(l,d){const s=this.parentScale,[e,r]=this.pageDimensions,[c,o]=this.pageTranslation,t=l/s,n=d/s,f=this.x*e,a=this.y*r,T=this.width*e,O=this.height*r;switch(this.rotation){case 0:return[f+t+c,r-a-n-O+o,f+t+T+c,r-a-n+o];case 90:return[f+n+c,r-a+t+o,f+n+O+c,r-a+t+T+o];case 180:return[f-t-T+c,r-a+n+o,f-t+c,r-a+n+O+o];case 270:return[f-n-O+c,r-a-t-T+o,f-n+c,r-a-t+o];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(l,d){const[s,e,r,c]=l,o=r-s,t=c-e;switch(this.rotation){case 0:return[s,d-c,o,t];case 90:return[s,d-e,t,o];case 180:return[r,d-e,o,t];case 270:return[r,d-c,t,o];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){pe(this,m,!0)}disableEditMode(){pe(this,m,!1)}isInEditMode(){return E(this,m)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var l;(l=this.div)==null||l.addEventListener("focusin",E(this,B))}serialize(){(0,V.unreachable)("An editor must be serializable")}static deserialize(l,d,s){const e=new this.prototype.constructor({parent:d,id:d.getNextId(),uiManager:s});e.rotation=l.rotation;const[r,c]=e.pageDimensions,[o,t,n,f]=e.getRectInCurrentCoords(l.rect,c);return e.x=o/r,e.y=t/c,e.width=n/r,e.height=f/c,e}remove(){this.div.removeEventListener("focusin",E(this,B)),this.div.removeEventListener("focusout",E(this,R)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var l;(l=this.div)==null||l.classList.add("selectedEditor")}unselect(){var l;(l=this.div)==null||l.classList.remove("selectedEditor")}updateParams(l,d){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return E(this,h)}set isEditing(l){pe(this,h,l),l?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};B=new WeakMap,R=new WeakMap,N=new WeakMap,h=new WeakMap,m=new WeakMap,L=new WeakMap,Fe(C,"_colorManager",new x.ColorManager),Fe(C,"_zIndex",1);let ne=C;P.AnnotationEditor=ne},(me,P,Z)=>{var C,u,l,d,s,e,Yt,o,t,n,f,a,T,O,X,Y,_e,ue,J,K,$,k,le,re,y,p,g,M,W,z,U,Qt,ft,Jt,Zt,Ne,Ke,ei,ti,pt,Ye,gt;Object.defineProperty(P,"__esModule",{value:!0}),P.KeyboardManager=P.CommandManager=P.ColorManager=P.AnnotationEditorUIManager=void 0,P.bindEvents=ne,P.opacityToHex=B;var x=Z(1),V=Z(6);function ne(H,S,F){for(const D of F)S.addEventListener(D,H[D].bind(H))}function B(H){return Math.round(Math.min(255,Math.max(1,255*H))).toString(16).padStart(2,"0")}class R{constructor(){de(this,C,0)}getId(){return`${x.AnnotationEditorPrefix}${et(this,C)._++}`}}C=new WeakMap;class N{constructor(S=128){de(this,u,[]);de(this,l,!1);de(this,d);de(this,s,-1);pe(this,d,S)}add({cmd:S,undo:F,mustExec:D,type:q=NaN,overwriteIfSameType:oe=!1,keepUndo:fe=!1}){if(D&&S(),E(this,l))return;const ge={cmd:S,undo:F,type:q};if(E(this,s)===-1){E(this,u).length>0&&(E(this,u).length=0),pe(this,s,0),E(this,u).push(ge);return}if(oe&&E(this,u)[E(this,s)].type===q){fe&&(ge.undo=E(this,u)[E(this,s)].undo),E(this,u)[E(this,s)]=ge;return}const be=E(this,s)+1;be===E(this,d)?E(this,u).splice(0,1):(pe(this,s,be),be<E(this,u).length&&E(this,u).splice(be)),E(this,u).push(ge)}undo(){E(this,s)!==-1&&(pe(this,l,!0),E(this,u)[E(this,s)].undo(),pe(this,l,!1),pe(this,s,E(this,s)-1))}redo(){E(this,s)<E(this,u).length-1&&(pe(this,s,E(this,s)+1),pe(this,l,!0),E(this,u)[E(this,s)].cmd(),pe(this,l,!1))}hasSomethingToUndo(){return E(this,s)!==-1}hasSomethingToRedo(){return E(this,s)<E(this,u).length-1}destroy(){pe(this,u,null)}}u=new WeakMap,l=new WeakMap,d=new WeakMap,s=new WeakMap,P.CommandManager=N;class h{constructor(S){de(this,e);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:F}=x.FeatureTest.platform;for(const[D,q]of S)for(const oe of D){const fe=oe.startsWith("mac+");F&&fe?(this.callbacks.set(oe.slice(4),q),this.allKeys.add(oe.split("+").at(-1))):!F&&!fe&&(this.callbacks.set(oe,q),this.allKeys.add(oe.split("+").at(-1)))}}exec(S,F){if(!this.allKeys.has(F.key))return;const D=this.callbacks.get(te(this,e,Yt).call(this,F));D&&(D.bind(S)(),F.stopPropagation(),F.preventDefault())}}e=new WeakSet,Yt=function(S){S.altKey&&this.buffer.push("alt"),S.ctrlKey&&this.buffer.push("ctrl"),S.metaKey&&this.buffer.push("meta"),S.shiftKey&&this.buffer.push("shift"),this.buffer.push(S.key);const F=this.buffer.join("+");return this.buffer.length=0,F},P.KeyboardManager=h;const c=class c{get _colors(){const S=new Map([["CanvasText",null],["Canvas",null]]);return(0,V.getColorValues)(S),(0,x.shadow)(this,"_colors",S)}convert(S){const F=(0,V.getRGB)(S);if(!window.matchMedia("(forced-colors: active)").matches)return F;for(const[D,q]of this._colors)if(q.every((oe,fe)=>oe===F[fe]))return c._colorsMapping.get(D);return F}getHexCode(S){const F=this._colors.get(S);return F?x.Util.makeHexColor(...F):S}};Fe(c,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let m=c;P.ColorManager=m;const G=class G{constructor(S,F,D){de(this,U);de(this,o,null);de(this,t,new Map);de(this,n,new Map);de(this,f,null);de(this,a,new N);de(this,T,0);de(this,O,null);de(this,X,new Set);de(this,Y,null);de(this,_e,new R);de(this,ue,!1);de(this,J,x.AnnotationEditorType.NONE);de(this,K,new Set);de(this,$,this.copy.bind(this));de(this,k,this.cut.bind(this));de(this,le,this.paste.bind(this));de(this,re,this.keydown.bind(this));de(this,y,this.onEditingAction.bind(this));de(this,p,this.onPageChanging.bind(this));de(this,g,this.onScaleChanging.bind(this));de(this,M,this.onRotationChanging.bind(this));de(this,W,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});de(this,z,null);pe(this,z,S),pe(this,Y,F),E(this,Y)._on("editingaction",E(this,y)),E(this,Y)._on("pagechanging",E(this,p)),E(this,Y)._on("scalechanging",E(this,g)),E(this,Y)._on("rotationchanging",E(this,M)),pe(this,f,D),this.viewParameters={realScale:V.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){te(this,U,ft).call(this),E(this,Y)._off("editingaction",E(this,y)),E(this,Y)._off("pagechanging",E(this,p)),E(this,Y)._off("scalechanging",E(this,g)),E(this,Y)._off("rotationchanging",E(this,M));for(const S of E(this,n).values())S.destroy();E(this,n).clear(),E(this,t).clear(),E(this,X).clear(),pe(this,o,null),E(this,K).clear(),E(this,a).destroy()}onPageChanging({pageNumber:S}){pe(this,T,S-1)}focusMainContainer(){E(this,z).focus()}addShouldRescale(S){E(this,X).add(S)}removeShouldRescale(S){E(this,X).delete(S)}onScaleChanging({scale:S}){this.commitOrRemove(),this.viewParameters.realScale=S*V.PixelsPerInch.PDF_TO_CSS_UNITS;for(const F of E(this,X))F.onScaleChanging()}onRotationChanging({pagesRotation:S}){this.commitOrRemove(),this.viewParameters.rotation=S}addToAnnotationStorage(S){!S.isEmpty()&&E(this,f)&&!E(this,f).has(S.id)&&E(this,f).setValue(S.id,S)}copy(S){if(S.preventDefault(),E(this,o)&&E(this,o).commitOrRemove(),!this.hasSelection)return;const F=[];for(const D of E(this,K))D.isEmpty()||F.push(D.serialize());F.length!==0&&S.clipboardData.setData("application/pdfjs",JSON.stringify(F))}cut(S){this.copy(S),this.delete()}paste(S){S.preventDefault();let F=S.clipboardData.getData("application/pdfjs");if(!F)return;try{F=JSON.parse(F)}catch(q){(0,x.warn)(`paste: "${q.message}".`);return}if(!Array.isArray(F))return;this.unselectAll();const D=E(this,n).get(E(this,T));try{const q=[];for(const ge of F){const be=D.deserialize(ge);if(!be)return;q.push(be)}const oe=()=>{for(const ge of q)te(this,U,pt).call(this,ge);te(this,U,gt).call(this,q)},fe=()=>{for(const ge of q)ge.remove()};this.addCommands({cmd:oe,undo:fe,mustExec:!0})}catch(q){(0,x.warn)(`paste: "${q.message}".`)}}keydown(S){var F;(F=this.getActive())!=null&&F.shouldGetKeyboardEvents()||G._keyboardManager.exec(this,S)}onEditingAction(S){["undo","redo","delete","selectAll"].includes(S.name)&&this[S.name]()}setEditingState(S){S?(te(this,U,Qt).call(this),te(this,U,Jt).call(this),te(this,U,Ne).call(this,{isEditing:E(this,J)!==x.AnnotationEditorType.NONE,isEmpty:te(this,U,Ye).call(this),hasSomethingToUndo:E(this,a).hasSomethingToUndo(),hasSomethingToRedo:E(this,a).hasSomethingToRedo(),hasSelectedEditor:!1})):(te(this,U,ft).call(this),te(this,U,Zt).call(this),te(this,U,Ne).call(this,{isEditing:!1}))}registerEditorTypes(S){if(!E(this,O)){pe(this,O,S);for(const F of E(this,O))te(this,U,Ke).call(this,F.defaultPropertiesToUpdate)}}getId(){return E(this,_e).getId()}get currentLayer(){return E(this,n).get(E(this,T))}get currentPageIndex(){return E(this,T)}addLayer(S){E(this,n).set(S.pageIndex,S),E(this,ue)?S.enable():S.disable()}removeLayer(S){E(this,n).delete(S.pageIndex)}updateMode(S){if(pe(this,J,S),S===x.AnnotationEditorType.NONE)this.setEditingState(!1),te(this,U,ti).call(this);else{this.setEditingState(!0),te(this,U,ei).call(this);for(const F of E(this,n).values())F.updateMode(S)}}updateToolbar(S){S!==E(this,J)&&E(this,Y).dispatch("switchannotationeditormode",{source:this,mode:S})}updateParams(S,F){if(E(this,O)){for(const D of E(this,K))D.updateParams(S,F);for(const D of E(this,O))D.updateDefaultParams(S,F)}}getEditors(S){const F=[];for(const D of E(this,t).values())D.pageIndex===S&&F.push(D);return F}getEditor(S){return E(this,t).get(S)}addEditor(S){E(this,t).set(S.id,S)}removeEditor(S){var F;E(this,t).delete(S.id),this.unselect(S),(F=E(this,f))==null||F.remove(S.id)}setActiveEditor(S){E(this,o)!==S&&(pe(this,o,S),S&&te(this,U,Ke).call(this,S.propertiesToUpdate))}toggleSelected(S){if(E(this,K).has(S)){E(this,K).delete(S),S.unselect(),te(this,U,Ne).call(this,{hasSelectedEditor:this.hasSelection});return}E(this,K).add(S),S.select(),te(this,U,Ke).call(this,S.propertiesToUpdate),te(this,U,Ne).call(this,{hasSelectedEditor:!0})}setSelected(S){for(const F of E(this,K))F!==S&&F.unselect();E(this,K).clear(),E(this,K).add(S),S.select(),te(this,U,Ke).call(this,S.propertiesToUpdate),te(this,U,Ne).call(this,{hasSelectedEditor:!0})}isSelected(S){return E(this,K).has(S)}unselect(S){S.unselect(),E(this,K).delete(S),te(this,U,Ne).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return E(this,K).size!==0}undo(){E(this,a).undo(),te(this,U,Ne).call(this,{hasSomethingToUndo:E(this,a).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:te(this,U,Ye).call(this)})}redo(){E(this,a).redo(),te(this,U,Ne).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:E(this,a).hasSomethingToRedo(),isEmpty:te(this,U,Ye).call(this)})}addCommands(S){E(this,a).add(S),te(this,U,Ne).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:te(this,U,Ye).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const S=[...E(this,K)],F=()=>{for(const q of S)q.remove()},D=()=>{for(const q of S)te(this,U,pt).call(this,q)};this.addCommands({cmd:F,undo:D,mustExec:!0})}commitOrRemove(){var S;(S=E(this,o))==null||S.commitOrRemove()}selectAll(){for(const S of E(this,K))S.commit();te(this,U,gt).call(this,E(this,t).values())}unselectAll(){if(E(this,o)){E(this,o).commitOrRemove();return}if(E(this,K).size!==0){for(const S of E(this,K))S.unselect();E(this,K).clear(),te(this,U,Ne).call(this,{hasSelectedEditor:!1})}}isActive(S){return E(this,o)===S}getActive(){return E(this,o)}getMode(){return E(this,J)}};o=new WeakMap,t=new WeakMap,n=new WeakMap,f=new WeakMap,a=new WeakMap,T=new WeakMap,O=new WeakMap,X=new WeakMap,Y=new WeakMap,_e=new WeakMap,ue=new WeakMap,J=new WeakMap,K=new WeakMap,$=new WeakMap,k=new WeakMap,le=new WeakMap,re=new WeakMap,y=new WeakMap,p=new WeakMap,g=new WeakMap,M=new WeakMap,W=new WeakMap,z=new WeakMap,U=new WeakSet,Qt=function(){E(this,z).addEventListener("keydown",E(this,re))},ft=function(){E(this,z).removeEventListener("keydown",E(this,re))},Jt=function(){document.addEventListener("copy",E(this,$)),document.addEventListener("cut",E(this,k)),document.addEventListener("paste",E(this,le))},Zt=function(){document.removeEventListener("copy",E(this,$)),document.removeEventListener("cut",E(this,k)),document.removeEventListener("paste",E(this,le))},Ne=function(S){Object.entries(S).some(([D,q])=>E(this,W)[D]!==q)&&E(this,Y).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(E(this,W),S)})},Ke=function(S){E(this,Y).dispatch("annotationeditorparamschanged",{source:this,details:S})},ei=function(){if(!E(this,ue)){pe(this,ue,!0);for(const S of E(this,n).values())S.enable()}},ti=function(){if(this.unselectAll(),E(this,ue)){pe(this,ue,!1);for(const S of E(this,n).values())S.disable()}},pt=function(S){const F=E(this,n).get(S.pageIndex);F?F.addOrRebuild(S):this.addEditor(S)},Ye=function(){if(E(this,t).size===0)return!0;if(E(this,t).size===1)for(const S of E(this,t).values())return S.isEmpty();return!1},gt=function(S){E(this,K).clear();for(const F of S)F.isEmpty()||(E(this,K).add(F),F.select());te(this,U,Ne).call(this,{hasSelectedEditor:!0})},Fe(G,"_keyboardManager",new h([[["ctrl+a","mac+meta+a"],G.prototype.selectAll],[["ctrl+z","mac+meta+z"],G.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],G.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],G.prototype.delete],[["Escape","mac+Escape"],G.prototype.unselectAll]]));let L=G;P.AnnotationEditorUIManager=L},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.StatTimer=P.RenderingCancelledException=P.PixelsPerInch=P.PageViewport=P.PDFDateString=P.DOMStandardFontDataFactory=P.DOMSVGFactory=P.DOMCanvasFactory=P.DOMCMapReaderFactory=P.AnnotationPrefix=void 0,P.deprecated=n,P.getColorValues=X,P.getCurrentTransform=Y,P.getCurrentTransformInverse=_e,P.getFilenameFromUrl=e,P.getPdfFilenameFromUrl=r,P.getRGB=O,P.getXfaPageViewport=T,P.isDataScheme=d,P.isPdfFile=s,P.isValidFetchUrl=o,P.loadScript=t,P.setLayerDimensions=ue;var x=Z(7),V=Z(1);const ne="http://www.w3.org/2000/svg",B="pdfjs_internal_id_";P.AnnotationPrefix=B;const J=class J{};Fe(J,"CSS",96),Fe(J,"PDF",72),Fe(J,"PDF_TO_CSS_UNITS",J.CSS/J.PDF);let R=J;P.PixelsPerInch=R;class N extends x.BaseCanvasFactory{constructor({ownerDocument:$=globalThis.document}={}){super(),this._document=$}_createCanvas($,k){const le=this._document.createElement("canvas");return le.width=$,le.height=k,le}}P.DOMCanvasFactory=N;async function h(K,$=!1){if(o(K,document.baseURI)){const k=await fetch(K);if(!k.ok)throw new Error(k.statusText);return $?new Uint8Array(await k.arrayBuffer()):(0,V.stringToBytes)(await k.text())}return new Promise((k,le)=>{const re=new XMLHttpRequest;re.open("GET",K,!0),$&&(re.responseType="arraybuffer"),re.onreadystatechange=()=>{if(re.readyState===XMLHttpRequest.DONE){if(re.status===200||re.status===0){let y;if($&&re.response?y=new Uint8Array(re.response):!$&&re.responseText&&(y=(0,V.stringToBytes)(re.responseText)),y){k(y);return}}le(new Error(re.statusText))}},re.send(null)})}class m extends x.BaseCMapReaderFactory{_fetchData($,k){return h($,this.isCompressed).then(le=>({cMapData:le,compressionType:k}))}}P.DOMCMapReaderFactory=m;class L extends x.BaseStandardFontDataFactory{_fetchData($){return h($,!0)}}P.DOMStandardFontDataFactory=L;class C extends x.BaseSVGFactory{_createSVG($){return document.createElementNS(ne,$)}}P.DOMSVGFactory=C;class u{constructor({viewBox:$,scale:k,rotation:le,offsetX:re=0,offsetY:y=0,dontFlip:p=!1}){this.viewBox=$,this.scale=k,this.rotation=le,this.offsetX=re,this.offsetY=y;const g=($[2]+$[0])/2,M=($[3]+$[1])/2;let W,z,U,Q;switch(le%=360,le<0&&(le+=360),le){case 180:W=-1,z=0,U=0,Q=1;break;case 90:W=0,z=1,U=1,Q=0;break;case 270:W=0,z=-1,U=-1,Q=0;break;case 0:W=1,z=0,U=0,Q=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}p&&(U=-U,Q=-Q);let ee,he,ie,v;W===0?(ee=Math.abs(M-$[1])*k+re,he=Math.abs(g-$[0])*k+y,ie=($[3]-$[1])*k,v=($[2]-$[0])*k):(ee=Math.abs(g-$[0])*k+re,he=Math.abs(M-$[1])*k+y,ie=($[2]-$[0])*k,v=($[3]-$[1])*k),this.transform=[W*k,z*k,U*k,Q*k,ee-W*k*g-U*k*M,he-z*k*g-Q*k*M],this.width=ie,this.height=v}get rawDims(){const{viewBox:$}=this;return(0,V.shadow)(this,"rawDims",{pageWidth:$[2]-$[0],pageHeight:$[3]-$[1],pageX:$[0],pageY:$[1]})}clone({scale:$=this.scale,rotation:k=this.rotation,offsetX:le=this.offsetX,offsetY:re=this.offsetY,dontFlip:y=!1}={}){return new u({viewBox:this.viewBox.slice(),scale:$,rotation:k,offsetX:le,offsetY:re,dontFlip:y})}convertToViewportPoint($,k){return V.Util.applyTransform([$,k],this.transform)}convertToViewportRectangle($){const k=V.Util.applyTransform([$[0],$[1]],this.transform),le=V.Util.applyTransform([$[2],$[3]],this.transform);return[k[0],k[1],le[0],le[1]]}convertToPdfPoint($,k){return V.Util.applyInverseTransform([$,k],this.transform)}}P.PageViewport=u;class l extends V.BaseException{constructor($,k,le=0){super($,"RenderingCancelledException"),this.type=k,this.extraDelay=le}}P.RenderingCancelledException=l;function d(K){const $=K.length;let k=0;for(;k<$&&K[k].trim()==="";)k++;return K.substring(k,k+5).toLowerCase()==="data:"}function s(K){return typeof K=="string"&&/\.pdf$/i.test(K)}function e(K,$=!1){return $||([K]=K.split(/[#?]/,1)),K.substring(K.lastIndexOf("/")+1)}function r(K,$="document.pdf"){if(typeof K!="string")return $;if(d(K))return(0,V.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),$;const k=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,le=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,re=k.exec(K);let y=le.exec(re[1])||le.exec(re[2])||le.exec(re[3]);if(y&&(y=y[0],y.includes("%")))try{y=le.exec(decodeURIComponent(y))[0]}catch{}return y||$}class c{constructor(){Fe(this,"started",Object.create(null));Fe(this,"times",[])}time($){$ in this.started&&(0,V.warn)(`Timer is already running for ${$}`),this.started[$]=Date.now()}timeEnd($){$ in this.started||(0,V.warn)(`Timer has not been started for ${$}`),this.times.push({name:$,start:this.started[$],end:Date.now()}),delete this.started[$]}toString(){const $=[];let k=0;for(const{name:le}of this.times)k=Math.max(le.length,k);for(const{name:le,start:re,end:y}of this.times)$.push(`${le.padEnd(k)} ${y-re}ms
`);return $.join("")}}P.StatTimer=c;function o(K,$){try{const{protocol:k}=$?new URL(K,$):new URL(K);return k==="http:"||k==="https:"}catch{return!1}}function t(K,$=!1){return new Promise((k,le)=>{const re=document.createElement("script");re.src=K,re.onload=function(y){$&&re.remove(),k(y)},re.onerror=function(){le(new Error(`Cannot load script at: ${re.src}`))},(document.head||document.documentElement).append(re)})}function n(K){console.log("Deprecated API usage: "+K)}let f;class a{static toDateObject($){if(!$||typeof $!="string")return null;f||(f=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const k=f.exec($);if(!k)return null;const le=parseInt(k[1],10);let re=parseInt(k[2],10);re=re>=1&&re<=12?re-1:0;let y=parseInt(k[3],10);y=y>=1&&y<=31?y:1;let p=parseInt(k[4],10);p=p>=0&&p<=23?p:0;let g=parseInt(k[5],10);g=g>=0&&g<=59?g:0;let M=parseInt(k[6],10);M=M>=0&&M<=59?M:0;const W=k[7]||"Z";let z=parseInt(k[8],10);z=z>=0&&z<=23?z:0;let U=parseInt(k[9],10)||0;return U=U>=0&&U<=59?U:0,W==="-"?(p+=z,g+=U):W==="+"&&(p-=z,g-=U),new Date(Date.UTC(le,re,y,p,g,M))}}P.PDFDateString=a;function T(K,{scale:$=1,rotation:k=0}){const{width:le,height:re}=K.attributes.style,y=[0,0,parseInt(le),parseInt(re)];return new u({viewBox:y,scale:$,rotation:k})}function O(K){if(K.startsWith("#")){const $=parseInt(K.slice(1),16);return[($&16711680)>>16,($&65280)>>8,$&255]}return K.startsWith("rgb(")?K.slice(4,-1).split(",").map($=>parseInt($)):K.startsWith("rgba(")?K.slice(5,-1).split(",").map($=>parseInt($)).slice(0,3):((0,V.warn)(`Not a valid color format: "${K}"`),[0,0,0])}function X(K){const $=document.createElement("span");$.style.visibility="hidden",document.body.append($);for(const k of K.keys()){$.style.color=k;const le=window.getComputedStyle($).color;K.set(k,O(le))}$.remove()}function Y(K){const{a:$,b:k,c:le,d:re,e:y,f:p}=K.getTransform();return[$,k,le,re,y,p]}function _e(K){const{a:$,b:k,c:le,d:re,e:y,f:p}=K.getTransform().invertSelf();return[$,k,le,re,y,p]}function ue(K,$,k=!1,le=!0){if($ instanceof u){const{pageWidth:re,pageHeight:y}=$.rawDims,{style:p}=K,g=`calc(var(--scale-factor) * ${re}px)`,M=`calc(var(--scale-factor) * ${y}px)`;!k||$.rotation%180===0?(p.width=g,p.height=M):(p.width=M,p.height=g)}le&&K.setAttribute("data-main-rotation",$.rotation)}},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.BaseStandardFontDataFactory=P.BaseSVGFactory=P.BaseCanvasFactory=P.BaseCMapReaderFactory=void 0;var x=Z(1);class V{constructor(){this.constructor===V&&(0,x.unreachable)("Cannot initialize BaseCanvasFactory.")}create(h,m){if(h<=0||m<=0)throw new Error("Invalid canvas size");const L=this._createCanvas(h,m);return{canvas:L,context:L.getContext("2d")}}reset(h,m,L){if(!h.canvas)throw new Error("Canvas is not specified");if(m<=0||L<=0)throw new Error("Invalid canvas size");h.canvas.width=m,h.canvas.height=L}destroy(h){if(!h.canvas)throw new Error("Canvas is not specified");h.canvas.width=0,h.canvas.height=0,h.canvas=null,h.context=null}_createCanvas(h,m){(0,x.unreachable)("Abstract method `_createCanvas` called.")}}P.BaseCanvasFactory=V;class ne{constructor({baseUrl:h=null,isCompressed:m=!1}){this.constructor===ne&&(0,x.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=h,this.isCompressed=m}async fetch({name:h}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!h)throw new Error("CMap name must be specified.");const m=this.baseUrl+h+(this.isCompressed?".bcmap":""),L=this.isCompressed?x.CMapCompressionType.BINARY:x.CMapCompressionType.NONE;return this._fetchData(m,L).catch(C=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${m}`)})}_fetchData(h,m){(0,x.unreachable)("Abstract method `_fetchData` called.")}}P.BaseCMapReaderFactory=ne;class B{constructor({baseUrl:h=null}){this.constructor===B&&(0,x.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=h}async fetch({filename:h}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!h)throw new Error("Font filename must be specified.");const m=`${this.baseUrl}${h}`;return this._fetchData(m).catch(L=>{throw new Error(`Unable to load font data at: ${m}`)})}_fetchData(h){(0,x.unreachable)("Abstract method `_fetchData` called.")}}P.BaseStandardFontDataFactory=B;class R{constructor(){this.constructor===R&&(0,x.unreachable)("Cannot initialize BaseSVGFactory.")}create(h,m,L=!1){if(h<=0||m<=0)throw new Error("Invalid SVG dimensions");const C=this._createSVG("svg:svg");return C.setAttribute("version","1.1"),L||(C.setAttribute("width",`${h}px`),C.setAttribute("height",`${m}px`)),C.setAttribute("preserveAspectRatio","none"),C.setAttribute("viewBox",`0 0 ${h} ${m}`),C}createElement(h){if(typeof h!="string")throw new Error("Invalid SVG element type");return this._createSVG(h)}_createSVG(h){(0,x.unreachable)("Abstract method `_createSVG` called.")}}P.BaseSVGFactory=R},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.MurmurHash3_64=void 0;var x=Z(1);const V=3285377520,ne=4294901760,B=65535;class R{constructor(h){this.h1=h?h&4294967295:V,this.h2=h?h&4294967295:V}update(h){let m,L;if(typeof h=="string"){m=new Uint8Array(h.length*2),L=0;for(let f=0,a=h.length;f<a;f++){const T=h.charCodeAt(f);T<=255?m[L++]=T:(m[L++]=T>>>8,m[L++]=T&255)}}else if((0,x.isArrayBuffer)(h))m=h.slice(),L=m.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const C=L>>2,u=L-C*4,l=new Uint32Array(m.buffer,0,C);let d=0,s=0,e=this.h1,r=this.h2;const c=3432918353,o=461845907,t=c&B,n=o&B;for(let f=0;f<C;f++)f&1?(d=l[f],d=d*c&ne|d*t&B,d=d<<15|d>>>17,d=d*o&ne|d*n&B,e^=d,e=e<<13|e>>>19,e=e*5+3864292196):(s=l[f],s=s*c&ne|s*t&B,s=s<<15|s>>>17,s=s*o&ne|s*n&B,r^=s,r=r<<13|r>>>19,r=r*5+3864292196);switch(d=0,u){case 3:d^=m[C*4+2]<<16;case 2:d^=m[C*4+1]<<8;case 1:d^=m[C*4],d=d*c&ne|d*t&B,d=d<<15|d>>>17,d=d*o&ne|d*n&B,C&1?e^=d:r^=d}this.h1=e,this.h2=r}hexdigest(){let h=this.h1,m=this.h2;return h^=m>>>1,h=h*3981806797&ne|h*36045&B,m=m*4283543511&ne|((m<<16|h>>>16)*2950163797&ne)>>>16,h^=m>>>1,h=h*444984403&ne|h*60499&B,m=m*3301882366&ne|((m<<16|h>>>16)*3120437893&ne)>>>16,h^=m>>>1,(h>>>0).toString(16).padStart(8,"0")+(m>>>0).toString(16).padStart(8,"0")}}P.MurmurHash3_64=R},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.FontLoader=P.FontFaceObject=void 0;var x=Z(1),V=Z(10);class ne{constructor({onUnsupportedFeature:N,ownerDocument:h=globalThis.document,styleElement:m=null}){this._onUnsupportedFeature=N,this._document=h,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(N){this.nativeFontFaces.push(N),this._document.fonts.add(N)}insertRule(N){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const h=this.styleElement.sheet;h.insertRule(N,h.cssRules.length)}clear(){for(const N of this.nativeFontFaces)this._document.fonts.delete(N);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(N){if(N.attached||N.missingFile)return;if(N.attached=!0,this.isFontLoadingAPISupported){const m=N.createNativeFontFace();if(m){this.addNativeFontFace(m);try{await m.loaded}catch(L){throw this._onUnsupportedFeature({featureId:x.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,x.warn)(`Failed to load font '${m.family}': '${L}'.`),N.disableFontFace=!0,L}}return}const h=N.createFontFaceRule();if(h){if(this.insertRule(h),this.isSyncFontLoadingSupported)return;await new Promise(m=>{const L=this._queueLoadingCallback(m);this._prepareFontLoadEvent(N,L)})}}get isFontLoadingAPISupported(){var h;const N=!!((h=this._document)!=null&&h.fonts);return(0,x.shadow)(this,"isFontLoadingAPISupported",N)}get isSyncFontLoadingSupported(){let N=!1;return(V.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(N=!0),(0,x.shadow)(this,"isSyncFontLoadingSupported",N)}_queueLoadingCallback(N){function h(){for((0,x.assert)(!L.done,"completeRequest() cannot be called twice."),L.done=!0;m.length>0&&m[0].done;){const C=m.shift();setTimeout(C.callback,0)}}const{loadingRequests:m}=this,L={done:!1,complete:h,callback:N};return m.push(L),L}get _loadTestFont(){const N=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,x.shadow)(this,"_loadTestFont",N)}_prepareFontLoadEvent(N,h){function m(X,Y){return X.charCodeAt(Y)<<24|X.charCodeAt(Y+1)<<16|X.charCodeAt(Y+2)<<8|X.charCodeAt(Y+3)&255}function L(X,Y,_e,ue){const J=X.substring(0,Y),K=X.substring(Y+_e);return J+ue+K}let C,u;const l=this._document.createElement("canvas");l.width=1,l.height=1;const d=l.getContext("2d");let s=0;function e(X,Y){if(++s>30){(0,x.warn)("Load test font never loaded."),Y();return}if(d.font="30px "+X,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){Y();return}setTimeout(e.bind(null,X,Y))}const r=`lt${Date.now()}${this.loadTestFontId++}`;let c=this._loadTestFont;c=L(c,976,r.length,r);const t=16,n=1482184792;let f=m(c,t);for(C=0,u=r.length-3;C<u;C+=4)f=f-n+m(r,C)|0;C<r.length&&(f=f-n+m(r+"XXX",C)|0),c=L(c,t,4,(0,x.string32)(f));const a=`url(data:font/opentype;base64,${btoa(c)});`,T=`@font-face {font-family:"${r}";src:${a}}`;this.insertRule(T);const O=this._document.createElement("div");O.style.visibility="hidden",O.style.width=O.style.height="10px",O.style.position="absolute",O.style.top=O.style.left="0px";for(const X of[N.loadedName,r]){const Y=this._document.createElement("span");Y.textContent="Hi",Y.style.fontFamily=X,O.append(Y)}this._document.body.append(O),e(r,()=>{O.remove(),h.complete()})}}P.FontLoader=ne;class B{constructor(N,{isEvalSupported:h=!0,disableFontFace:m=!1,ignoreErrors:L=!1,onUnsupportedFeature:C,fontRegistry:u=null}){this.compiledGlyphs=Object.create(null);for(const l in N)this[l]=N[l];this.isEvalSupported=h!==!1,this.disableFontFace=m===!0,this.ignoreErrors=L===!0,this._onUnsupportedFeature=C,this.fontRegistry=u}createNativeFontFace(){var h;if(!this.data||this.disableFontFace)return null;let N;if(!this.cssFontInfo)N=new FontFace(this.loadedName,this.data,{});else{const m={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(m.style=`oblique ${this.cssFontInfo.italicAngle}deg`),N=new FontFace(this.cssFontInfo.fontFamily,this.data,m)}return(h=this.fontRegistry)==null||h.registerFont(this),N}createFontFaceRule(){var L;if(!this.data||this.disableFontFace)return null;const N=(0,x.bytesToString)(this.data),h=`url(data:${this.mimetype};base64,${btoa(N)});`;let m;if(!this.cssFontInfo)m=`@font-face {font-family:"${this.loadedName}";src:${h}}`;else{let C=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(C+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),m=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${C}src:${h}}`}return(L=this.fontRegistry)==null||L.registerFont(this,h),m}getPathGenerator(N,h){if(this.compiledGlyphs[h]!==void 0)return this.compiledGlyphs[h];let m;try{m=N.get(this.loadedName+"_path_"+h)}catch(L){if(!this.ignoreErrors)throw L;return this._onUnsupportedFeature({featureId:x.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,x.warn)(`getPathGenerator - ignoring character: "${L}".`),this.compiledGlyphs[h]=function(C,u){}}if(this.isEvalSupported&&x.FeatureTest.isEvalSupported){const L=[];for(const C of m){const u=C.args!==void 0?C.args.join(","):"";L.push("c.",C.cmd,"(",u,`);
`)}return this.compiledGlyphs[h]=new Function("c","size",L.join(""))}return this.compiledGlyphs[h]=function(L,C){for(const u of m)u.cmd==="scale"&&(u.args=[C,-C]),L[u.cmd].apply(L,u.args)}}}P.FontFaceObject=B},(me,P)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.isNodeJS=void 0;const Z=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");P.isNodeJS=Z},(me,P,Z)=>{var k,mt;Object.defineProperty(P,"__esModule",{value:!0}),P.CanvasGraphics=void 0;var x=Z(1),V=Z(6),ne=Z(12),B=Z(13);const R=16,N=100,h=4096,m=15,L=10,C=1e3,u=16;function l(y,p){if(y._removeMirroring)throw new Error("Context is already forwarding operations.");y.__originalSave=y.save,y.__originalRestore=y.restore,y.__originalRotate=y.rotate,y.__originalScale=y.scale,y.__originalTranslate=y.translate,y.__originalTransform=y.transform,y.__originalSetTransform=y.setTransform,y.__originalResetTransform=y.resetTransform,y.__originalClip=y.clip,y.__originalMoveTo=y.moveTo,y.__originalLineTo=y.lineTo,y.__originalBezierCurveTo=y.bezierCurveTo,y.__originalRect=y.rect,y.__originalClosePath=y.closePath,y.__originalBeginPath=y.beginPath,y._removeMirroring=()=>{y.save=y.__originalSave,y.restore=y.__originalRestore,y.rotate=y.__originalRotate,y.scale=y.__originalScale,y.translate=y.__originalTranslate,y.transform=y.__originalTransform,y.setTransform=y.__originalSetTransform,y.resetTransform=y.__originalResetTransform,y.clip=y.__originalClip,y.moveTo=y.__originalMoveTo,y.lineTo=y.__originalLineTo,y.bezierCurveTo=y.__originalBezierCurveTo,y.rect=y.__originalRect,y.closePath=y.__originalClosePath,y.beginPath=y.__originalBeginPath,delete y._removeMirroring},y.save=function(){p.save(),this.__originalSave()},y.restore=function(){p.restore(),this.__originalRestore()},y.translate=function(M,W){p.translate(M,W),this.__originalTranslate(M,W)},y.scale=function(M,W){p.scale(M,W),this.__originalScale(M,W)},y.transform=function(M,W,z,U,Q,ee){p.transform(M,W,z,U,Q,ee),this.__originalTransform(M,W,z,U,Q,ee)},y.setTransform=function(M,W,z,U,Q,ee){p.setTransform(M,W,z,U,Q,ee),this.__originalSetTransform(M,W,z,U,Q,ee)},y.resetTransform=function(){p.resetTransform(),this.__originalResetTransform()},y.rotate=function(M){p.rotate(M),this.__originalRotate(M)},y.clip=function(M){p.clip(M),this.__originalClip(M)},y.moveTo=function(g,M){p.moveTo(g,M),this.__originalMoveTo(g,M)},y.lineTo=function(g,M){p.lineTo(g,M),this.__originalLineTo(g,M)},y.bezierCurveTo=function(g,M,W,z,U,Q){p.bezierCurveTo(g,M,W,z,U,Q),this.__originalBezierCurveTo(g,M,W,z,U,Q)},y.rect=function(g,M,W,z){p.rect(g,M,W,z),this.__originalRect(g,M,W,z)},y.closePath=function(){p.closePath(),this.__originalClosePath()},y.beginPath=function(){p.beginPath(),this.__originalBeginPath()}}class d{constructor(p){this.canvasFactory=p,this.cache=Object.create(null)}getCanvas(p,g,M){let W;return this.cache[p]!==void 0?(W=this.cache[p],this.canvasFactory.reset(W,g,M)):(W=this.canvasFactory.create(g,M),this.cache[p]=W),W}delete(p){delete this.cache[p]}clear(){for(const p in this.cache){const g=this.cache[p];this.canvasFactory.destroy(g),delete this.cache[p]}}}function s(y,p,g,M,W,z,U,Q,ee,he){const[ie,v,i,b,w,A]=(0,V.getCurrentTransform)(y);if(v===0&&i===0){const G=U*ie+w,H=Math.round(G),S=Q*b+A,F=Math.round(S),D=(U+ee)*ie+w,q=Math.abs(Math.round(D)-H)||1,oe=(Q+he)*b+A,fe=Math.abs(Math.round(oe)-F)||1;return y.setTransform(Math.sign(ie),0,0,Math.sign(b),H,F),y.drawImage(p,g,M,W,z,0,0,q,fe),y.setTransform(ie,v,i,b,w,A),[q,fe]}if(ie===0&&b===0){const G=Q*i+w,H=Math.round(G),S=U*v+A,F=Math.round(S),D=(Q+he)*i+w,q=Math.abs(Math.round(D)-H)||1,oe=(U+ee)*v+A,fe=Math.abs(Math.round(oe)-F)||1;return y.setTransform(0,Math.sign(v),Math.sign(i),0,H,F),y.drawImage(p,g,M,W,z,0,0,fe,q),y.setTransform(ie,v,i,b,w,A),[fe,q]}y.drawImage(p,g,M,W,z,U,Q,ee,he);const I=Math.hypot(ie,v),j=Math.hypot(i,b);return[I*ee,j*he]}function e(y){const{width:p,height:g}=y;if(p>C||g>C)return null;const M=1e3,W=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),z=p+1;let U=new Uint8Array(z*(g+1)),Q,ee,he;const ie=p+7&-8;let v=new Uint8Array(ie*g),i=0;for(const j of y.data){let G=128;for(;G>0;)v[i++]=j&G?0:255,G>>=1}let b=0;for(i=0,v[i]!==0&&(U[0]=1,++b),ee=1;ee<p;ee++)v[i]!==v[i+1]&&(U[ee]=v[i]?2:1,++b),i++;for(v[i]!==0&&(U[ee]=2,++b),Q=1;Q<g;Q++){i=Q*ie,he=Q*z,v[i-ie]!==v[i]&&(U[he]=v[i]?1:8,++b);let j=(v[i]?4:0)+(v[i-ie]?8:0);for(ee=1;ee<p;ee++)j=(j>>2)+(v[i+1]?4:0)+(v[i-ie+1]?8:0),W[j]&&(U[he+ee]=W[j],++b),i++;if(v[i-ie]!==v[i]&&(U[he+ee]=v[i]?2:4,++b),b>M)return null}for(i=ie*(g-1),he=Q*z,v[i]!==0&&(U[he]=8,++b),ee=1;ee<p;ee++)v[i]!==v[i+1]&&(U[he+ee]=v[i]?4:8,++b),i++;if(v[i]!==0&&(U[he+ee]=4,++b),b>M)return null;const w=new Int32Array([0,z,-1,0,-z,0,0,0,1]),A=new Path2D;for(Q=0;b&&Q<=g;Q++){let j=Q*z;const G=j+p;for(;j<G&&!U[j];)j++;if(j===G)continue;A.moveTo(j%z,Q);const H=j;let S=U[j];do{const F=w[S];do j+=F;while(!U[j]);const D=U[j];D!==5&&D!==10?(S=D,U[j]=0):(S=D&51*S>>4,U[j]&=S>>2|S<<2),A.lineTo(j%z,j/z|0),U[j]||--b}while(H!==j);--Q}return v=null,U=null,function(j){j.save(),j.scale(1/p,-1/g),j.translate(0,-g),j.fill(A),j.beginPath(),j.restore()}}class r{constructor(p,g){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=x.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=x.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=x.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,p,g])}clone(){const p=Object.create(this);return p.clipBox=this.clipBox.slice(),p}setCurrentPoint(p,g){this.x=p,this.y=g}updatePathMinMax(p,g,M){[g,M]=x.Util.applyTransform([g,M],p),this.minX=Math.min(this.minX,g),this.minY=Math.min(this.minY,M),this.maxX=Math.max(this.maxX,g),this.maxY=Math.max(this.maxY,M)}updateRectMinMax(p,g){const M=x.Util.applyTransform(g,p),W=x.Util.applyTransform(g.slice(2),p);this.minX=Math.min(this.minX,M[0],W[0]),this.minY=Math.min(this.minY,M[1],W[1]),this.maxX=Math.max(this.maxX,M[0],W[0]),this.maxY=Math.max(this.maxY,M[1],W[1])}updateScalingPathMinMax(p,g){x.Util.scaleMinMax(p,g),this.minX=Math.min(this.minX,g[0]),this.maxX=Math.max(this.maxX,g[1]),this.minY=Math.min(this.minY,g[2]),this.maxY=Math.max(this.maxY,g[3])}updateCurvePathMinMax(p,g,M,W,z,U,Q,ee,he,ie){const v=x.Util.bezierBoundingBox(g,M,W,z,U,Q,ee,he);if(ie){ie[0]=Math.min(ie[0],v[0],v[2]),ie[1]=Math.max(ie[1],v[0],v[2]),ie[2]=Math.min(ie[2],v[1],v[3]),ie[3]=Math.max(ie[3],v[1],v[3]);return}this.updateRectMinMax(p,v)}getPathBoundingBox(p=ne.PathType.FILL,g=null){const M=[this.minX,this.minY,this.maxX,this.maxY];if(p===ne.PathType.STROKE){g||(0,x.unreachable)("Stroke bounding box must include transform.");const W=x.Util.singularValueDecompose2dScale(g),z=W[0]*this.lineWidth/2,U=W[1]*this.lineWidth/2;M[0]-=z,M[1]-=U,M[2]+=z,M[3]+=U}return M}updateClipFromPath(){const p=x.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(p||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(p){this.clipBox=p,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(p=ne.PathType.FILL,g=null){return x.Util.intersect(this.clipBox,this.getPathBoundingBox(p,g))}}function c(y,p,g=null){if(typeof ImageData<"u"&&p instanceof ImageData){y.putImageData(p,0,0);return}const M=p.height,W=p.width,z=M%u,U=(M-z)/u,Q=z===0?U:U+1,ee=y.createImageData(W,u);let he=0,ie;const v=p.data,i=ee.data;let b,w,A,I,j,G,H,S;if(g)switch(g.length){case 1:j=g[0],G=g[0],H=g[0],S=g[0];break;case 4:j=g[0],G=g[1],H=g[2],S=g[3];break}if(p.kind===x.ImageKind.GRAYSCALE_1BPP){const F=v.byteLength,D=new Uint32Array(i.buffer,0,i.byteLength>>2),q=D.length,oe=W+7>>3;let fe=4294967295,ge=x.FeatureTest.isLittleEndian?4278190080:255;for(S&&S[0]===255&&S[255]===0&&([fe,ge]=[ge,fe]),b=0;b<Q;b++){for(A=b<U?u:z,ie=0,w=0;w<A;w++){const be=F-he;let Ae=0;const ve=be>oe?W:be*8-7,Pe=ve&-8;let Ee=0,ce=0;for(;Ae<Pe;Ae+=8)ce=v[he++],D[ie++]=ce&128?fe:ge,D[ie++]=ce&64?fe:ge,D[ie++]=ce&32?fe:ge,D[ie++]=ce&16?fe:ge,D[ie++]=ce&8?fe:ge,D[ie++]=ce&4?fe:ge,D[ie++]=ce&2?fe:ge,D[ie++]=ce&1?fe:ge;for(;Ae<ve;Ae++)Ee===0&&(ce=v[he++],Ee=128),D[ie++]=ce&Ee?fe:ge,Ee>>=1}for(;ie<q;)D[ie++]=0;y.putImageData(ee,0,b*u)}}else if(p.kind===x.ImageKind.RGBA_32BPP){const F=!!(j||G||H);for(w=0,I=W*u*4,b=0;b<U;b++){if(i.set(v.subarray(he,he+I)),he+=I,F)for(let D=0;D<I;D+=4)j&&(i[D+0]=j[i[D+0]]),G&&(i[D+1]=G[i[D+1]]),H&&(i[D+2]=H[i[D+2]]);y.putImageData(ee,0,w),w+=u}if(b<Q){if(I=W*z*4,i.set(v.subarray(he,he+I)),F)for(let D=0;D<I;D+=4)j&&(i[D+0]=j[i[D+0]]),G&&(i[D+1]=G[i[D+1]]),H&&(i[D+2]=H[i[D+2]]);y.putImageData(ee,0,w)}}else if(p.kind===x.ImageKind.RGB_24BPP){const F=!!(j||G||H);for(A=u,I=W*A,b=0;b<Q;b++){for(b>=U&&(A=z,I=W*A),ie=0,w=I;w--;)i[ie++]=v[he++],i[ie++]=v[he++],i[ie++]=v[he++],i[ie++]=255;if(F)for(let D=0;D<ie;D+=4)j&&(i[D+0]=j[i[D+0]]),G&&(i[D+1]=G[i[D+1]]),H&&(i[D+2]=H[i[D+2]]);y.putImageData(ee,0,b*u)}}else throw new Error(`bad image kind: ${p.kind}`)}function o(y,p){if(p.bitmap){y.drawImage(p.bitmap,0,0);return}const g=p.height,M=p.width,W=g%u,z=(g-W)/u,U=W===0?z:z+1,Q=y.createImageData(M,u);let ee=0;const he=p.data,ie=Q.data;for(let v=0;v<U;v++){const i=v<z?u:W;({srcPos:ee}=(0,B.applyMaskImageData)({src:he,srcPos:ee,dest:ie,width:M,height:i})),y.putImageData(Q,0,v*u)}}function t(y,p){const g=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(const M of g)y[M]!==void 0&&(p[M]=y[M]);y.setLineDash!==void 0&&(p.setLineDash(y.getLineDash()),p.lineDashOffset=y.lineDashOffset)}function n(y,p){y.strokeStyle=y.fillStyle=p||"#000000",y.fillRule="nonzero",y.globalAlpha=1,y.lineWidth=1,y.lineCap="butt",y.lineJoin="miter",y.miterLimit=10,y.globalCompositeOperation="source-over",y.font="10px sans-serif",y.setLineDash!==void 0&&(y.setLineDash([]),y.lineDashOffset=0)}function f(y,p,g,M){const W=y.length;for(let z=3;z<W;z+=4){const U=y[z];if(U===0)y[z-3]=p,y[z-2]=g,y[z-1]=M;else if(U<255){const Q=255-U;y[z-3]=y[z-3]*U+p*Q>>8,y[z-2]=y[z-2]*U+g*Q>>8,y[z-1]=y[z-1]*U+M*Q>>8}}}function a(y,p,g){const M=y.length,W=1/255;for(let z=3;z<M;z+=4){const U=g?g[y[z]]:y[z];p[z]=p[z]*U*W|0}}function T(y,p,g){const M=y.length;for(let W=3;W<M;W+=4){const z=y[W-3]*77+y[W-2]*152+y[W-1]*28;p[W]=g?p[W]*g[z>>8]>>8:p[W]*z>>16}}function O(y,p,g,M,W,z,U,Q,ee,he,ie){const v=!!z,i=v?z[0]:0,b=v?z[1]:0,w=v?z[2]:0;let A;W==="Luminosity"?A=T:A=a;const j=Math.min(M,Math.ceil(1048576/g));for(let G=0;G<M;G+=j){const H=Math.min(j,M-G),S=y.getImageData(Q-he,G+(ee-ie),g,H),F=p.getImageData(Q,G+ee,g,H);v&&f(S.data,i,b,w),A(S.data,F.data,U),p.putImageData(F,Q,G+ee)}}function X(y,p,g,M){const W=M[0],z=M[1],U=M[2]-W,Q=M[3]-z;U===0||Q===0||(O(p.context,g,U,Q,p.subtype,p.backdrop,p.transferMap,W,z,p.offsetX,p.offsetY),y.save(),y.globalAlpha=1,y.globalCompositeOperation="source-over",y.setTransform(1,0,0,1,0,0),y.drawImage(g.canvas,0,0),y.restore())}function Y(y,p){const g=x.Util.singularValueDecompose2dScale(y);g[0]=Math.fround(g[0]),g[1]=Math.fround(g[1]);const M=Math.fround((globalThis.devicePixelRatio||1)*V.PixelsPerInch.PDF_TO_CSS_UNITS);return p!==void 0?p:g[0]<=M||g[1]<=M}const _e=["butt","round","square"],ue=["miter","round","bevel"],J={},K={},re=class re{constructor(p,g,M,W,{optionalContentConfig:z,markedContentStack:U=null},Q,ee){de(this,k);this.ctx=p,this.current=new r(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=g,this.objs=M,this.canvasFactory=W,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=U||[],this.optionalContentConfig=z,this.cachedCanvases=new d(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=Q,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(ee==null?void 0:ee.background)||null,this.foregroundColor=(ee==null?void 0:ee.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(p,g=null){return typeof p=="string"?p.startsWith("g_")?this.commonObjs.get(p):this.objs.get(p):g}beginDrawing({transform:p,viewport:g,transparency:M=!1,background:W=null}){const z=this.ctx.canvas.width,U=this.ctx.canvas.height,Q=W||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const ee=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const he=this.backgroundColor=this.ctx.fillStyle;let ie=!0,v=Q;if(this.ctx.fillStyle=Q,v=this.ctx.fillStyle,ie=typeof v=="string"&&/^#[0-9A-Fa-f]{6}$/.test(v),ee==="#000000"&&he==="#ffffff"||ee===he||!ie)this.foregroundColor=this.backgroundColor=null;else{const[i,b,w]=(0,V.getRGB)(v),A=j=>(j/=255,j<=.03928?j/12.92:((j+.055)/1.055)**2.4),I=Math.round(.2126*A(i)+.7152*A(b)+.0722*A(w));this.selectColor=(j,G,H)=>{const S=.2126*A(j)+.7152*A(G)+.0722*A(H);return Math.round(S)===I?he:ee}}}if(this.ctx.fillStyle=this.backgroundColor||Q,this.ctx.fillRect(0,0,z,U),this.ctx.restore(),M){const ee=this.cachedCanvases.getCanvas("transparent",z,U);this.compositeCtx=this.ctx,this.transparentCanvas=ee.canvas,this.ctx=ee.context,this.ctx.save(),this.ctx.transform(...(0,V.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),n(this.ctx,this.foregroundColor),p&&(this.ctx.transform(...p),this.outputScaleX=p[0],this.outputScaleY=p[0]),this.ctx.transform(...g.transform),this.viewportScale=g.scale,this.baseTransform=(0,V.getCurrentTransform)(this.ctx)}executeOperatorList(p,g,M,W){const z=p.argsArray,U=p.fnArray;let Q=g||0;const ee=z.length;if(ee===Q)return Q;const he=ee-Q>L&&typeof M=="function",ie=he?Date.now()+m:0;let v=0;const i=this.commonObjs,b=this.objs;let w;for(;;){if(W!==void 0&&Q===W.nextBreakPoint)return W.breakIt(Q,M),Q;if(w=U[Q],w!==x.OPS.dependency)this[w].apply(this,z[Q]);else for(const A of z[Q]){const I=A.startsWith("g_")?i:b;if(!I.has(A))return I.get(A,M),Q}if(Q++,Q===ee)return Q;if(he&&++v>L){if(Date.now()>ie)return M(),Q;v=0}}}endDrawing(){te(this,k,mt).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const p of this._cachedBitmapsMap.values()){for(const g of p.values())typeof HTMLCanvasElement<"u"&&g instanceof HTMLCanvasElement&&(g.width=g.height=0);p.clear()}this._cachedBitmapsMap.clear()}_scaleImage(p,g){const M=p.width,W=p.height;let z=Math.max(Math.hypot(g[0],g[1]),1),U=Math.max(Math.hypot(g[2],g[3]),1),Q=M,ee=W,he="prescale1",ie,v;for(;z>2&&Q>1||U>2&&ee>1;){let i=Q,b=ee;z>2&&Q>1&&(i=Math.ceil(Q/2),z/=Q/i),U>2&&ee>1&&(b=Math.ceil(ee/2),U/=ee/b),ie=this.cachedCanvases.getCanvas(he,i,b),v=ie.context,v.clearRect(0,0,i,b),v.drawImage(p,0,0,Q,ee,0,0,i,b),p=ie.canvas,Q=i,ee=b,he=he==="prescale1"?"prescale2":"prescale1"}return{img:p,paintWidth:Q,paintHeight:ee}}_createMaskCanvas(p){const g=this.ctx,{width:M,height:W}=p,z=this.current.fillColor,U=this.current.patternFill,Q=(0,V.getCurrentTransform)(g);let ee,he,ie,v;if((p.bitmap||p.data)&&p.count>1){const q=p.bitmap||p.data.buffer;he=JSON.stringify(U?Q:[Q.slice(0,4),z]),ee=this._cachedBitmapsMap.get(q),ee||(ee=new Map,this._cachedBitmapsMap.set(q,ee));const oe=ee.get(he);if(oe&&!U){const fe=Math.round(Math.min(Q[0],Q[2])+Q[4]),ge=Math.round(Math.min(Q[1],Q[3])+Q[5]);return{canvas:oe,offsetX:fe,offsetY:ge}}ie=oe}ie||(v=this.cachedCanvases.getCanvas("maskCanvas",M,W),o(v.context,p));let i=x.Util.transform(Q,[1/M,0,0,-1/W,0,0]);i=x.Util.transform(i,[1,0,0,1,0,-W]);const b=x.Util.applyTransform([0,0],i),w=x.Util.applyTransform([M,W],i),A=x.Util.normalizeRect([b[0],b[1],w[0],w[1]]),I=Math.round(A[2]-A[0])||1,j=Math.round(A[3]-A[1])||1,G=this.cachedCanvases.getCanvas("fillCanvas",I,j),H=G.context,S=Math.min(b[0],w[0]),F=Math.min(b[1],w[1]);H.translate(-S,-F),H.transform(...i),ie||(ie=this._scaleImage(v.canvas,(0,V.getCurrentTransformInverse)(H)),ie=ie.img,ee&&U&&ee.set(he,ie)),H.imageSmoothingEnabled=Y((0,V.getCurrentTransform)(H),p.interpolate),s(H,ie,0,0,ie.width,ie.height,0,0,M,W),H.globalCompositeOperation="source-in";const D=x.Util.transform((0,V.getCurrentTransformInverse)(H),[1,0,0,1,-S,-F]);return H.fillStyle=U?z.getPattern(g,this,D,ne.PathType.FILL):z,H.fillRect(0,0,M,W),ee&&!U&&(this.cachedCanvases.delete("fillCanvas"),ee.set(he,G.canvas)),{canvas:G.canvas,offsetX:Math.round(S),offsetY:Math.round(F)}}setLineWidth(p){p!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=p,this.ctx.lineWidth=p}setLineCap(p){this.ctx.lineCap=_e[p]}setLineJoin(p){this.ctx.lineJoin=ue[p]}setMiterLimit(p){this.ctx.miterLimit=p}setDash(p,g){const M=this.ctx;M.setLineDash!==void 0&&(M.setLineDash(p),M.lineDashOffset=g)}setRenderingIntent(p){}setFlatness(p){}setGState(p){for(const[g,M]of p)switch(g){case"LW":this.setLineWidth(M);break;case"LC":this.setLineCap(M);break;case"LJ":this.setLineJoin(M);break;case"ML":this.setMiterLimit(M);break;case"D":this.setDash(M[0],M[1]);break;case"RI":this.setRenderingIntent(M);break;case"FL":this.setFlatness(M);break;case"Font":this.setFont(M[0],M[1]);break;case"CA":this.current.strokeAlpha=M;break;case"ca":this.current.fillAlpha=M,this.ctx.globalAlpha=M;break;case"BM":this.ctx.globalCompositeOperation=M;break;case"SMask":this.current.activeSMask=M?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=M}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const p=this.inSMaskMode;this.current.activeSMask&&!p?this.beginSMaskMode():!this.current.activeSMask&&p&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const p=this.ctx.canvas.width,g=this.ctx.canvas.height,M="smaskGroupAt"+this.groupLevel,W=this.cachedCanvases.getCanvas(M,p,g);this.suspendedCtx=this.ctx,this.ctx=W.context;const z=this.ctx;z.setTransform(...(0,V.getCurrentTransform)(this.suspendedCtx)),t(this.suspendedCtx,z),l(z,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),t(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(p){if(!this.current.activeSMask)return;p?(p[0]=Math.floor(p[0]),p[1]=Math.floor(p[1]),p[2]=Math.ceil(p[2]),p[3]=Math.ceil(p[3])):p=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const g=this.current.activeSMask,M=this.suspendedCtx;X(M,g,this.ctx,p),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(t(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const p=this.current;this.stateStack.push(p),this.current=p.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),t(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(p,g,M,W,z,U){this.ctx.transform(p,g,M,W,z,U),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(p,g,M){const W=this.ctx,z=this.current;let U=z.x,Q=z.y,ee,he;const ie=(0,V.getCurrentTransform)(W),v=ie[0]===0&&ie[3]===0||ie[1]===0&&ie[2]===0,i=v?M.slice(0):null;for(let b=0,w=0,A=p.length;b<A;b++)switch(p[b]|0){case x.OPS.rectangle:U=g[w++],Q=g[w++];const I=g[w++],j=g[w++],G=U+I,H=Q+j;W.moveTo(U,Q),I===0||j===0?W.lineTo(G,H):(W.lineTo(G,Q),W.lineTo(G,H),W.lineTo(U,H)),v||z.updateRectMinMax(ie,[U,Q,G,H]),W.closePath();break;case x.OPS.moveTo:U=g[w++],Q=g[w++],W.moveTo(U,Q),v||z.updatePathMinMax(ie,U,Q);break;case x.OPS.lineTo:U=g[w++],Q=g[w++],W.lineTo(U,Q),v||z.updatePathMinMax(ie,U,Q);break;case x.OPS.curveTo:ee=U,he=Q,U=g[w+4],Q=g[w+5],W.bezierCurveTo(g[w],g[w+1],g[w+2],g[w+3],U,Q),z.updateCurvePathMinMax(ie,ee,he,g[w],g[w+1],g[w+2],g[w+3],U,Q,i),w+=6;break;case x.OPS.curveTo2:ee=U,he=Q,W.bezierCurveTo(U,Q,g[w],g[w+1],g[w+2],g[w+3]),z.updateCurvePathMinMax(ie,ee,he,U,Q,g[w],g[w+1],g[w+2],g[w+3],i),U=g[w+2],Q=g[w+3],w+=4;break;case x.OPS.curveTo3:ee=U,he=Q,U=g[w+2],Q=g[w+3],W.bezierCurveTo(g[w],g[w+1],U,Q,U,Q),z.updateCurvePathMinMax(ie,ee,he,g[w],g[w+1],U,Q,U,Q,i),w+=4;break;case x.OPS.closePath:W.closePath();break}v&&z.updateScalingPathMinMax(ie,i),z.setCurrentPoint(U,Q)}closePath(){this.ctx.closePath()}stroke(p=!0){const g=this.ctx,M=this.current.strokeColor;g.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof M=="object"&&(M!=null&&M.getPattern)?(g.save(),g.strokeStyle=M.getPattern(g,this,(0,V.getCurrentTransformInverse)(g),ne.PathType.STROKE),this.rescaleAndStroke(!1),g.restore()):this.rescaleAndStroke(!0)),p&&this.consumePath(this.current.getClippedPathBoundingBox()),g.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(p=!0){const g=this.ctx,M=this.current.fillColor,W=this.current.patternFill;let z=!1;W&&(g.save(),g.fillStyle=M.getPattern(g,this,(0,V.getCurrentTransformInverse)(g),ne.PathType.FILL),z=!0);const U=this.current.getClippedPathBoundingBox();this.contentVisible&&U!==null&&(this.pendingEOFill?(g.fill("evenodd"),this.pendingEOFill=!1):g.fill()),z&&g.restore(),p&&this.consumePath(U)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=J}eoClip(){this.pendingClip=K}beginText(){this.current.textMatrix=x.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const p=this.pendingTextPaths,g=this.ctx;if(p===void 0){g.beginPath();return}g.save(),g.beginPath();for(const M of p)g.setTransform(...M.transform),g.translate(M.x,M.y),M.addToPath(g,M.fontSize);g.restore(),g.clip(),g.beginPath(),delete this.pendingTextPaths}setCharSpacing(p){this.current.charSpacing=p}setWordSpacing(p){this.current.wordSpacing=p}setHScale(p){this.current.textHScale=p/100}setLeading(p){this.current.leading=-p}setFont(p,g){const M=this.commonObjs.get(p),W=this.current;if(!M)throw new Error(`Can't find font for ${p}`);if(W.fontMatrix=M.fontMatrix||x.FONT_IDENTITY_MATRIX,(W.fontMatrix[0]===0||W.fontMatrix[3]===0)&&(0,x.warn)("Invalid font matrix for font "+p),g<0?(g=-g,W.fontDirection=-1):W.fontDirection=1,this.current.font=M,this.current.fontSize=g,M.isType3Font)return;const z=M.loadedName||"sans-serif";let U="normal";M.black?U="900":M.bold&&(U="bold");const Q=M.italic?"italic":"normal",ee=`"${z}", ${M.fallbackName}`;let he=g;g<R?he=R:g>N&&(he=N),this.current.fontSizeScale=g/he,this.ctx.font=`${Q} ${U} ${he}px ${ee}`}setTextRenderingMode(p){this.current.textRenderingMode=p}setTextRise(p){this.current.textRise=p}moveText(p,g){this.current.x=this.current.lineX+=p,this.current.y=this.current.lineY+=g}setLeadingMoveText(p,g){this.setLeading(-g),this.moveText(p,g)}setTextMatrix(p,g,M,W,z,U){this.current.textMatrix=[p,g,M,W,z,U],this.current.textMatrixScale=Math.hypot(p,g),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(p,g,M,W){const z=this.ctx,U=this.current,Q=U.font,ee=U.textRenderingMode,he=U.fontSize/U.fontSizeScale,ie=ee&x.TextRenderingMode.FILL_STROKE_MASK,v=!!(ee&x.TextRenderingMode.ADD_TO_PATH_FLAG),i=U.patternFill&&!Q.missingFile;let b;(Q.disableFontFace||v||i)&&(b=Q.getPathGenerator(this.commonObjs,p)),Q.disableFontFace||i?(z.save(),z.translate(g,M),z.beginPath(),b(z,he),W&&z.setTransform(...W),(ie===x.TextRenderingMode.FILL||ie===x.TextRenderingMode.FILL_STROKE)&&z.fill(),(ie===x.TextRenderingMode.STROKE||ie===x.TextRenderingMode.FILL_STROKE)&&z.stroke(),z.restore()):((ie===x.TextRenderingMode.FILL||ie===x.TextRenderingMode.FILL_STROKE)&&z.fillText(p,g,M),(ie===x.TextRenderingMode.STROKE||ie===x.TextRenderingMode.FILL_STROKE)&&z.strokeText(p,g,M)),v&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,V.getCurrentTransform)(z),x:g,y:M,fontSize:he,addToPath:b})}get isFontSubpixelAAEnabled(){const{context:p}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);p.scale(1.5,1),p.fillText("I",0,10);const g=p.getImageData(0,0,10,10).data;let M=!1;for(let W=3;W<g.length;W+=4)if(g[W]>0&&g[W]<255){M=!0;break}return(0,x.shadow)(this,"isFontSubpixelAAEnabled",M)}showText(p){const g=this.current,M=g.font;if(M.isType3Font)return this.showType3Text(p);const W=g.fontSize;if(W===0)return;const z=this.ctx,U=g.fontSizeScale,Q=g.charSpacing,ee=g.wordSpacing,he=g.fontDirection,ie=g.textHScale*he,v=p.length,i=M.vertical,b=i?1:-1,w=M.defaultVMetrics,A=W*g.fontMatrix[0],I=g.textRenderingMode===x.TextRenderingMode.FILL&&!M.disableFontFace&&!g.patternFill;z.save(),z.transform(...g.textMatrix),z.translate(g.x,g.y+g.textRise),he>0?z.scale(ie,-1):z.scale(ie,1);let j;if(g.patternFill){z.save();const D=g.fillColor.getPattern(z,this,(0,V.getCurrentTransformInverse)(z),ne.PathType.FILL);j=(0,V.getCurrentTransform)(z),z.restore(),z.fillStyle=D}let G=g.lineWidth;const H=g.textMatrixScale;if(H===0||G===0){const D=g.textRenderingMode&x.TextRenderingMode.FILL_STROKE_MASK;(D===x.TextRenderingMode.STROKE||D===x.TextRenderingMode.FILL_STROKE)&&(G=this.getSinglePixelWidth())}else G/=H;if(U!==1&&(z.scale(U,U),G/=U),z.lineWidth=G,M.isInvalidPDFjsFont){const D=[];let q=0;for(const oe of p)D.push(oe.unicode),q+=oe.width;z.fillText(D.join(""),0,0),g.x+=q*A*ie,z.restore(),this.compose();return}let S=0,F;for(F=0;F<v;++F){const D=p[F];if(typeof D=="number"){S+=b*D*W/1e3;continue}let q=!1;const oe=(D.isSpace?ee:0)+Q,fe=D.fontChar,ge=D.accent;let be,Ae,ve=D.width;if(i){const Ee=D.vmetric||w,ce=-(D.vmetric?Ee[1]:ve*.5)*A,se=Ee[2]*A;ve=Ee?-Ee[0]:ve,be=ce/U,Ae=(S+se)/U}else be=S/U,Ae=0;if(M.remeasure&&ve>0){const Ee=z.measureText(fe).width*1e3/W*U;if(ve<Ee&&this.isFontSubpixelAAEnabled){const ce=ve/Ee;q=!0,z.save(),z.scale(ce,1),be/=ce}else ve!==Ee&&(be+=(ve-Ee)/2e3*W/U)}if(this.contentVisible&&(D.isInFont||M.missingFile)){if(I&&!ge)z.fillText(fe,be,Ae);else if(this.paintChar(fe,be,Ae,j),ge){const Ee=be+W*ge.offset.x/U,ce=Ae-W*ge.offset.y/U;this.paintChar(ge.fontChar,Ee,ce,j)}}let Pe;i?Pe=ve*A-oe*he:Pe=ve*A+oe*he,S+=Pe,q&&z.restore()}i?g.y-=S:g.x+=S*ie,z.restore(),this.compose()}showType3Text(p){const g=this.ctx,M=this.current,W=M.font,z=M.fontSize,U=M.fontDirection,Q=W.vertical?1:-1,ee=M.charSpacing,he=M.wordSpacing,ie=M.textHScale*U,v=M.fontMatrix||x.FONT_IDENTITY_MATRIX,i=p.length,b=M.textRenderingMode===x.TextRenderingMode.INVISIBLE;let w,A,I,j;if(!(b||z===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,g.save(),g.transform(...M.textMatrix),g.translate(M.x,M.y),g.scale(ie,U),w=0;w<i;++w){if(A=p[w],typeof A=="number"){j=Q*A*z/1e3,this.ctx.translate(j,0),M.x+=j*ie;continue}const G=(A.isSpace?he:0)+ee,H=W.charProcOperatorList[A.operatorListId];if(!H){(0,x.warn)(`Type3 character "${A.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=A,this.save(),g.scale(z,z),g.transform(...v),this.executeOperatorList(H),this.restore()),I=x.Util.applyTransform([A.width,0],v)[0]*z+G,g.translate(I,0),M.x+=I*ie}g.restore(),this.processingType3=null}}setCharWidth(p,g){}setCharWidthAndBounds(p,g,M,W,z,U){this.ctx.rect(M,W,z-M,U-W),this.ctx.clip(),this.endPath()}getColorN_Pattern(p){let g;if(p[0]==="TilingPattern"){const M=p[1],W=this.baseTransform||(0,V.getCurrentTransform)(this.ctx),z={createCanvasGraphics:U=>new re(U,this.commonObjs,this.objs,this.canvasFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};g=new ne.TilingPattern(p,M,this.ctx,z,W)}else g=this._getPattern(p[1],p[2]);return g}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(p,g,M){var z;const W=((z=this.selectColor)==null?void 0:z.call(this,p,g,M))||x.Util.makeHexColor(p,g,M);this.ctx.strokeStyle=W,this.current.strokeColor=W}setFillRGBColor(p,g,M){var z;const W=((z=this.selectColor)==null?void 0:z.call(this,p,g,M))||x.Util.makeHexColor(p,g,M);this.ctx.fillStyle=W,this.current.fillColor=W,this.current.patternFill=!1}_getPattern(p,g=null){let M;return this.cachedPatterns.has(p)?M=this.cachedPatterns.get(p):(M=(0,ne.getShadingPattern)(this.objs.get(p)),this.cachedPatterns.set(p,M)),g&&(M.matrix=g),M}shadingFill(p){if(!this.contentVisible)return;const g=this.ctx;this.save();const M=this._getPattern(p);g.fillStyle=M.getPattern(g,this,(0,V.getCurrentTransformInverse)(g),ne.PathType.SHADING);const W=(0,V.getCurrentTransformInverse)(g);if(W){const z=g.canvas,U=z.width,Q=z.height,ee=x.Util.applyTransform([0,0],W),he=x.Util.applyTransform([0,Q],W),ie=x.Util.applyTransform([U,0],W),v=x.Util.applyTransform([U,Q],W),i=Math.min(ee[0],he[0],ie[0],v[0]),b=Math.min(ee[1],he[1],ie[1],v[1]),w=Math.max(ee[0],he[0],ie[0],v[0]),A=Math.max(ee[1],he[1],ie[1],v[1]);this.ctx.fillRect(i,b,w-i,A-b)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,x.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,x.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(p,g){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(p)&&p.length===6&&this.transform(...p),this.baseTransform=(0,V.getCurrentTransform)(this.ctx),g)){const M=g[2]-g[0],W=g[3]-g[1];this.ctx.rect(g[0],g[1],M,W),this.current.updateRectMinMax((0,V.getCurrentTransform)(this.ctx),g),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(p){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const g=this.ctx;p.isolated||(0,x.info)("TODO: Support non-isolated groups."),p.knockout&&(0,x.warn)("Knockout groups not supported.");const M=(0,V.getCurrentTransform)(g);if(p.matrix&&g.transform(...p.matrix),!p.bbox)throw new Error("Bounding box is required.");let W=x.Util.getAxialAlignedBoundingBox(p.bbox,(0,V.getCurrentTransform)(g));const z=[0,0,g.canvas.width,g.canvas.height];W=x.Util.intersect(W,z)||[0,0,0,0];const U=Math.floor(W[0]),Q=Math.floor(W[1]);let ee=Math.max(Math.ceil(W[2])-U,1),he=Math.max(Math.ceil(W[3])-Q,1),ie=1,v=1;ee>h&&(ie=ee/h,ee=h),he>h&&(v=he/h,he=h),this.current.startNewPathAndClipBox([0,0,ee,he]);let i="groupAt"+this.groupLevel;p.smask&&(i+="_smask_"+this.smaskCounter++%2);const b=this.cachedCanvases.getCanvas(i,ee,he),w=b.context;w.scale(1/ie,1/v),w.translate(-U,-Q),w.transform(...M),p.smask?this.smaskStack.push({canvas:b.canvas,context:w,offsetX:U,offsetY:Q,scaleX:ie,scaleY:v,subtype:p.smask.subtype,backdrop:p.smask.backdrop,transferMap:p.smask.transferMap||null,startTransformInverse:null}):(g.setTransform(1,0,0,1,0,0),g.translate(U,Q),g.scale(ie,v),g.save()),t(g,w),this.ctx=w,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(g),this.groupLevel++}endGroup(p){if(!this.contentVisible)return;this.groupLevel--;const g=this.ctx,M=this.groupStack.pop();if(this.ctx=M,this.ctx.imageSmoothingEnabled=!1,p.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const W=(0,V.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...W);const z=x.Util.getAxialAlignedBoundingBox([0,0,g.canvas.width,g.canvas.height],W);this.ctx.drawImage(g.canvas,0,0),this.ctx.restore(),this.compose(z)}}beginAnnotation(p,g,M,W,z){if(te(this,k,mt).call(this),n(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(g)&&g.length===4){const U=g[2]-g[0],Q=g[3]-g[1];if(z&&this.annotationCanvasMap){M=M.slice(),M[4]-=g[0],M[5]-=g[1],g=g.slice(),g[0]=g[1]=0,g[2]=U,g[3]=Q;const[ee,he]=x.Util.singularValueDecompose2dScale((0,V.getCurrentTransform)(this.ctx)),{viewportScale:ie}=this,v=Math.ceil(U*this.outputScaleX*ie),i=Math.ceil(Q*this.outputScaleY*ie);this.annotationCanvas=this.canvasFactory.create(v,i);const{canvas:b,context:w}=this.annotationCanvas;this.annotationCanvasMap.set(p,b),this.annotationCanvas.savedCtx=this.ctx,this.ctx=w,this.ctx.setTransform(ee,0,0,-he,0,Q*he),n(this.ctx,this.foregroundColor)}else n(this.ctx,this.foregroundColor),this.ctx.rect(g[0],g[1],U,Q),this.ctx.clip(),this.endPath()}this.current=new r(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...M),this.transform(...W)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(p){if(!this.contentVisible)return;const g=p.count;p=this.getObject(p.data,p),p.count=g;const M=this.ctx,W=this.processingType3;if(W&&(W.compiled===void 0&&(W.compiled=e(p)),W.compiled)){W.compiled(M);return}const z=this._createMaskCanvas(p),U=z.canvas;M.save(),M.setTransform(1,0,0,1,0,0),M.drawImage(U,z.offsetX,z.offsetY),M.restore(),this.compose()}paintImageMaskXObjectRepeat(p,g,M=0,W=0,z,U){if(!this.contentVisible)return;p=this.getObject(p.data,p);const Q=this.ctx;Q.save();const ee=(0,V.getCurrentTransform)(Q);Q.transform(g,M,W,z,0,0);const he=this._createMaskCanvas(p);Q.setTransform(1,0,0,1,he.offsetX-ee[4],he.offsetY-ee[5]);for(let ie=0,v=U.length;ie<v;ie+=2){const i=x.Util.transform(ee,[g,M,W,z,U[ie],U[ie+1]]),[b,w]=x.Util.applyTransform([0,0],i);Q.drawImage(he.canvas,b,w)}Q.restore(),this.compose()}paintImageMaskXObjectGroup(p){if(!this.contentVisible)return;const g=this.ctx,M=this.current.fillColor,W=this.current.patternFill;for(const z of p){const{data:U,width:Q,height:ee,transform:he}=z,ie=this.cachedCanvases.getCanvas("maskCanvas",Q,ee),v=ie.context;v.save();const i=this.getObject(U,z);o(v,i),v.globalCompositeOperation="source-in",v.fillStyle=W?M.getPattern(v,this,(0,V.getCurrentTransformInverse)(g),ne.PathType.FILL):M,v.fillRect(0,0,Q,ee),v.restore(),g.save(),g.transform(...he),g.scale(1,-1),s(g,ie.canvas,0,0,Q,ee,0,-1,1,1),g.restore()}this.compose()}paintImageXObject(p){if(!this.contentVisible)return;const g=this.getObject(p);if(!g){(0,x.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(g)}paintImageXObjectRepeat(p,g,M,W){if(!this.contentVisible)return;const z=this.getObject(p);if(!z){(0,x.warn)("Dependent image isn't ready yet");return}const U=z.width,Q=z.height,ee=[];for(let he=0,ie=W.length;he<ie;he+=2)ee.push({transform:[g,0,0,M,W[he],W[he+1]],x:0,y:0,w:U,h:Q});this.paintInlineImageXObjectGroup(z,ee)}paintInlineImageXObject(p){if(!this.contentVisible)return;const g=p.width,M=p.height,W=this.ctx;this.save(),W.scale(1/g,-1/M);let z;if(typeof HTMLElement=="function"&&p instanceof HTMLElement||!p.data)z=p;else{const Q=this.cachedCanvases.getCanvas("inlineImage",g,M),ee=Q.context;c(ee,p,this.current.transferMaps),z=Q.canvas}const U=this._scaleImage(z,(0,V.getCurrentTransformInverse)(W));W.imageSmoothingEnabled=Y((0,V.getCurrentTransform)(W),p.interpolate),s(W,U.img,0,0,U.paintWidth,U.paintHeight,0,-M,g,M),this.compose(),this.restore()}paintInlineImageXObjectGroup(p,g){if(!this.contentVisible)return;const M=this.ctx,W=p.width,z=p.height,U=this.cachedCanvases.getCanvas("inlineImage",W,z),Q=U.context;c(Q,p,this.current.transferMaps);for(const ee of g)M.save(),M.transform(...ee.transform),M.scale(1,-1),s(M,U.canvas,ee.x,ee.y,ee.w,ee.h,0,-1,1,1),M.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(p){}markPointProps(p,g){}beginMarkedContent(p){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(p,g){p==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(g)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(p){const g=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(p);const M=this.ctx;this.pendingClip&&(g||(this.pendingClip===K?M.clip("evenodd"):M.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),M.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const p=(0,V.getCurrentTransform)(this.ctx);if(p[1]===0&&p[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(p[0]),Math.abs(p[3]));else{const g=Math.abs(p[0]*p[3]-p[2]*p[1]),M=Math.hypot(p[0],p[2]),W=Math.hypot(p[1],p[3]);this._cachedGetSinglePixelWidth=Math.max(M,W)/g}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:p}=this.current,g=(0,V.getCurrentTransform)(this.ctx);let M,W;if(g[1]===0&&g[2]===0){const z=Math.abs(g[0]),U=Math.abs(g[3]);if(p===0)M=1/z,W=1/U;else{const Q=z*p,ee=U*p;M=Q<1?1/Q:1,W=ee<1?1/ee:1}}else{const z=Math.abs(g[0]*g[3]-g[2]*g[1]),U=Math.hypot(g[0],g[1]),Q=Math.hypot(g[2],g[3]);if(p===0)M=Q/z,W=U/z;else{const ee=p*z;M=Q>ee?Q/ee:1,W=U>ee?U/ee:1}}this._cachedScaleForStroking=[M,W]}return this._cachedScaleForStroking}rescaleAndStroke(p){const{ctx:g}=this,{lineWidth:M}=this.current,[W,z]=this.getScaleForStroking();if(g.lineWidth=M||1,W===1&&z===1){g.stroke();return}let U,Q,ee;p&&(U=(0,V.getCurrentTransform)(g),Q=g.getLineDash().slice(),ee=g.lineDashOffset),g.scale(W,z);const he=Math.max(W,z);g.setLineDash(g.getLineDash().map(ie=>ie/he)),g.lineDashOffset/=he,g.stroke(),p&&(g.setTransform(...U),g.setLineDash(Q),g.lineDashOffset=ee)}isContentVisible(){for(let p=this.markedContentStack.length-1;p>=0;p--)if(!this.markedContentStack[p].visible)return!1;return!0}};k=new WeakSet,mt=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)};let $=re;P.CanvasGraphics=$;for(const y in x.OPS)$.prototype[y]!==void 0&&($.prototype[x.OPS[y]]=$.prototype[y])},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.TilingPattern=P.PathType=void 0,P.getShadingPattern=u;var x=Z(1),V=Z(6);const ne={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};P.PathType=ne;function B(s,e){if(!e)return;const r=e[2]-e[0],c=e[3]-e[1],o=new Path2D;o.rect(e[0],e[1],r,c),s.clip(o)}class R{constructor(){this.constructor===R&&(0,x.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,x.unreachable)("Abstract method `getPattern` called.")}}class N extends R{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let r;this._type==="axial"?r=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(r=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const c of this._colorStops)r.addColorStop(c[0],c[1]);return r}getPattern(e,r,c,o){let t;if(o===ne.STROKE||o===ne.FILL){const n=r.current.getClippedPathBoundingBox(o,(0,V.getCurrentTransform)(e))||[0,0,0,0],f=Math.ceil(n[2]-n[0])||1,a=Math.ceil(n[3]-n[1])||1,T=r.cachedCanvases.getCanvas("pattern",f,a,!0),O=T.context;O.clearRect(0,0,O.canvas.width,O.canvas.height),O.beginPath(),O.rect(0,0,O.canvas.width,O.canvas.height),O.translate(-n[0],-n[1]),c=x.Util.transform(c,[1,0,0,1,n[0],n[1]]),O.transform(...r.baseTransform),this.matrix&&O.transform(...this.matrix),B(O,this._bbox),O.fillStyle=this._createGradient(O),O.fill(),t=e.createPattern(T.canvas,"no-repeat");const X=new DOMMatrix(c);t.setTransform(X)}else B(e,this._bbox),t=this._createGradient(e);return t}}function h(s,e,r,c,o,t,n,f){const a=e.coords,T=e.colors,O=s.data,X=s.width*4;let Y;a[r+1]>a[c+1]&&(Y=r,r=c,c=Y,Y=t,t=n,n=Y),a[c+1]>a[o+1]&&(Y=c,c=o,o=Y,Y=n,n=f,f=Y),a[r+1]>a[c+1]&&(Y=r,r=c,c=Y,Y=t,t=n,n=Y);const _e=(a[r]+e.offsetX)*e.scaleX,ue=(a[r+1]+e.offsetY)*e.scaleY,J=(a[c]+e.offsetX)*e.scaleX,K=(a[c+1]+e.offsetY)*e.scaleY,$=(a[o]+e.offsetX)*e.scaleX,k=(a[o+1]+e.offsetY)*e.scaleY;if(ue>=k)return;const le=T[t],re=T[t+1],y=T[t+2],p=T[n],g=T[n+1],M=T[n+2],W=T[f],z=T[f+1],U=T[f+2],Q=Math.round(ue),ee=Math.round(k);let he,ie,v,i,b,w,A,I;for(let j=Q;j<=ee;j++){if(j<K){let D;j<ue?D=0:D=(ue-j)/(ue-K),he=_e-(_e-J)*D,ie=le-(le-p)*D,v=re-(re-g)*D,i=y-(y-M)*D}else{let D;j>k?D=1:K===k?D=0:D=(K-j)/(K-k),he=J-(J-$)*D,ie=p-(p-W)*D,v=g-(g-z)*D,i=M-(M-U)*D}let G;j<ue?G=0:j>k?G=1:G=(ue-j)/(ue-k),b=_e-(_e-$)*G,w=le-(le-W)*G,A=re-(re-z)*G,I=y-(y-U)*G;const H=Math.round(Math.min(he,b)),S=Math.round(Math.max(he,b));let F=X*j+H*4;for(let D=H;D<=S;D++)G=(he-D)/(he-b),G<0?G=0:G>1&&(G=1),O[F++]=ie-(ie-w)*G|0,O[F++]=v-(v-A)*G|0,O[F++]=i-(i-I)*G|0,O[F++]=255}}function m(s,e,r){const c=e.coords,o=e.colors;let t,n;switch(e.type){case"lattice":const f=e.verticesPerRow,a=Math.floor(c.length/f)-1,T=f-1;for(t=0;t<a;t++){let O=t*f;for(let X=0;X<T;X++,O++)h(s,r,c[O],c[O+1],c[O+f],o[O],o[O+1],o[O+f]),h(s,r,c[O+f+1],c[O+1],c[O+f],o[O+f+1],o[O+1],o[O+f])}break;case"triangles":for(t=0,n=c.length;t<n;t+=3)h(s,r,c[t],c[t+1],c[t+2],o[t],o[t+1],o[t+2]);break;default:throw new Error("illegal figure")}}class L extends R{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,r,c){const f=Math.floor(this._bounds[0]),a=Math.floor(this._bounds[1]),T=Math.ceil(this._bounds[2])-f,O=Math.ceil(this._bounds[3])-a,X=Math.min(Math.ceil(Math.abs(T*e[0]*1.1)),3e3),Y=Math.min(Math.ceil(Math.abs(O*e[1]*1.1)),3e3),_e=T/X,ue=O/Y,J={coords:this._coords,colors:this._colors,offsetX:-f,offsetY:-a,scaleX:1/_e,scaleY:1/ue},K=X+2*2,$=Y+2*2,k=c.getCanvas("mesh",K,$,!1),le=k.context,re=le.createImageData(X,Y);if(r){const p=re.data;for(let g=0,M=p.length;g<M;g+=4)p[g]=r[0],p[g+1]=r[1],p[g+2]=r[2],p[g+3]=255}for(const p of this._figures)m(re,p,J);return le.putImageData(re,2,2),{canvas:k.canvas,offsetX:f-2*_e,offsetY:a-2*ue,scaleX:_e,scaleY:ue}}getPattern(e,r,c,o){B(e,this._bbox);let t;if(o===ne.SHADING)t=x.Util.singularValueDecompose2dScale((0,V.getCurrentTransform)(e));else if(t=x.Util.singularValueDecompose2dScale(r.baseTransform),this.matrix){const f=x.Util.singularValueDecompose2dScale(this.matrix);t=[t[0]*f[0],t[1]*f[1]]}const n=this._createMeshCanvas(t,o===ne.SHADING?null:this._background,r.cachedCanvases);return o!==ne.SHADING&&(e.setTransform(...r.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(n.offsetX,n.offsetY),e.scale(n.scaleX,n.scaleY),e.createPattern(n.canvas,"no-repeat")}}class C extends R{getPattern(){return"hotpink"}}function u(s){switch(s[0]){case"RadialAxial":return new N(s);case"Mesh":return new L(s);case"Dummy":return new C}throw new Error(`Unknown IR type: ${s[0]}`)}const l={COLORED:1,UNCOLORED:2};class d{static get MAX_PATTERN_SIZE(){return(0,x.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(e,r,c,o,t){this.operatorList=e[2],this.matrix=e[3]||[1,0,0,1,0,0],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=r,this.ctx=c,this.canvasGraphicsFactory=o,this.baseTransform=t}createPatternCanvas(e){const r=this.operatorList,c=this.bbox,o=this.xstep,t=this.ystep,n=this.paintType,f=this.tilingType,a=this.color,T=this.canvasGraphicsFactory;(0,x.info)("TilingType: "+f);const O=c[0],X=c[1],Y=c[2],_e=c[3],ue=x.Util.singularValueDecompose2dScale(this.matrix),J=x.Util.singularValueDecompose2dScale(this.baseTransform),K=[ue[0]*J[0],ue[1]*J[1]],$=this.getSizeAndScale(o,this.ctx.canvas.width,K[0]),k=this.getSizeAndScale(t,this.ctx.canvas.height,K[1]),le=e.cachedCanvases.getCanvas("pattern",$.size,k.size,!0),re=le.context,y=T.createCanvasGraphics(re);y.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(y,n,a);let p=O,g=X,M=Y,W=_e;return O<0&&(p=0,M+=Math.abs(O)),X<0&&(g=0,W+=Math.abs(X)),re.translate(-($.scale*p),-(k.scale*g)),y.transform($.scale,0,0,k.scale,0,0),re.save(),this.clipBbox(y,p,g,M,W),y.baseTransform=(0,V.getCurrentTransform)(y.ctx),y.executeOperatorList(r),y.endDrawing(),{canvas:le.canvas,scaleX:$.scale,scaleY:k.scale,offsetX:p,offsetY:g}}getSizeAndScale(e,r,c){e=Math.abs(e);const o=Math.max(d.MAX_PATTERN_SIZE,r);let t=Math.ceil(e*c);return t>=o?t=o:c=t/e,{scale:c,size:t}}clipBbox(e,r,c,o,t){const n=o-r,f=t-c;e.ctx.rect(r,c,n,f),e.current.updateRectMinMax((0,V.getCurrentTransform)(e.ctx),[r,c,o,t]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,r,c){const o=e.ctx,t=e.current;switch(r){case l.COLORED:const n=this.ctx;o.fillStyle=n.fillStyle,o.strokeStyle=n.strokeStyle,t.fillColor=n.fillStyle,t.strokeColor=n.strokeStyle;break;case l.UNCOLORED:const f=x.Util.makeHexColor(c[0],c[1],c[2]);o.fillStyle=f,o.strokeStyle=f,t.fillColor=f,t.strokeColor=f;break;default:throw new x.FormatError(`Unsupported paint type: ${r}`)}}getPattern(e,r,c,o){let t=c;o!==ne.SHADING&&(t=x.Util.transform(t,r.baseTransform),this.matrix&&(t=x.Util.transform(t,this.matrix)));const n=this.createPatternCanvas(r);let f=new DOMMatrix(t);f=f.translate(n.offsetX,n.offsetY),f=f.scale(1/n.scaleX,1/n.scaleY);const a=e.createPattern(n.canvas,"repeat");return a.setTransform(f),a}}P.TilingPattern=d},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.applyMaskImageData=V;var x=Z(1);function V({src:ne,srcPos:B=0,dest:R,destPos:N=0,width:h,height:m,inverseDecode:L=!1}){const C=x.FeatureTest.isLittleEndian?4278190080:255,[u,l]=L?[0,C]:[C,0],d=h>>3,s=h&7,e=ne.length;R=new Uint32Array(R.buffer);for(let r=0;r<m;r++){for(const o=B+d;B<o;B++){const t=B<e?ne[B]:255;R[N++]=t&128?l:u,R[N++]=t&64?l:u,R[N++]=t&32?l:u,R[N++]=t&16?l:u,R[N++]=t&8?l:u,R[N++]=t&4?l:u,R[N++]=t&2?l:u,R[N++]=t&1?l:u}if(s===0)continue;const c=B<e?ne[B++]:255;for(let o=0;o<s;o++)R[N++]=c&1<<7-o?l:u}return{srcPos:B,destPos:N}}},(me,P)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.GlobalWorkerOptions=void 0;const Z=Object.create(null);P.GlobalWorkerOptions=Z,Z.workerPort=null,Z.workerSrc=""},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.MessageHandler=void 0;var x=Z(1);const V={UNKNOWN:0,DATA:1,ERROR:2},ne={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function B(N){switch(N instanceof Error||typeof N=="object"&&N!==null||(0,x.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),N.name){case"AbortException":return new x.AbortException(N.message);case"MissingPDFException":return new x.MissingPDFException(N.message);case"PasswordException":return new x.PasswordException(N.message,N.code);case"UnexpectedResponseException":return new x.UnexpectedResponseException(N.message,N.status);case"UnknownErrorException":return new x.UnknownErrorException(N.message,N.details);default:return new x.UnknownErrorException(N.message,N.toString())}}class R{constructor(h,m,L){this.sourceName=h,this.targetName=m,this.comObj=L,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=C=>{const u=C.data;if(u.targetName!==this.sourceName)return;if(u.stream){this._processStreamMessage(u);return}if(u.callback){const d=u.callbackId,s=this.callbackCapabilities[d];if(!s)throw new Error(`Cannot resolve callback ${d}`);if(delete this.callbackCapabilities[d],u.callback===V.DATA)s.resolve(u.data);else if(u.callback===V.ERROR)s.reject(B(u.reason));else throw new Error("Unexpected callback case");return}const l=this.actionHandler[u.action];if(!l)throw new Error(`Unknown action from worker: ${u.action}`);if(u.callbackId){const d=this.sourceName,s=u.sourceName;new Promise(function(e){e(l(u.data))}).then(function(e){L.postMessage({sourceName:d,targetName:s,callback:V.DATA,callbackId:u.callbackId,data:e})},function(e){L.postMessage({sourceName:d,targetName:s,callback:V.ERROR,callbackId:u.callbackId,reason:B(e)})});return}if(u.streamId){this._createStreamSink(u);return}l(u.data)},L.addEventListener("message",this._onComObjOnMessage)}on(h,m){const L=this.actionHandler;if(L[h])throw new Error(`There is already an actionName called "${h}"`);L[h]=m}send(h,m,L){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,data:m},L)}sendWithPromise(h,m,L){const C=this.callbackId++,u=(0,x.createPromiseCapability)();this.callbackCapabilities[C]=u;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,callbackId:C,data:m},L)}catch(l){u.reject(l)}return u.promise}sendWithStream(h,m,L,C){const u=this.streamId++,l=this.sourceName,d=this.targetName,s=this.comObj;return new ReadableStream({start:e=>{const r=(0,x.createPromiseCapability)();return this.streamControllers[u]={controller:e,startCall:r,pullCall:null,cancelCall:null,isClosed:!1},s.postMessage({sourceName:l,targetName:d,action:h,streamId:u,data:m,desiredSize:e.desiredSize},C),r.promise},pull:e=>{const r=(0,x.createPromiseCapability)();return this.streamControllers[u].pullCall=r,s.postMessage({sourceName:l,targetName:d,stream:ne.PULL,streamId:u,desiredSize:e.desiredSize}),r.promise},cancel:e=>{(0,x.assert)(e instanceof Error,"cancel must have a valid reason");const r=(0,x.createPromiseCapability)();return this.streamControllers[u].cancelCall=r,this.streamControllers[u].isClosed=!0,s.postMessage({sourceName:l,targetName:d,stream:ne.CANCEL,streamId:u,reason:B(e)}),r.promise}},L)}_createStreamSink(h){const m=h.streamId,L=this.sourceName,C=h.sourceName,u=this.comObj,l=this,d=this.actionHandler[h.action],s={enqueue(e,r=1,c){if(this.isCancelled)return;const o=this.desiredSize;this.desiredSize-=r,o>0&&this.desiredSize<=0&&(this.sinkCapability=(0,x.createPromiseCapability)(),this.ready=this.sinkCapability.promise),u.postMessage({sourceName:L,targetName:C,stream:ne.ENQUEUE,streamId:m,chunk:e},c)},close(){this.isCancelled||(this.isCancelled=!0,u.postMessage({sourceName:L,targetName:C,stream:ne.CLOSE,streamId:m}),delete l.streamSinks[m])},error(e){(0,x.assert)(e instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,u.postMessage({sourceName:L,targetName:C,stream:ne.ERROR,streamId:m,reason:B(e)}))},sinkCapability:(0,x.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:h.desiredSize,ready:null};s.sinkCapability.resolve(),s.ready=s.sinkCapability.promise,this.streamSinks[m]=s,new Promise(function(e){e(d(h.data,s))}).then(function(){u.postMessage({sourceName:L,targetName:C,stream:ne.START_COMPLETE,streamId:m,success:!0})},function(e){u.postMessage({sourceName:L,targetName:C,stream:ne.START_COMPLETE,streamId:m,reason:B(e)})})}_processStreamMessage(h){const m=h.streamId,L=this.sourceName,C=h.sourceName,u=this.comObj,l=this.streamControllers[m],d=this.streamSinks[m];switch(h.stream){case ne.START_COMPLETE:h.success?l.startCall.resolve():l.startCall.reject(B(h.reason));break;case ne.PULL_COMPLETE:h.success?l.pullCall.resolve():l.pullCall.reject(B(h.reason));break;case ne.PULL:if(!d){u.postMessage({sourceName:L,targetName:C,stream:ne.PULL_COMPLETE,streamId:m,success:!0});break}d.desiredSize<=0&&h.desiredSize>0&&d.sinkCapability.resolve(),d.desiredSize=h.desiredSize,new Promise(function(s){s(d.onPull&&d.onPull())}).then(function(){u.postMessage({sourceName:L,targetName:C,stream:ne.PULL_COMPLETE,streamId:m,success:!0})},function(s){u.postMessage({sourceName:L,targetName:C,stream:ne.PULL_COMPLETE,streamId:m,reason:B(s)})});break;case ne.ENQUEUE:if((0,x.assert)(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(h.chunk);break;case ne.CLOSE:if((0,x.assert)(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this._deleteStreamController(l,m);break;case ne.ERROR:(0,x.assert)(l,"error should have stream controller"),l.controller.error(B(h.reason)),this._deleteStreamController(l,m);break;case ne.CANCEL_COMPLETE:h.success?l.cancelCall.resolve():l.cancelCall.reject(B(h.reason)),this._deleteStreamController(l,m);break;case ne.CANCEL:if(!d)break;new Promise(function(s){s(d.onCancel&&d.onCancel(B(h.reason)))}).then(function(){u.postMessage({sourceName:L,targetName:C,stream:ne.CANCEL_COMPLETE,streamId:m,success:!0})},function(s){u.postMessage({sourceName:L,targetName:C,stream:ne.CANCEL_COMPLETE,streamId:m,reason:B(s)})}),d.sinkCapability.reject(B(h.reason)),d.isCancelled=!0,delete this.streamSinks[m];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(h,m){await Promise.allSettled([h.startCall&&h.startCall.promise,h.pullCall&&h.pullCall.promise,h.cancelCall&&h.cancelCall.promise]),delete this.streamControllers[m]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}P.MessageHandler=R},(me,P,Z)=>{var ne,B;Object.defineProperty(P,"__esModule",{value:!0}),P.Metadata=void 0;var x=Z(1);class V{constructor({parsedData:N,rawData:h}){de(this,ne);de(this,B);pe(this,ne,N),pe(this,B,h)}getRaw(){return E(this,B)}get(N){return E(this,ne).get(N)??null}getAll(){return(0,x.objectFromMap)(E(this,ne))}has(N){return E(this,ne).has(N)}}ne=new WeakMap,B=new WeakMap,P.Metadata=V},(me,P,Z)=>{var N,h,m,L,C,u,_t;Object.defineProperty(P,"__esModule",{value:!0}),P.OptionalContentConfig=void 0;var x=Z(1),V=Z(8);const ne=Symbol("INTERNAL");class B{constructor(s,e){de(this,N,!0);this.name=s,this.intent=e}get visible(){return E(this,N)}_setVisible(s,e){s!==ne&&(0,x.unreachable)("Internal method `_setVisible` called."),pe(this,N,e)}}N=new WeakMap;class R{constructor(s){de(this,u);de(this,h,null);de(this,m,new Map);de(this,L,null);de(this,C,null);if(this.name=null,this.creator=null,s!==null){this.name=s.name,this.creator=s.creator,pe(this,C,s.order);for(const e of s.groups)E(this,m).set(e.id,new B(e.name,e.intent));if(s.baseState==="OFF")for(const e of E(this,m).values())e._setVisible(ne,!1);for(const e of s.on)E(this,m).get(e)._setVisible(ne,!0);for(const e of s.off)E(this,m).get(e)._setVisible(ne,!1);pe(this,L,this.getHash())}}isVisible(s){if(E(this,m).size===0)return!0;if(!s)return(0,x.warn)("Optional content group not defined."),!0;if(s.type==="OCG")return E(this,m).has(s.id)?E(this,m).get(s.id).visible:((0,x.warn)(`Optional content group not found: ${s.id}`),!0);if(s.type==="OCMD"){if(s.expression)return te(this,u,_t).call(this,s.expression);if(!s.policy||s.policy==="AnyOn"){for(const e of s.ids){if(!E(this,m).has(e))return(0,x.warn)(`Optional content group not found: ${e}`),!0;if(E(this,m).get(e).visible)return!0}return!1}else if(s.policy==="AllOn"){for(const e of s.ids){if(!E(this,m).has(e))return(0,x.warn)(`Optional content group not found: ${e}`),!0;if(!E(this,m).get(e).visible)return!1}return!0}else if(s.policy==="AnyOff"){for(const e of s.ids){if(!E(this,m).has(e))return(0,x.warn)(`Optional content group not found: ${e}`),!0;if(!E(this,m).get(e).visible)return!0}return!1}else if(s.policy==="AllOff"){for(const e of s.ids){if(!E(this,m).has(e))return(0,x.warn)(`Optional content group not found: ${e}`),!0;if(E(this,m).get(e).visible)return!1}return!0}return(0,x.warn)(`Unknown optional content policy ${s.policy}.`),!0}return(0,x.warn)(`Unknown group type ${s.type}.`),!0}setVisibility(s,e=!0){if(!E(this,m).has(s)){(0,x.warn)(`Optional content group not found: ${s}`);return}E(this,m).get(s)._setVisible(ne,!!e),pe(this,h,null)}get hasInitialVisibility(){return this.getHash()===E(this,L)}getOrder(){return E(this,m).size?E(this,C)?E(this,C).slice():[...E(this,m).keys()]:null}getGroups(){return E(this,m).size>0?(0,x.objectFromMap)(E(this,m)):null}getGroup(s){return E(this,m).get(s)||null}getHash(){if(E(this,h)!==null)return E(this,h);const s=new V.MurmurHash3_64;for(const[e,r]of E(this,m))s.update(`${e}:${r.visible}`);return pe(this,h,s.hexdigest())}}h=new WeakMap,m=new WeakMap,L=new WeakMap,C=new WeakMap,u=new WeakSet,_t=function(s){const e=s.length;if(e<2)return!0;const r=s[0];for(let c=1;c<e;c++){const o=s[c];let t;if(Array.isArray(o))t=te(this,u,_t).call(this,o);else if(E(this,m).has(o))t=E(this,m).get(o).visible;else return(0,x.warn)(`Optional content group not found: ${o}`),!0;switch(r){case"And":if(!t)return!1;break;case"Or":if(t)return!0;break;case"Not":return!t;default:return!0}}return r==="And"},P.OptionalContentConfig=R},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.PDFDataTransportStream=void 0;var x=Z(1),V=Z(6);class ne{constructor({length:h,initialData:m,progressiveDone:L=!1,contentDispositionFilename:C=null,disableRange:u=!1,disableStream:l=!1},d){if((0,x.assert)(d,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=L,this._contentDispositionFilename=C,(m==null?void 0:m.length)>0){const s=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;this._queuedChunks.push(s)}this._pdfDataRangeTransport=d,this._isStreamingSupported=!l,this._isRangeSupported=!u,this._contentLength=h,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((s,e)=>{this._onReceiveData({begin:s,chunk:e})}),this._pdfDataRangeTransport.addProgressListener((s,e)=>{this._onProgress({loaded:s,total:e})}),this._pdfDataRangeTransport.addProgressiveReadListener(s=>{this._onReceiveData({chunk:s})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:h,chunk:m}){const L=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;if(h===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(L):this._queuedChunks.push(L);else{const C=this._rangeReaders.some(function(u){return u._begin!==h?!1:(u._enqueue(L),!0)});(0,x.assert)(C,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var h;return((h=this._fullRequestReader)==null?void 0:h._loaded)??0}_onProgress(h){var m,L,C,u;h.total===void 0?(L=(m=this._rangeReaders[0])==null?void 0:m.onProgress)==null||L.call(m,{loaded:h.loaded}):(u=(C=this._fullRequestReader)==null?void 0:C.onProgress)==null||u.call(C,{loaded:h.loaded,total:h.total})}_onProgressiveDone(){var h;(h=this._fullRequestReader)==null||h.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(h){const m=this._rangeReaders.indexOf(h);m>=0&&this._rangeReaders.splice(m,1)}getFullReader(){(0,x.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const h=this._queuedChunks;return this._queuedChunks=null,new B(this,h,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(h,m){if(m<=this._progressiveDataLength)return null;const L=new R(this,h,m);return this._pdfDataRangeTransport.requestDataRange(h,m),this._rangeReaders.push(L),L}cancelAllRequests(h){var m;(m=this._fullRequestReader)==null||m.cancel(h);for(const L of this._rangeReaders.slice(0))L.cancel(h);this._pdfDataRangeTransport.abort()}}P.PDFDataTransportStream=ne;class B{constructor(h,m,L=!1,C=null){this._stream=h,this._done=L||!1,this._filename=(0,V.isPdfFile)(C)?C:null,this._queuedChunks=m||[],this._loaded=0;for(const u of this._queuedChunks)this._loaded+=u.byteLength;this._requests=[],this._headersReady=Promise.resolve(),h._fullRequestReader=this,this.onProgress=null}_enqueue(h){this._done||(this._requests.length>0?this._requests.shift().resolve({value:h,done:!1}):this._queuedChunks.push(h),this._loaded+=h.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const h=(0,x.createPromiseCapability)();return this._requests.push(h),h.promise}cancel(h){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class R{constructor(h,m,L){this._stream=h,this._begin=m,this._end=L,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(h){if(!this._done){if(this._requests.length===0)this._queuedChunk=h;else{this._requests.shift().resolve({value:h,done:!1});for(const L of this._requests)L.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const h=(0,x.createPromiseCapability)();return this._requests.push(h),h.promise}cancel(h){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(me,P)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.XfaText=void 0;class Z{static textContent(V){const ne=[],B={items:ne,styles:Object.create(null)};function R(N){var L;if(!N)return;let h=null;const m=N.name;if(m==="#text")h=N.value;else if(Z.shouldBuildText(m))(L=N==null?void 0:N.attributes)!=null&&L.textContent?h=N.attributes.textContent:N.value&&(h=N.value);else return;if(h!==null&&ne.push({str:h}),!!N.children)for(const C of N.children)R(C)}return R(V),B}static shouldBuildText(V){return!(V==="textarea"||V==="input"||V==="option"||V==="select")}}P.XfaText=Z},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.NodeStandardFontDataFactory=P.NodeCanvasFactory=P.NodeCMapReaderFactory=void 0;var x=Z(7);const V=function(N){return new Promise((h,m)=>{require$$5.readFile(N,(C,u)=>{if(C||!u){m(new Error(C));return}h(new Uint8Array(u))})})};class ne extends x.BaseCanvasFactory{_createCanvas(h,m){return require$$5.createCanvas(h,m)}}P.NodeCanvasFactory=ne;class B extends x.BaseCMapReaderFactory{_fetchData(h,m){return V(h).then(L=>({cMapData:L,compressionType:m}))}}P.NodeCMapReaderFactory=B;class R extends x.BaseStandardFontDataFactory{_fetchData(h){return V(h)}}P.NodeStandardFontDataFactory=R},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.PDFNodeStream=void 0;var x=Z(1),V=Z(22);const ne=require$$5,B=require$$5,R=require$$5,N=require$$5,h=/^file:\/\/\/[a-zA-Z]:\//;function m(c){const o=N.parse(c);return o.protocol==="file:"||o.host?o:/^[a-z]:[/\\]/i.test(c)?N.parse(`file:///${c}`):(o.host||(o.protocol="file:"),o)}class L{constructor(o){this.source=o,this.url=m(o.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&o.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var o;return((o=this._fullRequestReader)==null?void 0:o._loaded)??0}getFullReader(){return(0,x.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new e(this):new d(this),this._fullRequestReader}getRangeReader(o,t){if(t<=this._progressiveDataLength)return null;const n=this.isFsUrl?new r(this,o,t):new s(this,o,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(o){var t;(t=this._fullRequestReader)==null||t.cancel(o);for(const n of this._rangeRequestReaders.slice(0))n.cancel(o)}}P.PDFNodeStream=L;class C{constructor(o){this._url=o.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=o.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=(0,x.createPromiseCapability)(),this._headersCapability=(0,x.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const o=this._readableStream.read();return o===null?(this._readCapability=(0,x.createPromiseCapability)(),this.read()):(this._loaded+=o.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(o).buffer,done:!1})}cancel(o){if(!this._readableStream){this._error(o);return}this._readableStream.destroy(o)}_error(o){this._storedError=o,this._readCapability.resolve()}_setReadableStream(o){this._readableStream=o,o.on("readable",()=>{this._readCapability.resolve()}),o.on("end",()=>{o.destroy(),this._done=!0,this._readCapability.resolve()}),o.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new x.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class u{constructor(o){this._url=o.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,x.createPromiseCapability)();const t=o.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const o=this._readableStream.read();return o===null?(this._readCapability=(0,x.createPromiseCapability)(),this.read()):(this._loaded+=o.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(o).buffer,done:!1})}cancel(o){if(!this._readableStream){this._error(o);return}this._readableStream.destroy(o)}_error(o){this._storedError=o,this._readCapability.resolve()}_setReadableStream(o){this._readableStream=o,o.on("readable",()=>{this._readCapability.resolve()}),o.on("end",()=>{o.destroy(),this._done=!0,this._readCapability.resolve()}),o.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function l(c,o){return{protocol:c.protocol,auth:c.auth,host:c.hostname,port:c.port,path:c.path,method:"GET",headers:o}}class d extends C{constructor(o){super(o);const t=n=>{if(n.statusCode===404){const O=new x.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=O,this._headersCapability.reject(O);return}this._headersCapability.resolve(),this._setReadableStream(n);const f=O=>this._readableStream.headers[O.toLowerCase()],{allowRangeRequests:a,suggestedLength:T}=(0,V.validateRangeRequestCapabilities)({getResponseHeader:f,isHttp:o.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=T||this._contentLength,this._filename=(0,V.extractFilenameFromHeader)(f)};this._request=null,this._url.protocol==="http:"?this._request=B.request(l(this._url,o.httpHeaders),t):this._request=R.request(l(this._url,o.httpHeaders),t),this._request.on("error",n=>{this._storedError=n,this._headersCapability.reject(n)}),this._request.end()}}class s extends u{constructor(o,t,n){super(o),this._httpHeaders={};for(const a in o.httpHeaders){const T=o.httpHeaders[a];T!==void 0&&(this._httpHeaders[a]=T)}this._httpHeaders.Range=`bytes=${t}-${n-1}`;const f=a=>{if(a.statusCode===404){const T=new x.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=T;return}this._setReadableStream(a)};this._request=null,this._url.protocol==="http:"?this._request=B.request(l(this._url,this._httpHeaders),f):this._request=R.request(l(this._url,this._httpHeaders),f),this._request.on("error",a=>{this._storedError=a}),this._request.end()}}class e extends C{constructor(o){super(o);let t=decodeURIComponent(this._url.path);h.test(this._url.href)&&(t=t.replace(/^\//,"")),ne.lstat(t,(n,f)=>{if(n){n.code==="ENOENT"&&(n=new x.MissingPDFException(`Missing PDF "${t}".`)),this._storedError=n,this._headersCapability.reject(n);return}this._contentLength=f.size,this._setReadableStream(ne.createReadStream(t)),this._headersCapability.resolve()})}}class r extends u{constructor(o,t,n){super(o);let f=decodeURIComponent(this._url.path);h.test(this._url.href)&&(f=f.replace(/^\//,"")),this._setReadableStream(ne.createReadStream(f,{start:t,end:n-1}))}}},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.createResponseStatusError=N,P.extractFilenameFromHeader=R,P.validateRangeRequestCapabilities=B,P.validateResponseStatus=h;var x=Z(1),V=Z(23),ne=Z(6);function B({getResponseHeader:m,isHttp:L,rangeChunkSize:C,disableRange:u}){const l={allowRangeRequests:!1,suggestedLength:void 0},d=parseInt(m("Content-Length"),10);return!Number.isInteger(d)||(l.suggestedLength=d,d<=2*C)||u||!L||m("Accept-Ranges")!=="bytes"||(m("Content-Encoding")||"identity")!=="identity"||(l.allowRangeRequests=!0),l}function R(m){const L=m("Content-Disposition");if(L){let C=(0,V.getFilenameFromContentDispositionHeader)(L);if(C.includes("%"))try{C=decodeURIComponent(C)}catch{}if((0,ne.isPdfFile)(C))return C}return null}function N(m,L){return m===404||m===0&&L.startsWith("file:")?new x.MissingPDFException('Missing PDF "'+L+'".'):new x.UnexpectedResponseException(`Unexpected server response (${m}) while retrieving PDF "${L}".`,m)}function h(m){return m===200||m===206}},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.getFilenameFromContentDispositionHeader=V;var x=Z(1);function V(ne){let B=!0,R=N("filename\\*","i").exec(ne);if(R){R=R[1];let d=C(R);return d=unescape(d),d=u(d),d=l(d),m(d)}if(R=L(ne),R){const d=l(R);return m(d)}if(R=N("filename","i").exec(ne),R){R=R[1];let d=C(R);return d=l(d),m(d)}function N(d,s){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',s)}function h(d,s){if(d){if(!/^[\x00-\xFF]+$/.test(s))return s;try{const e=new TextDecoder(d,{fatal:!0}),r=(0,x.stringToBytes)(s);s=e.decode(r),B=!1}catch{}}return s}function m(d){return B&&/[\x80-\xff]/.test(d)&&(d=h("utf-8",d),B&&(d=h("iso-8859-1",d))),d}function L(d){const s=[];let e;const r=N("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(e=r.exec(d))!==null;){let[,o,t,n]=e;if(o=parseInt(o,10),o in s){if(o===0)break;continue}s[o]=[t,n]}const c=[];for(let o=0;o<s.length&&o in s;++o){let[t,n]=s[o];n=C(n),t&&(n=unescape(n),o===0&&(n=u(n))),c.push(n)}return c.join("")}function C(d){if(d.startsWith('"')){const s=d.slice(1).split('\\"');for(let e=0;e<s.length;++e){const r=s[e].indexOf('"');r!==-1&&(s[e]=s[e].slice(0,r),s.length=e+1),s[e]=s[e].replace(/\\(.)/g,"$1")}d=s.join('"')}return d}function u(d){const s=d.indexOf("'");if(s===-1)return d;const e=d.slice(0,s),c=d.slice(s+1).replace(/^[^']*'/,"");return h(e,c)}function l(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(s,e,r,c){if(r==="q"||r==="Q")return c=c.replace(/_/g," "),c=c.replace(/=([0-9a-fA-F]{2})/g,function(o,t){return String.fromCharCode(parseInt(t,16))}),h(e,c);try{c=atob(c)}catch{}return h(e,c)})}return""}},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.PDFNetworkStream=void 0;var x=Z(1),V=Z(22);const ne=200,B=206;function R(C){const u=C.response;return typeof u!="string"?u:(0,x.stringToBytes)(u).buffer}class N{constructor(u,l={}){this.url=u,this.isHttp=/^https?:/i.test(u),this.httpHeaders=this.isHttp&&l.httpHeaders||Object.create(null),this.withCredentials=l.withCredentials||!1,this.getXhr=l.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(u,l,d){const s={begin:u,end:l};for(const e in d)s[e]=d[e];return this.request(s)}requestFull(u){return this.request(u)}request(u){const l=this.getXhr(),d=this.currXhrId++,s=this.pendingRequests[d]={xhr:l};l.open("GET",this.url),l.withCredentials=this.withCredentials;for(const e in this.httpHeaders){const r=this.httpHeaders[e];r!==void 0&&l.setRequestHeader(e,r)}return this.isHttp&&"begin"in u&&"end"in u?(l.setRequestHeader("Range",`bytes=${u.begin}-${u.end-1}`),s.expectedStatus=B):s.expectedStatus=ne,l.responseType="arraybuffer",u.onError&&(l.onerror=function(e){u.onError(l.status)}),l.onreadystatechange=this.onStateChange.bind(this,d),l.onprogress=this.onProgress.bind(this,d),s.onHeadersReceived=u.onHeadersReceived,s.onDone=u.onDone,s.onError=u.onError,s.onProgress=u.onProgress,l.send(null),d}onProgress(u,l){var s;const d=this.pendingRequests[u];d&&((s=d.onProgress)==null||s.call(d,l))}onStateChange(u,l){var o,t,n;const d=this.pendingRequests[u];if(!d)return;const s=d.xhr;if(s.readyState>=2&&d.onHeadersReceived&&(d.onHeadersReceived(),delete d.onHeadersReceived),s.readyState!==4||!(u in this.pendingRequests))return;if(delete this.pendingRequests[u],s.status===0&&this.isHttp){(o=d.onError)==null||o.call(d,s.status);return}const e=s.status||ne;if(!(e===ne&&d.expectedStatus===B)&&e!==d.expectedStatus){(t=d.onError)==null||t.call(d,s.status);return}const c=R(s);if(e===B){const f=s.getResponseHeader("Content-Range"),a=/bytes (\d+)-(\d+)\/(\d+)/.exec(f);d.onDone({begin:parseInt(a[1],10),chunk:c})}else c?d.onDone({begin:0,chunk:c}):(n=d.onError)==null||n.call(d,s.status)}getRequestXhr(u){return this.pendingRequests[u].xhr}isPendingRequest(u){return u in this.pendingRequests}abortRequest(u){const l=this.pendingRequests[u].xhr;delete this.pendingRequests[u],l.abort()}}class h{constructor(u){this._source=u,this._manager=new N(u.url,{httpHeaders:u.httpHeaders,withCredentials:u.withCredentials}),this._rangeChunkSize=u.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(u){const l=this._rangeRequestReaders.indexOf(u);l>=0&&this._rangeRequestReaders.splice(l,1)}getFullReader(){return(0,x.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new m(this._manager,this._source),this._fullRequestReader}getRangeReader(u,l){const d=new L(this._manager,u,l);return d.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(d),d}cancelAllRequests(u){var l;(l=this._fullRequestReader)==null||l.cancel(u);for(const d of this._rangeRequestReaders.slice(0))d.cancel(u)}}P.PDFNetworkStream=h;class m{constructor(u,l){this._manager=u;const d={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=l.url,this._fullRequestId=u.requestFull(d),this._headersReceivedCapability=(0,x.createPromiseCapability)(),this._disableRange=l.disableRange||!1,this._contentLength=l.length,this._rangeChunkSize=l.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const u=this._fullRequestId,l=this._manager.getRequestXhr(u),d=r=>l.getResponseHeader(r),{allowRangeRequests:s,suggestedLength:e}=(0,V.validateRangeRequestCapabilities)({getResponseHeader:d,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=e||this._contentLength,this._filename=(0,V.extractFilenameFromHeader)(d),this._isRangeSupported&&this._manager.abortRequest(u),this._headersReceivedCapability.resolve()}_onDone(u){if(u&&(this._requests.length>0?this._requests.shift().resolve({value:u.chunk,done:!1}):this._cachedChunks.push(u.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(u){this._storedError=(0,V.createResponseStatusError)(u,this._url),this._headersReceivedCapability.reject(this._storedError);for(const l of this._requests)l.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(u){var l;(l=this.onProgress)==null||l.call(this,{loaded:u.loaded,total:u.lengthComputable?u.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const u=(0,x.createPromiseCapability)();return this._requests.push(u),u.promise}cancel(u){this._done=!0,this._headersReceivedCapability.reject(u);for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class L{constructor(u,l,d){this._manager=u;const s={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=u.url,this._requestId=u.requestRange(l,d,s),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var u;(u=this.onClosed)==null||u.call(this,this)}_onDone(u){const l=u.chunk;this._requests.length>0?this._requests.shift().resolve({value:l,done:!1}):this._queuedChunk=l,this._done=!0;for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(u){this._storedError=(0,V.createResponseStatusError)(u,this._url);for(const l of this._requests)l.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(u){var l;this.isStreamingSupported||(l=this.onProgress)==null||l.call(this,{loaded:u.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const l=this._queuedChunk;return this._queuedChunk=null,{value:l,done:!1}}if(this._done)return{value:void 0,done:!0};const u=(0,x.createPromiseCapability)();return this._requests.push(u),u.promise}cancel(u){this._done=!0;for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.PDFFetchStream=void 0;var x=Z(1),V=Z(22);function ne(L,C,u){return{method:"GET",headers:L,signal:u.signal,mode:"cors",credentials:C?"include":"same-origin",redirect:"follow"}}function B(L){const C=new Headers;for(const u in L){const l=L[u];l!==void 0&&C.append(u,l)}return C}function R(L){return L instanceof Uint8Array?L.buffer:L instanceof ArrayBuffer?L:((0,x.warn)(`getArrayBuffer - unexpected data format: ${L}`),new Uint8Array(L).buffer)}class N{constructor(C){this.source=C,this.isHttp=/^https?:/i.test(C.url),this.httpHeaders=this.isHttp&&C.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var C;return((C=this._fullRequestReader)==null?void 0:C._loaded)??0}getFullReader(){return(0,x.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new h(this),this._fullRequestReader}getRangeReader(C,u){if(u<=this._progressiveDataLength)return null;const l=new m(this,C,u);return this._rangeRequestReaders.push(l),l}cancelAllRequests(C){var u;(u=this._fullRequestReader)==null||u.cancel(C);for(const l of this._rangeRequestReaders.slice(0))l.cancel(C)}}P.PDFFetchStream=N;class h{constructor(C){this._stream=C,this._reader=null,this._loaded=0,this._filename=null;const u=C.source;this._withCredentials=u.withCredentials||!1,this._contentLength=u.length,this._headersCapability=(0,x.createPromiseCapability)(),this._disableRange=u.disableRange||!1,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!u.disableStream,this._isRangeSupported=!u.disableRange,this._headers=B(this._stream.httpHeaders);const l=u.url;fetch(l,ne(this._headers,this._withCredentials,this._abortController)).then(d=>{if(!(0,V.validateResponseStatus)(d.status))throw(0,V.createResponseStatusError)(d.status,l);this._reader=d.body.getReader(),this._headersCapability.resolve();const s=c=>d.headers.get(c),{allowRangeRequests:e,suggestedLength:r}=(0,V.validateRangeRequestCapabilities)({getResponseHeader:s,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=e,this._contentLength=r||this._contentLength,this._filename=(0,V.extractFilenameFromHeader)(s),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new x.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var l;await this._headersCapability.promise;const{value:C,done:u}=await this._reader.read();return u?{value:C,done:u}:(this._loaded+=C.byteLength,(l=this.onProgress)==null||l.call(this,{loaded:this._loaded,total:this._contentLength}),{value:R(C),done:!1})}cancel(C){var u;(u=this._reader)==null||u.cancel(C),this._abortController.abort()}}class m{constructor(C,u,l){this._stream=C,this._reader=null,this._loaded=0;const d=C.source;this._withCredentials=d.withCredentials||!1,this._readCapability=(0,x.createPromiseCapability)(),this._isStreamingSupported=!d.disableStream,this._abortController=new AbortController,this._headers=B(this._stream.httpHeaders),this._headers.append("Range",`bytes=${u}-${l-1}`);const s=d.url;fetch(s,ne(this._headers,this._withCredentials,this._abortController)).then(e=>{if(!(0,V.validateResponseStatus)(e.status))throw(0,V.createResponseStatusError)(e.status,s);this._readCapability.resolve(),this._reader=e.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var l;await this._readCapability.promise;const{value:C,done:u}=await this._reader.read();return u?{value:C,done:u}:(this._loaded+=C.byteLength,(l=this.onProgress)==null||l.call(this,{loaded:this._loaded}),{value:R(C),done:!1})}cancel(C){var u;(u=this._reader)==null||u.cancel(C),this._abortController.abort()}}},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.TextLayerRenderTask=void 0,P.renderTextLayer=d,P.updateTextLayer=s;var x=Z(1),V=Z(6);const ne=1e5,B=30,R=.8,N=new Map;function h(e,r){let c;if(r&&x.FeatureTest.isOffscreenCanvasSupported)c=new OffscreenCanvas(e,e).getContext("2d",{alpha:!1});else{const o=document.createElement("canvas");o.width=o.height=e,c=o.getContext("2d",{alpha:!1})}return c}function m(e,r){const c=N.get(e);if(c)return c;const o=h(B,r);o.font=`${B}px ${e}`;const t=o.measureText("");let n=t.fontBoundingBoxAscent,f=Math.abs(t.fontBoundingBoxDescent);if(n){const T=n/(n+f);return N.set(e,T),o.canvas.width=o.canvas.height=0,T}o.strokeStyle="red",o.clearRect(0,0,B,B),o.strokeText("g",0,0);let a=o.getImageData(0,0,B,B).data;f=0;for(let T=a.length-1-3;T>=0;T-=4)if(a[T]>0){f=Math.ceil(T/4/B);break}o.clearRect(0,0,B,B),o.strokeText("A",0,B),a=o.getImageData(0,0,B,B).data,n=0;for(let T=0,O=a.length;T<O;T+=4)if(a[T]>0){n=B-Math.floor(T/4/B);break}if(o.canvas.width=o.canvas.height=0,n){const T=n/(n+f);return N.set(e,T),T}return N.set(e,R),R}function L(e,r,c){const o=document.createElement("span"),t={angle:0,canvasWidth:0,hasText:r.str!=="",hasEOL:r.hasEOL,fontSize:0};e._textDivs.push(o);const n=x.Util.transform(e._transform,r.transform);let f=Math.atan2(n[1],n[0]);const a=c[r.fontName];a.vertical&&(f+=Math.PI/2);const T=Math.hypot(n[2],n[3]),O=T*m(a.fontFamily,e._isOffscreenCanvasSupported);let X,Y;f===0?(X=n[4],Y=n[5]-O):(X=n[4]+O*Math.sin(f),Y=n[5]-O*Math.cos(f));const _e="calc(var(--scale-factor)*",ue=o.style;e._container===e._rootContainer?(ue.left=`${(100*X/e._pageWidth).toFixed(2)}%`,ue.top=`${(100*Y/e._pageHeight).toFixed(2)}%`):(ue.left=`${_e}${X.toFixed(2)}px)`,ue.top=`${_e}${Y.toFixed(2)}px)`),ue.fontSize=`${_e}${T.toFixed(2)}px)`,ue.fontFamily=a.fontFamily,t.fontSize=T,o.setAttribute("role","presentation"),o.textContent=r.str,o.dir=r.dir,e._fontInspectorEnabled&&(o.dataset.fontName=r.fontName),f!==0&&(t.angle=f*(180/Math.PI));let J=!1;if(r.str.length>1)J=!0;else if(r.str!==" "&&r.transform[0]!==r.transform[3]){const K=Math.abs(r.transform[0]),$=Math.abs(r.transform[3]);K!==$&&Math.max(K,$)/Math.min(K,$)>1.5&&(J=!0)}J&&(t.canvasWidth=a.vertical?r.height:r.width),e._textDivProperties.set(o,t),e._isReadableStream&&e._layoutText(o)}function C(e){const{div:r,scale:c,properties:o,ctx:t,prevFontSize:n,prevFontFamily:f}=e,{style:a}=r;let T="";if(o.canvasWidth!==0&&o.hasText){const{fontFamily:O}=a,{canvasWidth:X,fontSize:Y}=o;(n!==Y||f!==O)&&(t.font=`${Y*c}px ${O}`,e.prevFontSize=Y,e.prevFontFamily=O);const{width:_e}=t.measureText(r.textContent);_e>0&&(T=`scaleX(${X*c/_e})`)}o.angle!==0&&(T=`rotate(${o.angle}deg) ${T}`),T.length>0&&(a.transform=T)}function u(e){if(e._canceled)return;const r=e._textDivs,c=e._capability;if(r.length>ne){c.resolve();return}if(!e._isReadableStream)for(const t of r)e._layoutText(t);c.resolve()}class l{constructor({textContentSource:r,container:c,viewport:o,textDivs:t,textDivProperties:n,textContentItemsStr:f,isOffscreenCanvasSupported:a}){var _e;this._textContentSource=r,this._isReadableStream=r instanceof ReadableStream,this._container=this._rootContainer=c,this._textDivs=t||[],this._textContentItemsStr=f||[],this._fontInspectorEnabled=!!((_e=globalThis.FontInspector)!=null&&_e.enabled),this._reader=null,this._textDivProperties=n||new WeakMap,this._canceled=!1,this._capability=(0,x.createPromiseCapability)(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:o.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:h(0,a)};const{pageWidth:T,pageHeight:O,pageX:X,pageY:Y}=o.rawDims;this._transform=[1,0,0,-1,-X,Y+O],this._pageWidth=T,this._pageHeight=O,(0,V.setLayerDimensions)(c,o),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new x.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new x.AbortException("TextLayer task cancelled."))}_processItems(r,c){for(const o of r){if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const t=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),o.id!==null&&this._container.setAttribute("id",`${o.id}`),t.append(this._container)}else o.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(o.str),L(this,o,c)}}_layoutText(r){const c=this._layoutTextParams.properties=this._textDivProperties.get(r);if(this._layoutTextParams.div=r,C(this._layoutTextParams),c.hasText&&this._container.append(r),c.hasEOL){const o=document.createElement("br");o.setAttribute("role","presentation"),this._container.append(o)}}_render(){const r=(0,x.createPromiseCapability)();let c=Object.create(null);if(this._isReadableStream){const o=()=>{this._reader.read().then(({value:t,done:n})=>{if(n){r.resolve();return}Object.assign(c,t.styles),this._processItems(t.items,c),o()},r.reject)};this._reader=this._textContentSource.getReader(),o()}else if(this._textContentSource){const{items:o,styles:t}=this._textContentSource;this._processItems(o,t),r.resolve()}else throw new Error('No "textContentSource" parameter specified.');r.promise.then(()=>{c=null,u(this)},this._capability.reject)}}P.TextLayerRenderTask=l;function d(e){!e.textContentSource&&(e.textContent||e.textContentStream)&&((0,V.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),e.textContentSource=e.textContent||e.textContentStream);const r=new l(e);return r._render(),r}function s({container:e,viewport:r,textDivs:c,textDivProperties:o,isOffscreenCanvasSupported:t,mustRotate:n=!0,mustRescale:f=!0}){if(n&&(0,V.setLayerDimensions)(e,{rotation:r.rotation}),f){const a=h(0,t),O={prevFontSize:null,prevFontFamily:null,div:null,scale:r.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:a};for(const X of c)O.properties=o.get(X),O.div=X,C(O)}}},(me,P,Z)=>{var h,m,L,C,u,l,d,s,e,bt,ii,yt,ni;Object.defineProperty(P,"__esModule",{value:!0}),P.AnnotationEditorLayer=void 0;var x=Z(1),V=Z(5),ne=Z(28),B=Z(29),R=Z(6);const n=class n{constructor(a){de(this,e);de(this,h);de(this,m,!1);de(this,L,this.pointerup.bind(this));de(this,C,this.pointerdown.bind(this));de(this,u,new Map);de(this,l,!1);de(this,d,!1);de(this,s);n._initialized||(n._initialized=!0,ne.FreeTextEditor.initialize(a.l10n),B.InkEditor.initialize(a.l10n)),a.uiManager.registerEditorTypes([ne.FreeTextEditor,B.InkEditor]),pe(this,s,a.uiManager),this.pageIndex=a.pageIndex,this.div=a.div,pe(this,h,a.accessibilityManager),E(this,s).addLayer(this)}updateToolbar(a){E(this,s).updateToolbar(a)}updateMode(a=E(this,s).getMode()){te(this,e,ni).call(this),a===x.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),E(this,s).unselectAll(),this.div.classList.toggle("freeTextEditing",a===x.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",a===x.AnnotationEditorType.INK)}addInkEditorIfNeeded(a){if(!a&&E(this,s).getMode()!==x.AnnotationEditorType.INK)return;if(!a){for(const O of E(this,u).values())if(O.isEmpty()){O.setInBackground();return}}te(this,e,yt).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(a){E(this,s).setEditingState(a)}addCommands(a){E(this,s).addCommands(a)}enable(){this.div.style.pointerEvents="auto";for(const a of E(this,u).values())a.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const a of E(this,u).values())a.disableEditing()}setActiveEditor(a){E(this,s).getActive()!==a&&E(this,s).setActiveEditor(a)}enableClick(){this.div.addEventListener("pointerdown",E(this,C)),this.div.addEventListener("pointerup",E(this,L))}disableClick(){this.div.removeEventListener("pointerdown",E(this,C)),this.div.removeEventListener("pointerup",E(this,L))}attach(a){E(this,u).set(a.id,a)}detach(a){var T;E(this,u).delete(a.id),(T=E(this,h))==null||T.removePointerInTextLayer(a.contentDiv)}remove(a){E(this,s).removeEditor(a),this.detach(a),a.div.style.display="none",setTimeout(()=>{a.div.style.display="",a.div.remove(),a.isAttachedToDOM=!1,document.activeElement===document.body&&E(this,s).focusMainContainer()},0),E(this,d)||this.addInkEditorIfNeeded(!1)}add(a){if(te(this,e,bt).call(this,a),E(this,s).addEditor(a),this.attach(a),!a.isAttachedToDOM){const T=a.render();this.div.append(T),a.isAttachedToDOM=!0}this.moveEditorInDOM(a),a.onceAdded(),E(this,s).addToAnnotationStorage(a)}moveEditorInDOM(a){var T;(T=E(this,h))==null||T.moveElementInDOM(this.div,a.div,a.contentDiv,!0)}addOrRebuild(a){a.needsToBeRebuilt()?a.rebuild():this.add(a)}addANewEditor(a){const T=()=>{this.addOrRebuild(a)},O=()=>{a.remove()};this.addCommands({cmd:T,undo:O,mustExec:!0})}addUndoableEditor(a){const T=()=>{this.addOrRebuild(a)},O=()=>{a.remove()};this.addCommands({cmd:T,undo:O,mustExec:!1})}getNextId(){return E(this,s).getId()}deserialize(a){switch(a.annotationType){case x.AnnotationEditorType.FREETEXT:return ne.FreeTextEditor.deserialize(a,this,E(this,s));case x.AnnotationEditorType.INK:return B.InkEditor.deserialize(a,this,E(this,s))}return null}setSelected(a){E(this,s).setSelected(a)}toggleSelected(a){E(this,s).toggleSelected(a)}isSelected(a){return E(this,s).isSelected(a)}unselect(a){E(this,s).unselect(a)}pointerup(a){const{isMac:T}=x.FeatureTest.platform;if(!(a.button!==0||a.ctrlKey&&T)&&a.target===this.div&&E(this,l)){if(pe(this,l,!1),!E(this,m)){pe(this,m,!0);return}te(this,e,yt).call(this,a)}}pointerdown(a){const{isMac:T}=x.FeatureTest.platform;if(a.button!==0||a.ctrlKey&&T||a.target!==this.div)return;pe(this,l,!0);const O=E(this,s).getActive();pe(this,m,!O||O.isEmpty())}drop(a){const T=a.dataTransfer.getData("text/plain"),O=E(this,s).getEditor(T);if(!O)return;a.preventDefault(),a.dataTransfer.dropEffect="move",te(this,e,bt).call(this,O);const X=this.div.getBoundingClientRect(),Y=a.clientX-X.x,_e=a.clientY-X.y;O.translate(Y-O.startX,_e-O.startY),this.moveEditorInDOM(O),O.div.focus()}dragover(a){a.preventDefault()}destroy(){var a,T;((a=E(this,s).getActive())==null?void 0:a.parent)===this&&E(this,s).setActiveEditor(null);for(const O of E(this,u).values())(T=E(this,h))==null||T.removePointerInTextLayer(O.contentDiv),O.setParent(null),O.isAttachedToDOM=!1,O.div.remove();this.div=null,E(this,u).clear(),E(this,s).removeLayer(this)}render({viewport:a}){this.viewport=a,(0,R.setLayerDimensions)(this.div,a),(0,V.bindEvents)(this,this.div,["dragover","drop"]);for(const T of E(this,s).getEditors(this.pageIndex))this.add(T);this.updateMode()}update({viewport:a}){E(this,s).commitOrRemove(),this.viewport=a,(0,R.setLayerDimensions)(this.div,{rotation:a.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:a,pageHeight:T}=this.viewport.rawDims;return[a,T]}};h=new WeakMap,m=new WeakMap,L=new WeakMap,C=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,s=new WeakMap,e=new WeakSet,bt=function(a){var T;a.parent!==this&&(this.attach(a),(T=a.parent)==null||T.detach(a),a.setParent(this),a.div&&a.isAttachedToDOM&&(a.div.remove(),this.div.append(a.div)))},ii=function(a){switch(E(this,s).getMode()){case x.AnnotationEditorType.FREETEXT:return new ne.FreeTextEditor(a);case x.AnnotationEditorType.INK:return new B.InkEditor(a)}return null},yt=function(a){const T=this.getNextId(),O=te(this,e,ii).call(this,{parent:this,id:T,x:a.offsetX,y:a.offsetY,uiManager:E(this,s)});return O&&this.add(O),O},ni=function(){pe(this,d,!0);for(const a of E(this,u).values())a.isEmpty()&&a.remove();pe(this,d,!1)},Fe(n,"_initialized",!1);let N=n;P.AnnotationEditorLayer=N},(me,P,Z)=>{var R,N,h,m,L,C,u,l,d,s,si,ri,ai,vt;Object.defineProperty(P,"__esModule",{value:!0}),P.FreeTextEditor=void 0;var x=Z(1),V=Z(5),ne=Z(4);const t=class t extends ne.AnnotationEditor{constructor(a){super({...a,name:"freeTextEditor"});de(this,s);de(this,R,this.editorDivBlur.bind(this));de(this,N,this.editorDivFocus.bind(this));de(this,h,this.editorDivInput.bind(this));de(this,m,this.editorDivKeydown.bind(this));de(this,L);de(this,C,"");de(this,u,`${this.id}-editor`);de(this,l,!1);de(this,d);pe(this,L,a.color||t._defaultColor||ne.AnnotationEditor._defaultLineColor),pe(this,d,a.fontSize||t._defaultFontSize)}static initialize(a){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(O=>[O,a.get(O)]));const T=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(T.getPropertyValue("--freetext-padding"))}static updateDefaultParams(a,T){switch(a){case x.AnnotationEditorParamsType.FREETEXT_SIZE:t._defaultFontSize=T;break;case x.AnnotationEditorParamsType.FREETEXT_COLOR:t._defaultColor=T;break}}updateParams(a,T){switch(a){case x.AnnotationEditorParamsType.FREETEXT_SIZE:te(this,s,si).call(this,T);break;case x.AnnotationEditorParamsType.FREETEXT_COLOR:te(this,s,ri).call(this,T);break}}static get defaultPropertiesToUpdate(){return[[x.AnnotationEditorParamsType.FREETEXT_SIZE,t._defaultFontSize],[x.AnnotationEditorParamsType.FREETEXT_COLOR,t._defaultColor||ne.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[x.AnnotationEditorParamsType.FREETEXT_SIZE,E(this,d)],[x.AnnotationEditorParamsType.FREETEXT_COLOR,E(this,L)]]}getInitialTranslation(){const a=this.parentScale;return[-t._internalPadding*a,-(t._internalPadding+E(this,d))*a]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(x.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",E(this,m)),this.editorDiv.addEventListener("focus",E(this,N)),this.editorDiv.addEventListener("blur",E(this,R)),this.editorDiv.addEventListener("input",E(this,h)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",E(this,u)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",E(this,m)),this.editorDiv.removeEventListener("focus",E(this,N)),this.editorDiv.removeEventListener("blur",E(this,R)),this.editorDiv.removeEventListener("input",E(this,h)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(a){super.focusin(a),a.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){this.isInEditMode()&&(super.commit(),E(this,l)||(pe(this,l,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),pe(this,C,te(this,s,ai).call(this).trimEnd()),te(this,s,vt).call(this))}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(a){this.enableEditMode(),this.editorDiv.focus()}keydown(a){a.target===this.div&&a.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(a){t._keyboardManager.exec(this,a)}editorDivFocus(a){this.isEditing=!0}editorDivBlur(a){this.isEditing=!1}editorDivInput(a){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let a,T;this.width&&(a=this.x,T=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",E(this,u)),this.enableEditing(),t._l10nPromise.get("editor_free_text2_aria_label").then(X=>{var Y;return(Y=this.editorDiv)==null?void 0:Y.setAttribute("aria-label",X)}),t._l10nPromise.get("free_text2_default_content").then(X=>{var Y;return(Y=this.editorDiv)==null?void 0:Y.setAttribute("default-content",X)}),this.editorDiv.contentEditable=!0;const{style:O}=this.editorDiv;if(O.fontSize=`calc(${E(this,d)}px * var(--scale-factor))`,O.color=E(this,L),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,V.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[X,Y]=this.parentDimensions;this.setAt(a*X,T*Y,this.width*X,this.height*Y);for(const _e of E(this,C).split(`
`)){const ue=document.createElement("div");ue.append(_e?document.createTextNode(_e):document.createElement("br")),this.editorDiv.append(ue)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(a,T,O){const X=super.deserialize(a,T,O);return pe(X,d,a.fontSize),pe(X,L,x.Util.makeHexColor(...a.color)),pe(X,C,a.value),X}serialize(){if(this.isEmpty())return null;const a=t._internalPadding*this.parentScale,T=this.getRect(a,a),O=ne.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:E(this,L));return{annotationType:x.AnnotationEditorType.FREETEXT,color:O,fontSize:E(this,d),value:E(this,C),pageIndex:this.pageIndex,rect:T,rotation:this.rotation}}};R=new WeakMap,N=new WeakMap,h=new WeakMap,m=new WeakMap,L=new WeakMap,C=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,s=new WeakSet,si=function(a){const T=X=>{this.editorDiv.style.fontSize=`calc(${X}px * var(--scale-factor))`,this.translate(0,-(X-E(this,d))*this.parentScale),pe(this,d,X),te(this,s,vt).call(this)},O=E(this,d);this.addCommands({cmd:()=>{T(a)},undo:()=>{T(O)},mustExec:!0,type:x.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},ri=function(a){const T=E(this,L);this.addCommands({cmd:()=>{pe(this,L,this.editorDiv.style.color=a)},undo:()=>{pe(this,L,this.editorDiv.style.color=T)},mustExec:!0,type:x.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},ai=function(){const a=this.editorDiv.getElementsByTagName("div");if(a.length===0)return this.editorDiv.innerText;const T=[];for(const O of a)T.push(O.innerText.replace(/\r\n?|\n/,""));return T.join(`
`)},vt=function(){const[a,T]=this.parentDimensions;let O;if(this.isAttachedToDOM)O=this.div.getBoundingClientRect();else{const{currentLayer:X,div:Y}=this,_e=Y.style.display;Y.style.display="hidden",X.div.append(this.div),O=Y.getBoundingClientRect(),Y.remove(),Y.style.display=_e}this.width=O.width/a,this.height=O.height/T},Fe(t,"_freeTextDefaultContent",""),Fe(t,"_l10nPromise"),Fe(t,"_internalPadding",0),Fe(t,"_defaultColor",null),Fe(t,"_defaultFontSize",10),Fe(t,"_keyboardManager",new V.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.prototype.commitOrRemove]])),Fe(t,"_type","freetext");let B=t;P.FreeTextEditor=B},(me,P,Z)=>{var m,L,C,u,l,d,s,e,r,c,o,t,n,f,a,oi,li,ci,hi,At,di,ui,fi,Be,St,tt,it,Ge,Et,nt,M,Pt,pi,gi,mi,Ct,st,ze,wt;Object.defineProperty(P,"__esModule",{value:!0}),P.InkEditor=void 0,Object.defineProperty(P,"fitCurve",{enumerable:!0,get:function(){return ne.fitCurve}});var x=Z(1),V=Z(4),ne=Z(30),B=Z(5);const R=16,N=100,i=class i extends V.AnnotationEditor{constructor(A){super({...A,name:"inkEditor"});de(this,a);de(this,m,0);de(this,L,0);de(this,C,0);de(this,u,this.canvasPointermove.bind(this));de(this,l,this.canvasPointerleave.bind(this));de(this,d,this.canvasPointerup.bind(this));de(this,s,this.canvasPointerdown.bind(this));de(this,e,!1);de(this,r,!1);de(this,c,null);de(this,o,null);de(this,t,0);de(this,n,0);de(this,f,null);this.color=A.color||null,this.thickness=A.thickness||null,this.opacity=A.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(A){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(I=>[I,A.get(I)]))}static updateDefaultParams(A,I){switch(A){case x.AnnotationEditorParamsType.INK_THICKNESS:i._defaultThickness=I;break;case x.AnnotationEditorParamsType.INK_COLOR:i._defaultColor=I;break;case x.AnnotationEditorParamsType.INK_OPACITY:i._defaultOpacity=I/100;break}}updateParams(A,I){switch(A){case x.AnnotationEditorParamsType.INK_THICKNESS:te(this,a,oi).call(this,I);break;case x.AnnotationEditorParamsType.INK_COLOR:te(this,a,li).call(this,I);break;case x.AnnotationEditorParamsType.INK_OPACITY:te(this,a,ci).call(this,I);break}}static get defaultPropertiesToUpdate(){return[[x.AnnotationEditorParamsType.INK_THICKNESS,i._defaultThickness],[x.AnnotationEditorParamsType.INK_COLOR,i._defaultColor||V.AnnotationEditor._defaultLineColor],[x.AnnotationEditorParamsType.INK_OPACITY,Math.round(i._defaultOpacity*100)]]}get propertiesToUpdate(){return[[x.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||i._defaultThickness],[x.AnnotationEditorParamsType.INK_COLOR,this.color||i._defaultColor||V.AnnotationEditor._defaultLineColor],[x.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??i._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(te(this,a,tt).call(this),te(this,a,it).call(this)),this.isAttachedToDOM||(this.parent.add(this),te(this,a,Ge).call(this)),te(this,a,ze).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,E(this,o).disconnect(),pe(this,o,null),super.remove())}setParent(A){!this.parent&&A?this._uiManager.removeShouldRescale(this):this.parent&&A===null&&this._uiManager.addShouldRescale(this),super.setParent(A)}onScaleChanging(){const[A,I]=this.parentDimensions,j=this.width*A,G=this.height*I;this.setDimensions(j,G)}enableEditMode(){E(this,e)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",E(this,s)),this.canvas.addEventListener("pointerup",E(this,d)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",E(this,s)),this.canvas.removeEventListener("pointerup",E(this,d)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){E(this,e)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),pe(this,e,!0),this.div.classList.add("disabled"),te(this,a,ze).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(A){super.focusin(A),this.enableEditMode()}canvasPointerdown(A){A.button!==0||!this.isInEditMode()||E(this,e)||(this.setInForeground(),A.type!=="mouse"&&this.div.focus(),A.stopPropagation(),this.canvas.addEventListener("pointerleave",E(this,l)),this.canvas.addEventListener("pointermove",E(this,u)),te(this,a,di).call(this,A.offsetX,A.offsetY))}canvasPointermove(A){A.stopPropagation(),te(this,a,ui).call(this,A.offsetX,A.offsetY)}canvasPointerup(A){A.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(A.stopPropagation(),te(this,a,St).call(this,A),this.setInBackground())}canvasPointerleave(A){te(this,a,St).call(this,A),this.setInBackground()}render(){if(this.div)return this.div;let A,I;this.width&&(A=this.x,I=this.y),super.render(),i._l10nPromise.get("editor_ink2_aria_label").then(F=>{var D;return(D=this.div)==null?void 0:D.setAttribute("aria-label",F)});const[j,G,H,S]=te(this,a,hi).call(this);if(this.setAt(j,G,0,0),this.setDims(H,S),te(this,a,tt).call(this),this.width){const[F,D]=this.parentDimensions;this.setAt(A*F,I*D,this.width*F,this.height*D),pe(this,r,!0),te(this,a,Ge).call(this),this.setDims(this.width*F,this.height*D),te(this,a,Be).call(this),te(this,a,wt).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return te(this,a,it).call(this),this.div}setDimensions(A,I){const j=Math.round(A),G=Math.round(I);if(E(this,t)===j&&E(this,n)===G)return;pe(this,t,j),pe(this,n,G),this.canvas.style.visibility="hidden",E(this,m)&&Math.abs(E(this,m)-A/I)>.01&&(I=Math.ceil(A/E(this,m)),this.setDims(A,I));const[H,S]=this.parentDimensions;this.width=A/H,this.height=I/S,E(this,e)&&te(this,a,Et).call(this,A,I),te(this,a,Ge).call(this),te(this,a,Be).call(this),this.canvas.style.visibility="visible"}static deserialize(A,I,j){var ge,be;const G=super.deserialize(A,I,j);G.thickness=A.thickness,G.color=x.Util.makeHexColor(...A.color),G.opacity=A.opacity;const[H,S]=G.pageDimensions,F=G.width*H,D=G.height*S,q=G.parentScale,oe=A.thickness/2;pe(G,m,F/D),pe(G,e,!0),pe(G,t,Math.round(F)),pe(G,n,Math.round(D));for(const{bezier:Ae}of A.paths){const ve=[];G.paths.push(ve);let Pe=q*(Ae[0]-oe),Ee=q*(D-Ae[1]-oe);for(let se=2,ae=Ae.length;se<ae;se+=6){const ye=q*(Ae[se]-oe),Se=q*(D-Ae[se+1]-oe),xe=q*(Ae[se+2]-oe),Ce=q*(D-Ae[se+3]-oe),we=q*(Ae[se+4]-oe),Re=q*(D-Ae[se+5]-oe);ve.push([[Pe,Ee],[ye,Se],[xe,Ce],[we,Re]]),Pe=we,Ee=Re}const ce=te(this,M,Pt).call(this,ve);G.bezierPath2D.push(ce)}const fe=te(ge=G,a,Ct).call(ge);return pe(G,C,Math.max(R,fe[2]-fe[0])),pe(G,L,Math.max(R,fe[3]-fe[1])),te(be=G,a,Et).call(be,F,D),G}serialize(){if(this.isEmpty())return null;const A=this.getRect(0,0),I=this.rotation%180===0?A[3]-A[1]:A[2]-A[0],j=V.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:x.AnnotationEditorType.INK,color:j,thickness:this.thickness,opacity:this.opacity,paths:te(this,a,pi).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,I),pageIndex:this.pageIndex,rect:A,rotation:this.rotation}}};m=new WeakMap,L=new WeakMap,C=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,s=new WeakMap,e=new WeakMap,r=new WeakMap,c=new WeakMap,o=new WeakMap,t=new WeakMap,n=new WeakMap,f=new WeakMap,a=new WeakSet,oi=function(A){const I=this.thickness;this.addCommands({cmd:()=>{this.thickness=A,te(this,a,ze).call(this)},undo:()=>{this.thickness=I,te(this,a,ze).call(this)},mustExec:!0,type:x.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},li=function(A){const I=this.color;this.addCommands({cmd:()=>{this.color=A,te(this,a,Be).call(this)},undo:()=>{this.color=I,te(this,a,Be).call(this)},mustExec:!0,type:x.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},ci=function(A){A/=100;const I=this.opacity;this.addCommands({cmd:()=>{this.opacity=A,te(this,a,Be).call(this)},undo:()=>{this.opacity=I,te(this,a,Be).call(this)},mustExec:!0,type:x.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},hi=function(){const{parentRotation:A,parentDimensions:[I,j]}=this;switch(A){case 90:return[0,j,j,I];case 180:return[I,j,I,j];case 270:return[I,0,j,I];default:return[0,0,I,j]}},At=function(){const{ctx:A,color:I,opacity:j,thickness:G,parentScale:H,scaleFactor:S}=this;A.lineWidth=G*H/S,A.lineCap="round",A.lineJoin="round",A.miterLimit=10,A.strokeStyle=`${I}${(0,B.opacityToHex)(j)}`},di=function(A,I){this.isEditing=!0,E(this,r)||(pe(this,r,!0),te(this,a,Ge).call(this),this.thickness||(this.thickness=i._defaultThickness),this.color||(this.color=i._defaultColor||V.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=i._defaultOpacity)),this.currentPath.push([A,I]),pe(this,c,null),te(this,a,At).call(this),this.ctx.beginPath(),this.ctx.moveTo(A,I),pe(this,f,()=>{E(this,f)&&(E(this,c)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):te(this,a,Be).call(this),this.ctx.lineTo(...E(this,c)),pe(this,c,null),this.ctx.stroke()),window.requestAnimationFrame(E(this,f)))}),window.requestAnimationFrame(E(this,f))},ui=function(A,I){const[j,G]=this.currentPath.at(-1);A===j&&I===G||(this.currentPath.push([A,I]),pe(this,c,[A,I]))},fi=function(A,I){var q;this.ctx.closePath(),pe(this,f,null),A=Math.min(Math.max(A,0),this.canvas.width),I=Math.min(Math.max(I,0),this.canvas.height);const[j,G]=this.currentPath.at(-1);(A!==j||I!==G)&&this.currentPath.push([A,I]);let H;if(this.currentPath.length!==1)H=(0,ne.fitCurve)(this.currentPath,30,null);else{const oe=[A,I];H=[[oe,oe.slice(),oe.slice(),oe]]}const S=te(q=i,M,Pt).call(q,H);this.currentPath.length=0;const F=()=>{this.paths.push(H),this.bezierPath2D.push(S),this.rebuild()},D=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(te(this,a,tt).call(this),te(this,a,it).call(this)),te(this,a,ze).call(this))};this.addCommands({cmd:F,undo:D,mustExec:!0})},Be=function(){if(this.isEmpty()){te(this,a,nt).call(this);return}te(this,a,At).call(this);const{canvas:A,ctx:I}=this;I.setTransform(1,0,0,1,0,0),I.clearRect(0,0,A.width,A.height),te(this,a,nt).call(this);for(const j of this.bezierPath2D)I.stroke(j)},St=function(A){te(this,a,fi).call(this,A.offsetX,A.offsetY),this.canvas.removeEventListener("pointerleave",E(this,l)),this.canvas.removeEventListener("pointermove",E(this,u)),this.addToAnnotationStorage()},tt=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",i._l10nPromise.get("editor_ink_canvas_aria_label").then(A=>{var I;return(I=this.canvas)==null?void 0:I.setAttribute("aria-label",A)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},it=function(){let A=null;pe(this,o,new ResizeObserver(I=>{const j=I[0].contentRect;j.width&&j.height&&(A!==null&&clearTimeout(A),A=setTimeout(()=>{this.fixDims(),A=null},N),this.setDimensions(j.width,j.height))})),E(this,o).observe(this.div)},Ge=function(){if(!E(this,r))return;const[A,I]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*A),this.canvas.height=Math.ceil(this.height*I),te(this,a,nt).call(this)},Et=function(A,I){const j=te(this,a,st).call(this),G=(A-j)/E(this,C),H=(I-j)/E(this,L);this.scaleFactor=Math.min(G,H)},nt=function(){const A=te(this,a,st).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+A,this.translationY*this.scaleFactor+A)},M=new WeakSet,Pt=function(A){const I=new Path2D;for(let j=0,G=A.length;j<G;j++){const[H,S,F,D]=A[j];j===0&&I.moveTo(...H),I.bezierCurveTo(S[0],S[1],F[0],F[1],D[0],D[1])}return I},pi=function(A,I,j,G){const S=[],F=this.thickness/2;let D,q;for(const oe of this.paths){D=[],q=[];for(let fe=0,ge=oe.length;fe<ge;fe++){const[be,Ae,ve,Pe]=oe[fe],Ee=A*(be[0]+I)+F,ce=G-A*(be[1]+j)-F,se=A*(Ae[0]+I)+F,ae=G-A*(Ae[1]+j)-F,ye=A*(ve[0]+I)+F,Se=G-A*(ve[1]+j)-F,xe=A*(Pe[0]+I)+F,Ce=G-A*(Pe[1]+j)-F;fe===0&&(D.push(Ee,ce),q.push(Ee,ce)),D.push(se,ae,ye,Se,xe,Ce),te(this,a,gi).call(this,Ee,ce,se,ae,ye,Se,xe,Ce,4,q)}S.push({bezier:D,points:q})}return S},gi=function(A,I,j,G,H,S,F,D,q,oe){if(te(this,a,mi).call(this,A,I,j,G,H,S,F,D)){oe.push(F,D);return}for(let fe=1;fe<q-1;fe++){const ge=fe/q,be=1-ge;let Ae=ge*A+be*j,ve=ge*I+be*G,Pe=ge*j+be*H,Ee=ge*G+be*S;const ce=ge*H+be*F,se=ge*S+be*D;Ae=ge*Ae+be*Pe,ve=ge*ve+be*Ee,Pe=ge*Pe+be*ce,Ee=ge*Ee+be*se,Ae=ge*Ae+be*Pe,ve=ge*ve+be*Ee,oe.push(Ae,ve)}oe.push(F,D)},mi=function(A,I,j,G,H,S,F,D){const oe=(3*j-2*A-F)**2,fe=(3*G-2*I-D)**2,ge=(3*H-A-2*F)**2,be=(3*S-I-2*D)**2;return Math.max(oe,ge)+Math.max(fe,be)<=10},Ct=function(){let A=1/0,I=-1/0,j=1/0,G=-1/0;for(const H of this.paths)for(const[S,F,D,q]of H){const oe=x.Util.bezierBoundingBox(...S,...F,...D,...q);A=Math.min(A,oe[0]),j=Math.min(j,oe[1]),I=Math.max(I,oe[2]),G=Math.max(G,oe[3])}return[A,j,I,G]},st=function(){return E(this,e)?Math.ceil(this.thickness*this.parentScale):0},ze=function(A=!1){if(this.isEmpty())return;if(!E(this,e)){te(this,a,Be).call(this);return}const I=te(this,a,Ct).call(this),j=te(this,a,st).call(this);pe(this,C,Math.max(R,I[2]-I[0])),pe(this,L,Math.max(R,I[3]-I[1]));const G=Math.ceil(j+E(this,C)*this.scaleFactor),H=Math.ceil(j+E(this,L)*this.scaleFactor),[S,F]=this.parentDimensions;this.width=G/S,this.height=H/F,pe(this,m,G/H),te(this,a,wt).call(this);const D=this.translationX,q=this.translationY;this.translationX=-I[0],this.translationY=-I[1],te(this,a,Ge).call(this),te(this,a,Be).call(this),pe(this,t,G),pe(this,n,H),this.setDims(G,H);const oe=A?j/this.scaleFactor/2:0;this.translate(D-this.translationX-oe,q-this.translationY-oe)},wt=function(){const{style:A}=this.div;E(this,m)>=1?(A.minHeight=`${R}px`,A.minWidth=`${Math.round(E(this,m)*R)}px`):(A.minWidth=`${R}px`,A.minHeight=`${Math.round(R/E(this,m))}px`)},de(i,M),Fe(i,"_defaultColor",null),Fe(i,"_defaultOpacity",1),Fe(i,"_defaultThickness",1),Fe(i,"_l10nPromise"),Fe(i,"_type","ink");let h=i;P.InkEditor=h},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.fitCurve=void 0;const x=Z(31);P.fitCurve=x},me=>{function P(l,d,s){if(!Array.isArray(l))throw new TypeError("First argument should be an array");if(l.forEach(o=>{if(!Array.isArray(o)||o.some(t=>typeof t!="number")||o.length!==l[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),l=l.filter((o,t)=>t===0||!o.every((n,f)=>n===l[t-1][f])),l.length<2)return[];const e=l.length,r=L(l[1],l[0]),c=L(l[e-2],l[e-1]);return Z(l,r,c,d,s)}function Z(l,d,s,e,r){var o,t,n,f,a,T,O,X,Y,_e,ue,J,K;if(l.length===2)return J=C.vectorLen(C.subtract(l[0],l[1]))/3,o=[l[0],C.addArrays(l[0],C.mulItems(d,J)),C.addArrays(l[1],C.mulItems(s,J)),l[1]],[o];if(t=R(l),[o,f,T]=x(l,t,t,d,s,r),f===0||f<e)return[o];if(f<e*e)for(n=t,a=f,O=T,K=0;K<20;K++){if(n=ne(o,l,n),[o,f,T]=x(l,t,n,d,s,r),f<e)return[o];if(T===O){let $=f/a;if($>.9999&&$<1.0001)break}a=f,O=T}return ue=[],X=C.subtract(l[T-1],l[T+1]),X.every($=>$===0)&&(X=C.subtract(l[T-1],l[T]),[X[0],X[1]]=[-X[1],X[0]]),Y=C.normalize(X),_e=C.mulItems(Y,-1),ue=ue.concat(Z(l.slice(0,T+1),d,Y,e,r)),ue=ue.concat(Z(l.slice(T),_e,s,e,r)),ue}function x(l,d,s,e,r,c){var o,t,n;return o=V(l,s,e,r),[t,n]=N(l,o,d),c&&c({bez:o,points:l,params:d,maxErr:t,maxPoint:n}),[o,t,n]}function V(l,d,s,e){var r,c,o,t,n,f,a,T,O,X,Y,_e,ue,J,K,$,k,le=l[0],re=l[l.length-1];for(r=[le,null,null,re],c=C.zeros_Xx2x2(d.length),ue=0,J=d.length;ue<J;ue++)$=d[ue],k=1-$,o=c[ue],o[0]=C.mulItems(s,3*$*(k*k)),o[1]=C.mulItems(e,3*k*($*$));for(t=[[0,0],[0,0]],n=[0,0],ue=0,J=l.length;ue<J;ue++)$=d[ue],o=c[ue],t[0][0]+=C.dot(o[0],o[0]),t[0][1]+=C.dot(o[0],o[1]),t[1][0]+=C.dot(o[0],o[1]),t[1][1]+=C.dot(o[1],o[1]),K=C.subtract(l[ue],u.q([le,le,re,re],$)),n[0]+=C.dot(o[0],K),n[1]+=C.dot(o[1],K);return f=t[0][0]*t[1][1]-t[1][0]*t[0][1],a=t[0][0]*n[1]-t[1][0]*n[0],T=n[0]*t[1][1]-n[1]*t[0][1],O=f===0?0:T/f,X=f===0?0:a/f,_e=C.vectorLen(C.subtract(le,re)),Y=1e-6*_e,O<Y||X<Y?(r[1]=C.addArrays(le,C.mulItems(s,_e/3)),r[2]=C.addArrays(re,C.mulItems(e,_e/3))):(r[1]=C.addArrays(le,C.mulItems(s,O)),r[2]=C.addArrays(re,C.mulItems(e,X))),r}function ne(l,d,s){return s.map((e,r)=>B(l,d[r],e))}function B(l,d,s){var e=C.subtract(u.q(l,s),d),r=u.qprime(l,s),c=C.mulMatrix(e,r),o=C.sum(C.squareItems(r))+2*C.mulMatrix(e,u.qprimeprime(l,s));return o===0?s:s-c/o}function R(l){var d=[],s,e,r;return l.forEach((c,o)=>{s=o?e+C.vectorLen(C.subtract(c,r)):0,d.push(s),e=s,r=c}),d=d.map(c=>c/e),d}function N(l,d,s){var e,r,c,o,t,n,f,a;r=0,c=Math.floor(l.length/2);const T=h(d,10);for(t=0,n=l.length;t<n;t++)f=l[t],a=m(d,s[t],T,10),o=C.subtract(u.q(d,a),f),e=o[0]*o[0]+o[1]*o[1],e>r&&(r=e,c=t);return[r,c]}var h=function(l,d){for(var s,e=[0],r=l[0],c=0,o=1;o<=d;o++)s=u.q(l,o/d),c+=C.vectorLen(C.subtract(s,r)),e.push(c),r=s;return e=e.map(t=>t/c),e};function m(l,d,s,e){if(d<0)return 0;if(d>1)return 1;for(var r,c,o,t,n,f=1;f<=e;f++)if(d<=s[f]){t=(f-1)/e,o=f/e,c=s[f-1],r=s[f],n=(d-c)/(r-c)*(o-t)+t;break}return n}function L(l,d){return C.normalize(C.subtract(l,d))}class C{static zeros_Xx2x2(d){for(var s=[];d--;)s.push([0,0]);return s}static mulItems(d,s){return d.map(e=>e*s)}static mulMatrix(d,s){return d.reduce((e,r,c)=>e+r*s[c],0)}static subtract(d,s){return d.map((e,r)=>e-s[r])}static addArrays(d,s){return d.map((e,r)=>e+s[r])}static addItems(d,s){return d.map(e=>e+s)}static sum(d){return d.reduce((s,e)=>s+e)}static dot(d,s){return C.mulMatrix(d,s)}static vectorLen(d){return Math.hypot(...d)}static divItems(d,s){return d.map(e=>e/s)}static squareItems(d){return d.map(s=>s*s)}static normalize(d){return this.divItems(d,this.vectorLen(d))}}class u{static q(d,s){var e=1-s,r=C.mulItems(d[0],e*e*e),c=C.mulItems(d[1],3*e*e*s),o=C.mulItems(d[2],3*e*s*s),t=C.mulItems(d[3],s*s*s);return C.addArrays(C.addArrays(r,c),C.addArrays(o,t))}static qprime(d,s){var e=1-s,r=C.mulItems(C.subtract(d[1],d[0]),3*e*e),c=C.mulItems(C.subtract(d[2],d[1]),6*e*s),o=C.mulItems(C.subtract(d[3],d[2]),3*s*s);return C.addArrays(C.addArrays(r,c),o)}static qprimeprime(d,s){return C.addArrays(C.mulItems(C.addArrays(C.subtract(d[2],C.mulItems(d[1],2)),d[0]),6*(1-s)),C.mulItems(C.addArrays(C.subtract(d[3],C.mulItems(d[2],2)),d[1]),6*s))}}me.exports=P,me.exports.fitCubic=Z,me.exports.createTangent=L},(me,P,Z)=>{var g,Ue,_i,U,Tt,xt;Object.defineProperty(P,"__esModule",{value:!0}),P.AnnotationLayer=void 0;var x=Z(1),V=Z(6),ne=Z(3),B=Z(33),R=Z(34);const N=1e3,h=9,m=new WeakSet;function L(ie){return{width:ie[2]-ie[0],height:ie[3]-ie[1]}}class C{static create(v){switch(v.data.annotationType){case x.AnnotationType.LINK:return new l(v);case x.AnnotationType.TEXT:return new d(v);case x.AnnotationType.WIDGET:switch(v.data.fieldType){case"Tx":return new e(v);case"Btn":return v.data.radioButton?new c(v):v.data.checkBox?new r(v):new o(v);case"Ch":return new t(v)}return new s(v);case x.AnnotationType.POPUP:return new n(v);case x.AnnotationType.FREETEXT:return new a(v);case x.AnnotationType.LINE:return new T(v);case x.AnnotationType.SQUARE:return new O(v);case x.AnnotationType.CIRCLE:return new X(v);case x.AnnotationType.POLYLINE:return new Y(v);case x.AnnotationType.CARET:return new ue(v);case x.AnnotationType.INK:return new J(v);case x.AnnotationType.POLYGON:return new _e(v);case x.AnnotationType.HIGHLIGHT:return new K(v);case x.AnnotationType.UNDERLINE:return new $(v);case x.AnnotationType.SQUIGGLY:return new k(v);case x.AnnotationType.STRIKEOUT:return new le(v);case x.AnnotationType.STAMP:return new re(v);case x.AnnotationType.FILEATTACHMENT:return new y(v);default:return new u(v)}}}class u{constructor(v,{isRenderable:i=!1,ignoreBorder:b=!1,createQuadrilaterals:w=!1}={}){this.isRenderable=i,this.data=v.data,this.layer=v.layer,this.page=v.page,this.viewport=v.viewport,this.linkService=v.linkService,this.downloadManager=v.downloadManager,this.imageResourcesPath=v.imageResourcesPath,this.renderForms=v.renderForms,this.svgFactory=v.svgFactory,this.annotationStorage=v.annotationStorage,this.enableScripting=v.enableScripting,this.hasJSActions=v.hasJSActions,this._fieldObjects=v.fieldObjects,i&&(this.container=this._createContainer(b)),w&&(this.quadrilaterals=this._createQuadrilaterals(b))}_createContainer(v=!1){const{data:i,page:b,viewport:w}=this,A=document.createElement("section");A.setAttribute("data-annotation-id",i.id);const{pageWidth:I,pageHeight:j,pageX:G,pageY:H}=w.rawDims,{width:S,height:F}=L(i.rect),D=x.Util.normalizeRect([i.rect[0],b.view[3]-i.rect[1]+b.view[1],i.rect[2],b.view[3]-i.rect[3]+b.view[1]]);if(!v&&i.borderStyle.width>0){A.style.borderWidth=`${i.borderStyle.width}px`;const oe=i.borderStyle.horizontalCornerRadius,fe=i.borderStyle.verticalCornerRadius;if(oe>0||fe>0){const be=`calc(${oe}px * var(--scale-factor)) / calc(${fe}px * var(--scale-factor))`;A.style.borderRadius=be}else if(this instanceof c){const be=`calc(${S}px * var(--scale-factor)) / calc(${F}px * var(--scale-factor))`;A.style.borderRadius=be}switch(i.borderStyle.style){case x.AnnotationBorderStyleType.SOLID:A.style.borderStyle="solid";break;case x.AnnotationBorderStyleType.DASHED:A.style.borderStyle="dashed";break;case x.AnnotationBorderStyleType.BEVELED:(0,x.warn)("Unimplemented border style: beveled");break;case x.AnnotationBorderStyleType.INSET:(0,x.warn)("Unimplemented border style: inset");break;case x.AnnotationBorderStyleType.UNDERLINE:A.style.borderBottomStyle="solid";break}const ge=i.borderColor||null;ge?A.style.borderColor=x.Util.makeHexColor(ge[0]|0,ge[1]|0,ge[2]|0):A.style.borderWidth=0}A.style.left=`${100*(D[0]-G)/I}%`,A.style.top=`${100*(D[1]-H)/j}%`;const{rotation:q}=i;return i.hasOwnCanvas||q===0?(A.style.width=`${100*S/I}%`,A.style.height=`${100*F/j}%`):this.setRotation(q,A),A}setRotation(v,i=this.container){const{pageWidth:b,pageHeight:w}=this.viewport.rawDims,{width:A,height:I}=L(this.data.rect);let j,G;v%180===0?(j=100*A/b,G=100*I/w):(j=100*I/b,G=100*A/w),i.style.width=`${j}%`,i.style.height=`${G}%`,i.setAttribute("data-main-rotation",(360-v)%360)}get _commonActions(){const v=(i,b,w)=>{const A=w.detail[i];w.target.style[b]=B.ColorConverters[`${A[0]}_HTML`](A.slice(1))};return(0,x.shadow)(this,"_commonActions",{display:i=>{const b=i.detail.display%2===1;this.container.style.visibility=b?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:b,print:i.detail.display===0||i.detail.display===3})},print:i=>{this.annotationStorage.setValue(this.data.id,{print:i.detail.print})},hidden:i=>{this.container.style.visibility=i.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:i.detail.hidden})},focus:i=>{setTimeout(()=>i.target.focus({preventScroll:!1}),0)},userName:i=>{i.target.title=i.detail.userName},readonly:i=>{i.detail.readonly?i.target.setAttribute("readonly",""):i.target.removeAttribute("readonly")},required:i=>{this._setRequired(i.target,i.detail.required)},bgColor:i=>{v("bgColor","backgroundColor",i)},fillColor:i=>{v("fillColor","backgroundColor",i)},fgColor:i=>{v("fgColor","color",i)},textColor:i=>{v("textColor","color",i)},borderColor:i=>{v("borderColor","borderColor",i)},strokeColor:i=>{v("strokeColor","borderColor",i)},rotation:i=>{const b=i.detail.rotation;this.setRotation(b),this.annotationStorage.setValue(this.data.id,{rotation:b})}})}_dispatchEventFromSandbox(v,i){const b=this._commonActions;for(const w of Object.keys(i.detail)){const A=v[w]||b[w];A==null||A(i)}}_setDefaultPropertiesFromJS(v){if(!this.enableScripting)return;const i=this.annotationStorage.getRawValue(this.data.id);if(!i)return;const b=this._commonActions;for(const[w,A]of Object.entries(i)){const I=b[w];if(I){const j={detail:{[w]:A},target:v};I(j),delete i[w]}}}_createQuadrilaterals(v=!1){if(!this.data.quadPoints)return null;const i=[],b=this.data.rect;for(const w of this.data.quadPoints)this.data.rect=[w[2].x,w[2].y,w[1].x,w[1].y],i.push(this._createContainer(v));return this.data.rect=b,i}_createPopup(v,i){let b=this.container;this.quadrilaterals&&(v=v||this.quadrilaterals,b=this.quadrilaterals[0]),v||(v=document.createElement("div"),v.className="popupTriggerArea",b.append(v));const A=new f({container:b,trigger:v,color:i.color,titleObj:i.titleObj,modificationDate:i.modificationDate,contentsObj:i.contentsObj,richText:i.richText,hideWrapper:!0}).render();A.style.left="100%",b.append(A)}_renderQuadrilaterals(v){for(const i of this.quadrilaterals)i.className=v;return this.quadrilaterals}render(){(0,x.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(v,i=null){const b=[];if(this._fieldObjects){const w=this._fieldObjects[v];if(w)for(const{page:A,id:I,exportValues:j}of w){if(A===-1||I===i)continue;const G=typeof j=="string"?j:null,H=document.querySelector(`[data-element-id="${I}"]`);if(H&&!m.has(H)){(0,x.warn)(`_getElementsByName - element not allowed: ${I}`);continue}b.push({id:I,exportValue:G,domElement:H})}return b}for(const w of document.getElementsByName(v)){const{exportValue:A}=w,I=w.getAttribute("data-element-id");I!==i&&m.has(w)&&b.push({id:I,exportValue:A,domElement:w})}return b}}class l extends u{constructor(i,b=null){super(i,{isRenderable:!0,ignoreBorder:!!(b!=null&&b.ignoreBorder),createQuadrilaterals:!0});de(this,g);this.isTooltipOnly=i.data.isTooltipOnly}render(){const{data:i,linkService:b}=this,w=document.createElement("a");w.setAttribute("data-element-id",i.id);let A=!1;return i.url?(b.addLinkAttributes(w,i.url,i.newWindow),A=!0):i.action?(this._bindNamedAction(w,i.action),A=!0):i.attachment?(this._bindAttachment(w,i.attachment),A=!0):i.setOCGState?(te(this,g,_i).call(this,w,i.setOCGState),A=!0):i.dest?(this._bindLink(w,i.dest),A=!0):(i.actions&&(i.actions.Action||i.actions["Mouse Up"]||i.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(w,i),A=!0),i.resetForm?(this._bindResetFormAction(w,i.resetForm),A=!0):this.isTooltipOnly&&!A&&(this._bindLink(w,""),A=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((I,j)=>{const G=j===0?w:w.cloneNode();return I.append(G),I}):(this.container.className="linkAnnotation",A&&this.container.append(w),this.container)}_bindLink(i,b){i.href=this.linkService.getDestinationHash(b),i.onclick=()=>(b&&this.linkService.goToDestination(b),!1),(b||b==="")&&te(this,g,Ue).call(this)}_bindNamedAction(i,b){i.href=this.linkService.getAnchorUrl(""),i.onclick=()=>(this.linkService.executeNamedAction(b),!1),te(this,g,Ue).call(this)}_bindAttachment(i,b){i.href=this.linkService.getAnchorUrl(""),i.onclick=()=>{var w;return(w=this.downloadManager)==null||w.openOrDownloadData(this.container,b.content,b.filename),!1},te(this,g,Ue).call(this)}_bindJSAction(i,b){i.href=this.linkService.getAnchorUrl("");const w=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const A of Object.keys(b.actions)){const I=w.get(A);I&&(i[I]=()=>{var j;return(j=this.linkService.eventBus)==null||j.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b.id,name:A}}),!1})}i.onclick||(i.onclick=()=>!1),te(this,g,Ue).call(this)}_bindResetFormAction(i,b){const w=i.onclick;if(w||(i.href=this.linkService.getAnchorUrl("")),te(this,g,Ue).call(this),!this._fieldObjects){(0,x.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),w||(i.onclick=()=>!1);return}i.onclick=()=>{var F;w==null||w();const{fields:A,refs:I,include:j}=b,G=[];if(A.length!==0||I.length!==0){const D=new Set(I);for(const q of A){const oe=this._fieldObjects[q]||[];for(const{id:fe}of oe)D.add(fe)}for(const q of Object.values(this._fieldObjects))for(const oe of q)D.has(oe.id)===j&&G.push(oe)}else for(const D of Object.values(this._fieldObjects))G.push(...D);const H=this.annotationStorage,S=[];for(const D of G){const{id:q}=D;switch(S.push(q),D.type){case"text":{const fe=D.defaultValue||"";H.setValue(q,{value:fe});break}case"checkbox":case"radiobutton":{const fe=D.defaultValue===D.exportValues;H.setValue(q,{value:fe});break}case"combobox":case"listbox":{const fe=D.defaultValue||"";H.setValue(q,{value:fe});break}default:continue}const oe=document.querySelector(`[data-element-id="${q}"]`);if(oe){if(!m.has(oe)){(0,x.warn)(`_bindResetFormAction - element not allowed: ${q}`);continue}}else continue;oe.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((F=this.linkService.eventBus)==null||F.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:S,name:"ResetForm"}})),!1}}}g=new WeakSet,Ue=function(){this.container.setAttribute("data-internal-link","")},_i=function(i,b){i.href=this.linkService.getAnchorUrl(""),i.onclick=()=>(this.linkService.executeSetOCGState(b),!1),te(this,g,Ue).call(this)};class d extends u{constructor(v){var b,w,A;const i=!!(v.data.hasPopup||(b=v.data.titleObj)!=null&&b.str||(w=v.data.contentsObj)!=null&&w.str||(A=v.data.richText)!=null&&A.str);super(v,{isRenderable:i})}render(){this.container.className="textAnnotation";const v=document.createElement("img");return v.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",v.alt="[{{type}} Annotation]",v.dataset.l10nId="text_annotation_type",v.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(v,this.data),this.container.append(v),this.container}}class s extends u{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(v){const{isWin:i,isMac:b}=x.FeatureTest.platform;return i&&v.ctrlKey||b&&v.metaKey}_setEventListener(v,i,b,w){i.includes("mouse")?v.addEventListener(i,A=>{var I;(I=this.linkService.eventBus)==null||I.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:b,value:w(A),shift:A.shiftKey,modifier:this._getKeyModifier(A)}})}):v.addEventListener(i,A=>{var I;(I=this.linkService.eventBus)==null||I.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:b,value:w(A)}})})}_setEventListeners(v,i,b){var w;for(const[A,I]of i)(I==="Action"||(w=this.data.actions)!=null&&w[I])&&this._setEventListener(v,A,I,b)}_setBackgroundColor(v){const i=this.data.backgroundColor||null;v.style.backgroundColor=i===null?"transparent":x.Util.makeHexColor(i[0],i[1],i[2])}_setTextStyle(v){const i=["left","center","right"],{fontColor:b}=this.data.defaultAppearanceData,w=this.data.defaultAppearanceData.fontSize||h,A=v.style;let I;const j=2,G=H=>Math.round(10*H)/10;if(this.data.multiLine){const H=Math.abs(this.data.rect[3]-this.data.rect[1]-j),S=Math.round(H/(x.LINE_FACTOR*w))||1,F=H/S;I=Math.min(w,G(F/x.LINE_FACTOR))}else{const H=Math.abs(this.data.rect[3]-this.data.rect[1]-j);I=Math.min(w,G(H/x.LINE_FACTOR))}A.fontSize=`calc(${I}px * var(--scale-factor))`,A.color=x.Util.makeHexColor(b[0],b[1],b[2]),this.data.textAlignment!==null&&(A.textAlign=i[this.data.textAlignment])}_setRequired(v,i){i?v.setAttribute("required",!0):v.removeAttribute("required"),v.setAttribute("aria-required",i)}}class e extends s{constructor(v){const i=v.renderForms||!v.data.hasAppearance&&!!v.data.fieldValue;super(v,{isRenderable:i})}setPropertyOnSiblings(v,i,b,w){const A=this.annotationStorage;for(const I of this._getElementsByName(v.name,v.id))I.domElement&&(I.domElement[i]=b),A.setValue(I.id,{[w]:b})}render(){var w;const v=this.annotationStorage,i=this.data.id;this.container.className="textWidgetAnnotation";let b=null;if(this.renderForms){const A=v.getValue(i,{value:this.data.fieldValue});let I=A.formattedValue||A.value||"";const j=v.getValue(i,{charLimit:this.data.maxLen}).charLimit;j&&I.length>j&&(I=I.slice(0,j));const G={userValue:I,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(b=document.createElement("textarea"),b.textContent=I,this.data.doNotScroll&&(b.style.overflowY="hidden")):(b=document.createElement("input"),b.type="text",b.setAttribute("value",I),this.data.doNotScroll&&(b.style.overflowX="hidden")),m.add(b),b.setAttribute("data-element-id",i),b.disabled=this.data.readOnly,b.name=this.data.fieldName,b.tabIndex=N,this._setRequired(b,this.data.required),j&&(b.maxLength=j),b.addEventListener("input",S=>{v.setValue(i,{value:S.target.value}),this.setPropertyOnSiblings(b,"value",S.target.value,"value")}),b.addEventListener("resetform",S=>{const F=this.data.defaultFieldValue??"";b.value=G.userValue=F,G.formattedValue=null});let H=S=>{const{formattedValue:F}=G;F!=null&&(S.target.value=F),S.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){b.addEventListener("focus",F=>{const{target:D}=F;G.userValue&&(D.value=G.userValue),G.lastCommittedValue=D.value,G.commitKey=1}),b.addEventListener("updatefromsandbox",F=>{const D={value(q){G.userValue=q.detail.value??"",v.setValue(i,{value:G.userValue.toString()}),q.target.value=G.userValue},formattedValue(q){const{formattedValue:oe}=q.detail;G.formattedValue=oe,oe!=null&&q.target!==document.activeElement&&(q.target.value=oe),v.setValue(i,{formattedValue:oe})},selRange(q){q.target.setSelectionRange(...q.detail.selRange)},charLimit:q=>{var be;const{charLimit:oe}=q.detail,{target:fe}=q;if(oe===0){fe.removeAttribute("maxLength");return}fe.setAttribute("maxLength",oe);let ge=G.userValue;!ge||ge.length<=oe||(ge=ge.slice(0,oe),fe.value=G.userValue=ge,v.setValue(i,{value:ge}),(be=this.linkService.eventBus)==null||be.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:ge,willCommit:!0,commitKey:1,selStart:fe.selectionStart,selEnd:fe.selectionEnd}}))}};this._dispatchEventFromSandbox(D,F)}),b.addEventListener("keydown",F=>{var oe;G.commitKey=1;let D=-1;if(F.key==="Escape"?D=0:F.key==="Enter"&&!this.data.multiLine?D=2:F.key==="Tab"&&(G.commitKey=3),D===-1)return;const{value:q}=F.target;G.lastCommittedValue!==q&&(G.lastCommittedValue=q,G.userValue=q,(oe=this.linkService.eventBus)==null||oe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:q,willCommit:!0,commitKey:D,selStart:F.target.selectionStart,selEnd:F.target.selectionEnd}}))});const S=H;H=null,b.addEventListener("blur",F=>{var q;if(!F.relatedTarget)return;const{value:D}=F.target;G.userValue=D,G.lastCommittedValue!==D&&((q=this.linkService.eventBus)==null||q.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:D,willCommit:!0,commitKey:G.commitKey,selStart:F.target.selectionStart,selEnd:F.target.selectionEnd}})),S(F)}),(w=this.data.actions)!=null&&w.Keystroke&&b.addEventListener("beforeinput",F=>{var ve;G.lastCommittedValue=null;const{data:D,target:q}=F,{value:oe,selectionStart:fe,selectionEnd:ge}=q;let be=fe,Ae=ge;switch(F.inputType){case"deleteWordBackward":{const Pe=oe.substring(0,fe).match(/\w*[^\w]*$/);Pe&&(be-=Pe[0].length);break}case"deleteWordForward":{const Pe=oe.substring(fe).match(/^[^\w]*\w*/);Pe&&(Ae+=Pe[0].length);break}case"deleteContentBackward":fe===ge&&(be-=1);break;case"deleteContentForward":fe===ge&&(Ae+=1);break}F.preventDefault(),(ve=this.linkService.eventBus)==null||ve.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:oe,change:D||"",willCommit:!1,selStart:be,selEnd:Ae}})}),this._setEventListeners(b,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],F=>F.target.value)}if(H&&b.addEventListener("blur",H),this.data.comb){const F=(this.data.rect[2]-this.data.rect[0])/j;b.classList.add("comb"),b.style.letterSpacing=`calc(${F}px * var(--scale-factor) - 1ch)`}}else b=document.createElement("div"),b.textContent=this.data.fieldValue,b.style.verticalAlign="middle",b.style.display="table-cell";return this._setTextStyle(b),this._setBackgroundColor(b),this._setDefaultPropertiesFromJS(b),this.container.append(b),this.container}}class r extends s{constructor(v){super(v,{isRenderable:v.renderForms})}render(){const v=this.annotationStorage,i=this.data,b=i.id;let w=v.getValue(b,{value:i.exportValue===i.fieldValue}).value;typeof w=="string"&&(w=w!=="Off",v.setValue(b,{value:w})),this.container.className="buttonWidgetAnnotation checkBox";const A=document.createElement("input");return m.add(A),A.setAttribute("data-element-id",b),A.disabled=i.readOnly,this._setRequired(A,this.data.required),A.type="checkbox",A.name=i.fieldName,w&&A.setAttribute("checked",!0),A.setAttribute("exportValue",i.exportValue),A.tabIndex=N,A.addEventListener("change",I=>{const{name:j,checked:G}=I.target;for(const H of this._getElementsByName(j,b)){const S=G&&H.exportValue===i.exportValue;H.domElement&&(H.domElement.checked=S),v.setValue(H.id,{value:S})}v.setValue(b,{value:G})}),A.addEventListener("resetform",I=>{const j=i.defaultFieldValue||"Off";I.target.checked=j===i.exportValue}),this.enableScripting&&this.hasJSActions&&(A.addEventListener("updatefromsandbox",I=>{const j={value(G){G.target.checked=G.detail.value!=="Off",v.setValue(b,{value:G.target.checked})}};this._dispatchEventFromSandbox(j,I)}),this._setEventListeners(A,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],I=>I.target.checked)),this._setBackgroundColor(A),this._setDefaultPropertiesFromJS(A),this.container.append(A),this.container}}class c extends s{constructor(v){super(v,{isRenderable:v.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const v=this.annotationStorage,i=this.data,b=i.id;let w=v.getValue(b,{value:i.fieldValue===i.buttonValue}).value;typeof w=="string"&&(w=w!==i.buttonValue,v.setValue(b,{value:w}));const A=document.createElement("input");if(m.add(A),A.setAttribute("data-element-id",b),A.disabled=i.readOnly,this._setRequired(A,this.data.required),A.type="radio",A.name=i.fieldName,w&&A.setAttribute("checked",!0),A.tabIndex=N,A.addEventListener("change",I=>{const{name:j,checked:G}=I.target;for(const H of this._getElementsByName(j,b))v.setValue(H.id,{value:!1});v.setValue(b,{value:G})}),A.addEventListener("resetform",I=>{const j=i.defaultFieldValue;I.target.checked=j!=null&&j===i.buttonValue}),this.enableScripting&&this.hasJSActions){const I=i.buttonValue;A.addEventListener("updatefromsandbox",j=>{const G={value:H=>{const S=I===H.detail.value;for(const F of this._getElementsByName(H.target.name)){const D=S&&F.id===b;F.domElement&&(F.domElement.checked=D),v.setValue(F.id,{value:D})}}};this._dispatchEventFromSandbox(G,j)}),this._setEventListeners(A,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],j=>j.target.checked)}return this._setBackgroundColor(A),this._setDefaultPropertiesFromJS(A),this.container.append(A),this.container}}class o extends l{constructor(v){super(v,{ignoreBorder:v.data.hasAppearance})}render(){const v=super.render();v.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(v.title=this.data.alternativeText);const i=v.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",b=>{this._dispatchEventFromSandbox({},b)})),v}}class t extends s{constructor(v){super(v,{isRenderable:v.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const v=this.annotationStorage,i=this.data.id,b=v.getValue(i,{value:this.data.fieldValue}),w=document.createElement("select");m.add(w),w.setAttribute("data-element-id",i),w.disabled=this.data.readOnly,this._setRequired(w,this.data.required),w.name=this.data.fieldName,w.tabIndex=N;let A=this.data.combo&&this.data.options.length>0;this.data.combo||(w.size=this.data.options.length,this.data.multiSelect&&(w.multiple=!0)),w.addEventListener("resetform",S=>{const F=this.data.defaultFieldValue;for(const D of w.options)D.selected=D.value===F});for(const S of this.data.options){const F=document.createElement("option");F.textContent=S.displayValue,F.value=S.exportValue,b.value.includes(S.exportValue)&&(F.setAttribute("selected",!0),A=!1),w.append(F)}let I=null;if(A){const S=document.createElement("option");S.value=" ",S.setAttribute("hidden",!0),S.setAttribute("selected",!0),w.prepend(S),I=()=>{S.remove(),w.removeEventListener("input",I),I=null},w.addEventListener("input",I)}const j=S=>{const F=S?"value":"textContent",{options:D,multiple:q}=w;return q?Array.prototype.filter.call(D,oe=>oe.selected).map(oe=>oe[F]):D.selectedIndex===-1?null:D[D.selectedIndex][F]};let G=j(!1);const H=S=>{const F=S.target.options;return Array.prototype.map.call(F,D=>({displayValue:D.textContent,exportValue:D.value}))};return this.enableScripting&&this.hasJSActions?(w.addEventListener("updatefromsandbox",S=>{const F={value(D){I==null||I();const q=D.detail.value,oe=new Set(Array.isArray(q)?q:[q]);for(const fe of w.options)fe.selected=oe.has(fe.value);v.setValue(i,{value:j(!0)}),G=j(!1)},multipleSelection(D){w.multiple=!0},remove(D){const q=w.options,oe=D.detail.remove;q[oe].selected=!1,w.remove(oe),q.length>0&&Array.prototype.findIndex.call(q,ge=>ge.selected)===-1&&(q[0].selected=!0),v.setValue(i,{value:j(!0),items:H(D)}),G=j(!1)},clear(D){for(;w.length!==0;)w.remove(0);v.setValue(i,{value:null,items:[]}),G=j(!1)},insert(D){const{index:q,displayValue:oe,exportValue:fe}=D.detail.insert,ge=w.children[q],be=document.createElement("option");be.textContent=oe,be.value=fe,ge?ge.before(be):w.append(be),v.setValue(i,{value:j(!0),items:H(D)}),G=j(!1)},items(D){const{items:q}=D.detail;for(;w.length!==0;)w.remove(0);for(const oe of q){const{displayValue:fe,exportValue:ge}=oe,be=document.createElement("option");be.textContent=fe,be.value=ge,w.append(be)}w.options.length>0&&(w.options[0].selected=!0),v.setValue(i,{value:j(!0),items:H(D)}),G=j(!1)},indices(D){const q=new Set(D.detail.indices);for(const oe of D.target.options)oe.selected=q.has(oe.index);v.setValue(i,{value:j(!0)}),G=j(!1)},editable(D){D.target.disabled=!D.detail.editable}};this._dispatchEventFromSandbox(F,S)}),w.addEventListener("input",S=>{var D;const F=j(!0);v.setValue(i,{value:F}),S.preventDefault(),(D=this.linkService.eventBus)==null||D.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:G,changeEx:F,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(w,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],S=>S.target.checked)):w.addEventListener("input",function(S){v.setValue(i,{value:j(!0)})}),this.data.combo&&this._setTextStyle(w),this._setBackgroundColor(w),this._setDefaultPropertiesFromJS(w),this.container.append(w),this.container}}const z=class z extends u{constructor(v){var w,A,I;const{data:i}=v,b=!z.IGNORE_TYPES.has(i.parentType)&&!!((w=i.titleObj)!=null&&w.str||(A=i.contentsObj)!=null&&A.str||(I=i.richText)!=null&&I.str);super(v,{isRenderable:b})}render(){this.container.className="popupAnnotation";const v=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(v.length===0)return this.container;const i=new f({container:this.container,trigger:Array.from(v),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),b=this.page,w=x.Util.normalizeRect([this.data.parentRect[0],b.view[3]-this.data.parentRect[1]+b.view[1],this.data.parentRect[2],b.view[3]-this.data.parentRect[3]+b.view[1]]),A=w[0]+this.data.parentRect[2]-this.data.parentRect[0],I=w[1],{pageWidth:j,pageHeight:G,pageX:H,pageY:S}=this.viewport.rawDims;return this.container.style.left=`${100*(A-H)/j}%`,this.container.style.top=`${100*(I-S)/G}%`,this.container.append(i.render()),this.container}};Fe(z,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));let n=z;class f{constructor(v){this.container=v.container,this.trigger=v.trigger,this.color=v.color,this.titleObj=v.titleObj,this.modificationDate=v.modificationDate,this.contentsObj=v.contentsObj,this.richText=v.richText,this.hideWrapper=v.hideWrapper||!1,this.pinned=!1}render(){var j,G;const i=document.createElement("div");i.className="popupWrapper",this.hideElement=this.hideWrapper?i:this.container,this.hideElement.hidden=!0;const b=document.createElement("div");b.className="popup";const w=this.color;if(w){const H=.7*(255-w[0])+w[0],S=.7*(255-w[1])+w[1],F=.7*(255-w[2])+w[2];b.style.backgroundColor=x.Util.makeHexColor(H|0,S|0,F|0)}const A=document.createElement("h1");A.dir=this.titleObj.dir,A.textContent=this.titleObj.str,b.append(A);const I=V.PDFDateString.toDateObject(this.modificationDate);if(I){const H=document.createElement("span");H.className="popupDate",H.textContent="{{date}}, {{time}}",H.dataset.l10nId="annotation_date_string",H.dataset.l10nArgs=JSON.stringify({date:I.toLocaleDateString(),time:I.toLocaleTimeString()}),b.append(H)}if((j=this.richText)!=null&&j.str&&(!((G=this.contentsObj)!=null&&G.str)||this.contentsObj.str===this.richText.str))R.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:b}),b.lastChild.className="richText popupContent";else{const H=this._formatContents(this.contentsObj);b.append(H)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const H of this.trigger)H.addEventListener("click",this._toggle.bind(this)),H.addEventListener("mouseover",this._show.bind(this,!1)),H.addEventListener("mouseout",this._hide.bind(this,!1));return b.addEventListener("click",this._hide.bind(this,!0)),i.append(b),i}_formatContents({str:v,dir:i}){const b=document.createElement("p");b.className="popupContent",b.dir=i;const w=v.split(/(?:\r\n?|\n)/);for(let A=0,I=w.length;A<I;++A){const j=w[A];b.append(document.createTextNode(j)),A<I-1&&b.append(document.createElement("br"))}return b}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(v=!1){v&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(v=!0){v&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class a extends u{constructor(v){var b,w,A;const i=!!(v.data.hasPopup||(b=v.data.titleObj)!=null&&b.str||(w=v.data.contentsObj)!=null&&w.str||(A=v.data.richText)!=null&&A.str);super(v,{isRenderable:i,ignoreBorder:!0}),this.textContent=v.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const v=document.createElement("div");v.className="annotationTextContent",v.setAttribute("role","comment");for(const i of this.textContent){const b=document.createElement("span");b.textContent=i,v.append(b)}this.container.append(v)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class T extends u{constructor(v){var b,w,A;const i=!!(v.data.hasPopup||(b=v.data.titleObj)!=null&&b.str||(w=v.data.contentsObj)!=null&&w.str||(A=v.data.richText)!=null&&A.str);super(v,{isRenderable:i,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const v=this.data,{width:i,height:b}=L(v.rect),w=this.svgFactory.create(i,b,!0),A=this.svgFactory.createElement("svg:line");return A.setAttribute("x1",v.rect[2]-v.lineCoordinates[0]),A.setAttribute("y1",v.rect[3]-v.lineCoordinates[1]),A.setAttribute("x2",v.rect[2]-v.lineCoordinates[2]),A.setAttribute("y2",v.rect[3]-v.lineCoordinates[3]),A.setAttribute("stroke-width",v.borderStyle.width||1),A.setAttribute("stroke","transparent"),A.setAttribute("fill","transparent"),w.append(A),this.container.append(w),this._createPopup(A,v),this.container}}class O extends u{constructor(v){var b,w,A;const i=!!(v.data.hasPopup||(b=v.data.titleObj)!=null&&b.str||(w=v.data.contentsObj)!=null&&w.str||(A=v.data.richText)!=null&&A.str);super(v,{isRenderable:i,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const v=this.data,{width:i,height:b}=L(v.rect),w=this.svgFactory.create(i,b,!0),A=v.borderStyle.width,I=this.svgFactory.createElement("svg:rect");return I.setAttribute("x",A/2),I.setAttribute("y",A/2),I.setAttribute("width",i-A),I.setAttribute("height",b-A),I.setAttribute("stroke-width",A||1),I.setAttribute("stroke","transparent"),I.setAttribute("fill","transparent"),w.append(I),this.container.append(w),this._createPopup(I,v),this.container}}class X extends u{constructor(v){var b,w,A;const i=!!(v.data.hasPopup||(b=v.data.titleObj)!=null&&b.str||(w=v.data.contentsObj)!=null&&w.str||(A=v.data.richText)!=null&&A.str);super(v,{isRenderable:i,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const v=this.data,{width:i,height:b}=L(v.rect),w=this.svgFactory.create(i,b,!0),A=v.borderStyle.width,I=this.svgFactory.createElement("svg:ellipse");return I.setAttribute("cx",i/2),I.setAttribute("cy",b/2),I.setAttribute("rx",i/2-A/2),I.setAttribute("ry",b/2-A/2),I.setAttribute("stroke-width",A||1),I.setAttribute("stroke","transparent"),I.setAttribute("fill","transparent"),w.append(I),this.container.append(w),this._createPopup(I,v),this.container}}class Y extends u{constructor(v){var b,w,A;const i=!!(v.data.hasPopup||(b=v.data.titleObj)!=null&&b.str||(w=v.data.contentsObj)!=null&&w.str||(A=v.data.richText)!=null&&A.str);super(v,{isRenderable:i,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const v=this.data,{width:i,height:b}=L(v.rect),w=this.svgFactory.create(i,b,!0);let A=[];for(const j of v.vertices){const G=j.x-v.rect[0],H=v.rect[3]-j.y;A.push(G+","+H)}A=A.join(" ");const I=this.svgFactory.createElement(this.svgElementName);return I.setAttribute("points",A),I.setAttribute("stroke-width",v.borderStyle.width||1),I.setAttribute("stroke","transparent"),I.setAttribute("fill","transparent"),w.append(I),this.container.append(w),this._createPopup(I,v),this.container}}class _e extends Y{constructor(v){super(v),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class ue extends u{constructor(v){var b,w,A;const i=!!(v.data.hasPopup||(b=v.data.titleObj)!=null&&b.str||(w=v.data.contentsObj)!=null&&w.str||(A=v.data.richText)!=null&&A.str);super(v,{isRenderable:i,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class J extends u{constructor(v){var b,w,A;const i=!!(v.data.hasPopup||(b=v.data.titleObj)!=null&&b.str||(w=v.data.contentsObj)!=null&&w.str||(A=v.data.richText)!=null&&A.str);super(v,{isRenderable:i,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const v=this.data,{width:i,height:b}=L(v.rect),w=this.svgFactory.create(i,b,!0);for(const A of v.inkLists){let I=[];for(const G of A){const H=G.x-v.rect[0],S=v.rect[3]-G.y;I.push(`${H},${S}`)}I=I.join(" ");const j=this.svgFactory.createElement(this.svgElementName);j.setAttribute("points",I),j.setAttribute("stroke-width",v.borderStyle.width||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),this._createPopup(j,v),w.append(j)}return this.container.append(w),this.container}}class K extends u{constructor(v){var b,w,A;const i=!!(v.data.hasPopup||(b=v.data.titleObj)!=null&&b.str||(w=v.data.contentsObj)!=null&&w.str||(A=v.data.richText)!=null&&A.str);super(v,{isRenderable:i,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class $ extends u{constructor(v){var b,w,A;const i=!!(v.data.hasPopup||(b=v.data.titleObj)!=null&&b.str||(w=v.data.contentsObj)!=null&&w.str||(A=v.data.richText)!=null&&A.str);super(v,{isRenderable:i,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class k extends u{constructor(v){var b,w,A;const i=!!(v.data.hasPopup||(b=v.data.titleObj)!=null&&b.str||(w=v.data.contentsObj)!=null&&w.str||(A=v.data.richText)!=null&&A.str);super(v,{isRenderable:i,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class le extends u{constructor(v){var b,w,A;const i=!!(v.data.hasPopup||(b=v.data.titleObj)!=null&&b.str||(w=v.data.contentsObj)!=null&&w.str||(A=v.data.richText)!=null&&A.str);super(v,{isRenderable:i,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class re extends u{constructor(v){var b,w,A;const i=!!(v.data.hasPopup||(b=v.data.titleObj)!=null&&b.str||(w=v.data.contentsObj)!=null&&w.str||(A=v.data.richText)!=null&&A.str);super(v,{isRenderable:i,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class y extends u{constructor(v){var w;super(v,{isRenderable:!0});const{filename:i,content:b}=this.data.file;this.filename=(0,V.getFilenameFromUrl)(i,!0),this.content=b,(w=this.linkService.eventBus)==null||w.dispatch("fileattachmentannotation",{source:this,filename:i,content:b})}render(){var i,b;this.container.className="fileAttachmentAnnotation";let v;return this.data.hasAppearance?v=document.createElement("div"):(v=document.createElement("img"),v.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),v.className="popupTriggerArea",v.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((i=this.data.titleObj)!=null&&i.str||(b=this.data.contentsObj)!=null&&b.str||this.data.richText)&&this._createPopup(v,this.data),this.container.append(v),this.container}_download(){var v;(v=this.downloadManager)==null||v.openOrDownloadData(this.container,this.content,this.filename)}}const he=class he{static render(v){var G,H;const{annotations:i,div:b,viewport:w,accessibilityManager:A}=v;(0,V.setLayerDimensions)(b,w);const I={data:null,layer:b,page:v.page,viewport:w,linkService:v.linkService,downloadManager:v.downloadManager,imageResourcesPath:v.imageResourcesPath||"",renderForms:v.renderForms!==!1,svgFactory:new V.DOMSVGFactory,annotationStorage:v.annotationStorage||new ne.AnnotationStorage,enableScripting:v.enableScripting===!0,hasJSActions:v.hasJSActions,fieldObjects:v.fieldObjects};let j=0;for(const S of i){if(S.annotationType!==x.AnnotationType.POPUP){const{width:q,height:oe}=L(S.rect);if(q<=0||oe<=0)continue}I.data=S;const F=C.create(I);if(!F.isRenderable)continue;const D=F.render();if(S.hidden&&(D.style.visibility="hidden"),Array.isArray(D))for(const q of D)q.style.zIndex=j++,te(G=he,U,Tt).call(G,q,S.id,b,A);else D.style.zIndex=j++,F instanceof n?b.prepend(D):te(H=he,U,Tt).call(H,D,S.id,b,A)}te(this,U,xt).call(this,b,v.annotationCanvasMap)}static update(v){const{annotationCanvasMap:i,div:b,viewport:w}=v;(0,V.setLayerDimensions)(b,{rotation:w.rotation}),te(this,U,xt).call(this,b,i),b.hidden=!1}};U=new WeakSet,Tt=function(v,i,b,w){const A=v.firstChild||v;A.id=`${V.AnnotationPrefix}${i}`,b.append(v),w==null||w.moveElementInDOM(b,v,A,!1)},xt=function(v,i){if(i){for(const[b,w]of i){const A=v.querySelector(`[data-annotation-id="${b}"]`);if(!A)continue;const{firstChild:I}=A;I?I.nodeName==="CANVAS"?I.replaceWith(w):I.before(w):A.append(w)}i.clear()}},de(he,U);let p=he;P.AnnotationLayer=p},(me,P)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.ColorConverters=void 0;function Z(V){return Math.floor(Math.max(0,Math.min(1,V))*255).toString(16).padStart(2,"0")}class x{static CMYK_G([ne,B,R,N]){return["G",1-Math.min(1,.3*ne+.59*R+.11*B+N)]}static G_CMYK([ne]){return["CMYK",0,0,0,1-ne]}static G_RGB([ne]){return["RGB",ne,ne,ne]}static G_HTML([ne]){const B=Z(ne);return`#${B}${B}${B}`}static RGB_G([ne,B,R]){return["G",.3*ne+.59*B+.11*R]}static RGB_HTML([ne,B,R]){const N=Z(ne),h=Z(B),m=Z(R);return`#${N}${h}${m}`}static T_HTML(){return"#00000000"}static CMYK_RGB([ne,B,R,N]){return["RGB",1-Math.min(1,ne+N),1-Math.min(1,R+N),1-Math.min(1,B+N)]}static CMYK_HTML(ne){const B=this.CMYK_RGB(ne).slice(1);return this.RGB_HTML(B)}static RGB_CMYK([ne,B,R]){const N=1-ne,h=1-B,m=1-R,L=Math.min(N,h,m);return["CMYK",N,h,m,L]}}P.ColorConverters=x},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.XfaLayer=void 0;var x=Z(19);class V{static setupStorage(B,R,N,h,m){const L=h.getValue(R,{value:null});switch(N.name){case"textarea":if(L.value!==null&&(B.textContent=L.value),m==="print")break;B.addEventListener("input",C=>{h.setValue(R,{value:C.target.value})});break;case"input":if(N.attributes.type==="radio"||N.attributes.type==="checkbox"){if(L.value===N.attributes.xfaOn?B.setAttribute("checked",!0):L.value===N.attributes.xfaOff&&B.removeAttribute("checked"),m==="print")break;B.addEventListener("change",C=>{h.setValue(R,{value:C.target.checked?C.target.getAttribute("xfaOn"):C.target.getAttribute("xfaOff")})})}else{if(L.value!==null&&B.setAttribute("value",L.value),m==="print")break;B.addEventListener("input",C=>{h.setValue(R,{value:C.target.value})})}break;case"select":if(L.value!==null)for(const C of N.children)C.attributes.value===L.value&&(C.attributes.selected=!0);B.addEventListener("input",C=>{const u=C.target.options,l=u.selectedIndex===-1?"":u[u.selectedIndex].value;h.setValue(R,{value:l})});break}}static setAttributes({html:B,element:R,storage:N=null,intent:h,linkService:m}){const{attributes:L}=R,C=B instanceof HTMLAnchorElement;L.type==="radio"&&(L.name=`${L.name}-${h}`);for(const[u,l]of Object.entries(L))if(l!=null)switch(u){case"class":l.length&&B.setAttribute(u,l.join(" "));break;case"dataId":break;case"id":B.setAttribute("data-element-id",l);break;case"style":Object.assign(B.style,l);break;case"textContent":B.textContent=l;break;default:(!C||u!=="href"&&u!=="newWindow")&&B.setAttribute(u,l)}C&&m.addLinkAttributes(B,L.href,L.newWindow),N&&L.dataId&&this.setupStorage(B,L.dataId,R,N)}static render(B){var d;const R=B.annotationStorage,N=B.linkService,h=B.xfaHtml,m=B.intent||"display",L=document.createElement(h.name);h.attributes&&this.setAttributes({html:L,element:h,intent:m,linkService:N});const C=[[h,-1,L]],u=B.div;if(u.append(L),B.viewport){const s=`matrix(${B.viewport.transform.join(",")})`;u.style.transform=s}m!=="richText"&&u.setAttribute("class","xfaLayer xfaFont");const l=[];for(;C.length>0;){const[s,e,r]=C.at(-1);if(e+1===s.children.length){C.pop();continue}const c=s.children[++C.at(-1)[1]];if(c===null)continue;const{name:o}=c;if(o==="#text"){const n=document.createTextNode(c.value);l.push(n),r.append(n);continue}let t;if((d=c==null?void 0:c.attributes)!=null&&d.xmlns?t=document.createElementNS(c.attributes.xmlns,o):t=document.createElement(o),r.append(t),c.attributes&&this.setAttributes({html:t,element:c,storage:R,intent:m,linkService:N}),c.children&&c.children.length>0)C.push([c,-1,t]);else if(c.value){const n=document.createTextNode(c.value);x.XfaText.shouldBuildText(o)&&l.push(n),t.append(n)}}for(const s of u.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))s.setAttribute("readOnly",!0);return{textDivs:l}}static update(B){const R=`matrix(${B.viewport.transform.join(",")})`;B.div.style.transform=R,B.div.hidden=!1}}P.XfaLayer=V},(me,P,Z)=>{Object.defineProperty(P,"__esModule",{value:!0}),P.SVGGraphics=void 0;var x=Z(6),V=Z(1),ne=Z(10);let B=class{constructor(){(0,V.unreachable)("Not implemented: SVGGraphics")}};P.SVGGraphics=B;{let d=function(t){let n=[];const f=[];for(const a of t){if(a.fn==="save"){n.push({fnId:92,fn:"group",items:[]}),f.push(n),n=n.at(-1).items;continue}a.fn==="restore"?n=f.pop():n.push(a)}return n},s=function(t){if(Number.isInteger(t))return t.toString();const n=t.toFixed(10);let f=n.length-1;if(n[f]!=="0")return n;do f--;while(n[f]==="0");return n.substring(0,n[f]==="."?f:f+1)},e=function(t){if(t[4]===0&&t[5]===0){if(t[1]===0&&t[2]===0)return t[0]===1&&t[3]===1?"":`scale(${s(t[0])} ${s(t[3])})`;if(t[0]===t[3]&&t[1]===-t[2]){const n=Math.acos(t[0])*180/Math.PI;return`rotate(${s(n)})`}}else if(t[0]===1&&t[1]===0&&t[2]===0&&t[3]===1)return`translate(${s(t[4])} ${s(t[5])})`;return`matrix(${s(t[0])} ${s(t[1])} ${s(t[2])} ${s(t[3])} ${s(t[4])} ${s(t[5])})`};const R={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},N="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/1999/xlink",m=["butt","round","square"],L=["miter","round","bevel"],C=function(t,n="",f=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!f)return URL.createObjectURL(new Blob([t],{type:n}));const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let T=`data:${n};base64,`;for(let O=0,X=t.length;O<X;O+=3){const Y=t[O]&255,_e=t[O+1]&255,ue=t[O+2]&255,J=Y>>2,K=(Y&3)<<4|_e>>4,$=O+1<X?(_e&15)<<2|ue>>6:64,k=O+2<X?ue&63:64;T+=a[J]+a[K]+a[$]+a[k]}return T},u=function(){const t=new Uint8Array([137,80,78,71,13,10,26,10]),n=12,f=new Int32Array(256);for(let ue=0;ue<256;ue++){let J=ue;for(let K=0;K<8;K++)J&1?J=3988292384^J>>1&2147483647:J=J>>1&2147483647;f[ue]=J}function a(ue,J,K){let $=-1;for(let k=J;k<K;k++){const le=($^ue[k])&255,re=f[le];$=$>>>8^re}return $^-1}function T(ue,J,K,$){let k=$;const le=J.length;K[k]=le>>24&255,K[k+1]=le>>16&255,K[k+2]=le>>8&255,K[k+3]=le&255,k+=4,K[k]=ue.charCodeAt(0)&255,K[k+1]=ue.charCodeAt(1)&255,K[k+2]=ue.charCodeAt(2)&255,K[k+3]=ue.charCodeAt(3)&255,k+=4,K.set(J,k),k+=J.length;const re=a(K,$+4,k);K[k]=re>>24&255,K[k+1]=re>>16&255,K[k+2]=re>>8&255,K[k+3]=re&255}function O(ue,J,K){let $=1,k=0;for(let le=J;le<K;++le)$=($+(ue[le]&255))%65521,k=(k+$)%65521;return k<<16|$}function X(ue){if(!ne.isNodeJS)return Y(ue);try{let J;parseInt(process.versions.node)>=8?J=ue:J=Buffer.from(ue);const K=require$$5.deflateSync(J,{level:9});return K instanceof Uint8Array?K:new Uint8Array(K)}catch(J){(0,V.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+J)}return Y(ue)}function Y(ue){let J=ue.length;const K=65535,$=Math.ceil(J/K),k=new Uint8Array(2+J+$*5+4);let le=0;k[le++]=120,k[le++]=156;let re=0;for(;J>K;)k[le++]=0,k[le++]=255,k[le++]=255,k[le++]=0,k[le++]=0,k.set(ue.subarray(re,re+K),le),le+=K,re+=K,J-=K;k[le++]=1,k[le++]=J&255,k[le++]=J>>8&255,k[le++]=~J&65535&255,k[le++]=(~J&65535)>>8&255,k.set(ue.subarray(re),le),le+=ue.length-re;const y=O(ue,0,ue.length);return k[le++]=y>>24&255,k[le++]=y>>16&255,k[le++]=y>>8&255,k[le++]=y&255,k}function _e(ue,J,K,$){const k=ue.width,le=ue.height;let re,y,p;const g=ue.data;switch(J){case V.ImageKind.GRAYSCALE_1BPP:y=0,re=1,p=k+7>>3;break;case V.ImageKind.RGB_24BPP:y=2,re=8,p=k*3;break;case V.ImageKind.RGBA_32BPP:y=6,re=8,p=k*4;break;default:throw new Error("invalid format")}const M=new Uint8Array((1+p)*le);let W=0,z=0;for(let v=0;v<le;++v)M[W++]=0,M.set(g.subarray(z,z+p),W),z+=p,W+=p;if(J===V.ImageKind.GRAYSCALE_1BPP&&$){W=0;for(let v=0;v<le;v++){W++;for(let i=0;i<p;i++)M[W++]^=255}}const U=new Uint8Array([k>>24&255,k>>16&255,k>>8&255,k&255,le>>24&255,le>>16&255,le>>8&255,le&255,re,y,0,0,0]),Q=X(M),ee=t.length+n*3+U.length+Q.length,he=new Uint8Array(ee);let ie=0;return he.set(t,ie),ie+=t.length,T("IHDR",U,he,ie),ie+=n+U.length,T("IDATA",Q,he,ie),ie+=n+Q.length,T("IEND",new Uint8Array(0),he,ie),C(he,"image/png",K)}return function(J,K,$){const k=J.kind===void 0?V.ImageKind.GRAYSCALE_1BPP:J.kind;return _e(J,k,K,$)}}();class l{constructor(){this.fontSizeScale=1,this.fontWeight=R.fontWeight,this.fontSize=0,this.textMatrix=V.IDENTITY_MATRIX,this.fontMatrix=V.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=V.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=R.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(n,f){this.x=n,this.y=f}}let r=0,c=0,o=0;P.SVGGraphics=B=class{constructor(t,n,f=!1){(0,x.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new x.DOMSVGFactory,this.current=new l,this.transformMatrix=V.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=n,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!f,this._operatorIdMapping=[];for(const a in V.OPS)this._operatorIdMapping[V.OPS[a]]=a}getObject(t,n=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):n}save(){this.transformStack.push(this.transformMatrix);const t=this.current;this.extraStack.push(t),this.current=t.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(t){this.save(),this.executeOpTree(t),this.restore()}loadDependencies(t){const n=t.fnArray,f=t.argsArray;for(let a=0,T=n.length;a<T;a++)if(n[a]===V.OPS.dependency)for(const O of f[a]){const X=O.startsWith("g_")?this.commonObjs:this.objs,Y=new Promise(_e=>{X.get(O,_e)});this.current.dependencies.push(Y)}return Promise.all(this.current.dependencies)}transform(t,n,f,a,T,O){const X=[t,n,f,a,T,O];this.transformMatrix=V.Util.transform(this.transformMatrix,X),this.tgrp=null}getSVG(t,n){this.viewport=n;const f=this._initialize(n);return this.loadDependencies(t).then(()=>(this.transformMatrix=V.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(t)),f))}convertOpList(t){const n=this._operatorIdMapping,f=t.argsArray,a=t.fnArray,T=[];for(let O=0,X=a.length;O<X;O++){const Y=a[O];T.push({fnId:Y,fn:n[Y],args:f[O]})}return d(T)}executeOpTree(t){for(const n of t){const f=n.fn,a=n.fnId,T=n.args;switch(a|0){case V.OPS.beginText:this.beginText();break;case V.OPS.dependency:break;case V.OPS.setLeading:this.setLeading(T);break;case V.OPS.setLeadingMoveText:this.setLeadingMoveText(T[0],T[1]);break;case V.OPS.setFont:this.setFont(T);break;case V.OPS.showText:this.showText(T[0]);break;case V.OPS.showSpacedText:this.showText(T[0]);break;case V.OPS.endText:this.endText();break;case V.OPS.moveText:this.moveText(T[0],T[1]);break;case V.OPS.setCharSpacing:this.setCharSpacing(T[0]);break;case V.OPS.setWordSpacing:this.setWordSpacing(T[0]);break;case V.OPS.setHScale:this.setHScale(T[0]);break;case V.OPS.setTextMatrix:this.setTextMatrix(T[0],T[1],T[2],T[3],T[4],T[5]);break;case V.OPS.setTextRise:this.setTextRise(T[0]);break;case V.OPS.setTextRenderingMode:this.setTextRenderingMode(T[0]);break;case V.OPS.setLineWidth:this.setLineWidth(T[0]);break;case V.OPS.setLineJoin:this.setLineJoin(T[0]);break;case V.OPS.setLineCap:this.setLineCap(T[0]);break;case V.OPS.setMiterLimit:this.setMiterLimit(T[0]);break;case V.OPS.setFillRGBColor:this.setFillRGBColor(T[0],T[1],T[2]);break;case V.OPS.setStrokeRGBColor:this.setStrokeRGBColor(T[0],T[1],T[2]);break;case V.OPS.setStrokeColorN:this.setStrokeColorN(T);break;case V.OPS.setFillColorN:this.setFillColorN(T);break;case V.OPS.shadingFill:this.shadingFill(T[0]);break;case V.OPS.setDash:this.setDash(T[0],T[1]);break;case V.OPS.setRenderingIntent:this.setRenderingIntent(T[0]);break;case V.OPS.setFlatness:this.setFlatness(T[0]);break;case V.OPS.setGState:this.setGState(T[0]);break;case V.OPS.fill:this.fill();break;case V.OPS.eoFill:this.eoFill();break;case V.OPS.stroke:this.stroke();break;case V.OPS.fillStroke:this.fillStroke();break;case V.OPS.eoFillStroke:this.eoFillStroke();break;case V.OPS.clip:this.clip("nonzero");break;case V.OPS.eoClip:this.clip("evenodd");break;case V.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case V.OPS.paintImageXObject:this.paintImageXObject(T[0]);break;case V.OPS.paintInlineImageXObject:this.paintInlineImageXObject(T[0]);break;case V.OPS.paintImageMaskXObject:this.paintImageMaskXObject(T[0]);break;case V.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(T[0],T[1]);break;case V.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case V.OPS.closePath:this.closePath();break;case V.OPS.closeStroke:this.closeStroke();break;case V.OPS.closeFillStroke:this.closeFillStroke();break;case V.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case V.OPS.nextLine:this.nextLine();break;case V.OPS.transform:this.transform(T[0],T[1],T[2],T[3],T[4],T[5]);break;case V.OPS.constructPath:this.constructPath(T[0],T[1]);break;case V.OPS.endPath:this.endPath();break;case 92:this.group(n.items);break;default:(0,V.warn)(`Unimplemented operator ${f}`);break}}}setWordSpacing(t){this.current.wordSpacing=t}setCharSpacing(t){this.current.charSpacing=t}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(t,n,f,a,T,O){const X=this.current;X.textMatrix=X.lineMatrix=[t,n,f,a,T,O],X.textMatrixScale=Math.hypot(t,n),X.x=X.lineX=0,X.y=X.lineY=0,X.xcoords=[],X.ycoords=[],X.tspan=this.svgFactory.createElement("svg:tspan"),X.tspan.setAttributeNS(null,"font-family",X.fontFamily),X.tspan.setAttributeNS(null,"font-size",`${s(X.fontSize)}px`),X.tspan.setAttributeNS(null,"y",s(-X.y)),X.txtElement=this.svgFactory.createElement("svg:text"),X.txtElement.append(X.tspan)}beginText(){const t=this.current;t.x=t.lineX=0,t.y=t.lineY=0,t.textMatrix=V.IDENTITY_MATRIX,t.lineMatrix=V.IDENTITY_MATRIX,t.textMatrixScale=1,t.tspan=this.svgFactory.createElement("svg:tspan"),t.txtElement=this.svgFactory.createElement("svg:text"),t.txtgrp=this.svgFactory.createElement("svg:g"),t.xcoords=[],t.ycoords=[]}moveText(t,n){const f=this.current;f.x=f.lineX+=t,f.y=f.lineY+=n,f.xcoords=[],f.ycoords=[],f.tspan=this.svgFactory.createElement("svg:tspan"),f.tspan.setAttributeNS(null,"font-family",f.fontFamily),f.tspan.setAttributeNS(null,"font-size",`${s(f.fontSize)}px`),f.tspan.setAttributeNS(null,"y",s(-f.y))}showText(t){const n=this.current,f=n.font,a=n.fontSize;if(a===0)return;const T=n.fontSizeScale,O=n.charSpacing,X=n.wordSpacing,Y=n.fontDirection,_e=n.textHScale*Y,ue=f.vertical,J=ue?1:-1,K=f.defaultVMetrics,$=a*n.fontMatrix[0];let k=0;for(const y of t){if(y===null){k+=Y*X;continue}else if(typeof y=="number"){k+=J*y*a/1e3;continue}const p=(y.isSpace?X:0)+O,g=y.fontChar;let M,W,z=y.width;if(ue){let Q;const ee=y.vmetric||K;Q=y.vmetric?ee[1]:z*.5,Q=-Q*$;const he=ee[2]*$;z=ee?-ee[0]:z,M=Q/T,W=(k+he)/T}else M=k/T,W=0;(y.isInFont||f.missingFile)&&(n.xcoords.push(n.x+M),ue&&n.ycoords.push(-n.y+W),n.tspan.textContent+=g);let U;ue?U=z*$-p*Y:U=z*$+p*Y,k+=U}n.tspan.setAttributeNS(null,"x",n.xcoords.map(s).join(" ")),ue?n.tspan.setAttributeNS(null,"y",n.ycoords.map(s).join(" ")):n.tspan.setAttributeNS(null,"y",s(-n.y)),ue?n.y-=k:n.x+=k*_e,n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",`${s(n.fontSize)}px`),n.fontStyle!==R.fontStyle&&n.tspan.setAttributeNS(null,"font-style",n.fontStyle),n.fontWeight!==R.fontWeight&&n.tspan.setAttributeNS(null,"font-weight",n.fontWeight);const le=n.textRenderingMode&V.TextRenderingMode.FILL_STROKE_MASK;if(le===V.TextRenderingMode.FILL||le===V.TextRenderingMode.FILL_STROKE?(n.fillColor!==R.fillColor&&n.tspan.setAttributeNS(null,"fill",n.fillColor),n.fillAlpha<1&&n.tspan.setAttributeNS(null,"fill-opacity",n.fillAlpha)):n.textRenderingMode===V.TextRenderingMode.ADD_TO_PATH?n.tspan.setAttributeNS(null,"fill","transparent"):n.tspan.setAttributeNS(null,"fill","none"),le===V.TextRenderingMode.STROKE||le===V.TextRenderingMode.FILL_STROKE){const y=1/(n.textMatrixScale||1);this._setStrokeAttributes(n.tspan,y)}let re=n.textMatrix;n.textRise!==0&&(re=re.slice(),re[5]+=n.textRise),n.txtElement.setAttributeNS(null,"transform",`${e(re)} scale(${s(_e)}, -1)`),n.txtElement.setAttributeNS(N,"xml:space","preserve"),n.txtElement.append(n.tspan),n.txtgrp.append(n.txtElement),this._ensureTransformGroup().append(n.txtElement)}setLeadingMoveText(t,n){this.setLeading(-n),this.moveText(t,n)}addFontStyle(t){if(!t.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const n=C(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${t.loadedName}"; src: url(${n}); }
`}setFont(t){const n=this.current,f=this.commonObjs.get(t[0]);let a=t[1];n.font=f,this.embedFonts&&!f.missingFile&&!this.embeddedFonts[f.loadedName]&&(this.addFontStyle(f),this.embeddedFonts[f.loadedName]=f),n.fontMatrix=f.fontMatrix||V.FONT_IDENTITY_MATRIX;let T="normal";f.black?T="900":f.bold&&(T="bold");const O=f.italic?"italic":"normal";a<0?(a=-a,n.fontDirection=-1):n.fontDirection=1,n.fontSize=a,n.fontFamily=f.loadedName,n.fontWeight=T,n.fontStyle=O,n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"y",s(-n.y)),n.xcoords=[],n.ycoords=[]}endText(){var n;const t=this.current;t.textRenderingMode&V.TextRenderingMode.ADD_TO_PATH_FLAG&&((n=t.txtElement)!=null&&n.hasChildNodes())&&(t.element=t.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(t){t>0&&(this.current.lineWidth=t)}setLineCap(t){this.current.lineCap=m[t]}setLineJoin(t){this.current.lineJoin=L[t]}setMiterLimit(t){this.current.miterLimit=t}setStrokeAlpha(t){this.current.strokeAlpha=t}setStrokeRGBColor(t,n,f){this.current.strokeColor=V.Util.makeHexColor(t,n,f)}setFillAlpha(t){this.current.fillAlpha=t}setFillRGBColor(t,n,f){this.current.fillColor=V.Util.makeHexColor(t,n,f),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(t){this.current.strokeColor=this._makeColorN_Pattern(t)}setFillColorN(t){this.current.fillColor=this._makeColorN_Pattern(t)}shadingFill(t){const n=this.viewport.width,f=this.viewport.height,a=V.Util.inverseTransform(this.transformMatrix),T=V.Util.applyTransform([0,0],a),O=V.Util.applyTransform([0,f],a),X=V.Util.applyTransform([n,0],a),Y=V.Util.applyTransform([n,f],a),_e=Math.min(T[0],O[0],X[0],Y[0]),ue=Math.min(T[1],O[1],X[1],Y[1]),J=Math.max(T[0],O[0],X[0],Y[0]),K=Math.max(T[1],O[1],X[1],Y[1]),$=this.svgFactory.createElement("svg:rect");$.setAttributeNS(null,"x",_e),$.setAttributeNS(null,"y",ue),$.setAttributeNS(null,"width",J-_e),$.setAttributeNS(null,"height",K-ue),$.setAttributeNS(null,"fill",this._makeShadingPattern(t)),this.current.fillAlpha<1&&$.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append($)}_makeColorN_Pattern(t){return t[0]==="TilingPattern"?this._makeTilingPattern(t):this._makeShadingPattern(t)}_makeTilingPattern(t){const n=t[1],f=t[2],a=t[3]||V.IDENTITY_MATRIX,[T,O,X,Y]=t[4],_e=t[5],ue=t[6],J=t[7],K=`shading${o++}`,[$,k,le,re]=V.Util.normalizeRect([...V.Util.applyTransform([T,O],a),...V.Util.applyTransform([X,Y],a)]),[y,p]=V.Util.singularValueDecompose2dScale(a),g=_e*y,M=ue*p,W=this.svgFactory.createElement("svg:pattern");W.setAttributeNS(null,"id",K),W.setAttributeNS(null,"patternUnits","userSpaceOnUse"),W.setAttributeNS(null,"width",g),W.setAttributeNS(null,"height",M),W.setAttributeNS(null,"x",`${$}`),W.setAttributeNS(null,"y",`${k}`);const z=this.svg,U=this.transformMatrix,Q=this.current.fillColor,ee=this.current.strokeColor,he=this.svgFactory.create(le-$,re-k);if(this.svg=he,this.transformMatrix=a,J===2){const ie=V.Util.makeHexColor(...n);this.current.fillColor=ie,this.current.strokeColor=ie}return this.executeOpTree(this.convertOpList(f)),this.svg=z,this.transformMatrix=U,this.current.fillColor=Q,this.current.strokeColor=ee,W.append(he.childNodes[0]),this.defs.append(W),`url(#${K})`}_makeShadingPattern(t){switch(typeof t=="string"&&(t=this.objs.get(t)),t[0]){case"RadialAxial":const n=`shading${o++}`,f=t[3];let a;switch(t[1]){case"axial":const T=t[4],O=t[5];a=this.svgFactory.createElement("svg:linearGradient"),a.setAttributeNS(null,"id",n),a.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),a.setAttributeNS(null,"x1",T[0]),a.setAttributeNS(null,"y1",T[1]),a.setAttributeNS(null,"x2",O[0]),a.setAttributeNS(null,"y2",O[1]);break;case"radial":const X=t[4],Y=t[5],_e=t[6],ue=t[7];a=this.svgFactory.createElement("svg:radialGradient"),a.setAttributeNS(null,"id",n),a.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),a.setAttributeNS(null,"cx",Y[0]),a.setAttributeNS(null,"cy",Y[1]),a.setAttributeNS(null,"r",ue),a.setAttributeNS(null,"fx",X[0]),a.setAttributeNS(null,"fy",X[1]),a.setAttributeNS(null,"fr",_e);break;default:throw new Error(`Unknown RadialAxial type: ${t[1]}`)}for(const T of f){const O=this.svgFactory.createElement("svg:stop");O.setAttributeNS(null,"offset",T[0]),O.setAttributeNS(null,"stop-color",T[1]),a.append(O)}return this.defs.append(a),`url(#${n})`;case"Mesh":return(0,V.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${t[0]}`)}}setDash(t,n){this.current.dashArray=t,this.current.dashPhase=n}constructPath(t,n){const f=this.current;let a=f.x,T=f.y,O=[],X=0;for(const Y of t)switch(Y|0){case V.OPS.rectangle:a=n[X++],T=n[X++];const _e=n[X++],ue=n[X++],J=a+_e,K=T+ue;O.push("M",s(a),s(T),"L",s(J),s(T),"L",s(J),s(K),"L",s(a),s(K),"Z");break;case V.OPS.moveTo:a=n[X++],T=n[X++],O.push("M",s(a),s(T));break;case V.OPS.lineTo:a=n[X++],T=n[X++],O.push("L",s(a),s(T));break;case V.OPS.curveTo:a=n[X+4],T=n[X+5],O.push("C",s(n[X]),s(n[X+1]),s(n[X+2]),s(n[X+3]),s(a),s(T)),X+=6;break;case V.OPS.curveTo2:O.push("C",s(a),s(T),s(n[X]),s(n[X+1]),s(n[X+2]),s(n[X+3])),a=n[X+2],T=n[X+3],X+=4;break;case V.OPS.curveTo3:a=n[X+2],T=n[X+3],O.push("C",s(n[X]),s(n[X+1]),s(a),s(T),s(a),s(T)),X+=4;break;case V.OPS.closePath:O.push("Z");break}O=O.join(" "),f.path&&t.length>0&&t[0]!==V.OPS.rectangle&&t[0]!==V.OPS.moveTo?O=f.path.getAttributeNS(null,"d")+O:(f.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(f.path)),f.path.setAttributeNS(null,"d",O),f.path.setAttributeNS(null,"fill","none"),f.element=f.path,f.setCurrentPoint(a,T)}endPath(){const t=this.current;if(t.path=null,!this.pendingClip)return;if(!t.element){this.pendingClip=null;return}const n=`clippath${r++}`,f=this.svgFactory.createElement("svg:clipPath");f.setAttributeNS(null,"id",n),f.setAttributeNS(null,"transform",e(this.transformMatrix));const a=t.element.cloneNode(!0);if(this.pendingClip==="evenodd"?a.setAttributeNS(null,"clip-rule","evenodd"):a.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,f.append(a),this.defs.append(f),t.activeClipUrl){t.clipGroup=null;for(const T of this.extraStack)T.clipGroup=null;f.setAttributeNS(null,"clip-path",t.activeClipUrl)}t.activeClipUrl=`url(#${n})`,this.tgrp=null}clip(t){this.pendingClip=t}closePath(){const t=this.current;if(t.path){const n=`${t.path.getAttributeNS(null,"d")}Z`;t.path.setAttributeNS(null,"d",n)}}setLeading(t){this.current.leading=-t}setTextRise(t){this.current.textRise=t}setTextRenderingMode(t){this.current.textRenderingMode=t}setHScale(t){this.current.textHScale=t/100}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[n,f]of t)switch(n){case"LW":this.setLineWidth(f);break;case"LC":this.setLineCap(f);break;case"LJ":this.setLineJoin(f);break;case"ML":this.setMiterLimit(f);break;case"D":this.setDash(f[0],f[1]);break;case"RI":this.setRenderingIntent(f);break;case"FL":this.setFlatness(f);break;case"Font":this.setFont(f);break;case"CA":this.setStrokeAlpha(f);break;case"ca":this.setFillAlpha(f);break;default:(0,V.warn)(`Unimplemented graphic state operator ${n}`);break}}fill(){const t=this.current;t.element&&(t.element.setAttributeNS(null,"fill",t.fillColor),t.element.setAttributeNS(null,"fill-opacity",t.fillAlpha),this.endPath())}stroke(){const t=this.current;t.element&&(this._setStrokeAttributes(t.element),t.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(t,n=1){const f=this.current;let a=f.dashArray;n!==1&&a.length>0&&(a=a.map(function(T){return n*T})),t.setAttributeNS(null,"stroke",f.strokeColor),t.setAttributeNS(null,"stroke-opacity",f.strokeAlpha),t.setAttributeNS(null,"stroke-miterlimit",s(f.miterLimit)),t.setAttributeNS(null,"stroke-linecap",f.lineCap),t.setAttributeNS(null,"stroke-linejoin",f.lineJoin),t.setAttributeNS(null,"stroke-width",s(n*f.lineWidth)+"px"),t.setAttributeNS(null,"stroke-dasharray",a.map(s).join(" ")),t.setAttributeNS(null,"stroke-dashoffset",s(n*f.dashPhase)+"px")}eoFill(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const t=this.svgFactory.createElement("svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(t)}paintImageXObject(t){const n=this.getObject(t);if(!n){(0,V.warn)(`Dependent image with object ID ${t} is not ready yet`);return}this.paintInlineImageXObject(n)}paintInlineImageXObject(t,n){const f=t.width,a=t.height,T=u(t,this.forceDataSchema,!!n),O=this.svgFactory.createElement("svg:rect");O.setAttributeNS(null,"x","0"),O.setAttributeNS(null,"y","0"),O.setAttributeNS(null,"width",s(f)),O.setAttributeNS(null,"height",s(a)),this.current.element=O,this.clip("nonzero");const X=this.svgFactory.createElement("svg:image");X.setAttributeNS(h,"xlink:href",T),X.setAttributeNS(null,"x","0"),X.setAttributeNS(null,"y",s(-a)),X.setAttributeNS(null,"width",s(f)+"px"),X.setAttributeNS(null,"height",s(a)+"px"),X.setAttributeNS(null,"transform",`scale(${s(1/f)} ${s(-1/a)})`),n?n.append(X):this._ensureTransformGroup().append(X)}paintImageMaskXObject(t){const n=this.getObject(t.data,t);if(n.bitmap){(0,V.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const f=this.current,a=n.width,T=n.height,O=f.fillColor;f.maskId=`mask${c++}`;const X=this.svgFactory.createElement("svg:mask");X.setAttributeNS(null,"id",f.maskId);const Y=this.svgFactory.createElement("svg:rect");Y.setAttributeNS(null,"x","0"),Y.setAttributeNS(null,"y","0"),Y.setAttributeNS(null,"width",s(a)),Y.setAttributeNS(null,"height",s(T)),Y.setAttributeNS(null,"fill",O),Y.setAttributeNS(null,"mask",`url(#${f.maskId})`),this.defs.append(X),this._ensureTransformGroup().append(Y),this.paintInlineImageXObject(n,X)}paintFormXObjectBegin(t,n){if(Array.isArray(t)&&t.length===6&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]),n){const f=n[2]-n[0],a=n[3]-n[1],T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x",n[0]),T.setAttributeNS(null,"y",n[1]),T.setAttributeNS(null,"width",s(f)),T.setAttributeNS(null,"height",s(a)),this.current.element=T,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(t){const n=this.svgFactory.create(t.width,t.height),f=this.svgFactory.createElement("svg:defs");n.append(f),this.defs=f;const a=this.svgFactory.createElement("svg:g");return a.setAttributeNS(null,"transform",e(t.transform)),n.append(a),this.svg=a,n}_ensureClipGroup(){if(!this.current.clipGroup){const t=this.svgFactory.createElement("svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(t),this.current.clipGroup=t}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",e(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(me){var P=__webpack_module_cache__[me];if(P!==void 0)return P.exports;var Z=__webpack_module_cache__[me]={exports:{}};return __webpack_modules__[me](Z,Z.exports,__w_pdfjs_require__),Z.exports}var __webpack_exports__={};return(()=>{var me=__webpack_exports__;Object.defineProperty(me,"__esModule",{value:!0}),Object.defineProperty(me,"AbortException",{enumerable:!0,get:function(){return P.AbortException}}),Object.defineProperty(me,"AnnotationEditorLayer",{enumerable:!0,get:function(){return ne.AnnotationEditorLayer}}),Object.defineProperty(me,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return P.AnnotationEditorParamsType}}),Object.defineProperty(me,"AnnotationEditorType",{enumerable:!0,get:function(){return P.AnnotationEditorType}}),Object.defineProperty(me,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return B.AnnotationEditorUIManager}}),Object.defineProperty(me,"AnnotationLayer",{enumerable:!0,get:function(){return R.AnnotationLayer}}),Object.defineProperty(me,"AnnotationMode",{enumerable:!0,get:function(){return P.AnnotationMode}}),Object.defineProperty(me,"CMapCompressionType",{enumerable:!0,get:function(){return P.CMapCompressionType}}),Object.defineProperty(me,"GlobalWorkerOptions",{enumerable:!0,get:function(){return N.GlobalWorkerOptions}}),Object.defineProperty(me,"InvalidPDFException",{enumerable:!0,get:function(){return P.InvalidPDFException}}),Object.defineProperty(me,"MissingPDFException",{enumerable:!0,get:function(){return P.MissingPDFException}}),Object.defineProperty(me,"OPS",{enumerable:!0,get:function(){return P.OPS}}),Object.defineProperty(me,"PDFDataRangeTransport",{enumerable:!0,get:function(){return Z.PDFDataRangeTransport}}),Object.defineProperty(me,"PDFDateString",{enumerable:!0,get:function(){return x.PDFDateString}}),Object.defineProperty(me,"PDFWorker",{enumerable:!0,get:function(){return Z.PDFWorker}}),Object.defineProperty(me,"PasswordResponses",{enumerable:!0,get:function(){return P.PasswordResponses}}),Object.defineProperty(me,"PermissionFlag",{enumerable:!0,get:function(){return P.PermissionFlag}}),Object.defineProperty(me,"PixelsPerInch",{enumerable:!0,get:function(){return x.PixelsPerInch}}),Object.defineProperty(me,"RenderingCancelledException",{enumerable:!0,get:function(){return x.RenderingCancelledException}}),Object.defineProperty(me,"SVGGraphics",{enumerable:!0,get:function(){return h.SVGGraphics}}),Object.defineProperty(me,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return P.UNSUPPORTED_FEATURES}}),Object.defineProperty(me,"UnexpectedResponseException",{enumerable:!0,get:function(){return P.UnexpectedResponseException}}),Object.defineProperty(me,"Util",{enumerable:!0,get:function(){return P.Util}}),Object.defineProperty(me,"VerbosityLevel",{enumerable:!0,get:function(){return P.VerbosityLevel}}),Object.defineProperty(me,"XfaLayer",{enumerable:!0,get:function(){return m.XfaLayer}}),Object.defineProperty(me,"build",{enumerable:!0,get:function(){return Z.build}}),Object.defineProperty(me,"createPromiseCapability",{enumerable:!0,get:function(){return P.createPromiseCapability}}),Object.defineProperty(me,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return P.createValidAbsoluteUrl}}),Object.defineProperty(me,"getDocument",{enumerable:!0,get:function(){return Z.getDocument}}),Object.defineProperty(me,"getFilenameFromUrl",{enumerable:!0,get:function(){return x.getFilenameFromUrl}}),Object.defineProperty(me,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return x.getPdfFilenameFromUrl}}),Object.defineProperty(me,"getXfaPageViewport",{enumerable:!0,get:function(){return x.getXfaPageViewport}}),Object.defineProperty(me,"isDataScheme",{enumerable:!0,get:function(){return x.isDataScheme}}),Object.defineProperty(me,"isPdfFile",{enumerable:!0,get:function(){return x.isPdfFile}}),Object.defineProperty(me,"loadScript",{enumerable:!0,get:function(){return x.loadScript}}),Object.defineProperty(me,"renderTextLayer",{enumerable:!0,get:function(){return V.renderTextLayer}}),Object.defineProperty(me,"setLayerDimensions",{enumerable:!0,get:function(){return x.setLayerDimensions}}),Object.defineProperty(me,"shadow",{enumerable:!0,get:function(){return P.shadow}}),Object.defineProperty(me,"updateTextLayer",{enumerable:!0,get:function(){return V.updateTextLayer}}),Object.defineProperty(me,"version",{enumerable:!0,get:function(){return Z.version}});var P=__w_pdfjs_require__(1),Z=__w_pdfjs_require__(2),x=__w_pdfjs_require__(6),V=__w_pdfjs_require__(26),ne=__w_pdfjs_require__(27),B=__w_pdfjs_require__(5),R=__w_pdfjs_require__(32),N=__w_pdfjs_require__(14),h=__w_pdfjs_require__(35),m=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports,pdf_viewer={exports:{}};(function(me,P){(function(x,V){me.exports=V()})(globalThis,()=>(()=>{var Z=[,(B,R,N)=>{var d,s,Mt,r,bi;Object.defineProperty(R,"__esModule",{value:!0}),R.SimpleLinkService=R.PDFLinkService=R.LinkTarget=void 0;var h=N(2);const m="noopener noreferrer nofollow",L={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};R.LinkTarget=L;function C(t,{url:n,target:f,rel:a,enabled:T=!0}={}){if(!n||typeof n!="string")throw new Error('A valid "url" parameter must provided.');const O=(0,h.removeNullCharacters)(n);T?t.href=t.title=O:(t.href="",t.title=`Disabled: ${O}`,t.onclick=()=>!1);let X="";switch(f){case L.NONE:break;case L.SELF:X="_self";break;case L.BLANK:X="_blank";break;case L.PARENT:X="_parent";break;case L.TOP:X="_top";break}t.target=X,t.rel=typeof a=="string"?a:m}const o=class o{constructor({eventBus:n,externalLinkTarget:f=null,externalLinkRel:a=null,ignoreDestinationZoom:T=!1}={}){de(this,s);de(this,d,new Map);this.eventBus=n,this.externalLinkTarget=f,this.externalLinkRel=a,this.externalLinkEnabled=!0,this._ignoreDestinationZoom=T,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(n,f=null){this.baseUrl=f,this.pdfDocument=n,E(this,d).clear()}setViewer(n){this.pdfViewer=n}setHistory(n){this.pdfHistory=n}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfViewer.currentPageNumber}set page(n){this.pdfViewer.currentPageNumber=n}get rotation(){return this.pdfViewer.pagesRotation}set rotation(n){this.pdfViewer.pagesRotation=n}get isInPresentationMode(){return this.pdfViewer.isInPresentationMode}async goToDestination(n){if(!this.pdfDocument)return;let f,a;if(typeof n=="string"?(f=n,a=await this.pdfDocument.getDestination(n)):(f=null,a=await n),!Array.isArray(a)){console.error(`PDFLinkService.goToDestination: "${a}" is not a valid destination array, for dest="${n}".`);return}te(this,s,Mt).call(this,n,f,a)}goToPage(n){if(!this.pdfDocument)return;const f=typeof n=="string"&&this.pdfViewer.pageLabelToPageNumber(n)||n|0;if(!(Number.isInteger(f)&&f>0&&f<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${n}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(f)),this.pdfViewer.scrollPageIntoView({pageNumber:f})}addLinkAttributes(n,f,a=!1){C(n,{url:f,target:a?L.BLANK:this.externalLinkTarget,rel:this.externalLinkRel,enabled:this.externalLinkEnabled})}getDestinationHash(n){if(typeof n=="string"){if(n.length>0)return this.getAnchorUrl("#"+escape(n))}else if(Array.isArray(n)){const f=JSON.stringify(n);if(f.length>0)return this.getAnchorUrl("#"+escape(f))}return this.getAnchorUrl("")}getAnchorUrl(n){return(this.baseUrl||"")+n}setHash(n){var T;if(!this.pdfDocument)return;let f,a;if(n.includes("=")){const O=(0,h.parseQueryString)(n);if(O.has("search")&&this.eventBus.dispatch("findfromurlhash",{source:this,query:O.get("search").replace(/"/g,""),phraseSearch:O.get("phrase")==="true"}),O.has("page")&&(f=O.get("page")|0||1),O.has("zoom")){const X=O.get("zoom").split(","),Y=X[0],_e=parseFloat(Y);Y.includes("Fit")?Y==="Fit"||Y==="FitB"?a=[null,{name:Y}]:Y==="FitH"||Y==="FitBH"||Y==="FitV"||Y==="FitBV"?a=[null,{name:Y},X.length>1?X[1]|0:null]:Y==="FitR"?X.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):a=[null,{name:Y},X[1]|0,X[2]|0,X[3]|0,X[4]|0]:console.error(`PDFLinkService.setHash: "${Y}" is not a valid zoom value.`):a=[null,{name:"XYZ"},X.length>1?X[1]|0:null,X.length>2?X[2]|0:null,_e?_e/100:Y]}a?this.pdfViewer.scrollPageIntoView({pageNumber:f||this.page,destArray:a,allowNegativeOffset:!0}):f&&(this.page=f),O.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:O.get("pagemode")}),O.has("nameddest")&&this.goToDestination(O.get("nameddest"))}else{a=unescape(n);try{a=JSON.parse(a),Array.isArray(a)||(a=a.toString())}catch{}if(typeof a=="string"||te(T=o,r,bi).call(T,a)){this.goToDestination(a);return}console.error(`PDFLinkService.setHash: "${unescape(n)}" is not a valid destination.`)}}executeNamedAction(n){var f,a;switch(n){case"GoBack":(f=this.pdfHistory)==null||f.back();break;case"GoForward":(a=this.pdfHistory)==null||a.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break}this.eventBus.dispatch("namedaction",{source:this,action:n})}async executeSetOCGState(n){const f=this.pdfDocument,a=await this.pdfViewer.optionalContentConfigPromise;if(f!==this.pdfDocument)return;let T;for(const O of n.state){switch(O){case"ON":case"OFF":case"Toggle":T=O;continue}switch(T){case"ON":a.setVisibility(O,!0);break;case"OFF":a.setVisibility(O,!1);break;case"Toggle":const X=a.getGroup(O);X&&a.setVisibility(O,!X.visible);break}}this.pdfViewer.optionalContentConfigPromise=Promise.resolve(a)}cachePageRef(n,f){if(!f)return;const a=f.gen===0?`${f.num}R`:`${f.num}R${f.gen}`;E(this,d).set(a,n)}_cachedPageNumber(n){if(!n)return null;const f=n.gen===0?`${n.num}R`:`${n.num}R${n.gen}`;return E(this,d).get(f)||null}isPageVisible(n){return this.pdfViewer.isPageVisible(n)}isPageCached(n){return this.pdfViewer.isPageCached(n)}};d=new WeakMap,s=new WeakSet,Mt=function(n,f=null,a){const T=a[0];let O;if(typeof T=="object"&&T!==null){if(O=this._cachedPageNumber(T),!O){this.pdfDocument.getPageIndex(T).then(X=>{this.cachePageRef(X+1,T),te(this,s,Mt).call(this,n,f,a)}).catch(()=>{console.error(`PDFLinkService.#goToDestinationHelper: "${T}" is not a valid page reference, for dest="${n}".`)});return}}else if(Number.isInteger(T))O=T+1;else{console.error(`PDFLinkService.#goToDestinationHelper: "${T}" is not a valid destination reference, for dest="${n}".`);return}if(!O||O<1||O>this.pagesCount){console.error(`PDFLinkService.#goToDestinationHelper: "${O}" is not a valid page number, for dest="${n}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:f,explicitDest:a,pageNumber:O})),this.pdfViewer.scrollPageIntoView({pageNumber:O,destArray:a,ignoreDestinationZoom:this._ignoreDestinationZoom})},r=new WeakSet,bi=function(n){if(!Array.isArray(n))return!1;const f=n.length;if(f<2)return!1;const a=n[0];if(!(typeof a=="object"&&Number.isInteger(a.num)&&Number.isInteger(a.gen))&&!(Number.isInteger(a)&&a>=0))return!1;const T=n[1];if(!(typeof T=="object"&&typeof T.name=="string"))return!1;let O=!0;switch(T.name){case"XYZ":if(f!==5)return!1;break;case"Fit":case"FitB":return f===2;case"FitH":case"FitBH":case"FitV":case"FitBV":if(f!==3)return!1;break;case"FitR":if(f!==6)return!1;O=!1;break;default:return!1}for(let X=2;X<f;X++){const Y=n[X];if(!(typeof Y=="number"||O&&Y===null))return!1}return!0},de(o,r);let u=o;R.PDFLinkService=u;class l{constructor(){this.externalLinkEnabled=!0}get pagesCount(){return 0}get page(){return 0}set page(n){}get rotation(){return 0}set rotation(n){}get isInPresentationMode(){return!1}async goToDestination(n){}goToPage(n){}addLinkAttributes(n,f,a=!1){C(n,{url:f,enabled:this.externalLinkEnabled})}getDestinationHash(n){return"#"}getAnchorUrl(n){return"#"}setHash(n){}executeNamedAction(n){}executeSetOCGState(n){}cachePageRef(n,f){}isPageVisible(n){return!0}isPageCached(n){return!0}}R.SimpleLinkService=l},(B,R)=>{var A,I,j,G,H;Object.defineProperty(R,"__esModule",{value:!0}),R.animationStarted=R.VERTICAL_PADDING=R.UNKNOWN_SCALE=R.TextLayerMode=R.SpreadMode=R.SidebarView=R.ScrollMode=R.SCROLLBAR_PADDING=R.RenderingStates=R.RendererType=R.ProgressBar=R.PresentationModeState=R.OutputScale=R.MIN_SCALE=R.MAX_SCALE=R.MAX_AUTO_SCALE=R.DEFAULT_SCALE_VALUE=R.DEFAULT_SCALE_DELTA=R.DEFAULT_SCALE=R.AutoPrintRegExp=void 0,R.apiPageLayoutToViewerModes=b,R.apiPageModeToSidebarView=w,R.approximateFraction=$,R.backtrackBeforeAllVisibleElements=re,R.binarySearchFirstItem=K,R.docStyle=void 0,R.getActiveOrFocusedElement=i,R.getPageSizeInches=le,R.getVisibleElements=y,R.isPortraitOrientation=Q,R.isValidRotation=W,R.isValidScrollMode=z,R.isValidSpreadMode=U,R.noContextMenuHandler=p,R.normalizeWheelEventDelta=M,R.normalizeWheelEventDirection=g,R.parseQueryString=Y,R.removeNullCharacters=J,R.roundToDivide=k,R.scrollIntoView=O,R.watchScroll=X;const N="auto";R.DEFAULT_SCALE_VALUE=N;const h=1;R.DEFAULT_SCALE=h;const m=1.1;R.DEFAULT_SCALE_DELTA=m;const L=.1;R.MIN_SCALE=L;const C=10;R.MAX_SCALE=C;const u=0;R.UNKNOWN_SCALE=u;const l=1.25;R.MAX_AUTO_SCALE=l;const d=40;R.SCROLLBAR_PADDING=d;const s=5;R.VERTICAL_PADDING=s;const e={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3};R.RenderingStates=e;const r={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};R.PresentationModeState=r;const c={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4};R.SidebarView=c;const o={CANVAS:"canvas",SVG:"svg"};R.RendererType=o;const t={DISABLE:0,ENABLE:1};R.TextLayerMode=t;const n={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3};R.ScrollMode=n;const f={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};R.SpreadMode=f;const a=/\bprint\s*\(/;R.AutoPrintRegExp=a;class T{constructor(){const F=window.devicePixelRatio||1;this.sx=F,this.sy=F}get scaled(){return this.sx!==1||this.sy!==1}}R.OutputScale=T;function O(S,F,D=!1){let q=S.offsetParent;if(!q){console.error("offsetParent is not set -- cannot scroll");return}let oe=S.offsetTop+S.clientTop,fe=S.offsetLeft+S.clientLeft;for(;q.clientHeight===q.scrollHeight&&q.clientWidth===q.scrollWidth||D&&(q.classList.contains("markedContent")||getComputedStyle(q).overflow==="hidden");)if(oe+=q.offsetTop,fe+=q.offsetLeft,q=q.offsetParent,!q)return;F&&(F.top!==void 0&&(oe+=F.top),F.left!==void 0&&(fe+=F.left,q.scrollLeft=fe)),q.scrollTop=oe}function X(S,F){const D=function(fe){oe||(oe=window.requestAnimationFrame(function(){oe=null;const be=S.scrollLeft,Ae=q.lastX;be!==Ae&&(q.right=be>Ae),q.lastX=be;const ve=S.scrollTop,Pe=q.lastY;ve!==Pe&&(q.down=ve>Pe),q.lastY=ve,F(q)}))},q={right:!0,down:!0,lastX:S.scrollLeft,lastY:S.scrollTop,_eventHandler:D};let oe=null;return S.addEventListener("scroll",D,!0),q}function Y(S){const F=new Map;for(const[D,q]of new URLSearchParams(S))F.set(D.toLowerCase(),q);return F}const _e=/\x00/g,ue=/[\x01-\x1F]/g;function J(S,F=!1){return typeof S!="string"?(console.error("The argument must be a string."),S):(F&&(S=S.replace(ue," ")),S.replace(_e,""))}function K(S,F,D=0){let q=D,oe=S.length-1;if(oe<0||!F(S[oe]))return S.length;if(F(S[q]))return q;for(;q<oe;){const fe=q+oe>>1,ge=S[fe];F(ge)?oe=fe:q=fe+1}return q}function $(S){if(Math.floor(S)===S)return[S,1];const F=1/S,D=8;if(F>D)return[1,D];if(Math.floor(F)===F)return[1,F];const q=S>1?F:S;let oe=0,fe=1,ge=1,be=1;for(;;){const ve=oe+ge,Pe=fe+be;if(Pe>D)break;q<=ve/Pe?(ge=ve,be=Pe):(oe=ve,fe=Pe)}let Ae;return q-oe/fe<ge/be-q?Ae=q===S?[oe,fe]:[fe,oe]:Ae=q===S?[ge,be]:[be,ge],Ae}function k(S,F){const D=S%F;return D===0?S:Math.round(S-D+F)}function le({view:S,userUnit:F,rotate:D}){const[q,oe,fe,ge]=S,be=D%180!==0,Ae=(fe-q)/72*F,ve=(ge-oe)/72*F;return{width:be?ve:Ae,height:be?Ae:ve}}function re(S,F,D){if(S<2)return S;let q=F[S].div,oe=q.offsetTop+q.clientTop;oe>=D&&(q=F[S-1].div,oe=q.offsetTop+q.clientTop);for(let fe=S-2;fe>=0&&(q=F[fe].div,!(q.offsetTop+q.clientTop+q.clientHeight<=oe));--fe)S=fe;return S}function y({scrollEl:S,views:F,sortByVisibility:D=!1,horizontal:q=!1,rtl:oe=!1}){const fe=S.scrollTop,ge=fe+S.clientHeight,be=S.scrollLeft,Ae=be+S.clientWidth;function ve(Ce){const we=Ce.div;return we.offsetTop+we.clientTop+we.clientHeight>fe}function Pe(Ce){const we=Ce.div,Re=we.offsetLeft+we.clientLeft,Ie=Re+we.clientWidth;return oe?Re<Ae:Ie>be}const Ee=[],ce=new Set,se=F.length;let ae=K(F,q?Pe:ve);ae>0&&ae<se&&!q&&(ae=re(ae,F,fe));let ye=q?Ae:-1;for(let Ce=ae;Ce<se;Ce++){const we=F[Ce],Re=we.div,Ie=Re.offsetLeft+Re.clientLeft,Te=Re.offsetTop+Re.clientTop,ke=Re.clientWidth,Me=Re.clientHeight,Oe=Ie+ke,Le=Te+Me;if(ye===-1)Le>=ge&&(ye=Le);else if((q?Ie:Te)>ye)break;if(Le<=fe||Te>=ge||Oe<=be||Ie>=Ae)continue;const Ve=Math.max(0,fe-Te)+Math.max(0,Le-ge),He=Math.max(0,be-Ie)+Math.max(0,Oe-Ae),$e=(Me-Ve)/Me,We=(ke-He)/ke,je=$e*We*100|0;Ee.push({id:we.id,x:Ie,y:Te,view:we,percent:je,widthPercent:We*100|0}),ce.add(we.id)}const Se=Ee[0],xe=Ee.at(-1);return D&&Ee.sort(function(Ce,we){const Re=Ce.percent-we.percent;return Math.abs(Re)>.001?-Re:Ce.id-we.id}),{first:Se,last:xe,views:Ee,ids:ce}}function p(S){S.preventDefault()}function g(S){let F=Math.hypot(S.deltaX,S.deltaY);const D=Math.atan2(S.deltaY,S.deltaX);return-.25*Math.PI<D&&D<.75*Math.PI&&(F=-F),F}function M(S){const F=S.deltaMode;let D=g(S);const q=30,oe=30;return F===WheelEvent.DOM_DELTA_PIXEL?D/=q*oe:F===WheelEvent.DOM_DELTA_LINE&&(D/=oe),D}function W(S){return Number.isInteger(S)&&S%90===0}function z(S){return Number.isInteger(S)&&Object.values(n).includes(S)&&S!==n.UNKNOWN}function U(S){return Number.isInteger(S)&&Object.values(f).includes(S)&&S!==f.UNKNOWN}function Q(S){return S.width<=S.height}const ee=new Promise(function(S){window.requestAnimationFrame(S)});R.animationStarted=ee;const he=document.documentElement.style;R.docStyle=he;function ie(S,F,D){return Math.min(Math.max(S,F),D)}class v{constructor(F){de(this,A,null);de(this,I,null);de(this,j,0);de(this,G,null);de(this,H,!0);pe(this,A,F.classList),pe(this,G,F.style)}get percent(){return E(this,j)}set percent(F){if(pe(this,j,ie(F,0,100)),isNaN(F)){E(this,A).add("indeterminate");return}E(this,A).remove("indeterminate"),E(this,G).setProperty("--progressBar-percent",`${E(this,j)}%`)}setWidth(F){if(!F)return;const q=F.parentNode.offsetWidth-F.offsetWidth;q>0&&E(this,G).setProperty("--progressBar-end-offset",`${q}px`)}setDisableAutoFetch(F=5e3){isNaN(E(this,j))||(E(this,I)&&clearTimeout(E(this,I)),this.show(),pe(this,I,setTimeout(()=>{pe(this,I,null),this.hide()},F)))}hide(){E(this,H)&&(pe(this,H,!1),E(this,A).add("hidden"))}show(){E(this,H)||(pe(this,H,!0),E(this,A).remove("hidden"))}}A=new WeakMap,I=new WeakMap,j=new WeakMap,G=new WeakMap,H=new WeakMap,R.ProgressBar=v;function i(){let S=document,F=S.activeElement||S.querySelector(":focus");for(;F!=null&&F.shadowRoot;)S=F.shadowRoot,F=S.activeElement||S.querySelector(":focus");return F}function b(S){let F=n.VERTICAL,D=f.NONE;switch(S){case"SinglePage":F=n.PAGE;break;case"OneColumn":break;case"TwoPageLeft":F=n.PAGE;case"TwoColumnLeft":D=f.ODD;break;case"TwoPageRight":F=n.PAGE;case"TwoColumnRight":D=f.EVEN;break}return{scrollMode:F,spreadMode:D}}function w(S){switch(S){case"UseNone":return c.NONE;case"UseThumbs":return c.THUMBS;case"UseOutlines":return c.OUTLINE;case"UseAttachments":return c.ATTACHMENTS;case"UseOC":return c.LAYERS}return c.NONE}},(B,R,N)=>{var u,l,d,Rt;Object.defineProperty(R,"__esModule",{value:!0}),R.AnnotationLayerBuilder=void 0;var h=N(4),m=N(5),L=N(2);class C{constructor({pageDiv:r,pdfPage:c,linkService:o,downloadManager:t,annotationStorage:n=null,imageResourcesPath:f="",renderForms:a=!0,l10n:T=m.NullL10n,enableScripting:O=!1,hasJSActionsPromise:X=null,fieldObjectsPromise:Y=null,annotationCanvasMap:_e=null,accessibilityManager:ue=null}){de(this,d);de(this,u,0);de(this,l,null);this.pageDiv=r,this.pdfPage=c,this.linkService=o,this.downloadManager=t,this.imageResourcesPath=f,this.renderForms=a,this.l10n=T,this.annotationStorage=n,this.enableScripting=O,this._hasJSActionsPromise=X||Promise.resolve(!1),this._fieldObjectsPromise=Y||Promise.resolve(null),this._annotationCanvasMap=_e,this._accessibilityManager=ue,this.div=null,this._cancelled=!1,this._eventBus=o.eventBus}async render(r,c="display"){var f;if(this.div){if(this._cancelled||E(this,u)===0)return;h.AnnotationLayer.update({viewport:r.clone({dontFlip:!0}),div:this.div,annotationCanvasMap:this._annotationCanvasMap});return}const[o,t,n]=await Promise.all([this.pdfPage.getAnnotations({intent:c}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(!this._cancelled){if(pe(this,u,o.length),this.div=document.createElement("div"),this.div.className="annotationLayer",this.pageDiv.append(this.div),E(this,u)===0){this.hide();return}h.AnnotationLayer.render({viewport:r.clone({dontFlip:!0}),div:this.div,annotations:o,page:this.pdfPage,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:t,fieldObjects:n,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager}),this.l10n.translate(this.div),this.linkService.isInPresentationMode&&te(this,d,Rt).call(this,L.PresentationModeState.FULLSCREEN),E(this,l)||(pe(this,l,a=>{te(this,d,Rt).call(this,a.state)}),(f=this._eventBus)==null||f._on("presentationmodechanged",E(this,l)))}}cancel(){var r;this._cancelled=!0,E(this,l)&&((r=this._eventBus)==null||r._off("presentationmodechanged",E(this,l)),pe(this,l,null))}hide(){this.div&&(this.div.hidden=!0)}}u=new WeakMap,l=new WeakMap,d=new WeakSet,Rt=function(r){if(!this.div)return;let c=!1;switch(r){case L.PresentationModeState.FULLSCREEN:c=!0;break;case L.PresentationModeState.NORMAL:break;default:return}for(const o of this.div.childNodes)o.hasAttribute("data-internal-link")||(o.inert=c)},R.AnnotationLayerBuilder=C},B=>{let R;typeof window<"u"&&window["pdfjs-dist/build/pdf"]?R=window["pdfjs-dist/build/pdf"]:R=pdfExports,B.exports=R},(B,R)=>{Object.defineProperty(R,"__esModule",{value:!0}),R.NullL10n=void 0,R.fixupLangCode=L,R.getL10nFallback=h;const N={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading:"Loading…",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image"};N.print_progress_percent="{{progress}}%";function h(l,d){switch(l){case"find_match_count":l=`find_match_count[${d.total===1?"one":"other"}]`;break;case"find_match_count_limit":l=`find_match_count_limit[${d.limit===1?"one":"other"}]`;break}return N[l]||""}const m={en:"en-US",es:"es-ES",fy:"fy-NL",ga:"ga-IE",gu:"gu-IN",hi:"hi-IN",hy:"hy-AM",nb:"nb-NO",ne:"ne-NP",nn:"nn-NO",pa:"pa-IN",pt:"pt-PT",sv:"sv-SE",zh:"zh-CN"};function L(l){return m[l==null?void 0:l.toLowerCase()]||l}function C(l,d){return d?l.replace(/\{\{\s*(\w+)\s*\}\}/g,(s,e)=>e in d?d[e]:"{{"+e+"}}"):l}const u={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(l,d=null,s=h(l,d)){return C(s,d)},async translate(l){}};R.NullL10n=u},(B,R,N)=>{var C;Object.defineProperty(R,"__esModule",{value:!0}),R.DownloadManager=void 0;var h=N(4);function m(u,l){const d=document.createElement("a");if(!d.click)throw new Error('DownloadManager: "a.click()" is not supported.');d.href=u,d.target="_parent","download"in d&&(d.download=l),(document.body||document.documentElement).append(d),d.click(),d.remove()}class L{constructor(){de(this,C,new WeakMap)}downloadUrl(l,d){if(!(0,h.createValidAbsoluteUrl)(l,"http://example.com")){console.error(`downloadUrl - not a valid URL: ${l}`);return}m(l+"#pdfjs.action=download",d)}downloadData(l,d,s){const e=URL.createObjectURL(new Blob([l],{type:s}));m(e,d)}openOrDownloadData(l,d,s){const e=(0,h.isPdfFile)(s),r=e?"application/pdf":"";if(e){let c=E(this,C).get(l);c||(c=URL.createObjectURL(new Blob([d],{type:r})),E(this,C).set(l,c));let o;o="?file="+encodeURIComponent(c+"#"+s);try{return window.open(o),!0}catch(t){console.error(`openOrDownloadData: ${t}`),URL.revokeObjectURL(c),E(this,C).delete(l)}}return this.downloadData(d,s,r),!1}download(l,d,s){const e=URL.createObjectURL(l);m(e,s)}}C=new WeakMap,R.DownloadManager=L},(B,R)=>{var C;Object.defineProperty(R,"__esModule",{value:!0}),R.WaitOnType=R.EventBus=R.AutomationEventBus=void 0,R.waitOnEventOrTimeout=h;const N={EVENT:"event",TIMEOUT:"timeout"};R.WaitOnType=N;function h({target:u,name:l,delay:d=0}){return new Promise(function(s,e){if(typeof u!="object"||!(l&&typeof l=="string")||!(Number.isInteger(d)&&d>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");function r(n){u instanceof m?u._off(l,c):u.removeEventListener(l,c),t&&clearTimeout(t),s(n)}const c=r.bind(null,N.EVENT);u instanceof m?u._on(l,c):u.addEventListener(l,c);const o=r.bind(null,N.TIMEOUT),t=setTimeout(o,d)})}class m{constructor(){de(this,C,Object.create(null))}on(l,d,s=null){this._on(l,d,{external:!0,once:s==null?void 0:s.once})}off(l,d,s=null){this._off(l,d,{external:!0,once:s==null?void 0:s.once})}dispatch(l,d){const s=E(this,C)[l];if(!s||s.length===0)return;let e;for(const{listener:r,external:c,once:o}of s.slice(0)){if(o&&this._off(l,r),c){(e||(e=[])).push(r);continue}r(d)}if(e){for(const r of e)r(d);e=null}}_on(l,d,s=null){var r;((r=E(this,C))[l]||(r[l]=[])).push({listener:d,external:(s==null?void 0:s.external)===!0,once:(s==null?void 0:s.once)===!0})}_off(l,d,s=null){const e=E(this,C)[l];if(e){for(let r=0,c=e.length;r<c;r++)if(e[r].listener===d){e.splice(r,1);return}}}}C=new WeakMap,R.EventBus=m;class L extends m{dispatch(l,d){throw new Error("Not implemented: AutomationEventBus.dispatch")}}R.AutomationEventBus=L},(B,R,N)=>{Object.defineProperty(R,"__esModule",{value:!0}),R.GenericL10n=void 0,N(9);var h=N(5);const m=document.webL10n;class L{constructor(u){this._lang=u,this._ready=new Promise((l,d)=>{m.setLanguage((0,h.fixupLangCode)(u),()=>{l(m)})})}async getLanguage(){return(await this._ready).getLanguage()}async getDirection(){return(await this._ready).getDirection()}async get(u,l=null,d=(0,h.getL10nFallback)(u,l)){return(await this._ready).get(u,l,d)}async translate(u){return(await this._ready).translate(u)}}R.GenericL10n=L},()=>{document.webL10n=function(B,R,N){var h={},m="",L="textContent",C="",u={},l="loading",d=!0;function s(){return R.querySelectorAll('link[type="application/l10n"]')}function e(){var J=R.querySelector('script[type="application/l10n"]');return J?JSON.parse(J.innerHTML):null}function r(J){return J?J.querySelectorAll("*[data-l10n-id]"):[]}function c(J){if(!J)return{};var K=J.getAttribute("data-l10n-id"),$=J.getAttribute("data-l10n-args"),k={};if($)try{k=JSON.parse($)}catch{console.warn("could not parse arguments for #"+K)}return{id:K,args:k}}function o(J,K,$){K=K||function(re){},$=$||function(){};var k=new XMLHttpRequest;k.open("GET",J,d),k.overrideMimeType&&k.overrideMimeType("text/plain; charset=utf-8"),k.onreadystatechange=function(){k.readyState==4&&(k.status==200||k.status===0?K(k.responseText):$())},k.onerror=$,k.ontimeout=$;try{k.send(null)}catch{$()}}function t(J,K,$,k){var le=J.replace(/[^\/]*$/,"")||"./";function re(p){return p.lastIndexOf("\\")<0?p:p.replace(/\\\\/g,"\\").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'")}function y(p,g){var M={},W=/^\s*|\s*$/,z=/^\s*#|^\s*$/,U=/^\s*\[(.*)\]\s*$/,Q=/^\s*@import\s+url\((.*)\)\s*$/i,ee=/^([^=\s]*)\s*=\s*(.+)$/;function he(v,i,b){var w=v.replace(W,"").split(/[\r\n]+/),A="*",I=K.split("-",1)[0],j=!1,G="";function H(){for(;;){if(!w.length){b();return}var S=w.shift();if(!z.test(S)){if(i){if(G=U.exec(S),G){A=G[1].toLowerCase(),j=A!=="*"&&A!==K&&A!==I;continue}else if(j)continue;if(G=Q.exec(S),G){ie(le+G[1],H);return}}var F=S.match(ee);F&&F.length==3&&(M[F[1]]=re(F[2]))}}}H()}function ie(v,i){o(v,function(b){he(b,!1,i)},function(){console.warn(v+" not found."),i()})}he(p,!0,function(){g(M)})}o(J,function(p){m+=p,y(p,function(g){for(var M in g){var W,z,U=M.lastIndexOf(".");U>0?(W=M.substring(0,U),z=M.substring(U+1)):(W=M,z=L),h[W]||(h[W]={}),h[W][z]=g[M]}$&&$()})},k)}function n(J,K){J&&(J=J.toLowerCase()),K=K||function(){},f(),C=J;var $=s(),k=$.length;if(k===0){var le=e();if(le&&le.locales&&le.default_locale){if(console.log("using the embedded JSON directory, early way out"),h=le.locales[J],!h){var re=le.default_locale.toLowerCase();for(var y in le.locales)if(y=y.toLowerCase(),y===J){h=le.locales[J];break}else y===re&&(h=le.locales[re])}K()}else console.log("no resource to load, early way out");l="complete";return}var p=null,g=0;p=function(){g++,g>=k&&(K(),l="complete")};function M(U){var Q=U.href;this.load=function(ee,he){t(Q,ee,he,function(){console.warn(Q+" not found."),console.warn('"'+ee+'" resource not found'),C="",he()})}}for(var W=0;W<k;W++){var z=new M($[W]);z.load(J,p)}}function f(){h={},m="",C=""}function a(J){var K={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3};function $(y,p){return p.indexOf(y)!==-1}function k(y,p,g){return p<=y&&y<=g}var le={0:function(y){return"other"},1:function(y){return k(y%100,3,10)?"few":y===0?"zero":k(y%100,11,99)?"many":y==2?"two":y==1?"one":"other"},2:function(y){return y!==0&&y%10===0?"many":y==2?"two":y==1?"one":"other"},3:function(y){return y==1?"one":"other"},4:function(y){return k(y,0,1)?"one":"other"},5:function(y){return k(y,0,2)&&y!=2?"one":"other"},6:function(y){return y===0?"zero":y%10==1&&y%100!=11?"one":"other"},7:function(y){return y==2?"two":y==1?"one":"other"},8:function(y){return k(y,3,6)?"few":k(y,7,10)?"many":y==2?"two":y==1?"one":"other"},9:function(y){return y===0||y!=1&&k(y%100,1,19)?"few":y==1?"one":"other"},10:function(y){return k(y%10,2,9)&&!k(y%100,11,19)?"few":y%10==1&&!k(y%100,11,19)?"one":"other"},11:function(y){return k(y%10,2,4)&&!k(y%100,12,14)?"few":y%10===0||k(y%10,5,9)||k(y%100,11,14)?"many":y%10==1&&y%100!=11?"one":"other"},12:function(y){return k(y,2,4)?"few":y==1?"one":"other"},13:function(y){return k(y%10,2,4)&&!k(y%100,12,14)?"few":y!=1&&k(y%10,0,1)||k(y%10,5,9)||k(y%100,12,14)?"many":y==1?"one":"other"},14:function(y){return k(y%100,3,4)?"few":y%100==2?"two":y%100==1?"one":"other"},15:function(y){return y===0||k(y%100,2,10)?"few":k(y%100,11,19)?"many":y==1?"one":"other"},16:function(y){return y%10==1&&y!=11?"one":"other"},17:function(y){return y==3?"few":y===0?"zero":y==6?"many":y==2?"two":y==1?"one":"other"},18:function(y){return y===0?"zero":k(y,0,2)&&y!==0&&y!=2?"one":"other"},19:function(y){return k(y,2,10)?"few":k(y,0,1)?"one":"other"},20:function(y){return(k(y%10,3,4)||y%10==9)&&!(k(y%100,10,19)||k(y%100,70,79)||k(y%100,90,99))?"few":y%1e6===0&&y!==0?"many":y%10==2&&!$(y%100,[12,72,92])?"two":y%10==1&&!$(y%100,[11,71,91])?"one":"other"},21:function(y){return y===0?"zero":y==1?"one":"other"},22:function(y){return k(y,0,1)||k(y,11,99)?"one":"other"},23:function(y){return k(y%10,1,2)||y%20===0?"one":"other"},24:function(y){return k(y,3,10)||k(y,13,19)?"few":$(y,[2,12])?"two":$(y,[1,11])?"one":"other"}},re=K[J.replace(/-.*$/,"")];return re in le?le[re]:(console.warn("plural form unknown for ["+J+"]"),function(){return"other"})}u.plural=function(J,K,$,k){var le=parseFloat(K);if(isNaN(le)||k!=L)return J;u._pluralRules||(u._pluralRules=a(C));var re="["+u._pluralRules(le)+"]";return le===0&&$+"[zero]"in h?J=h[$+"[zero]"][k]:le==1&&$+"[one]"in h?J=h[$+"[one]"][k]:le==2&&$+"[two]"in h?J=h[$+"[two]"][k]:$+re in h?J=h[$+re][k]:$+"[other]"in h&&(J=h[$+"[other]"][k]),J};function T(J,K,$){var k=h[J];if(!k){if(console.warn("#"+J+" is undefined."),!$)return null;k=$}var le={};for(var re in k){var y=k[re];y=O(y,K,J,re),y=X(y,K,J),le[re]=y}return le}function O(J,K,$,k){var le=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/,re=le.exec(J);if(!re||!re.length)return J;var y=re[1],p=re[2],g;if(K&&p in K?g=K[p]:p in h&&(g=h[p]),y in u){var M=u[y];J=M(J,g,$,k)}return J}function X(J,K,$){var k=/\{\{\s*(.+?)\s*\}\}/g;return J.replace(k,function(le,re){return K&&re in K?K[re]:re in h?h[re]:(console.log("argument {{"+re+"}} for #"+$+" is undefined."),le)})}function Y(J){var K=c(J);if(K.id){var $=T(K.id,K.args);if(!$){console.warn("#"+K.id+" is undefined.");return}if($[L]){if(_e(J)===0)J[L]=$[L];else{for(var k=J.childNodes,le=!1,re=0,y=k.length;re<y;re++)k[re].nodeType===3&&/\S/.test(k[re].nodeValue)&&(le?k[re].nodeValue="":(k[re].nodeValue=$[L],le=!0));if(!le){var p=R.createTextNode($[L]);J.prepend(p)}}delete $[L]}for(var g in $)J[g]=$[g]}}function _e(J){if(J.children)return J.children.length;if(typeof J.childElementCount<"u")return J.childElementCount;for(var K=0,$=0;$<J.childNodes.length;$++)K+=J.nodeType===1?1:0;return K}function ue(J){J=J||R.documentElement;for(var K=r(J),$=K.length,k=0;k<$;k++)Y(K[k]);Y(J)}return{get:function(J,K,$){var k=J.lastIndexOf("."),le=L;k>0&&(le=J.substring(k+1),J=J.substring(0,k));var re;$&&(re={},re[le]=$);var y=T(J,K,re);return y&&le in y?y[le]:"{{"+J+"}}"},getData:function(){return h},getText:function(){return m},getLanguage:function(){return C},setLanguage:function(J,K){n(J,function(){K&&K()})},getDirection:function(){var J=["ar","he","fa","ps","ur"],K=C.split("-",1)[0];return J.indexOf(K)>=0?"rtl":"ltr"},translate:ue,getReadyState:function(){return l},ready:function(J){if(J)l=="complete"||l=="interactive"?B.setTimeout(function(){J()}):R.addEventListener&&R.addEventListener("localized",function K(){R.removeEventListener("localized",K),J()});else return}}}(window,document)},(B,R,N)=>{var K,$,k,yi,kt,Ft,vi,Ai,Si,Lt,Ei,Pi,rt,Qe,Xe,Ci,It,Dt,at,wi,Ot,Nt,Je;Object.defineProperty(R,"__esModule",{value:!0}),R.PDFFindController=R.FindState=void 0;var h=N(2),m=N(4),L=N(11);const C={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3};R.FindState=C;const u=250,l=-50,d=-400,s={"‐":"-","‘":"'","’":"'","‚":"'","‛":"'","“":'"',"”":'"',"„":'"',"‟":'"',"¼":"1/4","½":"1/2","¾":"3/4"},e=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]);let r;const c=new RegExp("\\p{M}+","gu"),o=new RegExp("([.*+?^${}()|[\\]\\\\])|(\\p{P})|(\\s+)|(\\p{M})|(\\p{L})","gu"),t=new RegExp("([^\\p{M}])\\p{M}*$","u"),n=new RegExp("^\\p{M}*([^\\p{M}])","u"),f=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,a=new Map,T="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]",O=new Map;let X=null,Y=null;function _e(G){const H=[];let S;for(;(S=f.exec(G))!==null;){let{index:Ee}=S;for(const ce of S[0]){let se=a.get(ce);se||(se=ce.normalize("NFD").length,a.set(ce,se)),H.push([se,Ee++])}}let F;if(H.length===0&&X)F=X;else if(H.length>0&&Y)F=Y;else{const ae=`([${Object.keys(s).join("")}])|([①-⑳Ⓐ-⓿㉄-㊿㋐-㋾＀-￯])|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|((?:\\p{Ideographic}|[぀-ヿ])\\n)|(\\n)`;H.length===0?F=X=new RegExp(ae+"|(\\u0000)","gum"):F=Y=new RegExp(ae+`|(${T})`,"gum")}const D=[];for(;(S=c.exec(G))!==null;)D.push([S[0].length,S.index]);let q=G.normalize("NFD");const oe=[[0,0]];let fe=0,ge=0,be=0,Ae=0,ve=0,Pe=!1;return q=q.replace(F,(Ee,ce,se,ae,ye,Se,xe,Ce,we)=>{var Re,Ie;if(we-=Ae,ce){const Te=s[ce],ke=Te.length;for(let Me=1;Me<ke;Me++)oe.push([we-be+Me,be-Me]);return be-=ke-1,Te}if(se){let Te=O.get(se);Te||(Te=se.normalize("NFKC"),O.set(se,Te));const ke=Te.length;for(let Me=1;Me<ke;Me++)oe.push([we-be+Me,be-Me]);return be-=ke-1,Te}if(ae){const Te=ae.endsWith(`
`),ke=Te?ae.length-2:ae.length;Pe=!0;let Me=ke;we+ve===((Re=D[fe])==null?void 0:Re[1])&&(Me-=D[fe][0],++fe);for(let Oe=1;Oe<=Me;Oe++)oe.push([we-1-be+Oe,be-Oe]);return be-=Me,Ae+=Me,Te?(we+=ke-1,oe.push([we-be+1,1+be]),be+=1,Ae+=1,ve+=1,ae.slice(0,ke)):ae}if(ye)return oe.push([we-be+1,1+be]),be+=1,Ae+=1,ve+=1,ye.charAt(0);if(Se)return oe.push([we-be+1,be]),Ae+=1,ve+=1,Se.charAt(0);if(xe)return oe.push([we-be+1,be-1]),be-=1,Ae+=1,ve+=1," ";if(we+ve===((Ie=H[ge])==null?void 0:Ie[1])){const Te=H[ge][0]-1;++ge;for(let ke=1;ke<=Te;ke++)oe.push([we-(be-ke),be-ke]);be-=Te,Ae+=Te}return Ce}),oe.push([q.length,be]),[q,oe,Pe]}function ue(G,H,S){if(!G)return[H,S];const F=H,D=H+S;let q=(0,h.binarySearchFirstItem)(G,fe=>fe[0]>=F);G[q][0]>F&&--q;let oe=(0,h.binarySearchFirstItem)(G,fe=>fe[0]>=D,q);return G[oe][0]>D&&--oe,[F+G[q][1],S+G[oe][1]-G[q][1]]}class J{constructor({linkService:H,eventBus:S,updateMatchesCountOnProgress:F=!0}){de(this,k);de(this,K,!0);de(this,$,0);this._linkService=H,this._eventBus=S,pe(this,K,F),te(this,k,kt).call(this),S._on("find",te(this,k,yi).bind(this)),S._on("findbarclose",te(this,k,wi).bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this._state}setDocument(H){this._pdfDocument&&te(this,k,kt).call(this),H&&(this._pdfDocument=H,this._firstPageCapability.resolve())}scrollMatchIntoView({element:H=null,selectedLeft:S=0,pageIndex:F=-1,matchIndex:D=-1}){if(!this._scrollMatches||!H)return;if(D===-1||D!==this._selected.matchIdx)return;if(F===-1||F!==this._selected.pageIdx)return;this._scrollMatches=!1;const q={top:l,left:S+d};(0,h.scrollIntoView)(H,q,!0)}}K=new WeakMap,$=new WeakMap,k=new WeakSet,yi=function(H){if(!H)return;const S=this._pdfDocument,{type:F}=H;(this._state===null||te(this,k,vi).call(this,H))&&(this._dirtyMatch=!0),this._state=H,F!=="highlightallchange"&&te(this,k,Je).call(this,C.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||S&&this._pdfDocument!==S)return;te(this,k,Pi).call(this);const D=!this._highlightMatches,q=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),F?this._dirtyMatch?te(this,k,Xe).call(this):F==="again"?(te(this,k,Xe).call(this),D&&this._state.highlightAll&&te(this,k,Qe).call(this)):F==="highlightallchange"?(q?te(this,k,Xe).call(this):this._highlightMatches=!0,te(this,k,Qe).call(this)):te(this,k,Xe).call(this):this._findTimeout=setTimeout(()=>{te(this,k,Xe).call(this),this._findTimeout=null},u)})},kt=function(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],pe(this,$,0),this._state=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=(0,m.createPromiseCapability)()},Ft=function(){return this._state.query!==this._rawQuery&&(this._rawQuery=this._state.query,[this._normalizedQuery]=_e(this._state.query)),this._normalizedQuery},vi=function(H){if(H.query!==this._state.query)return!0;switch(H.type){case"again":const S=this._selected.pageIdx+1,F=this._linkService;return S>=1&&S<=F.pagesCount&&S!==F.page&&!F.isPageVisible(S);case"highlightallchange":return!1}return!0},Ai=function(H,S,F){let D=H.slice(0,S).match(t);if(D){const q=H.charCodeAt(S),oe=D[1].charCodeAt(0);if((0,L.getCharacterType)(q)===(0,L.getCharacterType)(oe))return!1}if(D=H.slice(S+F).match(n),D){const q=H.charCodeAt(S+F-1),oe=D[1].charCodeAt(0);if((0,L.getCharacterType)(q)===(0,L.getCharacterType)(oe))return!1}return!0},Si=function(H,S,F,D){const q=this._pageMatches[F]=[],oe=this._pageMatchesLength[F]=[];if(!H)return;const fe=this._pageDiffs[F];let ge;for(;(ge=H.exec(D))!==null;){if(S&&!te(this,k,Ai).call(this,D,ge.index,ge[0].length))continue;const[be,Ae]=ue(fe,ge.index,ge[0].length);Ae&&(q.push(be),oe.push(Ae))}},Lt=function(H,S){const{matchDiacritics:F}=this._state;let D=!1;H=H.replace(o,(oe,fe,ge,be,Ae,ve)=>fe?`[ ]*\\${fe}[ ]*`:ge?`[ ]*${ge}[ ]*`:be?"[ ]+":F?Ae||ve:Ae?e.has(Ae.charCodeAt(0))?Ae:"":S?(D=!0,`${ve}\\p{M}*`):ve);const q="[ ]*";return H.endsWith(q)&&(H=H.slice(0,H.length-q.length)),F&&S&&(r||(r=String.fromCharCode(...e)),D=!0,H=`${H}(?=[${r}]|[^\\p{M}]|$)`),[D,H]},Ei=function(H){let S=E(this,k,Ft);if(!S)return;const{caseSensitive:F,entireWord:D,phraseSearch:q}=this._state,oe=this._pageContents[H],fe=this._hasDiacritics[H];let ge=!1;if(q)[ge,S]=te(this,k,Lt).call(this,S,fe);else{const ve=S.match(/\S+/g);ve&&(S=ve.sort().reverse().map(Pe=>{const[Ee,ce]=te(this,k,Lt).call(this,Pe,fe);return ge||(ge=Ee),`(${ce})`}).join("|"))}const be=`g${ge?"u":""}${F?"":"i"}`;S=S?new RegExp(S,be):null,te(this,k,Si).call(this,S,D,H,oe),this._state.highlightAll&&te(this,k,rt).call(this,H),this._resumePageIdx===H&&(this._resumePageIdx=null,te(this,k,It).call(this));const Ae=this._pageMatches[H].length;this._matchesCountTotal+=Ae,E(this,K)?Ae>0&&te(this,k,Nt).call(this):++et(this,$)._===this._linkService.pagesCount&&te(this,k,Nt).call(this)},Pi=function(){if(this._extractTextPromises.length>0)return;let H=Promise.resolve();for(let S=0,F=this._linkService.pagesCount;S<F;S++){const D=(0,m.createPromiseCapability)();this._extractTextPromises[S]=D.promise,H=H.then(()=>this._pdfDocument.getPage(S+1).then(q=>q.getTextContent()).then(q=>{const oe=[];for(const fe of q.items)oe.push(fe.str),fe.hasEOL&&oe.push(`
`);[this._pageContents[S],this._pageDiffs[S],this._hasDiacritics[S]]=_e(oe.join("")),D.resolve()},q=>{console.error(`Unable to get text content for page ${S+1}`,q),this._pageContents[S]="",this._pageDiffs[S]=null,this._hasDiacritics[S]=!1,D.resolve()}))}},rt=function(H){this._scrollMatches&&this._selected.pageIdx===H&&(this._linkService.page=H+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:H})},Qe=function(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})},Xe=function(){const H=this._state.findPrevious,S=this._linkService.page-1,F=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=S,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,pe(this,$,0),this._matchesCountTotal=0,te(this,k,Qe).call(this);for(let q=0;q<F;q++)this._pendingFindMatches.has(q)||(this._pendingFindMatches.add(q),this._extractTextPromises[q].then(()=>{this._pendingFindMatches.delete(q),te(this,k,Ei).call(this,q)}))}if(!E(this,k,Ft)){te(this,k,Je).call(this,C.FOUND);return}if(this._resumePageIdx)return;const D=this._offset;if(this._pagesToSearch=F,D.matchIdx!==null){const q=this._pageMatches[D.pageIdx].length;if(!H&&D.matchIdx+1<q||H&&D.matchIdx>0){D.matchIdx=H?D.matchIdx-1:D.matchIdx+1,te(this,k,at).call(this,!0);return}te(this,k,Dt).call(this,H)}te(this,k,It).call(this)},Ci=function(H){const S=this._offset,F=H.length,D=this._state.findPrevious;return F?(S.matchIdx=D?F-1:0,te(this,k,at).call(this,!0),!0):(te(this,k,Dt).call(this,D),S.wrapped&&(S.matchIdx=null,this._pagesToSearch<0)?(te(this,k,at).call(this,!1),!0):!1)},It=function(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let H=null;do{const S=this._offset.pageIdx;if(H=this._pageMatches[S],!H){this._resumePageIdx=S;break}}while(!te(this,k,Ci).call(this,H))},Dt=function(H){const S=this._offset,F=this._linkService.pagesCount;S.pageIdx=H?S.pageIdx-1:S.pageIdx+1,S.matchIdx=null,this._pagesToSearch--,(S.pageIdx>=F||S.pageIdx<0)&&(S.pageIdx=H?F-1:0,S.wrapped=!0)},at=function(H=!1){let S=C.NOT_FOUND;const F=this._offset.wrapped;if(this._offset.wrapped=!1,H){const D=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,S=F?C.WRAPPED:C.FOUND,D!==-1&&D!==this._selected.pageIdx&&te(this,k,rt).call(this,D)}te(this,k,Je).call(this,S,this._state.findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,te(this,k,rt).call(this,this._selected.pageIdx))},wi=function(H){const S=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||S&&this._pdfDocument!==S||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),te(this,k,Je).call(this,C.FOUND),this._highlightMatches=!1,te(this,k,Qe).call(this))})},Ot=function(){var q;const{pageIdx:H,matchIdx:S}=this._selected;let F=0,D=this._matchesCountTotal;if(S!==-1){for(let oe=0;oe<H;oe++)F+=((q=this._pageMatches[oe])==null?void 0:q.length)||0;F+=S+1}return(F<1||F>D)&&(F=D=0),{current:F,total:D}},Nt=function(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:te(this,k,Ot).call(this)})},Je=function(H,S=!1){var F;!E(this,K)&&(E(this,$)!==this._linkService.pagesCount||H===C.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:H,previous:S,matchesCount:te(this,k,Ot).call(this),rawQuery:((F=this._state)==null?void 0:F.query)??null})},R.PDFFindController=J},(B,R)=>{Object.defineProperty(R,"__esModule",{value:!0}),R.CharacterType=void 0,R.getCharacterType=c;const N={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};R.CharacterType=N;function h(o){return o<11904}function m(o){return(o&65408)===0}function L(o){return o>=97&&o<=122||o>=65&&o<=90}function C(o){return o>=48&&o<=57}function u(o){return o===32||o===9||o===13||o===10}function l(o){return o>=13312&&o<=40959||o>=63744&&o<=64255}function d(o){return o>=12448&&o<=12543}function s(o){return o>=12352&&o<=12447}function e(o){return o>=65376&&o<=65439}function r(o){return(o&65408)===3584}function c(o){return h(o)?m(o)?u(o)?N.SPACE:L(o)||C(o)||o===95?N.ALPHA_LETTER:N.PUNCT:r(o)?N.THAI_LETTER:o===160?N.SPACE:N.ALPHA_LETTER:l(o)?N.HAN_LETTER:d(o)?N.KATAKANA_LETTER:s(o)?N.HIRAGANA_LETTER:e(o)?N.HALFWIDTH_KATAKANA_LETTER:N.ALPHA_LETTER}},(B,R,N)=>{Object.defineProperty(R,"__esModule",{value:!0}),R.PDFHistory=void 0,R.isDestArraysEqual=e,R.isDestHashesEqual=s;var h=N(2),m=N(7);const L=1e3,C=50,u=1e3;function l(){return document.location.hash}class d{constructor({linkService:c,eventBus:o}){this.linkService=c,this.eventBus=o,this._initialized=!1,this._fingerprint="",this.reset(),this._boundEvents=null,this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",t=>{this._isPagesLoaded=!!t.pagesCount},{once:!0})})}initialize({fingerprint:c,resetHistory:o=!1,updateUrl:t=!1}){if(!c||typeof c!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();const n=this._fingerprint!==""&&this._fingerprint!==c;this._fingerprint=c,this._updateUrl=t===!0,this._initialized=!0,this._bindEvents();const f=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=l(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this._isValidState(f,!0)||o){const{hash:T,page:O,rotation:X}=this._parseCurrentHash(!0);if(!T||n||o){this._pushOrReplaceState(null,!0);return}this._pushOrReplaceState({hash:T,page:O,rotation:X},!0);return}const a=f.destination;this._updateInternalState(a,f.uid,!0),a.rotation!==void 0&&(this._initialRotation=a.rotation),a.dest?(this._initialBookmark=JSON.stringify(a.dest),this._destination.page=null):a.hash?this._initialBookmark=a.hash:a.page&&(this._initialBookmark=`page=${a.page}`)}reset(){this._initialized&&(this._pageHide(),this._initialized=!1,this._unbindEvents()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:c=null,explicitDest:o,pageNumber:t}){if(!this._initialized)return;if(c&&typeof c!="string"){console.error(`PDFHistory.push: "${c}" is not a valid namedDest parameter.`);return}else if(Array.isArray(o)){if(!this._isValidPage(t)&&(t!==null||this._destination)){console.error(`PDFHistory.push: "${t}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${o}" is not a valid explicitDest parameter.`);return}const n=c||JSON.stringify(o);if(!n)return;let f=!1;if(this._destination&&(s(this._destination.hash,n)||e(this._destination.dest,o))){if(this._destination.page)return;f=!0}this._popStateInProgress&&!f||(this._pushOrReplaceState({dest:o,hash:n,page:t,rotation:this.linkService.rotation},f),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(c){var o;if(this._initialized){if(!this._isValidPage(c)){console.error(`PDFHistory.pushPage: "${c}" is not a valid page number.`);return}((o=this._destination)==null?void 0:o.page)!==c&&(this._popStateInProgress||(this._pushOrReplaceState({dest:null,hash:`page=${c}`,page:c,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this._tryPushCurrentPosition()}back(){if(!this._initialized||this._popStateInProgress)return;const c=window.history.state;this._isValidState(c)&&c.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const c=window.history.state;this._isValidState(c)&&c.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}_pushOrReplaceState(c,o=!1){const t=o||!this._destination,n={fingerprint:this._fingerprint,uid:t?this._uid:this._uid+1,destination:c};this._updateInternalState(c,n.uid);let f;if(this._updateUrl&&(c!=null&&c.hash)){const a=document.location.href.split("#")[0];a.startsWith("file://")||(f=`${a}#${c.hash}`)}t?window.history.replaceState(n,"",f):window.history.pushState(n,"",f)}_tryPushCurrentPosition(c=!1){if(!this._position)return;let o=this._position;if(c&&(o=Object.assign(Object.create(null),this._position),o.temporary=!0),!this._destination){this._pushOrReplaceState(o);return}if(this._destination.temporary){this._pushOrReplaceState(o,!0);return}if(this._destination.hash===o.hash||!this._destination.page&&this._numPositionUpdates<=C)return;let t=!1;if(this._destination.page>=o.first&&this._destination.page<=o.page){if(this._destination.dest!==void 0||!this._destination.first)return;t=!0}this._pushOrReplaceState(o,t)}_isValidPage(c){return Number.isInteger(c)&&c>0&&c<=this.linkService.pagesCount}_isValidState(c,o=!1){if(!c)return!1;if(c.fingerprint!==this._fingerprint)if(o){if(typeof c.fingerprint!="string"||c.fingerprint.length!==this._fingerprint.length)return!1;const[t]=performance.getEntriesByType("navigation");if((t==null?void 0:t.type)!=="reload")return!1}else return!1;return!(!Number.isInteger(c.uid)||c.uid<0||c.destination===null||typeof c.destination!="object")}_updateInternalState(c,o,t=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),t&&(c!=null&&c.temporary)&&delete c.temporary,this._destination=c,this._uid=o,this._maxUid=Math.max(this._maxUid,o),this._numPositionUpdates=0}_parseCurrentHash(c=!1){const o=unescape(l()).substring(1),t=(0,h.parseQueryString)(o),n=t.get("nameddest")||"";let f=t.get("page")|0;return(!this._isValidPage(f)||c&&n.length>0)&&(f=null),{hash:o,page:f,rotation:this.linkService.rotation}}_updateViewarea({location:c}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:c.pdfOpenParams.substring(1),page:this.linkService.page,first:c.pageNumber,rotation:c.rotation},!this._popStateInProgress&&(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this._tryPushCurrentPosition(!0),this._updateViewareaTimeout=null},u))}_popState({state:c}){const o=l(),t=this._currentHash!==o;if(this._currentHash=o,!c){this._uid++;const{hash:f,page:a,rotation:T}=this._parseCurrentHash();this._pushOrReplaceState({hash:f,page:a,rotation:T},!0);return}if(!this._isValidState(c))return;this._popStateInProgress=!0,t&&(this._blockHashChange++,(0,m.waitOnEventOrTimeout)({target:window,name:"hashchange",delay:L}).then(()=>{this._blockHashChange--}));const n=c.destination;this._updateInternalState(n,c.uid,!0),(0,h.isValidRotation)(n.rotation)&&(this.linkService.rotation=n.rotation),n.dest?this.linkService.goToDestination(n.dest):n.hash?this.linkService.setHash(n.hash):n.page&&(this.linkService.page=n.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}_pageHide(){(!this._destination||this._destination.temporary)&&this._tryPushCurrentPosition()}_bindEvents(){this._boundEvents||(this._boundEvents={updateViewarea:this._updateViewarea.bind(this),popState:this._popState.bind(this),pageHide:this._pageHide.bind(this)},this.eventBus._on("updateviewarea",this._boundEvents.updateViewarea),window.addEventListener("popstate",this._boundEvents.popState),window.addEventListener("pagehide",this._boundEvents.pageHide))}_unbindEvents(){this._boundEvents&&(this.eventBus._off("updateviewarea",this._boundEvents.updateViewarea),window.removeEventListener("popstate",this._boundEvents.popState),window.removeEventListener("pagehide",this._boundEvents.pageHide),this._boundEvents=null)}}R.PDFHistory=d;function s(r,c){return typeof r!="string"||typeof c!="string"?!1:r===c||(0,h.parseQueryString)(r).get("nameddest")===c}function e(r,c){function o(t,n){if(typeof t!=typeof n||Array.isArray(t)||Array.isArray(n))return!1;if(t!==null&&typeof t=="object"&&n!==null){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const f in t)if(!o(t[f],n[f]))return!1;return!0}return t===n||Number.isNaN(t)&&Number.isNaN(n)}if(!(Array.isArray(r)&&Array.isArray(c))||r.length!==c.length)return!1;for(let t=0,n=r.length;t<n;t++)if(!o(r[t],c[t]))return!1;return!0}},(B,R,N)=>{var f,a,T,O,X,Y,ot,Bt,jt,Ut,Vt,Ti,xi;Object.defineProperty(R,"__esModule",{value:!0}),R.PDFPageView=void 0;var h=N(4),m=N(2),L=N(14),C=N(3),u=N(15),l=N(5),d=N(16),s=N(17),e=N(18),r=N(19),c=N(20);const o=u.compatibilityParams.maxCanvasPixels||16777216,t=()=>({annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){const{SimpleLinkService:re}=N(1);return new re}});class n{constructor(y){de(this,Y);de(this,f,h.AnnotationMode.ENABLE_FORMS);de(this,a,null);de(this,T,null);de(this,O,m.RenderingStates.INITIAL);de(this,X,{initialOptionalContent:!0,regularAnnotations:!0});var W;const p=y.container,g=y.defaultViewport;this.id=y.id,this.renderingId="page"+this.id,pe(this,a,y.layerProperties||t),this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=y.scale||m.DEFAULT_SCALE,this.viewport=g,this.pdfPageRotate=g.rotation,this._optionalContentConfigPromise=y.optionalContentConfigPromise||null,this.hasRestrictedScaling=!1,this.textLayerMode=y.textLayerMode??m.TextLayerMode.ENABLE,pe(this,f,y.annotationMode??h.AnnotationMode.ENABLE_FORMS),this.imageResourcesPath=y.imageResourcesPath||"",this.useOnlyCssZoom=y.useOnlyCssZoom||!1,this.isOffscreenCanvasSupported=y.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=y.maxCanvasPixels||o,this.pageColors=y.pageColors||null,this.eventBus=y.eventBus,this.renderingQueue=y.renderingQueue,this.renderer=y.renderer||m.RendererType.CANVAS,this.l10n=y.l10n||l.NullL10n,this.paintTask=null,this.paintedViewportMap=new WeakMap,this.resume=null,this._renderError=null,this._isStandalone=!((W=this.renderingQueue)!=null&&W.hasViewer()),this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null;const M=document.createElement("div");if(M.className="page",M.setAttribute("data-page-number",this.id),M.setAttribute("role","region"),this.l10n.get("page_landmark",{page:this.id}).then(z=>{M.setAttribute("aria-label",z)}),this.div=M,te(this,Y,ot).call(this),p==null||p.append(M),this._isStandalone){p==null||p.style.setProperty("--scale-factor",this.scale*h.PixelsPerInch.PDF_TO_CSS_UNITS);const{optionalContentConfigPromise:z}=y;z&&z.then(U=>{z===this._optionalContentConfigPromise&&(E(this,X).initialOptionalContent=U.hasInitialVisibility)})}}get renderingState(){return E(this,O)}set renderingState(y){var p,g;switch(pe(this,O,y),y){case m.RenderingStates.INITIAL:case m.RenderingStates.PAUSED:(p=this.loadingIconDiv)==null||p.classList.add("notVisible");break;case m.RenderingStates.RUNNING:(g=this.loadingIconDiv)==null||g.classList.remove("notVisible");break;case m.RenderingStates.FINISHED:this.loadingIconDiv&&(this.loadingIconDiv.remove(),delete this.loadingIconDiv);break}}setPdfPage(y){this.pdfPage=y,this.pdfPageRotate=y.rotate;const p=(this.rotation+this.pdfPageRotate)%360;this.viewport=y.getViewport({scale:this.scale*h.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:p}),te(this,Y,ot).call(this),this.reset()}destroy(){var y;this.reset(),(y=this.pdfPage)==null||y.cleanup()}get _textHighlighter(){return(0,h.shadow)(this,"_textHighlighter",new e.TextHighlighter({pageIndex:this.id-1,eventBus:this.eventBus,findController:E(this,a).call(this).findController}))}_resetZoomLayer(y=!1){if(!this.zoomLayer)return;const p=this.zoomLayer.firstChild;this.paintedViewportMap.delete(p),p.width=0,p.height=0,y&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:y=!1,keepAnnotationLayer:p=!1,keepAnnotationEditorLayer:g=!1,keepXfaLayer:M=!1,keepTextLayer:W=!1}={}){var i,b,w,A;this.cancelRendering({keepAnnotationLayer:p,keepAnnotationEditorLayer:g,keepXfaLayer:M,keepTextLayer:W}),this.renderingState=m.RenderingStates.INITIAL;const z=this.div,U=z.childNodes,Q=y&&this.zoomLayer||null,ee=p&&((i=this.annotationLayer)==null?void 0:i.div)||null,he=g&&((b=this.annotationEditorLayer)==null?void 0:b.div)||null,ie=M&&((w=this.xfaLayer)==null?void 0:w.div)||null,v=W&&((A=this.textLayer)==null?void 0:A.div)||null;for(let I=U.length-1;I>=0;I--){const j=U[I];switch(j){case Q:case ee:case he:case ie:case v:case this.loadingIconDiv:continue}j.remove()}z.removeAttribute("data-loaded"),ee&&this.annotationLayer.hide(),he&&this.annotationEditorLayer.hide(),ie&&this.xfaLayer.hide(),v&&this.textLayer.hide(),Q||(this.canvas&&(this.paintedViewportMap.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer()),this.svg&&(this.paintedViewportMap.delete(this.svg),delete this.svg),this.loadingIconDiv||(this.loadingIconDiv=document.createElement("div"),this.loadingIconDiv.className="loadingIcon notVisible",this.loadingIconDiv.setAttribute("role","img"),this.l10n.get("loading").then(I=>{var j;(j=this.loadingIconDiv)==null||j.setAttribute("aria-label",I)}),z.append(this.loadingIconDiv))}update({scale:y=0,rotation:p=null,optionalContentConfigPromise:g=null,drawingDelay:M=-1}){var Q;this.scale=y||this.scale,typeof p=="number"&&(this.rotation=p),g instanceof Promise&&(this._optionalContentConfigPromise=g,g.then(ee=>{g===this._optionalContentConfigPromise&&(E(this,X).initialOptionalContent=ee.hasInitialVisibility)}));const W=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*h.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:W}),te(this,Y,ot).call(this),this._isStandalone&&((Q=this.div.parentNode)==null||Q.style.setProperty("--scale-factor",this.viewport.scale)),this.svg){this.cssTransform({target:this.svg,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!0}),this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});return}let z=!1;if(this.canvas&&this.maxCanvasPixels>0){const ee=this.outputScale;(Math.floor(this.viewport.width)*ee.sx|0)*(Math.floor(this.viewport.height)*ee.sy|0)>this.maxCanvasPixels&&(z=!0)}const U=M>=0&&M<1e3;if(this.canvas){if(U||this.useOnlyCssZoom||this.hasRestrictedScaling&&z){U&&this.renderingState!==m.RenderingStates.FINISHED&&(this.cancelRendering({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:M}),this.renderingState=m.RenderingStates.FINISHED),this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!U,hideTextLayer:U}),this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});return}!this.zoomLayer&&!this.canvas.hidden&&(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0})}cancelRendering({keepAnnotationLayer:y=!1,keepAnnotationEditorLayer:p=!1,keepXfaLayer:g=!1,keepTextLayer:M=!1,cancelExtraDelay:W=0}={}){var z;this.paintTask&&(this.paintTask.cancel(W),this.paintTask=null),this.resume=null,this.textLayer&&(!M||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationLayer&&(!y||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.annotationEditorLayer&&(!p||!this.annotationEditorLayer.div)&&(this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!g||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,(z=this._textHighlighter)==null||z.disable())}cssTransform({target:y,redrawAnnotationLayer:p=!1,redrawAnnotationEditorLayer:g=!1,redrawXfaLayer:M=!1,redrawTextLayer:W=!1,hideTextLayer:z=!1}){if(y instanceof HTMLCanvasElement){if(!y.hasAttribute("zooming")){y.setAttribute("zooming",!0);const{style:Q}=y;Q.width=Q.height=""}}else{const Q=this.div,{width:ee,height:he}=this.viewport;y.style.width=y.parentNode.style.width=Q.style.width=Math.floor(ee)+"px",y.style.height=y.parentNode.style.height=Q.style.height=Math.floor(he)+"px"}const U=this.paintedViewportMap.get(y);if(this.viewport!==U){const Q=this.viewport.rotation-U.rotation,ee=Math.abs(Q);let he=1,ie=1;if(ee===90||ee===270){const{width:v,height:i}=this.viewport;he=i/v,ie=v/i}ee!==0&&(y.style.transform=`rotate(${Q}deg) scale(${he}, ${ie})`)}p&&this.annotationLayer&&te(this,Y,Bt).call(this),g&&this.annotationEditorLayer&&te(this,Y,jt).call(this),M&&this.xfaLayer&&te(this,Y,Ut).call(this),this.textLayer&&(z?this.textLayer.hide():W&&te(this,Y,Vt).call(this))}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(y,p){return this.viewport.convertToPdfPoint(y,p)}draw(){var Q;this.renderingState!==m.RenderingStates.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:y,pdfPage:p}=this;if(!p)return this.renderingState=m.RenderingStates.FINISHED,Promise.reject(new Error("pdfPage is not loaded"));this.renderingState=m.RenderingStates.RUNNING;const g=document.createElement("div");if(g.classList.add("canvasWrapper"),y.append(g),!this.textLayer&&this.textLayerMode!==m.TextLayerMode.DISABLE&&!p.isPureXfa&&(this._accessibilityManager||(this._accessibilityManager=new s.TextAccessibilityManager),this.textLayer=new r.TextLayerBuilder({highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported}),y.append(this.textLayer.div)),!this.annotationLayer&&E(this,f)!==h.AnnotationMode.DISABLE){const{annotationStorage:ee,downloadManager:he,enableScripting:ie,fieldObjectsPromise:v,hasJSActionsPromise:i,linkService:b}=E(this,a).call(this);this._annotationCanvasMap||(this._annotationCanvasMap=new Map),this.annotationLayer=new C.AnnotationLayerBuilder({pageDiv:y,pdfPage:p,annotationStorage:ee,imageResourcesPath:this.imageResourcesPath,renderForms:E(this,f)===h.AnnotationMode.ENABLE_FORMS,linkService:b,downloadManager:he,l10n:this.l10n,enableScripting:ie,hasJSActionsPromise:i,fieldObjectsPromise:v,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager})}(Q=this.xfaLayer)!=null&&Q.div&&y.append(this.xfaLayer.div);let M=null;this.renderingQueue&&(M=ee=>{if(!this.renderingQueue.isHighestPriority(this)){this.renderingState=m.RenderingStates.PAUSED,this.resume=()=>{this.renderingState=m.RenderingStates.RUNNING,ee()};return}ee()});const W=async(ee=null)=>{if(z===this.paintTask&&(this.paintTask=null),ee instanceof h.RenderingCancelledException){this._renderError=null;return}if(this._renderError=ee,this.renderingState=m.RenderingStates.FINISHED,this._resetZoomLayer(!0),E(this,X).regularAnnotations=!z.separateAnnots,this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this._renderError}),ee)throw ee},z=this.renderer===m.RendererType.SVG?this.paintOnSvg(g):this.paintOnCanvas(g);z.onRenderContinue=M,this.paintTask=z;const U=z.promise.then(()=>W(null).then(async()=>{if(te(this,Y,Vt).call(this),this.annotationLayer&&await te(this,Y,Bt).call(this),!this.annotationEditorLayer){const{annotationEditorUIManager:ee}=E(this,a).call(this);if(!ee)return;this.annotationEditorLayer=new L.AnnotationEditorLayerBuilder({uiManager:ee,pageDiv:y,pdfPage:p,l10n:this.l10n,accessibilityManager:this._accessibilityManager})}te(this,Y,jt).call(this)}),function(ee){return W(ee)});if(p.isPureXfa){if(!this.xfaLayer){const{annotationStorage:ee,linkService:he}=E(this,a).call(this);this.xfaLayer=new c.XfaLayerBuilder({pageDiv:y,pdfPage:p,annotationStorage:ee,linkService:he})}te(this,Y,Ut).call(this)}return y.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),U}paintOnCanvas(y){const p=(0,h.createPromiseCapability)(),g={promise:p.promise,onRenderContinue(j){j()},cancel(j=0){I.cancel(j)},get separateAnnots(){return I.separateAnnots}},M=this.viewport,{width:W,height:z}=M,U=document.createElement("canvas");U.setAttribute("role","presentation"),U.hidden=!0;let Q=!0;const ee=function(){Q&&(U.hidden=!1,Q=!1)};y.append(U),this.canvas=U;const he=U.getContext("2d",{alpha:!1}),ie=this.outputScale=new m.OutputScale;if(this.useOnlyCssZoom){const j=M.clone({scale:h.PixelsPerInch.PDF_TO_CSS_UNITS});ie.sx*=j.width/W,ie.sy*=j.height/z}if(this.maxCanvasPixels>0){const j=W*z,G=Math.sqrt(this.maxCanvasPixels/j);ie.sx>G||ie.sy>G?(ie.sx=G,ie.sy=G,this.hasRestrictedScaling=!0):this.hasRestrictedScaling=!1}const v=(0,m.approximateFraction)(ie.sx),i=(0,m.approximateFraction)(ie.sy);U.width=(0,m.roundToDivide)(M.width*ie.sx,v[0]),U.height=(0,m.roundToDivide)(M.height*ie.sy,i[0]);const{style:b}=U;b.width=(0,m.roundToDivide)(M.width,v[1])+"px",b.height=(0,m.roundToDivide)(M.height,i[1])+"px",this.paintedViewportMap.set(U,M);const w=ie.scaled?[ie.sx,0,0,ie.sy,0,0]:null,A={canvasContext:he,transform:w,viewport:M,annotationMode:E(this,f),optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:this.pageColors},I=this.pdfPage.render(A);return I.onContinue=function(j){ee(),g.onRenderContinue?g.onRenderContinue(j):j()},I.promise.then(function(){ee(),p.resolve()},function(j){j instanceof h.RenderingCancelledException||ee(),p.reject(j)}),g}paintOnSvg(y){let p=!1;const g=()=>{if(p)throw new h.RenderingCancelledException(`Rendering cancelled, page ${this.id}`,"svg")},M=this.pdfPage,W=this.viewport.clone({scale:h.PixelsPerInch.PDF_TO_CSS_UNITS});return{promise:M.getOperatorList({annotationMode:E(this,f)}).then(U=>(g(),new h.SVGGraphics(M.commonObjs,M.objs).getSVG(U,W).then(ee=>{g(),this.svg=ee,this.paintedViewportMap.set(ee,W),ee.style.width=y.style.width,ee.style.height=y.style.height,this.renderingState=m.RenderingStates.FINISHED,y.append(ee)}))),onRenderContinue(U){U()},cancel(){p=!0},get separateAnnots(){return!1}}}setPageLabel(y){this.pageLabel=typeof y=="string"?y:null,this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){const{initialOptionalContent:y,regularAnnotations:p}=E(this,X);return y&&p?this.canvas:null}}f=new WeakMap,a=new WeakMap,T=new WeakMap,O=new WeakMap,X=new WeakMap,Y=new WeakSet,ot=function(){const{viewport:y}=this;if(this.pdfPage){if(E(this,T)===y.rotation)return;pe(this,T,y.rotation)}(0,h.setLayerDimensions)(this.div,y,!0,!1)},Bt=async function(){let y=null;try{await this.annotationLayer.render(this.viewport,"display")}catch(p){console.error(`#renderAnnotationLayer: "${p}".`),y=p}finally{this.eventBus.dispatch("annotationlayerrendered",{source:this,pageNumber:this.id,error:y})}},jt=async function(){let y=null;try{await this.annotationEditorLayer.render(this.viewport,"display")}catch(p){console.error(`#renderAnnotationEditorLayer: "${p}".`),y=p}finally{this.eventBus.dispatch("annotationeditorlayerrendered",{source:this,pageNumber:this.id,error:y})}},Ut=async function(){let y=null;try{const p=await this.xfaLayer.render(this.viewport,"display");p!=null&&p.textDivs&&this._textHighlighter&&te(this,Y,xi).call(this,p.textDivs)}catch(p){console.error(`#renderXfaLayer: "${p}".`),y=p}finally{this.eventBus.dispatch("xfalayerrendered",{source:this,pageNumber:this.id,error:y})}},Vt=async function(){const{pdfPage:y,textLayer:p,viewport:g}=this;if(!p)return;let M=null;try{if(!p.renderingDone){const W=y.streamTextContent({includeMarkedContent:!0});p.setTextContentSource(W)}await p.render(g)}catch(W){if(W instanceof h.AbortException)return;console.error(`#renderTextLayer: "${W}".`),M=W}this.eventBus.dispatch("textlayerrendered",{source:this,pageNumber:this.id,numTextDivs:p.numTextDivs,error:M}),te(this,Y,Ti).call(this)},Ti=async function(){var g,M;if(!this.textLayer)return;this.structTreeLayer||(this.structTreeLayer=new d.StructTreeLayerBuilder);const y=await(this.structTreeLayer.renderingDone?null:this.pdfPage.getStructTree()),p=(g=this.structTreeLayer)==null?void 0:g.render(y);p&&((M=this.canvas)==null||M.append(p))},xi=async function(y){const p=await this.pdfPage.getTextContent(),g=[];for(const M of p.items)g.push(M.str);this._textHighlighter.setTextMapping(y,g),this._textHighlighter.enable()},R.PDFPageView=n},(B,R,N)=>{var C;Object.defineProperty(R,"__esModule",{value:!0}),R.AnnotationEditorLayerBuilder=void 0;var h=N(4),m=N(5);class L{constructor(l){de(this,C);this.pageDiv=l.pageDiv,this.pdfPage=l.pdfPage,this.accessibilityManager=l.accessibilityManager,this.l10n=l.l10n||m.NullL10n,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,pe(this,C,l.uiManager)}async render(l,d="display"){if(d!=="display"||this._cancelled)return;const s=l.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:s}),this.show();return}const e=this.div=document.createElement("div");e.className="annotationEditorLayer",e.tabIndex=0,this.pageDiv.append(e),this.annotationEditorLayer=new h.AnnotationEditorLayer({uiManager:E(this,C),div:e,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:s});const r={viewport:s,div:e,annotations:null,intent:d};this.annotationEditorLayer.render(r)}cancel(){this._cancelled=!0,this.div&&(this.pageDiv=null,this.annotationEditorLayer.destroy(),this.div.remove())}hide(){this.div&&(this.div.hidden=!0)}show(){this.div&&(this.div.hidden=!1)}}C=new WeakMap,R.AnnotationEditorLayerBuilder=L},(B,R)=>{Object.defineProperty(R,"__esModule",{value:!0}),R.compatibilityParams=R.OptionKind=R.AppOptions=void 0;const N=Object.create(null);R.compatibilityParams=N;{const u=navigator.userAgent||"",l=navigator.platform||"",d=navigator.maxTouchPoints||1,s=/Android/.test(u),e=/\b(iPad|iPhone|iPod)(?=;)/.test(u)||l==="MacIntel"&&d>1;(function(){(e||s)&&(N.maxCanvasPixels=5242880)})()}const h={VIEWER:2,API:4,WORKER:8,PREFERENCE:128};R.OptionKind=h;const m={annotationEditorMode:{value:0,kind:h.VIEWER+h.PREFERENCE},annotationMode:{value:2,kind:h.VIEWER+h.PREFERENCE},cursorToolOnLoad:{value:0,kind:h.VIEWER+h.PREFERENCE},defaultZoomDelay:{value:400,kind:h.VIEWER+h.PREFERENCE},defaultZoomValue:{value:"",kind:h.VIEWER+h.PREFERENCE},disableHistory:{value:!1,kind:h.VIEWER},disablePageLabels:{value:!1,kind:h.VIEWER+h.PREFERENCE},enablePermissions:{value:!1,kind:h.VIEWER+h.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:h.VIEWER+h.PREFERENCE},enableScripting:{value:!0,kind:h.VIEWER+h.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:h.VIEWER},externalLinkTarget:{value:0,kind:h.VIEWER+h.PREFERENCE},historyUpdateUrl:{value:!1,kind:h.VIEWER+h.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:h.VIEWER+h.PREFERENCE},imageResourcesPath:{value:"./images/",kind:h.VIEWER},maxCanvasPixels:{value:16777216,kind:h.VIEWER},forcePageColors:{value:!1,kind:h.VIEWER+h.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:h.VIEWER+h.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:h.VIEWER+h.PREFERENCE},pdfBugEnabled:{value:!1,kind:h.VIEWER+h.PREFERENCE},printResolution:{value:150,kind:h.VIEWER},sidebarViewOnLoad:{value:-1,kind:h.VIEWER+h.PREFERENCE},scrollModeOnLoad:{value:-1,kind:h.VIEWER+h.PREFERENCE},spreadModeOnLoad:{value:-1,kind:h.VIEWER+h.PREFERENCE},textLayerMode:{value:1,kind:h.VIEWER+h.PREFERENCE},useOnlyCssZoom:{value:!1,kind:h.VIEWER+h.PREFERENCE},viewerCssTheme:{value:0,kind:h.VIEWER+h.PREFERENCE},viewOnLoad:{value:0,kind:h.VIEWER+h.PREFERENCE},cMapPacked:{value:!0,kind:h.API},cMapUrl:{value:"../web/cmaps/",kind:h.API},disableAutoFetch:{value:!1,kind:h.API+h.PREFERENCE},disableFontFace:{value:!1,kind:h.API+h.PREFERENCE},disableRange:{value:!1,kind:h.API+h.PREFERENCE},disableStream:{value:!1,kind:h.API+h.PREFERENCE},docBaseUrl:{value:"",kind:h.API},enableXfa:{value:!0,kind:h.API+h.PREFERENCE},fontExtraProperties:{value:!1,kind:h.API},isEvalSupported:{value:!0,kind:h.API},isOffscreenCanvasSupported:{value:!0,kind:h.API},maxImageSize:{value:-1,kind:h.API},pdfBug:{value:!1,kind:h.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:h.API},verbosity:{value:1,kind:h.API},workerPort:{value:null,kind:h.WORKER},workerSrc:{value:"../build/pdf.worker.js",kind:h.WORKER}};m.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:h.VIEWER},m.disablePreferences={value:!1,kind:h.VIEWER},m.locale={value:navigator.language||"en-US",kind:h.VIEWER},m.renderer={value:"canvas",kind:h.VIEWER+h.PREFERENCE},m.sandboxBundleSrc={value:"../build/pdf.sandbox.js",kind:h.VIEWER};const L=Object.create(null);class C{constructor(){throw new Error("Cannot initialize AppOptions.")}static get(l){const d=L[l];if(d!==void 0)return d;const s=m[l];if(s!==void 0)return N[l]??s.value}static getAll(l=null){const d=Object.create(null);for(const s in m){const e=m[s];if(l){if(!(l&e.kind))continue;if(l===h.PREFERENCE){const c=e.value,o=typeof c;if(o==="boolean"||o==="string"||o==="number"&&Number.isInteger(c)){d[s]=c;continue}throw new Error(`Invalid type for preference: ${s}`)}}const r=L[s];d[s]=r!==void 0?r:N[s]??e.value}return d}static set(l,d){L[l]=d}static setAll(l){for(const d in l)L[d]=l[d]}static remove(l){delete L[l]}static _hasUserOptions(){return Object.keys(L).length>0}}R.AppOptions=C},(B,R)=>{var L,C,Ht,Wt;Object.defineProperty(R,"__esModule",{value:!0}),R.StructTreeLayerBuilder=void 0;const N={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},h=/^H(\d+)$/;class m{constructor(){de(this,C);de(this,L)}get renderingDone(){return E(this,L)!==void 0}render(s){if(E(this,L)!==void 0)return E(this,L);const e=te(this,C,Wt).call(this,s);return e==null||e.classList.add("structTree"),pe(this,L,e)}}L=new WeakMap,C=new WeakSet,Ht=function(s,e){s.alt!==void 0&&e.setAttribute("aria-label",s.alt),s.id!==void 0&&e.setAttribute("aria-owns",s.id),s.lang!==void 0&&e.setAttribute("lang",s.lang)},Wt=function(s){if(!s)return null;const e=document.createElement("span");if("role"in s){const{role:r}=s,c=r.match(h);c?(e.setAttribute("role","heading"),e.setAttribute("aria-level",c[1])):N[r]&&e.setAttribute("role",N[r])}if(te(this,C,Ht).call(this,s,e),s.children)if(s.children.length===1&&"id"in s.children[0])te(this,C,Ht).call(this,s.children[0],e);else for(const r of s.children)e.append(te(this,C,Wt).call(this,r));return e},R.StructTreeLayerBuilder=m},(B,R,N)=>{var L,C,u,l,d,lt,e,Gt;Object.defineProperty(R,"__esModule",{value:!0}),R.TextAccessibilityManager=void 0;var h=N(2);const c=class c{constructor(){de(this,e);de(this,L,!1);de(this,C,null);de(this,u,new Map);de(this,l,new Map)}setTextMapping(t){pe(this,C,t)}enable(){if(E(this,L))throw new Error("TextAccessibilityManager is already enabled.");if(!E(this,C))throw new Error("Text divs and strings have not been set.");if(pe(this,L,!0),pe(this,C,E(this,C).slice()),E(this,C).sort(te(c,d,lt)),E(this,u).size>0){const t=E(this,C);for(const[n,f]of E(this,u)){if(!document.getElementById(n)){E(this,u).delete(n);continue}te(this,e,Gt).call(this,n,t[f])}}for(const[t,n]of E(this,l))this.addPointerInTextLayer(t,n);E(this,l).clear()}disable(){E(this,L)&&(E(this,l).clear(),pe(this,C,null),pe(this,L,!1))}removePointerInTextLayer(t){if(!E(this,L)){E(this,l).delete(t);return}const n=E(this,C);if(!n||n.length===0)return;const{id:f}=t,a=E(this,u).get(f);if(a===void 0)return;const T=n[a];E(this,u).delete(f);let O=T.getAttribute("aria-owns");O!=null&&O.includes(f)&&(O=O.split(" ").filter(X=>X!==f).join(" "),O?T.setAttribute("aria-owns",O):(T.removeAttribute("aria-owns"),T.setAttribute("role","presentation")))}addPointerInTextLayer(t,n){const{id:f}=t;if(!f)return;if(!E(this,L)){E(this,l).set(t,n);return}n&&this.removePointerInTextLayer(t);const a=E(this,C);if(!a||a.length===0)return;const T=(0,h.binarySearchFirstItem)(a,X=>{var Y;return te(Y=c,d,lt).call(Y,t,X)<0}),O=Math.max(0,T-1);te(this,e,Gt).call(this,f,a[O]),E(this,u).set(f,O)}moveElementInDOM(t,n,f,a){if(this.addPointerInTextLayer(f,a),!t.hasChildNodes()){t.append(n);return}const T=Array.from(t.childNodes).filter(Y=>Y!==n);if(T.length===0)return;const O=f||n,X=(0,h.binarySearchFirstItem)(T,Y=>{var _e;return te(_e=c,d,lt).call(_e,O,Y)<0});X===0?T[0].before(n):T[X-1].after(n)}};L=new WeakMap,C=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakSet,lt=function(t,n){const f=t.getBoundingClientRect(),a=n.getBoundingClientRect();if(f.width===0&&f.height===0)return 1;if(a.width===0&&a.height===0)return-1;const T=f.y,O=f.y+f.height,X=f.y+f.height/2,Y=a.y,_e=a.y+a.height,ue=a.y+a.height/2;if(X<=Y&&ue>=O)return-1;if(ue<=T&&X>=_e)return 1;const J=f.x+f.width/2,K=a.x+a.width/2;return J-K},e=new WeakSet,Gt=function(t,n){const f=n.getAttribute("aria-owns");f!=null&&f.includes(t)||n.setAttribute("aria-owns",f?`${f} ${t}`:t),n.removeAttribute("role")},de(c,d);let m=c;R.TextAccessibilityManager=m},(B,R)=>{Object.defineProperty(R,"__esModule",{value:!0}),R.TextHighlighter=void 0;class N{constructor({findController:m,eventBus:L,pageIndex:C}){this.findController=m,this.matches=[],this.eventBus=L,this.pageIdx=C,this._onUpdateTextLayerMatches=null,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(m,L){this.textDivs=m,this.textContentItemsStr=L}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this._onUpdateTextLayerMatches||(this._onUpdateTextLayerMatches=m=>{(m.pageIndex===this.pageIdx||m.pageIndex===-1)&&this._updateMatches()},this.eventBus._on("updatetextlayermatches",this._onUpdateTextLayerMatches)),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this._onUpdateTextLayerMatches&&(this.eventBus._off("updatetextlayermatches",this._onUpdateTextLayerMatches),this._onUpdateTextLayerMatches=null),this._updateMatches(!0))}_convertMatches(m,L){if(!m)return[];const{textContentItemsStr:C}=this;let u=0,l=0;const d=C.length-1,s=[];for(let e=0,r=m.length;e<r;e++){let c=m[e];for(;u!==d&&c>=l+C[u].length;)l+=C[u].length,u++;u===C.length&&console.error("Could not find a matching mapping");const o={begin:{divIdx:u,offset:c-l}};for(c+=L[e];u!==d&&c>l+C[u].length;)l+=C[u].length,u++;o.end={divIdx:u,offset:c-l},s.push(o)}return s}_renderMatches(m){if(m.length===0)return;const{findController:L,pageIdx:C}=this,{textContentItemsStr:u,textDivs:l}=this,d=C===L.selected.pageIdx,s=L.selected.matchIdx,e=L.state.highlightAll;let r=null;const c={divIdx:-1,offset:void 0};function o(a,T){const O=a.divIdx;return l[O].textContent="",t(O,0,a.offset,T)}function t(a,T,O,X){let Y=l[a];if(Y.nodeType===Node.TEXT_NODE){const J=document.createElement("span");Y.before(J),J.append(Y),l[a]=J,Y=J}const _e=u[a].substring(T,O),ue=document.createTextNode(_e);if(X){const J=document.createElement("span");return J.className=`${X} appended`,J.append(ue),Y.append(J),X.includes("selected")?J.offsetLeft:0}return Y.append(ue),0}let n=s,f=n+1;if(e)n=0,f=m.length;else if(!d)return;for(let a=n;a<f;a++){const T=m[a],O=T.begin,X=T.end,Y=d&&a===s,_e=Y?" selected":"";let ue=0;if(!r||O.divIdx!==r.divIdx?(r!==null&&t(r.divIdx,r.offset,c.offset),o(O)):t(r.divIdx,r.offset,O.offset),O.divIdx===X.divIdx)ue=t(O.divIdx,O.offset,X.offset,"highlight"+_e);else{ue=t(O.divIdx,O.offset,c.offset,"highlight begin"+_e);for(let J=O.divIdx+1,K=X.divIdx;J<K;J++)l[J].className="highlight middle"+_e;o(X,"highlight end"+_e)}r=X,Y&&L.scrollMatchIntoView({element:l[O.divIdx],selectedLeft:ue,pageIndex:C,matchIndex:s})}r&&t(r.divIdx,r.offset,c.offset)}_updateMatches(m=!1){if(!this.enabled&&!m)return;const{findController:L,matches:C,pageIdx:u}=this,{textContentItemsStr:l,textDivs:d}=this;let s=-1;for(const c of C){const o=Math.max(s,c.begin.divIdx);for(let t=o,n=c.end.divIdx;t<=n;t++){const f=d[t];f.textContent=l[t],f.className=""}s=c.end.divIdx+1}if(!(L!=null&&L.highlightMatches)||m)return;const e=L.pageMatches[u]||null,r=L.pageMatchesLength[u]||null;this.matches=this._convertMatches(e,r),this._renderMatches(this.matches)}}R.TextHighlighter=N},(B,R,N)=>{var L,C,u,l,Mi,Ri;Object.defineProperty(R,"__esModule",{value:!0}),R.TextLayerBuilder=void 0;var h=N(4);class m{constructor({highlighter:r=null,accessibilityManager:c=null,isOffscreenCanvasSupported:o=!0}){de(this,l);de(this,L,0);de(this,C,0);de(this,u,null);this.textContentItemsStr=[],this.renderingDone=!1,this.textDivs=[],this.textDivProperties=new WeakMap,this.textLayerRenderTask=null,this.highlighter=r,this.accessibilityManager=c,this.isOffscreenCanvasSupported=o,this.div=document.createElement("div"),this.div.className="textLayer",this.hide()}get numTextDivs(){return this.textDivs.length}async render(r){var t,n,f;if(!E(this,u))throw new Error('No "textContentSource" parameter specified.');const c=r.scale*(globalThis.devicePixelRatio||1),{rotation:o}=r;if(this.renderingDone){const a=o!==E(this,L),T=c!==E(this,C);(a||T)&&(this.hide(),(0,h.updateTextLayer)({container:this.div,viewport:r,textDivs:this.textDivs,textDivProperties:this.textDivProperties,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,mustRescale:T,mustRotate:a}),pe(this,C,c),pe(this,L,o)),this.show();return}this.cancel(),(t=this.highlighter)==null||t.setTextMapping(this.textDivs,this.textContentItemsStr),(n=this.accessibilityManager)==null||n.setTextMapping(this.textDivs),this.textLayerRenderTask=(0,h.renderTextLayer)({textContentSource:E(this,u),container:this.div,viewport:r,textDivs:this.textDivs,textDivProperties:this.textDivProperties,textContentItemsStr:this.textContentItemsStr,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported}),await this.textLayerRenderTask.promise,te(this,l,Mi).call(this),pe(this,C,c),pe(this,L,o),this.show(),(f=this.accessibilityManager)==null||f.enable()}hide(){var r;this.div.hidden||((r=this.highlighter)==null||r.disable(),this.div.hidden=!0)}show(){var r;this.div.hidden&&this.renderingDone&&(this.div.hidden=!1,(r=this.highlighter)==null||r.enable())}cancel(){var r,c;this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),(r=this.highlighter)==null||r.disable(),(c=this.accessibilityManager)==null||c.disable(),this.textContentItemsStr.length=0,this.textDivs.length=0,this.textDivProperties=new WeakMap}setTextContentSource(r){this.cancel(),pe(this,u,r)}}L=new WeakMap,C=new WeakMap,u=new WeakMap,l=new WeakSet,Mi=function(){this.renderingDone=!0;const r=document.createElement("div");r.className="endOfContent",this.div.append(r),te(this,l,Ri).call(this)},Ri=function(){const{div:r}=this;r.addEventListener("mousedown",c=>{const o=r.querySelector(".endOfContent");if(!o)return;let t=c.target!==r;if(t&&(t=getComputedStyle(o).getPropertyValue("-moz-user-select")!=="none"),t){const n=r.getBoundingClientRect(),f=Math.max(0,(c.pageY-n.top)/n.height);o.style.top=(f*100).toFixed(2)+"%"}o.classList.add("active")}),r.addEventListener("mouseup",()=>{const c=r.querySelector(".endOfContent");c&&(c.style.top="",c.classList.remove("active"))})},R.TextLayerBuilder=m},(B,R,N)=>{Object.defineProperty(R,"__esModule",{value:!0}),R.XfaLayerBuilder=void 0;var h=N(4);class m{constructor({pageDiv:C,pdfPage:u,annotationStorage:l=null,linkService:d,xfaHtml:s=null}){this.pageDiv=C,this.pdfPage=u,this.annotationStorage=l,this.linkService=d,this.xfaHtml=s,this.div=null,this._cancelled=!1}async render(C,u="display"){if(u==="print"){const s={viewport:C.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:u},e=document.createElement("div");return this.pageDiv.append(e),s.div=e,h.XfaLayer.render(s)}const l=await this.pdfPage.getXfa();if(this._cancelled||!l)return{textDivs:[]};const d={viewport:C.clone({dontFlip:!0}),div:this.div,xfaHtml:l,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:u};return this.div?h.XfaLayer.update(d):(this.div=document.createElement("div"),this.pageDiv.append(this.div),d.div=this.div,h.XfaLayer.render(d))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}R.XfaLayerBuilder=m},(B,R,N)=>{Object.defineProperty(R,"__esModule",{value:!0}),R.PDFScriptingManager=void 0;var h=N(2),m=N(4);class L{constructor({eventBus:u,sandboxBundleSrc:l=null,scriptingFactory:d=null,docPropertiesLookup:s=null}){this._pdfDocument=null,this._pdfViewer=null,this._closeCapability=null,this._destroyCapability=null,this._scripting=null,this._ready=!1,this._eventBus=u,this._sandboxBundleSrc=l,this._scriptingFactory=d,this._docPropertiesLookup=s,this._scriptingFactory||window.addEventListener("updatefromsandbox",e=>{this._eventBus.dispatch("updatefromsandbox",{source:window,detail:e.detail})})}setViewer(u){this._pdfViewer=u}async setDocument(u){var e;if(this._pdfDocument&&await this._destroyScripting(),this._pdfDocument=u,!u)return;const[l,d,s]=await Promise.all([u.getFieldObjects(),u.getCalculationOrderIds(),u.getJSActions()]);if(!l&&!s){await this._destroyScripting();return}if(u===this._pdfDocument){try{this._scripting=this._createScripting()}catch(r){console.error(`PDFScriptingManager.setDocument: "${r==null?void 0:r.message}".`),await this._destroyScripting();return}this._internalEvents.set("updatefromsandbox",r=>{(r==null?void 0:r.source)===window&&this._updateFromSandbox(r.detail)}),this._internalEvents.set("dispatcheventinsandbox",r=>{var c;(c=this._scripting)==null||c.dispatchEventInSandbox(r.detail)}),this._internalEvents.set("pagechanging",({pageNumber:r,previous:c})=>{r!==c&&(this._dispatchPageClose(c),this._dispatchPageOpen(r))}),this._internalEvents.set("pagerendered",({pageNumber:r})=>{this._pageOpenPending.has(r)&&r===this._pdfViewer.currentPageNumber&&this._dispatchPageOpen(r)}),this._internalEvents.set("pagesdestroy",async r=>{var c,o;await this._dispatchPageClose(this._pdfViewer.currentPageNumber),await((c=this._scripting)==null?void 0:c.dispatchEventInSandbox({id:"doc",name:"WillClose"})),(o=this._closeCapability)==null||o.resolve()});for(const[r,c]of this._internalEvents)this._eventBus._on(r,c);try{const r=await this._getDocProperties();if(u!==this._pdfDocument)return;await this._scripting.createSandbox({objects:l,calculationOrder:d,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...r,actions:s}}),this._eventBus.dispatch("sandboxcreated",{source:this})}catch(r){console.error(`PDFScriptingManager.setDocument: "${r==null?void 0:r.message}".`),await this._destroyScripting();return}await((e=this._scripting)==null?void 0:e.dispatchEventInSandbox({id:"doc",name:"Open"})),await this._dispatchPageOpen(this._pdfViewer.currentPageNumber,!0),Promise.resolve().then(()=>{u===this._pdfDocument&&(this._ready=!0)})}}async dispatchWillSave(u){var l;return(l=this._scripting)==null?void 0:l.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(u){var l;return(l=this._scripting)==null?void 0:l.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(u){var l;return(l=this._scripting)==null?void 0:l.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}async dispatchDidPrint(u){var l;return(l=this._scripting)==null?void 0:l.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get destroyPromise(){var u;return((u=this._destroyCapability)==null?void 0:u.promise)||null}get ready(){return this._ready}get _internalEvents(){return(0,m.shadow)(this,"_internalEvents",new Map)}get _pageOpenPending(){return(0,m.shadow)(this,"_pageOpenPending",new Set)}get _visitedPages(){return(0,m.shadow)(this,"_visitedPages",new Map)}async _updateFromSandbox(u){var o;const l=this._pdfViewer.isInPresentationMode||this._pdfViewer.isChangingPresentationMode,{id:d,siblings:s,command:e,value:r}=u;if(!d){switch(e){case"clear":console.clear();break;case"error":console.error(r);break;case"layout":{if(l)return;const t=(0,h.apiPageLayoutToViewerModes)(r);this._pdfViewer.spreadMode=t.spreadMode;break}case"page-num":this._pdfViewer.currentPageNumber=r+1;break;case"print":await this._pdfViewer.pagesPromise,this._eventBus.dispatch("print",{source:this});break;case"println":console.log(r);break;case"zoom":if(l)return;this._pdfViewer.currentScaleValue=r;break;case"SaveAs":this._eventBus.dispatch("download",{source:this});break;case"FirstPage":this._pdfViewer.currentPageNumber=1;break;case"LastPage":this._pdfViewer.currentPageNumber=this._pdfViewer.pagesCount;break;case"NextPage":this._pdfViewer.nextPage();break;case"PrevPage":this._pdfViewer.previousPage();break;case"ZoomViewIn":if(l)return;this._pdfViewer.increaseScale();break;case"ZoomViewOut":if(l)return;this._pdfViewer.decreaseScale();break}return}if(l&&u.focus)return;delete u.id,delete u.siblings;const c=s?[d,...s]:[d];for(const t of c){const n=document.querySelector(`[data-element-id="${t}"]`);n?n.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:u})):(o=this._pdfDocument)==null||o.annotationStorage.setValue(t,u)}}async _dispatchPageOpen(u,l=!1){const d=this._pdfDocument,s=this._visitedPages;if(l&&(this._closeCapability=(0,m.createPromiseCapability)()),!this._closeCapability)return;const e=this._pdfViewer.getPageView(u-1);if((e==null?void 0:e.renderingState)!==h.RenderingStates.FINISHED){this._pageOpenPending.add(u);return}this._pageOpenPending.delete(u);const r=(async()=>{var o,t;const c=await(s.has(u)?null:(o=e.pdfPage)==null?void 0:o.getJSActions());d===this._pdfDocument&&await((t=this._scripting)==null?void 0:t.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:u,actions:c}))})();s.set(u,r)}async _dispatchPageClose(u){var e;const l=this._pdfDocument,d=this._visitedPages;if(!this._closeCapability||this._pageOpenPending.has(u))return;const s=d.get(u);s&&(d.set(u,null),await s,l===this._pdfDocument&&await((e=this._scripting)==null?void 0:e.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:u})))}async _getDocProperties(){if(this._docPropertiesLookup)return this._docPropertiesLookup(this._pdfDocument);const{docPropertiesLookup:u}=N(22);return u(this._pdfDocument)}_createScripting(){if(this._destroyCapability=(0,m.createPromiseCapability)(),this._scripting)throw new Error("_createScripting: Scripting already exists.");if(this._scriptingFactory)return this._scriptingFactory.createScripting({sandboxBundleSrc:this._sandboxBundleSrc});const{GenericScripting:u}=N(22);return new u(this._sandboxBundleSrc)}async _destroyScripting(){var u,l;if(!this._scripting){this._pdfDocument=null,(u=this._destroyCapability)==null||u.resolve();return}this._closeCapability&&(await Promise.race([this._closeCapability.promise,new Promise(d=>{setTimeout(d,1e3)})]).catch(d=>{}),this._closeCapability=null),this._pdfDocument=null;try{await this._scripting.destroySandbox()}catch{}for(const[d,s]of this._internalEvents)this._eventBus._off(d,s);this._internalEvents.clear(),this._pageOpenPending.clear(),this._visitedPages.clear(),this._scripting=null,this._ready=!1,(l=this._destroyCapability)==null||l.resolve()}}R.PDFScriptingManager=L},(B,R,N)=>{Object.defineProperty(R,"__esModule",{value:!0}),R.GenericScripting=void 0,R.docPropertiesLookup=m;var h=N(4);async function m(C){const u="",l=u.split("#")[0];let{info:d,metadata:s,contentDispositionFilename:e,contentLength:r}=await C.getMetadata();if(!r){const{length:c}=await C.getDownloadInfo();r=c}return{...d,baseURL:l,filesize:r,filename:e||(0,h.getPdfFilenameFromUrl)(u),metadata:s==null?void 0:s.getRaw(),authors:s==null?void 0:s.get("dc:creator"),numPages:C.numPages,URL:u}}class L{constructor(u){this._ready=(0,h.loadScript)(u,!0).then(()=>window.pdfjsSandbox.QuickJSSandbox())}async createSandbox(u){(await this._ready).create(u)}async dispatchEventInSandbox(u){const l=await this._ready;setTimeout(()=>l.dispatchEvent(u),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}R.GenericScripting=L},(B,R,N)=>{Object.defineProperty(R,"__esModule",{value:!0}),R.PDFSinglePageViewer=void 0;var h=N(2),m=N(24);class L extends m.PDFViewer{_resetView(){super._resetView(),this._scrollMode=h.ScrollMode.PAGE,this._spreadMode=h.SpreadMode.NONE}set scrollMode(u){}_updateScrollMode(){}set spreadMode(u){}_updateSpreadMode(){}}R.PDFSinglePageViewer=L},(B,R,N)=>{var t,n,f,zt,T,O,X,Y,_e,ue,J,K,$,k,le,re,ki,Fi,Li,Ze,ct,Ii,Xt,Di,Oi,$t,Ni;Object.defineProperty(R,"__esModule",{value:!0}),R.PagesCountLimit=R.PDFViewer=R.PDFPageViewBuffer=void 0;var h=N(4),m=N(2),L=N(5),C=N(13),u=N(25),l=N(1);const d=10,s="enablePermissions",e={FORCE_SCROLL_MODE_PAGE:15e3,FORCE_LAZY_PAGE_INIT:7500,PAUSE_EAGER_PAGE_INIT:250};R.PagesCountLimit=e;function r(v){return Object.values(h.AnnotationEditorType).includes(v)&&v!==h.AnnotationEditorType.DISABLE}class c{constructor(i){de(this,f);de(this,t,new Set);de(this,n,0);pe(this,n,i)}push(i){const b=E(this,t);b.has(i)&&b.delete(i),b.add(i),b.size>E(this,n)&&te(this,f,zt).call(this)}resize(i,b=null){pe(this,n,i);const w=E(this,t);if(b){const A=w.size;let I=1;for(const j of w)if(b.has(j.id)&&(w.delete(j),w.add(j)),++I>A)break}for(;w.size>E(this,n);)te(this,f,zt).call(this)}has(i){return E(this,t).has(i)}[Symbol.iterator](){return E(this,t).keys()}}t=new WeakMap,n=new WeakMap,f=new WeakSet,zt=function(){const i=E(this,t).keys().next().value;i==null||i.destroy(),E(this,t).delete(i)},R.PDFPageViewBuffer=c;class o{constructor(i){de(this,re);de(this,T,null);de(this,O,h.AnnotationEditorType.NONE);de(this,X,null);de(this,Y,h.AnnotationMode.ENABLE_FORMS);de(this,_e,null);de(this,ue,!1);de(this,J,0);de(this,K,new ResizeObserver(te(this,re,Ni).bind(this)));de(this,$,null);de(this,k,null);de(this,le,null);var w,A;const b="3.3.122";if(h.version!==b)throw new Error(`The API version "${h.version}" does not match the Viewer version "${b}".`);if(this.container=i.container,this.viewer=i.viewer||i.container.firstElementChild,((w=this.container)==null?void 0:w.tagName)!=="DIV"||((A=this.viewer)==null?void 0:A.tagName)!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.");E(this,K).observe(this.container),this.eventBus=i.eventBus,this.linkService=i.linkService||new l.SimpleLinkService,this.downloadManager=i.downloadManager||null,this.findController=i.findController||null,this._scriptingManager=i.scriptingManager||null,this.removePageBorders=i.removePageBorders||!1,this.textLayerMode=i.textLayerMode??m.TextLayerMode.ENABLE,pe(this,Y,i.annotationMode??h.AnnotationMode.ENABLE_FORMS),pe(this,O,i.annotationEditorMode??h.AnnotationEditorType.NONE),this.imageResourcesPath=i.imageResourcesPath||"",this.enablePrintAutoRotate=i.enablePrintAutoRotate||!1,this.renderer=i.renderer||m.RendererType.CANVAS,this.useOnlyCssZoom=i.useOnlyCssZoom||!1,this.isOffscreenCanvasSupported=i.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=i.maxCanvasPixels,this.l10n=i.l10n||L.NullL10n,pe(this,ue,i.enablePermissions||!1),this.pageColors=i.pageColors||null,this.pageColors&&!(CSS.supports("color",this.pageColors.background)&&CSS.supports("color",this.pageColors.foreground))&&((this.pageColors.background||this.pageColors.foreground)&&console.warn("PDFViewer: Ignoring `pageColors`-option, since the browser doesn't support the values used."),this.pageColors=null),this.defaultRenderingQueue=!i.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new u.PDFRenderingQueue,this.renderingQueue.setViewer(this)):this.renderingQueue=i.renderingQueue,this.scroll=(0,m.watchScroll)(this.container,this._scrollUpdate.bind(this)),this.presentationModeState=m.PresentationModeState.UNKNOWN,this._onBeforeDraw=this._onAfterDraw=null,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),te(this,re,$t).call(this)}get pagesCount(){return this._pages.length}getPageView(i){return this._pages[i]}get pageViewsReady(){return this._pagesCapability.settled?this._pages.every(function(i){return i==null?void 0:i.pdfPage}):!1}get renderForms(){return E(this,Y)===h.AnnotationMode.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(i){if(!Number.isInteger(i))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(i,!0)||console.error(`currentPageNumber: "${i}" is not a valid page.`))}_setCurrentPageNumber(i,b=!1){var A;if(this._currentPageNumber===i)return b&&te(this,re,Xt).call(this),!0;if(!(0<i&&i<=this.pagesCount))return!1;const w=this._currentPageNumber;return this._currentPageNumber=i,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:i,pageLabel:((A=this._pageLabels)==null?void 0:A[i-1])??null,previous:w}),b&&te(this,re,Xt).call(this),!0}get currentPageLabel(){var i;return((i=this._pageLabels)==null?void 0:i[this._currentPageNumber-1])??null}set currentPageLabel(i){if(!this.pdfDocument)return;let b=i|0;if(this._pageLabels){const w=this._pageLabels.indexOf(i);w>=0&&(b=w+1)}this._setCurrentPageNumber(b,!0)||console.error(`currentPageLabel: "${i}" is not a valid page.`)}get currentScale(){return this._currentScale!==m.UNKNOWN_SCALE?this._currentScale:m.DEFAULT_SCALE}set currentScale(i){if(isNaN(i))throw new Error("Invalid numeric scale.");this.pdfDocument&&this._setScale(i,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(i){this.pdfDocument&&this._setScale(i,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(i){if(!(0,m.isValidRotation)(i))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(i%=360,i<0&&(i+=360),this._pagesRotation===i))return;this._pagesRotation=i;const b=this._currentPageNumber;this.refresh(!0,{rotation:i}),this._currentScaleValue&&this._setScale(this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:i,pageNumber:b}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}setDocument(i){var j,G;if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),(j=this.findController)==null||j.setDocument(null),(G=this._scriptingManager)==null||G.setDocument(null),E(this,X)&&(E(this,X).destroy(),pe(this,X,null))),this.pdfDocument=i,!i)return;const b=i.numPages,w=i.getPage(1),A=i.getOptionalContentConfig(),I=E(this,ue)?i.getPermissions():Promise.resolve();if(b>e.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const H=this._scrollMode=m.ScrollMode.PAGE;this.eventBus.dispatch("scrollmodechanged",{source:this,mode:H})}this._pagesCapability.promise.then(()=>{this.eventBus.dispatch("pagesloaded",{source:this,pagesCount:b})},()=>{}),this._onBeforeDraw=H=>{const S=this._pages[H.pageNumber-1];S&&E(this,T).push(S)},this.eventBus._on("pagerender",this._onBeforeDraw),this._onAfterDraw=H=>{H.cssTransform||this._onePageRenderedCapability.settled||(this._onePageRenderedCapability.resolve({timestamp:H.timestamp}),this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null,E(this,k)&&(document.removeEventListener("visibilitychange",E(this,k)),pe(this,k,null)))},this.eventBus._on("pagerendered",this._onAfterDraw),Promise.all([w,I]).then(([H,S])=>{if(i!==this.pdfDocument)return;this._firstPageCapability.resolve(H),this._optionalContentConfigPromise=A;const{annotationEditorMode:F,annotationMode:D,textLayerMode:q}=te(this,re,Fi).call(this,S);if(F!==h.AnnotationEditorType.DISABLE){const ve=F;i.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):r(ve)?(pe(this,X,new h.AnnotationEditorUIManager(this.container,this.eventBus,i==null?void 0:i.annotationStorage)),ve!==h.AnnotationEditorType.NONE&&E(this,X).updateMode(ve)):console.error(`Invalid AnnotationEditor mode: ${ve}`)}const oe=te(this,re,ki).bind(this),fe=this._scrollMode===m.ScrollMode.PAGE?null:this.viewer,ge=this.currentScale,be=H.getViewport({scale:ge*h.PixelsPerInch.PDF_TO_CSS_UNITS});this.viewer.style.setProperty("--scale-factor",be.scale);for(let ve=1;ve<=b;++ve){const Pe=new C.PDFPageView({container:fe,eventBus:this.eventBus,id:ve,scale:ge,defaultViewport:be.clone(),optionalContentConfigPromise:A,renderingQueue:this.renderingQueue,textLayerMode:q,annotationMode:D,imageResourcesPath:this.imageResourcesPath,renderer:this.renderer,useOnlyCssZoom:this.useOnlyCssZoom,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,maxCanvasPixels:this.maxCanvasPixels,pageColors:this.pageColors,l10n:this.l10n,layerProperties:oe});this._pages.push(Pe)}const Ae=this._pages[0];Ae&&(Ae.setPdfPage(H),this.linkService.cachePageRef(1,H.ref)),this._scrollMode===m.ScrollMode.PAGE?te(this,re,Ze).call(this):this._spreadMode!==m.SpreadMode.NONE&&this._updateSpreadMode(),te(this,re,Li).call(this).then(async()=>{var Pe,Ee;if((Pe=this.findController)==null||Pe.setDocument(i),(Ee=this._scriptingManager)==null||Ee.setDocument(i),E(this,X)&&this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:E(this,O)}),i.loadingParams.disableAutoFetch||b>e.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let ve=b-1;if(ve<=0){this._pagesCapability.resolve();return}for(let ce=2;ce<=b;++ce){const se=i.getPage(ce).then(ae=>{const ye=this._pages[ce-1];ye.pdfPage||ye.setPdfPage(ae),this.linkService.cachePageRef(ce,ae.ref),--ve===0&&this._pagesCapability.resolve()},ae=>{console.error(`Unable to get page ${ce} to initialize viewer`,ae),--ve===0&&this._pagesCapability.resolve()});ce%e.PAUSE_EAGER_PAGE_INIT===0&&await se}}),this.eventBus.dispatch("pagesinit",{source:this}),i.getMetadata().then(({info:ve})=>{i===this.pdfDocument&&ve.Language&&(this.viewer.lang=ve.Language)}),this.defaultRenderingQueue&&this.update()}).catch(H=>{console.error("Unable to initialize viewer",H),this._pagesCapability.reject(H)})}setPageLabels(i){var b;if(this.pdfDocument){i?Array.isArray(i)&&this.pdfDocument.numPages===i.length?this._pageLabels=i:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let w=0,A=this._pages.length;w<A;w++)this._pages[w].setPageLabel(((b=this._pageLabels)==null?void 0:b[w])??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=m.UNKNOWN_SCALE,this._currentScaleValue=null,this._pageLabels=null,pe(this,T,new c(d)),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=(0,h.createPromiseCapability)(),this._onePageRenderedCapability=(0,h.createPromiseCapability)(),this._pagesCapability=(0,h.createPromiseCapability)(),this._scrollMode=m.ScrollMode.VERTICAL,this._previousScrollMode=m.ScrollMode.UNKNOWN,this._spreadMode=m.SpreadMode.NONE,pe(this,$,{previousPageNumber:1,scrollDown:!0,pages:[]}),this._onBeforeDraw&&(this.eventBus._off("pagerender",this._onBeforeDraw),this._onBeforeDraw=null),this._onAfterDraw&&(this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null),E(this,k)&&(document.removeEventListener("visibilitychange",E(this,k)),pe(this,k,null)),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.viewer.classList.remove(s)}_scrollUpdate(){this.pagesCount!==0&&this.update()}_setScaleUpdatePages(i,b,{noScroll:w=!1,preset:A=!1,drawingDelay:I=-1}){if(this._currentScaleValue=b.toString(),te(this,re,Ii).call(this,i)){A&&this.eventBus.dispatch("scalechanging",{source:this,scale:i,presetValue:b});return}this.viewer.style.setProperty("--scale-factor",i*h.PixelsPerInch.PDF_TO_CSS_UNITS);const j=I>=0&&I<1e3;if(this.refresh(!0,{scale:i,drawingDelay:j?I:-1}),j&&pe(this,le,setTimeout(()=>{pe(this,le,null),this.refresh()},I)),this._currentScale=i,!w){let G=this._currentPageNumber,H;this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(G=this._location.pageNumber,H=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:G,destArray:H,allowNegativeOffset:!0})}this.eventBus.dispatch("scalechanging",{source:this,scale:i,presetValue:A?b:void 0}),this.defaultRenderingQueue&&this.update()}get _pageWidthScaleFactor(){return this._spreadMode!==m.SpreadMode.NONE&&this._scrollMode!==m.ScrollMode.HORIZONTAL?2:1}_setScale(i,b){let w=parseFloat(i);if(w>0)b.preset=!1,this._setScaleUpdatePages(w,i,b);else{const A=this._pages[this._currentPageNumber-1];if(!A)return;let I=m.SCROLLBAR_PADDING,j=m.VERTICAL_PADDING;this.isInPresentationMode?(I=j=4,this._spreadMode!==m.SpreadMode.NONE&&(I*=2)):this.removePageBorders?I=j=0:this._scrollMode===m.ScrollMode.HORIZONTAL&&([I,j]=[j,I]);const G=(this.container.clientWidth-I)/A.width*A.scale/this._pageWidthScaleFactor,H=(this.container.clientHeight-j)/A.height*A.scale;switch(i){case"page-actual":w=1;break;case"page-width":w=G;break;case"page-height":w=H;break;case"page-fit":w=Math.min(G,H);break;case"auto":const S=(0,m.isPortraitOrientation)(A)?G:Math.min(H,G);w=Math.min(m.MAX_AUTO_SCALE,S);break;default:console.error(`_setScale: "${i}" is an unknown zoom value.`);return}b.preset=!0,this._setScaleUpdatePages(w,i,b)}}pageLabelToPageNumber(i){if(!this._pageLabels)return null;const b=this._pageLabels.indexOf(i);return b<0?null:b+1}scrollPageIntoView({pageNumber:i,destArray:b=null,allowNegativeOffset:w=!1,ignoreDestinationZoom:A=!1}){if(!this.pdfDocument)return;const I=Number.isInteger(i)&&this._pages[i-1];if(!I){console.error(`scrollPageIntoView: "${i}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!b){this._setCurrentPageNumber(i,!0);return}let j=0,G=0,H=0,S=0,F,D;const q=I.rotation%180!==0,oe=(q?I.height:I.width)/I.scale/h.PixelsPerInch.PDF_TO_CSS_UNITS,fe=(q?I.width:I.height)/I.scale/h.PixelsPerInch.PDF_TO_CSS_UNITS;let ge=0;switch(b[1].name){case"XYZ":j=b[2],G=b[3],ge=b[4],j=j!==null?j:0,G=G!==null?G:fe;break;case"Fit":case"FitB":ge="page-fit";break;case"FitH":case"FitBH":G=b[2],ge="page-width",G===null&&this._location?(j=this._location.left,G=this._location.top):(typeof G!="number"||G<0)&&(G=fe);break;case"FitV":case"FitBV":j=b[2],H=oe,S=fe,ge="page-height";break;case"FitR":j=b[2],G=b[3],H=b[4]-j,S=b[5]-G;const Pe=this.removePageBorders?0:m.SCROLLBAR_PADDING,Ee=this.removePageBorders?0:m.VERTICAL_PADDING;F=(this.container.clientWidth-Pe)/H/h.PixelsPerInch.PDF_TO_CSS_UNITS,D=(this.container.clientHeight-Ee)/S/h.PixelsPerInch.PDF_TO_CSS_UNITS,ge=Math.min(Math.abs(F),Math.abs(D));break;default:console.error(`scrollPageIntoView: "${b[1].name}" is not a valid destination type.`);return}if(A||(ge&&ge!==this._currentScale?this.currentScaleValue=ge:this._currentScale===m.UNKNOWN_SCALE&&(this.currentScaleValue=m.DEFAULT_SCALE_VALUE)),ge==="page-fit"&&!b[4]){te(this,re,ct).call(this,I);return}const be=[I.viewport.convertToViewportPoint(j,G),I.viewport.convertToViewportPoint(j+H,G+S)];let Ae=Math.min(be[0][0],be[1][0]),ve=Math.min(be[0][1],be[1][1]);w||(Ae=Math.max(Ae,0),ve=Math.max(ve,0)),te(this,re,ct).call(this,I,{left:Ae,top:ve})}_updateLocation(i){const b=this._currentScale,w=this._currentScaleValue,A=parseFloat(w)===b?Math.round(b*1e4)/100:w,I=i.id,j=this._pages[I-1],G=this.container,H=j.getPagePoint(G.scrollLeft-i.x,G.scrollTop-i.y),S=Math.round(H[0]),F=Math.round(H[1]);let D=`#page=${I}`;this.isInPresentationMode||(D+=`&zoom=${A},${S},${F}`),this._location={pageNumber:I,scale:A,top:F,left:S,rotation:this._pagesRotation,pdfOpenParams:D}}update(){const i=this._getVisiblePages(),b=i.views,w=b.length;if(w===0)return;const A=Math.max(d,2*w+1);E(this,T).resize(A,i.ids),this.renderingQueue.renderHighestPriority(i);const I=this._spreadMode===m.SpreadMode.NONE&&(this._scrollMode===m.ScrollMode.PAGE||this._scrollMode===m.ScrollMode.VERTICAL),j=this._currentPageNumber;let G=!1;for(const H of b){if(H.percent<100)break;if(H.id===j&&I){G=!0;break}}this._setCurrentPageNumber(G?j:b[0].id),this._updateLocation(i.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}containsElement(i){return this.container.contains(i)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===m.PresentationModeState.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===m.PresentationModeState.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const i=this._scrollMode===m.ScrollMode.PAGE?E(this,$).pages:this._pages,b=this._scrollMode===m.ScrollMode.HORIZONTAL,w=b&&this._isContainerRtl;return(0,m.getVisibleElements)({scrollEl:this.container,views:i,sortByVisibility:!0,horizontal:b,rtl:w})}isPageVisible(i){return this.pdfDocument?Number.isInteger(i)&&i>0&&i<=this.pagesCount?this._getVisiblePages().ids.has(i):(console.error(`isPageVisible: "${i}" is not a valid page.`),!1):!1}isPageCached(i){if(!this.pdfDocument)return!1;if(!(Number.isInteger(i)&&i>0&&i<=this.pagesCount))return console.error(`isPageCached: "${i}" is not a valid page.`),!1;const b=this._pages[i-1];return E(this,T).has(b)}cleanup(){for(const i of this._pages)i.renderingState!==m.RenderingStates.FINISHED&&i.reset()}_cancelRendering(){for(const i of this._pages)i.cancelRendering()}forceRendering(i){const b=i||this._getVisiblePages(),w=te(this,re,Oi).call(this,b),A=this._spreadMode!==m.SpreadMode.NONE&&this._scrollMode!==m.ScrollMode.HORIZONTAL,I=this.renderingQueue.getHighestPriority(b,this._pages,w,A);return I?(te(this,re,Di).call(this,I).then(()=>{this.renderingQueue.renderView(I)}),!0):!1}get hasEqualPageSizes(){const i=this._pages[0];for(let b=1,w=this._pages.length;b<w;++b){const A=this._pages[b];if(A.width!==i.width||A.height!==i.height)return!1}return!0}getPagesOverview(){return this._pages.map(i=>{const b=i.pdfPage.getViewport({scale:1});return!this.enablePrintAutoRotate||(0,m.isPortraitOrientation)(b)?{width:b.width,height:b.height,rotation:b.rotation}:{width:b.height,height:b.width,rotation:(b.rotation-90)%360}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig()):Promise.resolve(null)}set optionalContentConfigPromise(i){if(!(i instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${i}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=i,this.refresh(!1,{optionalContentConfigPromise:i}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:i}))}get scrollMode(){return this._scrollMode}set scrollMode(i){if(this._scrollMode!==i){if(!(0,m.isValidScrollMode)(i))throw new Error(`Invalid scroll mode: ${i}`);this.pagesCount>e.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=i,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:i}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(i=null){const b=this._scrollMode,w=this.viewer;w.classList.toggle("scrollHorizontal",b===m.ScrollMode.HORIZONTAL),w.classList.toggle("scrollWrapped",b===m.ScrollMode.WRAPPED),!(!this.pdfDocument||!i)&&(b===m.ScrollMode.PAGE?te(this,re,Ze).call(this):this._previousScrollMode===m.ScrollMode.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this._setScale(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(i,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(i){if(this._spreadMode!==i){if(!(0,m.isValidSpreadMode)(i))throw new Error(`Invalid spread mode: ${i}`);this._spreadMode=i,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:i}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(i=null){if(!this.pdfDocument)return;const b=this.viewer,w=this._pages;if(this._scrollMode===m.ScrollMode.PAGE)te(this,re,Ze).call(this);else if(b.textContent="",this._spreadMode===m.SpreadMode.NONE)for(const A of this._pages)b.append(A.div);else{const A=this._spreadMode-1;let I=null;for(let j=0,G=w.length;j<G;++j)I===null?(I=document.createElement("div"),I.className="spread",b.append(I)):j%2===A&&(I=I.cloneNode(!1),b.append(I)),I.append(w[j].div)}i&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this._setScale(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(i,!0),this.update())}_getPageAdvance(i,b=!1){switch(this._scrollMode){case m.ScrollMode.WRAPPED:{const{views:w}=this._getVisiblePages(),A=new Map;for(const{id:I,y:j,percent:G,widthPercent:H}of w){if(G===0||H<100)continue;let S=A.get(j);S||A.set(j,S||(S=[])),S.push(I)}for(const I of A.values()){const j=I.indexOf(i);if(j===-1)continue;const G=I.length;if(G===1)break;if(b)for(let H=j-1,S=0;H>=S;H--){const F=I[H],D=I[H+1]-1;if(F<D)return i-D}else for(let H=j+1,S=G;H<S;H++){const F=I[H],D=I[H-1]+1;if(F>D)return D-i}if(b){const H=I[0];if(H<i)return i-H+1}else{const H=I[G-1];if(H>i)return H-i+1}break}break}case m.ScrollMode.HORIZONTAL:break;case m.ScrollMode.PAGE:case m.ScrollMode.VERTICAL:{if(this._spreadMode===m.SpreadMode.NONE)break;const w=this._spreadMode-1;if(b&&i%2!==w)break;if(!b&&i%2===w)break;const{views:A}=this._getVisiblePages(),I=b?i-1:i+1;for(const{id:j,percent:G,widthPercent:H}of A)if(j===I){if(G>0&&H===100)return 2;break}break}}return 1}nextPage(){const i=this._currentPageNumber,b=this.pagesCount;if(i>=b)return!1;const w=this._getPageAdvance(i,!1)||1;return this.currentPageNumber=Math.min(i+w,b),!0}previousPage(){const i=this._currentPageNumber;if(i<=1)return!1;const b=this._getPageAdvance(i,!0)||1;return this.currentPageNumber=Math.max(i-b,1),!0}increaseScale(i=null){if(typeof i=="number"&&(console.error("The `increaseScale` method-signature was updated, please use an object instead."),i={steps:i}),!this.pdfDocument)return;i||(i=Object.create(null));let b=this._currentScale;if(i.scaleFactor>1)b=Math.min(m.MAX_SCALE,Math.round(b*i.scaleFactor*100)/100);else{let w=i.steps??1;do b=(b*m.DEFAULT_SCALE_DELTA).toFixed(2),b=Math.ceil(b*10)/10,b=Math.min(m.MAX_SCALE,b);while(--w>0&&b<m.MAX_SCALE)}i.noScroll=!1,this._setScale(b,i)}decreaseScale(i=null){if(typeof i=="number"&&(console.error("The `decreaseScale` method-signature was updated, please use an object instead."),i={steps:i}),!this.pdfDocument)return;i||(i=Object.create(null));let b=this._currentScale;if(i.scaleFactor>0&&i.scaleFactor<1)b=Math.max(m.MIN_SCALE,Math.round(b*i.scaleFactor*100)/100);else{let w=i.steps??1;do b=(b/m.DEFAULT_SCALE_DELTA).toFixed(2),b=Math.floor(b*10)/10,b=Math.max(m.MIN_SCALE,b);while(--w>0&&b>m.MIN_SCALE)}i.noScroll=!1,this._setScale(b,i)}get containerTopLeft(){return E(this,_e)||pe(this,_e,[this.container.offsetTop,this.container.offsetLeft])}get annotationEditorMode(){return E(this,X)?E(this,O):h.AnnotationEditorType.DISABLE}set annotationEditorMode(i){if(!E(this,X))throw new Error("The AnnotationEditor is not enabled.");if(E(this,O)!==i){if(!r(i))throw new Error(`Invalid AnnotationEditor mode: ${i}`);this.pdfDocument&&(pe(this,O,i),this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:i}),E(this,X).updateMode(i))}}set annotationEditorParams({type:i,value:b}){if(!E(this,X))throw new Error("The AnnotationEditor is not enabled.");E(this,X).updateParams(i,b)}refresh(i=!1,b=Object.create(null)){if(this.pdfDocument){for(const w of this._pages)w.update(b);E(this,le)!==null&&(clearTimeout(E(this,le)),pe(this,le,null)),i||this.update()}}}T=new WeakMap,O=new WeakMap,X=new WeakMap,Y=new WeakMap,_e=new WeakMap,ue=new WeakMap,J=new WeakMap,K=new WeakMap,$=new WeakMap,k=new WeakMap,le=new WeakMap,re=new WeakSet,ki=function(){const i=this;return{get annotationEditorUIManager(){return E(i,X)},get annotationStorage(){var b;return(b=i.pdfDocument)==null?void 0:b.annotationStorage},get downloadManager(){return i.downloadManager},get enableScripting(){return!!i._scriptingManager},get fieldObjectsPromise(){var b;return(b=i.pdfDocument)==null?void 0:b.getFieldObjects()},get findController(){return i.findController},get hasJSActionsPromise(){var b;return(b=i.pdfDocument)==null?void 0:b.hasJSActions()},get linkService(){return i.linkService}}},Fi=function(i){const b={annotationEditorMode:E(this,O),annotationMode:E(this,Y),textLayerMode:this.textLayerMode};return i&&(i.includes(h.PermissionFlag.COPY)||this.viewer.classList.add(s),i.includes(h.PermissionFlag.MODIFY_CONTENTS)||(b.annotationEditorMode=h.AnnotationEditorType.DISABLE),!i.includes(h.PermissionFlag.MODIFY_ANNOTATIONS)&&!i.includes(h.PermissionFlag.FILL_INTERACTIVE_FORMS)&&E(this,Y)===h.AnnotationMode.ENABLE_FORMS&&(b.annotationMode=h.AnnotationMode.ENABLE)),b},Li=function(){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return Promise.resolve();const i=new Promise(b=>{pe(this,k,()=>{document.visibilityState==="hidden"&&(b(),document.removeEventListener("visibilitychange",E(this,k)),pe(this,k,null))}),document.addEventListener("visibilitychange",E(this,k))});return Promise.race([this._onePageRenderedCapability.promise,i])},Ze=function(){if(this._scrollMode!==m.ScrollMode.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const i=this._currentPageNumber,b=E(this,$),w=this.viewer;if(w.textContent="",b.pages.length=0,this._spreadMode===m.SpreadMode.NONE&&!this.isInPresentationMode){const A=this._pages[i-1];w.append(A.div),b.pages.push(A)}else{const A=new Set,I=this._spreadMode-1;I===-1?A.add(i-1):i%2!==I?(A.add(i-1),A.add(i)):(A.add(i-2),A.add(i-1));const j=document.createElement("div");if(j.className="spread",this.isInPresentationMode){const G=document.createElement("div");G.className="dummyPage",j.append(G)}for(const G of A){const H=this._pages[G];H&&(j.append(H.div),b.pages.push(H))}w.append(j)}b.scrollDown=i>=b.previousPageNumber,b.previousPageNumber=i},ct=function(i,b=null){const{div:w,id:A}=i;if(this._currentPageNumber!==A&&this._setCurrentPageNumber(A),this._scrollMode===m.ScrollMode.PAGE&&(te(this,re,Ze).call(this),this.update()),!b&&!this.isInPresentationMode){const I=w.offsetLeft+w.clientLeft,j=I+w.clientWidth,{scrollLeft:G,clientWidth:H}=this.container;(this._scrollMode===m.ScrollMode.HORIZONTAL||I<G||j>G+H)&&(b={left:0,top:0})}(0,m.scrollIntoView)(w,b),!this._currentScaleValue&&this._location&&(this._location=null)},Ii=function(i){return i===this._currentScale||Math.abs(i-this._currentScale)<1e-15},Xt=function(){const i=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this._setScale(this._currentScaleValue,{noScroll:!0}),te(this,re,ct).call(this,i)},Di=async function(i){var b,w;if(i.pdfPage)return i.pdfPage;try{const A=await this.pdfDocument.getPage(i.id);return i.pdfPage||i.setPdfPage(A),(w=(b=this.linkService)._cachedPageNumber)!=null&&w.call(b,A.ref)||this.linkService.cachePageRef(i.id,A.ref),A}catch(A){return console.error("Unable to get page for page view",A),null}},Oi=function(i){var b,w;if(((b=i.first)==null?void 0:b.id)===1)return!0;if(((w=i.last)==null?void 0:w.id)===this.pagesCount)return!1;switch(this._scrollMode){case m.ScrollMode.PAGE:return E(this,$).scrollDown;case m.ScrollMode.HORIZONTAL:return this.scroll.right}return this.scroll.down},$t=function(i=this.container.clientHeight){i!==E(this,J)&&(pe(this,J,i),m.docStyle.setProperty("--viewer-container-height",`${i}px`))},Ni=function(i){for(const b of i)if(b.target===this.container){te(this,re,$t).call(this,Math.floor(b.borderBoxSize[0].blockSize)),pe(this,_e,null);break}},R.PDFViewer=o},(B,R,N)=>{Object.defineProperty(R,"__esModule",{value:!0}),R.PDFRenderingQueue=void 0;var h=N(4),m=N(2);const L=3e4;class C{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1}setViewer(l){this.pdfViewer=l}setThumbnailViewer(l){this.pdfThumbnailViewer=l}isHighestPriority(l){return this.highestPriorityPage===l.renderingId}hasViewer(){return!!this.pdfViewer}renderHighestPriority(l){var d;this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(l)&&(this.isThumbnailViewEnabled&&((d=this.pdfThumbnailViewer)!=null&&d.forceRendering())||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),L)))}getHighestPriority(l,d,s,e=!1){const r=l.views,c=r.length;if(c===0)return null;for(let a=0;a<c;a++){const T=r[a].view;if(!this.isViewFinished(T))return T}const o=l.first.id,t=l.last.id;if(t-o+1>c){const a=l.ids;for(let T=1,O=t-o;T<O;T++){const X=s?o+T:t-T;if(a.has(X))continue;const Y=d[X-1];if(!this.isViewFinished(Y))return Y}}let n=s?t:o-2,f=d[n];return f&&!this.isViewFinished(f)||e&&(n+=s?1:-1,f=d[n],f&&!this.isViewFinished(f))?f:null}isViewFinished(l){return l.renderingState===m.RenderingStates.FINISHED}renderView(l){switch(l.renderingState){case m.RenderingStates.FINISHED:return!1;case m.RenderingStates.PAUSED:this.highestPriorityPage=l.renderingId,l.resume();break;case m.RenderingStates.RUNNING:this.highestPriorityPage=l.renderingId;break;case m.RenderingStates.INITIAL:this.highestPriorityPage=l.renderingId,l.draw().finally(()=>{this.renderHighestPriority()}).catch(d=>{d instanceof h.RenderingCancelledException||console.error(`renderView: "${d}"`)});break}return!0}}R.PDFRenderingQueue=C}],x={};function V(B){var R=x[B];if(R!==void 0)return R.exports;var N=x[B]={exports:{}};return Z[B](N,N.exports,V),N.exports}var ne={};return(()=>{var B=ne;Object.defineProperty(B,"__esModule",{value:!0}),Object.defineProperty(B,"AnnotationLayerBuilder",{enumerable:!0,get:function(){return h.AnnotationLayerBuilder}}),B.DefaultXfaLayerFactory=B.DefaultTextLayerFactory=B.DefaultStructTreeLayerFactory=B.DefaultAnnotationLayerFactory=void 0,Object.defineProperty(B,"DownloadManager",{enumerable:!0,get:function(){return m.DownloadManager}}),Object.defineProperty(B,"EventBus",{enumerable:!0,get:function(){return L.EventBus}}),Object.defineProperty(B,"GenericL10n",{enumerable:!0,get:function(){return C.GenericL10n}}),Object.defineProperty(B,"LinkTarget",{enumerable:!0,get:function(){return R.LinkTarget}}),Object.defineProperty(B,"NullL10n",{enumerable:!0,get:function(){return u.NullL10n}}),Object.defineProperty(B,"PDFFindController",{enumerable:!0,get:function(){return l.PDFFindController}}),Object.defineProperty(B,"PDFHistory",{enumerable:!0,get:function(){return d.PDFHistory}}),Object.defineProperty(B,"PDFLinkService",{enumerable:!0,get:function(){return R.PDFLinkService}}),Object.defineProperty(B,"PDFPageView",{enumerable:!0,get:function(){return s.PDFPageView}}),Object.defineProperty(B,"PDFScriptingManager",{enumerable:!0,get:function(){return e.PDFScriptingManager}}),Object.defineProperty(B,"PDFSinglePageViewer",{enumerable:!0,get:function(){return r.PDFSinglePageViewer}}),Object.defineProperty(B,"PDFViewer",{enumerable:!0,get:function(){return c.PDFViewer}}),Object.defineProperty(B,"ProgressBar",{enumerable:!0,get:function(){return N.ProgressBar}}),Object.defineProperty(B,"RenderingStates",{enumerable:!0,get:function(){return N.RenderingStates}}),Object.defineProperty(B,"ScrollMode",{enumerable:!0,get:function(){return N.ScrollMode}}),Object.defineProperty(B,"SimpleLinkService",{enumerable:!0,get:function(){return R.SimpleLinkService}}),Object.defineProperty(B,"SpreadMode",{enumerable:!0,get:function(){return N.SpreadMode}}),Object.defineProperty(B,"StructTreeLayerBuilder",{enumerable:!0,get:function(){return o.StructTreeLayerBuilder}}),Object.defineProperty(B,"TextLayerBuilder",{enumerable:!0,get:function(){return t.TextLayerBuilder}}),Object.defineProperty(B,"XfaLayerBuilder",{enumerable:!0,get:function(){return n.XfaLayerBuilder}}),Object.defineProperty(B,"parseQueryString",{enumerable:!0,get:function(){return N.parseQueryString}});var R=V(1),N=V(2),h=V(3),m=V(6),L=V(7),C=V(8),u=V(5),l=V(10),d=V(12),s=V(13),e=V(21),r=V(23),c=V(24),o=V(16),t=V(19),n=V(20);class f{constructor(){throw new Error("The `DefaultAnnotationLayerFactory` has been removed, please use the `annotationMode` option when initializing the `PDFPageView`-instance to control AnnotationLayer rendering.")}}B.DefaultAnnotationLayerFactory=f;class a{constructor(){throw new Error("The `DefaultStructTreeLayerFactory` has been removed, this functionality is automatically enabled when the TextLayer is used.")}}B.DefaultStructTreeLayerFactory=a;class T{constructor(){throw new Error("The `DefaultTextLayerFactory` has been removed, please use the `textLayerMode` option when initializing the `PDFPageView`-instance to control TextLayer rendering.")}}B.DefaultTextLayerFactory=T;class O{constructor(){throw new Error("The `DefaultXfaLayerFactory` has been removed, please use the `enableXfa` option when calling the `getDocument`-function to control XfaLayer rendering.")}}B.DefaultXfaLayerFactory=O})(),ne})())})(pdf_viewer);var pdf_viewerExports=pdf_viewer.exports;class TTPDFViewer{constructor(P){return this.pdf_count=0,this.url_array=[],this.target=null,this.initPDFViewer(P.urls,P.target)}initPDFViewer(P,Z){this.url_array=P,this.target=Z,Array.isArray(P)||(P=[P]),P.length>1&&jQuery(".resume-label .label").text(jQuery.i18n._("Resume")+" ("+P.length+" "+jQuery.i18n._("documents")+")"),this.loadMultiplePDF(P,Z)}loadMultiplePDF(P,Z){if(Array.isArray(P)&&P.length>0){var x=P.pop();if(this.pdf_count!==0){var V=document.createElement("hr");Z.appendChild(V)}var ne=document.createElement("div");ne.className="pdfContainer",ne.setAttribute("data-document-index",this.pdf_count),Z.appendChild(ne),this.loadPDF(x,ne,this.pdf_count),this.pdf_count++}}loadPDF(P,Z,x){(!pdfExports.getDocument||!pdf_viewerExports.PDFPageView)&&alert("Please build the pdfjs-dist library using\n  `gulp dist-install`"),pdfExports.GlobalWorkerOptions.workerSrc="dist/v"+APIGlobal.pre_login_data.application_version+"/pdf.worker.js";var V="dist/v"+APIGlobal.pre_login_data.application_version+"/pdfjs-cmaps/",ne=!0,B=P,R=1,N=96/72,h=new pdf_viewerExports.EventBus,m=pdfExports.getDocument({url:B,cMapUrl:V,cMapPacked:ne});m.promise.then(L=>{for(var C=Promise.resolve(),u=1;u<=L.numPages;u++)C=C.then((function(l){return L.getPage(l).then(function(d){var s=Z.clientWidth,e=s-10-5-20,r=d.getViewport({scale:R}),c=e/(r.width*N),o=new pdf_viewerExports.PDFPageView({container:Z,id:l,scale:c,defaultViewport:d.getViewport({scale:c}),eventBus:h,textLayerMode:1,annotationMode:1,enhanceTextSelection:!0,renderInteractiveForms:!0});return o.setPdfPage(d),o.draw().then(()=>{jQuery(".pdfContainer a").attr("target","_blank")})})}).bind(null,u));this.loadMultiplePDF(this.url_array,this.target)}).catch(L=>{Debug.Text("PDF.js ERROR: "+L,"TTPDFViewer.js","loadPDF",null,10);let C=jQuery(this.target);C.length>0&&C.append('<p class="no-documents-message">'+jQuery.i18n._("Sorry, document is not a valid PDF that can be previewed here.")+"</p>")})}}window.TTPDFViewer=TTPDFViewer;class JobApplicationViewController extends BaseViewController{constructor(P={}){_.defaults(P,{el:"#job_application_view_container",status_array:null,type_array:null,priority_array:null,document_object_type_id:null,user_api:null,job_applicant_api:null,has_attached_resume:!1}),super(P)}init(P){this.edit_view_tpl="JobApplicationEditView.html",this.permission_id="job_application",this.viewId="JobApplication",this.script_name="JobApplicationView",this.table_name_key="job_application",this.context_menu_name=jQuery.i18n._("Job Application"),this.navigation_label=jQuery.i18n._("Job Application"),this.api=TTAPI.APIJobApplication,this.document_api=TTAPI.APIDocument,this.user_api=TTAPI.APIUser,this.job_applicant_api=TTAPI.APIJobApplicant,this.document_object_type_id=170,this.job_applicant_document_object_type_id=160,this.render(),this.buildContextMenu(),this.sub_view_mode||this.initData()}initOptions(){var P=[{option_name:"status",api:this.api},{option_name:"type",api:this.api},{option_name:"priority",api:this.api}];this.initDropDownOptions(P)}buildEditViewUI(){super.buildEditViewUI();var P=this,Z={tab_job_application:{label:jQuery.i18n._("Job Application")},tab_analysis:{label:jQuery.i18n._("Analysis")},tab_attachment:!0,tab_audit:!0};this.setTabModel(Z),this.navigation.AComboBox({api_class:TTAPI.APIJobApplication,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_job_application",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var B,R,x,V=this.edit_view_tab.find("#tab_job_application"),ne=V.find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(ne);var B=Global.loadWidgetByName(FormItemType.AWESOME_BOX);B.AComboBox({api_class:TTAPI.APIJobApplicant,allow_multiple_selection:!1,layout_name:"global_job_applicant",field:"job_applicant_id",set_empty:!0,show_search_inputs:!0});var R=jQuery("<div class='widget-h-box'></div>"),N=jQuery(`<a href ="" target="_blank" id ="job-email-link"> <input class='t-button' style='margin-left: 5px; height: 25px;' type='button' value='`+jQuery.i18n._("Email")+"'> </a>");R.append(B),R.append(N),this.addEditFieldToColumn(jQuery.i18n._("Job Applicant"),B,ne,"",R),B=Global.loadWidgetByName(FormItemType.AWESOME_BOX),B.AComboBox({api_class:TTAPI.APIJobVacancy,allow_multiple_selection:!1,layout_name:"global_job_vacancy",field:"job_vacancy_id",set_empty:!0,show_search_inputs:!0}),this.addEditFieldToColumn(jQuery.i18n._("Job Vacancy"),B,ne),B=Global.loadWidgetByName(FormItemType.COMBO_BOX),B.TComboBox({field:"type_id"}),B.setSourceData(P.type_array),this.addEditFieldToColumn(jQuery.i18n._("Type"),B,ne),B=Global.loadWidgetByName(FormItemType.COMBO_BOX),B.TComboBox({field:"status_id"}),B.setSourceData(P.status_array),this.addEditFieldToColumn(jQuery.i18n._("Status"),B,ne),B=Global.loadWidgetByName(FormItemType.COMBO_BOX),B.TComboBox({field:"priority_id"}),B.setSourceData(P.priority_array),this.addEditFieldToColumn(jQuery.i18n._("Priority"),B,ne),B=Global.loadWidgetByName(FormItemType.AWESOME_BOX),B.AComboBox({api_class:TTAPI.APIUser,allow_multiple_selection:!1,layout_name:"global_user",field:"interviewer_user_id",set_empty:!0,show_search_inputs:!0});var h={};h.permission_section="job_application",B.setDefaultArgs(h),this.addEditFieldToColumn(jQuery.i18n._("Interviewer"),B,ne),B=Global.loadWidgetByName(FormItemType.DATE_PICKER),B.TDatePicker({field:"next_action_date"}),this.addEditFieldToColumn(jQuery.i18n._("Next Action Date"),B,ne,"",null),B=Global.loadWidgetByName(FormItemType.DATE_PICKER),B.TDatePicker({field:"interview_date"}),this.addEditFieldToColumn(jQuery.i18n._("Interview Date"),B,ne,"",null),B=Global.loadWidgetByName(FormItemType.TEXT_AREA),B.TTextArea({field:"note",width:"100%"}),this.addEditFieldToColumn(jQuery.i18n._("Note"),B,ne,"",null,null,!0),B.parent().width("45%"),B=Global.loadWidgetByName(FormItemType.TAG_INPUT),B.TTagInput({field:"tag",object_type_id:950}),this.addEditFieldToColumn(jQuery.i18n._("Tags"),B,ne,"",null,null,!0),B=Global.loadWidgetByName(FormItemType.SEPARATED_BOX),B.SeparatedBox({label:jQuery.i18n._("Resume")}),B.addClass("resume-label"),this.addEditFieldToColumn(null,B,ne);var m=this.edit_view_tab.find("#tab_analysis"),L=m.find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(L),B=Global.loadWidgetByName(FormItemType.TEXT_INPUT),B.TTextInput({field:"analysis_rating",width:30}),R=jQuery("<div class='widget-h-box'></div>"),x=jQuery("<span class='widget-right-label'> "+jQuery.i18n._("(1=Excellent, 10=Poor)")+"</span>"),R.append(B),R.append(x),this.addEditFieldToColumn(jQuery.i18n._("Priority"),B,L,"",R),B=Global.loadWidgetByName(FormItemType.TEXT_AREA),B.TTextArea({field:"analysis_summary",width:"100%",height:100}),this.addEditFieldToColumn(jQuery.i18n._("Summary"),B,L,"",null,!0,!0),B.parent().width("45%"),B=Global.loadWidgetByName(FormItemType.TEXT_AREA),B.TTextArea({field:"analysis_strengths",width:"100%",height:100}),this.addEditFieldToColumn(jQuery.i18n._("Strengths"),B,L,"",null,!0,!0),B.parent().width("45%"),B=Global.loadWidgetByName(FormItemType.TEXT_AREA),B.TTextArea({field:"analysis_weaknesses",width:"100%",height:100}),this.addEditFieldToColumn(jQuery.i18n._("Weaknesses"),B,L,"",null,!0,!0),B.parent().width("45%")}checkTabPermissions(P){var Z=!1;switch(P){case"tab_analysis":Z=Global.getFeatureFlag("recruitment_analysis");break;default:Z=super.checkTabPermissions(P);break}return Z}setEditViewDataDone(){if(super.setEditViewDataDone(),!this.is_add){this.updateEmailLink(),this.removeFormItemResumePdf();var P=this,Z=jQuery("<div></div>").addClass("edit-view-form-item-div form_item_resume_pdf");P.edit_view_tab.find("#tab_job_application").find(".first-column").append(Z);var x={};x.filter_data={},x.filter_columns={id:!0,document_revision_id:!0},x.filter_data.object_id=this.current_edit_record.job_applicant_id,x.filter_data.object_type_id=this.job_applicant_document_object_type_id,this.document_api["get"+this.document_api.key_name](x,{onResult:function(V){var ne=[],B=V.getResult();if(B!==!0&&_.isArray(B))_.each(B,function(R){var N=ServiceCaller.getURLByObjectType("file_download")+"&object_type=document&parent_id="+R.id;N=N+"&parent_object_type_id="+P.job_applicant_document_object_type_id,N=N+"&object_id="+R.document_revision_id,ne.push(N)}),P.has_attached_resume=!0;else{Z.append('<p class="no-documents-message">'+jQuery.i18n._("Sorry, no documents have been attached yet.")+"</p>");return}new TTPDFViewer({urls:ne,target:Z[0]})}})}}buildSearchFields(){super.buildSearchFields();var P={};P.permission_section="job_application",this.search_fields=[new SearchField({label:jQuery.i18n._("Job Applicant"),in_column:1,field:"job_applicant_id",layout_name:"global_job_applicant",api_class:TTAPI.APIJobApplicant,multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:jQuery.i18n._("Job Vacancy"),in_column:1,field:"job_vacancy_id",layout_name:"global_job_vacancy",api_class:TTAPI.APIJobVacancy,multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:jQuery.i18n._("Interviewer"),in_column:1,field:"interviewer_user_id",default_args:P,layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:jQuery.i18n._("Type"),in_column:2,field:"type_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:jQuery.i18n._("Status"),in_column:2,field:"status_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:jQuery.i18n._("Priority"),in_column:2,field:"priority_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:jQuery.i18n._("Tags"),field:"tag",basic_search:!0,adv_search:!0,in_column:1,object_type_id:950,form_item_type:FormItemType.TAG_INPUT}),new SearchField({label:jQuery.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:jQuery.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX})]}getCustomContextMenuModel(){var P={exclude:["copy"],include:[{label:jQuery.i18n._("Hire Applicant"),id:"edit_employee",menu_align:"right",vue_icon:"tticon tticon-add_black_24dp",sort_order:7100},{label:jQuery.i18n._("Map"),id:"map",menu_align:"right",vue_icon:"tticon tticon-map_black_24dp",sort_order:8e3},{label:jQuery.i18n._("Analyze"),id:"analyze",menu_align:"right",vue_icon:"tticon tticon-lightbulb_black_24dp",sort_order:8100},{label:jQuery.i18n._("Jump To"),id:"jump_to_header",menu_align:"right",action_group:"jump_to",action_group_header:!0,permission_result:!1,sort_order:9050},{label:jQuery.i18n._("Edit Applicant"),id:"edit_job_applicant",menu_align:"right",action_group:"jump_to",group:"navigation",sort_order:9050}]};return P}removeFormItemResumePdf(){this.edit_view&&this.edit_view.find(".form_item_resume_pdf").length>0&&this.edit_view.find(".form_item_resume_pdf").remove()}onCustomContextClick(P){switch(P){case"map":this.onMapClick();break;case"edit_job_applicant":case"edit_employee":case"export_excel":this.onNavigationClick(P);break;case"analyze":this.onAnalyzeClick();break}}onMapClick(){if(Global.getProductEdition()>=15){this.is_viewing=!1;var P=this.getSelectedItems();this.is_mass_editing||__vitePreload(()=>import("./leaflet-timetrex-D9Z7_Af6.bundle.js"),__vite__mapDeps([0,1]),import.meta.url).then(Z=>{var x=Z.TTConvertMapData.processBasicFromGenericViewController(P);IndexViewController.openEditView(this,"Map",x)}).catch(Global.importErrorHandler)}}onAnalyzeClick(){this.has_attached_resume?this.api.analyzeJobApplication(this.current_edit_record.id,{onResult:P=>{let Z=P.getResult();Z?(this.setAnalysis(Z),TAlertManager.showAlert(jQuery.i18n._("Application Analysis Completed"))):TAlertManager.showAlert(jQuery.i18n._("Failed to Analyze Job Application."))}}):TAlertManager.showAlert(jQuery.i18n._("Cannot analyze Job Application as no resume is attached."))}getFilterColumnsFromDisplayColumns(){var P=super.getFilterColumnsFromDisplayColumns();return P==null&&(P={}),P.job_applicant_id=!0,P.latitude=!0,P.longitude=!0,this._getFilterColumnsFromDisplayColumns(P)}onNavigationClick(P){var Z=this,x,V;switch(P){case"edit_job_applicant":var ne=this.getSelectedItem();IndexViewController.openEditView(Z,"JobApplicant",ne.job_applicant_id);break;case"edit_employee":(function(R){Z.user_api.getUserDefaultData({onResult:function(N){var h=N.getResult();R(h)}})})(function(R){x={},Z.edit_view?V=Z.current_edit_record:V=Z.getSelectedItem(),x.filter_data={},x.filter_data.id=[V.job_applicant_id],Z.job_applicant_api.getJobApplicant(x,{onResult:function(N){var h=N.getResult();if(Global.isArray(h)&&h[0]){h=h[0];for(var m in R)h[m]||(h[m]=R[m])}else h=[];IndexViewController.openEditView(Z,"Employee",h)}})});break;case"export_excel":this.onExportClick("export"+this.api.key_name);break}}setCurrentEditRecordData(){super.setCurrentEditRecordData(),this.setAnalysis(this.current_edit_record.analysis)}setCustomDefaultMenuIcon(P,Z,x){switch(P){case"edit_job_applicant":case"edit_employee":this.setDefaultMenuEditIcon(Z,x,"user");break;case"analyze":this.setDefaultMenuAnalyzeIcon(Z,x);break}}setCustomEditMenuIcon(P,Z){switch(P){case"analyze":this.setEditMenuAnalyzeIcon(Z);break}}setDefaultMenuMapIcon(P){Global.getProductEdition()<=10&&ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,P.id,!1);var Z=!1;if(this.grid){var x=this.getSelectedItems();if(x.length>0){for(var V=0;V<x.length;V++)if(x[V]&&x[V].latitude&&x[V].longitude){Z=!0;break}}}Z?ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,P.id,!0):ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,P.id,!1)}setDefaultMenuAnalyzeIcon(P,Z){ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,P.id,!1),ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,P.id,!1)}setEditMenuAnalyzeIcon(P){Global.getProductEdition()<=10||!Global.getFeatureFlag("recruitment_analysis")?(ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,P.id,!1),ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,P.id,!1)):(ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,P.id,!0),ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,P.id,!0))}setEditMenuMapIcon(P){this.setDefaultMenuMapIcon(P)}searchDone(){super.searchDone(),TTPromise.resolve("JobAppView","init")}getDefaultDisplayColumns(P){this.sub_view_mode&&this.parent_view_controller.viewId==="JobApplicant"?(this.default_display_columns=["job_vacancy","status","priority","created_date"],P&&P()):this.sub_view_mode&&this.parent_view_controller.viewId==="JobVacancy"?(this.default_display_columns=["first_name","last_name","status","type","priority","created_date"],P&&P()):super.getDefaultDisplayColumns(P)}onFormItemChange(P,Z){if(this.current_edit_record){this.setIsChanged(P),this.setMassEditingFieldsWhenFormChange(P);var x=P.getField();this.current_edit_record[x]=P.getValue(),x==="job_applicant_id"&&this.updateEmailLink(),Z||this.validate()}}setAnalysis(P){if(P)for(let Z in P)this.edit_view_ui_dic["analysis_"+Z]&&(this.edit_view_ui_dic["analysis_"+Z].setEnabled(!1),this.edit_view_ui_dic["analysis_"+Z].setValue(P[Z]))}updateEmailLink(){var P={};P.filter_data={id:this.current_edit_record.job_applicant_id},P.filter_columns={email:!0},this.job_applicant_api.getJobApplicant(P,{onResult:Z=>{var x=Z.getResult();Array.isArray(x)&&x[0].email&&(document.getElementById("job-email-link").href="mailto:"+x[0].email+"?subject="+jQuery.i18n._("Re")+": "+this.current_edit_record.job_vacancy+" "+jQuery.i18n._("Application"))}})}}JobApplicationViewController.loadSubView=function(me,P,Z){Global.loadViewSource("JobApplication","SubApplicationView.html",function(x){var V={},ne=_.template(x);Global.isSet(P)&&P(),Global.isSet(me)&&(me.html(ne(V)),Global.isSet(Z)&&Z(sub_job_application_view_controller))})};export{JobApplicationViewController};
//# sourceMappingURL=JobApplicationViewController-CqVp5Nun.bundle.js.map
