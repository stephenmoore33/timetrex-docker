{"version":3,"file":"ShareReportWizardController-D7TG_yYv.bundle.js","sources":["../../views/wizard/share_report/ShareReportWizardController.js"],"sourcesContent":["export class ShareReportWizardController extends BaseWizardController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '.wizard-bg'\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\n\t\tthis.title = $.i18n._( 'Share Report Wizard' );\n\t\tthis.steps = 2;\n\t\tthis.current_step = 1;\n\n\t\tthis.render();\n\t}\n\n\trender() {\n\t\tsuper.render();\n\n\t\tthis.initCurrentStep();\n\t}\n\n\t//Create each page UI\n\tbuildCurrentStepUI() {\n\t\tvar $this = this;\n\t\tthis.content_div.empty();\n\n\t\tthis.stepsWidgetDic[this.current_step] = {};\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tvar label = this.getLabel();\n\t\t\t\tlabel.text( $.i18n._( 'Select one or more saved report you wish to share' ) );\n\n\t\t\t\tvar a_combobox = this.getAComboBox( TTAPI.APIUserReportData, true, 'global_job', 'user_report_data_ids', false );\n\t\t\t\tvar div = $( '<div class=\\'wizard-acombobox-div\\'></div>' );\n\t\t\t\tdiv.append( a_combobox );\n\n\t\t\t\tthis.content_div.append( label );\n\t\t\t\tthis.content_div.append( div );\n\n\t\t\t\tthis.stepsWidgetDic[this.current_step][a_combobox.getField()] = a_combobox;\n\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tlabel = this.getLabel();\n\t\t\t\tlabel.text( $.i18n._( 'Select one or more employees to share report with' ) );\n\n\t\t\t\ta_combobox = this.getAComboBox( TTAPI.APIUser, true, 'global_user', 'destination_user_ids', false );\n\t\t\t\tdiv = $( '<div class=\\'wizard-acombobox-div\\'></div>' );\n\t\t\t\tdiv.append( a_combobox );\n\n\t\t\t\tthis.stepsWidgetDic[this.current_step] = {};\n\t\t\t\tthis.stepsWidgetDic[this.current_step][a_combobox.getField()] = a_combobox;\n\n\t\t\t\tthis.content_div.append( label );\n\t\t\t\tthis.content_div.append( div );\n\t\t\t\tbreak;\n\n\t\t}\n\t}\n\n\tbuildCurrentStepData() {\n\t\tvar $this = this;\n\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tif ( !current_step_data ) {\n\t\t\t\t\tfor ( var key in current_step_ui ) {\n\n\t\t\t\t\t\tif ( !current_step_ui.hasOwnProperty( key ) ) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( this.default_data ) {\n\t\t\t\t\t\t\tcurrent_step_ui[key].setValue( this.default_data );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor ( var key in current_step_data ) {\n\t\t\t\t\t\tif ( !current_step_data.hasOwnProperty( key ) ) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcurrent_step_ui[key].setValue( current_step_data[key] );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfor ( var key in current_step_data ) {\n\t\t\t\t\tif ( !current_step_data.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tcurrent_step_ui[key].setValue( current_step_data[key] );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonDoneClick() {\n\t\tvar $this = this;\n\t\tsuper.onDoneClick();\n\t\tthis.saveCurrentStep();\n\n\t\tvar report_ids = this.stepsDataDic[1].user_report_data_ids;\n\t\tvar user_ids = this.stepsDataDic[2].destination_user_ids;\n\n\t\tvar api = TTAPI.APIUserReportData;\n\n\t\tapi.shareUserReportData( report_ids, user_ids, {\n\t\t\tonResult: function( result ) {\n\n\t\t\t\tif ( result.isValid() ) {\n\t\t\t\t\tTAlertManager.showAlert( $.i18n._( 'Report shared successfully' ) );\n\t\t\t\t\t$( $this.el ).remove();\n\t\t\t\t} else {\n\t\t\t\t\tTAlertManager.showErrorAlert( result );\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tsaveCurrentStep() {\n\t\tthis.stepsDataDic[this.current_step] = {};\n\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\t\tswitch ( this.current_step ) {\n\t\t\tdefault:\n\n\t\t\t\tfor ( var key in current_step_ui ) {\n\t\t\t\t\tif ( !current_step_ui.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tcurrent_step_data[key] = current_step_ui[key].getValue();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsetDefaultDataToSteps() {\n\n\t\tif ( !this.default_data ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n}"],"names":["ShareReportWizardController","options","_","$","label","a_combobox","div","current_step_data","current_step_ui","key","$this","report_ids","user_ids","api","result"],"mappings":"uDAAO,MAAMA,UAAoC,oBAAqB,CACrE,YAAaC,EAAU,GAAK,CAC3BC,EAAE,SAAUD,EAAS,CACpB,GAAI,YACP,GAEE,MAAOA,CAAO,CACd,CAED,KAAMA,EAAU,CAGf,KAAK,MAAQE,EAAE,KAAK,EAAG,qBAAqB,EAC5C,KAAK,MAAQ,EACb,KAAK,aAAe,EAEpB,KAAK,OAAM,CACX,CAED,QAAS,CACR,MAAM,OAAM,EAEZ,KAAK,gBAAe,CACpB,CAGD,oBAAqB,CAKpB,OAHA,KAAK,YAAY,QAEjB,KAAK,eAAe,KAAK,YAAY,EAAI,CAAA,EAChC,KAAK,aAAY,CACzB,IAAK,GACJ,IAAIC,EAAQ,KAAK,WACjBA,EAAM,KAAMD,EAAE,KAAK,EAAG,mDAAmD,GAEzE,IAAIE,EAAa,KAAK,aAAc,MAAM,kBAAmB,GAAM,aAAc,uBAAwB,IACrGC,EAAMH,EAAG,4CACbG,EAAI,OAAQD,GAEZ,KAAK,YAAY,OAAQD,GACzB,KAAK,YAAY,OAAQE,GAEzB,KAAK,eAAe,KAAK,YAAY,EAAED,EAAW,SAAQ,CAAE,EAAIA,EAEhE,MACD,IAAK,GACJD,EAAQ,KAAK,WACbA,EAAM,KAAMD,EAAE,KAAK,EAAG,mDAAmD,GAEzEE,EAAa,KAAK,aAAc,MAAM,QAAS,GAAM,cAAe,uBAAwB,IAC5FC,EAAMH,EAAG,4CACTG,EAAI,OAAQD,GAEZ,KAAK,eAAe,KAAK,YAAY,EAAI,CAAA,EACzC,KAAK,eAAe,KAAK,YAAY,EAAEA,EAAW,SAAQ,CAAE,EAAIA,EAEhE,KAAK,YAAY,OAAQD,GACzB,KAAK,YAAY,OAAQE,GACzB,KAED,CACD,CAED,sBAAuB,CAEtB,IAAIC,EAAoB,KAAK,aAAa,KAAK,YAAY,EACvDC,EAAkB,KAAK,eAAe,KAAK,YAAY,EAE3D,OAAS,KAAK,aAAY,CACzB,IAAK,GACJ,GAAMD,EAaL,QAAUE,KAAOF,EACVA,EAAkB,eAAgBE,IAIxCD,EAAgBC,CAAG,EAAE,SAAUF,EAAkBE,CAAG,CAAC,MAjBtD,SAAUA,KAAOD,EAEVA,EAAgB,eAAgBC,IAIjC,KAAK,cACTD,EAAgBC,CAAG,EAAE,SAAU,KAAK,YAAY,EAcnD,MACD,QACC,QAAUA,KAAOF,EACVA,EAAkB,eAAgBE,IAIxCD,EAAgBC,CAAG,EAAE,SAAUF,EAAkBE,CAAG,CAAC,EAEtD,KACD,CACD,CAED,aAAc,CACb,IAAIC,EAAQ,KACZ,MAAM,YAAW,EACjB,KAAK,gBAAe,EAEpB,IAAIC,EAAa,KAAK,aAAa,CAAC,EAAE,qBAClCC,EAAW,KAAK,aAAa,CAAC,EAAE,qBAEhCC,EAAM,MAAM,kBAEhBA,EAAI,oBAAqBF,EAAYC,EAAU,CAC9C,SAAU,SAAUE,EAAS,CAEvBA,EAAO,WACX,cAAc,UAAWX,EAAE,KAAK,EAAG,4BAA4B,GAC/DA,EAAGO,EAAM,EAAI,EAAC,OAAM,GAEpB,cAAc,eAAgBI,EAG/B,CACJ,EACE,CAED,iBAAkB,CACjB,KAAK,aAAa,KAAK,YAAY,EAAI,CAAA,EACvC,IAAIP,EAAoB,KAAK,aAAa,KAAK,YAAY,EACvDC,EAAkB,KAAK,eAAe,KAAK,YAAY,EAC3D,OAAS,KAAK,aAAY,CACzB,QAEC,QAAUC,KAAOD,EACVA,EAAgB,eAAgBC,KAItCF,EAAkBE,CAAG,EAAID,EAAgBC,CAAG,EAAE,SAAQ,GAEvD,KACD,CACD,CAED,uBAAwB,CAEvB,GAAK,CAAC,KAAK,aACV,OAAO,IAER,CAEF"}