import{_,j as jQuery,z as Backbone,T as Tooltip,G as bootstrap$1}from"./vendor-tTApdY0Y.bundle.js";import{T as TTAPI,i as PortalForgotPasswordController,S as ServiceCaller,e as TTBackboneView,j as HeaderUploadResumeWidget,g as TTUUID,f as TAlertManager,k as PortalJobVacancyRowController}from"./main_ui-z76rxVqJ.entry.bundle.js";import{P as PortalResetForgotPasswordController}from"./PayrollRemittanceAgencyEventWizardStepSubmit-ByowDQe1.bundle.js";import"./TImageBrowser-CvdFimWY.bundle.js";import"./datepicker-Bxb9_ya8.bundle.js";import{MyJobApplicationViewController}from"./MyJobApplicationViewController-B6L29qlb.bundle.js";let SignInController$1=class extends PortalBaseViewController{constructor(e={}){_.defaults(e,{doing_login:!1,edit_view_error_ui_dic:{},_delegate:null,events:{"click #forgot_password":"forgotPasswordClick"}}),super(e)}init(e){var i=this;i.recruitment_api=TTAPI.APIRecruitmentAuthentication,i.jobapplicant_api=TTAPI.APIJobApplicantPortal,i.authentication_api=TTAPI.APIAuthentication;var t=Global.loadWidget("views/portal/sign_in/SignIn.html");i.setElement(_.template(t)()),i.user_name=i.$("#user_name"),i.password=i.$("#password"),Global.isSet(e)&&Global.isSet(e._delegate)&&(i._delegate=e._delegate),LocalCacheData.getAllURLArgs().sm==="ResetPassword"&&LocalCacheData.getAllURLArgs().key&&LocalCacheData.getAllURLArgs().company_id?new PortalResetForgotPasswordController({callback:function(){LocalCacheData.setAllURLArgs(_.omit(LocalCacheData.getAllURLArgs(),"sm")),LocalCacheData.setAllURLArgs(_.omit(LocalCacheData.getAllURLArgs(),"key"));var a=Global.getBaseURL(null,!0,!0).replace(/#!m=.*?(&|$)/g,"#!m=PortalJobVacancy$1").replace(Global.getBaseURL(null,!0,!1),"");IndexViewController$1.instance.router.navigate(a,{trigger:!1,replace:!0}),i.setLoginTips(jQuery.i18n._("Password has been changed successfully, you may now login"))}}):i.render()}render(){var e=this;LocalCacheData.setSessionID(""),this.user_name.focus(),this.password.unbind("keydown").bind("keydown",function(i){i.keyCode===13&&e.onLoginBtnClick()}),LocalCacheData.getAllURLArgs().user_name&&this.user_name.val(LocalCacheData.getAllURLArgs().user_name),LocalCacheData.getAllURLArgs().password&&this.password.val(LocalCacheData.getAllURLArgs().password),this.showSignInModal()}showSignInModal(){var e=this;IndexViewController$1.instance.router.showSignInModal(this.$el,{title:jQuery.i18n._("Sign In"),actions:[{label:jQuery.i18n._("Cancel"),isClose:!0},{label:jQuery.i18n._("Sign In"),callBack:function(i){e.onLoginBtnClick()}}]})}hideSignInModal(e){e&&jQuery("#signinModal").unbind("hidden.bs.modal").bind("hidden.bs.modal",function(i){e()}),IndexViewController$1.instance.router.hideSignInModal()}forgotPasswordClick(){this.hideSignInModal(function(){new PortalForgotPasswordController,jQuery("#signinModal").unbind("hidden.bs.modal")})}onLoginBtnClick(){var e=this.user_name.val(),i=this.password.val(),t=this;if(!this.doing_login)this.doing_login=!0;else return;this.recruitment_api.Login(e,i,{onResult:function(a){t.onLoginSuccess(a),t.setLocalCacheCompany()},delegate:this})}setLocalCacheCompany(){this.authentication_api.getCurrentCompany({onResult:function(e){var i=e.getResult();LocalCacheData.setCurrentCompany(i)}})}onLoginSuccess(e,i){var t,a=this;i?t=i:t=e.getResult(),LocalCacheData.setLoginUserPreference(null),e&&!e.isValid()?(LocalCacheData.setSessionID(""),deleteCookie(Global.getSessionIDKey()),e.getDetails()[0].hasOwnProperty("password")?(a.hideSignInModal(),a.password.val(""),IndexViewController$1.openWizard("ResetPasswordWizard",{user_name:a.user_name.val(),api_class:TTAPI.APIRecruitmentAuthentication,message:e.getDetailsAsString()},function(){a.setLoginTips(jQuery.i18n._("Password has been changed successfully, you may now login"))})):this.setErrorTips(e),a.doing_login=!1):(this.clearErrorTips(),ServiceCaller.cancel_all_error=!1,IndexViewController$1.setPortalLoginUserData(t,function(){IndexViewController$1.instance.router.headerView.render(),a._delegate&&a._delegate.render(),a.hideSignInModal(),a.doing_login=!1}))}setLoginTips(e){typeof this.$(".alert")[0]<"u"&&this.$(".alert").remove();var i=Global.loadWidget("views/portal/alert/alert.html");this.$(".signIn-form").before(i),this.$(".alert").append("<p>"+e+"</p>"),this.showSignInModal()}setErrorTips(e){var i=e.getDetails()?e.getDetails()[0]:{};i&&i.hasOwnProperty("error")&&(i=i.error);for(var t in i)if(i.hasOwnProperty(t)){var a;if(document.getElementById(t)&&(a=document.getElementById(t)),a){a.classList.add("error-tip");var r;_.isArray(i[t])?r=i[t][0]:r=i[t];var o=new bootstrap.Tooltip(a,{title:r});o.show(),this.edit_view_error_ui_dic[t]=o}}}clearErrorTips(){Global.removeErrorTips(Object.values(this.edit_view_error_ui_dic).map(e=>e[0]),!0),this.edit_view_error_ui_dic={}}};const SignInController$2=Object.freeze(Object.defineProperty({__proto__:null,SignInController:SignInController$1},Symbol.toStringTag,{value:"Module"}));class HeaderViewController extends TTBackboneView{constructor(e={}){_.defaults(e,{events:{"click .navbar-signin .login":"goPortalLogin","click .navbar-signin .logout":"doLogout","click .navbar-signin .profile":"goProfile"}}),super(e)}initialize(t){super.initialize(t);var i,t={};LocalCacheData.getAllURLArgs().company_id?i=ServiceCaller.getAPIURL("Class=APIDocumentPortal&Method=getCompanyLogo&v=2")+"&company_id="+LocalCacheData.getAllURLArgs().company_id:i="../../theme/default/portal/images/t_icon_logo.png";var a=Global.loadWidget("views/portal/header/HeaderView.html");let r=Global.getBaseURL()+"#!m=PortalJobVacancy&company_id="+LocalCacheData.getAllURLArgs().company_id;this.setElement(_.template(a)({company_logo:i,portal_vacancy_link:r})),this.uploadResumeWidget=null,this.profileView=null,this.jobVacancyDetailController=null,this.jobVacancyViewController=null,this.render()}render(){if(LocalCacheData.getPortalLoginUser()){var i=jQuery('<div class="dropdown"></div>');i.append('<div class="dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">'+LocalCacheData.getPortalLoginUser().first_name+" "+LocalCacheData.getPortalLoginUser().last_name+' <span class="caret"></span></div>');var t=jQuery('<ul class="dropdown-menu" aria-labelledby="dropdownMenuButton"></ul>');t.append('<li><a class="profile" href="javascript:;">'+jQuery.i18n._("My Profile")+"</a></li>"),t.append('<li><a class="logout" href="javascript:;">'+jQuery.i18n._("Sign Out")+"</a></li>"),i.append(t),this.$(".navbar-signin").html(i)}else{var e=jQuery('<a class="login"></a>');e.attr("href","javascript:;"),e.append(jQuery("<img>").attr("src","../../theme/default/portal/images/t_icon_head.png")),e.append(jQuery("<span>").text(jQuery.i18n._("Sign In"))),this.$(".navbar-signin").html(e)}}goPortalLogin(){new SignInController$1({_delegate:this.jobVacancyDetailController})}doLogout(){this.clearErrorTips();var e=this,i=TTAPI.APIRecruitmentAuthentication;i.Logout({onResult:function(t){if(deleteCookie(Global.getSessionIDKey()),LocalCacheData.setPortalLoginUser(!1),LocalCacheData.current_open_view_id="",e.jobVacancyViewController)e.render();else if(window.location.href.indexOf("#!m=PortalJobVacancy&")!==-1)IndexViewController.instance.router.headerView.render();else{var a=Global.getBaseURL(null,!0,!0).replace(/#!m=.*?(&|$)/g,"#!m=PortalJobVacancy$1").replace(Global.getBaseURL(null,!0,!1),"");IndexViewController.instance.router.navigate(a,{trigger:!0,replace:!0})}}})}clearErrorTips(){Global.removeErrorTips(document.querySelectorAll(".error-tip"),!0)}goProfile(){window.location=Global.getBaseURL(null,!0,!0).replace(/#!m=.*?(&|$)/g,"#!m=MyProfile$1").replace(/&id=[^&]*/g,"")}uploadResume(){var e=this;LocalCacheData.getPortalLoginUser()?(this.uploadResumeWidget||(this.uploadResumeWidget=new HeaderUploadResumeWidget({profileView:e.profileView})),this.uploadResumeWidget.render()):this.goPortalLogin()}}const HeaderViewController$1=Object.freeze(Object.defineProperty({__proto__:null,HeaderViewController},Symbol.toStringTag,{value:"Module"}));/*!
 * Responsive Bootstrap Toolkit
 * Author:    Maciej Gurban
 * License:   MIT
 * Version:   2.6.3 (2016-06-21)
 * Origin:    https://github.com/maciej-gurban/responsive-bootstrap-toolkit
 */window.ResponsiveBootstrapToolkit=function(l){var e={detectionDivs:{bootstrap:{xs:l('<div class="device-xs visible-xs visible-xs-block"></div>'),sm:l('<div class="device-sm visible-sm visible-sm-block"></div>'),md:l('<div class="device-md visible-md visible-md-block"></div>'),lg:l('<div class="device-lg visible-lg visible-lg-block"></div>')},foundation:{small:l('<div class="device-xs show-for-small-only"></div>'),medium:l('<div class="device-sm show-for-medium-only"></div>'),large:l('<div class="device-md show-for-large-only"></div>'),xlarge:l('<div class="device-lg show-for-xlarge-only"></div>')}},applyDetectionDivs:function(){l(document).ready(function(){l.each(i.breakpoints,function(t){i.breakpoints[t].appendTo(".responsive-bootstrap-toolkit")})})},isAnExpression:function(t){return t.charAt(0)=="<"||t.charAt(0)==">"},splitExpression:function(t){var a=t.charAt(0),r=t.charAt(1)=="=",o=1+(r?1:0),n=t.slice(o);return{operator:a,orEqual:r,breakpointName:n}},isAnyActive:function(t){var a=!1;return l.each(t,function(r,o){return i.breakpoints[o].is(":visible")?(a=!0,!1):void 0}),a},isMatchingExpression:function(t){var a=e.splitExpression(t),r=Object.keys(i.breakpoints),o=r.indexOf(a.breakpointName);if(o!==-1){var n=0,s=0;a.operator=="<"&&(n=0,s=a.orEqual?++o:o),a.operator==">"&&(n=a.orEqual?o:++o,s=void 0);var c=r.slice(n,s);return e.isAnyActive(c)}}},i={interval:300,framework:null,breakpoints:null,is:function(t){return e.isAnExpression(t)?e.isMatchingExpression(t):i.breakpoints[t]&&i.breakpoints[t].is(":visible")},use:function(t,a){i.framework=t.toLowerCase(),i.framework==="bootstrap"||i.framework==="foundation"?i.breakpoints=e.detectionDivs[i.framework]:i.breakpoints=a,e.applyDetectionDivs()},current:function(){var t="unrecognized";return l.each(i.breakpoints,function(a){i.is(a)&&(t=a)}),t},changed:function(t,a){var r;return function(){clearTimeout(r),r=setTimeout(function(){t()},a||i.interval)}}};return l(document).ready(function(){l('<div class="responsive-bootstrap-toolkit"></div>').appendTo("body")}),i.framework===null&&i.use("bootstrap"),i}(jQuery);typeof module<"u"&&module.exports&&(module.exports=ResponsiveBootstrapToolkit);class PortalJobVacancyDetailController extends PortalBaseViewController{constructor(e={}){_.defaults(e,{edit_view_error_ui_dic:{},events:{"click #applyBtn":"debouncedOnApplyJobClick","click #available_jobs":"availableJobsClick","click #applied_jobs":"appliedJobsClick","click #applied_btn":"appliedJobsClick","click .sign-in":"signIN"}}),super(e),this.debouncedOnApplyJobClick=_.debounce(this.onApplyJobClick.bind(this),Global.calcDebounceWaitTimeBasedOnNetwork(),!0),this.events["click #applyBtn"]="debouncedOnApplyJobClick",this.delegateEvents()}init(){this.viewId="PortalJobVacancyDetail",this.script_name="JobVacancyDetailView",this.job_applicant_api=TTAPI.APIJobApplicantPortal,this.viewport=jQuery.extend({},ResponsiveBootstrapToolkit),this.render()}render(){var e=this;LocalCacheData.getPortalLoginUser()?this.setRegisterContainerStatus(function(i){e.showJobVacancy({applied:i})}):this.showJobVacancy()}showJobVacancy(e){var i=this,t=Global.loadWidget("views/portal/hr/recruitment/PortalJobVacancyDetail.html"),a={first_name:"",last_name:"",email:"",applied:!1};LocalCacheData.getPortalLoginUser()&&(a={first_name:LocalCacheData.getPortalLoginUser().first_name,last_name:LocalCacheData.getPortalLoginUser().last_name,email:LocalCacheData.getPortalLoginUser().email}),Global.isSet(e)&&Global.isSet(e.applied)&&(a.applied=e.applied);for(var r in this.model.attributes)this.model.get(r)==!1&&this.model.set(r,"");this.$el.html(_.template(t)(jQuery.extend(a,this.model.toJSON()))),this.$('input[type="text"], input[type="email"]').each(function(){jQuery(this).unbind("focus").bind("focus",function(){jQuery(this).parent().addClass("job-apply-form-focus")})}),this.$('input[type="text"], input[type="email"]').each(function(){jQuery(this).unbind("blur").bind("blur",function(){jQuery(this).parent().removeClass("job-apply-form-focus")})}),this.setDetailAndApplyFormHeight(),jQuery(window).resize(i.viewport.changed(function(){i.setDetailAndApplyFormHeight()})),this.uploader=this.$(".register-resume").TImageBrowser({field:"file",name:"file_data",accept_filter:"*",changeHandler:function(n){var s=jQuery(this).find(".browser")[0].files[0].name;i.$(".apply-form #file_name").val(s)}});let o=document.querySelector(".apply-form");o&&Global.initFileDragAndDrop(o,n=>{this.attachDragAndDropFile(n)}),jQuery(".apply-form").unbind("keydown").bind("keydown",function(n){n.keyCode===13&&i.onApplyJobClick()})}attachDragAndDropFile(e){let i=new DataTransfer;i.items.add(e[0]),this.uploader[0].querySelector("input").files=i.files,this.$(".apply-form #file_name").val(e[0].name)}setDetailAndApplyFormHeight(){var e=this.$(".job-header").height(),i=this.$(".job-apply").height();this.viewport.is("md")||this.viewport.is(">md")?e!==i&&(e>i?this.$(".job-apply").height(e-20):this.$(".job-header").height(i+20)):this.viewport.is("<=sm")&&this.$(".job-apply").height(70)}onApplyJobClick(){var e=this;LocalCacheData.getPortalLoginUser()?this.getJobApplication(function(i){if(i&&i.isValid()){var t=i.getResult();if(Global.isArray(t)||(t=[]),t.length>0){var a=Global.getBaseURL(null,!0,!0).replace(/#!m=.*?(&|$)/g,"#!m=MyProfile$1");window.location=a}else e.uploadResume(),e.saveCurrentJobVacancy()}}):this.registerNewUser(function(i,t){var a=TTAPI.APIRecruitmentAuthentication;a.Login(i,t,{onResult:function(r){e.onLoginSuccess(r)}})})}availableJobsClick(){window.location=Global.getBaseURL(null,!0,!0).replace(/#!m=.*?(&|$)/g,"#!m=PortalJobVacancy$1").replace(/&id=[^&]*/g,""),LocalCacheData.setAllURLArgs({})}appliedJobsClick(){window.location=Global.getBaseURL(null,!0,!0).replace(/#!m=.*?(&|$)/g,"#!m=MyJobApplication$1").replace(/&id=[^&]*/g,""),LocalCacheData.setAllURLArgs({})}signIN(){new SignInController({_delegate:this})}onLoginSuccess(e,i){var t,a=this;i?t=i:t=e.getResult(),ServiceCaller.cancel_all_error=!1,LocalCacheData.setSessionID(t),setCookie(Global.getSessionIDKey(),t);var r=TTAPI.APIJobApplicantPortal;r.getJobApplicant({onResult:function(o){o&&o.isValid()?(LocalCacheData.setPortalLoginUser(o.getResult()[0]),IndexViewController.instance.router.headerView.render(),a.uploadResume(),a.saveCurrentJobVacancy()):ProgressBar.closeOverlay()}})}setRegisterContainerStatus(e){this.getJobApplication(function(i){var t=!1;if(i&&i.isValid()){var a=i.getResult();Global.isArray(a)||(a=[]),a.length>0&&(t=!0)}e(t)})}getJobApplication(e){var i={};i.filter_data={},i.filter_data.job_vacancy_id=this.model.id,this.job_applicant_api.getJobApplication(i,{onResult:function(t){e(t)}})}saveCurrentJobVacancy(e){var i=this,t={};t.job_vacancy_id=this.model.id,this.job_applicant_api.setJobApplication(t,{onResult:function(a){a.isValid()?i.render():i.showValidateErrorTips(a)}})}showAlert(e){IndexViewController.instance.router.showTipModal(e,{style:{border:"2px solid #154575",color:"#154575"}})}uploadResume(){if(!this.uploader)return!1;if(document.getElementById("file_browser")!==null){var e=this.uploader;e.attr("file_name");var i=e.getValue();if(i){this.document_api=TTAPI.APIDocumentPortal;var t="Resume - "+this.$('.apply-form input[id="first_name"]').val()+" "+this.$('.apply-form input[id="last_name"]').val(),a=this.document_api.addAttachment(t,"",{async:!1}).getResult().document_revision_id;this.uploadFile(i,a)}else this.applyFail(jQuery.i18n._("No resume uploaded."))}}getProfileURL(){return Global.getBaseURL(null,!0,!0).replace(/#!m=.*?(&|$)/g,"#!m=MyProfile$1")}applySuccess(){var e=jQuery("<div>");e.append("<p><strong>"+jQuery.i18n._("Application sent successfully!")+"</strong></p>"),e.append("<p>"+jQuery.i18n._("Please ensure all sections of your profile are accurate and complete.")+"</p>"),this.showAlert(e),window.location=this.getProfileURL()}applyFail(e){var i=jQuery("<div>");i.append('<p><strong><font color="red">'+e+"</font></strong></p>"),i.append("<p>"+jQuery.i18n._("Please complete your profile and ensure all information is accurate and complete.")+"</p>"),this.showAlert(i),window.location=this.getProfileURL()}uploadFile(e,i){var t=this,a=ServiceCaller.getAPIURL("Class="+this.document_api.className+"&Method=uploadAttachment&v=2");LocalCacheData.getAllURLArgs().company_id&&(a=a+"&company_id="+LocalCacheData.getAllURLArgs().company_id),a=a+"&object_id="+i;var r=TTUUID.generateUUID();ProgressBar.showProgressBar(r),ProgressBar.changeProgressBarMessage("File Uploading"),jQuery.ajax({url:a,headers:{"X-Client-ID":"Browser-TimeTrex","X-CSRF-Token":getCookie("CSRF-Token")},type:"POST",data:e,success:function(o){ProgressBar.removeProgressBar(),o.error==""?t.applySuccess():t.applyFail(o.error)},cache:!1,contentType:!1,processData:!1})}registerNewUser(e){var i=this,t={};if(t.first_name=this.$('.apply-form input[id="first_name"]').val(),t.last_name=this.$('.apply-form input[id="last_name"]').val(),t.user_name=this.$('.apply-form input[id="email"]').val(),t.email=t.user_name,t.password=Math.random().toString(36).replace(/[^a-z0-9]+/g,""),t.company_id=LocalCacheData.getAllURLArgs().company_id,this.$('.apply-form input[id="email"]').val()===this.$('.apply-form input[id="confirm_email"]').val()){if(this.edit_view_error_ui_dic.hasOwnProperty("confirm_email")&&Global.removeErrorTips([this.edit_view_error_ui_dic.confirm_email[0]],!0),t.first_name!=""&&t.last_name!=""&&t.email!=""&&!this.uploader.getValue()){IndexViewController.instance.router.showConfirmModal(jQuery.i18n._("Are you sure you want to apply for this position without uploading a resume?"),{title:"",actions:[{label:"No",isClose:!0,callBack:function(r){}},{label:"Yes",callBack:function(r){IndexViewController.instance.router.hideConfirmModal(),i.setJobApplicant(t,e)}}]});return}this.setJobApplicant(t,e)}else{this.removeValidateErrorTips();var a=this.$(".apply-form").find('input[id="confirm_email"]');a[0].classList.add("error-tip");const r=new bootstrap.Tooltip(a[0],{title:"Confirm email does not match email"});r&&r.show(),this.edit_view_error_ui_dic.confirm_email=a}}setJobApplicant(e,i){var t=this;this.job_applicant_api.setIsIdempotent(!0),this.job_applicant_api.setJobApplicant(e,{onResult:function(a){a&&a.isValid()?(t.removeValidateErrorTips(),t.edit_view_error_ui_dic={},i(e.user_name,e.password)):t.showValidateErrorTips(a)}})}showValidateErrorTips(e,i){const t=e.getDetails()||e.getDescription();return(Global.isArray(t)||typeof t=="object")&&(this.removeValidateErrorTips(),Object.values(t).forEach(a=>{a.hasOwnProperty("error")&&(a=a.error);for(let r in a){if(!a.hasOwnProperty(r))continue;let o="";r==="user_name"&&(r="email",o=jQuery.i18n._("Email address already exists, please login instead"));let n=null;this.$(".apply-form").find(`input[id="${r}"]`)[0]?n=this.$(".apply-form").find(`input[id="${r}"]`):n=this.$(".apply-form"),n&&(n.addClass("error-tip"),o||(o=_.isArray(a[r])?a[r][0]:a[r]),n.attr({title:o,"data-bs-original-title":o}),new bootstrap.Tooltip(n[0],{title:o}).show(),this.edit_view_error_ui_dic[r]=n)}})),!1}removeValidateErrorTips(){const e=[];for(const i in this.edit_view_error_ui_dic)i==="email"||i==="confirm_email"||e.push(this.edit_view_error_ui_dic[i]);Global.removeErrorTips(e.map(i=>i[0]),!0)}}const PortalJobVacancyDetailController$1=Object.freeze(Object.defineProperty({__proto__:null,PortalJobVacancyDetailController},Symbol.toStringTag,{value:"Module"}));class PortalJobVacancyDetailViewController extends PortalBaseViewController{constructor(e={}){_.defaults(e,{el:".job-vacancy-detail-view",api:null}),super(e)}init(){this.script_name="JobVacancyDetailView",this.api=TTAPI.APIJobVacancyPortal,this.job_detail_panel=this.$(".search-result"),this.job_detail_panel.empty(),this.render()}render(){ProgressBar.showOverlay(),this.search()}search(){var e=this,i={};i.filter_data={},LocalCacheData.edit_id_for_next_open_view&&(this.view_id=LocalCacheData.edit_id_for_next_open_view,i.filter_data.id=[this.view_id],ProgressBar.showOverlay(),this.api.getJobVacancy(i,{onResult:function(t){var a=t.getResult();if(a||(a=[]),a=a[0],a){var r=new Backbone.Model(a),o=new PortalJobVacancyDetailController({model:r,el:e.$el});IndexViewController$1.instance.router.headerView.jobVacancyDetailController=o}}}),LocalCacheData.edit_id_for_next_open_view=null)}goPortalLogin(){var e=Global.getBaseURL(null,!0,!0).replace(/#!m=.*?(&|$)/g,"#!m=PortalJobVacancy$1");window.location.href===e?IndexViewController$1.instance.router.reloadView("PortalJobVacancy"):window.location=e}}PortalJobVacancyDetailViewController.html_template=`
<div class="view job-vacancy-detail-view"></div>`;const PortalJobVacancyDetailViewController$1=Object.freeze(Object.defineProperty({__proto__:null,PortalJobVacancyDetailViewController},Symbol.toStringTag,{value:"Module"}));class PortalJobVacancyViewController extends PortalBaseViewController{constructor(e={}){_.defaults(e,{el:"#job_vacancy_view_container"}),super(e)}init(e){this.api=TTAPI.APIJobVacancyPortal,this.script_name="JobVacancyView",this.render(),TTPromise.resolve("IndexController","onViewChange")}search(){this.onSearchClick({callback:function(){LocalCacheData.getAllURLArgs().sm==="ResetPassword"&&LocalCacheData.getAllURLArgs().key&&LocalCacheData.getAllURLArgs().company_id&&new SignInController$1}})}}PortalJobVacancyViewController.html_template=`
<div id="job_vacancy_view_container">
	<div class="search-bar">
		<div class="container">
			<form>
				<div class="row">
					<div class="col-md-3">
						<div class="form-group">
							<label class="sr-only" for="name">title</label>
							<input class="form-control" id="name" placeholder="<%= $.i18n._('Search Title') %>">
						</div>
					</div>
					<div class="col-md-2">
						<div class="form-group">
							<label for="country" class="sr-only">country</label>
							<div class="styled-select">
								<select class="form-control" id="country"></select>
							</div>
						</div>
					</div>
					<div class="col-md-2">
						<div class="form-group">
							<label for="province" class="sr-only">province</label>
							<div class="styled-select">
								<select class="form-control" id="province">
									<option value=""><%= $.i18n._('All Province/States') %></option>
								</select>
							</div>
						</div>
					</div>
					<div class="col-md-2">
						<div class="form-group">
							<label for="city" class="sr-only">city</label>
							<input class="form-control" id="city" placeholder="<%= $.i18n._('Search City') %>">
						</div>
					</div>
					<div class="col-md-3">
						<button type="button" class="btn btn-block btn-default search-btn w-100"><%= $.i18n._('Search') %> <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span></button>
					</div>
				</div>
			</form>
		</div>
	</div>
	<div class="search-result">
		<div class="content container"></div>
		<div class="more container">
			<div class="row">
				<button type="button" class="btn btn-primary btn-lg btn-block"><%= $.i18n._('Loading') %>...</button>
			</div>
		</div>
	</div>
</div>

`;const PortalJobVacancyViewController$1=Object.freeze(Object.defineProperty({__proto__:null,PortalJobVacancyViewController},Symbol.toStringTag,{value:"Module"}));class JobApplicantSubBaseViewController extends PortalBaseViewController{constructor(e={}){_.defaults(e,{events:{'change input[type="text"]':"onFormItemChange",'change input[type="checkbox"]':"onFormItemChange","change select.form-control":"onFormItemChange","change textarea.form-control":"onFormItemChange"}}),super(e)}preInit(e){this.api=TTAPI.APIJobApplicantPortal,this.qualification_api=TTAPI.APIQualificationPortal,this.company_api=TTAPI.APICompanyPortal,this.sub_view_id=e.sub_view_id,this.display_columns=e.display_columns,this.table_container=e.table_container,this.available_fields=e.available_fields,this._delegate=e._delegate,this.edit_view_error_ui_dic={},this.enable_add_qualification=e.enable_add_qualification||!1}postInit(){this.model.id?this.render():this.setEditView()}render(){var e=this,i=Global.loadWidget("views/portal/hr/my_profile/MyProfileSubView.html"),t=this.sub_view_id+"-"+this.model.id;if(this.unique_id=t,this.sub_view=_.template(i)({}),this.table_container.find(".table-container").length==0&&this.table_container.html('<div class="table-responsive"><table class="table table-condensed table-bordered table-container"><thead></thead><tbody></tbody></table></div>'),this.table_container.find("#"+t).length===0){var a=jQuery("<tr>").attr("id",t);jQuery(this.table_container.find("tbody")[0]).append(a)}else this.table_container.find("#"+t).html("");var r=jQuery("<tr>");for(var o in this.display_columns)if(this.display_columns.hasOwnProperty(o)){var n;switch(o){case"is_current_employer":case"is_contact_available":this.model.get(o)?n=jQuery.i18n._("Yes"):n=jQuery.i18n._("No");break;default:this.model.get(o)?n=this.model.get(o):n="";break}r.append("<th>"+this.display_columns[o]+"</th>"),this.table_container.find("#"+t).append("<td>"+n+"</td>")}r.append("<th>"+jQuery.i18n._("Action")+"</th>"),this.table_container.find("thead").html()===""&&this.table_container.find("thead").html(r),this.table_container.find("#"+t).append(this.sub_view),this.table_container.find("#"+t).find(".edit-icon").unbind("click").bind("click",function(s){e["get"+e.sub_view_id](function(){e.setEditView()})}),this.table_container.find("#"+t).find(".delete-icon").unbind("click").bind("click",function(s){e["get"+e.sub_view_id](function(){e.onDeleteClick()})})}initOptions(){var e=this,i={},t={};t.type_id=[this.qualification_type_id],i.filter_data=t,i.filter_columns={id:!0,name:!0},this.qualification_api.getQualification(i,!0,{onResult:function(a){var r=a.getResult(),o={};for(var n in r)if(r.hasOwnProperty(n)){var s=r[n];o[s.id]=jQuery.i18n._(s.name)}e.setSourceData("qualification_id",o,!0)}})}onSelectClick(e){var i=jQuery(e.currentTarget).parent().find("select");if(document.createEvent){var e=document.createEvent("MouseEvents");e.initMouseEvent("mousedown",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i[0].dispatchEvent(e)}else element.fireEvent&&i[0].fireEvent("onmousedown")}setEditView(){var e=Global.loadWidget("views/portal/hr/my_profile/"+this.sub_view_id+"SubEditView.html");this.setElement(_.template(e)({available_fields:this.available_fields,enable_add_qualification:this.enable_add_qualification})),this.initOptions(),this.registerDatePicker(),this.setCurrentEditRecordData(),this.openEditView()}onDeleteClick(){var e=this;IndexViewController.instance.router.showConfirmModal(Global.delete_confirm_message,{title:"",actions:[{label:"No",isClose:!0},{label:"Yes",callBack:function(i){e.closeConfirmModal(),ProgressBar.showOverlay(),e.api["delete"+e.sub_view_id](e.model.id,{onResult:function(t){ProgressBar.closeOverlay(),t&&t.isValid()?e._delegate.setSubViews(e.sub_view_id,e.display_columns):e.showErrorAlert(t)}})}}]})}setSourceData(e,i,t){var a=this,r='select[name="'+e+'"]';if(this.$(r)&&this.$(r)[0])this.$(r).empty();else return;switch(Global.isSet(this.model.get(e))||this.model.set(e,""),_.size(i)==0&&(t=!0,this.model.set(e,"")),e){case"qualification_id":if(this.enable_add_qualification){var o;switch(this.sub_view_id){case"JobApplicantSkill":o=jQuery.i18n._("Add New Skill");break;case"JobApplicantEducation":o=jQuery.i18n._("Add New Course");break;case"JobApplicantLicense":o=jQuery.i18n._("Add New Type");break;case"JobApplicantLanguage":o=jQuery.i18n._("Add New Language");break;case"JobApplicantMembership":o=jQuery.i18n._("Add New Membership");break}t=!1,this.$(r).append(jQuery("<option></option>").prop("value","").text("-- "+o+" --"))}default:t===!0&&this.$(r).append(jQuery("<option></option>").prop("value","").text("-- "+jQuery.i18n._("None")+" --")),_.size(i)>0&&jQuery.each(i,function(n,s){a.$(r).append(jQuery("<option></option>").prop("value",n).text(s)),a.model.get(e)==n&&a.$(r).val(n)}),a.$(r).selectpicker();break}}registerDatePicker(){var e="dd-M-y",i,t=!1,a=[jQuery.i18n._("Sun"),jQuery.i18n._("Mon"),jQuery.i18n._("Tue"),jQuery.i18n._("Wed"),jQuery.i18n._("Thu"),jQuery.i18n._("Fri"),jQuery.i18n._("Sat")],r=[jQuery.i18n._("Jan"),jQuery.i18n._("Feb"),jQuery.i18n._("Mar"),jQuery.i18n._("Apr"),jQuery.i18n._("May"),jQuery.i18n._("Jun"),jQuery.i18n._("Jul"),jQuery.i18n._("Aug"),jQuery.i18n._("Sep"),jQuery.i18n._("Oct"),jQuery.i18n._("Nov"),jQuery.i18n._("Dec")],o=jQuery.i18n._("Today"),n=jQuery.i18n._("Close"),s={showTime:!1,dateFormat:e,showHour:!1,showMinute:!1,changeMonth:!0,changeYear:!0,showButtonPanel:!0,duration:"",showAnim:"",yearRange:"-100:+10",showOn:"",dayNamesMin:a,currentText:o,monthNamesShort:r,closeText:n,beforeShow:function(){},onSelect:function(c){jQuery(this).change()},onClose:function(){i=setTimeout(function(){t=!1},100)}};this.$('input[type="text"].datepicker').datepicker(s),this.$('input[type="text"].datepicker').attr("placeholder","dd-mmm-yy"),this.$('input[type="text"].datepicker').bind("mouseup",function(){t?(t=!1,i&&(clearTimeout(i),i=null)):(jQuery(this).datepicker("show"),t=!0)}).next(".glyphicon").bind("mouseup",function(){jQuery(this).prev().trigger("mouseup")})}setCurrentEditRecordData(){var e=this,i=this.$(".detail-form").serializeArray();jQuery.map(i,function(t,a){Global.isSet(e.model.get(t.name))||e.model.set(t.name,t.value)}),this.model.has("qualification_id")||this.model.set("qualification_id",!1)}addQualification(){var e=this,i={};i.type_id=this.qualification_type_id;var t=i.name=this.getQualificationWidget().val();this.qualification_api.setQualification(i,{onResult:function(a){if(!a.isValid())e.setErrorTips(a);else{e.$("select[name='qualification_id']").selectpicker("destroy");var r=a.getResult();jQuery("<option>").attr({selected:"selected",value:r}).text(t).appendTo(e.$("select[name='qualification_id']")),e.$("select[name='qualification_id']").selectpicker(),e.$("select[name='qualification_id']").trigger("change")}}})}getAddQualificationContainer(){return this.$(".add-qualification-container")}getQualificationWidget(){return this.getAddQualificationContainer().find('input[name="name"]')}showAddQualificationContainer(){var e=this,i=this.getAddQualificationContainer();i.css("display","table"),i.find(".input-group-btn").off("click").on("click",function(){e.addQualification()});var t=this.getQualificationWidget();return t.val(""),t.unbind("keydown").bind("keydown",function(a){a.keyCode===13&&e.addQualification()}),i}hideAddQualificationContainer(){var e=this.getAddQualificationContainer();return e.css("display","none"),e}openEditView(){var e=this;IndexViewController.instance.router.showFormModal(this.$el,{title:"",actions:[{label:"Close",isClose:!0,callBack:function(i){}},{label:"Save Changes",callBack:function(i){e.onSaveClick()}}]})}closeEditView(){IndexViewController.instance.router.hideFormModal()}closeConfirmModal(){IndexViewController.instance.router.hideConfirmModal()}onFormItemChange(e,i){var t=e.currentTarget.name;switch(this.model.set(t,jQuery(e.currentTarget).val()),t){case"qualification_id":this.model.get(t)===""&&this.enable_add_qualification?(this.showAddQualificationContainer(),i=!0):this.hideAddQualificationContainer();break}i||this.validate()}validate(){var e=this;this.api["validate"+this.sub_view_id](this.model.toJSON(),{onResult:function(i){e.validateResult(i)}})}validateResult(e){this.setErrorTips(e)}clearErrorTips(e){Global.removeErrorTips(Object.values(this.edit_view_error_ui_dic).map(i=>i[0]),e)}setErrorTips(e){this.clearErrorTips(!0);let i=e.getDetails()?e.getDetails()[0]:{};i&&i.hasOwnProperty("error")&&(i=i.error);for(const t in i){if(!i.hasOwnProperty(t))continue;let a;if(this.$(`input[name="${t}"]`)[0]?a=this.$(`input[name="${t}"]`):this.$(`select[name="${t}"]`)[0]?a=this.$(`select[name="${t}"]`).parents(".styled-select"):this.$(`textarea[name="${t}"]`)[0]&&(a=this.$(`textarea[name="${t}"]`)),a){a.addClass("error-tip");let r;_.isArray(i[t])?r=i[t][0]:r=i[t],new bootstrap.Tooltip(a[0],{title:r,placement:"right",container:"body",trigger:"hover focus"}).show(),this.edit_view_error_ui_dic[t]=a}}}showErrorAlert(e){var i=e.getDetails();i.hasOwnProperty("error"),i||(i=e.getDescription());var t="";Global.isArray(i)||typeof i=="object"?jQuery.each(i,function(a,r){r.hasOwnProperty("error")&&(r=r.error);for(var o in r)t=t+r[o]+"<br>"}):t=i,this.showAlert(t)}onSaveClick(){var e=this;this.api["set"+this.sub_view_id](this.model.toJSON(),{onResult:function(i){if(i&&i.isValid()){var t=i.getResult();t!==!0&&TTUUID.isUUID(t)&&t!=TTUUID.zero_id&&t!=TTUUID.not_exist_id&&e.model.set("id",t),e.edit_view_error_ui_dic={},e["get"+e.sub_view_id](function(){e.render(),e.closeEditView()})}else e.setErrorTips(i)}})}showAlert(e){IndexViewController.instance.router.showTipModal(e)}}const JobApplicantSubBaseViewController$1=Object.freeze(Object.defineProperty({__proto__:null,JobApplicantSubBaseViewController},Symbol.toStringTag,{value:"Module"}));class JobApplicantEmploymentSubViewController extends JobApplicantSubBaseViewController{constructor(e={}){_.defaults(e,{}),super(e)}initOptions(){var e=this;this.api.getJobApplicantEmploymentOptions("employment_status",{onResult:function(i){e.setSourceData("employment_status_id",i.getResult(),!0)}}),this.api.getJobApplicantEmploymentOptions("wage_type",{onResult:function(i){e.setSourceData("wage_type_id",i.getResult(),!0)}}),this.company_api.getOptions("country",{onResult:function(t){var t=t.getResult();e.setSourceData("country",t,!0)}})}getJobApplicantEmployment(e){var i=this,t={};t.filter_data={},t.filter_data.id=this.model.id,this.api.getJobApplicantEmployment(t,{onResult:function(a){if(a&&a.isValid()){var r=a.getResult();r||(r=[]),r=r[0],i.model.set(r),e&&e()}else i.showErrorAlert(a),ProgressBar.closeOverlay()}})}setCurrentEditRecordData(){super.setCurrentEditRecordData();var e,i;for(var t in this.model.attributes)if(this.model.has(t))switch(t){case"country":e='select[name="'+t+'"]',this.$(e).val(this.model.get(t)),t==="country"&&this.eSetProvince(this.model.get(t));break;case"is_current_employer":case"is_contact_available":e='input[name="'+t+'"]',this.model.get(t)===!0?this.$(e).prop("checked","checked"):this.model.get(t)===!1&&this.$(e).removeAttr("checked");break;default:this.model.get(t)===!1&&this.model.set(t,""),e='.form-control[name="'+t+'"]',i=this.$(e),i&&i[0]&&this.$(e).val(this.model.get(t));break}}onFormItemChange(e,i){var t=e.currentTarget.name,a=this;switch(this.model.set(t,jQuery(e.currentTarget).val()),t){case"is_current_employer":case"is_contact_available":jQuery(e.currentTarget).is(":checked")?this.model.set(t,!0):this.model.set(t,!1);break}if(t=="country"){this.eSetProvince(this.$('select[name="country"]').val(),!0,function(){a.validate()});return}i||this.validate()}eSetProvince(e,i,t){var a=this;a.$('select[name="province"]').selectpicker("destroy"),!e||e==="-1"||e==="0"?(a.e_province_array=[],a.setSourceData("province",[])):this.company_api.getOptions("province",e,{onResult:function(r){r=r.getResult(),r||(r=[]),a.e_province_array=Global.buildRecordArray(r),i&&a.e_province_array.length>0&&(a.model.set("province",a.e_province_array[0].value),a.$('select[name="province"]').val(a.model.get("province"))),a.setSourceData("province",r),t&&t()}})}}const JobApplicantEmploymentSubViewController$1=Object.freeze(Object.defineProperty({__proto__:null,JobApplicantEmploymentSubViewController},Symbol.toStringTag,{value:"Module"}));class JobApplicantReferenceSubViewController extends JobApplicantSubBaseViewController{constructor(e={}){_.defaults(e,{}),super(e)}initOptions(){var e=this;this.api.getJobApplicantReferenceOptions("type",{onResult:function(i){e.setSourceData("type_id",i.getResult(),!0)}}),this.company_api.getOptions("country",{onResult:function(t){var t=t.getResult();e.setSourceData("country",t,!0)}})}getJobApplicantReference(e){var i=this,t={};t.filter_data={},t.filter_data.id=this.model.id,this.api.getJobApplicantReference(t,{onResult:function(a){if(a&&a.isValid()){var r=a.getResult();r||(r=[]),r=r[0],i.model.set(r),e&&e()}else i.showErrorAlert(a),ProgressBar.closeOverlay()}})}setCurrentEditRecordData(){super.setCurrentEditRecordData();var e,i;for(var t in this.model.attributes)if(this.model.has(t))switch(t){case"country":e='select[name="'+t+'"]',this.$(e).val(this.model.get(t)),t==="country"&&this.eSetProvince(this.model.get(t));break;default:this.model.get(t)===!1&&this.model.set(t,""),e='.form-control[name="'+t+'"]',i=this.$(e),i&&i[0]&&this.$(e).val(this.model.get(t));break}}onFormItemChange(e,i){var t=e.currentTarget.name,a=this;if(this.model.set(t,jQuery(e.currentTarget).val()),t=="country"){this.eSetProvince(this.$('select[name="country"]').val(),!0,function(){a.validate()});return}i||this.validate()}eSetProvince(e,i,t){var a=this;a.$('select[name="province"]').selectpicker("destroy"),!e||e==="-1"||e==="0"?(a.e_province_array=[],a.setSourceData("province",[])):this.company_api.getOptions("province",e,{onResult:function(r){r=r.getResult(),r||(r=[]),a.e_province_array=Global.buildRecordArray(r),i&&a.e_province_array.length>0&&(a.model.set("province",a.e_province_array[0].value),a.$('select[name="province"]').val(a.model.get("province"))),a.setSourceData("province",r),t&&t()}})}}const JobApplicantReferenceSubViewController$1=Object.freeze(Object.defineProperty({__proto__:null,JobApplicantReferenceSubViewController},Symbol.toStringTag,{value:"Module"}));class JobApplicantLocationSubViewController extends JobApplicantSubBaseViewController{constructor(e={}){_.defaults(e,{}),super(e)}initOptions(){var e=this;this.company_api.getOptions("country",{onResult:function(t){var t=t.getResult();e.setSourceData("country",t,!0)}})}getJobApplicantLocation(e){var i=this,t={};t.filter_data={},t.filter_data.id=this.model.id,this.api.getJobApplicantLocation(t,{onResult:function(a){if(a&&a.isValid()){var r=a.getResult();r||(r=[]),r=r[0],i.model.set(r),e&&e()}else i.showErrorAlert(a),ProgressBar.closeOverlay()}})}setCurrentEditRecordData(){super.setCurrentEditRecordData();var e,i;for(var t in this.model.attributes)if(this.model.has(t))switch(t){case"country":e='select[name="'+t+'"]',this.$(e).val(this.model.get(t)),t==="country"&&this.eSetProvince(this.model.get(t));break;default:this.model.get(t)===!1&&this.model.set(t,""),e='.form-control[name="'+t+'"]',i=this.$(e),i&&i[0]&&this.$(e).val(this.model.get(t));break}}onFormItemChange(e,i){var t=e.currentTarget.name,a=this;if(this.model.set(t,jQuery(e.currentTarget).val()),t=="country"){this.eSetProvince(this.$('select[name="country"]').val(),!0,function(){a.validate()});return}i||this.validate()}eSetProvince(e,i,t){var a=this;a.$('select[name="province"]').selectpicker("destroy"),!e||e==="-1"||e==="0"?(a.e_province_array=[],a.setSourceData("province",[])):this.company_api.getOptions("province",e,{onResult:function(r){r=r.getResult(),r||(r=[]),a.e_province_array=Global.buildRecordArray(r),i&&a.e_province_array.length>0&&(a.model.set("province",a.e_province_array[0].value),a.$('select[name="province"]').val(a.model.get("province"))),a.setSourceData("province",r),t&&t()}})}}const JobApplicantLocationSubViewController$1=Object.freeze(Object.defineProperty({__proto__:null,JobApplicantLocationSubViewController},Symbol.toStringTag,{value:"Module"}));class JobApplicantSkillSubViewController extends JobApplicantSubBaseViewController{constructor(e={}){_.defaults(e,{}),super(e)}init(e){this.qualification_type_id=10}initOptions(){var e=this;this.api.getJobApplicantSkillOptions("proficiency",{onResult:function(a){e.setSourceData("proficiency_id",a.getResult(),!0)}});var i={},t={};t.type_id=[this.qualification_type_id],i.filter_data=t,i.filter_columns={id:!0,name:!0},this.qualification_api.getQualification(i,!0,{onResult:function(a){var r=a.getResult(),o={};for(var n in r)if(r.hasOwnProperty(n)){var s=r[n];o[s.id]=jQuery.i18n._(s.name)}e.setSourceData("qualification_id",o,!0)}})}getJobApplicantSkill(e){var i=this,t={};t.filter_data={},t.filter_data.id=this.model.id,this.api.getJobApplicantSkill(t,{onResult:function(a){if(a&&a.isValid()){var r=a.getResult();r||(r=[]),r=r[0],i.model.set(r),e&&e()}else i.showErrorAlert(a),ProgressBar.closeOverlay()}})}setCurrentEditRecordData(){super.setCurrentEditRecordData();var e,i;Global.isSet(this.model.get("enable_calc_experience"))||this.model.set("enable_calc_experience",!1);for(var t in this.model.attributes)if(this.model.has(t))switch(t){case"enable_calc_experience":e='input[name="'+t+'"]',this.model.get(t)===!0?this.$(e).prop("checked","checked"):this.model.get(t)===!1&&this.$(e).removeAttr("checked");break;default:this.model.get(t)===!1&&(this.model.set(t,""),t==="qualification_id"&&this.enable_add_qualification&&this.showAddQualificationContainer()),e='.form-control[name="'+t+'"]',i=this.$(e),i&&i[0]&&this.$(e).val(this.model.get(t));break}this.setEditViewDataDone()}setEditViewDataDone(){this.model.get("enable_calc_experience")===!0?this.$('input[name="experience"]').attr("readonly","true"):this.$('input[name="experience"]').removeAttr("readonly"),jQuery(".edit-view-tab-bar").css("opacity",1)}onFormItemChange(e,i){var t=e.currentTarget.name;switch(this.model.set(t,jQuery(e.currentTarget).val()),this.model.get("first_used_date")?(this.model.set("enable_calc_experience",!0),this.$('input[name="enable_calc_experience"]').prop("checked","checked"),this.$('input[name="enable_calc_experience"]')[0].checked=!0,this.$('input[name="enable_calc_experience"]').attr("disabled","disabled")):(this.model.set("enable_calc_experience",!1),this.$('input[name="enable_calc_experience"]')&&this.$('input[name="enable_calc_experience"]')[0]&&(this.$('input[name="enable_calc_experience"]').removeAttr("checked"),this.$('input[name="enable_calc_experience"]')[0].checked=!1,this.$('input[name="enable_calc_experience"]').removeAttr("disabled"))),t){case"qualification_id":this.model.get(t)===""&&this.enable_add_qualification?(this.showAddQualificationContainer(),i=!0):this.hideAddQualificationContainer();break;case"enable_calc_experience":jQuery(e.currentTarget).is(":checked")?(this.model.set(t,!0),this.calcExperience()):(this.model.set(t,!1),this.$('input[name="experience"]').removeAttr("readonly"));break;case"last_used_date":case"first_used_date":this.calcExperience();break}i||this.validate()}calcExperience(){this.model.get("enable_calc_experience")===!0?this.$('input[name="experience"]').attr("readonly","true"):this.$('input[name="experience"]').removeAttr("readonly");var e=this.$('input[name="first_used_date"]').val(),i=this.$('input[name="last_used_date"]').val();i=i||new Date().format("DD-MMM-YY");var t=0;e!==""&&i!==""?(t=this.api.calcExperience(e,i,{async:!1}).getResult(),this.$('input[name="experience"]').val(t)):this.$('input[name="experience"]').val(t),this.model.set("experience",t)}}const JobApplicantSkillSubViewController$1=Object.freeze(Object.defineProperty({__proto__:null,JobApplicantSkillSubViewController},Symbol.toStringTag,{value:"Module"}));class JobApplicantEducationSubViewController extends JobApplicantSubBaseViewController{constructor(e={}){_.defaults(e,{}),super(e)}init(e){this.qualification_type_id=20}getJobApplicantEducation(e){var i=this,t={};t.filter_data={},t.filter_data.id=this.model.id,this.api.getJobApplicantEducation(t,{onResult:function(a){if(a&&a.isValid()){var r=a.getResult();r||(r=[]),r=r[0],i.model.set(r),e&&e()}else i.showErrorAlert(a),ProgressBar.closeOverlay()}})}setCurrentEditRecordData(){super.setCurrentEditRecordData();var e,i;for(var t in this.model.attributes)if(this.model.has(t))switch(t){default:this.model.get(t)===!1&&(this.model.set(t,""),t==="qualification_id"&&this.enable_add_qualification&&this.showAddQualificationContainer()),e='.form-control[name="'+t+'"]',i=this.$(e),i&&i[0]&&this.$(e).val(this.model.get(t));break}}}const JobApplicantEducationSubViewController$1=Object.freeze(Object.defineProperty({__proto__:null,JobApplicantEducationSubViewController},Symbol.toStringTag,{value:"Module"}));class JobApplicantMembershipSubViewController extends JobApplicantSubBaseViewController{constructor(e={}){_.defaults(e,{}),super(e)}init(e){this.qualification_type_id=50,this.currency_api=TTAPI.APICurrencyPortal}initOptions(){var e=this,i={};this.api.getJobApplicantMembershipOptions("ownership",{onResult:function(a){e.setSourceData("ownership_id",a.getResult(),!0)}});var t={};t.type_id=[this.qualification_type_id],i.filter_data=t,i.filter_columns={id:!0,name:!0},this.qualification_api.getQualification(i,!0,{onResult:function(a){var r=a.getResult(),o={};for(var n in r)if(r.hasOwnProperty(n)){var s=r[n];o[s.id]=jQuery.i18n._(s.name)}e.setSourceData("qualification_id",o,!0)}}),this.currency_api.getCurrency({onResult:function(a){var r=a.getResult(),o={};for(var n in r)if(r.hasOwnProperty(n)){var s=r[n];o[s.id]=jQuery.i18n._(s.name)}e.setSourceData("currency_id",o,!0)}})}getJobApplicantMembership(e){var i=this,t={};t.filter_data={},t.filter_data.id=this.model.id,this.api.getJobApplicantMembership(t,{onResult:function(a){if(a&&a.isValid()){var r=a.getResult();r||(r=[]),r=r[0],i.model.set(r),e&&e()}else i.showErrorAlert(a),ProgressBar.closeOverlay()}})}setCurrentEditRecordData(){super.setCurrentEditRecordData();var e,i;for(var t in this.model.attributes)if(this.model.has(t))switch(t){default:this.model.get(t)===!1&&(this.model.set(t,""),t==="qualification_id"&&this.enable_add_qualification&&this.showAddQualificationContainer()),e='.form-control[name="'+t+'"]',i=this.$(e),i&&i[0]&&this.$(e).val(this.model.get(t));break}}}const JobApplicantMembershipSubViewController$1=Object.freeze(Object.defineProperty({__proto__:null,JobApplicantMembershipSubViewController},Symbol.toStringTag,{value:"Module"}));class JobApplicantLicenseSubViewController extends JobApplicantSubBaseViewController{constructor(e={}){_.defaults(e,{}),super(e)}init(e){this.qualification_type_id=30}getJobApplicantLicense(e){var i=this,t={};t.filter_data={},t.filter_data.id=this.model.id,this.api.getJobApplicantLicense(t,{onResult:function(a){if(a&&a.isValid()){var r=a.getResult();r||(r=[]),r=r[0],i.model.set(r),e&&e()}else i.showErrorAlert(a),ProgressBar.closeOverlay()}})}setCurrentEditRecordData(){super.setCurrentEditRecordData();var e,i;for(var t in this.model.attributes)if(this.model.has(t))switch(t){default:this.model.get(t)===!1&&(this.model.set(t,""),t==="qualification_id"&&this.enable_add_qualification&&this.showAddQualificationContainer()),e='.form-control[name="'+t+'"]',i=this.$(e),i&&i[0]&&this.$(e).val(this.model.get(t));break}}}const JobApplicantLicenseSubViewController$1=Object.freeze(Object.defineProperty({__proto__:null,JobApplicantLicenseSubViewController},Symbol.toStringTag,{value:"Module"}));class JobApplicantLanguageSubViewController extends JobApplicantSubBaseViewController{constructor(e={}){_.defaults(e,{}),super(e)}init(e){this.qualification_type_id=40}initOptions(){var e=this,i={};this.api.getJobApplicantLanguageOptions("fluency",{onResult:function(a){e.setSourceData("fluency_id",a.getResult(),!0)}}),this.api.getJobApplicantLanguageOptions("competency",{onResult:function(a){e.setSourceData("competency_id",a.getResult(),!0)}});var t={};t.type_id=[this.qualification_type_id],i.filter_data=t,i.filter_columns={id:!0,name:!0},this.qualification_api.getQualification(i,!0,{onResult:function(a){var r=a.getResult(),o={};for(var n in r)if(r.hasOwnProperty(n)){var s=r[n];o[s.id]=jQuery.i18n._(s.name)}e.setSourceData("qualification_id",o,!0)}})}getJobApplicantLanguage(e){var i=this,t={};t.filter_data={},t.filter_data.id=this.model.id,this.api.getJobApplicantLanguage(t,{onResult:function(a){if(a&&a.isValid()){var r=a.getResult();r||(r=[]),r=r[0],i.model.set(r),e&&e()}else i.showErrorAlert(a),ProgressBar.closeOverlay()}})}setCurrentEditRecordData(){super.setCurrentEditRecordData();var e,i;for(var t in this.model.attributes)if(this.model.has(t))switch(t){default:this.model.get(t)===!1&&(this.model.set(t,""),t==="qualification_id"&&this.enable_add_qualification&&this.showAddQualificationContainer()),e='.form-control[name="'+t+'"]',i=this.$(e),i&&i[0]&&this.$(e).val(this.model.get(t));break}}}const JobApplicantLanguageSubViewController$1=Object.freeze(Object.defineProperty({__proto__:null,JobApplicantLanguageSubViewController},Symbol.toStringTag,{value:"Module"}));class JobApplicationSubViewController extends JobApplicantSubBaseViewController{constructor(e={}){_.defaults(e,{}),super(e)}render(){var e=this,i=Global.loadWidget("views/portal/hr/my_profile/MyProfileSubView.html"),t=this.sub_view_id+"-"+this.model.id;if(this.unique_id=t,this.sub_view=_.template(i)({}),this.table_container.find(".table-container").length==0&&this.table_container.html('<div class="table-responsive"><table class="table table-condensed table-bordered table-container"><thead></thead><tbody></tbody></table></div>'),this.table_container.find("#"+t).length===0){var a=jQuery("<tr>").attr("id",t);jQuery(this.table_container.find("tbody")[0]).append(a)}else this.table_container.find("#"+t).html("");var r=jQuery("<tr>");for(var o in this.display_columns)if(this.display_columns.hasOwnProperty(o)){var n;switch(o){default:if(this.model.get(o)?n=this.model.get(o):n="",o==="job_vacancy"){var s=Global.getBaseURL(null,!0,!0).replace(/#!m=.*?(&|$)/g,"#!m=PortalJobVacancyDetail&id="+this.model.get("job_vacancy_id")+"$1");this.table_container.find("#"+t).append('<td><a href="'+s+'">'+n+"</a></td>")}else this.table_container.find("#"+t).append("<td>"+n+"</td>");break}r.append("<th>"+this.display_columns[o]+"</th>")}r.append("<th>"+jQuery.i18n._("Action")+"</th>"),this.table_container.find("thead").html()===""&&this.table_container.find("thead").html(r),this.table_container.find("#"+t).append(this.sub_view),this.table_container.find("#"+t).find(".edit-icon").remove(),this.table_container.find("#"+t).find(".delete-icon").unbind("click").bind("click",function(c){e["get"+e.sub_view_id](function(){e.onDeleteClick()})})}getJobApplication(e){var i=this,t={};t.filter_data={},t.filter_data.id=this.model.id,this.api.getJobApplication(t,{onResult:function(a){if(a&&a.isValid()){var r=a.getResult();r||(r=[]),r=r[0],i.model.set(r),e&&e()}else i.showErrorAlert(a),ProgressBar.closeOverlay()}})}}const JobApplicationSubViewController$1=Object.freeze(Object.defineProperty({__proto__:null,JobApplicationSubViewController},Symbol.toStringTag,{value:"Module"}));class DocumentSubViewController extends JobApplicantSubBaseViewController{constructor(e={}){_.defaults(e,{}),super(e)}init(e){this.document_api=TTAPI.APIDocumentPortal,this.attachment_data=null}render(){var e=this,i=Global.loadWidget("views/portal/hr/my_profile/MyProfileSubView.html"),t=this.sub_view_id+"-"+this.model.id;if(this.unique_id=t,this.sub_view=_.template(i)({}),this.table_container.find(".table-container").length==0&&this.table_container.html('<div class="table-responsive"><table class="table table-condensed table-bordered table-container"><thead></thead><tbody></tbody></table></div>'),this.table_container.find("#"+t).length===0){var a=jQuery("<tr>").attr("id",t);jQuery(this.table_container.find("tbody")[0]).append(a)}else this.table_container.find("#"+t).html("");var r=jQuery("<tr>");for(var o in this.display_columns)if(this.display_columns.hasOwnProperty(o)){var n;switch(o){default:this.model.get(o)?n=this.model.get(o):n="",o==="name"?this.table_container.find("#"+t).append('<td><a class="download-attachment" href="javascript:void(0);">'+n+"</a></td>"):this.table_container.find("#"+t).append("<td>"+n+"</td>");break}r.append("<th>"+this.display_columns[o]+"</th>")}r.append("<th>"+jQuery.i18n._("Action")+"</th>"),this.table_container.find("thead").html()===""&&this.table_container.find("thead").html(r),this.table_container.find("#"+t).append(this.sub_view),this.table_container.find("#"+t).find(".download-attachment").unbind("click").bind("click",function(s){var c={};c.filter_data={},c.filter_data.id=e.model.id,e.document_api.getAttachment(c,{onResult:function(u){e.downloadFile(u)}})}),this.table_container.find("#"+t).find(".edit-icon").unbind("click").bind("click",function(s){e["get"+e.sub_view_id](function(){e.setEditView()})}),this.table_container.find("#"+t).find(".delete-icon").unbind("click").bind("click",function(s){e["get"+e.sub_view_id](function(){e.onDeleteClick()})})}downloadFile(e){var i=e.getResult();if(i.length>0){var t=i[0].id,a=i[0].document_revision_id,r=ServiceCaller.getAPIURL("Class=APIDocumentPortal&Method=downloadAttachment&v=2");LocalCacheData.getAllURLArgs().company_id&&(r=r+"&company_id="+LocalCacheData.getAllURLArgs().company_id);var o={parent_id:t,object_id:a};Global.APIFileDownload(null,null,o,r)}}initOptions(){}getDocument(e){var i=this,t={};t.filter_data={},t.filter_data.id=this.model.id,this.api.getDocument(t,{onResult:function(a){if(a&&a.isValid()){var r=a.getResult();r||(r=[]),r=r[0],i.model.set(r),e&&e()}else i.showErrorAlert(a),ProgressBar.closeOverlay()}})}setCurrentEditRecordData(){super.setCurrentEditRecordData();var e,i;for(var t in this.model.attributes)if(this.model.has(t))switch(t){case"private":case"template":e='input[name="'+t+'"]',this.model.get(t)===!0?this.$(e).prop("checked","checked"):this.model.get(t)===!1&&this.$(e).removeAttr("checked");break;default:this.model.get(t)===!1&&this.model.set(t,""),e='.form-control[name="'+t+'"]',i=this.$(e),i&&i[0]&&this.$(e).val(this.model.get(t));break}}onSaveClick(){var e=this;_.size(this.edit_view_error_ui_dic)>0||(this.model.get("name")||this.model.set("name","Resume - "+LocalCacheData.getPortalLoginUser().first_name+" "+LocalCacheData.getPortalLoginUser().last_name),this.api["set"+this.sub_view_id](this.model.toJSON(),{onResult:function(i){if(i&&i.isValid()){var t=i.getResult();t!==!0&&TTUUID.isUUID(t)&&t!=TTUUID.zero_id&&t!=TTUUID.not_exist_id&&e.model.set("id",t),e.onSaveResult(i,function(){e["get"+e.sub_view_id](function(){ProgressBar.changeProgressBarMessage("Processing..."),e.closeEditView(),e._delegate.refreshProfile()})})}else e.setErrorTips(i)}}))}onSaveResult(e,i){var t=e.getResult(),a=this.$('input[name="file_data"]')[0].files[0],r=new FormData;if(t===!0&&(t=this.model.id),a){var o=this.model.get("name"),n=this.model.get("revision"),s=this.document_api.addAttachment(o,t,n,{async:!1}).getResult().document_revision_id;r.append("file_data",a),this.uploadFile(r,s,i)}else i()}uploadFile(e,i,t){var a=ServiceCaller.getAPIURL("Class="+this.document_api.className+"&Method=uploadAttachment&v=2");LocalCacheData.getAllURLArgs().company_id&&(a=a+"&company_id="+LocalCacheData.getAllURLArgs().company_id),a=a+"&object_id="+i;var r=TTUUID.generateUUID();ProgressBar.showProgressBar(r),ProgressBar.changeProgressBarMessage("File Uploading"),jQuery.ajax({url:a,headers:{"X-Client-ID":"Browser-TimeTrex","X-CSRF-Token":getCookie("CSRF-Token")},type:"POST",data:e,success:function(o){if(ProgressBar.removeProgressBar(),o.error.length>0){IndexViewController.instance.router.showTipModal(o.error);return}t()},cache:!1,contentType:!1,processData:!1})}onFormItemChange(e,i){var t=e.currentTarget.name;switch(this.model.set(t,jQuery(e.currentTarget).val()),t){case"private":case"template":jQuery(e.currentTarget).is(":checked")?this.model.set(t,!0):this.model.set(t,!1);break}i||this.validate()}}const DocumentSubViewController$1=Object.freeze(Object.defineProperty({__proto__:null,DocumentSubViewController},Symbol.toStringTag,{value:"Module"}));class MyProfileViewController extends PortalBaseViewController{constructor(e={}){_.defaults(e,{el:"#my_profile_view",events:{"click #saveBtn":"onSaveClick","click #available_jobs":"availableJobsClick","click #applied_jobs":"appliedJobsClick",'change input[type="text"]':"onFormItemChange",'change input[type="checkbox"]':"onFormItemChange","change select.form-control":"onFormItemChange","change textarea.form-control":"onFormItemChange","click .detail-form-title":"onFormTitleClick","click .table-title .add-btn":"onSubViewAddClick"}}),super(e)}init(){if(!Global.isSet(LocalCacheData.getPortalLoginUser()))return!1;this.current_edit_record=Global.clone(LocalCacheData.getPortalLoginUser()),this.model=new Backbone.Model(this.current_edit_record),this.viewId="MyProfile",this.api=TTAPI.APIJobApplicantPortal,this.company_api=TTAPI.APICompanyPortal,this.ethnic_group_api=TTAPI.APIEthnicGroupPortal,this.qualification_api=TTAPI.APIQualificationPortal,this.script_name="ProfileView",this.edit_view_error_ui_dic={},this.applicant_fields={},this.background_fields={},this.availability_fields={},this.employment_history_fields={},this.reference_fields={},this.location_fields={},this.skill_fields={},this.education_fields={},this.membership_fields={},this.license_fields={},this.language_fields={},this.enable_add_qualification_fields={},this.is_changed=null;var e=this;this.getAvailableFieldsForSection(function(){e.render()})}refreshProfile(){var e=this;this.api.getJobApplicant({onResult:function(i){i&&i.isValid()&&(LocalCacheData.setPortalLoginUser(i.getResult()[0]),e.current_edit_record=Global.clone(LocalCacheData.getPortalLoginUser())),e.$(".job-applicant-detail").remove(),e.render()}})}getAvailableFieldsForSection(e){var i=this,t;this.api.getRecruitmentPortalConfig({},{onResult:function(a){var r=a.getResult();if(Global.isArray(r)&&(t=r[0]),t)for(var o in t){var n;if(t.hasOwnProperty(o)&&(n=t[o]),Global.isArray(n))for(var s=0;s<n.length;s++){var c=n[s];i[o+"_fields"][c]=!0}}i.api.getJobApplicant({onResult:function(u){u&&u.isValid()&&(LocalCacheData.setPortalLoginUser(u.getResult()[0]),i.current_edit_record=Global.clone(LocalCacheData.getPortalLoginUser())),e&&e()}})}})}render(){var e=Global.loadWidget("views/portal/hr/my_profile/MyProfileDetailView.html");this.$el.append(_.template(e)({applicant:this.applicant_fields,background:this.background_fields,availability:this.availability_fields,employment_history:this.employment_history_fields,reference:this.reference_fields,location:this.location_fields,skill:this.skill_fields,education:this.education_fields,membership:this.membership_fields,license:this.license_fields,language:this.language_fields})),this.initOptions(),this.registerDatePicker(),this.setCurrentEditRecordData(),this.initSubHistoryView(),this.initSubQualificationView(),this.initSubApplicationView(),this.initSubDocumentView();var i=this;jQuery(".portal-tables #password, .portal-tables #password_confirm").on("change",function(t){i.onFormItemChange(t)})}initOptions(){var e=this;this.api.getJobApplicantOptions("sex",{onResult:function(i){e.setSourceData("sex_id",i.getResult())}}),this.ethnic_group_api.getEthnicGroup({filter_columns:{id:!0,name:!0}},!0,{onResult:function(i){var t=i.getResult(),a={};for(var r in t)if(t.hasOwnProperty(r)){var o=t[r];a[o.id]=jQuery.i18n._(o.name)}e.setSourceData("ethnic_group_id",a,!0)}}),this.api.getJobApplicantOptions("minimum_wage_type",{onResult:function(i){e.setSourceData("minimum_wage_type_id",i.getResult(),!0)}}),this.company_api.getOptions("country",{onResult:function(t){var t=t.getResult();e.setSourceData("country",t,!0),e.setSourceData("identification_country",t,!0)}}),this.api.getJobApplicantOptions("identification_type",{onResult:function(i){e.setSourceData("identification_type_id",i.getResult(),!0)}}),this.api.getJobApplicantOptions("available_days_of_week",{onResult:function(i){e.setSourceData("available_days_of_week",i.getResult(),!0)}}),this.api.getJobApplicantOptions("available_hours_of_day",{onResult:function(i){e.setSourceData("available_hours_of_day",i.getResult(),!0)}})}onSelectClick(e){var i=jQuery(e.currentTarget).parent().find("select");if(document.createEvent){var e=document.createEvent("MouseEvents");e.initMouseEvent("mousedown",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i[0].dispatchEvent(e)}else element.fireEvent&&i[0].fireEvent("onmousedown")}registerDatePicker(){var e="dd-M-y",i,t=!1,a=[jQuery.i18n._("Sun"),jQuery.i18n._("Mon"),jQuery.i18n._("Tue"),jQuery.i18n._("Wed"),jQuery.i18n._("Thu"),jQuery.i18n._("Fri"),jQuery.i18n._("Sat")],r=[jQuery.i18n._("Jan"),jQuery.i18n._("Feb"),jQuery.i18n._("Mar"),jQuery.i18n._("Apr"),jQuery.i18n._("May"),jQuery.i18n._("Jun"),jQuery.i18n._("Jul"),jQuery.i18n._("Aug"),jQuery.i18n._("Sep"),jQuery.i18n._("Oct"),jQuery.i18n._("Nov"),jQuery.i18n._("Dec")],o=jQuery.i18n._("Today"),n=jQuery.i18n._("Close"),s={showTime:!1,dateFormat:e,showHour:!1,showMinute:!1,changeMonth:!0,changeYear:!0,showButtonPanel:!0,duration:"",showAnim:"",yearRange:"-100:+10",showOn:"",dayNamesMin:a,currentText:o,monthNamesShort:r,closeText:n,beforeShow:function(){},onSelect:function(c){jQuery(this).change()},onClose:function(){i=setTimeout(function(){t=!1},100)}};this.$('input[type="text"].datepicker').datepicker(s),this.$('input[type="text"].datepicker').attr("placeholder","dd-mmm-yy"),this.$('input[type="text"].datepicker').bind("mouseup",function(){t?(t=!1,i&&(clearTimeout(i),i=null)):(jQuery(this).datepicker("show"),t=!0)}).next(".glyphicon").bind("mouseup",function(){jQuery(this).prev().trigger("mouseup")})}setSourceData(e,i,t){var a=this,r='select[id="'+e+'"]';if(this.$(r)&&this.$(r)[0])this.$(r).empty();else return;_.size(i)==0&&(t=!0),t===!0&&(e==="available_days_of_week"||e==="available_hours_of_day"?this.$(r).append(jQuery("<option></option>").prop("value","0").text("-- "+jQuery.i18n._("Select all that apply")+" --").attr("selected","selected")):this.$(r).append(jQuery("<option></option>").prop("value","0").text("-- "+jQuery.i18n._("None")+" --").attr("selected","selected"))),_.size(i)>0&&jQuery.each(i,function(o,n){if(a.$(r).append(jQuery("<option></option>").prop("value",o).text(n)),e==="available_days_of_week"||e==="available_hours_of_day"){if(_.isArray(a.current_edit_record[e])){a.$(r).find("option[value='0']").removeAttr("selected");for(var s=a.current_edit_record[e],c=0;c<s.length;c++)o==s[c]&&a.$(r).find("option[value='"+o+"']").attr("selected","selected")}}else a.current_edit_record[e]==o&&a.$(r).val(o)}),a.$(r).selectpicker()}setCurrentEditRecordData(){var e,i;for(var t in this.current_edit_record)if(this.current_edit_record.hasOwnProperty(t))switch(t){case"country":case"identification_country":t==="country"?this.eSetProvince(this.current_edit_record[t]):t==="identification_country"&&this.iSetProvince(this.current_edit_record[t]);break;case"currently_employed":case"immediate_drug_test":case"criminal_record":e='input[id="'+t+'"]',this.current_edit_record[t]===!0?(this.$(e).prop("checked","checked"),this.$('textarea[id="criminal_record_description"]')[0]&&(t==="criminal_record"?(this.$('textarea[id="criminal_record_description"]').removeAttr("disabled"),this.$('textarea[id="criminal_record_description"]').css("background-color","#fff")):(this.$('textarea[id="criminal_record_description"]').attr("disabled","disabled"),this.$('textarea[id="criminal_record_description"]').css("background-color","#eee")))):this.current_edit_record[t]===!1&&(this.$(e).removeAttr("checked"),this.$('textarea[id="criminal_record_description"]')[0]&&(this.$('textarea[id="criminal_record_description"]').attr("disabled","disabled"),this.$('textarea[id="criminal_record_description"]').css("background-color","#eee")));break;default:this.current_edit_record[t]===!1&&(this.current_edit_record[t]=""),e='.form-control[id="'+t+'"]',i=this.$(e),i&&i[0]&&this.$(e).val(this.current_edit_record[t]);break}}onFormItemChange(e,i){if(e.currentTarget.name)var t=e.currentTarget.name;else if(e.currentTarget.id)var t=e.currentTarget.id;else return!1;var a=this;switch(this.current_edit_record[t]=jQuery(e.currentTarget).val(),this.model.set(t,jQuery(e.currentTarget).val()),this.is_changed=!0,t){case"currently_employed":case"immediate_drug_test":case"criminal_record":jQuery(e.currentTarget).is(":checked")?(this.current_edit_record[t]=!0,this.model.set(t,!0),t==="criminal_record"&&this.$('textarea[id="criminal_record_description"]')[0]&&(this.$('textarea[id="criminal_record_description"]').removeAttr("disabled"),this.$('textarea[id="criminal_record_description"]').css("background-color","#fff"))):(this.current_edit_record[t]=!1,this.model.set(t,!1),t==="criminal_record"&&this.$('textarea[id="criminal_record_description"]')[0]&&(this.$('textarea[id="criminal_record_description"]').attr("disabled","disabled"),this.$('textarea[id="criminal_record_description"]').css("background-color","#eee")));break;case"available_days_of_week":case"available_hours_of_day":jQuery(e.currentTarget).val()===null&&(this.current_edit_record[t]=0);break;case"confirm_password":i=!1;break}if(t=="country"){this.eSetProvince(this.$('select[id="country"]').val(),!0,function(){a.validate()});return}if(t==="identification_country"){this.iSetProvince(this.$('select[id="identification_country"]').val(),!0,function(){a.validate()});return}i||this.validate()}validate(){var e=this,i=this.current_edit_record;this.api.validateJobApplicant(i,{onResult:function(t){e.validateResult(t)}})}validateResult(e){this.clearErrorTips(),this.setErrorTips(e)}clearErrorTips(e){Global.removeErrorTips(Object.values(this.edit_view_error_ui_dic).map(i=>i[0]),e)}setErrorTips(e){this.clearErrorTips(!0);var i=e.getDetails()?e.getDetails()[0]:{};i&&i.hasOwnProperty("error")&&(i=i.error);var t=[];_.size(i)>0?this.$(".save-btn").addClass("error"):this.$(".save-btn").removeClass("error");for(var a in i)if(i.hasOwnProperty(a)){var r;if(this.$('input[id="'+a+'"]:visible')[0]?r=this.$('input[id="'+a+'"]:visible'):this.$('select[id="'+a+'"]:visible')[0]?r=this.$('select[id="'+a+'"]:visible').parents(".styled-select"):this.$('textarea[id="'+a+'"]:visible')[0]&&(r=this.$('textarea[id="'+a+'"]:visible')),r){r.addClass("error-tip");var o;_.isArray(i[a])?o=i[a][0]:o=i[a];var n=new Tooltip(r.get(0),{title:o,placement:"right",selector:"#"+a});n.show(),this.edit_view_error_ui_dic[a]=r,t.push(r.attr("data-sort"))}}if(t.length>0){t.sort();var s,a=t[0];this.$('input[data-sort="'+a+'"]')[0]?s=this.$('input[data-sort="'+a+'"]'):this.$('select[data-sort="'+a+'"]')[0]?s=this.$('select[data-sort="'+a+'"]'):this.$('textarea[data-sort="'+a+'"]')[0]&&(s=this.$('textarea[data-sort="'+a+'"]'));var c=jQuery("html, body");c.on("scroll mousedown wheel DOMMouseScroll mousewheel keyup touchmove",function(p){(p.which>0||p.type=="mousedown"||p.type=="mousewheel"||p.type=="touchmove")&&c.stop()}),s&&c.animate({scrollTop:s.parent().find(".error-tip").offset().top},"slow",function(){c.off("scroll mousedown wheel DOMMouseScroll mousewheel keyup touchmove")})}}eSetProvince(e,i,t){var a=this;a.$('select[id="province"]').selectpicker("destroy"),!e||e==="-1"||e==="0"?(a.e_province_array=[],a.setSourceData("province",[])):this.company_api.getOptions("province",e,{onResult:function(r){r=r.getResult(),r||(r=[]),a.e_province_array=Global.buildRecordArray(r),i&&a.e_province_array.length>0&&(a.current_edit_record.province=a.e_province_array[0].value,a.model.set("province",a.e_province_array[0].value),a.$('select[id="province"]').val(a.current_edit_record.province)),a.setSourceData("province",r),t&&t()}})}iSetProvince(e,i,t){var a=this;a.$('select[id="identification_province"]').selectpicker("destroy"),!e||e==="-1"||e==="0"?(a.i_province_array=[],a.setSourceData("identification_province",[])):this.company_api.getOptions("province",e,{onResult:function(r){r=r.getResult(),r||(r=[]),a.i_province_array=Global.buildRecordArray(r),i&&a.i_province_array.length>0&&(a.current_edit_record.identification_province=a.i_province_array[0].value,a.model.set("identification_province",a.i_province_array[0].value),a.$('select[id="identification_province"]').val(a.current_edit_record.identification_province)),a.setSourceData("identification_province",r),t&&t()}})}availableJobsClick(){window.location=Global.getBaseURL(null,!0,!0).replace(/#!m=.*?(&|$)/g,"#!m=PortalJobVacancy$1"),LocalCacheData.setAllURLArgs({})}appliedJobsClick(){window.location=Global.getBaseURL(null,!0,!0).replace(/#!m=.*?(&|$)/g,"#!m=MyJobApplication$1"),LocalCacheData.setAllURLArgs({})}onSaveClick(){this.clearErrorTips(!0);var e=this;this.api.setJobApplicant(this.current_edit_record,{onResult:function(i){i&&i.isValid()?(e.is_changed=null,e.showAlert(jQuery.i18n._("Profile Saved Successfully!"),{style:{border:"2px solid #154575",color:"#154575"}}),e.api.getJobApplicant({onResult:function(t){t&&t.isValid()?(e.$("#saveBtn").removeClass("error"),e.edit_view_error_ui_dic={},LocalCacheData.setPortalLoginUser(t.getResult()[0]),IndexViewController.instance.router.headerView.render()):(e.showErrorAlert(t),ProgressBar.closeOverlay())}})):e.setErrorTips(i)}})}showErrorAlert(e){var i=e.getDetails();i.hasOwnProperty("error"),i||(i=e.getDescription());var t="";Global.isArray(i)||typeof i=="object"?jQuery.each(i,function(a,r){r.hasOwnProperty("error")&&(r=r.error);for(var o in r)t=t+r[o]+"<br>"}):t=i,this.showAlert(t)}showAlert(e,i){IndexViewController.instance.router.showTipModal(e,i)}onFormTitleClick(e){this.toggleSubViews(e),jQuery("span.glyphicon",e.currentTarget).toggleClass("glyphicon-chevron-up glyphicon-chevron-down"),setTimeout(function(){jQuery(e.currentTarget).toggleClass("title-expand title-pack-up")},500)}toggleSubViews(e){var i=jQuery(e.currentTarget).attr("id"),t="."+i;this.$(t).slideToggle("row-expand row-pack-up")}initSubHistoryView(){var e=["JobApplicantEmployment","JobApplicantReference","JobApplicantLocation"];for(var i in e)this.initSubViews(e[i])}initSubQualificationView(){this.initSubViews("JobApplicantSkill",{type_id:10}),this.initSubViews("JobApplicantEducation",{type_id:20}),this.initSubViews("JobApplicantLicense",{type_id:30}),this.initSubViews("JobApplicantLanguage",{type_id:40}),this.initSubViews("JobApplicantMembership",{type_id:50})}initSubApplicationView(){this.initSubViews("JobApplication")}initSubDocumentView(){this.initSubViews("Document")}initSubViews(e,i){var t=this;switch(e){case"JobApplication":var a={job_vacancy:jQuery.i18n._("Job Vacancy"),created_date:jQuery.i18n._("Date")};this.setSubViews(e,a);break;case"Document":var a={name:jQuery.i18n._("Name"),created_date:jQuery.i18n._("Uploaded Date")};this.setSubViews(e,a,i);break;case"JobApplicantSkill":case"JobApplicantEducation":case"JobApplicantMembership":case"JobApplicantLicense":case"JobApplicantLanguage":var r={},o={};o.type_id=[i.type_id],r.filter_data=o,r.filter_columns={id:!0,name:!0},this.qualification_api.getQualification(r,!0,{onResult:function(n){var s=n.getResult();if(s===!0&&t.isEnableAddQualification(e)===!1){t.$("."+e+"-table").parent().parent().css("display","none");return}else t.showQualificationHeader(),t.getAllColumns(e,function(c){t.setSubViews(e,c)})}});break;default:this.getAllColumns(e,function(n){t.setSubViews(e,n)});break}}showQualificationHeader(){this.$("#qualifications-tables").show()}isEnableAddQualification(e){var i;switch(e){case"JobApplicantSkill":i=this.enable_add_qualification_fields.hasOwnProperty("skill")&&this.enable_add_qualification_fields.skill===!0;break;case"JobApplicantEducation":i=this.enable_add_qualification_fields.hasOwnProperty("education")&&this.enable_add_qualification_fields.education===!0;break;case"JobApplicantMembership":i=this.enable_add_qualification_fields.hasOwnProperty("membership")&&this.enable_add_qualification_fields.membership===!0;break;case"JobApplicantLicense":i=this.enable_add_qualification_fields.hasOwnProperty("license")&&this.enable_add_qualification_fields.license===!0;break;case"JobApplicantLanguage":i=this.enable_add_qualification_fields.hasOwnProperty("language")&&this.enable_add_qualification_fields.language===!0;break}return i}addDocumentRow(e){var i={};i.filter_data={id:e},i.append=!0,this.initSubViews("Document",i)}getAllColumns(e,i){var t="get"+e+"Options";this.api[t]("columns",{onResult:function(a){var r=a.getResult();i&&i(r)}})}setSubViews(e,i,t){var a=this,r={};r.filter_data={},r.filter_sort={},r.filter_items_per_page=0,r.filter_page=1,Global.isSet(t)&&Global.isSet(t.filter_data)&&(r.filter_data=t.filter_data),this.api["get"+e](r,!0,{onResult:function(o){var n=o.getResult(),s="."+e+"-table";if((!Global.isSet(t)||Global.isSet(t)&&!t.append)&&a.$(s).empty(),!Global.isArray(n)&&!TTUUID.isUUID(a.refresh_id))a.$(s).html('<h4 class="no-result">'+jQuery.i18n._('None provided yet, click the "+" icon to add')+"</h4>");else for(var c in n)a.initSubView(e,i,n[c])}})}initSubView(e,i,t){var a=this,r=new Backbone.Model(t),o=e+"SubViewController",n=null,s;switch(e){case"JobApplicantEmployment":n=this.employment_history_fields;break;case"JobApplicantReference":n=this.reference_fields;break;case"JobApplicantLocation":n=this.location_fields;break;case"JobApplicantSkill":n=this.skill_fields,s=this.enable_add_qualification_fields.skill;break;case"JobApplicantEducation":n=this.education_fields,s=this.enable_add_qualification_fields.education;break;case"JobApplicantMembership":n=this.membership_fields,s=this.enable_add_qualification_fields.membership;break;case"JobApplicantLicense":n=this.license_fields,s=this.enable_add_qualification_fields.license;break;case"JobApplicantLanguage":n=this.language_fields,s=this.enable_add_qualification_fields.language;break}switch(o){case"JobApplicantEmploymentSubViewController":var c=JobApplicantEmploymentSubViewController;break;case"JobApplicantReferenceSubViewController":var c=JobApplicantReferenceSubViewController;break;case"JobApplicantLocationSubViewController":var c=JobApplicantLocationSubViewController;break;case"JobApplicantSkillSubViewController":var c=JobApplicantSkillSubViewController;break;case"JobApplicantSubBaseViewController":var c=JobApplicantSubBaseViewController;break;case"JobApplicantEducationSubViewController":var c=JobApplicantEducationSubViewController;break;case"JobApplicantMembershipSubViewController":var c=JobApplicantMembershipSubViewController;break;case"JobApplicantLicenseSubViewController":var c=JobApplicantLicenseSubViewController;break;case"JobApplicantLanguageSubViewController":var c=JobApplicantLanguageSubViewController;break;case"JobApplicationSubViewController":var c=JobApplicationSubViewController;break;case"DocumentSubViewController":var c=DocumentSubViewController;break}new c({table_container:a.$("."+e+"-table"),model:r,sub_view_id:e,_delegate:a,available_fields:n,enable_add_qualification:s,display_columns:i})}onSubViewAddClick(e){var i=this,t=jQuery(e.currentTarget).attr("id"),a=t.split("-")[0];switch(a){case"JobApplication":var r={job_vacancy:jQuery.i18n._("Job Vacancy"),created_date:jQuery.i18n._("Date")};i.setSubViewsDefaultData(a,r);break;case"Document":var r={name:jQuery.i18n._("Name"),created_date:jQuery.i18n._("Uploaded Date")};i.setSubViewsDefaultData(a,r);break;default:this.getAllColumns(a,function(o){i.setSubViewsDefaultData(a,o)});break}}setSubViewsDefaultData(e,i){var t=this;if(e==="JobApplication"){this.availableJobsClick();return}this.api["get"+e+"DefaultData"]({onResult:function(a){var r=a.getResult();t.initSubView(e,i,r)}})}getFilterColumnsFromDisplayColumns(e){var i={};i.is_owner=!0,i.id=!0,i.is_child=!0,i.in_use=!0,i.first_name=!0,i.last_name=!0,i.job_vacancy_id=!0;for(var t in e)i[t]=!0;return i}}MyProfileViewController.html_template=`
<div id="my_profile_view">
	<div class="job-applicant-navbar">
		<div class="container">
			<div class="row">
				<div class="col-md-3 col-sm-12 col-xs-12">
					<button id="available_jobs" class="btn btn-block btn-default w-100"><span class="glyphicon glyphicon-menu-left"></span> <%= $.i18n._('Available Jobs') %></button>
				</div>
				<div class="col-md-3 col-sm-12 col-xs-12">
					<button id="applied_jobs" class="btn btn-block btn-default w-100"><%= $.i18n._('Applied Jobs') %></button>
				</div>
				<div class="col-md-2 col-sm-12 col-xs-12 offset-4">
					<button id="saveBtn" class="btn save-btn btn-block w-100"><%= $.i18n._('Save') %></button>
				</div>
			</div>
		</div>
	</div>
</div>
`;const MyProfileViewController$1=Object.freeze(Object.defineProperty({__proto__:null,MyProfileViewController},Symbol.toStringTag,{value:"Module"}));class ApplicationRouter extends Backbone.Router{constructor(l={}){_.defaults(l,{controller:null,headerView:null,routes:{"":"onViewChange","!:viewName":"onViewChange","*notFound":"notFound"}}),super(l)}reloadView(view_id){eval("typeof "+view_id+"ViewController")==="function"&&PortalBaseViewController.loadView(view_id)}notFound(l){var e=Global.getBaseURL();Global.setURLToBrowser(e+"#!m=PortalJobVacancy")}onViewChange(l){var e=this,i={},t,a,r;if(Global.needReloadBrowser){Global.needReloadBrowser=!1,window.location.reload();return}if(l&&(i=Global.buildArgDic(l.split("&"))),l&&l.indexOf("m=")>=0?t=Global.sanitizeViewId(i.m):t="PortalJobVacancy",LocalCacheData.fullUrlParameterStr=l,LocalCacheData.setAllURLArgs(i),LocalCacheData.getAllURLArgs()&&(LocalCacheData.getAllURLArgs().hasOwnProperty("company_id")||(TTPromise.add("IndexController","onViewChange"),TTPromise.wait(null,null,function(){IndexViewController$1&&IndexViewController$1.instance&&IndexViewController$1.instance.router?IndexViewController$1.instance.router.showTipModal(jQuery.i18n._("Invalid Company")):TAlertManager.showAlert(jQuery.i18n._("Invalid Company"))}),setTimeout(function(){TTPromise.resolve("IndexController","onViewChange")},4e3))),a=i.id,r=i.a,LocalCacheData.current_open_view_id===t){if(LocalCacheData.current_open_primary_controller){if(r){switch(r){case"edit":(!LocalCacheData.current_open_primary_controller.edit_view||LocalCacheData.current_open_primary_controller.current_edit_record&&LocalCacheData.current_open_primary_controller.current_edit_record.id!=a)&&LocalCacheData.current_doing_context_action==="edit"&&f(a);break;case"new":LocalCacheData.current_open_primary_controller.edit_view||f();break;case"view":switch(t){case"MessageControl":i.t==="message"?(!LocalCacheData.current_open_primary_controller.edit_view||!p())&&f(a,!0):i.t==="request"&&(!LocalCacheData.current_open_primary_controller.edit_view||LocalCacheData.current_open_primary_controller.current_select_message_control_data.id!=a)&&f(a,!0);break;default:(!LocalCacheData.current_open_primary_controller.edit_view||LocalCacheData.current_open_primary_controller.current_edit_record.id!=a)&&f(a,!0);break}}return}else if(LocalCacheData.current_open_primary_controller.edit_view&&LocalCacheData.current_open_primary_controller.current_edit_record){if(LocalCacheData.current_open_primary_controller.viewId==="TimeSheet"&&LocalCacheData.current_open_primary_controller.is_mass_editing)return;LocalCacheData.current_open_primary_controller.buildContextMenu(!0),LocalCacheData.current_open_primary_controller.removeEditView(),this.cleanAnySubViewUI()}}return}else switch(LocalCacheData.edit_id_for_next_open_view=a,r&&(LocalCacheData.current_doing_context_action=r),t){case"TimeSheet":case"Schedule":i.date&&(LocalCacheData.current_select_date=i.date);break}var o;if(o=0,LocalCacheData.loadViewRequiredJSReady)s();else var n=setInterval(function(){o==100&&clearInterval(n),o=o+1,LocalCacheData.loadViewRequiredJSReady&&(s(),clearInterval(n))},600);function s(){IndexViewController$1.autoLogin(function(){if(jQuery("body").removeClass("login-bg"),Global.loadStyleSheet("../../framework/bootstrap-select/css/bootstrap-select.min.css?v="+APIGlobal.pre_login_data.application_build),!e.headerView)e.headerView=new HeaderViewController,jQuery("#topContainer").html(e.headerView.el),u();else if(e.headerView.profileView&&e.headerView.profileView.is_changed){e.showConfirmModal(jQuery.i18n._("You have modified data without saving, are you sure you want to continue and lose your changes"),{title:"",actions:[{label:"No",isClose:!0,callBack:function(d){e.navigate("#!m=MyProfile&company_id="+LocalCacheData.getAllURLArgs().company_id,{trigger:!1,replace:!0})}},{label:"Yes",callBack:function(d){e.hideConfirmModal(),c(),u()}}]});return}else c(),u()})}function c(){e.headerView.jobVacancyViewController=null,e.headerView.profileView=null,e.headerView.render()}function u(){switch(setTimeout((function(){Global.topContainer().css("display","block"),Global.bottomContainer().css("display","block"),Global.showPoweredBy()}).bind(this),50),t){case"PortalJobVacancyDetail":window.PortalJobVacancyDetailViewController=PortalJobVacancyDetailViewController;break;case"PortalJobVacancy":window.PortalJobVacancyViewController=PortalJobVacancyViewController;break;case"MyProfile":window.MyProfileViewController=MyProfileViewController;break;case"MyJobApplication":window.MyJobApplicationViewController=MyJobApplicationViewController;break}PortalBaseViewController.loadView(t)}function p(){if(Global.isArray(LocalCacheData.current_open_primary_controller.current_edit_record))for(var d=0;d<LocalCacheData.current_open_primary_controller.current_edit_record.length;d++){var h=LocalCacheData.current_open_primary_controller.current_edit_record[d];if(h.id===a)return!0}else if(h=LocalCacheData.current_open_primary_controller.current_edit_record,h.id===a)return!0;return!1}function f(d,h){var b;switch(t){case"MessageControl":b=i.t;var m={};b==="message"?m.id=d:(m.object_id=d,m.object_type_id=50),LocalCacheData.current_open_primary_controller.onViewClick(m);break;case"TimeSheet":b=i.t,h?d&&LocalCacheData.current_open_primary_controller.onViewClick(d,b):d?LocalCacheData.current_open_primary_controller.onEditClick(d,b):LocalCacheData.current_open_primary_controller.onAddClick();break;default:h?d&&LocalCacheData.current_open_primary_controller.onViewClick(d):d?LocalCacheData.current_open_primary_controller.onEditClick(d):LocalCacheData.current_open_primary_controller.onAddClick();break}}}cleanAnySubViewUI(){var l=Global.contentContainer().children();if(l.length>1)for(var e=1;e<l.length;e++)try{if(jQuery(l[e]).attr("id")===LocalCacheData.current_open_primary_controller.ui_id)continue;l[e].remove()}catch{}}setContentDivHeight(){Global.contentContainer().removeClass("content-container"),Global.contentContainer().addClass("content-container-after-login"),Global.topContainer().addClass("top-container-after-login")}addTopMenu(){Global.loadScript("global/widgets/top_menu/TopMenuController.js"),TopMenuController&&TopMenuController.loadView()}showFormModal(l,e){jQuery("#formModal").hasClass("show")?(this.hideFormModal(),setTimeout(function(){i()},500)):i();function i(){if(!e&&(e={title:"...",actions:[]}),jQuery("#formModal").length>0){var t=new bootstrap.Modal(document.getElementById("formModal"),{backdrop:"static"});t.show()}jQuery("#formModalLabel").text(e.title),jQuery("#formModalBody").html(l),e.actions.length>0&&(jQuery("#formModalFooter").empty(),jQuery.each(e.actions,function(r,o){var n=jQuery('<button type="button" class="btn"></button>');o.isClose&&n.attr("data-bs-dismiss","modal"),n.text(o.label),o.class&&n.addClass(o.class),!o.class&&n.addClass("btn-primary"),o.callBack&&(o.isClose&&jQuery("#formModal button.close").unbind("click").bind("click",o.callBack.bind(self)),n.unbind("click").bind("click",o.callBack.bind(self))),jQuery("#formModalFooter").append(n)}));let a=jQuery("#formModal").find("#inputFile");a.length>0&&a.unbind("change").bind("change",function(r){let o=jQuery("#formModal").find("#file_name");o.length>0&&o.val(r.target.files[0].name)})}}showTipModal(l,e){var i=this;jQuery("#tipModal").hasClass("show")?(this.hideTipModal(),setTimeout(function(){t()},500)):t();function t(){if(!e&&(e={title:"...",actions:[],style:{}}),jQuery("#tipModal .modal-content").css(e.style),jQuery("#tipModal").length>0){var a=new bootstrap.Modal(document.getElementById("tipModal"));a.show()}jQuery("#tipModalBody").html(l),i.autoHideTipModal()}}showConfirmModal(l,e){jQuery("#confirmModal").is(":visible")?(this.hideConfirmModal(),setTimeout(function(){i()},500)):i();function i(){if(!e&&(e={title:"...",actions:[]}),jQuery("#confirmModal").length>0){var t=new bootstrap.Modal(document.getElementById("confirmModal"),{backdrop:"static"});t.show()}jQuery("#confirmModalLabel").text(e.title),jQuery("#confirmModalBody").html(l),e.actions.length>0&&(jQuery("#confirmModalFooter").empty(),jQuery.each(e.actions,function(a,r){var o=jQuery('<button type="button" class="btn"></button>');r.isClose&&o.attr("data-bs-dismiss","modal"),o.text(r.label),r.class&&o.addClass(r.class),!r.class&&o.addClass("btn-primary"),r.callBack&&o.unbind("click").bind("click",r.callBack.bind(self)),jQuery("#confirmModalFooter").append(o)}))}}showSignInModal(l,e){jQuery("#signinModal").hasClass("show")?(this.hideSignInModal(),setTimeout(function(){i()},500)):i();function i(){if(!e&&(e={title:"...",actions:[]}),jQuery("#signinModal").length>0){var t=new bootstrap.Modal(document.getElementById("signinModal"),{backdrop:"static"});t.show()}jQuery("#signinModalLabel").text(e.title),jQuery("#signinModalBody").html(l),e.actions.length>0&&(jQuery("#signinModalFooter").empty(),jQuery.each(e.actions,function(a,r){var o=jQuery('<button type="button" class="btn"></button>');r.isClose&&o.attr("data-bs-dismiss","modal"),o.text(r.label),r.class&&o.addClass(r.class),!r.class&&o.addClass("btn-primary"),r.callBack&&(r.isClose&&jQuery("#signinModal button.close").unbind("click").bind("click",r.callBack.bind(self)),o.unbind("click").bind("click",r.callBack.bind(self))),jQuery("#signinModalFooter").append(o)}))}}autoHideTipModal(){var l=this;setTimeout(function(){l.hideTipModal()},5e3)}hideTipModal(){var l=bootstrap.Modal.getInstance(document.getElementById("tipModal"));l&&l.hide()}hideFormModal(){var l=bootstrap.Modal.getInstance(document.getElementById("formModal"));l&&l.hide()}hideSignInModal(){var l=bootstrap.Modal.getInstance(document.getElementById("signinModal"));l&&l.hide()}hideConfirmModal(){var l=bootstrap.Modal.getInstance(document.getElementById("confirmModal"));l&&l.hide()}removeCurrentView(l){LocalCacheData.current_open_edit_only_controller&&(e(LocalCacheData.current_open_edit_only_controller),LocalCacheData.current_open_edit_only_controller=null),LocalCacheData.current_open_primary_controller?(LocalCacheData.current_open_primary_controller.edit_view&&e(LocalCacheData.current_open_primary_controller),Global.contentContainer().empty(),LocalCacheData.current_open_primary_controller.cleanWhenUnloadView(l)):Global.isSet(l)&&l();function e(i){i.clearErrorTips(),i.edit_view&&i.edit_view.remove(),i.sub_log_view_controller=null,i.edit_view_ui_dic={},i.edit_view_ui_validation_field_dic={},i.edit_view_form_item_dic={},i.edit_view_error_ui_dic={},LocalCacheData.current_doing_context_action=""}}}let IndexViewController$1=class v extends Backbone.View{constructor(e={}){_.defaults(e,{el:"body",router:null}),super(e)}initialize(e){this.router=new ApplicationRouter,this.router.controller=this,Backbone.History.started||Backbone.history.start(),v.instance=this}};IndexViewController$1.autoLogin=function(l){var e=getCookie(Global.getSessionIDKey()),i=LocalCacheData.getLoginData();e&&e.length>=40&&i&&i.is_logged_in==!0?IndexViewController$1.setPortalLoginUserData(e,l):l()};IndexViewController$1.setPortalLoginUserData=function(l,e){if(LocalCacheData.getPortalLoginUser()===null){var i=this;LocalCacheData.setSessionID(l),setCookie(Global.getSessionIDKey(),l),this.doing_login=!0,this.jobapplicant_api=TTAPI.APIJobApplicantPortal,this.jobapplicant_api.getJobApplicant({onResult:function(t){t&&t.isValid()&&LocalCacheData.setPortalLoginUser(t.getResult()[0]),i.doing_login=!1,e&&e()}})}else e()};IndexViewController$1.goToView=function(l,e){jQuery("#"+l).addClass("selected-menu"),LocalCacheData.default_filter_for_next_open_view=e,MenuManager.goToView(l,!0)};IndexViewController$1.goToViewByViewLabel=function(l){var e;switch(l){case"Exceptions":e="Exception";break;case"Messages":e="MessageControl";break;case"Requests":e="Request";break;case"Contact Information":IndexViewController$1.openEditView(LocalCacheData.current_open_primary_controller,"LoginUserContact");return;default:var i=/\s/g;e=l.replace(i,"");break}MenuManager.goToView(e,!0)};IndexViewController$1.openWizard=function(l,e,i){switch(BaseWizardController.default_data=e,BaseWizardController.call_back=i,l){default:Global.trackView(l),Global.loadViewSource(l,l+"Controller.js",function(){BaseWizardController.openWizard(l,l+".html")});break}};IndexViewController$1.openReport=function(parent_view_controller,view_name,id){var view_controller=null;switch(LocalCacheData.current_open_report_controller&&LocalCacheData.current_open_report_controller.removeEditView(),ProgressBar.showOverlay(),view_name){default:Global.loadViewSource(view_name,view_name+"ViewController.js",function(){view_controller=eval("new "+view_name+"ViewController( {edit_only_mode: true} ); "),view_controller.parent_view_controller=parent_view_controller,view_controller.openEditView();var current_url=window.location.href;current_url.indexOf("&sm")>0&&(current_url=current_url.substring(0,current_url.indexOf("&sm"))),current_url=current_url+"&sm="+view_name,LocalCacheData.default_edit_id_for_next_open_edit_view&&(current_url=current_url+"&sid="+LocalCacheData.default_edit_id_for_next_open_edit_view),Global.setURLToBrowser(current_url)});break}};IndexViewController$1.openEditView=function(parent_view_controller,view_name,id){var view_controller=null;if(!PermissionManager.checkTopLevelPermission(view_name)&&view_name!=="map"){TAlertManager.showAlert("Permission denied");return}switch(Global.trackView(view_name),view_name){default:Global.loadViewSource(view_name,view_name+"ViewController.js",function(){view_controller=eval("new "+view_name+"ViewController( {edit_only_mode: true} ); "),view_controller.parent_view_controller=parent_view_controller,view_controller.openEditView(id);var current_url=window.location.href;current_url.indexOf("&sm")>0&&(current_url=current_url.substring(0,current_url.indexOf("&sm"))),id?current_url=current_url+"&sm="+view_name+"&sid="+id:current_url=current_url+"&sm="+view_name,Global.setURLToBrowser(current_url),LocalCacheData.current_open_edit_only_controller=view_controller});break}};IndexViewController$1.instance=null;class PortalBaseViewController extends TTBackboneView{constructor(e={}){_.defaults(e,{can_cache_controller:!0,pager_data:null,events:{"click .search-btn":"onSearchClick",'change select[id="country"]':"onCountryChange",'keydown input[id="name"]':"autoSearch",'keydown input[id="city"]':"autoSearch"}}),super(e)}initialize(e){window.bootstrap=bootstrap$1,super.initialize(e),this.preInit(e),this.company_api=TTAPI.APICompanyPortal,LocalCacheData.current_open_primary_controller=this,this.init(),this.postInit(e)}preInit(){}init(){}postInit(){}render(){var e=this;ProgressBar.showOverlay(),this.initOptions(function(){e.search()}),jQuery(window).off("scroll").on("scroll",Global.debounce(function(){e.isOnScreen(".more.container")&&e.loadMore()},200))}isOnScreen(e){let i=jQuery(e);if(i.length===0||!i.is(":visible"))return!1;let t=i[0].getBoundingClientRect();return t.top>=0&&t.left>=0&&t.right<=(window.innerWidth||document.documentElement.clientWidth)&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)}autoSearch(e){e.keyCode===13&&this.onSearchClick()}initOptions(e){this.initCountryOptions(e)}initCountryOptions(e){var i=this;this.company_api.getOptions("country",{onResult:function(a){var a=a.getResult();i.$("#country").append(jQuery("<option></option>").prop("value","").attr("selected","selected").text(jQuery.i18n._("All Countries"))),jQuery.each(a,function(r,o){i.$("#country").append(jQuery("<option></option>").prop("value",r).text(jQuery.i18n._(o)))}),i.$("#country").selectpicker(),i.$("#province").selectpicker(),e()}})}onCountryChange(){this.eSetProvince(this.$('select[id="country"]').val())}eSetProvince(e){var i=this;if(i.$("#province").selectpicker("destroy"),!e){i.$("#province").html(jQuery("<option></option>").prop("value","").attr("selected","selected").text(jQuery.i18n._("All Province/States"))),i.$("#province").selectpicker();return}this.company_api.getOptions("province",e,{onResult:function(t){t=t.getResult(),t||(t=[]),i.$("#province").html(jQuery("<option></option>").prop("value","").attr("selected","selected").text(jQuery.i18n._("All Province/States"))),jQuery.each(t,function(a,r){i.$("#province").append(jQuery("<option></option>").prop("value",a).text(jQuery.i18n._(r)))}),i.$("#province").selectpicker()}})}loadMore(){this.onSearchClick({page_action:"next"})}addSearchResultPanel(){}onSearchClick(e){var i=this,t={};this.addSearchResultPanel(),typeof e>"u"&&(e={}),typeof e.page_action>"u"&&this.$(".search-result .content").empty(),this.vacancy_list_panel=this.$(".search-result .content"),this.more_btn=this.$(".search-result .more"),this.more_btn.unbind("click").bind("click",function(){i.loadMore()}),t.filter_data={},t.filter_sort={},t.filter_items_per_page=0,this.$("#name").val()&&this.$("#name").val()!=""&&(t.filter_data.name=this.$("#name").val()),this.$("#country").val()&&this.$("#country").val()!=""&&(t.filter_data.country=this.$("#country").val()),this.$("#province").val()&&this.$("#province").val()!=""&&(t.filter_data.province=this.$("#province").val()),this.$("#city").val()&&this.$("#city").val()!=""&&(t.filter_data.city=this.$("#city").val()),this.pager_data&&e.page_action==="next"?t.filter_page=this.pager_data.next_page:t.filter_page=1,LocalCacheData.getAllURLArgs()&&LocalCacheData.getAllURLArgs().hasOwnProperty("branch_id")&&(t.filter_data.branch_id=LocalCacheData.getAllURLArgs().branch_id),this.api["get"+this.api.key_name](t,!1,{onResult:function(a){i.pager_data=a.getPagerData();var r=a.getResult(),o=i.vacancy_list_panel.find(".vacancy-list-no-result");if((o[0]||i.pager_data&&i.pager_data.is_first_page)&&i.vacancy_list_panel.empty(),Global.isArray(r))for(var s=0;s<r.length;s++){var c=r[s],u=new Backbone.Model(c),p=new PortalJobVacancyRowController({model:u});i.vacancy_list_panel.append(p.el)}else{var n=jQuery('<div class="vacancy-list-no-result">'+jQuery.i18n._("No Results Found")+"</div>");i.vacancy_list_panel.html(n)}!i.pager_data||i.pager_data.is_last_page||r===!0?i.more_btn.hide():i.more_btn.show(),typeof e.callback<"u"&&e.callback()},onError:function(){window.location.reload()}})}onSelectClick(e){var i=jQuery(e.currentTarget).parent().find("select");if(document.createEvent){var e=document.createEvent("MouseEvents");e.initMouseEvent("mousedown",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i[0].dispatchEvent(e)}else element.fireEvent&&i[0].fireEvent("onmousedown")}}PortalBaseViewController.loadView=function(l){Global.loadViewSource(l,l+"View.html",function(e){var i=_.template(e)();window.IndexViewController=IndexViewController$1,Global.contentContainer().html(i),LocalCacheData.current_open_view_id=l,jQuery("div.tooltip").remove(),Global.trackView(l,LocalCacheData.current_doing_context_action)})};const PortalBaseViewController$1=Object.freeze(Object.defineProperty({__proto__:null,PortalBaseViewController},Symbol.toStringTag,{value:"Module"}));export{DocumentSubViewController$1 as D,HeaderViewController$1 as H,JobApplicantSubBaseViewController$1 as J,MyProfileViewController$1 as M,PortalJobVacancyDetailController$1 as P,SignInController$2 as S,PortalJobVacancyDetailViewController$1 as a,PortalJobVacancyViewController$1 as b,JobApplicantEmploymentSubViewController$1 as c,JobApplicantReferenceSubViewController$1 as d,JobApplicantLocationSubViewController$1 as e,JobApplicantSkillSubViewController$1 as f,JobApplicantEducationSubViewController$1 as g,JobApplicantMembershipSubViewController$1 as h,JobApplicantLicenseSubViewController$1 as i,JobApplicantLanguageSubViewController$1 as j,JobApplicationSubViewController$1 as k,PortalBaseViewController$1 as l};
//# sourceMappingURL=PortalBaseViewController-CFANGFNp.bundle.js.map
