import{_ as m,j as a}from"./vendor-tTApdY0Y.bundle.js";class p extends BaseViewController{constructor(e={}){m.defaults(e,{el:"#user_skill_view_container",proficiency_array:null,document_object_type_id:null,qualification_group_api:null,qualification_api:null,qualification_group_array:null,source_type_array:null,qualification_array:null,sub_view_grid_autosize:!0}),super(e)}init(e){this.edit_view_tpl="UserSkillEditView.html",this.permission_id="user_skill",this.viewId="UserSkill",this.script_name="UserSkillView",this.table_name_key="user_skill",this.context_menu_name=a.i18n._("Skills"),this.navigation_label=a.i18n._("Skill"),this.api=TTAPI.APIUserSkill,this.qualification_api=TTAPI.APIQualification,this.qualification_group_api=TTAPI.APIQualificationGroup,this.document_object_type_id=125,this.render(),this.sub_view_mode||(this.buildContextMenu(),this.initData())}showNoResultCover(e){super.showNoResultCover(!!this.sub_view_mode)}onGridSelectRow(){this.sub_view_mode?(this.buildContextMenu(!0),this.cancelOtherSubViewSelectedStatus()):this.buildContextMenu(),this.setDefaultMenu()}onGridSelectAll(){this.sub_view_mode&&(this.buildContextMenu(!0),this.cancelOtherSubViewSelectedStatus()),this.setDefaultMenu()}cancelOtherSubViewSelectedStatus(){switch(!0){case typeof this.parent_view_controller.sub_user_education_view_controller<"u":this.parent_view_controller.sub_user_education_view_controller.unSelectAll();case typeof this.parent_view_controller.sub_user_license_view_controller<"u":this.parent_view_controller.sub_user_license_view_controller.unSelectAll();case typeof this.parent_view_controller.sub_user_membership_view_controller<"u":this.parent_view_controller.sub_user_membership_view_controller.unSelectAll();case typeof this.parent_view_controller.sub_user_language_view_controller<"u":this.parent_view_controller.sub_user_language_view_controller.unSelectAll();break}}onAddClick(){this.sub_view_mode&&this.buildContextMenu(!0),super.onAddClick()}initOptions(){var e=this;this.initDropDownOption("proficiency"),this.initDropDownOption("source_type"),this.qualification_group_api.getQualificationGroup("",!1,!1,{onResult:function(t){t=t.getResult(),t=Global.buildTreeRecord(t),e.qualification_group_array=t,!e.sub_view_mode&&e.basic_search_field_ui_dic.group_id&&(e.basic_search_field_ui_dic.group_id.setSourceData(t),e.adv_search_field_ui_dic.group_id.setSourceData(t))}});var l={},_={};_.type_id=[10],_.visibility_type_id=[10,100],l.filter_data=_,this.qualification_api.getQualification(l,{onResult:function(t){t=t.getResult(),e.qualification_array=t,!e.sub_view_mode&&e.basic_search_field_ui_dic.qualification_id&&(e.basic_search_field_ui_dic.qualification_id.setSourceData(t),e.adv_search_field_ui_dic.qualification_id.setSourceData(t))}})}getCustomContextMenuModel(){var e={exclude:["copy"],include:[{label:a.i18n._("Import"),id:"import_icon",menu_align:"right",action_group:"import_export",group:"other",vue_icon:"tticon tticon-file_download_black_24dp",permission_result:PermissionManager.checkTopLevelPermission("ImportCSVEmployeeSkill"),permission:null,sort_order:9010}]};return e}setDefaultMenuImportIcon(e,l,_){PermissionManager.checkTopLevelPermission("ImportCSVEmployeeSkill")===!0?ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,e.id,!0):ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,e.id,!1)}onCustomContextClick(e){switch(e){case"import_icon":this.onImportClick();break}}onImportClick(){var e=this;IndexViewController.openWizard("ImportCSVWizard","UserSkill",function(){e.search()})}onMassEditClick(){var e=this;e.is_add=!1,e.is_viewing=!1,e.is_mass_editing=!0,LocalCacheData.current_doing_context_action="mass_edit",e.openEditView();var l={},_=this.getGridSelectIdArray();_.length,this.mass_edit_record_ids=[],a.each(_,function(t,i){e.mass_edit_record_ids.push(i)}),l.filter_data={},l.filter_data.id=this.mass_edit_record_ids,this.api["getCommon"+this.api.key_name+"Data"](l,{onResult:function(t){var i=t.getResult();e.unique_columns={},e.linked_columns={},i||(i=[]),e.sub_view_mode&&e.parent_key&&(i[e.parent_key]=e.parent_value),e.current_edit_record=i,e.initEditView()}})}buildEditViewUI(){super.buildEditViewUI();var e=this,l={tab_skill:{label:a.i18n._("Skill")},tab_attachment:!0,tab_audit:!0};this.setTabModel(l),this.navigation.AComboBox({api_class:TTAPI.APIUserSkill,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_user_skill",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var _=this.edit_view_tab.find("#tab_skill"),t=_.find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(t);var i,r,u;i=Global.loadWidgetByName(FormItemType.AWESOME_BOX),i.AComboBox({api_class:TTAPI.APIUser,allow_multiple_selection:!0,layout_name:"global_user",field:"user_id",set_empty:!0,show_search_inputs:!0});var d={};d.permission_section="user_skill",i.setDefaultArgs(d),this.addEditFieldToColumn(a.i18n._("Employee"),i,t,"");var c={},o={};o.type_id=[10],o.visibility_type_id=[10,100],c.filter_data=o,i=Global.loadWidgetByName(FormItemType.AWESOME_BOX),i.AComboBox({api_class:TTAPI.APIQualification,allow_multiple_selection:!1,layout_name:"global_qualification",show_search_inputs:!0,set_empty:!0,field:"qualification_id"}),i.setDefaultArgs(c),this.addEditFieldToColumn(a.i18n._("Skill"),i,t),i=Global.loadWidgetByName(FormItemType.COMBO_BOX),i.TComboBox({field:"proficiency_id",set_empty:!0}),i.setSourceData(e.proficiency_array),this.addEditFieldToColumn(a.i18n._("Proficiency"),i,t),i=Global.loadWidgetByName(FormItemType.DATE_PICKER),i.TDatePicker({field:"first_used_date"}),this.addEditFieldToColumn(a.i18n._("First Used Date"),i,t),i=Global.loadWidgetByName(FormItemType.DATE_PICKER),i.TDatePicker({field:"last_used_date"}),this.addEditFieldToColumn(a.i18n._("Last Used Date"),i,t);var n=[];i=Global.loadWidgetByName(FormItemType.TEXT_INPUT),i.TTextInput({field:"experience",width:50}),n.push(i),r=a('<div class="widget-h-box"></div>'),u=a("<span class='widget-right-label'> "+a.i18n._("Automatic")+"</span>"),r.append(i),r.append(u),i=Global.loadWidgetByName(FormItemType.CHECKBOX),i.TCheckbox({field:"enable_calc_experience"}),n.push(i),r.append(i),this.addEditFieldToColumn(a.i18n._("Years Experience"),n,t,"",r),i=Global.loadWidgetByName(FormItemType.DATE_PICKER),i.TDatePicker({field:"expiry_date"}),this.addEditFieldToColumn(a.i18n._("Expiry Date"),i,t,"",null),i=Global.loadWidgetByName(FormItemType.TEXT_AREA),i.TTextArea({field:"description",width:"100%"}),this.addEditFieldToColumn(a.i18n._("Description"),i,t,"",null,null,!0),i.parent().width("45%"),i=Global.loadWidgetByName(FormItemType.TAG_INPUT),i.TTagInput({field:"tag",object_type_id:251}),this.addEditFieldToColumn(a.i18n._("Tags"),i,t,"",null,null,!0)}buildSearchFields(){super.buildSearchFields();var e={};e.permission_section="user_skill",this.search_fields=[new SearchField({label:a.i18n._("Employee"),in_column:1,field:"user_id",default_args:e,layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:a.i18n._("Proficiency"),in_column:1,field:"proficiency_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:a.i18n._("Skill"),in_column:1,field:"qualification_id",layout_name:"global_qualification",api_class:TTAPI.APIQualification,multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:a.i18n._("Group"),in_column:2,multiple:!0,field:"group_id",layout_name:"global_tree_column",tree_mode:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:a.i18n._("Source"),in_column:2,multiple:!0,field:"source_type_id",basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:a.i18n._("Expiry Date"),in_column:1,field:"expiry_date",tree_mode:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.DATE_PICKER}),new SearchField({label:a.i18n._("Tags"),field:"tag",basic_search:!0,adv_search:!0,in_column:1,object_type_id:251,form_item_type:FormItemType.TAG_INPUT}),new SearchField({label:a.i18n._("First Used Date"),in_column:2,field:"first_used_date",tree_mode:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.DATE_PICKER}),new SearchField({label:a.i18n._("Last Used Date"),in_column:2,field:"last_used_date",tree_mode:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.DATE_PICKER}),new SearchField({label:a.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:a.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX})]}setEditViewDataDone(){super.setEditViewDataDone(),this.current_edit_record.enable_calc_experience?this.edit_view_ui_dic.experience.setEnabled(!1):this.edit_view_ui_dic.experience.setEnabled(!0)}onFormItemChange(e,l){this.setIsChanged(e),this.setMassEditingFieldsWhenFormChange(e);var _=e.getField(),t=e.getValue();switch(_){case"enable_calc_experience":t?this.calcExperience():this.edit_view_ui_dic.experience.setEnabled(!0);break;case"last_used_date":case"first_used_date":this.current_edit_record.enable_calc_experience&&this.calcExperience();break}this.current_edit_record[_]=t,l||this.validate()}calcExperience(){this.edit_view_ui_dic.experience.setEnabled(!1);var e=this.edit_view_ui_dic.first_used_date.getValue(),l=this.edit_view_ui_dic.last_used_date.getValue();if(l=l||new Date().format(),e!==""&&l!==""){var _=this.api.calcExperience(e,l,{async:!1});if(_){var t=_.getResult();this.edit_view_ui_dic.experience.setValue(t)}}else this.edit_view_ui_dic.experience.setValue(0)}searchDone(){super.searchDone(),TTPromise.resolve("Employee_Qualifications_Tab","UserSkillViewController")}uniformVariable(e){if(Global.isArray(e.user_id)&&e.user_id.length>0){let l=[];for(let _ in e.user_id)l.push(Object.assign({},e,{user_id:e.user_id[_]}));return l}return e}}p.loadSubView=function(s,e,l){Global.loadViewSource("UserSkill","SubUserSkillView.html",function(_){var t={},i=m.template(_);Global.isSet(e)&&e(),Global.isSet(s)&&(s.html(i(t)),Global.isSet(l)&&l(sub_user_skill_view_controller))})};export{p as UserSkillViewController};
//# sourceMappingURL=UserSkillViewController-dwPj3eN9.bundle.js.map
