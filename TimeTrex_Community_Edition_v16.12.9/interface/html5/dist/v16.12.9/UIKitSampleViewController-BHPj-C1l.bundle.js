import{_ as w,j as t}from"./vendor-tTApdY0Y.bundle.js";import"./TImage-D3G3HRb1.bundle.js";import"./TImageBrowser-CvdFimWY.bundle.js";import"./TImageAdvBrowser-CQSTdPda.bundle.js";import"./TColorPicker-CsBr6yL-.bundle.js";import"./FormulaBuilder-C7dDDUu-.bundle.js";import{t as f}from"./content-Bx-gviSK.bundle.js";class P extends BaseViewController{constructor(i={}){w.defaults(i,{el:"#ui_kit_sample_view_container",report_api:null,company_api:null,combo_box_array:null,sub_ui_kit_child_sample_view_controller:null,combo_box_parent_array:[],combo_box_child_array:[]}),super(i)}init(i){this.edit_view_tpl="UIKitSampleEditView.html",this.permission_id="user",this.viewId="UIKitSample",this.script_name="UIKitSample",this.table_name_key="ui_kit",this.context_menu_name=t.i18n._("UIKit Sample"),this.navigation_label=t.i18n._("UIKit Sample"),this.api=TTAPI.APIUIKitSample,this.report_api=TTAPI.APITimesheetSummaryReport,this.company_api=TTAPI.APICompany,this.render(),this.buildContextMenu(),this.initData()}initOptions(){let i=[{option_name:"combo_box",api:this.api},{option_name:"country",field_name:"combo_box_parent",api:this.company_api}];this.initDropDownOptions(i,()=>{this.combo_box_parent_array=this.country_array})}onFormItemChange(i,d){this.setIsChanged(i),this.setMassEditingFieldsWhenFormChange(i);var e=i.getField();switch(e){case"combo_box_parent":var a=this.edit_view_ui_dic.combo_box_child;a.setValue(null);break}if(this.current_edit_record[e]=i.getValue(),e==="combo_box_parent"){this.onComboBoxParentChanged();return}d||this.validate()}onComboBoxParentChanged(){var i=this.edit_view_ui_dic.combo_box_parent.getValue();this.setComboBoxChild(i,!0)}setComboBoxChild(i,d,e){var a=this,l=a.edit_view_ui_dic.combo_box_child;!i||i==="-1"||i==="0"?(a.combo_box_child_array=[],l.setSourceData([])):this.company_api.getOptions("province",i,{onResult:function(_){if(_=_.getResult(),_||(_=[]),a.combo_box_child_array=Global.buildRecordArray(_),l.setSourceData(a.combo_box_child_array),d&&a.combo_box_child_array.length>0){let o=e||a.combo_box_child_array[0].value;a.current_edit_record.combo_box_child=o,l.setValue(o)}}})}getCustomContextMenuModel(){var i={exclude:[],include:[]};return i}buildEditViewUI(){super.buildEditViewUI();var i=this,d={tab_input_basic:{label:t.i18n._("Text / Basic"),html_template:this.getInputTabHtml()},tab_dropdowns:{label:t.i18n._("Dropdowns")},tab_date_selectors:{label:t.i18n._("Date / Time")},tab_image_file:{label:t.i18n._("Pickers")},tab_sub_view:{label:t.i18n._("Sub View"),is_sub_view:!0,init_callback:"initSubUIKitChildView",display_on_mass_edit:!1},tab_misc:{label:t.i18n._("Misc")},tab_audit:!0};this.setTabModel(d);var e;this.navigation.AComboBox({api_class:TTAPI.APIUIKitSample,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_ui_kit_sample",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var a=this.edit_view_tab.find("#tab_input_basic"),l=a.find(".first-column"),_,o;this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(l),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"text_input",width:"100%"}),this.addEditFieldToColumn(t.i18n._("Text Input (Display Name)"),e,l),e=Global.loadWidgetByName(FormItemType.TAG_INPUT),e.TTagInput({field:"tag",object_type_id:110}),this.addEditFieldToColumn(t.i18n._("Tags"),e,l,"",null,null,!0),e=Global.loadWidgetByName(FormItemType.TEXT_AREA),e.TTextArea({field:"textarea",width:"100%",rows:4}),this.addEditFieldToColumn(t.i18n._("Textarea"),e,l,"",null,null,!0),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"numeric_input",width:"100%"}),this.addEditFieldToColumn(t.i18n._("Numeric (20,4)"),e,l),e=Global.loadWidgetByName(FormItemType.PASSWORD_INPUT),e.TPasswordInput({field:"password_input",width:"100%"}),this.addEditFieldToColumn(t.i18n._("Password"),e,l,"",null,!0),e=Global.loadWidgetByName(FormItemType.CHECKBOX),e.TCheckbox({field:"checkbox"}),o=t("<div class='widget-h-box'></div>"),o.append(e),this.addEditFieldToColumn(t.i18n._("Checkbox"),e,l,"",o);var s=this.edit_view_tab.find("#tab_dropdowns"),r=s.find(".first-column");this.edit_view_tabs[1]=[],this.edit_view_tabs[1].push(r),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"combo_box"}),e.setSourceData(i.combo_box_array),this.addEditFieldToColumn(t.i18n._("Combo Box"),e,r,""),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"combo_box_parent"}),e.setSourceData(i.combo_box_parent_array),this.addEditFieldToColumn(t.i18n._("Combo Box Parent"),e,r,""),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"combo_box_child"}),e.setSourceData(i.combo_box_child_array),this.addEditFieldToColumn(t.i18n._("Combo Box Child"),e,r,""),e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIUser,allow_multiple_selection:!0,layout_name:"global_user",show_search_inputs:!0,set_empty:!0,field:"awesome_box_multi"}),this.addEditFieldToColumn(t.i18n._("Awesome Box Multiple"),e,r),e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIUser,allow_multiple_selection:!1,layout_name:"global_user",show_search_inputs:!0,set_empty:!0,field:"awesome_box_single"}),this.addEditFieldToColumn(t.i18n._("Awesome Box Single"),e,r);var p=this.edit_view_tab.find("#tab_date_selectors"),n=p.find(".first-column");this.edit_view_tabs[2]=[],this.edit_view_tabs[2].push(n),e=Global.loadWidgetByName(FormItemType.DATE_PICKER),e.TDatePicker({field:"date"}),this.addEditFieldToColumn(t.i18n._("Date"),e,n),e=Global.loadWidgetByName(FormItemType.DATE_PICKER),e.TRangePicker({field:"date_range",validation_field:"date_stamp"}),this.addEditFieldToColumn(t.i18n._("Date Range"),e,n,"",null,!0),e=Global.loadWidgetByName(FormItemType.TIME_PICKER),e.TTimePicker({field:"time",validation_field:"time_stamp"}),o=t("<div class='widget-h-box'></div>"),this.actual_time_label=t("<span class='widget-right-label'></span>"),o.append(e),o.append(this.actual_time_label),this.addEditFieldToColumn(t.i18n._("Time"),e,n,"",o,!0),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"text_input",width:"100%",need_parser_sec:!0,mode:"time_unit"}),this.addEditFieldToColumn(t.i18n._("Text Input (Display Name)"),e,n);var T=this.edit_view_tab.find("#tab_image_file"),m=T.find(".first-column");this.edit_view_tabs[3]=[],this.edit_view_tabs[3].push(m),e=Global.loadWidgetByName(FormItemType.IMAGE_AVD_BROWSER),this.image_browser=e.TImageAdvBrowser({field:"",default_width:128,default_height:128,enable_delete:!0,callBack:function(b){new ServiceCaller().uploadFile(b,"object_type=user_photo&object_id="+i.current_edit_record.id,{onResult:function(h){h.toLowerCase()==="true"?i.image_browser.setImage(ServiceCaller.getURLByObjectType("user_photo")+"&object_id="+i.current_edit_record.id):TAlertManager.showAlert(h,"Error")}})},deleteImageHandler:function(b){i.onDeleteImage()}}),o=t("<div class='widget-h-box'></div>"),_=t("<span class='widget-right-label'>"+t.i18n._("Upload Disabled")+"</span>"),o.append(this.image_browser),o.append(_),this.addEditFieldToColumn(t.i18n._("Photo"),this.image_browser,m,"",o,!1,!0),e=Global.loadWidgetByName(FormItemType.FILE_BROWSER),this.file_browser=e.TImageBrowser({field:"file",name:"file_data",accept_filter:"*"}),o=t("<div class='widget-h-box'></div>"),_=t("<span class='widget-right-label'>"+t.i18n._("Upload Disabled")+"</span>"),o.append(this.file_browser),o.append(_),this.addEditFieldToColumn(t.i18n._("File"),e,m,"",o,!0,!0),e=Global.loadWidgetByName(FormItemType.COLOR_PICKER),e.TColorPicker({field:"color"}),this.addEditFieldToColumn(t.i18n._("Color"),e,m);var y=this.edit_view_tab.find("#tab_misc"),c=y.find(".first-column");this.edit_view_tabs[4]=[],this.edit_view_tabs[4].push(c),e=Global.loadWidgetByName(FormItemType.SEPARATED_BOX),e.SeparatedBox({label:t.i18n._("Separated Box One")}),this.addEditFieldToColumn(null,e,c,"",null,!0,!1,"shifts_scheduled_to_work"),e=Global.loadWidgetByName(FormItemType.FORMULA_BUILDER),e.FormulaBuilder({field:"formula_builder",width:"100%",onFormulaBtnClick:function(){TTAPI.APIReportCustomColumn.getOptions("formula_functions",{onResult:function(b){var h=b.getResult();i.report_api.getOptions("filter_columns",{onResult:C});function C(I){var g=I.getResult(),u={};u.functions=Global.buildRecordArray(h),u.variables=Global.buildRecordArray(g),u.formula=i.current_edit_record.formula_builder,u.current_edit_record=Global.clone(i.current_edit_record),u.api=i.api,IndexViewController.openWizard("FormulaBuilderWizard",u,function(v){i.current_edit_record.formula_builder=v,i.edit_view_ui_dic.formula_builder.setValue(v)})}}})}}),i.addEditFieldToColumn(t.i18n._("Formula"),e,c,"",null,!0,!0),e=Global.loadWidgetByName(FormItemType.SEPARATED_BOX),e.SeparatedBox({label:t.i18n._("Separated Box Two")}),this.addEditFieldToColumn(null,e,c,"",null,!0,!1,"shifts_scheduled_to_work")}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:t.i18n._("Text Input"),in_column:1,field:"text_input",multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.TEXT_INPUT})]}setCurrentEditRecordData(){super.setCurrentEditRecordData(),this.setComboBoxChild(this.current_edit_record.combo_box_parent,!0,this.current_edit_record.combo_box_child),this.setWYSIWGText()}setWYSIWGText(i){var d=this,e=t(Global.loadWidgetByName(WidgetNamesDic.EDIT_VIEW_FORM_ITEM)),a=e.find(".edit-view-form-item-label-div"),l=e.find(".edit-view-form-item-input-div"),_=e.find(".edit-view-form-item-label");_.text(t.i18n._("TinyMCE")),l.addClass("edit-view-form-item-tinymce-textarea-div");var o=this.edit_view_tab.find("#tab_input_basic"),s=o.find(".third-column");return s.html(e),this.edit_view_tabs[0].push(s),this.editFieldResize(0),a.css("height","340px"),a.css("width",a.width()+1),this.showWYSIWGText(),window.onresize=function(){this.edit_view&&d.resizeMCE()},e}showWYSIWGText(){if(this.edit_view_tab){var i=this.edit_view_tab.find("#tab_input_basic").find(".third-column").find(".edit-view-form-item-label-div").width()+12,d=Global.loadWidgetByName(FormItemType.TINYMCE_TEXT_AREA,!0),e=this.current_edit_record.wysiwg_text,a=t(this.edit_view_tab.find(".edit-view-tab")[0]).width()-i,l={description:e,width:a-3+"px",height:"335px"},_=!1;this.is_viewing&&(_=!0);var o=w.template(d)(l);f.remove(),this.edit_view_tab.find("#tab_input_basic").find(".third-column").find(".edit-view-form-item-tinymce-textarea-div").html(o),f.init({height:"335px",width:"100%",autoresize_min_width:a-3,selector:".tinymce-text-area",readonly:_,menubar:!1,statusbar:!1,plugins:"link",content_style:"body { font-size: 14px; margin-top: 0; color: #404042; }"});var s=this,r=this.edit_view_tab.find("#tab_input_basic").find(".third-column").find(".edit-view-form-item-tinymce-textarea-div");r.hide();var p=setInterval(function(){var n=r.find("iframe").contents().find("body");w.isUndefined(n[0])||(clearInterval(p),s.resizeMCE(),r.show())},50)}}resizeMCE(){}setDefaultMenuDeleteIcon(i,d,e){d>=1?ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,i.id,!0):ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,i.id,!1)}setEditMenuDeleteIcon(i,d){(!this.current_edit_record||!this.current_edit_record.id)&&ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,i.id,!1)}uniformVariable(i){return this.is_mass_editing||(i.wysiwg_text=f.activeEditor.getContent()),i}removeEditView(){this.sub_ui_kit_child_sample_view_controller=null,super.removeEditView()}initSubUIKitChildView(){var i=this;if(!this.current_edit_record.id){TTPromise.resolve("BaseViewController","onTabShow");return}if(TTPromise.add("UIKitChildSampleView","init"),this.sub_ui_kit_child_sample_view_controller){this.sub_ui_kit_child_sample_view_controller.buildContextMenu(!0),this.sub_ui_kit_child_sample_view_controller.setDefaultMenu(),i.sub_ui_kit_child_sample_view_controller.parent_value=i.current_edit_record.id,i.sub_ui_kit_child_sample_view_controller.parent_edit_record=i.current_edit_record,i.sub_ui_kit_child_sample_view_controller.initData(),TTPromise.resolve("UIKitChildSampleView","init");return}Global.loadScript("views/ui_kit_sample/UIKitChildSampleViewController.js",function(){if(i.edit_view_tab){var a=i.edit_view_tab.find("#tab_sub_view"),l=a.find(".first-column-sub-view");Global.trackView("SubUIKitChildView"),UIKitChildSampleViewController.loadSubView(l,d,e)}});function d(){}function e(a,l){i.sub_ui_kit_child_sample_view_controller=a,i.sub_ui_kit_child_sample_view_controller.parent_key="parent_id",i.sub_ui_kit_child_sample_view_controller.parent_value=i.current_edit_record.id,i.sub_ui_kit_child_sample_view_controller.parent_edit_record=i.current_edit_record,i.sub_ui_kit_child_sample_view_controller.parent_view_controller=i,TTPromise.wait("BaseViewController","initialize",function(){i.sub_ui_kit_child_sample_view_controller&&i.sub_ui_kit_child_sample_view_controller.initData()})}}setEditViewDataDone(){super.setEditViewDataDone(),this.is_add&&Global.initFileDragAndDrop(this.edit_view[0].firstElementChild,i=>{this.attachDragAndDropFile(i)})}attachDragAndDropFile(i){let d=new DataTransfer;d.items.add(i[0]),this.edit_view_ui_dic.file[0].querySelector("input").files=d.files}getInputTabHtml(){return`<div id="tab_input_basic" class="edit-view-tab-outside">
					<div class="edit-view-tab" id="tab_text_content_div">
						<div class="first-column"></div>
						<div class="second-column"></div>
						<div class="fourth-column job-text-summary-description"></div>
						<div class="third-column full-width-column"></div>
					</div>
				</div>`}}export{P as UIKitSampleViewController};
//# sourceMappingURL=UIKitSampleViewController-BHPj-C1l.bundle.js.map
