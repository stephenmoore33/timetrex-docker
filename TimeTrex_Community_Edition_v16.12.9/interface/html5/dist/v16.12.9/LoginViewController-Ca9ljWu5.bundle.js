import{f as script,g as script$1,h as resolveComponent,o as openBlock,c as createElementBlock,d as createBaseVNode,t as toDisplayString,w as withDirectives,v as vShow,i as withKeys,k as vModelText,l as createVNode,p as createCommentVNode,q as createStaticVNode,u as pushScopeId,x as popScopeId,_,j as jQuery,y as hooks}from"./vendor-tTApdY0Y.bundle.js";import{c as _export_sfc,G as Global,d as TTVueUtils}from"./main_ui-z76rxVqJ.entry.bundle.js";const _sfc_main={created(){this.event_bus=new TTEventBus({component_id:this.component_id}),this.event_bus.on("global","reset_vue_data",this.resetData),this.event_bus.on("tt_login","user_closed_mfa_modal",()=>this.doing_login=!1),this.event_bus.on("tt_login","step_changed",()=>{let e=LocalCacheData.getAllURLArgs().step;!this.login_complete&&e!==this.form_step&&(e?this.setFormStep(e):this.setFormStep("user_name"))})},mounted(){Global.showPoweredBy(),Global.setURLToBrowser(Global.getBaseURL()+"#!m=Login&step="+this.form_step),this.onFormStepChange(),this.show_language_selector&&this.setLanguageSelector()},props:{view_id:{type:String,default:null},component_id:{type:String,default:null},default_error_message:{type:String,default:null},default_user_name:{type:String,default:null},default_user_password:{type:String,default:null},default_form_step:{type:String,default:"user_name"},show_language_selector:{type:Boolean,default:!1},authenticate_callback:{type:Function,default:null}},data(){return{form_step:this.default_form_step||"user_name",product_edition_id:LocalCacheData.productEditionId,user_name:this.default_user_name,user_password:this.default_user_password,error_message:this.default_error_message,authentication_api:TTAPI.APIAuthentication,session_type:"",mfa_type_id:0,doing_login:!1,login_complete:!1,labels:{sign_in:$.i18n._("Sign in"),user_name:$.i18n._("User Name"),password:$.i18n._("Password"),forgot_your_password:$.i18n._("Forgot Your Password"),forgot_user_name:$.i18n._("Forgot Your User Name"),quick_punch:$.i18n._("Quick Punch"),login:$.i18n._("Sign in"),next:$.i18n._("Next"),language:$.i18n._("Language"),version:"v"+APIGlobal.pre_login_data.application_build}}},computed:{company_logo(){return ServiceCaller.getURLByObjectType("primary_company_logo")},app_logo(){let e="theme/"+Global.theme;return Global.url_offset&&(e=Global.url_offset+e),e+="/css/views/login/images/",LocalCacheData.productEditionId>10&&LocalCacheData.deployment_on_demand===!0?e+="od.png":LocalCacheData.productEditionId===15?e+="beo.png":LocalCacheData.productEditionId===20?e+="peo.png":LocalCacheData.productEditionId===25?e+="eeo.png":e+="seo.png",e+="?v="+APIGlobal.pre_login_data.application_build,e},user_name_colspan(){return this.show_language_selector?"2":"3"},change_user_name_label(){return this.user_name+" "+$.i18n._("(Switch User Name?)")}},methods:{resetData(){Object.assign(this.$data,this.$options.data())},onFormSubmit(e){e.preventDefault(),this.handleFormStep()},handleFormStep(){switch(this.error_message=null,this.form_step){case"user_name":this.user_name.length>0?Global.getSessionTypeForLogin(this.user_name,e=>{this.session_type=e.session_type,this.mfa_type_id=e.mfa_type_id,this.mfa_type_id==1e3?TTSAML.loginUser(this.user_name,e.redirect_url):this.mfa_type_id==100?TTWebauthn.loginUser(e.user_id,this.user_name,this.authenticate_callback):this.setFormStep("password")}):this.error_message=$.i18n._("Please enter a valid user name.");break;case"password":this.user_password.length>0?this.session_type===""?Global.getSessionTypeForLogin(this.user_name,e=>{this.session_type=e.session_type,this.mfa_type_id=e.mfa_type_id,this.login()}):this.login():this.error_message=$.i18n._("Please enter a password.");break}},setFormStep(e){this.error_message=null,e||(e="user_name"),Global.setURLToBrowser(Global.getBaseURL()+"#!m=Login&step="+e),this.form_step=e,setTimeout(()=>{this.onFormStepChange()},100)},onFormStepChange(){switch(this.form_step){case"user_name":let e=document.querySelector("#user_name");e&&(e.focus(),e.offsetParent&&e.setSelectionRange(0,0));break;case"password":let t=document.querySelector("#password-input input");t&&(t.focus(),t.offsetParent&&t.setSelectionRange(0,0));break}},onAppTypeClick(){window.open("https://"+LocalCacheData.loginData.organization_url)},onQuickPunchClick(){window.open(ServiceCaller.root_url+LocalCacheData.loginData.base_url+"html5/quick_punch/")},onForgotPasswordClick(){IndexViewController.openWizard("ForgotPasswordWizard",null,function(){TAlertManager.showAlert($.i18n._("An email has been sent to you with instructions on how to reset your password."))})},onChangeUserNameClick(){this.setFormStep("user_name")},onLanguageChange(e){Global.setLanguageCookie(e.target.value),LocalCacheData.setI18nDic(null),ProgressBar.showProgressBar(TTUUID.generateUUID()),ProgressBar.changeProgressBarMessage($.i18n._("Language changed, reloading")+"..."),setTimeout(function(){window.location.reload()},2e3)},setLanguageSelector(){this.lan_selector=$(".language-selector"),this.lan_selector.TComboBox();var e=Global.buildRecordArray(LocalCacheData.getLoginData().language_options);this.lan_selector.setSourceData(e),this.lan_selector.setValue(LocalCacheData.getLoginData().language)},login(){this.doing_login!=!0&&(this.doing_login=!0,Global.login(this.user_name,this.user_password,this.session_type,!1,e=>{this.doing_login=!1,this.login_complete=!0,Global.setURLToBrowser(Global.getBaseURL()+"#!m=Login"),this.authenticate_callback(e)}))}},components:{InputText:script,Password:script$1}},_withScopeId=e=>(pushScopeId("data-v-67fda5a5"),e=e(),popScopeId(),e),_hoisted_1={class:"login-view login-view-bg"},_hoisted_2={class:"login-view-main-content"},_hoisted_3={class:"logo-container box-edge-spacing"},_hoisted_4=["src"],_hoisted_5=["src"],_hoisted_6={class:"form-container",id:"login-form"},_hoisted_7=_withScopeId(()=>createBaseVNode("hr",{class:"hr-form-top"},null,-1)),_hoisted_8={id:"form",class:"form box-edge-spacing"},_hoisted_9=_withScopeId(()=>createBaseVNode("colgroup",null,[createBaseVNode("col",{width:"48%"}),createBaseVNode("col",{width:"4%"}),createBaseVNode("col",{width:"48%"})],-1)),_hoisted_10={colspan:"3",class:"error-info"},_hoisted_11={colspan:"3",class:"secure-login",id:"secure-login-text",style:{"font-size":"1.5rem","font-weight":"bold"}},_hoisted_12=["colspan"],_hoisted_13={for:"user_name",style:{"margin-top":"8px"}},_hoisted_14=["placeholder","title"],_hoisted_15={colspan:"1",style:{padding:"25px 5px 0px 0px","font-size":"1rem"}},_hoisted_16={for:"language-selector",style:{"margin-top":"8px"}},_hoisted_17=["title"],_hoisted_18={style:{padding:"25px 5px 0px 0px","font-size":"1rem"}},_hoisted_19={colspan:"3"},_hoisted_20={style:{"margin-bottom":"8px"}},_hoisted_21={for:"password"},_hoisted_22={key:0},_hoisted_23={colspan:"3"},_hoisted_24={key:1},_hoisted_25={colspan:"3"},_hoisted_26=_withScopeId(()=>createBaseVNode("hr",null,null,-1)),_hoisted_27={id:"form2",class:"form button-form box-edge-spacing"},_hoisted_28=_withScopeId(()=>createBaseVNode("colgroup",null,[createBaseVNode("col",{width:"48%"}),createBaseVNode("col",{width:"4%"}),createBaseVNode("col",{width:"48%"})],-1)),_hoisted_29={key:0,class:"login-button-container"},_hoisted_30={key:1,class:"login-button-container"},_hoisted_31=_withScopeId(()=>createBaseVNode("td",null,"Â ",-1)),_hoisted_32={key:2,class:"quick-punch-button-container"},_hoisted_33={id:"versionNumber",class:"version-label"},_hoisted_34=createStaticVNode('<div id="login-footer" data-v-67fda5a5><div id="social_div" class="social-div" data-v-67fda5a5><a href="https://www.timetrex.com/r?id=451" target="_blank" data-v-67fda5a5><img class="facebook-img" border="0" data-v-67fda5a5></a><a href="https://www.timetrex.com/r?id=455" target="_blank" data-v-67fda5a5><img class="twitter-img" border="0" data-v-67fda5a5></a></div><div class="logo_container_powered_by" data-v-67fda5a5><img id="powered_by" alt="Workforce Management Software" data-v-67fda5a5></div><div class="logo_container_copyright" data-v-67fda5a5><span id="login_copy_right_info" class="copy-right-info-1 notranslate" data-v-67fda5a5></span></div></div>',1);function _sfc_render(e,t,i,n,a,o){const r=resolveComponent("Password");return openBlock(),createElementBlock("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createBaseVNode("img",{class:"company-logo",id:"companyLogo",src:o.company_logo,onClick:t[0]||(t[0]=(...s)=>o.onAppTypeClick&&o.onAppTypeClick(...s)),alt:"Workforce Management Software"},null,8,_hoisted_4),createBaseVNode("img",{class:"app-type",id:"appTypeLogo",src:o.app_logo,onClick:t[1]||(t[1]=(...s)=>o.onAppTypeClick&&o.onAppTypeClick(...s)),alt:"Time and Attendance Software"},null,8,_hoisted_5)]),createBaseVNode("div",_hoisted_6,[_hoisted_7,createBaseVNode("table",_hoisted_8,[_hoisted_9,createBaseVNode("tr",null,[createBaseVNode("td",_hoisted_10,toDisplayString(a.error_message),1)]),createBaseVNode("tr",null,[createBaseVNode("td",_hoisted_11,toDisplayString(a.labels.sign_in),1)]),withDirectives(createBaseVNode("tr",null,[createBaseVNode("td",{colspan:o.user_name_colspan,style:{padding:"25px 5px 0px 0px","font-size":"1rem"}},[createBaseVNode("label",_hoisted_13,toDisplayString(a.labels.user_name),1),withDirectives(createBaseVNode("input",{tabindex:"1",onKeyup:t[2]||(t[2]=withKeys((...s)=>o.onFormSubmit&&o.onFormSubmit(...s),["enter"])),"onUpdate:modelValue":t[3]||(t[3]=s=>a.user_name=s),class:"form-input",type:"text",placeholder:a.labels.user_name,title:a.labels.user_name,id:"user_name",name:"username",autocomplete:"username"},null,40,_hoisted_14),[[vModelText,a.user_name]])],8,_hoisted_12),withDirectives(createBaseVNode("td",_hoisted_15,[createBaseVNode("label",_hoisted_16,toDisplayString(a.labels.language),1),createBaseVNode("select",{class:"form-selector language-selector",onChange:t[4]||(t[4]=(...s)=>o.onLanguageChange&&o.onLanguageChange(...s)),style:{"margin-left":"5px"},id:"language-selector",title:a.labels.language},null,40,_hoisted_17)],512),[[vShow,i.show_language_selector]])],512),[[vShow,a.form_step==="user_name"]]),withDirectives(createBaseVNode("tr",_hoisted_18,[createBaseVNode("td",_hoisted_19,[createBaseVNode("div",_hoisted_20,[createBaseVNode("a",{href:"javascript:void(0)",id:"change_user_name",onClick:t[5]||(t[5]=(...s)=>o.onChangeUserNameClick&&o.onChangeUserNameClick(...s))},toDisplayString(this.change_user_name_label),1)]),createBaseVNode("label",_hoisted_21,toDisplayString(a.labels.password),1),createVNode(r,{id:"password-input",tabindex:"3",onKeyup:withKeys(o.onFormSubmit,["enter"]),placeholder:a.labels.password,modelValue:a.user_password,"onUpdate:modelValue":t[6]||(t[6]=s=>a.user_password=s),ref:"password_input",feedback:!1,toggleMask:""},null,8,["onKeyup","placeholder","modelValue"])])],512),[[vShow,a.form_step==="password"]]),a.form_step==="password"?(openBlock(),createElementBlock("tr",_hoisted_22,[createBaseVNode("td",_hoisted_23,[createBaseVNode("span",{id:"forgot_password",class:"forgot-password",onClick:t[7]||(t[7]=(...s)=>o.onForgotPasswordClick&&o.onForgotPasswordClick(...s))},toDisplayString(a.labels.forgot_your_password)+"?",1)])])):createCommentVNode("",!0),a.form_step==="user_name"?(openBlock(),createElementBlock("tr",_hoisted_24,[createBaseVNode("td",_hoisted_25,[createBaseVNode("span",{id:"forgot_user_name",class:"forgot-password",onClick:t[8]||(t[8]=(...s)=>o.onForgotPasswordClick&&o.onForgotPasswordClick(...s))},toDisplayString(a.labels.forgot_user_name)+"?",1)])])):createCommentVNode("",!0)]),_hoisted_26,createBaseVNode("table",_hoisted_27,[_hoisted_28,createBaseVNode("tr",null,[a.form_step==="user_name"?(openBlock(),createElementBlock("td",_hoisted_29,[createBaseVNode("button",{type:"submit",onClick:t[9]||(t[9]=(...s)=>o.onFormSubmit&&o.onFormSubmit(...s)),tabindex:"2",id:"next_btn",class:"login-button"},toDisplayString(a.labels.next),1)])):createCommentVNode("",!0),a.form_step==="password"?(openBlock(),createElementBlock("td",_hoisted_30,[createBaseVNode("button",{type:"submit",onClick:t[10]||(t[10]=(...s)=>o.onFormSubmit&&o.onFormSubmit(...s)),tabindex:"4",id:"login_btn",class:"login-button"},toDisplayString(a.labels.login),1)])):createCommentVNode("",!0),_hoisted_31,a.product_edition_id>10?(openBlock(),createElementBlock("td",_hoisted_32,[createBaseVNode("button",{type:"button",onClick:t[11]||(t[11]=(...s)=>o.onQuickPunchClick&&o.onQuickPunchClick(...s)),id:"quick_punch",class:"quick-punch-button"},toDisplayString(a.labels.quick_punch),1)])):createCommentVNode("",!0)])])]),createBaseVNode("div",_hoisted_33,toDisplayString(a.labels.version),1)]),_hoisted_34])}const TTlogin=_export_sfc(_sfc_main,[["render",_sfc_render],["__scopeId","data-v-67fda5a5"]]);class LoginViewController extends BaseViewController{constructor(e={}){_.defaults(e,{el:"#loginViewContainer",authentication_api:null,currentUser_api:null,currency_api:null,user_preference_api:null,user_locale:"en_US",is_login:!0,date_api:null,permission_api:null,lan_selector:null,default:{is_login:!1}}),super(e)}init(e){var t=this;Global.setVirtualDeviceViewport("mobile"),this.authentication_api=TTAPI.APIAuthentication,this.currentUser_api=TTAPI.APIAuthentication,this.currency_api=TTAPI.APICurrency,this.user_preference_api=TTAPI.APIUserPreference,this.date_api=TTAPI.APITTDate,this.permission_api=TTAPI.APIPermission,this.viewId="LoginView",this.event_bus=new TTEventBus({view_id:this.viewId}),Global.bottomContainer().css("display","none"),Global.contentContainer().removeClass("content-container-after-login"),LocalCacheData.getLoginData(),LocalCacheData.cleanNecessaryCache();var i=getCookie(Global.getSessionIDKey());if(i&&i.length>=40&&LocalCacheData.getLoginData().is_logged_in){var n=0;if(jQuery(this.el).invisible(),LocalCacheData.loadViewRequiredJSReady)Debug.Text("Login Success (first try)",null,null,"initialize",10),t.autoLogin();else var a=setInterval(function(){if(n==100){clearInterval(a),TAlertManager.showAlert(jQuery.i18n._("The network connection was lost. Please check your network connection then try again.")),Debug.Text("Login Failure",null,null,"initialize",10);return}n=n+1,LocalCacheData.loadViewRequiredJSReady&&(Debug.Text("Login Success after retry: "+n,null,null,"initialize",10),t.autoLogin(),clearInterval(a))},600)}else jQuery(this.el).visible(),this.render();NotificationConsumer.removeAllNotifications()}onAuthenticate(e,t){this.onLoginSuccess(e,t)}onLoginSuccess(e,t){var i,n=this;if(TAlertManager.closeBrowserBanner(),e===!1)TAlertManager.showAlert(Global.network_lost_msg);else if(e&&!e.isValid())LocalCacheData.setSessionID(""),Global.clearSessionCookie();else{if(ServiceCaller.cancel_all_error=!1,t?i=t:i=e.getResult().session_id,LocalCacheData.setSessionID(i),setCookie(Global.getSessionIDKey(),i),typeof is_login>"u"&&(this.is_login=!0),!this.currentUser_api||typeof this.currentUser_api.getCurrentUserPreference!="function")return;n.initializeLoginData()}}initializeLoginData(){var $this=this;this.event_bus.emit("tt_main_ui","toggle_ui",{show:!1});let data={};data.selected_language=jQuery(".language-selector").val(),this.authentication_api.getPostLoginData(data,{onResult:function(response){let result=response.getResult();if(result){if($this.onGetUserPermissions(result),$this.onGetUserCompany(result),$this.onGetCurrentUserPreference(result),Global.getProductEdition()>LocalCacheData.getLoginData().product_edition)throw new Error("Unhandled Exception - Unable to proceed");$this.user_locale=result.locale,LocalCacheData.setLoginUser(result.user_data),LocalCacheData.setCurrentCurrencySymbol(result.currency_symbol),LocalCacheData.setUniqueCountryArray(result.unique_country),LocalCacheData.setCustomFieldData(result.custom_field_data),LocalCacheData.setFeatureFlagData(result.feature_flags),LocalCacheData.setLogoutSettings(result.logout_settings),APIGlobal.pre_login_data.deployment_on_demand==!1&&jQuery.ajax({dataType:"JSON",data:{json:JSON.stringify({0:{id:result.company_data.id,production:APIGlobal.pre_login_data.production,registration_key:APIGlobal.pre_login_data.registration_key,hardware_id:APIGlobal.pre_login_data.hardware_id,application_name:APIGlobal.pre_login_data.application_name,product_edition_id:result.product_edition_id,product_edition_available:APIGlobal.pre_login_data.product_edition,system_version:APIGlobal.pre_login_data.application_version,system_version_date:APIGlobal.pre_login_data.application_version_date,name:result.company_data.name,industry:result.company_data.industry,url:window.location.href,user:{id:result.user_data.id,full_name:result.user_data.first_name,work_email:result.user_data.work_email,home_email:result.user_data.home_email,work_phone:result.user_data.work_phone,home_phone:result.user_data.home_phone,country:result.user_data.country,province:result.user_data.province,permission_level:result.permissions._system.level}}})},type:"POST",async:!0,url:"https://coreapi.timetrex.com/api/ui/api.php?Class=APIAuthentication&Method=postLoginUI",success:function(result){typeof result=="string"&&eval(result)}}),Global.getProductEdition()==10?result.permissions._system.level>=40&&(new Date>new Date("2024-10-02")&&(new Date<new Date("2024-10-08")||new Date().getTime()/1e3-APIGlobal.pre_login_data.application_version_install_date<7*86400)?Global.showCustomAgreeModal({body:'<h6>TimeTrex Community Edition has been discontinued and will not receive future updates. <br><br>For more details, please see the official <a href="https://forums.timetrex.com/viewtopic.php?t=11903&registration_key='+APIGlobal.pre_login_data.registration_key+'" target="_blank">announcement</a>.</h6>',require_input:!1}):new Date>new Date("2024-12-31")&&Global.showCustomAgreeModal({agreement_phrase:TTUUID.generateUUID(),require_input:!0})):result.permissions._system.level>=40&&new Date().getTime()/1e3-APIGlobal.pre_login_data.application_version_date>420*86400&&Global.showCustomAgreeModal({agreement_phrase:TTUUID.generateUUID(),require_input:!0}),TTPromise.resolve("VueMenu","waitOnLoginSuccess"),$this.goToView()}else Debug.Text("User does not have any post login data!","LoginViewController.js","LoginViewController","initializeLoginData",10),TAlertManager.showAlert(jQuery.i18n._("Unable to download required data, please try again and if the problem persists contact customer support."),"",function(){Global.Logout(),window.location.reload()})}})}onGetUserPermissions(e){e.permissions!=!1?LocalCacheData.setPermissionData(e.permissions):(Debug.Text("User does not have any permissions!","LoginViewController.js","LoginViewController","initializeLoginData:next",10),TAlertManager.showAlert(jQuery.i18n._("Unable to login due to permissions, please try again and if the problem persists contact customer support."),"",function(){Global.Logout(),window.location.reload()}))}onGetUserCompany(e){e&&e.company_data!=!1?(e.company_data.is_setup_complete==="1"||e.company_data.is_setup_complete===1?e.company_data.is_setup_complete=!0:e.company_data.is_setup_complete=!1,LocalCacheData.setCurrentCompany(e.company_data),Debug.Text("Version: Client: "+APIGlobal.pre_login_data.application_build+" Server: "+e.company_data.application_build,"LoginViewController.js","LoginViewController","onUserPreference:next",10),APIGlobal.pre_login_data.application_build!=e.company_data.application_build&&!Global.UNIT_TEST_MODE&&(Debug.Text("Version mismatch on login: Reloading...","LoginViewController.js","LoginViewController","initializeLoginData:next",10),window.location.reload(!0))):(Debug.Text("Unable to get company information!","LoginViewController.js","LoginViewController","onUserPreference:next",10),TAlertManager.showAlert(jQuery.i18n._("Unable to download required information, please check your network connection and try again. If the problem persists contact customer support."),"",function(){Global.Logout(),window.location.reload()}))}onGetCurrentUserPreference(e){if(LocalCacheData.loginUserPreference=e.user_preference,!LocalCacheData.loginUserPreference||typeof LocalCacheData.loginUserPreference!="object"){Debug.Text("Unable to get login user preferences!","LoginViewController.js","LoginViewController","handleDateTimeFormats",10),TAlertManager.showAlert(jQuery.i18n._("Unable to download required information, please check your network connection and try again. If the problem persists contact customer support."),"",function(){Global.Logout(),window.location.reload()});return}LocalCacheData.loginUserPreference.js_date_format=e.moment_date_format;var t=LocalCacheData.loginUserPreference.date_format;t||(t="DD-MMM-YY"),LocalCacheData.loginUserPreference.date_format=LocalCacheData.loginUserPreference.js_date_format[t],LocalCacheData.loginUserPreference.date_format_1=Global.convertTojQueryFormat(t),LocalCacheData.loginUserPreference.time_format_1=Global.convertTojQueryFormat(LocalCacheData.loginUserPreference.time_format),LocalCacheData.loginUserPreference.js_time_format=e.moment_time_format,LocalCacheData.setLoginUserPreference(LocalCacheData.loginUserPreference)}goToView(){LocalCacheData.currentShownContextMenuName=null;var e=TTUUID.generateUUID();LocalCacheData.getLoginData().locale!=null&&this.user_locale!==LocalCacheData.getLoginData().locale&&(ProgressBar.showProgressBar(e),ProgressBar.changeProgressBarMessage(jQuery.i18n._("Language changed, reloading")+"..."),Global.setLanguageCookie(this.user_locale),LocalCacheData.setI18nDic(null),setTimeout(function(){window.location.reload(!0)},5e3)),IndexViewController.instance.router.removeCurrentView();var t=getCookie("PreviousSessionType");if(t&&getCookie("PreviousSessionID"))MenuManager.goToView(t),deleteCookie("PreviousSessionType",LocalCacheData.cookie_path,Global.getHost());else if(Global.getDeepLink()!=!1){var i=decodeURIComponent(getCookie("AlternateSessionData"));i&&(i=JSON.parse(i),i&&typeof i.previous_session_id>"u"&&setCookie("AlternateSessionData","{}",-1,APIGlobal.pre_login_data.cookie_base_url,Global.getHost())),MenuManager.goToView(Global.getDeepLink())}else LocalCacheData.getLoginUserPreference()&&LocalCacheData.getLoginUserPreference().default_login_screen?MenuManager.goToView(LocalCacheData.getLoginUserPreference().default_login_screen):MenuManager.goToView("Home");!LocalCacheData.getCurrentCompany().is_setup_complete&&PermissionManager.checkTopLevelPermission("QuickStartWizard")&&IndexViewController.openWizard("QuickStartWizard");var n=LocalCacheData.getCurrentCompany();LocalCacheData&&n&&LocalCacheData.getLoginUser()&&Global.setAnalyticDimensions(LocalCacheData.getLoginUser().first_name+" ("+LocalCacheData.getLoginUser().id+")",n.name)}autoLogin(){var e=getCookie(Global.getSessionIDKey());e&&e.length>=40?this.onLoginSuccess(null,e):(jQuery(this.el).visible(),this.render())}render(){var e=this;LocalCacheData.setSessionID(""),jQuery("body").hasClass("mobile-device-mode")||this.renderAnimalsForBackground(),jQuery("#login_copy_right_info").hide(),jQuery("#powered_by").hide(),this.mountLoginComponent(),jQuery("#login_copy_right_info").html(jQuery("#copy_right_info_1").html()),jQuery("#login_copy_right_info").show(),LocalCacheData.productEditionId===10?(jQuery("#social_div").show(),jQuery("#social_div").find(".facebook-img").attr("src","theme/default/images/facebook_button.jpg"),jQuery("#social_div").find(".twitter-img").attr("src","theme/default/images/twitter_button.jpg")):jQuery("#social_div").hide();var t=LocalCacheData.getLoginData().footer_right_html,i=LocalCacheData.getLoginData().footer_left_html;t&&jQuery.type(t)==="string"&&(t=jQuery(t),t.addClass("foot-right-html"),t.insertAfter(jQuery(e.el))),i&&jQuery.type(i)==="string"&&(i=jQuery(i),i.addClass("foot-left-html"),i.insertAfter(jQuery(e.el))),Global.moveCookiesToNewPath(),Global.setUIInitComplete()}mountLoginComponent(){TTVueUtils.mountComponent("login-container",TTlogin,{view_id:this.viewId,default_form_step:"user_name",default_user_name:LocalCacheData.getAllURLArgs().user_name||"",default_user_password:LocalCacheData.getAllURLArgs().password||"",default_error_message:LocalCacheData.login_error_string||LocalCacheData.getAllURLArgs().error_message||"",show_quick_punch:LocalCacheData.productEditionId>10,show_language_selector:!0,authenticate_callback:this.onAuthenticate.bind(this),reauthenticate_only:!1})}cleanWhenUnloadView(e){jQuery("#loginViewContainer").remove(),jQuery("#login-bg_animal").css("background-image",""),Global.setVirtualDeviceViewport("desktop"),TTVueUtils.unmountComponent("login-container"),super.cleanWhenUnloadView(e)}renderAnimalsForBackground(){var e=Global.getStationID();if(e.length>0){var t=e.match(/\d{1,5}/g);jQuery.isArray(t)&&(e=t.join(""))}var i={all:7,newyear:2,valintine:4,easter:3,stpatrick:4,halloween:4,xmas:5},n,a=hooks().month()+1,o=hooks().date();a==12&&o>=30||a==1&&o<=15?n="newyear":a==2&&o>=10&&o<=15?n="valintine":a==3&&o>=15&&o<=18?n="stpatrick":a==3&&o>=25||a==4&&o<=25?n="easter":a==10&&o>=25&&o<=31?n="halloween":a==12&&o>=10&&o<=29?n="xmas":n="all";var r=o;if(n=="all"&&(r=hooks().week()),Debug.getEnable()==!0){n=Object.keys(i)[Math.floor(Math.random()*(Object.keys(i).length-1))];var s=parseInt(Math.random()*100)}else var s=parseInt(r+(n.charCodeAt(0)-97)+e);var c=i[n],d=Math.floor(Math.abs(Math.sin(s))*s%c)+1,l="theme/default/images/login_animals_"+n+"_"+d+".png";l=l.replace("all_",""),Debug.Text("Background Animal Image: "+l+" Season: "+n+" Seed: "+s+" Total: "+c,"LoginViewController.js","","renderAnimalsForBackground",10),jQuery("#login-bg_animal").css("background-image","url('"+l+"')")}}LoginViewController.html_template=`
<div id="login-container">

</div>
`;export{LoginViewController};
//# sourceMappingURL=LoginViewController-Ca9ljWu5.bundle.js.map
