import{_ as b,j as r}from"./vendor-tTApdY0Y.bundle.js";class C extends BaseWizardController{constructor(a={}){b.defaults(a,{el:".wizard-bg",selected_province_index:-1,selected_country_index:-1}),super(a)}init(a){this.title=r.i18n._("Quick Start Wizard"),this.steps=5,this.current_step=1,this.render()}render(){super.render(),this.initCurrentStep()}buildCurrentStepUI(){var a=this;switch(this.content_div.empty(),this.stepsWidgetDic[this.current_step]={},this.current_step){case 1:var p=this.getLabel();p.text(r.i18n._("Welcome to")+" "+LocalCacheData.getApplicationName()+", "+r.i18n._("this Quick Start Wizard will walk you through the initial setup by asking you a few basic questions about your company."));var v=r('<div><span class="clear-both-div">'+r.i18n._("Press")+'<button style="display: inline" class="forward-btn"></button> '+r.i18n._("below to continue")+"</span></div>");this.content_div.append(p),this.content_div.append(v);break;case 2:Global.setWidgetEnabled(this.next_btn,!1);var p=this.getLabel();p.text(r.i18n._("Please choose the preferred settings that you would like to use to display information throughout")+" "+LocalCacheData.getApplicationName()+"."),this.content_div.append(p);var e=r(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html")),t=e.find(".form-item-label"),i=e.find(".form-item-input-div"),s=this.getComboBox("time_zone",!0);t.text(r.i18n._("Timezone")),i.append(s),this.content_div.append(e),e=r(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html")),t=e.find(".form-item-label"),i=e.find(".form-item-input-div");var d=this.getComboBox("date_format",!0);t.text(r.i18n._("Date Format")),i.append(d),this.content_div.append(e),e=r(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html")),t=e.find(".form-item-label"),i=e.find(".form-item-input-div");var c=this.getComboBox("time_format",!0);t.text(r.i18n._("Time Format")),i.append(c),this.content_div.append(e),e=r(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html")),t=e.find(".form-item-label"),i=e.find(".form-item-input-div");var l=this.getComboBox("start_week_day",!0);t.text(r.i18n._("Calendar Starts On")),i.append(l),this.content_div.append(e),this.stepsWidgetDic[this.current_step][s.getField()]=s,this.stepsWidgetDic[this.current_step][d.getField()]=d,this.stepsWidgetDic[this.current_step][c.getField()]=c,this.stepsWidgetDic[this.current_step][l.getField()]=l;break;case 3:var p=this.getLabel();p.text(r.i18n._("Pay period schedules are critical to the operation of")+" "+LocalCacheData.getApplicationName()+" "+r.i18n._("regardless if you use it for processing payroll or not. Please select the pay period frequency and enter the start date, end date and transaction date (date the employees are paid) for your next four pay periods. Based on this information")+" "+LocalCacheData.getApplicationName()+" "+r.i18n._("will automatically create subsequent pay periods for you.")),this.content_div.append(p),e=r(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html")),t=e.find(".form-item-label"),i=e.find(".form-item-input-div");var u=this.getComboBox("type_id",!1);t.text(r.i18n._("Pay Period Frequency")),i.append(u),u.bind("formItemChange",function(w,y){a.onFrequencyChange(y)}),this.content_div.append(e),this.stepsWidgetDic[this.current_step][u.getField()]=u;var h="example_dates",o=r("<div style='float: left; width: 100%'  class='grid-div wizard-grid-div'> <table id='"+h+"'></table></div>");this.setDateGrid(h,o,300);break;case 4:var p=this.getLabel();p.text(r.i18n._("To help determine how")+" "+LocalCacheData.getApplicationName()+" "+r.i18n._("should be initially setup, please select one or more locations that your employees reside within.")),this.content_div.append(p);var v=r('<div><span class="clear-both-div">'+r.i18n._("Click")+' <button style="display: inline" class="plus-icon"></button> '+r.i18n._("icon to add additional locations")+"</span></div>");this.content_div.append(v);var n=r('<br><div><span class="clear-both-div">'+r.i18n._("Legal Entity")+"</span></div>");this.content_div.append(n);var g=Global.loadWidgetByName(FormItemType.AWESOME_BOX);g.TText({field:"legal_entity_id"}),g.AComboBox({api_class:TTAPI.APILegalEntity,allow_multiple_selection:!0,layout_name:"global_legal_entity",show_search_inputs:!1,set_empty:!0,custom_first_label:Global.all_item}),this.content_div.append(g),this.stepsWidgetDic[this.current_step].legal_entity_id=g;var _={country:r.i18n._("Country"),province:r.i18n._("Province/State")},f=Global.loadWidgetByName(FormItemType.INSIDE_EDITOR);f.InsideEditor({title:"",addRow:this.insideEditorAddRow,removeRow:this.insideEditorRemoveRow,getValue:this.insideEditorGetValue,setValue:this.insideEditorSetValue,parent_controller:this,render:"views/wizard/quick_start/QuickStartInsideEditorRender.html",render_args:_,row_render:"views/wizard/quick_start/QuickStartInsideEditorRow.html"}),f.addClass("wizard-inside-editor"),this.content_div.append(f),this.stepsWidgetDic[this.current_step].country=f;break;case 5:var p=this.getLabel();p.text(LocalCacheData.getApplicationName()+" "+r.i18n._("is now setup and ready for you to start adding employees and tracking their attendance.")),this.content_div.append(p);var v=r('<div><span class="clear-both-div">'+r.i18n._("Click the")+' <button style="display: inline" class="done-btn"></button> '+r.i18n._("icon below to begin doing that now")+"</span></div>");this.content_div.append(v);break}}initInsideEditorData(){var a=this.stepsDataDic[this.current_step],e=this.stepsWidgetDic[this.current_step],t=e.country;a?t.setValue(a.country):(t.removeAllRows(),t.addRow())}insideEditorSetValue(a){var e=a.length;if(this.removeAllRows(),e>0){for(var t=0;t<a.length;t++)if(Global.isSet(a[t])){var i=a[t];this.addRow(i)}}else this.addRow()}insideEditorRemoveRow(a){var e=a[0].rowIndex-1;a.remove(),this.rows_widgets_array.splice(e,1),this.removeLastRowLine()}insideEditorAddRow(a,e){var t=this;a||(a={country:LocalCacheData.getCurrentCompany().country,province:LocalCacheData.getCurrentCompany().province});var i=this.getRowRender(),s=this.getRender(),d={},c=r("<ul style='list-style: none; padding: 0; margin: 0;'></ul>"),l=r("<li class='widget-h-box' style='float: left; margin-right: 10px'></li>"),u=Global.loadWidgetByName(FormItemType.COMBO_BOX);u.TComboBox({field:"country",set_empty:!0,set_select_item_when_set_source_data:!0});var h=TTAPI.APICompany;h.getOptions("country",{onResult:function(n){var g=n.getResult();u.setSourceData(Global.buildRecordArray(g)),t.parent_controller.selected_country_index!=-1?u.setSelectedIndex(t.parent_controller.selected_country_index):(u.setValue(a.country),t.parent_controller.selected_country_index=u.getSelectedIndex()),a.country!=u.getValue()&&(a.country=u.getValue()),d[u.getField()]=u,u.bind("formItemChange",function(f,p){t.parent_controller.selected_country_index=u.getSelectedIndex(),TTPromise.add("QuickStartWizard","setProvince"),t.parent_controller.setProvince({country:p.getValue(),province:""},_),TTPromise.wait("QuickStartWizard","setProvince",function(){t.parent_controller.selected_province_index=_.getSelectedIndex()})}),l.append(u),c.append(l),i.children().eq(0).append(c),c=r("<ul style='list-style: none; padding: 0; margin: 0;'></ul>"),l=r("<li class='widget-h-box' style='float: left; margin-right: 10px'></li>");var _=Global.loadWidgetByName(FormItemType.COMBO_BOX);_.TComboBox({field:"province",set_empty:!1}),TTPromise.add("QuickStartWizard","setProvince"),t.parent_controller.setProvince(a,_),TTPromise.wait("QuickStartWizard","setProvince",function(){o(_)}),_.bind("formItemChange",function(){t.parent_controller.selected_province_index=_.getSelectedIndex()}),d[_.getField()]=_,l.append(_),c.append(l),i.children().eq(1).append(c),typeof e<"u"?(i.insertAfter(r(s).find("tr").eq(e)),t.rows_widgets_array.splice(e,0,d)):(r(s).append(i),t.rows_widgets_array.push(d)),d.current_edit_item=a,t.addIconsEvent(i),t.removeLastRowLine(),t.removeLastRowLine()}});function o(n){typeof e>"u"?t.parent_controller.selected_province_index=n.getSelectedIndex():(t.parent_controller.selected_province_index++,n.setSelectedIndex(t.parent_controller.selected_province_index))}}setProvince(a,e){if(!a.country){e.setSourceData([]),e.setValue(0),TTPromise.reject("QuickStart","setProvince");return}var t=TTAPI.APICompany;t.getOptions("province",a.country,{onResult:function(i){i=i.getResult(),e.setSourceData(Global.buildRecordArray(i)),e.setValue(a.province),TTPromise.resolve("QuickStartWizard","setProvince")}})}onFrequencyChange(a){var e=this.stepsWidgetDic[this.current_step],t=e.example_dates,i=t.getData(),s;i&&i[0]&&(s=i[0].start_date),s&&this.setDefaultDates(!0)}setDateGrid(a,e,t){var i=this;this.content_div.append(e),t||(t=370),this.getGridColumns(a,function(s){i.stepsWidgetDic[i.current_step][a]=new TTGrid(a,{sortable:!1,height:t,editurl:"QuickStart",multiselect:!1,onSelectRow:function(d){}},s),i.setGridSize(i.stepsWidgetDic[i.current_step][a]),i.setGridGroupColumns(a)})}onTextInputRender(a,e,t){var i=e.colModel,s=e.rowId,d=r('<div custom_cell="true" render_type="date_picker" id="'+s+"_"+i.name+'" class="t-date-picker-div"><input class="t-date-picker" type="text" value="'+a+'"></input><img id="tDatePickerIcon" class="t-date-picker-icon"></img>');return d.get(0).outerHTML}onCloseClick(){var a=this;LocalCacheData.getCurrentCompany().is_setup_complete?(r(a.el).remove(),LocalCacheData.current_open_wizard_controllers=LocalCacheData.current_open_wizard_controllers.filter(e=>e.wizard_id!==this.wizard_id)):TAlertManager.showConfirmAlert(r.i18n._("Would you like to be reminded to complete the Quick Start Wizard next time you login?"),"",function(e){if(!e){var t={};t.id=LocalCacheData.getCurrentCompany().id,t.is_setup_complete=!0;var i=TTAPI.APICompany;LocalCacheData.getCurrentCompany().is_setup_complete=!0,i.setCompany(t,{onResult:function(){}})}r(a.el).remove(),LocalCacheData.current_open_wizard_controllers=LocalCacheData.current_open_wizard_controllers.filter(s=>s.wizard_id!==a.wizard_id)})}onStep3DatePickerChange(a){for(var e=this,t=this.stepsWidgetDic[this.current_step],i=t.example_dates,s=a.attr("id"),d=s.split("_")[0],c=s.substring(s.indexOf("_")+1,s.length),l=i.getData(),u=a.getValue(),h=l[0].start_date,o=l.length,n=0;n<o;n++){var g=l[n];if(g.id==d){g[c]=u,n===0&&c==="start_date"&&(h&&h!==u?e.setDefaultDates(!0):h||e.setDefaultDates());break}}}setDefaultDates(a){var e=this;a?TAlertManager.showConfirmAlert(r.i18n._("Would you like to pre-populate all date fields based on the first start date"),"",function(i){i&&t()}):t();function t(){var i=e.stepsWidgetDic[3].type_id.getValue(),s=e.stepsWidgetDic[3].example_dates,d=s.getData(),c=d[0].start_date,l=TTAPI.APIPayPeriodSchedule;l.detectPayPeriodScheduleDates(i,c,{onResult:function(u){var h=u.getResult();s.setData(h),e.setStep3CellDatePickers(s)}})}}getGridColumns(a,e){var t=[],i=this;switch(a){case"example_dates":var s={name:"start_date",index:"start_date",label:r.i18n._("Start Date"),width:100,sortable:!1,title:!1,formatter:function(d,c,l){return i.onTextInputRender(d,c,l)}};t.push(s),s={name:"end_date",index:"end_date",label:r.i18n._("End Date"),width:100,sortable:!1,title:!1,formatter:function(d,c,l){return i.onTextInputRender(d,c,l)}},t.push(s),s={name:"transaction_date",index:"transaction_date",label:r.i18n._("Transaction Date"),width:100,sortable:!1,title:!1,formatter:function(d,c,l){return i.onTextInputRender(d,c,l)}},t.push(s);break}e(t)}buildCurrentStepData(){var a=this,e=this.stepsDataDic[this.current_step],t=this.stepsWidgetDic[this.current_step],i=0;switch(this.current_step){case 2:Global.setWidgetEnabled(this.next_btn,!1),Global.setWidgetEnabled(this.back_btn,!1);var s=TTAPI.APIUserPreference,d=TTAPI.APIAuthentication;s.getOptions("time_zone",{onResult:function(o){if(t.time_zone.setSourceData(Global.buildRecordArray(o.getResult())),e)for(var n in e)e.hasOwnProperty(n)&&t[n].setValue(e[n]);l()}}),s.getOptions("time_format",{onResult:function(o){if(t.time_format.setSourceData(Global.buildRecordArray(o.getResult())),e)for(var n in e)e.hasOwnProperty(n)&&t[n].setValue(e[n]);l()}}),s.getOptions("start_week_day",{onResult:function(o){if(t.start_week_day.setSourceData(Global.buildRecordArray(o.getResult())),e)for(var n in e)e.hasOwnProperty(n)&&t[n].setValue(e[n]);l()}}),d.getCurrentUserPreference({onResult:function(o){var n=o.getResult();u(n)}});break;case 3:var c=TTAPI.APIPayPeriodSchedule;c.getOptions("type",{onResult:function(o){var n=Global.buildRecordArray(o.getResult());if(n.splice(0,1),t.type_id.setSourceData(n),e){var g=e.example_dates,_=t.example_dates;_.setData(g),a.setStep3CellDatePickers(_),t.type_id.setValue(e.type_id)}else h()}});break;case 4:a.initInsideEditorData();break}function l(){i=i+1,i===4&&(Global.setWidgetEnabled(a.next_btn,!0),Global.setWidgetEnabled(a.back_btn,!0))}function u(o){var n=t.time_zone,g=t.date_format,_=t.time_format,f=t.start_week_day;o.language==="en"?s.getOptions("date_format",{onResult:function(p){if(t.date_format.setSourceData(Global.buildRecordArray(p.getResult())),e)for(var v in e)e.hasOwnProperty(v)&&t[v].setValue(e[v]);else n.setValue(o.time_zone),g.setValue(o.date_format),_.setValue(o.time_format),f.setValue(o.start_week_day)}}):s.getOptions("other_date_format",{onResult:function(p){if(t.date_format.setSourceData(Global.buildRecordArray(p.getResult())),e)for(var v in e)e.hasOwnProperty(v)&&t[v].setValue(e[v]);else n.setValue(o.time_zone),g.setValue(o.date_format),_.setValue(o.time_format),f.setValue(o.start_week_day)}}),l()}function h(){var o=[{start_date:"",end_date:"",transaction_date:""},{start_date:"",end_date:"",transaction_date:""},{start_date:"",end_date:"",transaction_date:""},{start_date:"",end_date:"",transaction_date:""}],n=t.example_dates;n.setData(o),a.setStep3CellDatePickers(n)}}setStep3CellDatePickers(a){for(var e=a.grid.find('div[custom_cell="true"]'),t=this,i=0;i<e.length;i++){var s=r(e[i]).TDatePicker({width:290});s.bind("formItemChange",function(d,c){t.onStep3DatePickerChange(c)})}}onDoneClick(){var a=this;super.onDoneClick(),r(a.el).remove(),LocalCacheData.current_open_wizard_controllers=LocalCacheData.current_open_wizard_controllers.filter(e=>e.wizard_id!==this.wizard_id),IndexViewController.goToView("Employee")}insideEditorGetValue(){for(var a=this.rows_widgets_array.length,e=[],t=0;t<a;t++){var i=this.rows_widgets_array[t],s={country:i.country.getValue(),province:i.province.getValue()};e.push(s)}return e}onNextClick(){var a=this;this.saveCurrentStep("forward",function(e){Global.setWidgetEnabled(a.next_btn,!0),Global.setWidgetEnabled(a.back_btn,!0),e&&(a.current_step=a.current_step+1,a.initCurrentStep())})}onBackClick(){var a=this;this.saveCurrentStep("back",function(e){Global.setWidgetEnabled(a.next_btn,!0),Global.setWidgetEnabled(a.back_btn,!0),e&&(a.current_step=a.current_step-1,a.initCurrentStep())})}saveCurrentStep(a,e){this.stepsDataDic[this.current_step]={};var t=this.stepsDataDic[this.current_step],i=this.stepsWidgetDic[this.current_step];switch(this.current_step){case 1:e(!0);break;case 2:if(Global.setWidgetEnabled(this.next_btn,!1),Global.setWidgetEnabled(this.back_btn,!1),t.time_zone=i.time_zone.getValue(),t.time_format=i.time_format.getValue(),t.date_format=i.date_format.getValue(),t.start_week_day=i.start_week_day.getValue(),a==="forward"){var s=TTAPI.APIAuthentication,d=TTAPI.APIUserPreference;s.getCurrentUserPreference({onResult:function(o){var n=o.getResult();n&&(n.date_format=t.date_format,n.time_format=t.time_format,n.time_zone=t.time_zone,n.start_week_day=t.start_week_day,d.setUserPreference(n,{onResult:function(){Global.updateUserPreference(function(){e(!0)})}}))}})}else e(!0);break;case 3:if(Global.setWidgetEnabled(this.next_btn,!1),Global.setWidgetEnabled(this.back_btn,!1),t.type_id=i.type_id.getValue(),t.example_dates=b.clone(i.example_dates.getGridParam("data")),a==="forward"){var c=TTAPI.APIPayPeriodSchedule;c.detectPayPeriodScheduleSettings(t.type_id,t.example_dates,{onResult:function(o){o=o.getResult(),o.hasOwnProperty("company_id")?c.setPayPeriodSchedule(o,{onResult:function(n){n.isValid()?e(!0):(TAlertManager.showErrorAlert(n),e(!1))}}):e(!0)}})}else e(!0);break;case 4:Global.setWidgetEnabled(this.next_btn,!1),Global.setWidgetEnabled(this.back_btn,!1),t.country=i.country.getValue(),t.legal_entity_id=null;var l=i.legal_entity_id.getValue(!0);if(l&&l.length>0){t.legal_entity_id=[];for(var u in l)t.legal_entity_id.push(l[u].id)}if(a==="forward"){var h=TTAPI.APISetupPresets;h.createPresets(t.country,t.legal_entity_id,{onResult:function(o){o.isValid?e(!0):(TAlertManager.showErrorAlert(o),e(!1))}})}else e(!0);break;case 5:e(!0);break}}}export{C as QuickStartWizardController};
//# sourceMappingURL=QuickStartWizardController-_UDgidPG.bundle.js.map
