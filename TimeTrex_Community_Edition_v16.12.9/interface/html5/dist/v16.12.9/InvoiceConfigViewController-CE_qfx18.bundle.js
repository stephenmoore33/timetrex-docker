import{_ as s,j as o}from"./vendor-tTApdY0Y.bundle.js";import"./TImage-D3G3HRb1.bundle.js";import"./TImageAdvBrowser-CQSTdPda.bundle.js";class h extends BaseViewController{constructor(i={}){s.defaults(i,{}),super(i)}init(i){this.edit_view_tpl="InvoiceConfigEditView.html",this.permission_id="invoice_config",this.viewId="InvoiceConfig",this.script_name="InvoiceConfigView",this.context_menu_name=o.i18n._("Preferences"),this.api=TTAPI.APIInvoiceConfig,this.render(),this.initData()}render(){super.render()}initOptions(i){i()}getCustomContextMenuModel(){var i={exclude:["default"],include:["save","cancel"]};return i}getInvoiceConfigData(i){var n=this;n.api["get"+n.api.key_name]({onResult:function(a){var t=a.getResult();Global.isArray(t)&&Global.isSet(t[0])?i(t[0]):n.api.getInvoiceConfigDefaultData({onResult:function(e){t=e.getResult(),i(t)}})}})}setCurrentEditRecordData(){for(var i in this.current_edit_record){var n=this.edit_view_ui_dic[i];if(Global.isSet(n))switch(i){default:n.setValue(this.current_edit_record[i]);break}}this.file_browser.setImage(ServiceCaller.getURLByObjectType("invoice_config")),this.collectUIDataToCurrentEditRecord(),this.setEditViewDataDone()}openEditView(){var i=this;i.edit_only_mode&&i.initOptions(function(){i.getInvoiceConfigData(function(n){i.buildContextMenu(),TTPromise.add("InvoiceConfig","openEditView"),i.edit_view||i.initEditViewUI(i.viewId,i.edit_view_tpl),i.current_edit_record=n,TTPromise.wait("InvoiceConfig","openEditView",function(){i.initEditView()})})})}onFormItemChange(i,n){this.setIsChanged(i),this.setMassEditingFieldsWhenFormChange(i);var a=i.getField(),t=i.getValue();this.current_edit_record[a]=t,n||this.validate()}setErrorMenu(){for(var i=ContextMenuManager.getMenuModelByMenuId(this.determineContextMenuMountAttributes().id),n=i.length,a=0;a<n;a++){let t=i[a],e=i[a].id;switch(ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,t.id,!0),e){case"cancel":break;default:ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,t.id,!1);break}}}buildEditViewUI(){var i=this;super.buildEditViewUI();var n={tab_invoice_settings:{label:o.i18n._("Invoice Settings")}};this.setTabModel(n);var a=this.edit_view_tab.find("#tab_invoice_settings"),t=a.find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(t);var e;typeof FormData>"u"?(e=Global.loadWidgetByName(FormItemType.IMAGE_BROWSER),this.file_browser=e.TImageBrowser({field:"",default_width:128,default_height:128}),this.file_browser.bind("imageChange",function(l,d){new ServiceCaller().uploadFile(d.getValue(),"object_type=invoice_config",{onResult:function(r){r.toLowerCase()==="true"?i.file_browser.setImage(ServiceCaller.getURLByObjectType("invoice_config")):TAlertManager.showAlert(r,"Error")}})})):(e=Global.loadWidgetByName(FormItemType.IMAGE_AVD_BROWSER),this.file_browser=e.TImageAdvBrowser({field:"",default_width:128,default_height:128,callBack:function(l){new ServiceCaller().uploadFile(l,"object_type=invoice_config",{onResult:function(d){d.toLowerCase()==="true"?i.file_browser.setImage(ServiceCaller.getURLByObjectType("invoice_config")):TAlertManager.showAlert(d,"Error")}})}})),this.addEditFieldToColumn(o.i18n._("Logo"),e,t,"",null,!1,!0),e=Global.loadWidgetByName(FormItemType.SEPARATED_BOX),e.SeparatedBox({label:o.i18n._("Display on Invoice")}),this.addEditFieldToColumn(null,e,t),e=Global.loadWidgetByName(FormItemType.CHECKBOX),e.TCheckbox({field:"display_company_address"}),this.addEditFieldToColumn(o.i18n._("Company Address"),e,t),e=Global.loadWidgetByName(FormItemType.CHECKBOX),e.TCheckbox({field:"display_company_work_phone"}),this.addEditFieldToColumn(o.i18n._("Phone"),e,t),e=Global.loadWidgetByName(FormItemType.CHECKBOX),e.TCheckbox({field:"display_company_fax_phone"}),this.addEditFieldToColumn(o.i18n._("Fax"),e,t),e=Global.loadWidgetByName(FormItemType.CHECKBOX),e.TCheckbox({field:"display_part_number"}),this.addEditFieldToColumn(o.i18n._("Part Numbers"),e,t),e=Global.loadWidgetByName(FormItemType.CHECKBOX),e.TCheckbox({field:"display_payment"}),this.addEditFieldToColumn(o.i18n._("Payment Information"),e,t),e=Global.loadWidgetByName(FormItemType.CHECKBOX),e.TCheckbox({field:"display_payment_signature"}),this.addEditFieldToColumn(o.i18n._("Payment Signature"),e,t),e=Global.loadWidgetByName(FormItemType.TEXT_AREA),e.TTextArea({field:"note",width:"100%"}),this.addEditFieldToColumn(o.i18n._("Note"),e,t,"",null,null,!0),e.parent().width("45%"),e=Global.loadWidgetByName(FormItemType.SEPARATED_BOX),e.SeparatedBox({label:o.i18n._("Invoice Email")}),this.addEditFieldToColumn(null,e,t),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"email_from"}),this.addEditFieldToColumn(o.i18n._("From Address"),e,t),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"email_bcc"}),this.addEditFieldToColumn(o.i18n._("Bcc Address"),e,t),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"email_subject"}),this.addEditFieldToColumn(o.i18n._("Subject"),e,t),e=Global.loadWidgetByName(FormItemType.TEXT_AREA),e.TTextArea({field:"email_body",width:400,height:300}),this.addEditFieldToColumn(o.i18n._("Body"),e,t,"",null,null,!0),TTPromise.resolve("InvoiceConfig","openEditView")}}export{h as InvoiceConfigViewController};
//# sourceMappingURL=InvoiceConfigViewController-CE_qfx18.bundle.js.map
