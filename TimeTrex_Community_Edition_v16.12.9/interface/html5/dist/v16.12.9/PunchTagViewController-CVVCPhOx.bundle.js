import{_ as m,j as t}from"./vendor-tTApdY0Y.bundle.js";class y extends BaseViewController{constructor(i={}){m.defaults(i,{el:"#punch_tag_view_container",status_array:null,punch_tag_group_array:null,punch_tag_group_api:null,user_group_api:null,job_group_array:null,job_group_api:null,job_item_group_api:null,job_detail_report_api:null,user_group_selection_type_id_array:null,punch_job_item_group_selection_type_id_array:null,punch_job_item_selection_type_id_array:null,user_title_selection_type_id_array:null,user_group_array:null}),super(i)}init(i){this.edit_view_tpl="PunchTagEditView.html",this.permission_id="job",this.viewId="PunchTag",this.script_name="PunchTagView",this.table_name_key="punch_tag",this.context_menu_name=t.i18n._("Punch Tag"),this.navigation_label=t.i18n._("Punch Tag"),this.primary_tab_label=t.i18n._("Punch Tag"),this.primary_tab_key="tab_punch_tag",this.api=TTAPI.APIPunchTag,this.punch_tag_group_api=TTAPI.APIPunchTagGroup,this.user_group_api=TTAPI.APIUserGroup,this.job_item_group_api=TTAPI.APIJobItemGroup,this.job_group_api=TTAPI.APIJobGroup,this.render(),this.buildContextMenu(),this.initData()}initOptions(){var i=this,n=[{option_name:"status",api:this.api},{option_name:"user_group_selection_type_id",api:this.api},{option_name:"punch_branch_selection_type_id",api:this.api},{option_name:"punch_department_selection_type_id",api:this.api},{option_name:"punch_job_group_selection_type_id",api:this.api},{option_name:"punch_job_selection_type_id",api:this.api},{option_name:"punch_job_item_group_selection_type_id",api:this.api},{option_name:"punch_job_item_selection_type_id",api:this.api},{option_name:"user_title_selection_type_id",api:this.api}];this.initDropDownOptions(n),this.punch_tag_group_api.getPunchTagGroup("",!1,!1,{onResult:function(o){o=o.getResult(),o=Global.buildTreeRecord(o),!i.sub_view_mode&&i.basic_search_field_ui_dic.group_id&&(i.basic_search_field_ui_dic.group_id.setSourceData(o),i.adv_search_field_ui_dic.group_id.setSourceData(o)),i.punch_tag_group_array=o}}),this.user_group_api.getUserGroup("",!1,!1,{onResult:function(o){o=o.getResult(),o=Global.buildTreeRecord(o),i.user_group_array=o}}),this.job_group_api.getJobGroup("",!1,!1,{onResult:function(o){o=o.getResult(),o=Global.buildTreeRecord(o),i.job_group_array=o}}),this.job_item_group_api.getJobItemGroup("",!1,!1,{onResult:function(o){o=o.getResult(),o=Global.buildTreeRecord(o),i.job_item_group_array=o}})}getCustomContextMenuModel(){var i={exclude:[],include:[]};return i}removeEditView(){super.removeEditView(),this.sub_job_item_amendment_view_controller=null}buildEditViewUI(){super.buildEditViewUI();var i=this,n={tab_punch_tag:{label:t.i18n._("Punch Tag")},tab_employee_criteria:{label:t.i18n._("Employee Criteria")},tab_punch_criteria:{label:t.i18n._("Punch Criteria")},tab_audit:!0};this.setTabModel(n),this.navigation.AComboBox({api_class:TTAPI.APIPunchTag,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_punch_tag",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var o=this.edit_view_tab.find("#tab_punch_tag"),s=o.find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(s);var e;e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"status_id"}),e.setSourceData(i.status_array),this.addEditFieldToColumn(t.i18n._("Status"),e,s,""),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn(t.i18n._("Name"),e,s),e.parent().width("45%"),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"description",width:"100%"}),this.addEditFieldToColumn(t.i18n._("Description"),e,s),e.parent().width("45%"),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"manual_id",width:65}),this.addEditFieldToColumn(t.i18n._("Code"),e,s),e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({tree_mode:!0,allow_multiple_selection:!1,layout_name:"global_tree_column",set_empty:!0,field:"group_id"}),e.setSourceData(i.punch_tag_group_array),this.addEditFieldToColumn(t.i18n._("Group"),e,s),e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIGEOFence,allow_multiple_selection:!0,layout_name:"global_geo_fence",show_search_inputs:!0,set_empty:!0,field:"geo_fence_ids"}),this.addEditFieldToColumn(t.i18n._("Allowed GEO Fences"),e,s);var d=this.edit_view_tab.find("#tab_employee_criteria"),p=d.find(".first-column");this.edit_view_tabs[1]=[],this.edit_view_tabs[1].push(p);var _=t("<div class='v-box'></div>");e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"user_group_selection_type_id"}),e.setSourceData(i.user_group_selection_type_id_array);var a=this.putInputToInsideFormItem(e,t.i18n._("Selection Type"));_.append(a),_.append("<div class='clear-both-div'></div>");var l=Global.loadWidgetByName(FormItemType.AWESOME_BOX);l.AComboBox({tree_mode:!0,allow_multiple_selection:!0,layout_name:"global_tree_column",set_empty:!0,field:"user_group_ids"}),l.setSourceData(i.user_group_array),a=this.putInputToInsideFormItem(l,t.i18n._("Selection")),_.append(a),this.addEditFieldToColumn(t.i18n._("Employee Groups"),[e,l],p,"",_,!1,!0),_=t("<div class='v-box'></div>"),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"user_title_selection_type_id",set_empty:!1}),e.setSourceData(i.user_title_selection_type_id_array),a=this.putInputToInsideFormItem(e,t.i18n._("Selection Type")),_.append(a),_.append("<div class='clear-both-div'></div>"),l=Global.loadWidgetByName(FormItemType.AWESOME_BOX),l.AComboBox({api_class:TTAPI.UserTitle,allow_multiple_selection:!0,layout_name:"global_user_title",show_search_inputs:!0,set_empty:!0,field:"user_title_ids"}),a=this.putInputToInsideFormItem(l,t.i18n._("Selection")),_.append(a),this.addEditFieldToColumn(t.i18n._("Employee Titles"),[e,l],p,"",_,!1,!0),e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIUser,allow_multiple_selection:!0,layout_name:"global_user",show_search_inputs:!0,set_empty:!0,field:"include_user_ids"}),this.addEditFieldToColumn(t.i18n._("Include Employees"),e,p),e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIUser,allow_multiple_selection:!0,layout_name:"global_user",show_search_inputs:!0,set_empty:!0,field:"exclude_user_ids"}),this.addEditFieldToColumn(t.i18n._("Exclude Employees"),e,p,"");var c=this.edit_view_tab.find("#tab_punch_criteria"),r=c.find(".first-column");this.edit_view_tabs[2]=[],this.edit_view_tabs[2].push(r);var _=t("<div class='v-box'></div>");e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"punch_branch_selection_type_id",set_empty:!1}),e.setSourceData(i.punch_branch_selection_type_id_array),a=this.putInputToInsideFormItem(e,t.i18n._("Selection Type")),_.append(a),_.append("<div class='clear-both-div'></div>");var l=Global.loadWidgetByName(FormItemType.AWESOME_BOX);l.AComboBox({api_class:TTAPI.APIBranch,allow_multiple_selection:!0,layout_name:"global_branch",show_search_inputs:!0,set_empty:!0,field:"punch_branch"});var a=this.putInputToInsideFormItem(l,t.i18n._("Selection"));_.append(a);var u=Global.loadWidgetByName(FormItemType.CHECKBOX);u.TCheckbox({field:"punch_exclude_default_branch"}),a=this.putInputToInsideFormItem(u,t.i18n._("Exclude Default")),_.append(a),this.addEditFieldToColumn(t.i18n._("Branches"),[e,l,u],r,"",_,!1,!0),_=t("<div class='v-box'></div>"),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"punch_department_selection_type_id",set_empty:!1}),e.setSourceData(i.punch_department_selection_type_id_array),a=this.putInputToInsideFormItem(e,t.i18n._("Selection Type")),_.append(a),_.append("<div class='clear-both-div'></div>"),l=Global.loadWidgetByName(FormItemType.AWESOME_BOX),l.AComboBox({api_class:TTAPI.APIDepartment,allow_multiple_selection:!0,layout_name:"global_department",show_search_inputs:!0,set_empty:!0,field:"punch_department"}),a=this.putInputToInsideFormItem(l,t.i18n._("Selection")),_.append(a),u=Global.loadWidgetByName(FormItemType.CHECKBOX),u.TCheckbox({field:"punch_exclude_default_department"}),a=this.putInputToInsideFormItem(u,t.i18n._("Exclude Default")),_.append(a),this.addEditFieldToColumn(t.i18n._("Departments"),[e,l,u],r,"",_,!1,!0),_=t("<div class='v-box'></div>"),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"punch_job_group_selection_type_id",set_empty:!1}),e.setSourceData(i.punch_job_group_selection_type_id_array),a=this.putInputToInsideFormItem(e,t.i18n._("Selection Type")),_.append(a),_.append("<div class='clear-both-div'></div>"),l=Global.loadWidgetByName(FormItemType.AWESOME_BOX),l.AComboBox({tree_mode:!0,allow_multiple_selection:!0,layout_name:"global_tree_column",set_empty:!0,field:"punch_job_group"}),l.setSourceData(i.job_group_array),a=this.putInputToInsideFormItem(l,t.i18n._("Selection")),_.append(a),this.addEditFieldToColumn(t.i18n._("Job Groups"),[e,l],r,"",_,!1,!0),_=t("<div class='v-box'></div>"),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"punch_job_selection_type_id",set_empty:!1}),e.setSourceData(i.punch_job_selection_type_id_array),a=this.putInputToInsideFormItem(e,t.i18n._("Selection Type")),_.append(a),_.append("<div class='clear-both-div'></div>"),l=Global.loadWidgetByName(FormItemType.AWESOME_BOX),l.AComboBox({api_class:TTAPI.APIJob,allow_multiple_selection:!0,layout_name:"global_job",show_search_inputs:!0,set_empty:!0,field:"punch_job"}),a=this.putInputToInsideFormItem(l,t.i18n._("Selection")),_.append(a),this.addEditFieldToColumn(t.i18n._("Jobs"),[e,l],r,"",_,!1,!0),_=t("<div class='v-box'></div>"),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"punch_job_item_group_selection_type_id",set_empty:!1}),e.setSourceData(i.punch_job_item_group_selection_type_id_array),a=this.putInputToInsideFormItem(e,t.i18n._("Selection Type")),_.append(a),_.append("<div class='clear-both-div'></div>"),l=Global.loadWidgetByName(FormItemType.AWESOME_BOX),l.AComboBox({tree_mode:!0,allow_multiple_selection:!0,layout_name:"global_tree_column",set_empty:!0,field:"punch_job_item_group"}),l.setSourceData(i.job_item_group_array),a=this.putInputToInsideFormItem(l,t.i18n._("Selection")),_.append(a),this.addEditFieldToColumn(t.i18n._("Task Groups"),[e,l],r,"",_,!1,!0),_=t("<div class='v-box'></div>"),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"punch_job_item_selection_type_id",set_empty:!1}),e.setSourceData(i.punch_job_item_selection_type_id_array),a=this.putInputToInsideFormItem(e,t.i18n._("Selection Type")),_.append(a),_.append("<div class='clear-both-div'></div>"),l=Global.loadWidgetByName(FormItemType.AWESOME_BOX),l.AComboBox({api_class:TTAPI.APIJobItem,allow_multiple_selection:!0,layout_name:"global_job_item",show_search_inputs:!0,set_empty:!0,field:"punch_job_item"}),a=this.putInputToInsideFormItem(l,t.i18n._("Selection")),_.append(a),this.addEditFieldToColumn(t.i18n._("Tasks"),[e,l],r,"",_,!1,!0)}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:t.i18n._("Code"),in_column:1,field:"manual_id",multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:t.i18n._("Name"),in_column:1,field:"name",multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:t.i18n._("Description"),in_column:1,field:"description",multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:t.i18n._("Group"),in_column:2,multiple:!0,field:"group_id",layout_name:"global_tree_column",tree_mode:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:t.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:t.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX})]}checkTabPermissions(i){var n=!1;switch(i){case"tab_task_amendments":(PermissionManager.validate("job_item","edit")||PermissionManager.validate("job_item","edit_child")||PermissionManager.validate("job_item","edit_own"))&&(n=!0);break;default:n=super.checkTabPermissions(i);break}return n}setCurrentEditRecordData(){this.setDefaultData({punch_branch_selection_type_id:10,punch_department_selection_type_id:10,punch_group_selection_type_id:10,punch_job_item_group_selection_type_id:10});for(var i in this.current_edit_record){var n=this.edit_view_ui_dic[i];Global.isSet(n)&&n.setValue(this.current_edit_record[i])}this.collectUIDataToCurrentEditRecord(),this.setEditViewDataDone()}setEditViewDataDone(){super.setEditViewDataDone(),this.onEmployeeGroupSelectionTypeChange(),this.onEmployeeTitleSelectionTypeChange(),this.onJobItemGroupSelectionTypeChange(),this.onJobItemSelectionTypeChange(),this.onPunchBranchSelectionTypeChange(),this.onPunchDepartmentSelectionTypeChange(),this.onPunchJobGroupSelectionTypeChange(),this.onPunchJobSelectionTypeChange()}onFormItemChange(i,n){this.setIsChanged(i),this.setMassEditingFieldsWhenFormChange(i);var o=i.getField(),s=i.getValue();this.current_edit_record[o]=s,o==="user_group_selection_type_id"&&this.onEmployeeGroupSelectionTypeChange(),o==="user_title_selection_type_id"&&this.onEmployeeTitleSelectionTypeChange(),o==="punch_job_item_group_selection_type_id"&&this.onJobItemGroupSelectionTypeChange(),o==="punch_job_item_selection_type_id"&&this.onJobItemSelectionTypeChange(),o==="punch_branch_selection_type_id"&&this.onPunchBranchSelectionTypeChange(),o==="punch_department_selection_type_id"&&this.onPunchDepartmentSelectionTypeChange(),o==="punch_job_group_selection_type_id"&&this.onPunchJobGroupSelectionTypeChange(),o==="punch_job_selection_type_id"&&this.onPunchJobSelectionTypeChange(),n||this.validate()}onEmployeeGroupSelectionTypeChange(){this.current_edit_record.user_group_selection_type_id==10?this.edit_view_ui_dic.user_group_ids.setEnabled(!1):this.edit_view_ui_dic.user_group_ids.setEnabled(!0)}onEmployeeTitleSelectionTypeChange(){this.current_edit_record.user_title_selection_type_id==10?this.edit_view_ui_dic.user_title_ids.setEnabled(!1):this.edit_view_ui_dic.user_title_ids.setEnabled(!0)}onJobItemGroupSelectionTypeChange(){this.current_edit_record.punch_job_item_group_selection_type_id==10?this.edit_view_ui_dic.punch_job_item_group.setEnabled(!1):this.edit_view_ui_dic.punch_job_item_group.setEnabled(!0)}onJobItemSelectionTypeChange(){this.current_edit_record.punch_job_item_selection_type_id==10?this.edit_view_ui_dic.punch_job_item.setEnabled(!1):this.edit_view_ui_dic.punch_job_item.setEnabled(!0)}onPunchBranchSelectionTypeChange(){this.current_edit_record.punch_branch_selection_type_id==10||this.is_viewing?this.edit_view_ui_dic.punch_branch.setEnabled(!1):this.edit_view_ui_dic.punch_branch.setEnabled(!0)}onPunchDepartmentSelectionTypeChange(){this.current_edit_record.punch_department_selection_type_id==10||this.is_viewing?this.edit_view_ui_dic.punch_department.setEnabled(!1):this.edit_view_ui_dic.punch_department.setEnabled(!0)}onPunchJobGroupSelectionTypeChange(){this.current_edit_record.punch_job_group_selection_type_id==10||this.is_viewing?this.edit_view_ui_dic.punch_job_group.setEnabled(!1):this.edit_view_ui_dic.punch_job_group.setEnabled(!0)}onPunchJobSelectionTypeChange(){Global.getProductEdition()>=20&&(this.current_edit_record.punch_job_selection_type_id==10||this.is_viewing?this.edit_view_ui_dic.punch_job.setEnabled(!1):this.edit_view_ui_dic.punch_job.setEnabled(!0))}getFilterColumnsFromDisplayColumns(i,n){return i==null&&(i={}),i.latitude=!0,i.longitude=!0,this._getFilterColumnsFromDisplayColumns(i,n)}}export{y as PunchTagViewController};
//# sourceMappingURL=PunchTagViewController-CVVCPhOx.bundle.js.map
