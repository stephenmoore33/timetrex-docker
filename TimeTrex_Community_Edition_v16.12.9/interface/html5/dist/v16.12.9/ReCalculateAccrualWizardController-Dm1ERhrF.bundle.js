import{_,j as d}from"./vendor-tTApdY0Y.bundle.js";class y extends BaseWizardController{constructor(r={}){_.defaults(r,{el:".wizard-bg"}),super(r)}init(r){this.title=d.i18n._("Accrual ReCalculation Wizard"),this.steps=3,this.current_step=1,this.render()}render(){super.render(),this.initCurrentStep()}buildCurrentStepUI(){this.content_div.empty();var r=this;switch(this.stepsWidgetDic[this.current_step]={},this.current_step){case 1:var e=this.getLabel();e.text(d.i18n._("Select one or more accrual policies"));var i=this.getAComboBox(TTAPI.APIAccrualPolicy,!0,"global_accrual","accrual_policy_id"),s=d("<div class='wizard-acombobox-div'></div>");s.append(i),this.stepsWidgetDic[this.current_step][i.getField()]=i,this.content_div.append(e),this.content_div.append(s);break;case 2:e=this.getLabel(),e.text(d.i18n._("Select the date range")),this.content_div.append(e);var t=d(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html")),a=t.find(".form-item-label"),n=t.find(".form-item-input-div"),c=this.getComboBox("time_period",!0);a.text(d.i18n._("Time Period")),n.append(c),this.content_div.append(t),t=d(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html")),a=t.find(".form-item-label"),n=t.find(".form-item-input-div");var p=this.getDatePicker("start_date");a.text(d.i18n._("Start Date")),n.append(p),this.content_div.append(t),t=d(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html")),a=t.find(".form-item-label"),n=t.find(".form-item-input-div");var l=this.getDatePicker("end_date");a.text(d.i18n._("End Date")),n.append(l),this.content_div.append(t),t=d(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html")),a=t.find(".form-item-label"),n=t.find(".form-item-input-div");var o=this.getAComboBox(TTAPI.APIPayPeriod,!0,"global_Pay_period","pay_period_id");a.text(d.i18n._("Pay Period")),n.append(o),this.content_div.append(t),t=d(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html")),a=t.find(".form-item-label"),n=t.find(".form-item-input-div");var h=this.getAComboBox(TTAPI.APIPayPeriodSchedule,!0,"global_pay_period_schedule","pay_period_schedule_id");a.text(d.i18n._("Pay Period Schedule")),n.append(h),this.content_div.append(t),c.bind("formItemChange",function(v,u){r.onTimePeriodChange(u)}),this.stepsWidgetDic[this.current_step][c.getField()]=c,this.stepsWidgetDic[this.current_step][p.getField()]=p,this.stepsWidgetDic[this.current_step][l.getField()]=l,this.stepsWidgetDic[this.current_step][o.getField()]=o,this.stepsWidgetDic[this.current_step][h.getField()]=h,r.onTimePeriodChange(c);break;case 3:e=this.getLabel(),e.text(d.i18n._("Select one or more employees")),i=this.getAComboBox(TTAPI.APIUser,!0,"global_user","user_id",!0),s=d("<div class='wizard-acombobox-div'></div>"),s.append(i),this.stepsWidgetDic[this.current_step]={},this.stepsWidgetDic[this.current_step][i.getField()]=i,this.content_div.append(e),this.content_div.append(s);break}}onTimePeriodChange(r){var e=r.getValue(),i=this.stepsWidgetDic[this.current_step].start_date.parent().parent(),s=this.stepsWidgetDic[this.current_step].end_date.parent().parent(),t=this.stepsWidgetDic[this.current_step].pay_period_id.parent().parent(),a=this.stepsWidgetDic[this.current_step].pay_period_schedule_id.parent().parent();e==="custom_date"?(i.css("display","block"),s.css("display","block"),t.css("display","none"),a.css("display","none")):e==="custom_pay_period"?(i.css("display","none"),s.css("display","none"),t.css("display","block"),a.css("display","none")):e==="this_pay_period"||e==="last_pay_period"||e==="to_last_pay_period"||e==="to_this_pay_period"?(i.css("display","none"),s.css("display","none"),t.css("display","none"),a.css("display","block")):(i.css("display","none"),s.css("display","none"),t.css("display","none"),a.css("display","none"))}onDoneClick(){var r=this;super.onDoneClick(),this.saveCurrentStep();var e=this.stepsDataDic[1].accrual_policy_id,i=this.stepsDataDic[3].user_id,s={};s.time_period=this.stepsDataDic[2].time_period;for(var t in this.stepsDataDic[2])!this.stepsDataDic[2].hasOwnProperty([t])||t==="time_period"||t==="effective_date"||(s[t]=this.stepsDataDic[2][t]);var a=TTAPI.APIAccrualPolicy;a.recalculateAccrual(e,s,i,{onResult:function(n){r.onCloseClick(),r.call_back&&r.call_back()}})}buildCurrentStepData(){var r=this,e=this.stepsDataDic[this.current_step],i=this.stepsWidgetDic[this.current_step];switch(this.current_step){case 1:if(e)for(var s in e)e.hasOwnProperty(s)&&i[s].setValue(e[s]);break;case 2:TTAPI.APITimesheetSummaryReport.getOptions("time_period",{onResult:function(t){if(i.time_period.setSourceData(Global.buildRecordArray(t.getResult())),!e)i.time_period.setValue("last_month");else for(var a in e)e.hasOwnProperty(a)&&i[a].setValue(e[a]);r.onTimePeriodChange(i.time_period)}});break;case 3:if(!e)i.user_id.setValue(TTUUID.not_exist_id);else for(var s in e)e.hasOwnProperty(s)&&i[s].setValue(e[s]);break;default:for(var s in e)e.hasOwnProperty(s)&&i[s].setValue(e[s]);break}}saveCurrentStep(){this.stepsDataDic[this.current_step]={};var r=this.stepsDataDic[this.current_step],e=this.stepsWidgetDic[this.current_step];switch(this.current_step){case 1:r.accrual_policy_id=e.accrual_policy_id.getValue();break;case 2:for(var i in e)e.hasOwnProperty(i)&&e[i].is(":visible")&&(r[i]=e[i].getValue());break;case 3:r.user_id=e.user_id.getValue();break}}setDefaultDataToSteps(){if(!this.default_data)return null;this.stepsDataDic[1]={},this.getDefaultData("accrual_policy_id")&&(this.stepsDataDic[1].accrual_policy_id=this.getDefaultData("accrual_policy_id"))}}export{y as ReCalculateAccrualWizardController};
//# sourceMappingURL=ReCalculateAccrualWizardController-Dm1ERhrF.bundle.js.map
