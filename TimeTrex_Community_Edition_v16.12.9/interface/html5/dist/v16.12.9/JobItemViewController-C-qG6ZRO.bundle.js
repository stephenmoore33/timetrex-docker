import{_ as d,j as i}from"./vendor-tTApdY0Y.bundle.js";class s extends BaseViewController{constructor(t={}){d.defaults(t,{el:"#job_item_view_container",status_array:null,job_item_group_array:null,job_item_group_api:null,sub_document_view_controller:null,document_object_type_id:null,date_api:null}),super(t)}init(t){this.edit_view_tpl="JobItemEditView.html",this.permission_id="job_item",this.viewId="JobItem",this.script_name="JobItemView",this.table_name_key="job_item",this.context_menu_name=i.i18n._("Tasks"),this.navigation_label=i.i18n._("Tasks"),this.document_object_type_id=70,this.api=TTAPI.APIJobItem,this.date_api=TTAPI.APITTDate,this.job_item_group_api=TTAPI.APIJobItemGroup,this.render(),this.buildContextMenu(),this.initData()}initOptions(){var t=this;this.initDropDownOption("status"),this.job_item_group_api.getJobItemGroup("",!1,!1,{onResult:function(a){a=a.getResult(),a=Global.buildTreeRecord(a),!t.sub_view_mode&&t.basic_search_field_ui_dic.group_id&&(t.basic_search_field_ui_dic.group_id.setSourceData(a),t.adv_search_field_ui_dic.group_id.setSourceData(a)),t.job_item_group_array=a}})}getCustomContextMenuModel(){var t={exclude:[],include:[{label:i.i18n._("Import"),id:"import_icon",menu_align:"right",action_group:"import_export",group:"other",vue_icon:"tticon tticon-file_download_black_24dp",permission_result:PermissionManager.checkTopLevelPermission("ImportCSVJobItem"),permission:null,sort_order:9010}]};return t}setDefaultMenuImportIcon(t,a,e){PermissionManager.checkTopLevelPermission("ImportCSVJobItem")===!0?ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,t.id,!0):ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,t.id,!1)}onCustomContextClick(t){switch(t){case"import_icon":this.onImportClick();break}}onImportClick(){var t=this;IndexViewController.openWizard("ImportCSVWizard","JobItem",function(){t.search()})}buildEditViewUI(){super.buildEditViewUI();var t=this,a={tab_task:{label:i.i18n._("Task"),is_multi_column:!0},tab_attachment:!0,tab_audit:!0};this.setTabModel(a);var e;this.navigation.AComboBox({api_class:TTAPI.APIJobItem,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_job_item",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var _=this.edit_view_tab.find("#tab_task"),l=_.find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(l),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"status_id"}),e.setSourceData(t.status_array),this.addEditFieldToColumn(i.i18n._("Status"),e,l,""),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn(i.i18n._("Name"),e,l),e.parent().width("45%"),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"description",width:"100%"}),this.addEditFieldToColumn(i.i18n._("Description"),e,l),e.parent().width("45%"),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"manual_id",width:65}),this.addEditFieldToColumn(i.i18n._("Code"),e,l),e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({tree_mode:!0,allow_multiple_selection:!1,layout_name:"global_tree_column",set_empty:!0,field:"group_id"}),e.setSourceData(t.job_item_group_array),this.addEditFieldToColumn(i.i18n._("Group"),e,l),e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIProduct,allow_multiple_selection:!1,layout_name:"global_product",show_search_inputs:!0,set_empty:!0,field:"product_id"}),this.addEditFieldToColumn(i.i18n._("Product"),e,l),Global.getProductEdition()>=20&&(e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIGEOFence,allow_multiple_selection:!0,layout_name:"global_geo_fence",show_search_inputs:!0,set_empty:!0,field:"geo_fence_ids"}),this.addEditFieldToColumn(i.i18n._("Allowed GEO Fences"),e,l)),e=Global.loadWidgetByName(FormItemType.TAG_INPUT),e.TTagInput({field:"tag",object_type_id:610}),this.addEditFieldToColumn(i.i18n._("Tags"),e,l,"",null,null,!0);var o=_.find(".second-column");this.edit_view_tabs[0].push(o),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"estimate_time",mode:"time_unit",need_parser_sec:!0}),this.addEditFieldToColumn(i.i18n._("Estimated Time"),e,o,"",null,!0,!0),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"estimate_quantity",width:150}),this.addEditFieldToColumn(i.i18n._("Estimated Quantity"),e,o),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"estimate_bad_quantity",width:150}),this.addEditFieldToColumn(i.i18n._("Estimated Bad Quantity"),e,o),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"bad_quantity_rate",width:150}),this.addEditFieldToColumn(i.i18n._("Bad Quantity Billable Rate"),e,o),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"billable_rate",width:86}),this.addEditFieldToColumn(i.i18n._("Billable Rate"),e,o),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"minimum_time",mode:"time_unit",need_parser_sec:!0}),this.addEditFieldToColumn(i.i18n._("Minimum Billable Time"),e,o,"",null)}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:i.i18n._("Status"),in_column:1,field:"status_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:i.i18n._("Code"),in_column:1,field:"manual_id",multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:i.i18n._("Name"),in_column:2,field:"name",multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:i.i18n._("Description"),in_column:1,field:"description",multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:i.i18n._("Tags"),field:"tag",basic_search:!0,adv_search:!0,in_column:1,object_type_id:610,form_item_type:FormItemType.TAG_INPUT}),new SearchField({label:i.i18n._("Group"),in_column:2,multiple:!0,field:"group_id",layout_name:"global_tree_column",tree_mode:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:i.i18n._("Product"),in_column:2,field:"product_id",layout_name:"global_product",api_class:TTAPI.APIProduct,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:i.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:i.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX})]}setCurrentEditRecordData(){for(var t in this.current_edit_record){var a=this.edit_view_ui_dic[t];if(Global.isSet(a))switch(t){default:a.setValue(this.current_edit_record[t]);break}}this.collectUIDataToCurrentEditRecord(),this.setEditViewDataDone()}onFormItemChange(t,a){this.setIsChanged(t),this.setMassEditingFieldsWhenFormChange(t);var e=t.getField(),_=t.getValue();this.current_edit_record[e]=_,a||this.validate()}}export{s as JobItemViewController};
//# sourceMappingURL=JobItemViewController-C-qG6ZRO.bundle.js.map
