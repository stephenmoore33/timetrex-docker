{"version":3,"file":"ForgotPasswordWizardController-B83O0qre.bundle.js","sources":["../../views/wizard/forgot_password/ForgotPasswordWizardController.js"],"sourcesContent":["export class ForgotPasswordWizardController extends BaseWizardController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '.wizard-bg'\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit() {\n\t\t//this._super('initialize' );\n\n\t\tthis.title = $.i18n._( 'Password Reset' );\n\t\tthis.steps = 1;\n\t\tthis.current_step = 1;\n\t\tif ( this.default_data && typeof this.default_data.api_class != 'undefined' ) {\n\t\t\tthis.api = this.default_data.api_class;\n\t\t} else {\n\t\t\tthis.api = TTAPI.APIAuthentication;\n\t\t}\n\t\tthis.render();\n\t}\n\n\trender() {\n\t\tvar $this = this;\n\t\tsuper.render();\n\n\t\t// $( this.el ).css( {left:  ( Global.bodyWidth() - $(this.el ).width() )/2} );\n\n//\t\tthis.content_div.css( {height: $(this.el ).height() - 145} );\n\n// \t\t$( window ).resize( function() {\n// \t\t\t// $( $this.el ).css( {left:  ( Global.bodyWidth() - $($this.el ).width() )/2} );\n// //\t\t\t$this.content_div.css( {height: $($this.el ).height() - 145} );\n// \t\t} );\n\n\t\tthis.initCurrentStep();\n\t}\n\n\tbuildCurrentStepUI() {\n\n\t\tvar $this = this;\n\t\tthis.content_div.empty();\n\n\t\tthis.stepsWidgetDic[this.current_step] = {};\n\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tvar form_item = $( Global.loadWidget( 'global/widgets/wizard_form_item/WizardFormItem.html' ) );\n\t\t\t\tvar form_item_label = form_item.find( '.form-item-label' );\n\t\t\t\tvar form_item_input_div = form_item.find( '.form-item-input-div' );\n\t\t\t\tvar item = this.getTextInput( 'email' );\n\t\t\t\tform_item_label.text( $.i18n._( 'Email Address' ) );\n\t\t\t\tform_item_input_div.unbind( 'keydown' ).bind( 'keydown', function( e ) {\n\t\t\t\t\tif ( e.keyCode === 13 ) {\n\t\t\t\t\t\t$this.onDoneClick();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\tform_item_input_div.append( item );\n\t\t\t\tthis.content_div.append( form_item );\n\t\t\t\tthis.stepsWidgetDic[this.current_step][item.getField()] = item;\n\t\t\t\tthis.stepsWidgetDic[this.current_step][item.getField()].focus();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsaveCurrentStep() {\n\t\tthis.stepsDataDic[this.current_step] = {};\n\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\t\tswitch ( this.current_step ) {\n\t\t\tdefault:\n\t\t\t\tfor ( var key in current_step_ui ) {\n\t\t\t\t\tif ( !current_step_ui.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tcurrent_step_data[key] = current_step_ui[key].getValue();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tbuildCurrentStepData() {\n\t}\n\n\tonCloseClick() {\n\t\t$( this.el ).remove();\n\t\tLocalCacheData.current_open_wizard_controllers = LocalCacheData.current_open_wizard_controllers.filter( wizard => wizard.wizard_id !== this.wizard_id );\n\t\tLocalCacheData.extra_filter_for_next_open_view = null;\n\t}\n\n\tonDoneClick() {\n\t\tvar $this = this;\n\t\tsuper.onDoneClick();\n\t\tthis.saveCurrentStep();\n\n\t\tvar email = this.stepsDataDic[1].email;\n\n\t\tthis.stepsWidgetDic[1].email.clearErrorStyle();\n\n\t\tif ( !email ) {\n\t\t\tthis.stepsWidgetDic[1].email.setErrorStyle( $.i18n._( 'Email must be specified' ), true );\n\t\t} else {\n\t\t\tthis.api.resetPassword( email, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\tif ( !result.isValid() ) {\n\t\t\t\t\t\tTAlertManager.showErrorAlert( result );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.onCloseClick();\n\t\t\t\t\t\tif ( $this.call_back ) {\n\t\t\t\t\t\t\t$this.call_back( result );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tshowErrorAlert( result ) {\n\t\tvar details = result.getDetails();\n\t\t// if ( details.hasOwnProperty( 'error' ) ) {\n\t\t//\n\t\t// }\n\t\tif ( !details ) {\n\t\t\tdetails = result.getDescription(); // If the details is empty, try to get description to show.\n\t\t}\n\t\tvar error_string = '';\n\n\t\tif ( Global.isArray( details ) || typeof details === 'object' ) {\n\n\t\t\t$.each( details, function( index, val ) {\n\n\t\t\t\tif ( val.hasOwnProperty( 'error' ) ) {\n\t\t\t\t\tval = val.error;\n\t\t\t\t}\n\n\t\t\t\tfor ( var key in val ) {\n\t\t\t\t\terror_string = error_string + val[key] + '<br>';\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\n\t\t\terror_string = details;\n\t\t}\n\t\tIndexViewController.instance.router.showTipModal( error_string );\n\t}\n}"],"names":["ForgotPasswordWizardController","options","_","$","$this","form_item","form_item_label","form_item_input_div","item","e","current_step_data","current_step_ui","key","wizard","email","result","details","error_string","index","val"],"mappings":"uDAAO,MAAMA,UAAuC,oBAAqB,CACxE,YAAaC,EAAU,GAAK,CAC3BC,EAAE,SAAUD,EAAS,CACpB,GAAI,YACP,GAEE,MAAOA,CAAO,CACd,CAED,MAAO,CAGN,KAAK,MAAQE,EAAE,KAAK,EAAG,gBAAgB,EACvC,KAAK,MAAQ,EACb,KAAK,aAAe,EACf,KAAK,cAAgB,OAAO,KAAK,aAAa,UAAa,IAC/D,KAAK,IAAM,KAAK,aAAa,UAE7B,KAAK,IAAM,MAAM,kBAElB,KAAK,OAAM,CACX,CAED,QAAS,CAER,MAAM,OAAM,EAWZ,KAAK,gBAAe,CACpB,CAED,oBAAqB,CAEpB,IAAIC,EAAQ,KAKZ,OAJA,KAAK,YAAY,QAEjB,KAAK,eAAe,KAAK,YAAY,EAAI,CAAA,EAEhC,KAAK,aAAY,CACzB,IAAK,GACJ,IAAIC,EAAYF,EAAG,OAAO,WAAY,qDAAuD,CAAA,EACzFG,EAAkBD,EAAU,KAAM,kBAAkB,EACpDE,EAAsBF,EAAU,KAAM,sBAAsB,EAC5DG,EAAO,KAAK,aAAc,OAAO,EACrCF,EAAgB,KAAMH,EAAE,KAAK,EAAG,eAAe,GAC/CI,EAAoB,OAAQ,SAAS,EAAG,KAAM,UAAW,SAAUE,EAAI,CACjEA,EAAE,UAAY,IAClBL,EAAM,YAAW,CAEvB,GACIG,EAAoB,OAAQC,GAC5B,KAAK,YAAY,OAAQH,GACzB,KAAK,eAAe,KAAK,YAAY,EAAEG,EAAK,SAAQ,CAAE,EAAIA,EAC1D,KAAK,eAAe,KAAK,YAAY,EAAEA,EAAK,SAAQ,CAAE,EAAE,QACxD,KACD,CACD,CAED,iBAAkB,CACjB,KAAK,aAAa,KAAK,YAAY,EAAI,CAAA,EACvC,IAAIE,EAAoB,KAAK,aAAa,KAAK,YAAY,EACvDC,EAAkB,KAAK,eAAe,KAAK,YAAY,EAC3D,OAAS,KAAK,aAAY,CACzB,QACC,QAAUC,KAAOD,EACVA,EAAgB,eAAgBC,KAGtCF,EAAkBE,CAAG,EAAID,EAAgBC,CAAG,EAAE,SAAQ,GAEvD,KACD,CACD,CAED,sBAAuB,CACtB,CAED,cAAe,CACdT,EAAG,KAAK,EAAI,EAAC,OAAM,EACnB,eAAe,gCAAkC,eAAe,gCAAgC,OAAQU,GAAUA,EAAO,YAAc,KAAK,WAC5I,eAAe,gCAAkC,IACjD,CAED,aAAc,CACb,IAAIT,EAAQ,KACZ,MAAM,YAAW,EACjB,KAAK,gBAAe,EAEpB,IAAIU,EAAQ,KAAK,aAAa,CAAC,EAAE,MAEjC,KAAK,eAAe,CAAC,EAAE,MAAM,gBAAe,EAEtCA,EAGL,KAAK,IAAI,cAAeA,EAAO,CAC9B,SAAU,SAAUC,EAAS,CACtBA,EAAO,WAGZX,EAAM,aAAY,EACbA,EAAM,WACVA,EAAM,UAAWW,IAJlB,cAAc,eAAgBA,EAO/B,CACL,GAbG,KAAK,eAAe,CAAC,EAAE,MAAM,cAAeZ,EAAE,KAAK,EAAG,yBAA2B,EAAE,EAAI,CAexF,CAED,eAAgBY,EAAS,CACxB,IAAIC,EAAUD,EAAO,aAIfC,IACLA,EAAUD,EAAO,kBAElB,IAAIE,EAAe,GAEd,OAAO,QAASD,CAAS,GAAI,OAAOA,GAAY,SAEpDb,EAAE,KAAMa,EAAS,SAAUE,EAAOC,EAAM,CAElCA,EAAI,eAAgB,WACxBA,EAAMA,EAAI,OAGX,QAAUP,KAAOO,EAChBF,EAAeA,EAAeE,EAAIP,CAAG,EAAI,MAE9C,GAGGK,EAAeD,EAEhB,oBAAoB,SAAS,OAAO,aAAcC,CAAY,CAC9D,CACF"}