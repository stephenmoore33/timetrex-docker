{"version":3,"file":"CurrencyRateViewController-Dtv63GIM.bundle.js","sources":["../../views/company/currency/CurrencyRateViewController.js"],"sourcesContent":["export class CurrencyRateViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\n\t\t\tel: '#currency_rate_view_container', //Must set el here and can only set string, so events can work\n\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'CurrencyRateEditView.html';\n\t\tthis.permission_id = 'currency';\n\t\tthis.script_name = 'CurrencyRateView';\n\t\tthis.viewId = 'CurrencyRate';\n\t\tthis.table_name_key = 'currency_rate';\n\t\tthis.context_menu_name = $.i18n._( 'Rates' );\n\t\tthis.navigation_label = $.i18n._( 'Rate' );\n\t\tthis.api = TTAPI.APICurrencyRate;\n\n\t\tthis.render();\n\n\t\tif ( this.sub_view_mode ) {\n\t\t\tthis.buildContextMenu( true );\n\t\t} else {\n\t\t\tthis.buildContextMenu();\n\t\t}\n\n\t\t//call init data in parent view\n\t\tif ( !this.sub_view_mode ) {\n\t\t\tthis.initData();\n\t\t}\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\texclude: ['copy'],\n\t\t\tinclude: []\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_currency_rate': { 'label': $.i18n._( 'Currency Rate' ) },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tvar form_item_input;\n\t\tvar widgetContainer;\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APICurrencyRate,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_currency_rate',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_currency_rate = this.edit_view_tab.find( '#tab_currency_rate' );\n\n\t\tvar tab_currency_rate_column1 = tab_currency_rate.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_currency_rate_column1 );\n\n\t\t// Currency\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APICurrency,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_currency',\n\t\t\tfield: 'currency_id',\n\t\t\tset_empty: false,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Currency' ), form_item_input, tab_currency_rate_column1 );\n\n\t\t// Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\tform_item_input.TDatePicker( { field: 'date_stamp' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Date' ), form_item_input, tab_currency_rate_column1 );\n\n\t\t// Conversion Rate\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'conversion_rate', width: 114 } );\n\t\twidgetContainer = $( '<div class=\\'\\'></div>' );\n\t\tvar conversion_rate_clarification_box = $( '<span id=\\'rate_conversion_rate_clarification_box\\'></span>' );\n\t\twidgetContainer.append( form_item_input );\n\t\twidgetContainer.append( conversion_rate_clarification_box );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Conversion Rate' ), [form_item_input], tab_currency_rate_column1, '', widgetContainer, false, true );\n\t}\n\n\tonMassEditClick() {\n\n\t\tvar $this = this;\n\t\t$this.is_add = false;\n\t\t$this.is_viewing = false;\n\t\t$this.is_mass_editing = true;\n\t\tLocalCacheData.current_doing_context_action = 'mass_edit';\n\t\t$this.openEditView();\n\t\tvar filter = {};\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\t\tthis.mass_edit_record_ids = [];\n\n\t\t$.each( grid_selected_id_array, function( index, value ) {\n\t\t\t$this.mass_edit_record_ids.push( value );\n\t\t} );\n\n\t\tfilter.filter_data = {};\n\t\tfilter.filter_data.id = this.mass_edit_record_ids;\n\n\t\tthis.api['getCommon' + this.api.key_name + 'Data']( filter, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\tif ( !result_data ) {\n\t\t\t\t\tresult_data = [];\n\t\t\t\t}\n\n\t\t\t\t$this.api['getOptions']( 'unique_columns', {\n\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t$this.unique_columns = result.getResult();\n\n\t\t\t\t\t\t$this.linked_columns = {};\n\t\t\t\t\t\tif ( $this.sub_view_mode && $this.parent_key ) {\n\t\t\t\t\t\t\tresult_data[$this.parent_key] = $this.parent_value;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$this.current_edit_record = result_data;\n\t\t\t\t\t\t$this.initEditView();\n\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tonFormItemChange( target, doNotValidate ) {\n\t\tif ( target.getField() == 'conversion_rate' ) {\n\t\t\tthis.setConversionRateExampleText( target.getValue(), null, this.edit_view_ui_dic.currency_id.getValue() );\n\t\t}\n\t\tsuper.onFormItemChange( target, doNotValidate );\n\t}\n\n\tinitEditView( editId, noRefreshUI ) {\n\t\tsuper.initEditView();\n\t\tthis.setConversionRateExampleText( this.edit_view_ui_dic.conversion_rate.getValue(), null, this.edit_view_ui_dic.currency_id.getValue() );\n\t}\n\n}\n\nCurrencyRateViewController.loadSubView = function( container, beforeViewLoadedFun, afterViewLoadedFun ) {\n\n\tGlobal.loadViewSource( 'CurrencyRate', 'SubCurrencyRateView.html', function( result ) {\n\n\t\tvar args = {};\n\t\tvar template = _.template( result );\n\n\t\tif ( Global.isSet( beforeViewLoadedFun ) ) {\n\t\t\tbeforeViewLoadedFun();\n\t\t}\n\n\t\tif ( Global.isSet( container ) ) {\n\t\t\tcontainer.html( template( args ) );\n\n\t\t\tif ( Global.isSet( afterViewLoadedFun ) ) {\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'initialize', function() {\n\t\t\t\t\tafterViewLoadedFun( sub_currency_rate_view_controller );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t}\n\n\t} );\n\n};"],"names":["CurrencyRateViewController","options","_","$","context_menu_model","tab_model","form_item_input","widgetContainer","tab_currency_rate","tab_currency_rate_column1","conversion_rate_clarification_box","$this","filter","grid_selected_id_array","index","value","result","result_data","target","doNotValidate","editId","noRefreshUI","container","beforeViewLoadedFun","afterViewLoadedFun","args","template"],"mappings":"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"}