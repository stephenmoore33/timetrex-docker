import{_ as s,j as r}from"./vendor-tTApdY0Y.bundle.js";class u extends BaseViewController{constructor(e={}){s.defaults(e,{el:"#exception_view_container",status_array:null}),super(e)}init(e){this.edit_view_tpl="ExceptionEditView.html",this.permission_id="punch",this.viewId="Exception",this.script_name="ExceptionView",this.context_menu_name=r.i18n._("Exceptions"),this.navigation_label=r.i18n._("Exception"),this.api=TTAPI.APIException,this.initPermission(),this.render(),this.buildContextMenu(),this.initData()}onCustomContextClick(e){switch(e){case"edit_employee":case"edit_pay_period":case"edit_pay_period_schedule":case"schedule":case"timesheet":case"send_message":this.onNavigationClick(e);break}}setCustomDefaultMenuIcon(e,t,a){switch(e){case"timesheet":this.setDefaultMenuViewIcon(t,a,"punch");break;case"schedule":this.setDefaultMenuViewIcon(t,a,"schedule");break;case"edit_employee":this.setDefaultMenuEditEmployeeIcon(t,a);break;case"edit_pay_period_schedule":this.setDefaultMenuEditIcon(t,a,"pay_period_schedule");break;case"edit_pay_period":this.setDefaultMenuEditIcon(t,a,"pay_period_schedule");break;case"send_message":this.setDefaultMenuSendMessageIcon(t,a);break}}initPermission(){super.initPermission(),PermissionManager.validate(this.permission_id,"view")||PermissionManager.validate(this.permission_id,"view_child")?this.show_search_tab=!0:this.show_search_tab=!1}autoOpenEditViewIfNecessary(){this.autoOpenEditOnlyViewIfNecessary()}setDefaultMenuEditEmployeeIcon(e,t){this.editChildPermissionValidate("user")||ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,e.id,!1),t===1?ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,e.id,!0):ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,e.id,!1)}setDefaultMenuSendMessageIcon(e,t,a){t>0?(ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,e.id,!0),ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,e.id,!0)):ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,e.id,!1)}onNavigationClick(e){var t=this.getSelectedItem();if(t!=null)var a=t.user_id;switch(e){case"edit_employee":IndexViewController.openEditView(this,"Employee",a);break;case"edit_pay_period":var i=t.pay_period_id;i&&IndexViewController.openEditView(this,"PayPeriods",i);break;case"edit_pay_period_schedule":var n=t.pay_period_schedule_id;n&&IndexViewController.openEditView(this,"PayPeriodSchedule",i);break;case"schedule":var l={filter_data:{}},o={value:[a]};l.filter_data.include_user_ids=o,l.select_date=t.date_stamp,Global.addViewTab(this.viewId,r.i18n._("Exception"),window.location.href),IndexViewController.goToView("Schedule",l);break;case"timesheet":l={filter_data:{}},l.user_id=a,l.base_date=t.date_stamp,Global.addViewTab(this.viewId,r.i18n._("Exception"),window.location.href),IndexViewController.goToView("TimeSheet",l);break;case"send_message":LocalCacheData.default_filter_for_next_open_view={to_user_id:s.uniq(this.getSelectedItems().map(d=>d.user_id))},IndexViewController.openEditView(this,"MessageControl",null,"onAddClick");break}}initOptions(){var e=this,t=[{option_name:"status",field_name:"user_status_id",api:TTAPI.APIUser},{option_name:"severity",api:TTAPI.APIExceptionPolicy},{option_name:"type",field_name:"exception_policy_type_id",api:TTAPI.APIExceptionPolicy}];this.initDropDownOptions(t);var a=TTAPI.APIUserGroup;a.getUserGroup("",!1,!1,{onResult:function(i){i=i.getResult(),i=Global.buildTreeRecord(i),!e.sub_view_mode&&e.basic_search_field_ui_dic.group_id&&(e.basic_search_field_ui_dic.group_id.setSourceData(i),e.adv_search_field_ui_dic.group_id.setSourceData(i))}})}getCustomContextMenuModel(){var e={exclude:["default"],include:[{label:r.i18n._("Send Message"),id:"send_message",menu_align:"right",vue_icon:"tticon tticon-send_black_24dp"},{label:r.i18n._("Jump To"),id:"jump_to_header",menu_align:"right",action_group:"jump_to",action_group_header:!0,permission_result:!1},{label:r.i18n._("TimeSheet"),id:"timesheet",menu_align:"right",action_group:"jump_to",group:"navigation"},{label:r.i18n._("Schedules"),id:"schedule",menu_align:"right",action_group:"jump_to",group:"navigation"},{label:r.i18n._("Edit Employee"),id:"edit_employee",menu_align:"right",action_group:"jump_to",group:"navigation"},{label:r.i18n._("Edit Pay Period"),id:"edit_pay_period",menu_align:"right",action_group:"jump_to",group:"navigation"},{label:r.i18n._("Edit PP Schedule"),id:"edit_pay_period_schedule",menu_align:"right",action_group:"jump_to",group:"navigation"},{label:r.i18n._("Export"),id:"export_excel",group:"other",vue_icon:"tticon tticon-file_upload_black_24dp",sort_order:9e3}]};return e}getSearchPanelFilter(e,t){if(Global.isSet(e))var a=e;else a=this.search_panel.getSelectTabIndex();var i=null;if(a===0)this.filter_data=[],i=this.basic_search_field_ui_dic;else if(a===1)this.filter_data=[],i=this.adv_search_field_ui_dic;else return;var n=this;r.each(i,function(l,o){if(n.filter_data[l]={field:l,id:"",value:i[l].getValue(!0)},l==="show_pre_mature"&&n.filter_data[l].value!==!0)return delete n.filter_data[l],!1;n.temp_basic_filter_data&&(n.temp_basic_filter_data[l]=n.filter_data[l]),n.temp_adv_filter_data&&(n.temp_adv_filter_data[l]=n.filter_data[l])}),t&&(a===0?n.temp_basic_filter_data=Global.clone(n.filter_data):a===1&&(n.temp_adv_filter_data=Global.clone(n.filter_data)))}onGridDblClickRow(){for(var e=ContextMenuManager.getMenuModelByMenuId(this.determineContextMenuMountAttributes().id),t=e.length,a=!1,i=0;i<t&&!a;i++){let n=e[i];switch(e[i].id){case"timesheet":if(n.visible&&!n.disabled){this.onNavigationClick("timesheet");return}break}}for(var i=0;i<t&&!a;i++){let l=e[i];switch(e[i].id){case"schedule":if(a=!0,l.visible&&!l.disabled){this.onNavigationClick("schedule");return}break}}}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:r.i18n._("Employee Status"),in_column:1,field:"user_status_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:r.i18n._("Pay Period"),in_column:1,field:"pay_period_id",layout_name:"global_Pay_period",api_class:TTAPI.APIPayPeriod,multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:r.i18n._("Employee"),in_column:1,field:"user_id",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:r.i18n._("Severity"),in_column:1,field:"severity_id",multiple:!0,adv_search:!0,basic_search:!1,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:r.i18n._("Exception"),in_column:1,field:"exception_policy_type_id",multiple:!0,adv_search:!0,basic_search:!1,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:r.i18n._("Group"),in_column:2,multiple:!0,field:"group_id",layout_name:"global_tree_column",tree_mode:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:r.i18n._("Default Branch"),in_column:2,field:"default_branch_id",layout_name:"global_branch",api_class:TTAPI.APIBranch,multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:r.i18n._("Default Department"),field:"default_department_id",in_column:2,layout_name:"global_department",api_class:TTAPI.APIDepartment,multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:r.i18n._("Branch"),in_column:2,field:"branch_id",layout_name:"global_branch",api_class:TTAPI.APIBranch,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:r.i18n._("Department"),field:"department_id",in_column:2,layout_name:"global_department",api_class:TTAPI.APIDepartment,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:r.i18n._("Title"),in_column:3,field:"title_id",layout_name:"global_job_title",api_class:TTAPI.APIUserTitle,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:r.i18n._("Show Pre-Mature"),in_column:3,field:"show_pre_mature",basic_search:!1,adv_search:!0,form_item_type:FormItemType.CHECKBOX})]}getFilterColumnsFromDisplayColumns(){var e={};return e.user_id=!0,e.date_stamp=!0,e.pay_period_id=!0,e.pay_period_schedule_id=!0,e.exception_color=!0,e.exception_background_color=!0,this._getFilterColumnsFromDisplayColumns(e,!0)}setGridCellBackGround(){var o;var e=(o=this.grid)==null?void 0:o.getGridParam("data");if(e)for(var t=e.length,a=0;a<t;a++){var i=e[a];if(i.exception_background_color){var n=r("tr[id='"+i.id+"']").find('td[aria-describedby="'+this.ui_id+'_grid_severity"]');n.css("background-color",i.exception_background_color),n.css("font-weight","bold")}if(i.exception_color){var l=r("tr[id='"+i.id+"']").find('td[aria-describedby="'+this.ui_id+'_grid_exception_policy_type_id"]');l.css("color",i.exception_color),l.css("font-weight","bold")}}}}u.loadView=function(){Global.loadViewSource("Exception","ExceptionView.html",function(_){var e={},t=s.template(_);Global.contentContainer().html(t(e))})};export{u as ExceptionViewController};
//# sourceMappingURL=ExceptionViewController-vnyt84FC.bundle.js.map
