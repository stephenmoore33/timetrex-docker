{"version":3,"file":"CurrencyViewController-DmdRCgMp.bundle.js","sources":["../../views/company/currency/CurrencyViewController.js"],"sourcesContent":["export class CurrencyViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#currency_view_container',\n\n\t\t\tstatus_array: null,\n\t\t\tiso_codes_array: null,\n\t\t\tround_decimal_places_array: null,\n\t\t\tsub_currency_rate_view_controller: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'CurrencyEditView.html';\n\t\tthis.permission_id = 'currency';\n\t\tthis.viewId = 'Currency';\n\t\tthis.script_name = 'CurrencyView';\n\t\tthis.table_name_key = 'currency';\n\t\tthis.context_menu_name = $.i18n._( 'Currencies' );\n\t\tthis.navigation_label = $.i18n._( 'Currency' );\n\t\tthis.api = TTAPI.APICurrency;\n\n\t\tthis.render();\n\t\tthis.buildContextMenu();\n\n\t\tthis.initData();\n\t}\n\n\tinitOptions() {\n\t\tvar $this = this;\n\n\t\tthis.initDropDownOption( 'status' );\n\t\tthis.initDropDownOption( 'round_decimal_places', 'round_decimal_places' );\n\t\tthis.api.getISOCodesArray( '', false, false, {\n\t\t\tonResult: function( res ) {\n\t\t\t\tres = res.getResult();\n\t\t\t\tres = Global.buildRecordArray( res );\n\t\t\t\t$this.basic_search_field_ui_dic['iso_code'].setSourceData( res );\n\t\t\t\t$this.iso_codes_array = res;\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_currency': { 'label': $.i18n._( 'Currency' ) },\n\t\t\t'tab_rates': {\n\t\t\t\t'label': $.i18n._( 'Rates' ),\n\t\t\t\t'init_callback': 'initSubCurrencyRateView',\n\t\t\t\t'display_on_mass_edit': false\n\t\t\t},\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APICurrency,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_currency',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_currency = this.edit_view_tab.find( '#tab_currency' );\n\n\t\tvar tab_currency_column1 = tab_currency.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_currency_column1 );\n\n\t\tvar form_item_input;\n\t\tvar widgetContainer;\n\n\t\t//Status\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'status_id' } );\n\t\tform_item_input.setSourceData( $this.status_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_currency_column1, '' );\n\n\t\t// ISO Currency\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'iso_code' } );\n\t\tform_item_input.setSourceData( $this.iso_codes_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'ISO Currency' ), form_item_input, tab_currency_column1 );\n\n\t\t//Name\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'name', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Name' ), form_item_input, tab_currency_column1 );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Base Currency\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'is_base' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Base Currency' ), form_item_input, tab_currency_column1 );\n\n\t\t// Conversion Rate\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'conversion_rate', width: 114 } );\n\n\t\twidgetContainer = $( '<div class=\\'\\'></div>' );\n\t\tvar conversion_rate_clarification_box = $( '<span id=\\'conversion_rate_clarification_box\\'></span>' );\n\n\t\twidgetContainer.append( form_item_input );\n\t\twidgetContainer.append( conversion_rate_clarification_box );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Conversion Rate' ), [form_item_input], tab_currency_column1, '', widgetContainer, false, true );\n\n\t\t// Default Currency\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'is_default' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Default Currency' ), form_item_input, tab_currency_column1 );\n\n\t\t// Auto Update\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'auto_update' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Auto Update' ), form_item_input, tab_currency_column1 );\n\n\t\t// Decimal Places\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'round_decimal_places' } );\n\t\tform_item_input.setSourceData( $this.round_decimal_places_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Decimal Places' ), form_item_input, tab_currency_column1, '' );\n\t}\n\n\tremoveEditView() {\n\t\tsuper.removeEditView();\n\n\t\tthis.sub_currency_rate_view_controller = null;\n\t}\n\n\tinitSubCurrencyRateView() {\n\t\tvar $this = this;\n\n\t\tif ( !this.current_edit_record.id ) {\n\t\t\tTTPromise.resolve( 'BaseViewController', 'onTabShow' ); //Since search() isn't called in this case, and we just display the \"Please Save This Record ...\" message, resolve the promise.\n\t\t\treturn;\n\t\t}\n\n\t\tif ( this.sub_currency_rate_view_controller ) {\n\t\t\tthis.sub_currency_rate_view_controller.buildContextMenu( true );\n\t\t\tthis.sub_currency_rate_view_controller.setDefaultMenu();\n\t\t\t$this.sub_currency_rate_view_controller.parent_key = 'currency_id';\n\t\t\t$this.sub_currency_rate_view_controller.parent_value = $this.current_edit_record.id;\n\t\t\t$this.sub_currency_rate_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.sub_currency_rate_view_controller.initData();\n\t\t\treturn;\n\t\t}\n\n\t\tGlobal.loadScript( 'views/company/currency/CurrencyRateViewController.js', function() {\n\t\t\tvar tab = $this.edit_view_tab.find( '#tab_rates' );\n\t\t\tvar firstColumn = tab.find( '.first-column-sub-view' );\n\t\t\tGlobal.trackView( 'Sub' + 'CurrencyRate' + 'View', LocalCacheData.current_doing_context_action );\n\t\t\tCurrencyRateViewController.loadSubView( firstColumn, beforeLoadView, afterLoadView );\n\t\t} );\n\n\t\tfunction beforeLoadView() {\n\n\t\t}\n\n\t\tfunction afterLoadView( subViewController ) {\n\t\t\t$this.sub_currency_rate_view_controller = subViewController;\n\t\t\t$this.sub_currency_rate_view_controller.parent_key = 'currency_id';\n\t\t\t$this.sub_currency_rate_view_controller.parent_value = $this.current_edit_record.id;\n\t\t\t$this.sub_currency_rate_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.sub_currency_rate_view_controller.parent_view_controller = $this;\n\t\t\t$this.sub_currency_rate_view_controller.initData();\n\n\t\t}\n\t}\n\n\tbuildSearchFields() {\n\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Status' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'status_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Name' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'name',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'ISO Currency' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'iso_code',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Created By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'created_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Updated By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'updated_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\t\t];\n\t}\n\n\tonFormItemChange( target, doNotValidate ) {\n\t\tif ( target.getField() == 'conversion_rate' ) {\n\t\t\tthis.setConversionRateExampleText( target.getValue(), this.edit_view_ui_dic.iso_code.getValue() );\n\t\t}\n\t\tsuper.onFormItemChange( target, doNotValidate );\n\t}\n\n\tinitEditView( editId, noRefreshUI ) {\n\t\tsuper.initEditView();\n\t\tthis.setConversionRateExampleText( this.edit_view_ui_dic.conversion_rate.getValue(), this.edit_view_ui_dic.iso_code.getValue() );\n\t}\n}\n"],"names":["CurrencyViewController","options","_","$","$this","res","tab_model","tab_currency","tab_currency_column1","form_item_input","widgetContainer","conversion_rate_clarification_box","tab","firstColumn","beforeLoadView","afterLoadView","subViewController","target","doNotValidate","editId","noRefreshUI"],"mappings":"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"}