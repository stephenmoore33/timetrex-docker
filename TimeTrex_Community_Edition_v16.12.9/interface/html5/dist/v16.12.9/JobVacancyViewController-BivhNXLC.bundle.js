import{_ as m,j as t}from"./vendor-tTApdY0Y.bundle.js";import{t as c}from"./content-Bx-gviSK.bundle.js";class v extends BaseViewController{constructor(i={}){m.defaults(i,{el:"#job_vacancy_view_container",status_array:null,type_array:null,level_array:null,employment_status_array:null,wage_type_array:null,availability_array:null,sub_job_vacancy_applicant_view_controller:null,document_object_type_id:null}),super(i)}init(i){this.edit_view_tpl="JobVacancyEditView.html",this.permission_id="job_vacancy",this.viewId="JobVacancy",this.script_name="JobVacancyView",this.table_name_key="job_vacancy",this.context_menu_name=t.i18n._("Job Vacancies"),this.navigation_label=t.i18n._("Job Vacancy"),this.api=TTAPI.APIJobVacancy,this.document_object_type_id=150;var a=this;a.render(),a.buildContextMenu(),a.initData()}initOptions(){var i=[{option_name:"status",api:this.api},{option_name:"type",api:this.api},{option_name:"level",api:this.api},{option_name:"employment_status",api:this.api},{option_name:"wage_type",api:this.api},{option_name:"availability",api:this.api}];this.initDropDownOptions(i)}getCustomContextMenuModel(){var i={exclude:[],include:[{label:t.i18n._("Jump To"),id:"jump_to_header",menu_align:"right",action_group:"jump_to",action_group_header:!0,permission_result:!1},{label:t.i18n._("Job Applications"),id:"job_application",menu_align:"right",action_group:"jump_to",group:"navigation",icon:"jobapplications-35x35.png",permission_result:!0,permission:null},{label:t.i18n._("Portal Preview"),id:"portal_preview",menu_align:"right",action_group:"jump_to",group:"navigation",icon:"reviews-35x35.png",permission_result:!0,permission:null}]};return i}onCustomContextClick(i){switch(i){case"download":this.onDownloadClick();break;case"map":this.onMapClick();break;case"job_application":case"portal_preview":this.onNavigationClick(i);break}}setCustomDefaultMenuIcon(i,a,n){switch(i){case"portal_preview":this.setDefaultMenuPortalViewIcon(a,n);break;case"job_application":this.setDefaultMenuEditIcon(a,n,"job_application");break}}setDefaultMenuPortalViewIcon(i,a,n){this.setMenuPortalViewIcon(i)}setEditMenuPortalViewIcon(i){this.setMenuPortalViewIcon(i)}setErrorMenuPortalViewIcon(i){this.setMenuPortalViewIcon(i)}setMenuPortalViewIcon(i){var a=this,n=this.getGridSelectIdArray(),o=n.length;if(o===1){var e=this.getRecordFromGridById(n[0]);r(e.id)}else(this.is_viewing||this.is_edit)&&this.current_edit_record&&this.current_edit_record.id?r(this.current_edit_record.id):ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,i.id,!1);function r(l){var d={};d.filter_data={},d.filter_data.id=[l],a.api["get"+a.api.key_name](d,{onResult:(function(s){var _=s.getResult();if(_||(_=[]),_=_[0],!_){ContextMenuManager.disableMenuItem(a.determineContextMenuMountAttributes().id,i.id,!1);return}(_.availability_id==20||_.availability_id==30)&&(_.status_id==20||_.status_id==40)?ContextMenuManager.disableMenuItem(a.determineContextMenuMountAttributes().id,i.id,!0):ContextMenuManager.disableMenuItem(a.determineContextMenuMountAttributes().id,i.id,!1)}).bind(a)})}}setErrorMenu(){for(var i=ContextMenuManager.getMenuModelByMenuId(this.determineContextMenuMountAttributes().id),a=i.length,n=0;n<a;n++){let o=i[n],e=i[n].id;switch(e!=="portal_preview"&&ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,o.id,!0),e){case"cancel":break;case"portal_preview":this.setErrorMenuPortalViewIcon(o);break;default:ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,o.id,!1);break}}}setCustomEditMenuIcon(i,a){switch(i){case"portal_preview":this.setEditMenuPortalViewIcon(a);break;case"job_application":this.setEditMenuNavEditIcon(a,"job_application");break}}onNavigationClick(i){var a=this.getGridSelectIdArray(),n=a.length,o=null;switch(n===1?o=this.getRecordFromGridById(a[0]):(this.is_viewing||this.is_edit)&&this.current_edit_record&&this.current_edit_record.id&&(o=this.current_edit_record),i){case"job_application":var e={filter_data:{}};o!=null&&(e.filter_data.job_vacancy_id=o.id,Global.addViewTab(this.viewId,t.i18n._("Job Vacancies"),window.location.href),IndexViewController.goToView("JobApplication",e));break;case"portal_preview":var r=Global.getBaseURL(!1,!1);o!=null&&(r+="portal/recruitment/#!m=PortalJobVacancyDetail&id="+o.id,r+="&company_id="+LocalCacheData.getCurrentCompany().short_name,window.open(r));break}}buildEditViewUI(){super.buildEditViewUI();var i=this,a={tab_vacancy:{label:t.i18n._("Job Vacancy"),html_template:this.getJobVacancyTabHtml(),is_multi_column:!0},tab_attachment:!0,tab_applications:{label:t.i18n._("Job Applications"),init_callback:"initSubApplicationView",display_on_mass_edit:!1},tab_audit:!0};this.setTabModel(a),this.navigation.AComboBox({api_class:TTAPI.APIJobVacancy,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_job_vacancy",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var n=this.edit_view_tab.find("#tab_vacancy"),o=n.find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(o);var e;e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"status_id"}),e.setSourceData(i.status_array),this.addEditFieldToColumn(t.i18n._("Status"),e,o,""),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn(t.i18n._("Name"),e,o),e.parent().width("45%"),e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIUserTitle,allow_multiple_selection:!1,layout_name:"global_user_title",field:"title_id",set_empty:!0,show_search_inputs:!0}),this.addEditFieldToColumn(t.i18n._("Title"),e,o),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"availability_id"}),e.setSourceData(i.availability_array),this.addEditFieldToColumn(t.i18n._("Availability"),e,o),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"employment_status_id"}),e.setSourceData(i.employment_status_array),this.addEditFieldToColumn(t.i18n._("Employment Status"),e,o),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"type_id"}),e.setSourceData(i.type_array),this.addEditFieldToColumn(t.i18n._("Type"),e,o),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"level_id"}),e.setSourceData(i.level_array),this.addEditFieldToColumn(t.i18n._("Level"),e,o),e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIBranch,allow_multiple_selection:!1,layout_name:"global_branch",field:"branch_id",set_empty:!0,show_search_inputs:!0}),this.addEditFieldToColumn(t.i18n._("Branch"),e,o),e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIDepartment,allow_multiple_selection:!1,layout_name:"global_department",field:"department_id",set_empty:!0,show_search_inputs:!0}),this.addEditFieldToColumn(t.i18n._("Department"),e,o),e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIUser,allow_multiple_selection:!1,layout_name:"global_user",field:"user_id",set_empty:!0,show_search_inputs:!0}),this.addEditFieldToColumn(t.i18n._("Hiring Manager"),e,o,"",null,!0),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"positions",width:50}),this.addEditFieldToColumn(t.i18n._("Positions Available"),e,o,"",null,!0);var r=n.find(".second-column");this.edit_view_tabs[0].push(r),e=Global.loadWidgetByName(FormItemType.DATE_PICKER),e.TDatePicker({field:"position_open_date"}),this.addEditFieldToColumn(t.i18n._("Position Open Date"),e,r),e=Global.loadWidgetByName(FormItemType.DATE_PICKER),e.TDatePicker({field:"position_expire_date"}),this.addEditFieldToColumn(t.i18n._("Position Expire Date"),e,r),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"wage_type_id"}),e.setSourceData(i.wage_type_array),this.addEditFieldToColumn(t.i18n._("Wage Type"),e,r),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"minimum_wage",width:150}),this.addEditFieldToColumn(t.i18n._("Minimum Wage"),e,r),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"maximum_wage",width:150}),this.addEditFieldToColumn(t.i18n._("Maximum Wage"),e,r),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"keywords",width:200}),this.addEditFieldToColumn(t.i18n._("Keywords"),e,r),e=Global.loadWidgetByName(FormItemType.TAG_INPUT),e.TTagInput({field:"tag",object_type_id:350}),this.addEditFieldToColumn(t.i18n._("Tags"),e,r,"",null,null,!0);var l=n.find(".fourth-column");this.edit_view_tabs[0].push(l),e=Global.loadWidgetByName(FormItemType.TEXT_AREA),e.TTextArea({field:"summary_description",rows:2}),this.addEditFieldToColumn(t.i18n._("Summary"),e,l,"",null,!0)}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:t.i18n._("Name"),field:"name",basic_search:!0,adv_search:!0,in_column:1,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:t.i18n._("Employee"),in_column:1,field:"user_id",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:t.i18n._("Status"),in_column:1,field:"status_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:t.i18n._("Type"),in_column:1,field:"type_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:t.i18n._("Employee Status"),in_column:1,field:"employee_status_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:t.i18n._("Availability"),in_column:1,field:"availability_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:t.i18n._("Title"),in_column:2,field:"title_id",layout_name:"global_user_title",api_class:TTAPI.APIUserTitle,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:t.i18n._("Branch"),in_column:2,field:"branch_id",layout_name:"global_branch",api_class:TTAPI.APIBranch,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:t.i18n._("Department"),in_column:2,field:"department_id",layout_name:"global_department",api_class:TTAPI.APIDepartment,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:t.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:t.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:t.i18n._("Tags"),field:"tag",basic_search:!0,adv_search:!0,in_column:2,object_type_id:350,form_item_type:FormItemType.TAG_INPUT})]}setCurrentEditRecordData(){TTPromise.add("job_vacancy","setCurrentEditRecordData");for(var i in this.current_edit_record)if(this.current_edit_record.hasOwnProperty(i)){i==="description"&&this.setDescription();var a=this.edit_view_ui_dic[i];if(Global.isSet(a))switch(i){case"country":this.eSetProvince(this.current_edit_record[i]),a.setValue(this.current_edit_record[i]);break;case"description":break;default:a.setValue(this.current_edit_record[i]);break}}this.collectUIDataToCurrentEditRecord();var n=this;TTPromise.wait("job_vacancy","setCurrentEditRecordData",function(){n.setEditViewDataDone()})}setEditViewDataDone(){this.moveFields(),super.setEditViewDataDone(),this.resizeSummaryField()}resizeSummaryField(){var i=this.edit_view_form_item_dic.summary_description,a=this.edit_view_ui_dic.summary_description,n=this.edit_view_tab.find("#tab_vacancy").find(".first-column").width(),o=this.edit_view_tab.find("#tab_vacancy").find(".second-column").width(),e=i.find(".edit-view-form-item-label-div"),r=e.width(),l=n+o-r+2;this.is_mass_editing==!0&&(l-=t(".mass-edit-checkbox").width()),a.width(l)}moveFields(){var i=this.edit_view_tab.find("#tab_vacancy").find(".second-column");this.edit_view_form_item_dic.user_id.appendTo(i),this.edit_view_form_item_dic.positions.appendTo(i)}setDescription(i){var a=this,n=t(Global.loadWidgetByName(WidgetNamesDic.EDIT_VIEW_FORM_ITEM)),o=n.find(".edit-view-form-item-label-div"),e=n.find(".edit-view-form-item-input-div"),r=n.find(".edit-view-form-item-label");r.text(t.i18n._("Description")),e.addClass("edit-view-form-item-tinymce-textarea-div");var l=this.edit_view_tab.find("#tab_vacancy"),d=l.find(".third-column");return d.html(n),this.edit_view_tabs[0].push(d),this.editFieldResize(0),o.css("height","340px"),o.css("width",o.width()+1),this.showDescription(),window.onresize=function(){this.edit_view&&(a.resizeSummaryField(),a.resizeMCE())},n}resizeMCE(){var i=this,a=this.edit_view_ui_dic.summary_description,n=a.width()+6;i.edit_view_tab.find("#tab_vacancy").find(".third-column").find(".edit-view-form-item-tinymce-textarea-div").width(n)}showDescription(){if(this.edit_view_tab){var i=this.edit_view_tab.find("#tab_vacancy").find(".third-column").find(".edit-view-form-item-label-div").width()+12,a=Global.loadWidgetByName(FormItemType.TINYMCE_TEXT_AREA,!0),n=this.current_edit_record.description,o=t(this.edit_view_tab.find(".edit-view-tab")[0]).width()-i,e={description:n,width:o-3+"px",height:"335px"},r=!1;this.is_viewing&&(r=!0);var l=m.template(a)(e);c.remove(),this.edit_view_tab.find("#tab_vacancy").find(".third-column").find(".edit-view-form-item-tinymce-textarea-div").html(l),c.editors=[],c.init({height:"335px",width:"100%",autoresize_min_width:o-3,selector:".tinymce-text-area",readonly:r,menubar:!1,statusbar:!1,plugins:"link",content_style:"body { font-size: 14px; margin-top: 0; color: #404042; padding: 0px; margin: 5px; }",setup:u=>{u.on("change",()=>{this.is_changed=!0})}});var d=this,s=this.edit_view_tab.find("#tab_vacancy").find(".third-column").find(".edit-view-form-item-tinymce-textarea-div");s.hide();var _=setInterval(function(){var u=s.find("iframe").contents().find("body");m.isUndefined(u[0])||(clearInterval(_),d.resizeSummaryField(),d.resizeMCE(),s.show(),TTPromise.resolve("job_vacancy","setCurrentEditRecordData"))},50)}}uniformVariable(i){return this.is_mass_editing||(i.description=c.activeEditor.getContent()),i}initSubApplicationView(){var i=this;if(!this.current_edit_record.id){TTPromise.resolve("BaseViewController","onTabShow");return}if(this.sub_job_vacancy_applicant_view_controller){this.sub_job_vacancy_applicant_view_controller.buildContextMenu(!0),this.sub_job_vacancy_applicant_view_controller.setDefaultMenu(),i.sub_job_vacancy_applicant_view_controller.parent_value=i.current_edit_record.id,i.sub_job_vacancy_applicant_view_controller.parent_edit_record=i.current_edit_record,i.sub_job_vacancy_applicant_view_controller.initData();return}TTPromise.add("initSubApplicationView","loadscript"),Global.loadScript("views/hr/recruitment/JobApplicationViewController.js",function(){var o=i.edit_view_tab.find("#tab_applications"),e=o.find(".first-column-sub-view");Global.trackView("SubJobApplicationView"),JobApplicationViewController.loadSubView(e,a,n)});function a(){}function n(o){i.sub_job_vacancy_applicant_view_controller=o,i.sub_job_vacancy_applicant_view_controller.parent_key="job_vacancy_id",i.sub_job_vacancy_applicant_view_controller.parent_value=i.current_edit_record.id,i.sub_job_vacancy_applicant_view_controller.parent_edit_record=i.current_edit_record,i.sub_job_vacancy_applicant_view_controller.parent_view_controller=i,i.sub_job_vacancy_applicant_view_controller.postInit=function(){this.initData(),TTPromise.resolve("initSubApplicationView","loadscript")}}}removeEditView(){super.removeEditView(),this.sub_job_vacancy_applicant_view_controller=null}onTabIndexChange(i,a){this.resizeSummaryField(),this.resizeMCE(),super.onTabIndexChange(i,a)}getJobVacancyTabHtml(){return`<div id="tab_vacancy" class="edit-view-tab-outside">
					<div class="edit-view-tab" id="tab_vacancy_content_div">
						<div class="first-column"></div>
						<div class="second-column"></div>
						<div class="fourth-column job-vacancy-summary-description"></div>
						<div class="third-column full-width-column"></div>
					</div>
				</div>`}}export{v as JobVacancyViewController};
//# sourceMappingURL=JobVacancyViewController-BivhNXLC.bundle.js.map
