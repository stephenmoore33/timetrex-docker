{"version":3,"file":"ProductViewController-DHrJkkOF.bundle.js","sources":["../../views/invoice/products/ProductViewController.js"],"sourcesContent":["export class ProductViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#product_view_container',\n\n\t\t\ttype_array: null,\n\t\t\tapply_frequency_array: null,\n\t\t\tmonth_of_year_array: null,\n\t\t\tday_of_month_array: null,\n\t\t\tday_of_week_array: null,\n\t\t\tlength_of_service_unit_array: null,\n\t\t\tdate_api: null,\n\t\t\tgroup_api: null,\n\n\t\t\tproduct_price_api: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'ProductEditView.html';\n\t\tthis.permission_id = 'product';\n\t\tthis.viewId = 'Product';\n\t\tthis.script_name = 'ProductView';\n\t\tthis.table_name_key = 'product';\n\t\tthis.context_menu_name = $.i18n._( 'Products' );\n\t\tthis.navigation_label = $.i18n._( 'Product' );\n\t\tthis.api = TTAPI.APIProduct;\n\t\tthis.date_api = TTAPI.APITTDate;\n\t\tthis.group_api = TTAPI.APIProductGroup;\n\t\tthis.product_price_api = TTAPI.APIProductPrice;\n\n\t\tthis.render();\n\t\tthis.buildContextMenu();\n\n\t\tthis.initData();\n\t}\n\n\tinitOptions( callBack ) {\n\t\tvar $this = this;\n\t\tvar options = [\n\t\t\t{ option_name: 'type', field_name: null, api: null },\n\t\t\t{ option_name: 'status', field_name: null, api: null },\n\t\t\t{ option_name: 'unit_price_type', field_name: null, api: null },\n\t\t\t{ option_name: 'weight_unit', field_name: null, api: null },\n\t\t\t{ option_name: 'dimension_unit', field_name: null, api: null },\n\t\t\t{ option_name: 'country', field_name: null, api: TTAPI.APICompany }\n\n\t\t];\n\n\t\tthis.initDropDownOptions( options, function( result ) {\n\n\t\t\t$this.group_api.getProductGroup( '', false, false, {\n\t\t\t\tonResult: function( res ) {\n\n\t\t\t\t\tres = res.getResult();\n\t\t\t\t\tres = Global.buildTreeRecord( res );\n\n\t\t\t\t\tif ( !$this.edit_only_mode ) {\n\t\t\t\t\t\tif ( !$this.sub_view_mode && $this.basic_search_field_ui_dic['group_id'] ) {\n\t\t\t\t\t\t\t$this.basic_search_field_ui_dic['group_id'].setSourceData( res );\n//\t\t\t\t\t\t$this.adv_search_field_ui_dic['group_id'].setSourceData( res );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t$this.group_array = res;\n\n\t\t\t\t\tif ( callBack ) {\n\t\t\t\t\t\tcallBack( result ); // First to initialize drop down options, and then to initialize edit view UI.\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t} );\n\n\t\t} );\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_product': { 'label': $.i18n._( 'Product' ) },\n\t\t\t'tab_pricing': {\n\t\t\t\t'label': $.i18n._( 'Pricing' ),\n\t\t\t\t'html_template': this.getProductPricingTabHtml()\n\t\t\t},\n\t\t\t'tab_shipping': { 'label': $.i18n._( 'Shipping' ) },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIProduct,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_product',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_product = this.edit_view_tab.find( '#tab_product' );\n\n\t\tvar tab_product_column1 = tab_product.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_product_column1 );\n\n\t\t//Type\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'type_id', set_empty: false } );\n\t\tform_item_input.setSourceData( $this.type_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Type' ), form_item_input, tab_product_column1, '' );\n\n\t\t//Status\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'status_id', set_empty: false } );\n\t\tform_item_input.setSourceData( $this.status_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_product_column1, '' );\n\n\t\t//Group\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\ttree_mode: true,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_tree_column',\n\t\t\tset_empty: true,\n\t\t\tfield: 'group_id'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.group_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Group' ), form_item_input, tab_product_column1 );\n\n\t\t//Part Number\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'part_number' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Part Number' ), form_item_input, tab_product_column1, '' );\n\n\t\t//Name\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'name', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Name' ), form_item_input, tab_product_column1, '' );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t//Description\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'description', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Description' ), form_item_input, tab_product_column1, '' );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Lock Description\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'description_locked' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Lock Description' ), form_item_input, tab_product_column1 );\n\n\t\t//UPC\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'upc' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'UPC' ), form_item_input, tab_product_column1, '' );\n\n\t\t//Current Stock\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'quantity' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Current Stock' ), form_item_input, tab_product_column1, '' );\n\n\t\t// Include Tax Policy\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APITaxPolicy,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_tax_policy',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'include_tax_policy'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Include Tax Policy' ), form_item_input, tab_product_column1, '' );\n\n\t\t// Exclude Tax Policy\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APITaxPolicy,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_tax_policy',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'exclude_tax_policy'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Exclude Tax Policy' ), form_item_input, tab_product_column1, '' );\n\n\t\t//Tags\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TAG_INPUT );\n\n\t\tform_item_input.TTagInput( { field: 'tag', object_type_id: 900 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Tags' ), form_item_input, tab_product_column1, '', null, null, true );\n\n\t\t//Tab 1 start\n\n\t\tvar tab_pricing = this.edit_view_tab.find( '#tab_pricing' );\n\n\t\tvar tab_pricing_column1 = tab_pricing.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[1] = [];\n\n\t\tthis.edit_view_tabs[1].push( tab_pricing_column1 );\n\n\t\t//Unit Cost\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'unit_cost', width: 80 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Unit Cost' ), form_item_input, tab_pricing_column1, '' );\n\n\t\t//Currency\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APICurrency,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_currency',\n\t\t\tshow_search_inputs: true,\n\t\t\tfield: 'currency_id'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Currency' ), form_item_input, tab_pricing_column1 );\n\n\t\t//Minimum Quantity\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'minimum_purchase_quantity', width: 80 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Minimum Quantity' ), form_item_input, tab_pricing_column1, '' );\n\n\t\t//Maximum Quantity\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'maximum_purchase_quantity', width: 80 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Maximum Quantity' ), form_item_input, tab_pricing_column1, '' );\n\n\t\t// Lock Price\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'price_locked' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Lock Price' ), form_item_input, tab_pricing_column1 );\n\n\t\t// Price Type\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'unit_price_type_id' } );\n\t\tform_item_input.setSourceData( $this.unit_price_type_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Price Type' ), form_item_input, tab_pricing_column1, '' );\n\n\t\t//Unit Price\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'unit_price', width: 80 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Unit Price' ), form_item_input, tab_pricing_column1, '', null, true );\n\n\t\t//Inside editor\n\t\tvar inside_editor_div = tab_pricing.find( '.inside-editor-div' );\n\t\tvar args = {\n\t\t\tquantity: $.i18n._( 'Quantity' ),\n\t\t\tunit_price: $.i18n._( 'Unit Price' )\n\n\t\t};\n\n\t\tthis.editor = Global.loadWidgetByName( FormItemType.INSIDE_EDITOR );\n\n\t\tthis.editor.InsideEditor( {\n\t\t\taddRow: this.insideEditorAddRow,\n\t\t\tremoveRow: this.insideEditorRemoveRow,\n\t\t\tgetValue: this.insideEditorGetValue,\n\t\t\tsetValue: this.insideEditorSetValue,\n\t\t\trender: getRender(),\n\t\t\trender_args: args,\n\t\t\trender_inline_html: true,\n\t\t\trow_render: getRowRender(),\n\t\t\tparent_controller: this\n\t\t} );\n\n\t\tfunction getRender() {\n\t\t\treturn `\n\t\t\t\t<table class=\"inside-editor-render\">\n\t\t\t\t\t<tr class=\"title\">\n\t\t\t\t\t\t<td style=\"width: 200px\"><%= quantity %></td>\n\t\t\t\t\t\t<td style=\"width: 200px\"><%= unit_price %></td>\n\t\t\t\t\t\t<td style=\"width: 25px\"></td>\n\t\t\t\t\t\t<td style=\"width: 25px\"></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>`;\n\t\t}\n\n\t\tfunction getRowRender() {\n\t\t\treturn `\n\t\t\t<tr class=\"inside-editor-row data-row\">\n\t\t\t\t<td class=\"quantity cell\"></td>\n\t\t\t\t<td class=\"unit-price cell\"></td>\n\t\t\t\t<td class=\"cell control-icon\">\n\t\t\t\t\t<button class=\"plus-icon\" onclick=\"\"></button>\n\t\t\t\t</td>\n\t\t\t\t<td class=\"cell control-icon\">\n\t\t\t\t\t<button class=\"minus-icon \" onclick=\"\"></button>\n\t\t\t\t</td>\n\t\t\t</tr>`;\n\t\t}\n\n\t\tinside_editor_div.append( this.editor );\n\n\t\t//Tab 2 start\n\n\t\tvar tab_shipping = this.edit_view_tab.find( '#tab_shipping' );\n\n\t\tvar tab_shipping_column1 = tab_shipping.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[2] = [];\n\n\t\tthis.edit_view_tabs[2].push( tab_shipping_column1 );\n\n\t\t// Weight Unit\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'weight_unit_id' } );\n\t\tform_item_input.setSourceData( $this.weight_unit_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Weight Unit' ), form_item_input, tab_shipping_column1, '' );\n\n\t\t//Weight\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'weight' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Weight' ), form_item_input, tab_shipping_column1, '' );\n\n\t\t// Dimension Unit\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'dimension_unit_id' } );\n\t\tform_item_input.setSourceData( $this.dimension_unit_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Dimension Unit' ), form_item_input, tab_shipping_column1, '' );\n\n\t\t//Length\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'dimension_length' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Length' ), form_item_input, tab_shipping_column1, '' );\n\n\t\t//Width\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'dimension_width' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Width' ), form_item_input, tab_shipping_column1, '' );\n\n\t\t//Height\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'dimension_height' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Height' ), form_item_input, tab_shipping_column1, '' );\n\n\t\t// Country\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'origin_country', set_empty: true } );\n\t\tform_item_input.setSourceData( $this.country_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Origin Country' ), form_item_input, tab_shipping_column1, '' );\n\n\t\t//Tariff Code\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'tariff_code' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Tariff Code' ), form_item_input, tab_shipping_column1, '' );\n\n\t\t//Custom Unit Value\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'customs_unit_value' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Custom Unit Value' ), form_item_input, tab_shipping_column1, '' );\n\t}\n\n\tonTypeChange() {\n\n\t\tif ( this.current_edit_record['type_id'] != 10 && this.current_edit_record.type_id != 62 ) {\n\t\t\t$( this.edit_view_tab.find( 'ul li' )[2] ).hide();\n\n\t\t\tif ( this.getEditViewTabIndex() == 2 ) {\n\t\t\t\tthis.edit_view_tab.tabs( 'option', 'active', 0 );\n\t\t\t}\n\n\t\t} else {\n\t\t\t$( this.edit_view_tab.find( 'ul li' )[2] ).show();\n\t\t}\n\n\t\tif ( ( this.current_edit_record['unit_price_type_id'] == 20 ||\n\t\t\tthis.current_edit_record.unit_price_type_id == 30 ) && !this.is_mass_editing ) {\n\n\t\t\tthis.detachElement( 'unit_price' );\n\t\t\tthis.editor.css( 'display', 'block' );\n\n\t\t} else {\n\n\t\t\tthis.attachElement( 'unit_price' );\n\t\t\tthis.editor.css( 'display', 'none' );\n\t\t}\n\n\t\tthis.editFieldResize();\n\t}\n\n\tonFormItemChange( target, doNotValidate ) {\n\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\t\tvar key = target.getField();\n\t\tvar c_value = target.getValue();\n\t\tthis.current_edit_record[key] = c_value;\n\t\tif ( key === 'type_id' || key === 'unit_price_type_id' ) {\n\n\t\t\tthis.onTypeChange();\n\t\t}\n\n\t\tif ( !doNotValidate ) {\n\t\t\tthis.validate();\n\t\t}\n\t}\n\n\tinsideEditorSetValue( val ) {\n\t\tvar len = val.length;\n\n\t\tthis.removeAllRows();\n\t\tfor ( var i = 0; i < val.length; i++ ) {\n\t\t\tif ( Global.isSet( val[i] ) ) {\n\t\t\t\tvar row = val[i];\n\t\t\t\trow['accrual_rate'] = Global.getTimeUnit( row['accrual_rate'] );\n\t\t\t\trow['maximum_time'] = Global.getTimeUnit( row['maximum_time'] );\n\t\t\t\trow['rollover_time'] = Global.getTimeUnit( row['rollover_time'] );\n\t\t\t\tif ( Global.isSet( this.parent_id ) ) {\n\t\t\t\t\trow['id'] = '';\n\t\t\t\t}\n\t\t\t\tthis.addRow( row );\n\t\t\t}\n\n\t\t}\n\t}\n\n\tinsideEditorAddRow( data, index ) {\n\n\t\tif ( !data ) {\n\t\t\tdata = {};\n\t\t}\n\n\t\tvar $this = this;\n\t\tvar row = this.getRowRender(); //Get Row render\n\t\tvar render = this.getRender(); //get render, should be a table\n\t\tvar widgets = {}; //Save each row's widgets\n\n\t\tvar form_item_input;\n\t\tvar widgetContainer;\n\t\tvar label;\n\n\t\t//Build row widgets\n\n\t\t// Quantity\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'quantity', width: 60 } );\n\t\tform_item_input.setValue( data.quantity ? data.quantity : 0 );\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\tlabel = $( '<span class=\\'widget-right-label\\'> ' + $.i18n._( 'or more' ) + '</span>' );\n\n\t\twidgetContainer.append( form_item_input );\n\t\twidgetContainer.append( label );\n\n\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\trow.children().eq( 0 ).append( widgetContainer );\n\n\t\tthis.setWidgetEnableBaseOnParentController( form_item_input );\n\n\t\t// Unit Price\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'unit_price', width: 60 } );\n\t\tform_item_input.setValue( data.unit_price ? data.unit_price : '0.00' );\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\twidgetContainer.append( form_item_input );\n\n\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\trow.children().eq( 1 ).append( widgetContainer );\n\n\t\tthis.setWidgetEnableBaseOnParentController( form_item_input );\n\n\t\twidgets.current_edit_item = data;\n\n\t\tif ( !this.parent_controller.current_edit_record.id ) {\n\t\t\twidgets.current_edit_item.id = '';\n\t\t}\n\n\t\tif ( typeof index != 'undefined' ) {\n\n\t\t\trow.insertAfter( $( render ).find( 'tr' ).eq( index ) );\n\t\t\tthis.rows_widgets_array.splice( ( index ), 0, widgets );\n\n\t\t} else {\n\t\t\t$( render ).append( row );\n\t\t\tthis.rows_widgets_array.push( widgets );\n\t\t}\n\t\tif ( this.parent_controller.is_viewing ) {\n\t\t\trow.find( '.control-icon' ).hide();\n\t\t}\n\n\t\tthis.addIconsEvent( row ); //Bind event to add and minus icon\n\t\tthis.removeLastRowLine();\n\t}\n\n\tinsideEditorRemoveRow( row ) {\n\t\tvar index = row[0].rowIndex - 1;\n\t\tvar remove_id = this.rows_widgets_array[index].current_edit_item.id;\n\t\tif ( TTUUID.isUUID( remove_id ) && remove_id != TTUUID.zero_id && remove_id != TTUUID.not_exist_id ) {\n\t\t\tthis.delete_ids.push( remove_id );\n\t\t}\n\t\trow.remove();\n\t\tthis.rows_widgets_array.splice( index, 1 );\n\t\tthis.removeLastRowLine();\n\t}\n\n\tinsideEditorGetValue( current_edit_item_id ) {\n\t\tvar len = this.rows_widgets_array.length;\n\t\tvar result = [];\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar row = this.rows_widgets_array[i];\n\t\t\tvar data = row.current_edit_item;\n\t\t\tdata.quantity = row.quantity.getValue();\n\t\t\tdata.unit_price = row.unit_price.getValue();\n\t\t\tdata.product_id = current_edit_item_id;\n\t\t\tresult.push( data );\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsetEditViewDataDone() {\n\t\tsuper.setEditViewDataDone();\n\t\tthis.onTypeChange();\n\t\tthis.initInsideEditorData();\n\t}\n\n\tinitInsideEditorData() {\n\t\tvar $this = this;\n\t\tvar args = {};\n\t\targs.filter_data = {};\n\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) && !this.copied_record_id ) {\n\t\t\t$this.editor.removeAllRows();\n\t\t\t$this.editor.addRow();\n\n\t\t} else {\n\t\t\targs.filter_data.product_id = this.current_edit_record.id ? this.current_edit_record.id : this.copied_record_id;\n\t\t\tthis.copied_record_id = '';\n\t\t\tthis.product_price_api.getProductPrice( args, true, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tif ( !$this.edit_view ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar data = res.getResult();\n\t\t\t\t\tif ( data === true ) { // result is null\n\t\t\t\t\t\t$this.editor.addRow();\n\t\t\t\t\t} else if ( data.length > 0 ) {\n\t\t\t\t\t\t$this.editor.setValue( data );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tsaveInsideEditorData( callBack ) {\n\t\tif ( ( this.current_edit_record['unit_price_type_id'] != 20 &&\n\t\t\tthis.current_edit_record.unit_price_type_id != 30 ) || this.is_mass_editing ) {\n\t\t\tif ( Global.isSet( callBack ) ) {\n\t\t\t\tcallBack();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tvar $this = this;\n\t\tvar data = this.editor.getValue( this.refresh_id );\n\t\tvar remove_ids = $this.editor.delete_ids;\n\t\tif ( remove_ids.length > 0 ) {\n\t\t\t$this.product_price_api.deleteProductPrice( remove_ids, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tif ( res && res.isValid() ) {\n\t\t\t\t\t\t$this.editor.delete_ids = [];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\t$this.product_price_api.setProductPrice( data, {\n\t\t\tonResult: function( res ) {\n\t\t\t\tvar res_data = res.getResult();\n\t\t\t\tif ( Global.isSet( callBack ) ) {\n\t\t\t\t\tcallBack();\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tonSaveResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result && result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true && $this.current_edit_record.id ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id; // as add\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) { // as new\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t} else {\n\t\t\t\t//Issue #3327 - Exception can occur above where $this.current_edit_record.id fails as $this.current_edit_record is null.\n\t\t\t\t//The exact cause is unknown, however it seems the user clicked the pricing tab multiple times after clicking save and before the save was complete.\n\t\t\t\t//This causes $this.refresh_id to potentially not be set and cause $this.saveInsideEditorData() to fail.\n\t\t\t\tDebug.Arr( this.current_edit_record, 'ERROR: Unable to determine refresh_id after save! Current edit record: ', 'ProductViewController.js', 'ProductViewController', 'onSaveResult', 10 );\n\t\t\t\tDebug.Arr( result_data, 'ERROR: Unable to determine refresh_id after save! result_data: ', 'ProductViewController.js', 'ProductViewController', 'onSaveResult', 10 );\n\t\t\t}\n\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.search();\n\t\t\t\t$this.onSaveDone( result );\n\n\t\t\t\t$this.removeEditView();\n\t\t\t} );\n\n\t\t} else {\n\t\t\t$this.setErrorTips( result );\n\t\t\t$this.setErrorMenu();\n\t\t}\n\t}\n\n\t// onSaveAndContinueResult( result ) {\n\t//\n\t// \tvar $this = this;\n\t// \tif ( result.isValid() ) {\n\t// \t\tvar result_data = result.getResult();\n\t// \t\tif ( result_data === true ) {\n\t// \t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t//\n\t// \t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) { // as new\n\t// \t\t\t$this.refresh_id = result_data;\n\t// \t\t}\n\t//\n\t// \t\t$this.saveInsideEditorData( function() {\n\t// \t\t\t$this.search( false );\n\t// \t\t\t$this.onEditClick( $this.refresh_id, true );\n\t//\n\t// \t\t\t$this.onSaveAndContinueDone( result );\n\t//\n\t// \t\t} );\n\t//\n\t// \t} else {\n\t// \t\t$this.setErrorTips( result );\n\t// \t\t$this.setErrorMenu();\n\t// \t}\n\t// },\n\n\t// onSaveAndNewResult: function( result ) {\n\t// \tvar $this = this;\n\t// \tif ( result.isValid() ) {\n\t// \t\tvar result_data = result.getResult();\n\t// \t\tif ( result_data === true ) {\n\t// \t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t//\n\t// \t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) { // as new\n\t// \t\t\t$this.refresh_id = result_data;\n\t// \t\t}\n\t//\n\t// \t\t$this.saveInsideEditorData( function() {\n\t// \t\t\t$this.search( false );\n\t// \t\t\t$this.onAddClick( true );\n\t//\n\t// \t\t} );\n\t// \t} else {\n\t// \t\t$this.setErrorTips( result );\n\t// \t\t$this.setErrorMenu();\n\t// \t}\n\t// },\n\n\tonSaveAndCopyResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result && result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.search( false );\n\t\t\t\t$this.onCopyAsNewClick();\n\n\t\t\t} );\n\n\t\t} else {\n\t\t\t$this.setErrorTips( result );\n\t\t\t$this.setErrorMenu();\n\t\t}\n\t}\n\n\t// onSaveAndNextResult( result ) {\n\t// \tvar $this = this;\n\t// \tif ( result.isValid() ) {\n\t// \t\tvar result_data = result.getResult();\n\t// \t\tif ( result_data === true ) {\n\t// \t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t//\n\t// \t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t// \t\t\t$this.refresh_id = result_data;\n\t// \t\t}\n\t//\n\t// \t\t$this.saveInsideEditorData( function() {\n\t// \t\t\t$this.onRightArrowClick();\n\t// \t\t\t$this.search( false );\n\t// \t\t\t$this.onSaveAndNextDone( result );\n\t//\n\t// \t\t} );\n\t//\n\t// \t} else {\n\t// \t\t$this.setErrorTips( result );\n\t// \t\t$this.setErrorMenu();\n\t// \t}\n\t// },\n\n\t_continueDoCopyAsNew() {\n\t\tthis.setCurrentEditViewState( 'new' );\n\t\tLocalCacheData.current_doing_context_action = 'copy_as_new';\n\n\t\tif ( Global.isSet( this.edit_view ) ) {\n\t\t\tfor ( var i = 0; i < this.editor.rows_widgets_array.length; i++ ) {\n\t\t\t\tthis.editor.rows_widgets_array[i].current_edit_item.id = '';\n\t\t\t}\n\t\t}\n\t\tsuper._continueDoCopyAsNew();\n\t}\n\n\tonCopyAsNewResult( result ) {\n\t\tvar $this = this;\n\t\tvar result_data = result.getResult();\n\n\t\tif ( !result_data ) {\n\t\t\tTAlertManager.showAlert( $.i18n._( 'Record does not exist' ) );\n\t\t\t$this.onCancelClick();\n\t\t\treturn;\n\t\t}\n\n\t\t$this.openEditView(); // Put it here is to avoid if the selected one is not existed in data or have deleted by other pragram. in this case, the edit view should not be opend.\n\n\t\tresult_data = result_data[0];\n\t\tthis.copied_record_id = result_data.id;\n\t\tresult_data.id = '';\n\n\t\tif ( $this.sub_view_mode && $this.parent_key ) {\n\t\t\tresult_data[$this.parent_key] = $this.parent_value;\n\t\t}\n\n\t\t$this.current_edit_record = result_data;\n\t\t$this.initEditView();\n\t}\n\n\tbuildSearchFields() {\n\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Name' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'name',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Type' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'type_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Status' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'status_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Group' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tmultiple: true,\n\t\t\t\tfield: 'group_id',\n\t\t\t\tlayout_name: 'global_tree_column',\n\t\t\t\ttree_mode: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Tags' ),\n\t\t\t\tfield: 'tag',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tin_column: 1,\n\t\t\t\tobject_type_id: 900,\n\t\t\t\tform_item_type: FormItemType.TAG_INPUT\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Part Number' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'part_number',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Description' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'description',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Created By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'created_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Updated By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'updated_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\t\t];\n\t}\n\n\tgetProductPricingTabHtml() {\n\t\treturn `<div id=\"tab_pricing\" class=\"edit-view-tab-outside\">\n\t\t\t\t\t<div class=\"edit-view-tab\" id=\"tab_pricing_content_div\">\n\t\t\t\t\t\t<div class=\"first-column full-width-column\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"inside-editor-div full-width-column\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`;\n\t}\n}\n"],"names":["ProductViewController","options","_","$","callBack","$this","result","res","tab_model","tab_product","tab_product_column1","form_item_input","tab_pricing","tab_pricing_column1","inside_editor_div","args","getRender","getRowRender","tab_shipping","tab_shipping_column1","target","doNotValidate","key","c_value","val","i","row","data","index","render","widgets","widgetContainer","label","remove_id","current_edit_item_id","len","remove_ids","result_data"],"mappings":"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"}