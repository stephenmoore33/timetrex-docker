import{_ as c,j as a}from"./vendor-tTApdY0Y.bundle.js";class v extends ReportBaseViewController{constructor(e={}){c.defaults(e,{form_setup_ui_dic:{},form_setup_data:{},save_form_setup_data:{}}),super(e)}initReport(e){this.script_name="USEEOReport",this.viewId="USEEOReport",this.context_menu_name=a.i18n._("US EEO"),this.navigation_label=a.i18n._("Saved Report")+":",this.view_file="USEEOReportView.html",this.api=TTAPI.APIUSEEOReport,this.api_paystub=TTAPI.APIPayStubEntryAccount,this.authentication_api=TTAPI.APIAuthentication,this.include_form_setup=!0,this.form_setup_data={}}initOptions(e){var t=[{option_name:"page_orientation"},{option_name:"font_size"},{option_name:"auto_refresh"},{option_name:"chart_display_mode"},{option_name:"chart_type"},{option_name:"templates"},{option_name:"setup_fields"},{option_name:"export_type"},{option_name:"eeo1_report_type"}];this.initDropDownOptions(t,function(i){e(i)})}getCustomContextMenuModel(){var e={groups:{form:{label:a.i18n._("Export"),id:this.viewId+"Form"}},exclude:[],include:[{label:a.i18n._("Export"),id:"export_export",group:"editor",vue_icon:"tticon tticon-file_upload_black_24dp",menu_align:"right"},{label:a.i18n._("Save Setup"),id:"save_setup",group:"form",vue_icon:"tticon tticon-settings_black_24dp",menu_align:"right",sort_order:3e3},{label:"",id:"other_header",menu_align:"right",action_group:"other",action_group_header:!0,vue_icon:"tticon tticon-more_vert_black_24dp",sort_order:4e3},{label:a.i18n._("Create Custom Fields"),id:"generate_custom_fields",menu_align:"right",action_group:"other",permission_result:!0,permission:null}]};return e}onContextMenuClick(e,t){var i;if(Global.isSet(t))i=t;else if(e.disabled)return;this.select_grid_last_row&&(this.export_grid.grid.jqGrid("saveRow",this.select_grid_last_row),this.select_grid_last_row=null);var _=a.i18n._("Setup data for this report has not been configured yet. Please click on the Form Setup tab to do so now.");switch(i){case"view":ProgressBar.showOverlay(),this.onViewClick(null,!1,_);break;case"view_html":ProgressBar.showOverlay(),this.onViewClick("html",!1,_);break;case"view_html_new_window":this.onViewClick("html",!1,_);break;case"export_excel":this.onViewExcelClick(_);break;case"export_export":ProgressBar.showOverlay(),this.onViewClick("efile",!1,_);break;case"generate_custom_fields":this.generateCustomFields();break;case"cancel":this.onCancelClick();break;case"save_existed_report":this.onSaveExistedReportClick();break;case"save_new_report":this.onSaveNewReportClick();break;case"save_setup":this.onSaveSetup(a.i18n._("Form setup"));break}Global.triggerAnalyticsContextMenuClick(e,t)}generateCustomFields(){let e=this;this.api.generateCustomFields(this.edit_view_ui_dic.export_type.getValue(),{onResult:function(t){Global.refreshCustomFieldCache(),Global.clearCache("export_type_codes"),e.onFormSetupChange(e.edit_view_ui_dic.export_type.getValue()),TAlertManager.showAlert(a.i18n._("Custom fields created successfully."),a.i18n._("Create Custom Fields"))}})}buildEditViewUI(){super.buildEditViewUI();var e=this.edit_view.find("a[ref=tab_form_setup]");e.text(a.i18n._("Form Setup"))}buildFormSetupUI(){var e=this,t=this.edit_view_tab.find("#tab_form_setup"),i=t.find(".first-column");this.edit_view_tabs[3]=[],this.edit_view_tabs[3].push(i);var _=Global.loadWidgetByName(FormItemType.COMBO_BOX);_.TComboBox({field:"export_type",set_empty:!1}),_.setSourceData(e.export_type_array),this.addEditFieldToColumn(a.i18n._("Format"),_,i,""),_.bind("formItemChange",function(u,o){e.onFormSetupChange(o.getValue())})}onFormSetupChange(e){var t=this;switch(this.removeCurrentFormSetupUI(),this.form_setup_ui_dic={},e){case"eeo1":var i=this.edit_view_tab.find("#tab_form_setup"),_=i.find(".first-column");this.edit_view_tabs[3]=[],this.edit_view_tabs[3].push(_);var u="form_setup_"+e+"_report_type",o=Global.loadWidgetByName(FormItemType.COMBO_BOX);o.TComboBox({field:u,set_empty:!1}),o.setSourceData(t.eeo1_report_type_array),this.addEditFieldToColumn(a.i18n._("Type"),o,_,"",null,!0),this.setWidgetVisible([o]),this.form_setup_ui_dic[u]=this.edit_view_form_item_dic[u],delete this.edit_view_form_item_dic[u],this.save_form_setup_data&&this.save_form_setup_data.eeo1&&o.setValue(this.save_form_setup_data.eeo1.report_type),t.buildAdditionalCustomInputBox(e,"company_id",a.i18n._("Company ID")),t.buildAdditionalCustomInputBox(e,"establishment_id",a.i18n._("Establishment ID")),t.buildAdditionalCustomInputBox(e,"establishment_uei",a.i18n._("Federal Contractor UEI")),t.buildAdditionalCustomInputBox(e,"job_category",a.i18n._("Job Category")),t.buildAdditionalCustomInputBox(e,"ethnicity",a.i18n._("Race/Ethnicity"));break;case"eeo4":t.buildAdditionalCustomInputBox(e,"function",a.i18n._("Function")),t.buildAdditionalCustomInputBox(e,"job_category",a.i18n._("Job Category")),t.buildAdditionalCustomInputBox(e,"ethnicity",a.i18n._("Race/Ethnicity")),t.buildAdditionalCustomInputBox(e,"employment_status",a.i18n._("Employment Status")),t.buildIncludeExcludeDropdown(e,"regular_earning","pay_stub_entry_account",a.i18n._("Regular Earnings"));break;case"eeo_ca":t.buildAdditionalCustomInputBox(e,"establishment_id",a.i18n._("Establishment ID")),t.buildAdditionalCustomInputBox(e,"establishment_is_hq",a.i18n._("Establishment Headquarters")),t.buildAdditionalCustomInputBox(e,"naics_code",a.i18n._("NAICS Code")),t.buildAdditionalCustomInputBox(e,"major_activity",a.i18n._("Major Activity")),t.buildAdditionalCustomInputBox(e,"job_category",a.i18n._("Job Category")),t.buildAdditionalCustomInputBox(e,"ethnicity",a.i18n._("Race/Ethnicity")),t.buildIncludeExcludeDropdown(e,"regular_earning","pay_stub_entry_account",a.i18n._("Regular Earnings"));break;default:this.edit_view_tab.find("#tab_form_setup .first-column").append('<div id="no-setup-data" style="font-weight: bold; text-align:center">'+a.i18n._("No form setup required for this format.")+"</div>");break}}onFormItemChange(e,t){if(e&&e.getField&&e.getField()=="export_type"){var i={};i.export_type=this.current_edit_record.export_type,i[i.export_type]={},this.form_setup_changed=!0;return}super.onFormItemChange(e,t)}setFormSetupData(e){if(e||(this.show_empty_message=!0),this.save_form_setup_data=e,e.export_type&&this.edit_view_ui_dic.export_type){this.edit_view_ui_dic.export_type.setValue(e.export_type),this.onFormSetupChange(e.export_type);let t=`form_setup_${e.export_type}_`,i=this.processFormSetupDataAndAddToBatch(e,[{data:c.get(e,[e.export_type,"regular_earning"]),field_key:t+"regular_earning",api:this.api_paystub,api_method:"getPayStubEntryAccount"},{data:c.get(e,[e.export_type,"regular_earning"]),field_key:t+"regular_earning",api:this.api_paystub,api_method:"getPayStubEntryAccount"}]);this.getBatchedRealFormDataFromAPI(i)}else Array.isArray(this.export_type_array)&&this.export_type_array.length>0&&this.onFormSetupChange(this.export_type_array[0].value)}buildAdditionalCustomInputBox(e,t,i){this.save_form_setup_data||(this.save_form_setup_data={}),this.save_form_setup_data[e]||(this.save_form_setup_data[e]={});var _=this,u=this.edit_view_tab.find("#tab_form_setup"),o=u.find(".first-column");this.edit_view_tabs[3]=[],this.edit_view_tabs[3].push(o);var l="form_setup_"+e+"_"+t,r=Global.loadWidgetByName(FormItemType.COMBO_BOX);r.TComboBox({field:l});var n=a("<div class='h-box'></div>"),s=Global.loadWidgetByName(FormItemType.TEXT_INPUT);s.css("margin-left","10px"),s.TTextInput({field:l+"_text"}),n.append(r),n.append(s),this.addEditFieldToColumn(a.i18n._(i),[r,s],o,"",n,!0),this.setWidgetVisible([r,s]),r.bind("formItemChange",(m,d)=>{d.getValue()===0?(_.save_form_setup_data[e][t]&&s.setValue(_.save_form_setup_data[e][t]),s.css("display","inline")):(s.css("display","none"),s.setValue(""))}),this.api.getOptions("export_type_codes",{onResult:m=>{var d=m.getResult();r.setSourceData(Global.buildRecordArray(d)),this.save_form_setup_data[e]&&this.save_form_setup_data[e][t]&&r.setValue(this.save_form_setup_data[e][t]),r.trigger("formItemChange",[r,!0])}}),this.form_setup_ui_dic[l]=this.edit_view_form_item_dic[l],delete this.edit_view_form_item_dic[l],this.editFieldResize(3)}buildIncludeExcludeDropdown(e,t,i,_){var u=this.edit_view_tab.find("#tab_form_setup"),o=u.find(".first-column"),l="form_setup_"+e+"_"+t+"_include_"+i,r="form_setup_"+e+"_"+t+"_exclude_"+i,n=a("<div class='v-box'></div>"),s=Global.loadWidgetByName(FormItemType.AWESOME_BOX);s.AComboBox({api_class:TTAPI.APIPayStubEntryAccount,allow_multiple_selection:!0,layout_name:"global_PayStubAccount",show_search_inputs:!0,set_empty:!0,field:l});var m=this.putInputToInsideFormItem(s,a.i18n._("Include"));n.append(m),n.append("<div class='clear-both-div'></div>");var d=Global.loadWidgetByName(FormItemType.AWESOME_BOX);d.AComboBox({api_class:TTAPI.APIPayStubEntryAccount,allow_multiple_selection:!0,layout_name:"global_PayStubAccount",show_search_inputs:!0,set_empty:!0,field:r}),m=this.putInputToInsideFormItem(d,a.i18n._("Exclude")),n.append(m),this.addEditFieldToColumn(_,[s,d],o,"",n,!1,!0),this.setWidgetVisible([s,d]),this.form_setup_ui_dic["form_setup_"+e+"_"+t+"_"+i]=n.parent().parent(),this.save_form_setup_data[e][t]&&this.save_form_setup_data[e][t]["include_"+i]&&this.edit_view_ui_dic[l].setValue(this.save_form_setup_data[e][t]["include_"+i]),this.save_form_setup_data[e][t]&&this.save_form_setup_data[e][t]["exclude_"+i]&&this.edit_view_ui_dic[r].setValue(this.save_form_setup_data[e][t]["exclude_"+i]),this.editFieldResize(3)}removeCurrentFormSetupUI(){for(var e in this.form_setup_ui_dic){var t=this.form_setup_ui_dic[e];t.remove()}if(a("#no-setup-data").remove(),!!this.edit_view_tab){var i=this.edit_view_tab.find("#tab_form_setup"),_=i.find(".first-column"),u=_.find(".clear-both-div");u.remove()}}getFormSetupFieldValues(e,t){for(var i={},_=0;_<t.length;_++)this.edit_view_ui_dic["form_setup_"+e+"_"+t[_]]&&!this.edit_view_ui_dic["form_setup_"+e+"_"+t[_]].getValue()?(i[t[_]]=this.edit_view_ui_dic["form_setup_"+e+"_"+t[_]+"_text"].getValue(),i[t[_]+"_value"]=this.edit_view_ui_dic["form_setup_"+e+"_"+t[_]+"_text"].getValue()):this.edit_view_ui_dic["form_setup_"+e+"_"+t[_]]?i[t[_]]=this.edit_view_ui_dic["form_setup_"+e+"_"+t[_]].getValue():i[t[_]]="";return this.edit_view_ui_dic["form_setup_"+e+"_regular_earning_include_pay_stub_entry_account"]&&(i.regular_earning={include_pay_stub_entry_account:this.edit_view_ui_dic["form_setup_"+e+"_regular_earning_include_pay_stub_entry_account"].getValue(),exclude_pay_stub_entry_account:this.edit_view_ui_dic["form_setup_"+e+"_regular_earning_exclude_pay_stub_entry_account"].getValue()}),i}getFormData(e,t){if(!e||!e.export_type)return!1;if(e[e.export_type]=this.getFormSetupFieldValues(e.export_type,this.getFieldList(e.export_type)),this.save_form_setup_data||(this.save_form_setup_data={}),this.save_form_setup_data[e.export_type]=e[e.export_type],this.save_form_setup_data.export_type=e.export_type,t)for(var i in this.save_form_setup_data)i!==!1&&typeof this.save_form_setup_data[i]!="string"&&(this.save_form_setup_data[i]=this.convertFormSetupValues(this.save_form_setup_data[i]));return this.save_form_setup_data}getFieldList(e){var t=[];switch(e){case"eeo1":t=["report_type","company_id","establishment_id","establishment_uei","naics_code","job_category","ethnicity"];break;case"eeo4":t=["function","job_category","ethnicity","employment_status"];break;case"eeo_ca":t=["establishment_id","establishment_is_hq","naics_code","major_activity","job_category","ethnicity"];break}return t}getFormSetupData(e){var t={};return t.export_type=this.edit_view_ui_dic.export_type.getValue(),t[t.export_type]={},t=this.getFormData(t,!0),t}convertFormSetupValues(e){for(var t in e){var i=t.substr(0,t.indexOf("_value"));t.search("_value")>0&&(e[i]=e[t])}return e.form_setup_columns&&!e.columns&&e.export_type!=0&&e.form_setup_columns[e.export_type]&&(e.columns={},e.columns=e.form_setup_columns[e.export_type].columns),e}}export{v as USEEOReportViewController};
//# sourceMappingURL=USEEOReportViewController-B8VqqgRc.bundle.js.map
