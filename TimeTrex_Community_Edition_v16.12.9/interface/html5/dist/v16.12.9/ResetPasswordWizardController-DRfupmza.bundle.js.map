{"version":3,"file":"ResetPasswordWizardController-DRfupmza.bundle.js","sources":["../../views/wizard/reset_password/ResetPasswordWizardController.js"],"sourcesContent":["export class ResetPasswordWizardController extends BaseWizardController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '.wizard'\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.title = $.i18n._( 'Reset Password' );\n\t\tthis.steps = 1;\n\t\tthis.current_step = 1;\n\t\tif ( this.default_data && typeof this.default_data.api_class != 'undefined' ) {\n\t\t\tthis.api = this.default_data.api_class;\n\t\t} else {\n\t\t\tthis.api = TTAPI.APIAuthentication;\n\t\t}\n\t\tthis.render();\n\t}\n\n\trender() {\n\t\tsuper.render();\n\n\t\tthis.initCurrentStep();\n\t}\n\n\tbuildCurrentStepUI() {\n\n\t\tvar $this = this;\n\t\tthis.content_div.empty();\n\n\t\tthis.stepsWidgetDic[this.current_step] = {};\n\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tvar label = this.getLabel();\n\t\t\t\t//Error: TypeError: this.default_data is null in interface/html5/framework/jquery.min.js?v=9.0.0-20151016-110437 line 2 > eval line 32\n\t\t\t\tlabel.text( this.default_data ? this.default_data.message : '' );\n\t\t\t\tthis.content_div.append( label );\n\n\t\t\t\tvar form_item = $( Global.loadWidget( 'global/widgets/wizard_form_item/WizardFormItem.html' ) );\n\t\t\t\tvar form_item_label = form_item.find( '.form-item-label' );\n\t\t\t\tvar form_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\t\t\tvar user_name = this.getText();\n\n\t\t\t\tuser_name.text( this.default_data ? this.default_data.user_name : '' );\n\n\t\t\t\tform_item_label.text( $.i18n._( 'User Name' ) );\n\t\t\t\tform_item_input_div.append( user_name );\n\n\t\t\t\tthis.content_div.append( form_item );\n\n\t\t\t\tform_item = $( Global.loadWidget( 'global/widgets/wizard_form_item/WizardFormItem.html' ) );\n\t\t\t\tform_item_label = form_item.find( '.form-item-label' );\n\t\t\t\tform_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\t\t\tvar current_password = this.getPasswordInput( 'current_password' );\n\n\t\t\t\tform_item_label.text( $.i18n._( 'Current Password' ) );\n\t\t\t\tform_item_input_div.append( current_password );\n\n\t\t\t\tthis.content_div.append( form_item );\n\n\t\t\t\tform_item = $( Global.loadWidget( 'global/widgets/wizard_form_item/WizardFormItem.html' ) );\n\t\t\t\tform_item_label = form_item.find( '.form-item-label' );\n\t\t\t\tform_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\t\t\tvar new_password = this.getPasswordInput( 'new_password' );\n\n\t\t\t\tform_item_label.text( $.i18n._( 'New Password' ) );\n\t\t\t\tform_item_input_div.append( new_password );\n\n\t\t\t\tthis.content_div.append( form_item );\n\n\t\t\t\tform_item = $( Global.loadWidget( 'global/widgets/wizard_form_item/WizardFormItem.html' ) );\n\t\t\t\tform_item_label = form_item.find( '.form-item-label' );\n\t\t\t\tform_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\t\t\tvar confirm_password = this.getPasswordInput( 'confirm_password' );\n\n\t\t\t\tform_item_label.text( $.i18n._( 'New Password (Confirm)' ) );\n\t\t\t\tform_item_input_div.append( confirm_password );\n\n\t\t\t\tthis.content_div.append( form_item );\n\n\t\t\t\tthis.stepsWidgetDic[this.current_step][current_password.getField()] = current_password;\n\t\t\t\tthis.stepsWidgetDic[this.current_step][new_password.getField()] = new_password;\n\t\t\t\tthis.stepsWidgetDic[this.current_step][confirm_password.getField()] = confirm_password;\n\n\t\t\t\tcurrent_password.focus();\n\n\t\t\t\tbreak;\n\n\t\t}\n\t}\n\n\tsaveCurrentStep() {\n\t\tthis.stepsDataDic[this.current_step] = {};\n\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\t\tswitch ( this.current_step ) {\n\t\t\tdefault:\n\n\t\t\t\tfor ( var key in current_step_ui ) {\n\t\t\t\t\tif ( !current_step_ui.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tcurrent_step_data[key] = current_step_ui[key].getValue();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tbuildCurrentStepData() {\n\t}\n\n\tonCloseClick() {\n\n\t\t$( this.el ).remove();\n\t\tLocalCacheData.current_open_wizard_controllers = LocalCacheData.current_open_wizard_controllers.filter( wizard => wizard.wizard_id !== this.wizard_id );\n\t\tLocalCacheData.extra_filter_for_next_open_view = null;\n\t}\n\n\tonDoneClick() {\n\n\t\tvar $this = this;\n\t\tsuper.onDoneClick();\n\t\tthis.saveCurrentStep();\n\n\t\tvar current_password = this.stepsDataDic[1].current_password;\n\t\tvar new_password = this.stepsDataDic[1].new_password;\n\t\tvar confirm_password = this.stepsDataDic[1].confirm_password;\n\n\t\tthis.stepsWidgetDic[1].current_password.clearErrorStyle();\n\t\tthis.stepsWidgetDic[1].new_password.clearErrorStyle();\n\t\tthis.stepsWidgetDic[1].confirm_password.clearErrorStyle();\n\n\t\tif ( !current_password ) {\n\t\t\tthis.stepsWidgetDic[1].current_password.setErrorStyle( $.i18n._( 'Current password can\\'t be empty' ), true );\n\t\t} else if ( !new_password ) {\n\t\t\tthis.stepsWidgetDic[1].new_password.setErrorStyle( $.i18n._( 'New password can\\'t be empty' ), true );\n\t\t} else if ( new_password !== confirm_password ) {\n\t\t\tthis.stepsWidgetDic[1].new_password.setErrorStyle( $.i18n._( 'New password does not match' ), true );\n\t\t} else {\n\t\t\tif ( !this.default_data || !this.default_data.user_name ) {\n\t\t\t\tTAlertManager.showAlert( $.i18n._( 'Invalid user name' ) );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.api.changePassword( this.default_data.user_name,\n\t\t\t\tcurrent_password,\n\t\t\t\tnew_password,\n\t\t\t\tconfirm_password,\n\t\t\t\t{\n\t\t\t\t\tonResult: function( result ) {\n\n\t\t\t\t\t\tif ( !result.isValid() ) {\n\t\t\t\t\t\t\tTAlertManager.showErrorAlert( result );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$this.onCloseClick();\n\n\t\t\t\t\t\t\tif ( $this.call_back ) {\n\t\t\t\t\t\t\t\t$this.call_back();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t}\n\t}\n\n}\n\nResetPasswordWizardController.type = '';"],"names":["ResetPasswordWizardController","options","_","$","label","form_item","form_item_label","form_item_input_div","user_name","current_password","new_password","confirm_password","current_step_data","current_step_ui","key","wizard","$this","result"],"mappings":"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"}