{"version":3,"file":"UserDateTotalParentViewController-BqcWSIhp.bundle.js","sources":["../../views/attendance/timesheet/UserDateTotalParentViewController.js"],"sourcesContent":["export class UserDateTotalParentViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#user_date_total_parent_view_container',\n\t\t\tsub_user_date_total_view_controller: null,\n\n\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'UserDateTotalParentEditView.html';\n\t\tthis.permission_id = 'punch';\n\t\tthis.script_name = 'UserDateTotalParentView';\n\t\tthis.viewId = 'UserDateTotalParent';\n\t\tthis.table_name_key = 'user_date_total_parent';\n\t\tthis.context_menu_name = $.i18n._( 'Accumulated Time' );\n\t\tthis.navigation_label = $.i18n._( 'Accumulated Time' );\n\t\tthis.api = TTAPI.APIUserDateTotal;\n\n\t\tthis.render();\n\n\t\tif ( this.sub_view_mode ) {\n\t\t\tthis.buildContextMenu( true );\n\t\t} else {\n\t\t\tthis.buildContextMenu();\n\t\t}\n\n\t\t//call init data in parent view\n\t\tif ( !this.sub_view_mode ) {\n\t\t\tthis.initData();\n\t\t}\n\t}\n\n\tremoveEditView() {\n\t\tsuper.removeEditView();\n\n\t\tif ( this.parent_view_controller && this.parent_view_controller.viewId === 'TimeSheet' ) {\n\t\t\tthis.parent_view_controller.onSubViewRemoved();\n\t\t}\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\treturn {\n\t\t\tinclude:\n\t\t\t\t['cancel'],\n\t\t\texclude:\n\t\t\t\t['default']\n\t\t};\n\t}\n\n\topenEditView( date_str ) {\n\n\t\tvar $this = this;\n\n\t\tif ( $this.edit_only_mode ) {\n\n\t\t\tTTPromise.add( 'UserDateTotalParent', 'init' );\n\t\t\tif ( !$this.edit_view ) {\n\t\t\t\t$this.initEditViewUI( $this.viewId, $this.edit_view_tpl );\n\t\t\t}\n\n\t\t\tvar date_stamp = Global.strToDate( date_str, 'YYYY-MM-DD' ).format();\n\n\t\t\t$this.current_edit_record = {\n\t\t\t\tdate: date_str,\n\t\t\t\tuser_id: LocalCacheData.getAllURLArgs().user_id,\n\t\t\t\tdate_stamp: date_stamp\n\t\t\t};\n\t\t\tTTPromise.wait( 'UserDateTotalParent', 'init', function() {\n\t\t\t\t$this.initEditView();\n\t\t\t} );\n\n\t\t} else {\n\t\t\tif ( !this.edit_view ) {\n\t\t\t\tthis.initEditViewUI( $this.viewId, $this.edit_view_tpl );\n\t\t\t}\n\n\t\t}\n\t}\n\n\tbuildSearchFields() {\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [];\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_user_date_total_parent': {\n\t\t\t\t'label': $.i18n._( 'Accumulated Time' ),\n\t\t\t\t'html_template': this.getUserDateTotalParentTabHTML(),\n\t\t\t},\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tTTPromise.resolve( 'UserDateTotalParent', 'init' );\n\t}\n\n\tsetCurrentEditRecordData() {\n\n\t\tthis.edit_view_tab.find( '#tab_user_date_total_parent' ).find( '.first-column-sub-view' ).css( 'display', 'block' );\n\t\tthis.initSubUserDateTotalView( 'tab_user_date_total_parent' );\n\t\tthis.setEditViewDataDone();\n\t}\n\n\tinitSubUserDateTotalView( tab_id ) {\n\t\tvar $this = this;\n\n\t\tif ( this.sub_user_date_total_view_controller ) {\n\t\t\tthis.sub_user_date_total_view_controller.buildContextMenu( true );\n\t\t\tthis.sub_user_date_total_view_controller.setDefaultMenu();\n\t\t\t$this.sub_user_date_total_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.sub_user_date_total_view_controller.getSubViewFilter = function( filter ) {\n\n\t\t\t\treturn getFilter( filter, this );\n\t\t\t};\n\n\t\t\t$this.sub_user_date_total_view_controller.initData();\n\t\t\treturn;\n\t\t}\n\n\t\tGlobal.loadScript( 'views/attendance/timesheet/UserDateTotalViewController.js', function() {\n\t\t\tvar tab = $this.edit_view_tab.find( '#' + tab_id );\n\t\t\tvar firstColumn = tab.find( '.first-column-sub-view' );\n\t\t\tGlobal.trackView( 'Sub' + 'UserDateTotal' + 'View' );\n\t\t\tUserDateTotalViewController.loadSubView( firstColumn, beforeLoadView, afterLoadView );\n\t\t} );\n\n\t\tfunction beforeLoadView() {\n\n\t\t}\n\n\t\tfunction afterLoadView( subViewController ) {\n\t\t\t$this.sub_user_date_total_view_controller = subViewController;\n\t\t\t$this.sub_user_date_total_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.sub_user_date_total_view_controller.getSubViewFilter = function( filter ) {\n\n\t\t\t\treturn getFilter( filter, this );\n\t\t\t};\n\t\t\t$this.sub_user_date_total_view_controller.parent_view_controller = $this;\n\t\t\t$this.sub_user_date_total_view_controller.initData();\n\n\t\t}\n\n\t\tfunction getFilter( filter, target ) {\n\t\t\tvar date = Global.strToDate( target.parent_edit_record.date, 'YYYY-MM-DD' ).format();\n\n\t\t\tfilter.date_stamp = date;\n\t\t\tfilter.user_id = target.parent_edit_record.user_id; //Should be selected user_id\n\t\t\tfilter.object_type_id = [20, 25, 30, 40, 100, 110];\n\n\t\t\treturn filter;\n\t\t}\n\t}\n\n\tgetUserDateTotalParentTabHTML() {\n\t\treturn `\n\t\t<div id=\"tab_user_date_total_parent\" class=\"edit-view-tab-outside-sub-view\">\n\t\t\t<div class=\"edit-view-tab\" id=\"tab_user_date_total_parent_content_div\">\n\t\t\t\t<div class=\"first-column-sub-view\"></div>\n\t\t\t</div>\n\t\t</div>`;\n\t}\n\n}\n\nUserDateTotalParentViewController.loadView = function( container ) {\n\tGlobal.loadViewSource( 'UserDateTotalParent', 'UserDateTotalParentView.html', function( result ) {\n\t\tvar args = {};\n\t\tvar template = _.template( result );\n\n\t\tif ( Global.isSet( container ) ) {\n\t\t\tcontainer.html( template( args ) );\n\t\t} else {\n\t\t\tGlobal.contentContainer().html( template( args ) );\n\t\t}\n\n\t} );\n};\n\nUserDateTotalParentViewController.loadSubView = function( container, beforeViewLoadedFun, afterViewLoadedFun ) {\n\n\tGlobal.loadViewSource( 'UserDateTotalParent', 'SubUserDateTotalParentView.html', function( result ) {\n\t\tvar args = {};\n\t\tvar template = _.template( result );\n\t\tif ( Global.isSet( beforeViewLoadedFun ) ) {\n\t\t\tbeforeViewLoadedFun();\n\t\t}\n\t\tif ( Global.isSet( container ) ) {\n\t\t\tcontainer.html( template( args ) );\n\t\t\tif ( Global.isSet( afterViewLoadedFun ) ) {\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'initialize', function() {\n\t\t\t\t\tafterViewLoadedFun( sub_user_date_total_parent_view_controller );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t} );\n\n};"],"names":["UserDateTotalParentViewController","options","_","$","date_str","$this","date_stamp","tab_model","tab_id","filter","getFilter","tab","firstColumn","beforeLoadView","afterLoadView","subViewController","target","date","container","result","args","template","beforeViewLoadedFun","afterViewLoadedFun"],"mappings":"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"}