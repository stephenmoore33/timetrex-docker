{"version":3,"file":"ReCalculateTimeSheetWizardController-BZNo8PeE.bundle.js","sources":["../../views/wizard/re_calculate_timesheet/ReCalculateTimeSheetWizardController.js"],"sourcesContent":["export class ReCalculateTimeSheetWizardController extends BaseWizardController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '.wizard-bg'\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\n\t\tthis.title = $.i18n._( 'TimeSheet ReCalculation Wizard' );\n\t\tthis.steps = 3;\n\t\tthis.current_step = 1;\n\n\t\tthis.render();\n\t}\n\n\trender() {\n\t\tsuper.render();\n\n\t\tthis.initCurrentStep();\n\t}\n\n\t//Create each page UI\n\tbuildCurrentStepUI() {\n\n\t\tthis.content_div.empty();\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tvar label = this.getLabel();\n\t\t\t\tlabel.text( $.i18n._( 'Recalculating timesheets is only required when policies have been modified and need to be applied retroactively.' ) );\n\n\t\t\t\tthis.content_div.append( label );\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tlabel = this.getLabel();\n\t\t\t\tlabel.text( $.i18n._( 'Select one or more pay periods' ) );\n\n\t\t\t\tvar a_combobox = this.getAComboBox( TTAPI.APIPayPeriod, true, 'global_Pay_period', 'pay_period_id' );\n\t\t\t\tvar div = $( '<div class=\\'wizard-acombobox-div\\'></div>' );\n\t\t\t\tdiv.append( a_combobox );\n\n\t\t\t\tthis.stepsWidgetDic[this.current_step] = {};\n\t\t\t\tthis.stepsWidgetDic[this.current_step][a_combobox.getField()] = a_combobox;\n\n\t\t\t\tthis.content_div.append( label );\n\t\t\t\tthis.content_div.append( div );\n\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tlabel = this.getLabel();\n\t\t\t\tlabel.text( $.i18n._( 'Select one or more employees' ) );\n\n\t\t\t\ta_combobox = this.getAComboBox( TTAPI.APIUser, true, 'global_user', 'user_id', true );\n\t\t\t\tdiv = $( '<div class=\\'wizard-acombobox-div\\'></div>' );\n\t\t\t\tdiv.append( a_combobox );\n\n\t\t\t\tthis.stepsWidgetDic[this.current_step] = {};\n\t\t\t\tthis.stepsWidgetDic[this.current_step][a_combobox.getField()] = a_combobox;\n\n\t\t\t\tthis.content_div.append( label );\n\t\t\t\tthis.content_div.append( div );\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tbuildCurrentStepData() {\n\t}\n\n\tonDoneClick() {\n\t\tvar $this = this;\n\t\tsuper.onDoneClick();\n\t\tthis.saveCurrentStep();\n\t\tif ( this.stepsDataDic && this.stepsDataDic[2] && this.stepsDataDic[3] ) {\n\t\t\tvar pay_period_ids = this.stepsDataDic[2].pay_period_id;\n\t\t\tvar user_ids = this.stepsDataDic[3].user_id;\n\n\t\t\tvar timesheet_api = TTAPI.APITimeSheet;\n\n\t\t\t//this is outside the callback to prevent hammer-clicking which was causing problems.\n\t\t\tthis.onCloseClick();\n\t\t\ttimesheet_api.reCalculateTimeSheet( pay_period_ids, user_ids, {\n\t\t\t\tonResult: function( result ) {\n\n\t\t\t\t\tif ( $this.call_back ) {\n\t\t\t\t\t\t$this.call_back();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tsetCurrentStepValues() {\n\n\t\tif ( !this.stepsDataDic[this.current_step] ) {\n\t\t\treturn;\n\t\t} else {\n\t\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\t\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\t\t}\n\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tif ( current_step_data.pay_period_id ) {\n\t\t\t\t\tcurrent_step_ui.pay_period_id.setValue( current_step_data.pay_period_id );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\n\t\t\t\tif ( current_step_data.user_id ) {\n\t\t\t\t\tcurrent_step_ui.user_id.setValue( current_step_data.user_id );\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsaveCurrentStep() {\n\t\tthis.stepsDataDic[this.current_step] = {};\n\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tcurrent_step_data.pay_period_id = current_step_ui.pay_period_id.getValue();\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tcurrent_step_data.user_id = current_step_ui.user_id.getValue();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsetDefaultDataToSteps() {\n\n\t\tif ( !this.default_data ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tthis.stepsDataDic[2] = {};\n\t\tthis.stepsDataDic[3] = {};\n\n\t\tif ( this.getDefaultData( 'user_id' ) ) {\n\t\t\tthis.stepsDataDic[3].user_id = this.getDefaultData( 'user_id' );\n\t\t}\n\n\t\tif ( this.getDefaultData( 'pay_period_id' ) ) {\n\t\t\tthis.stepsDataDic[2].pay_period_id = this.getDefaultData( 'pay_period_id' );\n\t\t}\n\t}\n\n}"],"names":["ReCalculateTimeSheetWizardController","options","_","$","label","a_combobox","div","$this","pay_period_ids","user_ids","timesheet_api","result","current_step_data","current_step_ui"],"mappings":"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"}