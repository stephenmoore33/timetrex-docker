{"version":3,"file":"HierarchyControlViewController-BRVJtRuS.bundle.js","sources":["../../views/company/hierarchy_control/HierarchyControlViewController.js"],"sourcesContent":["export class HierarchyControlViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#hierarchy_control_view_container',\n\n\n\n\t\t\tobject_type_array: null,\n\t\t\teditor: null,\n\t\t\toriginal_hierarchy_data: [],\n\n\t\t\thierarchy_level_api: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'HierarchyControlEditView.html';\n\t\tthis.permission_id = 'hierarchy';\n\t\tthis.viewId = 'HierarchyControl';\n\t\tthis.script_name = 'HierarchyControlView';\n\t\tthis.table_name_key = 'hierarchy_control';\n\t\tthis.context_menu_name = $.i18n._( 'Hierarchy' );\n\t\tthis.navigation_label = $.i18n._( 'Hierarchy' );\n\t\tthis.api = TTAPI.APIHierarchyControl;\n\t\tthis.hierarchy_level_api = TTAPI.APIHierarchyLevel;\n\n\t\tthis.render();\n\t\tthis.buildContextMenu();\n\n\t\tthis.initData();\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\texclude: ['mass_edit'],\n\t\t\tinclude: []\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tinitOptions() {\n\t\tvar $this = this;\n\n\t\tthis.initDropDownOption( 'object_type', 'object_type' );\n\t}\n\n\tbuildEditViewUI() {\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_hierarchy': {\n\t\t\t\t'label': $.i18n._( 'Hierarchy' ),\n\t\t\t\t'html_template': this.getHierarchyControlTabHtml()\n\t\t\t},\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIHierarchyControl,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_hierarchy',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_hierarchy = this.edit_view_tab.find( '#tab_hierarchy' );\n\n\t\tvar tab_hierarchy_column1 = tab_hierarchy.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_hierarchy_column1 );\n\n\t\t//Name\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'name', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Name' ), form_item_input, tab_hierarchy_column1, '' );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Description\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'description', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Description' ), form_item_input, tab_hierarchy_column1 );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Objects\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_option_column',\n\t\t\tshow_search_inputs: false,\n\t\t\tset_empty: true,\n\t\t\tkey: 'value',\n\t\t\tfield: 'object_type'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.object_type_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Objects' ), form_item_input, tab_hierarchy_column1 );\n\n\t\t// Subordinates\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIUser,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_user',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'user'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Subordinates' ), form_item_input, tab_hierarchy_column1, '' );\n\n\t\t//Inside editor\n\n\t\tvar inside_editor_div = tab_hierarchy.find( '.inside-editor-div' );\n\t\tvar args = {\n\t\t\tlevel: $.i18n._( 'Level' ),\n\t\t\tsuperiors: $.i18n._( 'Superiors' )\n\t\t};\n\n\t\tthis.editor = Global.loadWidgetByName( FormItemType.INSIDE_EDITOR );\n\n\t\tthis.editor.InsideEditor( {\n\t\t\ttitle: $.i18n._( 'NOTE: Level one denotes the top or last level of the hierarchy and employees at the same level share responsibilities.' ),\n\t\t\taddRow: this.insideEditorAddRow,\n\t\t\tgetValue: this.insideEditorGetValue,\n\t\t\tsetValue: this.insideEditorSetValue,\n\t\t\tremoveRow: this.insideEditorRemoveRow,\n\t\t\tparent_controller: this,\n\t\t\trender: getRender(),\n\t\t\trender_args: args,\n\t\t\tapi: this.hierarchy_level_api,\n\t\t\trender_inline_html: true,\n\t\t\trow_render: getRowRender()\n\t\t} );\n\n\t\tfunction getRender() {\n\t\t\treturn `\n\t\t\t\t<table class=\"inside-editor-render\">\n\t\t\t\t\t<tr class=\"title\">\n\t\t\t\t\t\t<td style=\"width: 50px\"><%= level %></td>\n\t\t\t\t\t\t<td style=\"width: 200px\"><%= superiors %></td>\n\t\t\t\t\t\t<td style=\"width: 25px\">\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td style=\"width: 25px\"></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>`;\n\t\t}\n\n\t\tfunction getRowRender() {\n\t\t\treturn `\n\t\t\t<tr class=\"inside-editor-row data-row\">\n\t\t\t\t<td class=\"level cell\"></td>\n\t\t\t\t<td class=\"superiors awesome-box-cell\"></td>\n\t\t\t\t<td class=\"cell control-icon\">\n\t\t\t\t\t<button class=\"plus-icon\" onclick=\"\"></button>\n\t\t\t\t</td>\n\t\t\t\t<td class=\"cell control-icon\">\n\t\t\t\t\t<button class=\"minus-icon \" onclick=\"\"></button>\n\t\t\t\t</td>\n\t\t\t</tr>`;\n\t\t}\n\n\t\tinside_editor_div.append( this.editor );\n\t}\n\n\tinsideEditorSetValue( val ) {\n\n\t\tvar len = val.length;\n\t\tthis.removeAllRows();\n\n\t\tif ( len > 0 ) {\n\t\t\tfor ( var i = 0; i < val.length; i++ ) {\n\t\t\t\tif ( Global.isSet( val[i] ) ) {\n\t\t\t\t\tvar row = val[i];\n\n\t\t\t\t\tif ( !this.parent_controller.current_edit_record.id ) { //Copy as New, clear the ID field.\n\t\t\t\t\t\trow.id = '';\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.addRow( row );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.getDefaultData();\n\t\t}\n\t}\n\n\tsetEditViewDataDone() {\n\t\tsuper.setEditViewDataDone();\n\t\tthis.initInsideEditorData();\n\t}\n\n\tinitInsideEditorData() {\n\t\tvar $this = this;\n\n\t\tvar args = {};\n\t\targs.filter_data = {};\n\t\targs.filter_data.hierarchy_control_id = this.current_edit_record.id ? this.current_edit_record.id : ( this.copied_record_id ? this.copied_record_id : '' );\n\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) && !this.copied_record_id ) {\n\t\t\tthis.editor.addRow();\n\t\t} else {\n\t\t\tthis.hierarchy_level_api.getHierarchyLevel( args, true, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tif ( !$this.edit_view ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar data = res.getResult();\n\n\t\t\t\t\t$this.original_hierarchy_data = _.map(data, _.clone);\n\n\t\t\t\t\t$this.editor.setValue( data );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tinsideEditorRemoveRow( row ) {\n\t\tvar index = row[0].rowIndex - 1;\n\t\tvar remove_id = this.rows_widgets_array[index].current_edit_item.id;\n\t\tif ( TTUUID.isUUID( remove_id ) && remove_id != TTUUID.zero_id && remove_id != TTUUID.not_exist_id ) {\n\t\t\tthis.delete_ids.push( remove_id );\n\t\t}\n\t\trow.remove();\n\t\tthis.rows_widgets_array.splice( index, 1 );\n\t\tthis.removeLastRowLine();\n\t}\n\n\tinsideEditorAddRow( data, index ) {\n\t\tif ( !data ) {\n\t\t\tdata = {};\n\t\t}\n\n\t\tvar row = this.getRowRender(); //Get Row render\n\t\tvar render = this.getRender(); //get render, should be a table\n\t\tvar widgets = {}; //Save each row's widgets\n\n\t\t//Build row widgets\n\n\t\t//Level\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'level', width: 50 } );\n\t\tform_item_input.setValue( data.level ? data.level : 1 );\n\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\trow.children().eq( 0 ).append( form_item_input );\n\n\t\tthis.setWidgetEnableBaseOnParentController( form_item_input );\n\n\t\t//Superiors\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIUser,\n\t\t\twidth: 132,\n\t\t\tis_static_width: true,\n\t\t\tlayout_name: 'global_user',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'user_id'\n\t\t} );\n\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\tform_item_input.setValue( data.user_id ? data.user_id : '' );\n\t\trow.children().eq( 1 ).append( form_item_input );\n\n\t\tif ( typeof index != 'undefined' ) {\n\n\t\t\trow.insertAfter( $( render ).find( 'tr' ).eq( index ) );\n\t\t\tthis.rows_widgets_array.splice( ( index ), 0, widgets );\n\n\t\t} else {\n\t\t\t$( render ).append( row );\n\t\t\tthis.rows_widgets_array.push( widgets );\n\t\t}\n\n\t\tif ( this.parent_controller.is_viewing ) {\n\t\t\trow.find( '.control-icon' ).hide();\n\t\t}\n\n\t\tthis.setWidgetEnableBaseOnParentController( form_item_input );\n\n\t\t//Save current set item\n\t\twidgets.current_edit_item = data;\n\n\t\tif ( !this.parent_controller.current_edit_record.id ) {\n\t\t\twidgets.current_edit_item.id = '';\n\t\t}\n\n\t\tthis.addIconsEvent( row ); //Bind event to add and minus icon\n\t\tthis.removeLastRowLine();\n\t}\n\n\tinsideEditorGetValue( current_edit_item_id ) {\n\t\tvar len = this.rows_widgets_array.length;\n\n\t\tvar result = [];\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar row = this.rows_widgets_array[i];\n\t\t\tvar data = { level: row.level.getValue(), user_id: row.user_id.getValue() };\n\t\t\tdata.hierarchy_control_id = current_edit_item_id;\n\t\t\tdata.id = row.current_edit_item.id ? row.current_edit_item.id : '';\n\t\t\tresult.push( data );\n\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tonSaveResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result && result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.search();\n\t\t\t\t$this.onSaveDone( result );\n\n\t\t\t\t$this.removeEditView();\n\t\t\t} );\n\n\t\t} else {\n\t\t\t$this.setErrorMenu();\n\t\t\t$this.setErrorTips( result );\n\n\t\t}\n\t}\n\n\t// onSaveAndContinueResult( result ) {\n\t// \tvar $this = this;\n\t// \tif ( result.isValid() ) {\n\t// \t\tvar result_data = result.getResult();\n\t// \t\tif ( result_data === true ) {\n\t// \t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t//\n\t// \t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t// \t\t\t$this.refresh_id = result_data;\n\t//\n\t// \t\t}\n\t//\n\t// \t\t$this.saveInsideEditorData( function() {\n\t//\n\t// \t\t\t$this.search( false );\n\t// \t\t\t$this.onEditClick( $this.refresh_id, true );\n\t//\n\t// \t\t\t$this.onSaveAndContinueDone( result );\n\t//\n\t// \t\t} );\n\t//\n\t// \t} else {\n\t// \t\t$this.setErrorTips( result );\n\t// \t\t$this.setErrorMenu();\n\t// \t}\n\t// },\n\n\t// onSaveAndNewResult: function( result ) {\n\t// \tvar $this = this;\n\t// \tif ( result.isValid() ) {\n\t// \t\tvar result_data = result.getResult();\n\t// \t\tif ( result_data === true ) {\n\t// \t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t//\n\t// \t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t// \t\t\t$this.refresh_id = result_data;\n\t// \t\t}\n\t//\n\t// \t\t$this.saveInsideEditorData( function() {\n\t// \t\t\t$this.search( false );\n\t// \t\t\t$this.onAddClick( true );\n\t// \t\t} );\n\t//\n\t// \t} else {\n\t// \t\t$this.setErrorTips( result );\n\t// \t\t$this.setErrorMenu();\n\t// \t}\n\t// },\n\n\tonSaveAndCopyResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result && result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\t\t\t$this.copied_record_id = $this.refresh_id;\n\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.search( false );\n\t\t\t\t$this.onCopyAsNewClick();\n\t\t\t} );\n\n\t\t} else {\n\t\t\t$this.setErrorTips( result );\n\t\t\t$this.setErrorMenu();\n\t\t}\n\t}\n\n\tsaveInsideEditorData( callBack ) {\n\n\t\tvar $this = this;\n\n\t\tvar data = this.editor.getValue( this.refresh_id );\n\n\t\tvar remove_ids = this.editor.delete_ids;\n\n\t\tif ( remove_ids.length > 0 ) {\n\t\t\tthis.hierarchy_level_api.deleteHierarchyLevel( remove_ids, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\t$this.editor.delete_ids = [];\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\tlet changed_data = this.getChangedRecords( data, this.original_hierarchy_data, [] );\n\n\t\tif ( Array.isArray( changed_data ) && changed_data.length > 0 ) {\n\t\t\tthis.hierarchy_level_api.ReMapHierarchyLevels( data, { //Not sending changed data as the API expects all records.\n\t\t\t\tonResult: function( res ) {\n\n\t\t\t\t\tvar res_data = res.getResult();\n\t\t\t\t\t$this.hierarchy_level_api.setHierarchyLevel( res_data, {\n\t\t\t\t\t\tonResult: function( re ) {\n\n\t\t\t\t\t\t\tcallBack();\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\tcallBack();\n\t\t}\n\t}\n\n\tbuildSearchFields() {\n\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Name' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'name',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Description' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'description',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Superior' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'superior_user_id',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Subordinate' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'user_id',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Object Type' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'object_type',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\t//\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Created By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'created_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Updated By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'updated_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\t\t];\n\t}\n\n\t_continueDoCopyAsNew() {\n\t\tthis.setCurrentEditViewState( 'new' );\n\t\tLocalCacheData.current_doing_context_action = 'copy_as_new';\n\t\tif ( Global.isSet( this.edit_view ) ) {\n\t\t\tfor ( var i = 0; i < this.editor.rows_widgets_array.length; i++ ) {\n\t\t\t\tthis.editor.rows_widgets_array[i].current_edit_item.id = '';\n\t\t\t}\n\t\t}\n\t\tsuper._continueDoCopyAsNew();\n\t}\n\n\tonCopyAsNewResult( result ) {\n\t\tvar $this = this;\n\t\tvar result_data = result.getResult();\n\n\t\tif ( !result_data ) {\n\t\t\tTAlertManager.showAlert( $.i18n._( 'Record does not exist' ) );\n\t\t\t$this.onCancelClick();\n\t\t\treturn;\n\t\t}\n\n\t\t$this.openEditView(); // Put it here is to avoid if the selected one is not existed in data or have deleted by other pragram. in this case, the edit view should not be opend.\n\n\t\tresult_data = result_data[0];\n\n\t\tthis.copied_record_id = result_data.id;\n\t\tresult_data.id = '';\n\n\t\tif ( $this.sub_view_mode && $this.parent_key ) {\n\t\t\tresult_data[$this.parent_key] = $this.parent_value;\n\t\t}\n\n\t\t$this.current_edit_record = result_data;\n\t\t$this.initEditView();\n\t}\n\n\tgetHierarchyControlTabHtml() {\n\t\treturn `<div id=\"tab_hierarchy\" class=\"edit-view-tab-outside\">\n\t\t\t\t\t<div class=\"edit-view-tab\" id=\"tab_hierarchy_content_div\">\n\t\t\t\t\t\t<div class=\"first-column full-width-column\"></div>\n\t\t\t\t\t\t<div class=\"inside-editor-div full-width-column\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`;\n\t}\n\n}\n"],"names":["HierarchyControlViewController","options","_","$","context_menu_model","$this","tab_model","tab_hierarchy","tab_hierarchy_column1","form_item_input","inside_editor_div","args","getRender","getRowRender","val","len","i","row","res","data","index","remove_id","render","widgets","current_edit_item_id","result","result_data","callBack","remove_ids","changed_data","res_data","re"],"mappings":"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"}