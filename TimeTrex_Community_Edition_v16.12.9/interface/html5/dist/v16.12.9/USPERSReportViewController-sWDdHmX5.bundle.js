import{_ as l,j as o}from"./vendor-tTApdY0Y.bundle.js";class h extends ReportBaseViewController{constructor(e={}){l.defaults(e,{form_setup_states_array:null,form_setup_ui_dic:{},form_setup_data:{},save_form_setup_data:{}}),super(e)}initReport(e){this.script_name="USPERSReport",this.viewId="USPERSReport",this.context_menu_name=o.i18n._("US PERS"),this.navigation_label=o.i18n._("Saved Report"),this.view_file="USPERSReportView.html",this.api=TTAPI.APIUSPERSReport,this.include_form_setup=!0,this.form_setup_data={}}initOptions(e){var t=[{option_name:"page_orientation"},{option_name:"font_size"},{option_name:"auto_refresh"},{option_name:"chart_display_mode"},{option_name:"chart_type"},{option_name:"templates"},{option_name:"setup_fields"},{option_name:"form_setup_states"}];this.initDropDownOptions(t,function(i){e(i)})}getCustomContextMenuModel(){var e={groups:{},exclude:[],include:[{label:o.i18n._("Save Setup"),id:"save_setup",group:"form",vue_icon:"tticon tticon-settings_black_24dp",menu_align:"right",sort_order:3e3}]};return e}onContextMenuClick(e,t){var i;if(Global.isSet(t))i=t;else if(e.disabled)return;this.select_grid_last_row&&(this.export_grid.grid.jqGrid("saveRow",this.select_grid_last_row),this.select_grid_last_row=null);var _=o.i18n._("Setup data for this report has not been configured yet. Please click on the Form Setup tab to do so now.");switch(i){case"view":ProgressBar.showOverlay(),this.onViewClick(null,!1,_);break;case"view_html":ProgressBar.showOverlay(),this.onViewClick("html",!1,_);break;case"view_html_new_window":this.onViewClick("html",!1,_);break;case"export_export":ProgressBar.showOverlay(),this.onViewClick("efile",!1,_);break;case"cancel":this.onCancelClick();break;case"save_existed_report":this.onSaveExistedReportClick();break;case"save_new_report":this.onSaveNewReportClick();break;case"save_setup":this.onSaveSetup(o.i18n._("Form setup"));break}Global.triggerAnalyticsContextMenuClick(e,t)}buildEditViewUI(){super.buildEditViewUI();var e=this.edit_view.find("a[ref=tab_form_setup]");e.text(o.i18n._("Form Setup"))}buildFormSetupUI(){var e=this,t=this.edit_view_tab.find("#tab_form_setup"),i=t.find(".first-column");this.edit_view_tabs[3]=[],this.edit_view_tabs[3].push(i);var _=Global.loadWidgetByName(FormItemType.COMBO_BOX);_.TComboBox({field:"form_setup_type",set_empty:!1}),_.setSourceData(e.form_setup_states_array),this.addEditFieldToColumn(o.i18n._("State"),_,i,""),_.bind("formItemChange",function(m,p){e.onFormSetupChange(p.getValue())})}onFormSetupChange(e){var t=this;switch(this.removeCurrentFormSetupUI(),this.form_setup_ui_dic={},o.i18n._("No"),o.i18n._("Yes"),e){case"MS":t.buildAdditionalCustomInputBox(e,"reporting_unit_number",o.i18n._("Unit Number")),t.buildAdditionalCustomInputBox(e,"wage_code",o.i18n._("Wage Code")),t.buildAdditionalCustomInputBox(e,"retirement_status_date",o.i18n._("Retirement Status Date")),t.buildAdditionalCustomInputBox(e,"retirement_status_code",o.i18n._("Retirement Status Code")),t.buildAdditionalCustomInputBox(e,"title_code",o.i18n._("Position Code"));break;case"IA":t.buildAdditionalCustomInputBox(e,"title_code",o.i18n._("Occupation Code"));break;case"NE":t.buildAdditionalCustomInputBox(e,"agency_number",o.i18n._("Agency Number")),t.buildAdditionalCustomInputBox(e,"plan_participation_date",o.i18n._("Plan Participation Date"));break;case"NV":t.buildAdditionalCustomInputBox(e,"employment_status",o.i18n._("Employment Status (FT/PT)")),t.buildAdditionalCustomInputBox(e,"employment_status_code",o.i18n._("Status Code"));break;default:this.edit_view_tab&&this.edit_view_tab.find("#tab_form_setup .first-column").append('<div id="no-setup-data" style="font-weight: bold; text-align:center">'+o.i18n._("No form setup required for this state.")+"</div>");break}}onFormItemChange(e,t){if(e&&e.getField&&e.getField()=="form_setup_type"){var i={};i.form_setup_type=this.current_edit_record.form_setup_type,i[i.form_setup_type]={},this.form_setup_changed=!0;return}super.onFormItemChange(e,t)}setFormSetupData(e){e||(this.show_empty_message=!0),this.save_form_setup_data=e;var t={};if(e.form_setup_type&&this.edit_view_ui_dic.form_setup_type){this.edit_view_ui_dic.form_setup_type.setValue(e.form_setup_type),this.onFormSetupChange(e.form_setup_type);let i=`form_setup_${e.form_setup_type}_`;t=this.processFormSetupDataAndAddToBatch(e,[{data:l.get(e,[e.form_setup_type,"employee_contribution"]),field_key:i+"employee_contribution",api:this.api_paystub,api_method:"getPayStubEntryAccount"},{data:l.get(e,[e.form_setup_type,"employee_contribution"]),field_key:i+"employee_contribution",api:this.api_paystub,api_method:"getPayStubEntryAccount"}]),this.getBatchedRealFormDataFromAPI(t),t=this.processFormSetupDataAndAddToBatch(e,[{data:l.get(e,[e.form_setup_type,"employer_contribution"]),field_key:i+"employer_contribution",api:this.api_paystub,api_method:"getPayStubEntryAccount"},{data:l.get(e,[e.form_setup_type,"employer_contribution"]),field_key:i+"employer_contribution",api:this.api_paystub,api_method:"getPayStubEntryAccount"}]),this.getBatchedRealFormDataFromAPI(t)}else Array.isArray(this.form_setup_states_array)&&this.form_setup_states_array.length>0&&this.onFormSetupChange(this.form_setup_states_array[0].value)}buildIncludeExcludeDropdown(e,t,i,_){var m=this.edit_view_tab.find("#tab_form_setup"),p=m.find(".first-column"),u="form_setup_"+e+"_"+t+"_include_"+i,s="form_setup_"+e+"_"+t+"_exclude_"+i,r=o("<div class='v-box'></div>"),a=Global.loadWidgetByName(FormItemType.AWESOME_BOX);a.AComboBox({api_class:TTAPI.APIPayStubEntryAccount,allow_multiple_selection:!0,layout_name:"global_PayStubAccount",show_search_inputs:!0,set_empty:!0,field:u});var d=this.putInputToInsideFormItem(a,o.i18n._("Include"));r.append(d),r.append("<div class='clear-both-div'></div>");var n=Global.loadWidgetByName(FormItemType.AWESOME_BOX);n.AComboBox({api_class:TTAPI.APIPayStubEntryAccount,allow_multiple_selection:!0,layout_name:"global_PayStubAccount",show_search_inputs:!0,set_empty:!0,field:s}),d=this.putInputToInsideFormItem(n,o.i18n._("Exclude")),r.append(d),this.addEditFieldToColumn(_,[a,n],p,"",r,!1,!0),this.setWidgetVisible([a,n]),this.form_setup_ui_dic["form_setup_"+e+"_"+t+"_"+i]=r.parent().parent(),this.save_form_setup_data[e][t]&&this.save_form_setup_data[e][t]["include_"+i]&&this.edit_view_ui_dic[u].setValue(this.save_form_setup_data[e][t]["include_"+i]),this.save_form_setup_data[e][t]&&this.save_form_setup_data[e][t]["exclude_"+i]&&this.edit_view_ui_dic[s].setValue(this.save_form_setup_data[e][t]["exclude_"+i]),this.editFieldResize(3)}buildAdditionalCustomInputBox(e,t,i,_=null){this.save_form_setup_data||(this.save_form_setup_data={}),this.save_form_setup_data[e]||(this.save_form_setup_data[e]={});var m=this.edit_view_tab.find("#tab_form_setup"),p=m.find(".first-column");this.edit_view_tabs[3]=[],this.edit_view_tabs[3].push(p);var u="form_setup_"+e+"_"+t,s=Global.loadWidgetByName(FormItemType.COMBO_BOX);if(s.TComboBox({field:u}),_)s.setSourceData(_),this.addEditFieldToColumn(o.i18n._(i),s,p,"",null,!0),this.setWidgetVisible([s]),this.save_form_setup_data[e]&&this.save_form_setup_data[e][t]&&s.setValue(this.save_form_setup_data[e][t]),s.trigger("formItemChange",[s,!0]);else{var r=o("<div class='h-box'></div>"),a=Global.loadWidgetByName(FormItemType.TEXT_INPUT);a.css("margin-left","10px"),a.TTextInput({field:u+"_text"}),r.append(s),r.append(a),this.addEditFieldToColumn(o.i18n._(i),[s,a],p,"",r,!0),this.setWidgetVisible([s,a]),s.bind("formItemChange",(d,n)=>{n.getValue()===0?(a.css("display","inline"),this.save_form_setup_data[e][t+"_value"]&&a.setValue(this.save_form_setup_data[e][t+"_value"])):(a.css("display","none"),a.setValue(""))}),this.api.getOptions("form_setup_custom_fields",{onResult:d=>{var n=d.getResult();s.setSourceData(Global.buildRecordArray(n)),this.save_form_setup_data[e]&&this.save_form_setup_data[e][t]&&s.setValue(this.save_form_setup_data[e][t]),s.trigger("formItemChange",[s,!0])}})}this.form_setup_ui_dic[u]=this.edit_view_form_item_dic[u],delete this.edit_view_form_item_dic[u],this.editFieldResize(3)}removeCurrentFormSetupUI(){for(var e in this.form_setup_ui_dic){var t=this.form_setup_ui_dic[e];t&&t.remove()}if(o("#no-setup-data").remove(),!!this.edit_view_tab){var i=this.edit_view_tab.find("#tab_form_setup"),_=i.find(".first-column"),m=_.find(".clear-both-div");m.remove()}}getFormSetupFieldValues(e,t){for(var i={},_=0;_<t.length;_++)this.edit_view_ui_dic["form_setup_"+e+"_"+t[_]]&&!this.edit_view_ui_dic["form_setup_"+e+"_"+t[_]].getValue()?this.edit_view_ui_dic["form_setup_"+e+"_"+t[_]+"_text"]?(i[t[_]]=this.edit_view_ui_dic["form_setup_"+e+"_"+t[_]+"_text"].getValue(),i[t[_]+"_value"]=this.edit_view_ui_dic["form_setup_"+e+"_"+t[_]+"_text"].getValue()):i[t[_]]=this.edit_view_ui_dic["form_setup_"+e+"_"+t[_]].getValue():this.edit_view_ui_dic["form_setup_"+e+"_"+t[_]]?i[t[_]]=this.edit_view_ui_dic["form_setup_"+e+"_"+t[_]].getValue():i[t[_]]="";return i}getFormData(e,t){if(!e||!e.form_setup_type)return!1;if(e[e.form_setup_type]=this.getFormSetupFieldValues(e.form_setup_type,this.getFieldList(e.form_setup_type)),this.save_form_setup_data||(this.save_form_setup_data={}),this.save_form_setup_data[e.form_setup_type]=e[e.form_setup_type],this.save_form_setup_data.form_setup_type=e.form_setup_type,t)for(var i in this.save_form_setup_data)i!==!1&&typeof this.save_form_setup_data[i]!="string"&&(this.save_form_setup_data[i]=this.convertFormSetupValues(this.save_form_setup_data[i]));return this.save_form_setup_data}getFieldList(e){var t=[];switch(e){case"MS":t=["reporting_unit_number","wage_code","retirement_status_date","retirement_status_code","title_code"];break;case"IA":t=["title_code"];break;case"NE":t=["agency_number","plan_participation_date"];break;case"NV":t=["employment_status","employment_status_code"];break}return t}getFormSetupData(e){var t={};return t.form_setup_type=this.edit_view_ui_dic.form_setup_type.getValue(),t[t.form_setup_type]={},t=this.getFormData(t,!0),t}convertFormSetupValues(e){for(var t in e){var i=t.substr(0,t.indexOf("_value"));t.search("_value")>0&&(e[i]=e[t])}return e.form_setup_columns&&!e.columns&&e.form_setup_type!=0&&e.form_setup_columns[e.form_setup_type]&&(e.columns={},e.columns=e.form_setup_columns[e.form_setup_type].columns),e}}export{h as USPERSReportViewController};
//# sourceMappingURL=USPERSReportViewController-sWDdHmX5.bundle.js.map
