{"version":3,"mappings":";q8EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAUC,SAASA,EAAG,CAMZ,IAAIC,EAAU,MAAM,UAAU,MAK1BC,EAAO,CAEV,KAAM,KACN,eAAgB,KAShB,KAAM,SAASC,EAAUC,EAAgB,CACpC,KAAK,OAAS,KACjBJ,EAAE,OAAO,KAAK,KAAMG,CAAQ,EAE5B,KAAK,KAAOA,EAGTC,IACH,KAAK,eAAiBA,EAEvB,EAOD,OAAQ,UAAW,CAClB,KAAK,KAAiB,KACtB,KAAK,eAAiB,IACtB,EAaD,EAAG,SAAUC,EAAK,CACjB,IAAIC,EAAO,KAAK,KAChB,GAAIA,GAAQA,EAAK,eAAeD,CAAG,EAClCA,EAAMC,EAAKD,CAAG,UACJ,KAAK,iBAAmB,KAClC,OAAO,KAAK,OAAO,KAAK,eAAgBA,CAAG,EAE5C,IAAIE,EAAON,EAAQ,KAAK,SAAS,EACjC,OAAAM,EAAK,CAAC,EAAIF,EAEH,KAAK,OAAO,MAAM,KAAME,CAAI,CACnC,EAYD,OAAQ,SAASF,EAAKE,EAAM,CAC3B,GAAI,UAAU,OAAS,EAAG,OAAOF,EACjC,IAAIE,EAAOP,EAAE,QAAQO,CAAI,EAAIA,EAAON,EAAQ,KAAK,UAAW,CAAC,EAC7D,OAAOI,EAAI,QAAQ,0BAA2B,SAASG,EAAIC,EAAGC,EAAU,CACvE,OAAIA,EACID,EAAIF,EAAK,SAASG,CAAQ,EAAE,CAAC,EAE9BD,EAAIF,EAAK,OAChB,GAAE,QAAQ,OAAQ,IAAI,CACvB,CAEH,EAcCP,EAAE,GAAG,GAAK,SAASK,EAAKM,EAAQ,CAC/B,OAAOX,EAAE,IAAI,EAAE,KAAKE,EAAK,EAAE,MAAMA,EAAM,SAAS,CAAC,CACnD,EAECF,EAAE,KAAOE,CACV,GAAG,MAAM,uFCxGJU,YAAU,CACX,KAAM,aACN,WAAY,CAAC,CACjB,gBAjBS,GAAG,mBAAmB,MAAM,kCAC7BC,gBAOM,OAPD,MAAM,cAAc,GACrBA,gBAKM,OALD,MAAM,kBAAkB,GACzBA,gBAEW,YAFD,MAAM,eAAe,IAAI,MAAM,MAAM,OAC3CA,gBAAyC,cAAjC,0BAAwB,IAEpCA,gBAAmD,OAA7C,OAAM,gBAAgB,EAAC,iBAAe,uBALpDC,qEADJC,mBASM,MATNC,aADJC,YAAA,uECSM,OAAS,CAMd,CAAE,KAAM,mBAAoB,KAAM,YAAa,UAAW,UAAY,CAIvE,EAEM,eAAiB,aAAa,CAEnC,QAAS,oBAAqB,EAC9B,MACD,CAAC,ECzBS,IAACC,SAAS,UAAW,CAC/B,EAEAA,SAAO,QAAU,uCACjBA,SAAO,aAAe,uCAEtBA,SAAO,QAAU,EAEjBA,SAAO,aAAe,SAAUC,EAAO,CACtC,GAAK,CAACA,GAAQ,gBAAkB,eAAe,WAAa,eAAe,UAAU,GAAK,CACzF,IAAIC,EAAU,eAAe,UAAU,GAAG,MAAO,KACjDD,EAAOC,EAAQ,CAAC,EAAIA,EAAQ,CAAC,EAAIA,EAAQ,CAAC,CAC1C,EAEID,GAAQ,MAAQA,EAAK,QAAU,MACnCA,GAASD,SAAO,WAAY,EAAG,GAAM,cAAgBA,SAAO,cAG7D,IAAIG,EAAWH,SAAO,aAClBI,EAAOH,EACPI,EAAOL,SAAO,aACdM,EAAY,IAAI,KAAM,EAAC,QAAO,EAGlCA,GAAaN,SAAO,QACpBA,SAAO,SAAW,EAElB,IAAIO,EAAKP,SAAO,mBAAoBM,CAAS,EACzCE,EAAKD,EAAG,IAAMF,EACdI,EAASF,EAAG,GAAK,KAAU,KAE/BJ,GAAY,MACZ,IAAIO,EAAUP,IAAa,EAAM,IAC7BQ,EAAMR,EAAW,IAErB,OAAOH,SAAO,UAAWQ,EAAID,EAAG,IAAKE,EAAMC,EAAOC,EAAKP,EACxD,EAEAJ,SAAO,SAAW,SAAUY,EAAO,CAElC,OAAKA,IAAS,MAAQZ,SAAO,OAAQY,CAAM,GAAI,GACvCA,EAGDZ,SAAO,OACf,EAEAA,SAAO,OAAS,SAAUY,EAAO,CAChC,IAAIC,EAAQ,IAAI,OAAQ,+EACxB,MAAK,GAAAD,GAAQ,IAAMC,EAAM,KAAMD,CAAI,EAKpC,EAEAZ,SAAO,UAAY,SAAUc,EAASC,EAASC,EAAkBC,EAAuBC,EAAad,EAAO,CAC3G,IAAIe,EACHnB,SAAO,aAAcgB,EAAiB,SAAU,EAAI,EAAE,CAAC,EAAKhB,SAAO,aAAce,EAAQ,SAAU,EAAE,EAAI,CAAG,EAC1G,IAAMf,SAAO,aAAcc,EAAQ,SAAU,EAAI,EAAC,UAAW,EAAG,CAAC,EAAI,CAAG,EACxE,IAAMd,SAAO,aAAcc,EAAQ,SAAU,EAAI,EAAC,UAAW,EAAG,CAAC,EAAI,CAAG,EACxE,IAAMd,SAAO,aAAciB,EAAsB,SAAU,EAAE,EAAI,CAAG,EAAGjB,SAAO,aAAckB,EAAY,SAAU,EAAE,EAAI,CAAG,EAC3H,IAAMd,EAAK,SAAQ,EAAG,UAAW,EAAG,IAEvC,OAAOe,CACR,EAEAnB,SAAO,YAAc,SAAUoB,EAAO,CACrC,OAAO,KAAK,IAAK,EAAGA,CAAI,CACzB,EAEApB,SAAO,UAAYA,SAAO,YAAa,CAAC,EACxCA,SAAO,UAAYA,SAAO,YAAa,CAAC,EACxCA,SAAO,UAAYA,SAAO,YAAa,EAAE,EACzCA,SAAO,UAAYA,SAAO,YAAa,EAAE,EACzCA,SAAO,UAAYA,SAAO,YAAa,EAAE,EAEzCA,SAAO,WAAa,UAAW,CAC9B,OAAOA,SAAO,aAAc,EAAKA,SAAO,UAAY,EACrD,EAEAA,SAAO,WAAa,UAAW,CAC9B,OAAOA,SAAO,aAAc,EAAKA,SAAO,UAAY,EACrD,EAEAA,SAAO,WAAa,UAAW,CAC9B,OAAOA,SAAO,aAAc,EAAKA,SAAO,UAAY,EACrD,EAEAA,SAAO,WAAa,UAAW,CAC9B,OAAS,EAAI,KAAK,OAAQ,GAAK,GAAK,MAAW,EAAI,KAAK,OAAQ,EAAK,OAAqB,GAAK,GAChG,EAEAA,SAAO,mBAAqB,SAAUqB,EAAO,CAC5C,IAAIC,EAAKD,EAAO,KAAK,IAAK,KAAM,EAAG,IAC/BE,EAASD,EAAK,WAAgB,IAAU,UAC5C,MAAO,CAAE,KAASA,EAAK,WAAc,IAAU,WAAa,IAAKC,EAAK,MAAQ,GAAIA,IAAO,GAAI,UAAWD,EACzG,EAEAtB,SAAO,aAAe,SAAUwB,EAAQC,EAAQC,EAAI,CACnDF,EAAS,OAAQA,GACjBE,EAAOA,GAAM,IAEb,QADI,EAAID,EAASD,EAAO,OAChB,EAAI,EAAG,KAAO,EAAGE,GAAKA,EACxB,EAAI,IACRF,EAASE,EAAIF,GAGf,OAAOA,CACR,EAEAxB,SAAO,aAAe,SAAU2B,EAAKC,EAAM,CAC1C,IAAIC,EAEAC,EAAa,OAAO,QAAU,OAAO,SACzC,GAAKA,EAAa,CACjB,IAAIC,EAAa,IAAI,WAAY,GACjCD,EAAW,gBAAiBC,GAE5BF,EAAa,KAAOE,EAAW,CAAC,EAAE,SAAQ,CAC5C,MACEF,EAAa,KAAK,SAGnB,OAAAA,EAAa,KAAK,MAAOA,GAAeD,EAAMD,EAAM,EAAK,EAAGA,EAErDE,CACR,EC/HO,MAAM,aAAa,SAAS,KAAM,CAExC,YAAaG,EAAU,GAAK,CAC3B,EAAE,SAAUA,EAAS,CACvB,GAEE,MAAOA,CAAO,CACd,CACF,CCNO,MAAM,uBAAuB,IAAK,CACxC,YAAaA,EAAU,GAAK,CAC3B,EAAE,SAAUA,EAAS,CACpB,SAAU,KACV,QAAS,KACT,SAAU,KACV,MAAO,IACV,GACE,MAAOA,CAAO,CACd,CACF,CCLO,MAAM,yBAAyB,IAAK,CAE1C,YAAaA,EAAU,GAAK,CAC3B,EAAE,SAAUA,EAAS,CACpB,YAAa,KACb,SAAU,IACb,GAEE,MAAOA,CAAO,CACd,CAED,SAAU,CACT,MAAK,SAAO,MAAO,KAAK,IAAK,aAAe,EAAC,UAAY,GAAI,KAAK,IAAK,aAAa,EAAG,aAAe,GAKtG,CAED,YAAa,CACZ,OAAK,OAAO,MAAO,KAAK,IAAK,aAAe,EAAC,WAAa,GAAI,OAAO,MAAO,KAAK,IAAK,aAAa,EAAG,YAAY,SAC1G,KAAK,IAAK,aAAa,EAAG,YAAY,QAGvC,EACP,CAED,cAAe,CACd,OAAK,OAAO,MAAO,KAAK,IAAK,aAAe,EAAC,WAAa,GAAI,OAAO,MAAO,KAAK,IAAK,aAAa,EAAG,YAAY,OAC1G,KAAK,IAAK,aAAa,EAAG,YAAY,MAGvC,EACP,CAED,WAAY,CAEX,IAAIC,EACJ,OAAK,OAAO,MAAO,KAAK,IAAK,aAAa,EAAG,YAC5CA,EAAS,KAAK,IAAK,aAAa,EAAG,WAEnCA,EAAS,KAAK,IAAK,eAGf,OAAOA,EAAW,IACtBA,EAAS,KACEnD,OAAE,KAAMmD,CAAM,IAAO,SAAWA,EAAO,SAAW,IAC7DA,EAAS,IAGHA,CAEP,CAED,SAAU,CACT,OAAK,OAAO,MAAO,KAAK,IAAK,aAAe,EAAC,WAAa,GAAI,OAAO,MAAO,KAAK,IAAK,aAAa,EAAG,YAAY,MAC1G,KAAK,IAAK,aAAa,EAAG,YAAY,KAGvC,EACP,CAED,gBAAiB,CAChB,OAAK,OAAO,MAAO,KAAK,IAAK,aAAe,EAAC,WAAa,GAAI,OAAO,MAAO,KAAK,IAAK,aAAa,EAAG,YAAY,aAC1G,KAAK,IAAK,aAAa,EAAG,YAAY,YAGvC,EACP,CAED,kBAAmB,CAClB,OAAK,OAAO,MAAO,KAAK,IAAK,aAAe,EAAC,WAAa,GAAI,OAAO,MAAO,KAAK,IAAK,aAAa,EAAG,YAAY,gBAC1G,KAAK,IAAK,aAAa,EAAG,YAAY,eAGvC,EACP,CAED,iBAAkB,CACjB,OAAK,OAAO,MAAO,KAAK,IAAK,aAAe,EAAC,WAAW,GAAM,OAAO,MAAO,KAAK,IAAK,aAAe,EAAC,YAAY,cAAgB,GACjI,OAAO,MAAO,KAAK,IAAK,aAAa,EAAG,YAAY,eAAe,eAC5D,KAAK,IAAK,aAAe,EAAC,YAAY,eAAe,cAGtD,EACP,CAED,iBAAkB,CACjB,OAAK,OAAO,MAAO,KAAK,IAAK,aAAe,EAAC,WAAW,GAAM,OAAO,MAAO,KAAK,IAAK,aAAe,EAAC,YAAY,cAAgB,GACjI,OAAO,MAAO,KAAK,IAAK,aAAa,EAAG,YAAY,eAAe,eAC5D,KAAK,IAAK,aAAe,EAAC,YAAY,eAAe,cAGtD,EACP,CAED,mBAAoB,CACnB,OAAK,OAAO,MAAO,KAAK,IAAK,aAAe,EAAC,WAAW,GAAM,OAAO,MAAO,KAAK,IAAK,aAAe,EAAC,YAAY,cAAgB,GACjI,OAAO,MAAO,KAAK,IAAK,aAAa,EAAG,YAAY,eAAe,iBAC5D,KAAK,IAAK,aAAe,EAAC,YAAY,eAAe,gBAGtD,EACP,CAED,yBAA0BC,EAAW,CACpC,IAAIC,EAAc,KAAK,IAAK,aAAa,EAEzC,OAAKA,GAAeA,EAAY,YACxBA,EAAY,YAAYD,CAAQ,EAGjC,EACP,CAED,oBAAqB,CACpB,IAAIE,EAAY,GAEhBtD,cAAE,KAAM,KAAK,WAAU,EAAI,SAAUuD,EAAOC,EAAY,CAEvD,QAAUC,KAAKD,EACdF,GAAaE,EAAUC,CAAC,EAAE,CAAC,EAAI,IAEnC,GAESH,CACP,CAEF,CCnIO,0BAAMI,UAAsB,SAAS,KAAM,CACjD,aAAc,CACb1D,OAAE,QAAU,GACZ,OACA,CAED,cAAe,CACd,OAAK,KAAK,WACF,KAAK,YAEZ,KAAK,aAAckB,SAAO,aAAc,GACjC,KAAK,WAIb,CAED,aAAcyC,EAAQ,CACrB,YAAK,WAAaA,EAEX,EACP,CAED,iBAAkB,CACjB,OAAK,KAAK,cACF,KAAK,cAGN,EACP,CAED,gBAAiBA,EAAQ,CACxB,YAAK,cAAgBA,EAEd,EACP,CAED,kBAAmB,CAClB,IAAIC,EAAY,UAAU,CAAC,EACvBC,EAAgB,UAAU,CAAC,EAC3BC,EAA2B,UAAU,CAAC,EACtCC,EAA+B,UAAU,CAAC,EAAID,EAAyB,OAAS,GAChFE,EAAU,GACVC,EACAC,EAEC,OAAO,MAAOH,EAA6B,QAAQ,GAAM,OAAO,MAAOA,EAA6B,QACxGG,EAAQJ,EAAyB,OAAS,EAE1CG,EAAiB,IAAI,eAAgBF,KAGrCG,EAAMJ,EAAyB,OAC/BG,EAAiB,MAGlB,QAAUR,EAAI,EAAGA,EAAIS,EAAKT,IACzBO,EAAQP,CAAC,EAAIK,EAAyBL,CAAC,EAElCA,IAAM,GAAKS,IAAQ,GACvB,OAAO,MAAOF,EAAQP,CAAC,CAAG,GAC1B,OAAO,MAAOO,EAAQP,CAAC,EAAE,gBAAgB,IACzCO,EAAQ,CAAC,EAAIA,EAAQP,CAAC,EAAE,kBAK1B,OAAO,KAAK,KAAMG,EAAWC,EAAeI,EAAgBD,EAC5D,CAED,mBAAoBG,EAAUC,EAAM,CAEnCpE,cAAE,KAAMmE,EAAU,SAAUZ,EAAOI,EAAQ,CAErC3D,OAAE,KAAM2D,CAAK,IAAO,SACxBS,EAAMA,EAAM,IAAM,KAAK,UAAWT,CAAK,EAEvCS,EAAMA,EAAM,IAAMT,CAGtB,GAESS,CAEP,CAED,cAAeR,EAAWC,EAAeG,EAASC,EAAiB,CAClE,IAAItD,EAAS,OAAO,OAAQ,KAAK,MAAOqD,EAAQ,IAAI,GACpD,MAAMJ,CAAS,EAAEC,CAAa,EAAG,GAAGlD,EAAQsD,EAAe,WAC3D,CAED,WAAYI,EAAWC,EAAYC,EAAc,CAChD,IAAIC,EAAa,KAAK,eAClBC,EAAaf,EAAc,mBAAoB,QAAU,EAAG,IAAMY,EAAa,IAAM,OAAO,gBAAiB,EAAG,IAAM,eAAe,aAAc,EAAE,cAAeE,EAExK,YAAY,gBAAiBA,GAC7B,YAAY,yBAA0BxE,OAAE,KAAK,EAAG,gBAAgB,GAEhEA,OAAE,KAAM,CACP,IAAKyE,EACL,QAAS,CAER,cAAe,mBACf,eAAgB,UAAW,YAAc,CACzC,EACD,KAAM,OAeN,QAAS,SAAUtB,EAAS,CACtBA,GAAUA,EAAO,SAAU,EAAC,kBAAiB,IAAO,QACxD,cAAc,UAAWA,GAGrBoB,EAAY,UAChBA,EAAY,SAAUpB,GAGvB,YAAY,kBAAiB,CAC7B,EAED,KAAMkB,EACN,MAAO,GACP,YAAa,GACb,YAAa,EAChB,EAEE,CAED,wBAAyBL,EAAU,CAClC,GAAKA,GAAWA,EAAQ,KAAO,CAC9B,IAAIU,EAAS,GACTnE,EAAO,KAAK,MAAOyD,EAAQ,IAAI,EACnC,QAAUW,KAAiBpE,EAAO,CACjC,IAAIqE,EAAMrE,EAAKoE,CAAa,EAC5BD,EAAO,KAAM,KAAK,UAAWE,EAAK,KAAM,CAAC,EACzC,CAED,OAAOF,EAAO,KAAM,KACpB,CAED,OAAO,IACP,CAED,SAAUG,EAAWZ,EAAgBJ,EAAeG,EAAU,CAC7D,IAAIb,EAAS,eAAe,aAAa0B,CAAS,EAG9CC,EAAmB,IAAI,iBAE3B,OAAAA,EAAiB,IAAK,cAAe3B,GACrC2B,EAAiB,IAAK,WAAYb,EAAe,IAAK,UAAU,GAChEa,EAAiB,IAAK,gBAAiBjB,GACvCiB,EAAiB,IAAK,OAAQd,GAEzBC,EAAe,IAAK,aACxBA,EAAe,IAAK,UAAY,EAAEa,CAAgB,EAG5CA,CACP,CAED,mBAAoBjB,EAAgB,CACnC,IAAIkB,EAAc,GAElB,OAASlB,EAAa,CACrB,IAAK,aACL,IAAK,0DACL,IAAK,eACL,IAAK,cACL,IAAK,kBACL,IAAK,kBACL,IAAK,mBACL,IAAK,wBACL,IAAK,cACL,IAAK,6BACJkB,EAAc,GACd,KACD,CAED,OAAOA,CACP,CAED,KAAMnB,EAAWC,EAAeI,EAAgBD,EAAU,CACzD,IAAIgB,EAAQ,KACRR,EACAS,EAAWvB,EAAc,UAAW,SAAWE,EAAY,WAAaC,EAAgB,QACxFqB,EAAMD,EACL,eAAe,kBACd,eAAe,cAAa,EAAG,eAAgB,SAAS,IAC5DC,EAAMA,EAAM,YAAc,eAAe,cAAa,EAAG,SAErD,eAAe,cAAa,EAAG,eAAgB,YAAY,IAC/DA,EAAMA,EAAM,eAAiB,eAAe,cAAa,EAAG,aAGzD,OAAO,iBACXA,EAAMA,EAAM,cAAgB,OAAO,aAAY,GAGhD,IAAIJ,EACAK,EAEClB,GAAkBA,EAAe,IAAK,OAAO,IAAO,GACxDkB,EAAQlB,EAAe,IAAK,SAE5BkB,EAAQ,GAET,IAAIN,EACJ,OAAShB,EAAa,CACrB,IAAK,aACL,IAAK,0DACL,IAAK,6BACL,IAAK,eACL,IAAK,cACL,IAAK,kBACL,IAAK,kBACL,IAAK,mBACL,IAAK,wBACL,IAAK,cAyBJ,GAvBKA,IAAkB,eACtBgB,EAAYjB,EAAY,aACbC,IAAkB,cAC7BgB,EAAYjB,EAAY,YACbC,IAAkB,kBAC7BgB,EAAYjB,EAAY,gBACbC,IAAkB,kBAC7BgB,EAAYjB,EAAY,gBACbC,IAAkB,mBAC7BgB,EAAYjB,EAAY,iBACbC,IAAkB,wBAC7BgB,EAAYjB,EAAY,sBACbC,IAAkB,cAC7BgB,EAAYjB,EAAY,YACbC,IAAkB,6BAC7BgB,EAAY,6BAEZA,EAAY,KAAK,mBAAoBb,EAASJ,EAAY,IAAMC,GAE5DI,EAAe,IAAK,SAAS,IAAO,KACxC,eAAe,aAAaY,CAAS,EAAI,IAGrCA,GAAa,eAAe,aAAaA,CAAS,EAAI,CAE1D,GAAK,eAAe,aAAaA,CAAS,EAAE,QAC3C,UAAU,IAAK,gBAAiBA,GAChC,UAAU,KAAM,gBAAiBA,GAAW,UAAW,CACtD,KAAK,SAAUA,EAAWZ,EAAgBJ,EAAeG,CAAO,CACvE,GAAQ,KAAM,IAAI,OAEZ,QAAO,KAAK,SAAUa,EAAWZ,EAAgBJ,EAAeG,GAGjE,OAAOc,CAEP,CACD,MACD,IAAK,eACL,IAAK,kBACJD,EAAYjB,EAAY,aACxB,eAAe,aAAaiB,CAAS,EAAI,GACzC,MACD,IAAK,cACL,IAAK,iBACJA,EAAYjB,EAAY,YACxB,eAAe,aAAaiB,CAAS,EAAI,GACzC,MACD,IAAK,kBACL,IAAK,qBACJA,EAAYjB,EAAY,gBACxB,eAAe,aAAaiB,CAAS,EAAI,GACzC,MACD,IAAK,kBACL,IAAK,qBACJA,EAAYjB,EAAY,gBACxB,eAAe,aAAaiB,CAAS,EAAI,GACzC,MACD,IAAK,mBACL,IAAK,sBACJA,EAAYjB,EAAY,iBACxB,eAAe,aAAaiB,CAAS,EAAI,GACzC,MACD,IAAK,wBACL,IAAK,2BACJA,EAAYjB,EAAY,sBACxB,eAAe,aAAaiB,CAAS,EAAI,GACzC,MACD,IAAK,cACL,IAAK,iBACJA,EAAYjB,EAAY,YACxB,eAAe,aAAaiB,CAAS,EAAI,GACzC,KACD,CAEDL,EAAa,KAAK,eAElB,UAAU,IAAK,gBAAiBA,GAE3BZ,IAAc,kBAAoBC,IAAkB,WACxDqB,EAAMA,EAAM,cAAgBV,GAGxB,KAAK,gBAAiB,GAAI,KAC9BU,EAAMA,EAAM,iBAGRxB,EAAc,YAClBwB,EAAMA,EAAMxB,EAAc,WAGrBM,IACLA,EAAU,IAIXA,EAAU,CAAE,KAAM,KAAK,UAAWA,CAAS,GAG3C,IAAIoB,EAAkB,KACtB,GAAK,OAAO,MAAU,IAAc,CACnC,IAAIC,EAAgB,IAAI,MACnB,OAAOA,GAAgB,UAAYA,EAAY,OAAS,OAAOA,EAAY,OAAU,SACzFD,EAAkBC,EAAY,MAAM,MAAO;AAAA,CAAI,EAE/CD,EAAkB,KAEnBC,EAAc,IACd,CAED,IAAIC,EAAkB,IAAI,KACtBC,EAAY,CACf,IAAK3B,EAAY,IAAMC,EACvB,KAAMG,EAAQ,KACd,WAAY,KAAK,aAAc,EAC/B,gBAAiBsB,EAAgB,YAAa,EAC9C,YAAaF,CAChB,EACE,OAAAA,EAAkB,KAEb,eAAe,UAAU,SAAW,IACxC,eAAe,UAAU,MAGrBvB,IAAkB,mBACtB,eAAe,UAAU,QAAS0B,GAG9B3B,IAAc,kBAAoBC,IAAkB,SAAWA,IAAkB,mBAAqBA,IAAkB,sCAC5H,YAAY,gBAAiBW,GAGzB,KAAK,mBAAoBX,CAAa,IAAO,KACjD,eAAe,aAAagB,CAAS,EAAI,CAAE,QAAS,EAAI,GAGzD7E,OAAE,KACD,CACC,SAAU,OACV,KAAMgE,EACN,QAAS,CAKR,uBAAwB,mBAAoB,eAAe,mBAAqB,EAGhF,cAAe,mBACf,eAAgB,UAAW,YAAc,CACzC,EACD,KAAM,OACN,MAAOmB,EACP,IAAKD,EACL,WAAY,SAAUM,EAAQ,CAC7BxF,OAAE,KAAK,mBAAqB,KAAK,IAAG,EACpC,KAAK,MAAQwF,EACbxF,OAAE,QAAQ,KAAM,KAChB,EACD,SAAU,SAAUwF,EAAQ,CAC3B,IAAIjC,EAAQvD,OAAE,QAAQ,QAAS,IAAI,EAC9BuD,EAAQ,IACZvD,OAAE,QAAQ,OAAQuD,EAAO,CAAC,EAG3B,IAAIkC,EAAuB,KAAK,IAAG,EAAKzF,OAAE,KAAK,mBAC1CyF,EAAqB,KACpB,OAAS,KAAW,KAAe,UAAU,eAAe,oBAAsB,KACtF,KAAM,QAAS,WAAY,CAC1B,MAAO7B,EACP,OAAQC,EACR,cAAe4B,CACvB,GACO,MAAM,KAAM,yBAA2B7B,EAAY,YAAcC,EAAgB,UAAY4B,EAAqB,KAAM,mBAAoB,gBAAiB,WAAY,EAAE,EAG7K,EACD,QAAS,SAAUtC,EAAS,CAU3B,GAFA6B,EAAM,aAAc,MAEf,OAAO,oBAAsB,GAAO,CACxC,IAAIU,EAAkB,oBAAsB9B,EAAY,KAAOC,EAAgB,6BAC/E,QAAQ,eAAgB6B,EAAiB,oBAAqB,qBAAqB,EACnF,QAAQ,IAAK,KAAO9B,EAAY,KAAOC,EAAgB,MAAQmB,EAAM,wBAAyBhB,CAAS,EAAG,IAAK,oBAAqB,qBAAqB,EAEzJ,IAAI2B,EAA8B,wCAClC,QAAQ,eAAgBA,EAA6B,oBAAqB,qBAAqB,EAC/F,QAAQ,IAAK,YAAcT,EAAK,oBAAqB,qBAAqB,EAC1E,QAAQ,IAAK,4CAA8ClB,EAAQ,KAAW,oBAAqB,uBACnG,QAAQ,IAAK,iEAAmE,OAAO,gBAAiB,EAAG,8BAAiCA,EAAQ,KAAO,MAASiB,EAAW,IAAK,oBAAqB,qBAAqB,EAC9N,QAAQ,SAAUU,GAElB,IAAIC,EAA2B,qCAC/B,QAAQ,eAAgBA,EAA0B,oBAAqB,qBAAqB,EAC5F,QAAQ,IAAK,KAAK,UAAWzC,EAAQ,KAAM,CAAC,GAC5C,QAAQ,SAAUyC,GAElB,QAAQ,SAAUF,GAClBC,EAA8B,KAC9BC,EAA2B,KAC3BF,EAAkB,IAClB,CAeD,GAbM,OAAO,MAAOvC,KACnBA,EAAS,IAELS,IAAc,kBAAoBC,IAAkB,SAAWA,IAAkB,mBAAqBA,IAAkB,sCAC5H,YAAY,kBAAmBW,GAGhCM,EAAmB,IAAI,iBACvBA,EAAiB,IAAK,cAAe3B,GACrC2B,EAAiB,IAAK,WAAYb,EAAe,IAAK,UAAU,GAChEa,EAAiB,IAAK,gBAAiBjB,GACvCiB,EAAiB,IAAK,OAAQd,GAEzB,CAACc,EAAiB,QAAS,IAAMA,EAAiB,YAAc,aAAeA,EAAiB,QAAS,IAAK,kBAAqB,CACvI,MAAM,KAAM,wBAA0BA,EAAiB,QAAO,EAAK,WAAaA,EAAiB,eAAc,EAAI,gBAAiBN,EAAY,mBAAoB,gBAAiB,KAAM,EAAE,EACxLM,EAAiB,QAAS,IAAK,kBACnC,OAAO,mBAAoB,iBAAkB,sBAAuB,wBAA0BA,EAAiB,QAAO,EAAK,WAAaA,EAAiB,eAAgB,GACzK,cAAc,UAAWA,EAAiB,eAAgB,EAAE,QAAS,UAAW,CAC/E,OAAO,SAAS,QACxB,KAEO,OAAO,gBAAiB,wBAA0BA,EAAiB,QAAO,EAAK,WAAaA,EAAiB,iBAAkB,oBAC/H,cAAc,UAAW9E,OAAE,KAAK,EAAG,iBAAoB,KAAO8E,EAAiB,eAAgB,EAAE,OAAO,GAIpG,OAAO,YAAe,IAC1B,UAAU,OAAQ,gBAAiBN,GAEnC,MAAM,KAAM,wDAAyD,mBAAoB,gBAAiB,KAAM,IAEjH,MACN,SAAiB,CAACM,EAAiB,QAAO,GAAMA,EAAiB,QAAS,IAAK,UAAY,CAKrF,GAHA,OAAO,OAAM,EACbpB,EAAc,iBAAmB,GACjC,eAAe,mBAAqB1D,OAAE,KAAK,EAAG,sCAAsC,EAC/E,OAAO,SAAS,MAAQ,OAAO,aAAe,YAO5C,CACN,IAAI6F,EAAQ,OAAO,WAAU,EAAG,QAASnC,EAAc,SAAU,EAAE,EAAG,MAAO,GAAG,EAC3EmC,EAAM,QAAS,aAAa,EAAK,EACrC,OAAO,gBAAiB,OAAO,WAAU,EAAK,uBACnCA,EAAM,QAAS,QAAQ,EAAK,EAClC,eAAe,cAAe,EAAC,aACnC,eAAe,mBAAoB,MACnC,OAAO,gBAAiB,OAAO,WAAY,EAAG,mCAAqC,eAAe,gBAAgB,aAG7G,eAAe,cAAe,EAAC,YACpC,OAAO,gBAAiB,OAAO,WAAU,EAAK,YAGhD,CACD,UAAU,QAAS,gBAAiBrB,GACpC,MACN,SAAiB,CAACM,EAAiB,QAAO,GAAMA,EAAiB,QAAS,IAAK,uBAAyB,CAClG,OAAO,mBAAoB,iBAAkB,6BAA8B,qCAAuCA,EAAiB,QAAO,EAAK,WAAaA,EAAiB,eAAgB,GAG7L,UAAU,QAAS,gBAAiBN,GAEpC,OAAO,SAAS,QAASd,EAAc,SAAW,eAAe,UAAU,SAAW,+DACtF,MACA,SAAWoB,EAAiB,QAAS,IAAK,iBAAmB,CAC7D,IAAIgB,EAAehB,EAAiB,YAE/BgB,EAAa,IAAI,SAAW,IAChC,WAAW,UAAW,eAAe,aAAc,EAAC,GAAI,eAAe,aAAc,EAAC,UAAW,IAAMd,EAAM,cAAepB,EAAWC,EAAeG,EAASC,CAAc,GAE7K,OAAO,wBAAyB,eAAe,gCAAgC,OAAQ6B,EAAa,aAAcA,EAAa,IAAK,GAAQ3C,GAAY,CACvJ,MAAM,KAAM,yBAA2BA,EAAQ,mBAAoB,gBAAiB,OAAQ,IAC5F,OAAO,wBAAuB,EAG9B6B,EAAM,cAAepB,EAAWC,EAAeG,EAASC,CAAc,CAC9E,GAGM,UAAU,QAAS,gBAAiBO,GACpC,MACN,MAIWQ,EAAM,mBAAoBnB,CAAa,IAAO,KAClD,eAAe,aAAagB,CAAS,EAAI1B,EACzC,UAAU,QAAS,gBAAiB0B,IAIhCZ,EAAe,IAAK,aAAgB,OAASA,EAAe,IAAK,aAAkB,YACvFA,EAAe,IAAK,UAAY,EAAEa,CAAgB,EAIpD,UAAU,QAAS,gBAAiBN,EACpC,EAED,MAAO,SAAUgB,EAAOO,EAAYC,EAAc,CAajD,GAZA,UAAU,OAAQ,gBAAiBxB,GAC9BZ,IAAc,kBAAoBC,IAAkB,SAAWA,IAAkB,mBAAqBA,IAAkB,sCAC5H,YAAY,kBAAmBW,GAG3BQ,EAAM,mBAAoBnB,CAAe,IAAK,IAAQ,eAAe,aAAagB,CAAS,GAAK,eAAe,aAAaA,CAAS,EAAE,UAG3I,OAAO,eAAe,aAAaA,CAAS,EAC5C,UAAU,OAAQ,gBAAiBA,IAG/B,CAAAnB,EAAc,iBAKnB,IADA,MAAM,KAAM,uBAAyBsC,EAAc,aAAeD,EAAa,eAAiBP,EAAM,OAAQ,mBAAoB,gBAAiB,OAAQ,EAAE,EACxJA,EAAM,cAAgBA,EAAM,aAAa,QAAS,wBAA0B,GAAI,EAAI,CACxF9B,EAAc,iBAAmB,GAEjC,eAAe,mBAAqB1D,OAAE,KAAK,EAAG,wCAAwC,EAEtF,OAAO,mBAAkB,EAEzB,OAAO,gBAAiB,OAAO,WAAU,EAAK,aAE9C,MAEN,MACWwF,EAAM,cAAgBxF,OAAE,KAAMwF,EAAM,YAAc,IAAK,UAC3D,cAAc,sBAAuBA,EAAOO,EAAYC,CAAW,EAIrE,OAAKR,EAAM,SAAW,KAAO,CAACA,EAAM,cACnCV,EAAmB,IAAI,iBACvBA,EAAiB,IAAK,cAAe,IACrCA,EAAiB,IAAK,WAAYb,EAAe,IAAK,UAAU,GAChEa,EAAiB,IAAK,gBAAiBjB,GACvCiB,EAAiB,IAAK,OAAQd,GAEzBC,EAAe,IAAK,aACxBA,EAAe,IAAK,UAAY,EAAEa,CAAgB,EAE5CA,KAEFU,EAAM,SAAW,GAAOA,EAAM,QAAU,KAAOA,EAAM,QAAU,OAGnE,cAAc,sBAAuBA,EAAOO,EAAYC,CAAW,EACnE,YAAY,kBAAiB,GAGzB/B,EAAe,IAAK,YAAe,OAASA,EAAe,IAAK,YAAiB,YACrFA,EAAe,IAAK,SAAW,EAAEa,CAAgB,EAG3C,MAER,CACD,CACJ,EAESA,CACP,CACF,EAEApB,gBAAc,UAAY,SAAUuC,EAAW,CAC9C,OAAOvC,gBAAc,SAAWA,gBAAc,aAAe,IAAMuC,CACpE,EAEAvC,gBAAc,mBAAqB,SAAUwC,EAAc,CAC1D,IAAIC,EAAc,GACdC,EAAsB,GAEtB1B,EAAS,KAETO,EAAWvB,gBAAc,SAAW,gCAExC,OAASwC,EAAY,YAAa,GACjC,IAAK,SACJxB,EAAShB,gBAAc,SAAW,4BAClCyC,EAAc,GACd,MACD,IAAK,qBACJzB,EAAShB,gBAAc,SAAW,2CAClCyC,EAAc,GACd,MACD,IAAK,gBACJzB,EAASO,EACTkB,EAAc,GACd,MACD,IAAK,eACJzB,EAASO,EAAW,4BACpBkB,EAAc,GACdC,EAAsB,GACtB,MACD,IAAK,oBACJ1B,EAASO,EAAW,iCACpBkB,EAAc,GACdC,EAAsB,GACtB,MACD,IAAK,iBACJ1B,EAASO,EAAW,8BACpBkB,EAAc,GACd,MACD,IAAK,aACJzB,EAASO,EAAW,0BACpBkB,EAAc,GACd,MACD,IAAK,4BACJzB,EAASO,EAAW,yCACpBkB,EAAc,GACdC,EAAsB,GACtB,MAED,IAAK,uBACJ1B,EAASO,EAAW,oCACpB,MACD,IAAK,cACJP,EAASO,EAAW,2BACpB,MACD,IAAK,YACJP,EAASO,EAAW,yBACpB,MACD,QACC,MAAM,KAAM,2BAA4BiB,EAAa,mBAAoB,gBAAiB,qBAAsB,IAChH,KACD,CAGD,OAAKC,GAAe,KACnBzB,GAAU,iBAAmB,UAAW,eAGpC0B,GAAuB,KAC3B1B,GAAU,MAAQ,IAAI,KAAM,EAAC,QAAO,GAG9BA,CACR,EAGAhB,gBAAc,SAAW,UAAW,CACnC1D,OAAE,KAAMA,OAAE,QAAS,SAAUuD,EAAO8C,EAAW,CACzC,OAAOA,GAAY,UAAYA,EAAS,OAAS,OAAOA,EAAS,OAAS,UAAY,OAAOA,EAAS,MAAM,OAAU,aACrHA,EAAS,KAAOA,EAAS,IAAI,QAAS,eAAe,GAAM,IAC/D,MAAM,KAAM,uBAAyBA,EAAS,IAAK,mBAAoB,gBAAiB,WAAY,IACpGA,EAAS,MAAM,SAEf,MAAM,KAAM,kCAAmC,mBAAoB,gBAAiB,WAAY,IAGpG,EACA,EAEA3C,gBAAc,SAAW,KACzBA,gBAAc,aAAe,KAC7BA,gBAAc,SAAW,KACzBA,gBAAc,iBAAmB,GACjCA,gBAAc,UAAY,GCrsB1B,MAAM,0BAA0BA,eAAc,CAC7C,YAAa4C,EAAYC,EAAW,CACnC,eAEA,KAAK,UAAYD,EAEXC,IACLA,EAAWD,EAAW,QAAS,MAAO,EAAE,GAEzC,KAAK,SAAWC,EAET,KAAK,mBAAoB,KAChC,CAED,mBAAoBC,EAAM,CACzB,OAAO,IAAI,MAAOA,EAAK,CACtB,IAAKC,EAAQC,EAAe,CAC3B,GAAKA,KAAgBD,EACpB,OAAOA,EAAOC,CAAY,EACpB,GAAK,OAAOD,EAAO,kBAAoB,WAC7C,OAAO,YAAalG,EAAO,CAC1B,OAAOkG,EAAO,iBAAiB,KAAMA,EAAQC,EAAcnG,EACjE,CAEI,CACJ,EACE,CACF,CAEA,kBAAkB,UAAU,iBAAmB,SAAUoG,EAAapG,EAAO,CAE5E,OAAO,KAAK,iBAAkB,KAAK,UAAWoG,EAAapG,EAC5D,EAEA,MAAM,cAAgB,GAChB,qBAAuB,CAC5B,IAAKkG,EAAQH,EAAa,CAEzB,OAAO,IAAI,kBAAmBA,EAC9B,CACF,EAEaM,QAAQ,IAAI,MAAO,cAAe,oBAAoB,EC5C5D,IAAIC,eAAe,UAAW,CAErC,EAEAA,eAAa,KAAO,OACpBA,eAAa,YAAc,aAC3BA,eAAa,iBAAmB,kBAChCA,eAAa,gBAAkB,iBAC/BA,eAAa,UAAY,WACzBA,eAAa,KAAO,OACpBA,eAAa,WAAa,YAC1BA,eAAa,YAAc,aAC3BA,eAAa,aAAe,cAC5BA,eAAa,eAAiB,gBAC9BA,eAAa,UAAY,WACzBA,eAAa,kBAAoB,kBACjCA,eAAa,UAAY,WACzBA,eAAa,YAAc,aAC3BA,eAAa,aAAe,oBAC5BA,eAAa,SAAW,WACxBA,eAAa,cAAgB,eAC7BA,eAAa,aAAe,cAC5BA,eAAa,cAAgB,eAC7BA,eAAa,kBAAoB,kBACjCA,eAAa,eAAiB,gBAC9BA,eAAa,UAAY,eACzBA,eAAa,cAAgB,eAC7BA,eAAa,MAAQ,QACrBA,eAAa,aAAe,cAErB,IAAIC,iBAAiB,UAAW,CAEvC,EAEAA,iBAAe,cAAgB,eAE/BA,iBAAe,oBAAsB,mBACrCA,iBAAe,wBAA0B,sBACzCA,iBAAe,OAAS,SACxBA,iBAAe,SAAW,WAC1BA,iBAAe,cAAgB,gBAC/BA,iBAAe,iBAAmB,mBAClCA,iBAAe,aAAe,2LCtBvB,IAAI,UAAY,UAAW,CAClC,EAGA,UAAU,OAAS,GACnB,UAAU,GAAK,GACf,UAAU,cAAgB,GAC1B,UAAU,WAAa,KAEvB,UAAU,MAAQ,UAAW,CAC5B,OAAO,KAAK,EACb,EACA,UAAU,MAAQ,SAAUnD,EAAQ,CACnC,OAAKA,GAAS,IACb,KAAK,GAAKA,EACH,IAED,EACR,EAEA,UAAU,gBAAkB,UAAW,CACtC,OAAO,KAAK,aACb,EACA,UAAU,gBAAkB,SAAUA,EAAQ,CAC7C,OAAKA,GAAS,IACb,KAAK,cAAgBA,EACd,IAED,EACR,EAEA,UAAU,aAAe,UAAW,CACnC,OAAO,KAAK,UACb,EACA,UAAU,aAAe,SAAUA,EAAQ,CAC1C,OAAKA,GAAS,IACb,KAAK,WAAaA,EACX,IAED,EACR,EAEA,UAAU,YAAc,UAAW,CAClC,OAAK,OAAS,KAAK,OAAO,KAAK,EAAE,EAAO,IAChC,KAED,KAAK,OAAO,KAAK,EAAE,CAC3B,EACA,UAAU,YAAc,SAAUA,EAAQ,CAIzC,OAHK,OAAS,KAAK,OAAO,KAAK,EAAE,EAAO,MACvC,KAAK,OAAO,KAAK,EAAE,EAAI,IAEnBA,GAAS,IACb,KAAK,OAAO,KAAK,EAAE,EAAIA,EAChB,IAED,EACR,EAEA,UAAU,YAAc,UAAW,CAClC,IAAIoD,EAAY,KAAK,cACrB,OAAK,OAAO,MAAOA,EAAU,QAAW,EAChCA,EAAU,SAGX,EACR,EAKA,UAAU,MAAQ,UAAW,CAC5B,GAAK,KAAK,MAAO,GAAI,GAAK,CACzB,IAAIA,EAAY,KAAK,cACjBC,EAAa,IAAI,KAAM,EAAG,QAAO,EAErC,GAAK,OAAO,MAAOD,CAAS,GAAM,GACjCA,EAAY,CACX,WAAYC,EACZ,SAAU,CACd,UACc,OAAO,MAAOD,GAAc,CAEvC,IAAIE,EAA0B,KAAK,aAAY,EAAK,IACpD,GAAKF,EAAU,SAAW,KAAK,gBAAe,GAAMA,EAAU,YAAgBC,EAAWC,EACxF,aAAM,KAAM,uBAAyBF,EAAU,SAAW,IAAM,KAAK,gBAAe,EAAK,QAAY,KAAK,OAASC,EAAWD,EAAU,YAAe,GAAI,EAAO,IAAM,KAAK,eAAiB,MAAO,eAAgB,YAAa,QAAS,EAAE,EACtO,GACIA,EAAU,WAAaC,EAAWC,IAC7CF,EAAY,CACX,WAAYC,EACZ,SAAU,CACf,EAEG,CAEDD,EAAU,WACV,KAAK,YAAaA,EAClB,CACD,MAAO,EACR,EAEA,UAAU,OAAS,SAAUG,EAAK,CAC5BA,GAAM,OACV,KAAK,GAAKA,GAEX,OAAO,KAAK,OAAO,KAAK,EAAE,CAC3B,GC9HE,SAAUlH,EAAI,CAEfA,EAAE,GAAG,cAAgB,SAAUkD,EAAU,CACxC,IAAIiE,EAAOnH,EAAE,OAAQ,CAAE,EAAEA,EAAE,GAAG,cAAc,SAAUkD,GAElD8B,EAAQ,KAEZ,OAAO,OAAQ,8CAEf,IAAIoC,EAAY,SAAUC,EAASC,EAAYpC,EAAM,CACpD,IAAIqC,EAAMvH,EAAG,OAAO,iBAAkB,eAAe,YAAY,GAC7DwH,EAAYD,EAAI,KAAM,YAAY,EACtCC,EAAU,KAAMF,GAChBC,EAAI,KAAM,KAAM,WAAaF,CAAO,EAEpCE,EAAI,KAAM,WAAYrC,GAEtB,WAAY,UAAW,CACtBqC,EAAI,SAAU,OACd,EAAE,GAAG,EAEN,IAAIE,EAAYF,EAAI,KAAM,YAAY,EAEtCA,EAAI,OAAQ,OAAS,EAAC,MAAO,UAAW,CACvC,OAAO,cAAa,EACpB,IAAIF,EAAUrH,EAAG,MAAO,KAAM,IAAI,EAAG,QAAS,WAAY,IACtDkF,EAAMlF,EAAG,IAAM,EAAC,KAAM,UAAU,EAGpC,OAFA,OAAO,cAAeqH,GAEbA,EAAO,CACf,IAAK,uBACJ,oBAAoB,WAAYA,GAChC,MACD,IAAK,+CACJ,oBAAoB,qBAAsB,gDAC1C,MACD,QAEC,OAAO,gBAAiBnC,EACzB,CAEL,GAEGuC,EAAU,OAAQ,OAAS,EAAC,MAAO,UAAW,CAC7C,IAAIJ,EAAUrH,EAAG,IAAI,EAAG,OAAQ,EAAC,KAAM,MAAO,QAAS,WAAY,EAAE,EACrE,OAAO,cAAeqH,EAC1B,GAEGrC,EAAM,OAAQuC,EACjB,EAEE,YAAK,UAAY,SAAUG,EAAU,CAIpC,QAAUtD,KAAOsD,EAChB,GAAKA,EAAQ,eAAgBtD,CAAK,GAAIA,EAAI,QAAS,UAAa,GAAK,CACpE,IAAIiD,EAAUjD,EACVkD,EAAaI,EAAQtD,CAAG,EACxBuD,EAAWD,EAAQtD,EAAM,MAAM,EAC9BpE,EAAG,YAAcqH,CAAO,EAAG,SAAW,GAC1CD,EAAWC,EAASC,EAAYK,EAGjC,CAKL,EAEE,KAAK,KAAM,UAAW,CAEb3H,EAAE,MAAOA,EAAE,OAAQ,CAAE,EAAEmH,EAAMnH,EAAG,IAAI,EAAG,KAAI,CAAI,CAE1D,GAES,IAET,EAECA,EAAE,GAAG,cAAc,SAAW,GAC9BA,EAAE,GAAG,cAAc,KAAO,CACzB,IAAK;AAAA;AAAA;AAAA;AAAA,UAKL,QAAS,sCACX,CAEA,GAAK,MAAQ,iHC1FP,SAAW,KAAI,EAGrB,OAAO,kBAAoB,CAAE,mBAAoB,GAAM,KAAM,SAAU,0BAA2B,IAclG,sBAAiB,CAKhB,YAAakD,EAAU,GAAK,CAE3B,KAAK,SAAWA,EAChB,KAAK,SAAW,KAChB,KAAK,oBAAqB,KAAK,2BAA4BA,CAAS,GACpE,MAAM,KAAM,uBAAwB,KAAK,SAAU,KAAM,gBAAiB,aAAc,cAAe,GACvG,CAOD,2BAA4BA,EAAU,CAYrC,OAAKA,GAAWA,EAAQ,SAAWA,EAAQ,cAC1C,MAAM,KAAM,oFAAqF,gBAAiB,aAAc,6BAA8B,GACvJA,EAAQ,QAAU,IAAMA,EAAQ,cAC5BA,GAAWA,EAAQ,QACvBA,EAAQ,QACJA,GAAWA,EAAQ,aACvBA,EAAQ,aAER,EAER,CAOD,oBAAqB0E,EAAW,CAC/B,OAAO,KAAK,SAAWA,CACvB,CAED,oBAAqB,CACpB,OAAO,KAAK,QACZ,CAED,eAAgBA,EAAUC,EAAW,CAEpC,OAAOD,EAAW,IAAMC,CACxB,CASD,GAAIC,EAAaD,EAAUE,EAAeC,EAAqB,CAC9D,kBAAkB,0BAA2B,KAAK,QAAU,EAAG,kBAAkB,0BAA2B,KAAK,QAAU,GAAI,GAG/H,IAAIC,EAAgB,KAAK,eAAgBH,EAAaD,CAAQ,EAC1DK,EAAqB,KAAK,SAAW,IAAMD,EAAgB,IAAM,OAAO,eAE5E,yBAAkB,0BAA2B,KAAK,QAAQ,EAAG,KAAM,CAClE,mBAAoBC,EACpB,cAAeD,EACf,YAAaH,EACb,SAAUD,EACV,cAAeE,EACf,mBAAoBC,CACvB,GACE,kBAAkB,KAAK,GAAIC,EAAeF,CAAa,EACvD,MAAM,KAAM,KAAK,SAAW,2BAA4BG,EAAoB,KAAM,gBAAiB,aAAc,KAAM,EAAE,EAElHA,CACP,CAQD,KAAMJ,EAAaD,EAAUM,EAAa,CACzC,IAAIF,EAAgB,KAAK,eAAgBH,EAAaD,CAAQ,EAC9D,aAAM,KAAM,KAAK,SAAW,wBAAyBI,EAAe,KAAM,gBAAiB,aAAc,OAAQ,EAAE,EAE5G,kBAAkB,KAAK,KAAMA,EAAeE,CAAU,CAC7D,CAUD,IAAKP,EAAUC,EAAW,CACzB,IAAIO,EAAc,kBAAkB,0BAA2BR,CAAQ,EACvE,GAAIQ,IAAgB,OAEnB,aAAM,MAAO,oDAAqD,gBAAiB,WAAY,MAAO,GAC/F,GAER,IAAIC,EAAcD,EAAY,IAAKE,GAAQA,EAAK,QAAU,EAAC,QAAST,GACpE,GAAIQ,GAAe,EAAI,CACtB,IAAIE,EAAeH,EAAaC,GAChC,OAAAD,EAAY,OAAOC,EAAa,CAAC,EACjC,MAAM,KAAM,KAAK,SAAW,2BAA4BE,EAAa,cAAe,KAAM,gBAAiB,WAAY,MAAO,EAAE,EAEzH,kBAAkB,KAAK,IAAKA,EAAa,cAAeA,EAAa,cAC/E,KAEG,cAAM,MAAO,oDAAqD,gBAAiB,WAAY,MAAO,GAC/F,EAER,CAMD,WAAY,CACX,aAAM,KAAM,2BAA4B,KAAK,SAAU,KAAM,gBAAiB,WAAY,YAAa,IAChG,KAAK,OAAQ,KAAK,QAAQ,CACjC,CAKD,OAAQX,EAAW,CAClB,IAAIQ,EAAc,kBAAkB,0BAA2BR,CAAQ,EACvE,GAAIQ,IAAgB,OAEnB,aAAM,KAAM,yGAA0G,gBAAiB,WAAY,SAAU,GAEtJ,GAIR,QAAU,EAAIA,EAAY,OAAS,EAAG,GAAK,EAAG,IACxCA,EAAY,CAAC,EAAE,oBAEnB,kBAAkB,KAAK,IAAKA,EAAY,CAAC,EAAE,cAAeA,EAAY,CAAC,EAAE,eACzE,MAAM,KAAM,gBAAkBA,EAAY,CAAC,EAAE,cAAgB,yBAA0B,gBAAiB,WAAY,SAAU,CAAC,EAC/HA,EAAY,OAAQ,EAAG,IAEvB,MAAM,KAAM,oDAAsDA,EAAY,CAAC,EAAE,cAAe,gBAAiB,WAAY,SAAU,CAAC,EAI1I,OAAK,CAAC,kBAAkB,0BAA2BR,CAAU,GAAI,kBAAkB,0BAA2BA,CAAQ,EAAG,SAAW,IAEnI,OAAO,kBAAkB,0BAA2BA,GAG9C,EACP,CACF,EC5LA,MAAM,aAAc,CAEnB,aAAc,CACb,CAWD,SAAUY,EAAOC,EAAO,CACvB,OAAKD,EACGC,GAAcD,EAEd,EAER,CAOD,cAAetF,EAAU,CACxB,IAAIwF,EAAS,GACb,QAAU,EAAI,EAAG,EAAIxF,EAAQ,OAAQ,IAAM,CAC1C,IAAIC,EAAS,KAAK,SAAUD,EAAQ,CAAC,EAAE,OAAQA,EAAQ,CAAC,EAAE,IAAI,EACzDC,GACJuF,EAAO,KAAMvF,EAEd,CACD,OAAOuF,EAAO,OAAS,EAAI,KAAOA,EAAO,KAAM,IAAI,EAAK,KAAO,EAC/D,CAKD,4BAA6BhG,EAAS,CAErC,OAAOA,EAAO,MAAO,gBAAgB,EAAG,KAAM,GAAG,EAAG,aACpD,CAKD,4BAA6BA,EAAS,CAErC,OAAOA,EAAO,MAAO,gBAAgB,EAAG,KAAM,GAAG,EAAG,aACpD,CAED,4BAA6BiG,EAAW,CACvC,IAAIC,EAEJ,OAAS,GAAI,CAEZ,KAAK,KAAK,sCAAuCD,CAAQ,IAAO,GAE/DC,EAAO,aAAa,YACpB,MACD,KAAKD,EAAS,QAAS,KAAK,IAAO,EAClCC,EAAO,aAAa,SACpB,MACD,KAAKD,EAAS,QAAS,eAAe,IAAO,GAC5CC,EAAO,aAAa,UACpB,MACD,KAAKD,EAAS,QAAS,qBAAwB,IAAMA,EAAS,SAAU,OAAO,IAAO,IACrFC,EAAO,aAAa,YACpB,MACD,KAAKD,EAAS,QAAS,WAAW,IAAO,GACxCC,EAAO,aAAa,UACpB,MACD,QAECA,EAAO,aAAa,WACrB,CAED,OAAOA,CACP,CAID,6BAA8BvB,EAAU,CACvC,IAAInE,EAAU,CACb,QAASmE,CAEZ,EAIE,MADiC,CAAC,0BAA2B,kBAAmB,mBAAoB,gBAAiB,gBAAiB,oBAAqB,eAAgB,uBAAwB,4BAA6B,eAAe,aAAa,EAC5N,SAAUA,KACzCnE,EAAQ,kBAAoB,IAGU,CAAC,eAAe,EACjB,SAAUmE,KAC/CnE,EAAQ,yBAA2B,IAKD,CAAC,kBAAmB,YAAa,sBAAuB,eAAe,EACxE,SAAUmE,KAC3CnE,EAAQ,wBAA0B,IAK/BmE,IAAY,QACfnE,EAAQ,YAAc,IAKD,CAAC,WAAY,eAAgB,gBAAiB,YAAa,gBAAiB,WAAY,cAAe,cAAc,EACtH,SAAUmE,KAC9BnE,EAAQ,eAAiB,IAGnBA,CACP,CAED,sCAAuCyF,EAAW,CAEjD,IAAIE,EAAc,OAAQF,EAAS,QAAQ,UAAU,EAAE,EAAI,cAC3D,OAAIE,IAAgB,QAAa,OAAOA,EAAY,eAAkB,SAC9DA,EAAY,cAEZ,EAER,CAQD,YAAaD,EAAM1F,EAAU,GAAI4F,EAAW,CAE3C,IAAIC,EAEJ,OAASH,EAAI,CACZ,KAAK,aAAa,UACjBG,EAAgB,KAAK,uBAAwB7F,GAC7C,MACD,KAAK,aAAa,SACjBA,EAAQ,YAAc,GACtB6F,EAAgB,KAAK,uBAAwB7F,GAC7C,MACD,KAAK,aAAa,UAEjB6F,EAAgB,oBAAoB,gBAAiB7F,GACrD,MACD,KAAK,aAAa,YAEjB6F,EAAgB,oBAAoB,sBAAuB7F,GAC3D,MACD,KAAK,aAAa,YACjB6F,EAAgB,KAAK,qBAAsB7F,CAAO,EAAK,KAAK,sCAAuCA,EAAQ,UAC3G,MACD,QACC,aAAM,MAAO,2DAA6DA,EAAQ,QAAS,mBAAoB,mBAAoB,cAAe,GAC3I,EACR,CAGD,GAAK4F,EACJA,EAAUC,CAAa,MAEvB,QAAOA,CAER,CAOD,uBAAwB7F,EAAU,GAAK,CACtC,aAAM,KAAM,mCAAqCA,EAAQ,QAAS,mBAAoB,mBAAoB,yBAA0B,IAE7H,KAAK,qBAAsBA,CAAO,EAAK,oBAAoB,gBAAiBA,EACnF,CAED,qBAAsBA,EAAU,GAAK,CAWpC,IAAIoD,EAAapD,EAAQ,QAAU,iBAYnC,MAX2B,gBAAgB,KAAK,SAAUA,EAAQ,YAAa,YAAa;AAAA,kBAC5E,KAAK,SAAUA,EAAQ,YAAa,MAAQ,IAAG,KAAK,4BAA6BA,EAAQ,OAAO,CAAE,0BAA0BoD,CAAU,IAAI,KAAK,cAAe,CAC7K,CAAE,OAAQpD,EAAQ,YAAa,KAAM,qBAAuB,EAC5D,CAAE,OAAQA,EAAQ,wBAAyB,KAAM,6BAA+B,CACnF,EAAK;AAAA,sBAQH,CAED,gBAAiBA,EAAU,GAAK,CAG/B,IAAI8F,EAAe,KAAK,4BAA6B9F,EAAQ,OAAS,EAAG,kBACrE+F,EAAkB,KAAK,4BAA6B/F,EAAQ,OAAS,EAAG,QAS5E,MARoB;AAAA,2CACqB,KAAK,SAAU+F,CAAiB,IAAG,KAAK,SAAU/F,EAAQ,YAAa,WAAa,UAAS,KAAK,SAAU8F,CAAY,CAAE;AAAA,MAC/J,KAAK,SAAU9F,EAAQ,yBAA0B,uCAAuC,CAAE;AAAA;AAAA,MAE1F,KAAK,gBAAiBA,EAAS;AAAA;AAAA,GAKnC,CAED,gBAAiBA,EAAU,GAAK,CAiB/B,MAfoB;AAAA;AAAA,KAEjB,KAAK,SAAU,CAACA,EAAQ,aAAe,CAACA,EAAQ,eAAgB,8EAA+E;AAAA;AAAA;AAAA,KAG/I,KAAK,SAAUA,EAAQ,YAAa,iCAAiC,CAAE;AAAA;AAAA,KAEvE,KAAK,SAAUA,EAAQ,YAAa,QAAQ,CAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASjD,CAED,gBAAiBA,EAAU,GAAK,CAK/B,IAAIgG,EAAa,KAAK,4BAA6BhG,EAAQ,OAAS,EAAG,qBACnEiG,EAAkBjG,EAAQ,QAAU,WAgBxC,MAfyB;AAAA,gDACqB,KAAK,SAAUiG,EAAiB;AAAA,yCACvC,KAAK,SAAUD,EAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAclE,CAED,WAAYhG,EAAU,GAAK,CAC1B,IAAIkG,EAAkBlG,EAAQ,gBAC1BmG,EAAsBnG,EAAQ,oBAC9BoG,EAASpG,EAAQ,aAAe,GAChCqG,EAASrG,EAAQ,OA6BrB,MAZe;AAAA,cACHqG,CAAM,8CAA8C,KAAK,SAAUD,EAAQ,YAAa;AAAA,qCACjEC,CAAM;AAAA,+BACZ,KAAK,SAAUD,EAAQ,WAAa,IAAG,KAAK,SAAU,CAACF,EAAiB,qBAAsB;AAAA,OACtH,KAAK,SAAUA,EAAiB,mCAAmC,CAAE;AAAA;AAAA,OAErE,KAAK,SAAUE,EArBS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAqBqB,CAAE;AAAA,OAC/C,KAAK,SAAUD,EAXC;AAAA;AAAA;AAAA,WAWkC,CAAE;AAAA;AAAA;AAAA,GAMzD,CAED,SAAUnG,EAAU,GAAK,CAkBxB,MAjBe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAkBf,CAED,sBAAuBA,EAAU,GAAK,CAMrC,IAAIgG,EAAa,KAAK,4BAA6BhG,EAAQ,OAAS,EAAG,gBA4FvE,MA3FyB;AAAA;AAAA,yCAEc,KAAK,SAAUgG,EAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAY5D,KAAK,SAAUhG,EAAQ,mBAAuBA,EAAQ,SAAWA,EAAQ,UAAY,sBAAyB,8DAA8D,CAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAsB/K,KAAK,SAAUA,EAAQ,kBAAmB;AAAA;AAAA;AAAA;AAAA;AAAA,aAMjD,CAAM;AAAA,OACC,KAAK,SAAUA,EAAQ,SAAWA,EAAQ,UAAY,sBAAuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAYpF,CAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAqCJ,CAiBF,CAMA,MAAM,aAAe,OAAO,OAAQ,CACnC,UAAW,OAAQ,WAAW,EAC9B,SAAU,OAAQ,UAAU,EAC5B,UAAW,OAAQ,WAAW,EAC9B,YAAa,OAAQ,aAAa,EAClC,YAAa,OAAQ,aAAa,EAClC,YAAa,OAAQ,aAAa,CACnC,GAEM,oBAAsB,IAAI,cAChC,OAAO,UAAY,oBCrcnB,MAAM,UAAW,CAChB,aAAc,CACb,KAAK,wBAA0B,EAC/B,CAED,eAAgBsG,EAAUC,EAAiBC,EAAa,CACvD,GAAIF,IAAa,OAChB,aAAM,MAAO,gDAAiD,gBAAiB,aAAc,iBAAkB,GACxG,GAGR,GAAI,SAAS,eAAgBA,CAAQ,IAAO,KAC3C,aAAM,MAAO,oBAAqBA,EAAW,+BAAgC,gBAAiB,aAAc,iBAAkB,GACvH,GAGR,GAAI,KAAK,wBAAyBA,CAAQ,IAAO,OAChD,aAAM,MAAO,qBAAsBA,EAAU,gCAAiC,gBAAiB,aAAc,iBAAkB,GACxH,GAGRE,EAAaA,GAAc,GAC3BA,EAAW,aAAeA,EAAW,cAAgBF,EACrD,IAAIG,EAAkB,IAAMH,EACxBI,EAAmB,UAAWH,EAAiBC,CAAU,EAE7DE,EAAiB,IAAK,SAAU,CAAE,OAAQ,GAAM,WAAY,QAAQ,CAAE,EACtEA,EAAiB,IAAK,gBACtBA,EAAiB,UAAU,UAAW,OAAO,EAE7C,IAAIC,EAAyBD,EAAiB,MAAOD,CAAe,EAEpE,YAAK,wBAAyBH,GAAa,CAC1C,SAAUA,EACV,kBAAmBI,EACnB,wBAAyBC,CAC5B,EAES,KAAK,wBAAyBL,EACrC,CACD,iBAAmBA,EAAW,CAC7B,OAAI,KAAK,wBAAyBA,CAAU,GAAI,KAAK,wBAAyBA,CAAU,EAAC,yBACxF,KAAK,wBAAyBA,CAAU,EAAC,kBAAkB,QAAO,EAClE,OAAO,KAAK,wBAAyBA,GACrC,MAAM,KAAM,qCAAsCA,EAAU,KAAM,gBAAiB,aAAc,mBAAoB,GAC9G,KAEP,MAAM,KAAM,qDAAsDA,EAAU,4BAA6B,gBAAiB,aAAc,mBAAoB,GACrJ,GAER,CAEF,CAEA,MAAe,iBAAI,WCjEJ,utBC8BV5I,YAAU,CACX,SAAU,CACN,KAAK,UAAY,IAAI,WAAY,CAC7B,aAAc,KAAK,YACvB,EACH,EACD,SAAU,CACN,KAAK,gBAAe,CACvB,EACD,MAAO,CACH,QAAS,CACL,KAAM,OACN,QAAS,IACZ,EACD,aAAc,CACV,KAAM,OACN,QAAS,IACZ,EACD,aAAc,CACV,KAAM,OACN,QAAS,WACZ,EACD,UAAW,CACP,KAAM,OACN,QAAS,EACZ,EACD,SAAU,CACN,KAAM,OACN,QAAS,CAAC,CACb,EACD,sBAAuB,CACnB,KAAM,SACN,QAAS,IACZ,EACD,oBAAqB,CACjB,KAAM,QACN,QAAS,EACZ,CACJ,EACD,MAAO,CACH,MAAO,CACH,YAAa,GACb,aAAc,GACd,uBAAwB,GACxB,KAAM,KAAK,SAAS,KACpB,QAAS,KAAK,SAAS,QACvB,cAAe,GACf,mBAAoB,MAAM,kBAC1B,sBAAuB,UAAW,eAAc,IAAQ,GACxD,SACA,OAAQ,CACJ,MAAO,EAAE,KAAK,EAAG,yBAA2B,EAC5C,KAAM,KAAK,SAAS,oBACpB,SAAU,EAAE,KAAK,EAAG,UAAY,EAChC,iBAAkB,EAAE,KAAK,EAAG,kBAAoB,EAChD,YAAa,EAAE,KAAK,EAAG,uCAAyC,CACpE,EAEP,EACD,SAAU,CACN,aAAc,CACV,GAAK,KAAK,yBAA2B,GACjC,OAAO,EAAE,KAAK,EAAG,cAAa,EAC3B,GAAK,KAAK,OAAS,WACtB,OAAO,EAAE,KAAK,EAAG,oBACd,GAAK,KAAK,OAAS,eACtB,OAAO,EAAE,KAAK,EAAG,QAAO,EACrB,GAAK,KAAK,OAAS,OACtB,OAAO,EAAE,KAAK,EAAG,QAAO,CAE/B,EACD,8BAA+B,CAE3B,OAAO,UAAW,eAAgB,IAAM,KAAQ,KAAK,OAAS,YAAc,KAAK,OAAS,iBAAoB,KAAK,sBAAwB,EAC/I,CACH,EACD,QAAS,CACL,iBAAkB,CACd,OAAS,KAAK,MACV,IAAK,OACL,IAAK,WACD,MACJ,IAAK,eACD,KAAK,4BAA2B,EAChC,MACJ,IAAK,QACD,KAAK,MAAK,EACV,KACR,CACH,EACD,WAAYkJ,EAAO,CACf,KAAK,KAAOA,EACZ,WAAY,IAAM,CAEd,KAAK,gBAAe,CACvB,EAAE,GAAE,CACR,EACD,aAAcC,EAAQ,CAGlB,OAFAA,EAAM,eAAc,EAEX,KAAK,MACV,IAAK,OACD,OAAO,UAAW,KAAK,UAAW,KAAK,SAAS,aAAc,IAC9D,KAAK,gBAAe,EACpB,MACJ,IAAK,WACD,KAAK,MAAK,EACV,MACJ,IAAK,eACD,KAAK,4BAA2B,EAChC,IAAIC,EAAgB,SAAS,cAAe,oBAAmB,EAC/DA,EAAc,SAAW,GACzB,KAAK,uBAAyB,GAC9B,WAAY,IAAM,CACdA,EAAc,SAAW,GACzB,KAAK,uBAAyB,EACjC,EAAE,KACH,KACR,CACH,EACD,qBAAsB,CAGlB,KAAK,mBAAmB,oBAAqB,GAAO,eAAe,aAAc,EAAE,GAAI,CAAE,eAAgB,IAAQ,CAC7G,SAAYC,GAAS,CAErB,CACJ,EACH,EACD,6BAA8B,CAC1B,KAAK,mBAAmB,4BAA6B,CACjD,SAAYA,GAAS,CAErB,CACJ,EACH,EACD,uBAAwBC,EAAe,CACnC,IAAIC,EAAe,qCAEd,KAAK,SAAW,MACjBA,EAAe,6BAEnB,KAAK,mBAAmBA,CAAY,EAAG,KAAK,sBAAuB,CAC/D,SAAYC,GAAc,CACtB,GAAKA,EAAS,UAAY,CACtB,IAAIjH,EAASiH,EAAS,YACjBjH,EAAO,SAAW,aACnB,KAAK,WAAU,EACf,KAAK,sBAAuB,KACpBA,EAAO,SAAW,iBAC1B,KAAK,cAAe+G,GACZ/G,EAAO,SAAW,cAC1B,KAAK,WAAU,EACf,cAAc,UAAW,EAAE,KAAK,EAAG,mEAAoE,EAAE,KAAK,EAAG,sCAAuC,UAG5J,KAAK,WAAU,CAEtB,EACD,QAAWkH,GAAS,CAChB,KAAK,WAAU,CACnB,CACJ,EACH,EACD,cAAeH,EAAe,CACrBA,EAAe,GAChB,KAAK,uBAAwBA,EAAe,IAE5C,KAAK,WAAU,EACf,cAAc,UAAW,EAAE,KAAK,EAAG,0DAA2D,EAAE,KAAK,EAAG,sCAAuC,IAEtJ,EACD,6BAA8B,CAC1B,KAAK,aAAe,GACpB,KAAK,4BAA2B,EAChC,KAAK,uBAAwB,GAE7B,YAAY,kBAAiB,CAChC,EACD,iBAAkB,CACd,KAAK,aAAe,GACpB,KAAK,uBAAwB,GAE7B,YAAY,kBAAiB,CAChC,EACD,yBAA0B,CACtB,GAAK,MAAM,QAAS,EAAE,OAAQ,EAC1B,QAAUzG,EAAI,EAAGA,EAAI,EAAE,QAAQ,OAAQA,IAC9B,EAAE,QAAQA,CAAC,EAAE,IAAI,SAAU,uCAC5B,EAAE,QAAQA,CAAC,EAAE,MAAM,MAAK,CAIvC,EACD,YAAa,CACT,KAAK,UAAU,KAAM,WAAY,wBAAyB,CACtD,OAAQ,EACZ,GACA,KAAK,aAAe,GACpB,KAAK,wBAAuB,EAC5B6G,aAAW,iBAAkB,KAAK,aACrC,EACD,OAAQ,CACJ,GAAK,KAAK,aAAe,GACrB,OAGJ,KAAK,YAAc,GAEnB,IAAIC,EAAqB,KAAK,aAEzB,KAAK,cAAgB,yBAA2B,KAAK,QAAU,IAChEA,EAAqB,yBAGzBC,SAAO,MAAO,KAAK,UAAW,KAAK,cAAeD,EAAoB,KAAK,oBAAuBN,GAAS,CAGvG,GAFA,KAAK,YAAc,GAEdA,EAAI,UAAY,CACjB,IAAI9G,EAAS8G,EAAI,YAEZ,KAAK,SAAW,GACjB,KAAK,YAAc,GACnB,KAAK,sBAAuB,KACpB,KAAK,SAAW,IAAM9G,EAAO,IAAI,MAAQ,gBACjD,KAAK,WAAY,eAEzB,CACJ,EACH,CACJ,EACD,WAAY,CACR,UAAAsH,OACA,SAAAC,SACA,gBAAAC,SACA,SAAAC,QACJ,CACJ,EA1QS5J,aAAA,OAAM,WAAW,EACbF,aAAA,OAAM,mBAAmB,EAFtCG,aAAA,QAIgB4J,aAAA,OAAM,iBAAiB,EAIgBC,aAAA,OAAM,kCAAkC,EACvEC,aAAA,OAAM,gBAAgB,EAGaC,aAAA,OAAM,oBAAoB,gBAE1D,MAAM,kBAAkB,IAAI,6JAbnD,OAAAC,UAAA,EAAAlK,mBAkBM,MAlBNC,aAkBM,CAjBFH,gBAgBM,MAhBNC,aAgBM,CAfFD,gBAA0D,QAAnD,4BAAOqK,EAAU,YAAAA,EAAA,cAAA3K,CAAA,GAAE,MAAM,mBAAkB,GAAC,EAAOM,gBAA6C,OAAxC,MAAM,kBAAmB,IAAKsK,EAAQ,QAHjH,SAAAlK,YAAA,EAIYJ,gBAAmD,KAAnDgK,aAA+BO,gBAAAD,EAAA,OAAO,KAAK,KAC3CE,eAAAxK,gBAAgF,KAA5C,MAAM,gBAAgB,EAAIuK,gBAAAD,EAAA,OAAO,IAAI,oBAAzD,MAAI,cACGA,EAAY,0BAAnCG,YAA4GC,EAAA,CANxH,MAMiD,OAA8B,4BAAC,YAAY,IAAI,kBAAkB,QANlHC,mBAAA,OAOY3K,gBAUO,QAVA,6BAAQqK,EAAY,cAAAA,EAAA,gBAAA3K,CAAA,GAAE,MAAM,iBAAiB,GAAG,eACnD8K,eAAAxK,gBAGM,MAHNiK,aAGM,CAFFjK,gBAA6D,KAA7DkK,aAA8BK,gBAAAD,EAAA,OAAO,gBAAgB,KACrDM,YAAkJC,EAAA,CAAxI,GAAG,iBAAkB,YAAaP,EAAM,OAAC,SAVvE,WAU0FA,EAAa,cAVvG,sBAAAQ,EAAA,KAAAA,EAAA,GAAAC,GAU0FT,EAAa,cAAAS,GAAE,IAAI,iBAAkB,SAAU,GAAO,uEAF9G,OAAI,cAItBP,eAAAxK,gBAGM,MAHNmK,aAGM,CAFFS,YAA8GI,EAAA,CAApG,QAAQ,cAAe,SAAQX,EAAmB,oBAbhF,WAa2FC,EAAqB,sBAbhH,sBAAAQ,EAAA,KAAAA,EAAA,GAAAC,GAa2FT,EAAqB,sBAAAS,GAAG,OAAQ,sCACvG/K,gBAAiF,QAAjFiL,aAAoDV,gBAAAD,EAAA,OAAO,WAAW,mBAF7DD,EAA4B,gCAIzCrK,gBAAiL,UAAzK,KAAK,SAAS,GAAG,oBAAoB,MAhB7DkL,eAAA,CAgBmE,mBAAkB,sBAAiC,OAAI,kBAAwB,4BAAOb,EAAY,cAAAA,EAAA,gBAAA3K,CAAA,oBAAK2K,EAAW,+ICShLtK,YAAU,CACX,SAAU,CACN,KAAK,UAAY,IAAI,WAAY,CAC7B,aAAc,KAAK,YACvB,EACH,EACD,SAAU,CACN,KAAK,cAAa,CACrB,EACD,MAAO,CACH,QAAS,CACL,KAAM,OACN,QAAS,IACZ,EACD,aAAc,CACV,KAAM,OACN,QAAS,IACZ,EACD,aAAc,CACV,KAAM,OACN,QAAS,WACZ,EACD,UAAW,CACP,KAAM,OACN,QAAS,EACZ,EACD,sBAAuB,CACnB,KAAM,OACN,QAAS,CAAC,CACb,EACD,sBAAuB,CACnB,KAAM,SACN,QAAS,IACZ,EACD,oBAAqB,CACjB,KAAM,QACN,QAAS,EACZ,CACJ,EACD,MAAO,CACH,MAAO,CACH,KAAM,KAAK,sBAAsB,KACjC,QAAS,KAAK,sBAAsB,QACpC,cAAe,KAAK,sBAAsB,cAC1C,gBAAiB,GACjB,SACA,OAAQ,CACJ,MAAO,KAAK,sBAAsB,MAClC,KAAM,KAAK,sBAAsB,KACjC,iBAAmB,KAAK,sBAAsB,gBAClD,EAEP,EACD,SAAU,CACN,aAAc,CACV,OAAK,KAAK,OAAS,eACR,EAAE,KAAK,EAAG,UAAS,EAGvB,EAAE,KAAK,EAAG,SAAQ,CAC5B,EACD,eAAgB,CACZ,MAAO,CAAC,KAAK,eAAiB,KAAK,kBAAoB,KAAK,OAAO,gBACtE,EACD,uBAAwB,CACpB,OAAO,EAAE,KAAK,OAAQ,+BAAgC,CAAE,KAAK,OAAO,gBAAe,EACvF,CAEH,EACD,MAAO,CACH,iBAAkB,CACd,KAAK,cAAa,CACtB,CACH,EACD,QAAS,CACL,eAAgB,CACZ,OAAK,KAAK,eACD,KAAK,eACN,KAAK,MAAM,gBAAgB,IAAI,UAAU,OAAQ,aAErD,KAAK,MAAM,cAAc,SAAW,GACpC,KAAK,MAAM,cAAc,MAAM,gBAAkB,UAC1C,KAEF,KAAK,eACN,KAAK,MAAM,gBAAgB,IAAI,UAAU,IAAK,aAElD,KAAK,MAAM,cAAc,SAAW,GACpC,KAAK,MAAM,cAAc,MAAM,gBAAkB,UAC1C,GAEd,EACD,aAAcmJ,EAAQ,CAGlB,OAFAA,EAAM,eAAc,EAEX,KAAK,MACV,IAAK,eACI,KAAK,gBACD,KAAK,uBACN,KAAK,sBAAuB,IAGhC,KAAK,WAAU,GAEnB,KACR,CACH,EACD,YAAa,CACTO,aAAW,iBAAkB,KAAK,aACrC,CACJ,EACD,WAAY,CACR,UAAAG,OACA,SAAAuB,SACA,SAAAtB,SACA,gBAAAC,QACJ,CACJ,EA7IS3J,aAAA,OAAM,wBAAwB,EAC1BF,aAAA,OAAM,gCAAgC,EAFnDG,aAAA,QAIgB4J,aAAA,OAAM,8BAA8B,EAE/BC,aAAA,OAAM,mCAAmC,EAN9DC,aAAA,kCAQkD,MAAM,6FAPpD,OAAAE,UAAA,EAAAlK,mBAaM,MAbNC,aAaM,CAZFH,gBAWM,MAXNC,aAWM,MAVgB,cAH9B0K,mBAAA,oBAGYzK,mBAAkG,QAH9G,MAG8C,4BAAOmK,EAAU,YAAAA,EAAA,cAAA3K,CAAA,GAAE,MAAM,gCAA+B,GAAC,GAAOM,gBAA0D,OAArD,MAAM,+BAAgC,IAAKsK,EAAQ,QAHtK,SAAAlK,YAAA,EAIYJ,gBAAgE,KAAhEgK,aAA4CO,gBAAAD,EAAA,OAAO,KAAK,KACxDtK,gBAOO,QAPA,6BAAQqK,EAAY,cAAAA,EAAA,gBAAA3K,CAAA,GAAE,MAAM,iBAAiB,GAAG,mBACnDM,gBAIM,MAJNiK,aAIM,CAHFjK,gBAAoD,OAA/C,GAAG,iBAAiB,UAAQsK,EAAM,OAAC,IAP5D,SAAAJ,YAAA,OAQmC,2BAAfhK,mBAAsF,KAAtFiK,aAAsFI,gBAA7BF,EAAqB,2BARlGM,mBAAA,YAS0C,2BAAtBF,YAA6MW,EAAA,CATjO,MASyD,GAAG,kBAAkB,aAAa,MAAO,YAAad,EAAM,OAAC,iBATtH,WASiJA,EAAe,gBAThK,sBAAAQ,EAAA,KAAAA,EAAA,GAAAC,GASiJT,EAAe,gBAAAS,GAAE,IAAI,kBAAmB,SAAU,GAAO,qDAT1MJ,mBAAA,SAWgB3K,gBAAoK,UAA5J,KAAK,SAAS,GAAG,iCAAiC,IAAI,gBAAgB,MAAM,gCAAiC,4BAAOqK,EAAY,cAAAA,EAAA,gBAAA3K,CAAA,oBAAK2K,EAAW,oICO9J,IAACV,SAAS,UAAW,CAC/B,EACAA,SAAO,UAAY,IAAI0B,aAAW,CAAE,QAAS,QAAU,GACvD1B,SAAO,eAAiB,kBACxBA,SAAO,aAAe,GAEtBA,SAAO,eAAiB,GAExBA,SAAO,cAAgB,IAEvBA,SAAO,MAAQ,UAQfA,SAAO,cAAgB,EAEvBA,SAAO,aAAe,KAEtBA,SAAO,mBAAqB,SAAU2B,EAAO,CAC5C,IAAIC,EAAQD,EACRE,EAAUrM,OAAG,QACbsM,EAAaD,EAAQ,YACrBE,EAAgBD,EAAaD,EAAQ,OAAM,EAC/C,GAAK,CAACD,EAAM,SACX,MAAO,GAER,IAAII,EAAUJ,EAAM,OAAM,EAAG,IAG7B,OAAOI,EAAUD,CAClB,EAGA/B,SAAO,4BAA8B,SAAUiC,EAAU,CACxD,OAAOA,GAAWA,EAAQ,aAAeA,EAAQ,YAClD,EAGAjC,SAAO,8BAAgC,SAAUiC,EAAU,CAC1D,OAAOA,GAAWA,EAAQ,YAAcA,EAAQ,WACjD,EAGAjC,SAAO,kBAAoB,UAAW,CACrC,GAAK,eAAe,kBAAmB,EAAG,EACnC,OAAO,eAAe,oBAG7B,IAAIkC,EAAa,SAAS,cAAc,KAAK,EAC7CA,EAAW,MAAM,WAAa,SAC9BA,EAAW,MAAM,SAAW,SAC5B,SAAS,KAAK,YAAYA,CAAU,EACpC,IAAIC,EAAmBD,EAAW,YAAcA,EAAW,YAC3D,gBAAS,KAAK,YAAYA,CAAU,EAG9BC,IACCA,EAAmB,IAG1B,eAAe,kBAAmBA,GAE3BA,CACR,EAGAnC,SAAO,mBAAqB,UAAW,CACtC,GAAK,eAAe,mBAAoB,EAAG,EAC1C,OAAO,eAAe,qBAGvB,IAAIkC,EAAa,SAAS,cAAc,KAAK,EAC7CA,EAAW,MAAM,WAAa,SAC9BA,EAAW,MAAM,SAAW,SAC5B,SAAS,KAAK,YAAYA,CAAU,EACpC,IAAIE,EAAoBF,EAAW,aAAeA,EAAW,aAC7D,gBAAS,KAAK,YAAYA,CAAU,EAG9BE,IACLA,EAAoB,IAGrB,eAAe,mBAAoBA,GAE5BA,CACR,EAEApC,SAAO,SAAW,CACjB,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,IACN,GAAM,GACP,EAEAA,SAAO,kBAAoB,GAI3BA,SAAO,SAAW,GAElBA,SAAO,gBAAkB,UAAW,OACnC,IAAIqC,EAAe,UAAU,CAAC,EAC1BC,EAAY,UAAU,CAAC,EACvBC,EAAO,UAAU,CAAC,EAClBC,EAAM,UAAU,CAAC,EACjBC,EAAY,UAAU,CAAC,EAM3B,GAJA,UAAU,MAAO,mBACjB,UAAU,gBAAiB,GAC3B,UAAU,aAAc,MAEnB,UAAU,QAAU,CACxB,IAAIC,EAAoB,SAAUC,EAAWF,EAAY,CACnDzC,SAAO,kBAAiB,GAAM,OAAO,QAAY,IACrD,YAAa,SAAS,IAAM,EAAC,KAAM,SAAU4C,EAAS,CACrD,IAAIC,EAAeD,EAAO,UAAS,EAAG,MAAO,GAAG,EAAG,CAAC,EACpDE,EAAqBH,EAAWF,EAAWI,EAChD,GAEIC,EAAqBH,EAAWF,EAAW,KAE/C,EAEMK,EAAsB,SAAUH,EAAWF,EAAWI,EAAe,CACxE,GAAKJ,EAAY,CAChB,IAAIM,EAAsB,SAAUC,EAAaL,EAAWF,EAAWI,EAAe,CACrF,IAAII,EAAoBD,EAAY,IAAK,SAAUE,EAAK,CACvD,MAAO,KAAOA,EAAG,UACvB,GAAS,KAAM;AAAA,GAEVP,EAAYA,EAAY;AAAA;AAAA;AAAA;AAAA,EAAwCF,EAAU,KAAO,KAAOA,EAAU,QAAU;AAAA,EAAOQ,EACnHN,EAAYA,EAAY;AAAA;AAAA;AAAA;AAAA,EAAqCF,EAAU,MAEvEU,EAAiBR,EAAWF,EAAWI,EAC5C,EAEQO,EAAqB,SAAUT,EAAWF,EAAWI,EAAe,CACvE,QAAQ,MAAO,4CACfM,EAAiBR,EAAWF,EAAWI,EAC5C,EAEI,WAAW,UAAWJ,GAAY,KAAMO,GAAeD,EAAqBC,EAAaL,EAAWF,EAAWI,EAAgB,EAAC,MAAOQ,GAASD,EAAoBT,EAAWF,EAAWI,CAAY,EAC1M,MACIM,EAAiBR,EAAWF,EAAWI,EAE3C,EAEMM,EAAkB,SAAUR,EAAWF,EAAWI,EAAe,CACpE,MAAM,KAAM,UAAYF,EAAW,YAAa,GAAI,kBAAmB,GAEvE,IAAIW,EAAqBlH,QAAM,kBAC/BkH,EAAmB,gBAAiBX,EAAWE,EAAc,CAC5D,SAAU,SAAUlK,EAAS,CAC5B,GAAK,CAACqH,SAAO,0BAA4B,UAAU,eAAe,aAAe,IAAQrH,EAAO,UAAW,IAAK,UAAU,eAAe,kBAAoB,CAC5JA,EAASA,EAAO,YAChB,IAAI4K,EAAU/N,OAAE,KAAK,EAAG,uKAA0K,WAAaA,OAAE,KAAK,EAAG,eAAe,EAAK,MAAQmD,EAAS,OAASnD,OAAE,KAAK,EAAG,gBAAgB,EAAK,KAAO,UAAU,eAAe,kBACtUwK,SAAO,yBAA2B,GAClCA,SAAO,gBAAiB,+DAAsErH,EAAS,oBAA2B,UAAU,eAAe,kBAAmBO,gBAAc,SAAU,GAAI,GAAI,IAE9M,IAAIsK,EAAkB,OAAO,WAAY,UAAW,CACnD,OAAO,SAAS,OAAQ,GACxB,EAAE,IAAM,EAET,cAAc,UAAWD,EAAS,GAAI,UAAW,CAChD,eAAe,kBAAoB,GACnC,MAAM,KAAM,0DAA2D,YAAa,SAAU,uBAAwB,IACtH,OAAO,aAAcC,GACrB,OAAO,SAAS,OAAQ,GAC/B,EACA,MAAiBxD,SAAO,2BAClBA,SAAO,yBAA2B,GAEnC,CACL,EACA,EAEMyD,EAAa,eAAe,eAKhC,GAAKnB,GAAa,OAAOA,GAAa,UAAYA,EAAU,QAAS,cAAgB,GAAI,EAAI,CAC5F,QAAQ,MAAO,kFACf,MACA,CAED,GAAKD,EAAa,QAAS,cAAc,GAAM,GAC9CA,EAAa,QAAS,mBAAmB,GAAM,GAC/CA,EAAa,QAAS,oCAAsC,GAAM,GAClEA,EAAa,QAAS,eAAe,GAAM,GAC3CA,EAAa,QAAS,oCAAoC,GAAM,GAChEA,EAAa,QAAS,8DAA8D,GAAM,GAC1FA,EAAa,QAAS,WAAW,GAAM,GACvCA,EAAa,QAAS,WAAW,GAAM,GACvCA,EAAa,QAAS,wBAAwB,GAAM,GACpDA,EAAa,QAAS,UAAU,GAAM,EACpC,CACF,QAAQ,MAAO,2DACf,MACA,CAED,GAAKrC,SAAO,UAAY,GAAK,CAC5B,MAAM,KAAM,6DAA8D,YAAa,GAAI,kBAAmB,GACzG,OAAS,KAAW,KAAe,UAAU,eAAe,oBAAsB,IACtF,KAAM,QAAS,YAAa,CAC3B,cAAiB,iBAAmBqC,EAAe,WAAgBC,EAAcA,EAAU,QAAStC,SAAO,WAAY,EAAE,EAAE,EAAK,OAAU,UAAYuC,EACtJ,QAAW,EAChB,CAAO,EAGJ,MACA,CAED,IAAIc,EAGAK,EAAc,YACb1D,SAAO,MAAO,cAAc,GAAMA,SAAO,MAAO,eAAe,+BAAiC,GAAIA,SAAO,MAAO,eAAe,gCAAgC,WAAW,IAChL0D,EAAc,eAAe,gCAAgC,aAG9D,IAAIC,EACC,UAAU,eACdA,EAAiB,UAAU,eAE3BA,EAAiB,KAGlB,IAAIC,EACC5D,SAAO,MAAO,cAAgB,GAAI,eAAe,gBACrD4D,EAAsB,eAAe,oBAErCA,EAAsB,KAGlBH,GAAc,MAAM,QACxBJ,EAAQ,mBAAqB,UAAU,eAAe,kBAAoB;AAAA;AAAA,uBAA8BK,EAAc;AAAA;AAAA,SAAgBrB,EAAe,QAAUC,EAAY,UAAYC,EAAO,IAAMC,EAAM;AAAA;AAAA,QAAeiB,EAAW,UAAY;AAAA;AAAA,OAAc,OAAO,SAAS,KAAO;AAAA;AAAA,cAAqB,UAAU,UAAY;AAAA;AAAA,gBAA6BzD,SAAO,aAAe;AAAA;AAAA,aAAoBA,SAAO,UAAY;AAAA;AAAA,kBAAyB,eAAe,aAAc,EAAG;AAAA;AAAA;AAAA,EAAgC,MAAM,QAASyD,GAAe;AAAA;AAAA;AAAA,EAAmC,MAAM,QAASG,CAAmB,EAAK;AAAA;AAAA;AAAA,EAAqB,MAAM,QAASD,CAAc,EAAK,IAElpBN,EAAQ,mBAAqB,UAAU,eAAe,kBAAoB;AAAA;AAAA,uBAA8BK,EAAc;AAAA;AAAA,SAAgBrB,EAAe,QAAUC,EAAY,UAAYC,EAAO,IAAMC,EAAM;AAAA;AAAA;AAAA;AAAA,OAAgC,OAAO,SAAS,KAAO;AAAA;AAAA,cAA2B,UAAU,UAGvS,QAAQ,MAAO;AAAA;AAAA,EAA2Ea,EAAQ;AAAA,8CAAiD,EACnJ,SAGK,UAAU,eAAe,aAAe,IAAQ,UAAU,eAAe,YAAc,IAAQ,UAAU,eAAe,UAAY,IACxI,MAAO;AAAA;AAAA,EAA2EA,EAAQ;AAAA,gDAGtF,OAAS,KAAW,KAAe,UAAU,eAAe,oBAAsB,IAGtF,KAAM,QAAS,YAAa,CAC3B,cAAiBhB,EAAe,WAAgBC,EAAcA,EAAU,QAAStC,SAAO,WAAU,EAAI,EAAI,EAAG,OAAU,UAAYuC,EAAO,IAAMC,EAChJ,QAAW,EACf,CAAM,EAGC,OAAS,QAAc,KAAe,UAAU,eAAe,oBAAsB,KACzF,QAAQ,MAAO,YAAa,QAC5B,QAAQ,MAAO,UAAUqB,EAAA,2CAAgB,iBAAhB,YAAAA,EAAgC,KAYrDD,IACJP,EAAQA,EAAQ;AAAA;AAAA,mBAA+BO,EAAoB,oBAGpEP,EAAQA,EAAQ;AAAA;AAAA;AAAA,yBAAuC,KAAK,UAAW,eAAe,eAAgB,OAAW,GACjHA,EAAQA,EAAQ;AAAA;AAAA;AAAA,cAA4B,KAAK,UAAW,eAAe,UAAW,OAAW,GAEjGX,EAAmBW,EAAOZ,EAC1B,CACF,EAEAzC,SAAO,kBAAoB,UAAW,CACrCA,SAAO,iBAAmBxK,OAAE,KAAK,EAAG,uFAAuF,EAE3HwK,SAAO,SAAW,MAAQxK,OAAE,KAAK,EAAG,KAAO,EAAG,MAE9CwK,SAAO,SAAW,MAAQxK,OAAE,KAAK,EAAG,KAAO,EAAG,MAE9CwK,SAAO,UAAYxK,OAAE,KAAK,EAAG,MAAM,EAEnCwK,SAAO,cAAgB,MAEvBA,SAAO,eAAiB,MAAQxK,OAAE,KAAK,EAAG,WAAa,EAAG,MAE1DwK,SAAO,aAAe,MAAQxK,OAAE,KAAK,EAAG,SAAW,EAAG,MAEtDwK,SAAO,cAAgB,MAAQxK,OAAE,KAAK,EAAG,UAAY,EAAG,MAExDwK,SAAO,UAAY,MAAQxK,OAAE,KAAK,EAAG,MAAQ,EAAG,MAEhDwK,SAAO,WAAa,MAAQxK,OAAE,KAAK,EAAG,MAAQ,EAAG,MAEjDwK,SAAO,kBAAoBxK,OAAE,KAAK,EAAG,kCAAoC,EAEzEwK,SAAO,uBAAyBxK,OAAE,KAAK,EAAG,gDAAkD,EAE5FwK,SAAO,kBAAoBxK,OAAE,KAAK,EAAG,kBAAkB,EAEvDwK,SAAO,0BAA4BxK,OAAE,KAAK,EAAG,2DAA2D,EAExGwK,SAAO,qBAAuBxK,OAAE,KAAK,EAAG,wBAAwB,EAEhEwK,SAAO,qBAAuBxK,OAAE,KAAK,EAAG,iGAAiG,EAEzIwK,SAAO,yBAA2BxK,OAAE,KAAK,EAAG,+MAA+M,EAE3PwK,SAAO,wBAA0BxK,OAAE,KAAK,EAAG,mDAAmD,EAE9FwK,SAAO,uBAAyBxK,OAAE,KAAK,EAAG,mHAAmH,EAE7JwK,SAAO,+BAAiCxK,OAAE,KAAK,EAAG,gIAAgI,EAElLwK,SAAO,8BAAgCxK,OAAE,KAAK,EAAG,+EAA+E,EAEhIwK,SAAO,qCAAuCxK,OAAE,KAAK,EAAG,2GAA2G,EAEnKwK,SAAO,iCAAmCxK,OAAE,KAAK,EAAG,mIAAmI,CACxL,EAEAwK,SAAO,kBAAoB,UAAW,CACrC,IAAIuD,EAAU/N,OAAE,KAAK,EAAG,yCAA2C,EAClE,IAAM,eAAe,eAAe,iBAAmB,IAExD,OAAKwK,SAAO,kBAAmB,EAAG,GAEjCuD,GAAW/N,OAAE,KAAK,EAAG,kDAAkD,EAC5DwK,SAAO,kBAAmB,EAAG,GAExCuD,GAAW/N,OAAE,KAAK,EAAG,mCAAmC,EAExD+N,GAAW/N,OAAE,KAAK,EAAG,sBAAsB,EAG5C+N,GAAW,IAAM/N,OAAE,KAAK,EAAG,mCAAqC,EAAG,wFAEnEwK,SAAO,UAAW,oBACXuD,CACR,EAEAvD,SAAO,kBAAoB,UAAW,CACrC,GAAKA,SAAO,UAAY,KAAK,IAAK,GAAI,UAAU,eAAe,qBAAuB,IAAO,CAC5FA,SAAO,UAAY,EACnB,MACA,CAKD,GAHA,MAAM,KAAM,wCAA0CA,SAAO,UAAY,0BAA2B,YAAa,GAAI,oBAAqB,GAC1IA,SAAO,UAAY,EAEd,eAAe,gCAAgC,SAAW,YAI/D,KAAI8D,EAAM1H,QAAM,kBAChB0H,EAAI,WAAY,GAAO,CACtB,SAAU,SAAUnL,EAAS,CAC5B,IAAIoL,EAAWpL,EAAO,YAEtB,GAAKoL,IAAa,GAAO,CAGxB,IAAID,EAAM1H,QAAM,QAChB0H,EAAI,KAAM,CACT,SAAU,UAAW,CACpB,CACN,EACI,CACD,CACH,GACA,EAEA9D,SAAO,UAAY,UAAW,CAC7BA,SAAO,UAAY,EACnBxK,OAAG,MAAM,EAAG,UAAWwK,SAAO,SAAU,SAAkCgE,EAAI,CAC7EhE,SAAO,kBAAiB,CAC1B,EAAI,GAAM,GACTxK,OAAG,MAAM,EAAG,SAAUwK,SAAO,SAAU,SAAiCgE,EAAI,CAC3EhE,SAAO,kBAAiB,CAC1B,EAAI,GAAM,GAET,YAAaiE,EAAgB,KAC7B,SAASA,GAAiB,CACzBjE,SAAO,UAAYA,SAAO,UAAY,EACjCA,SAAO,WAAa,KAAK,IAAK,GAAI,UAAU,eAAe,qBAAuB,KACtF,MAAM,KAAM,iBAAmBA,SAAO,UAAW,YAAa,GAAI,YAAa,EAEhF,CACF,EAEAA,SAAO,WAAa,SAAU3G,EAAgB,CAC7C,QAAUO,KAAO,eAAe,aAC1BA,EAAI,QAASP,CAAa,GAAM,GACpC,OAAO,eAAe,aAAaO,CAAG,CAGzC,EAEAoG,SAAO,QAAU,SAAUkE,EAAO,CAC3BA,IACLA,EAAO,OAAO,SAAS,UAKxB,IAAIC,EAAgBD,EAAK,MAAO,KAAK,EACrC,MAAK,4GAA4G,KAAMA,CAAM,GAAI,IAASC,GAAiBA,EAAc,OAAS,IACjLD,EAAOA,EAAK,UAAaA,EAAK,QAAS,GAAG,EAAK,IAGzCA,CACR,EAEAlE,SAAO,iBAAmB,SAAUoE,EAAQC,EAAM,CAC5CD,IACEC,GAILD,EAAO,WAAY,YACnBA,EAAO,YAAa,oBAJpBA,EAAO,KAAM,WAAY,QACzBA,EAAO,SAAU,mBAMpB,EAEApE,SAAO,eAAiB,UAAW,CAElC,GAAK,SAAO1D,iBAAkB,MAGzB,eAAe,wBAA0B,CAC7C,GAAK,CAAC,eAAe,iBAAmB,CACvC,IAAIgI,EAAmBtE,SAAO,iBAAkB1D,iBAAe,gBAAgB,EAC/EgI,EAAmB9O,OAAG8O,CAAkB,EAAC,cAAa,EACtD9O,OAAG,yBAAyB,EAAG,OAAQ8O,CAAgB,EAEvD,eAAe,iBAAmBA,CAClC,CAED,eAAe,iBAAiB,UAAW,eAAe,YAAY,CACtE,CACF,EAEAtE,SAAO,WAAa,SAAUnD,EAASG,EAAWtC,EAAM,CACvD,eAAe,aAAamC,CAAO,EAAIG,EAEvC,eAAe,aAAaH,EAAU,MAAM,EAAInC,EAEhDsF,SAAO,eAAc,CACtB,EAEAA,SAAO,cAAgB,SAAUnD,EAAU,CAC1C,OAAO,eAAe,aAAaA,CAAO,EAC1CrH,OAAG,YAAcqH,CAAS,EAAC,OAAM,CAClC,EAEAmD,SAAO,aAAe,UAAW,CAChC,eAAe,aAAe,GAC9BA,SAAO,eAAc,CACtB,EAKAA,SAAO,QAAU,SAAUnK,EAAM,CAChC,OAAK,OAAOA,GAAO,SACNA,EAAI,MAAO,GAAG,EAEP,IAAK,SAAU0O,EAAO,CACxC,OAAOA,EAAK,OAAQ,CAAG,EAAC,YAAW,EAAKA,EAAK,MAAO,EACvD,GAEgB,KAAM,KAGd1O,CACR,EAKAmK,SAAO,kBAAoB,SAAUnK,EAAM,CAC1C,OAAK,OAAOA,GAAO,WAClBA,EAAMA,EAAI,OAAQ,CAAG,EAAC,YAAW,EAAKA,EAAI,MAAO,IAE3CA,CACR,EAMAmK,SAAO,mBAAqB,SAAUwE,EAAM9L,EAAU,CAChD,OAAOA,EAAY,MACvBA,EAAU,IAGLA,EAAQ,WACbA,EAAQ,SAAW,QAGdA,EAAQ,aACbA,EAAQ,WAAa,OAAO,iBAAkB,SAAS,IAAM,EAAC,YAI/D,IAAI+L,GADSzE,SAAO,mBAAmB,SAAYA,SAAO,mBAAmB,OAAS,SAAS,cAAe,QAAU,IACnG,WAAY,IAAI,EAEhCtH,EAAQ,WACZA,EAAQ,WAAaA,EAAQ,WAE7BA,EAAQ,WAAa,GAGjBA,EAAQ,WACZA,EAAQ,WAAaA,EAAQ,WAE7BA,EAAQ,WAAa,GAGjBA,EAAQ,UACZA,EAAQ,UAAYA,EAAQ,UAE5BA,EAAQ,UAAY,GAGrB+L,EAAQ,KAAO/L,EAAQ,WAAa,IAAMA,EAAQ,SAAW,IAAMA,EAAQ,WAE3E,IAAIgM,EAAgBD,EAAQ,YAAaD,CAAI,EAAG,MAEhD,OAAK9L,EAAQ,WAAaA,EAAQ,UAAY,GAAKgM,EAAgBhM,EAAQ,YAC1EgM,EAAgBhM,EAAQ,WAEpBA,EAAQ,SAAWA,EAAQ,QAAU,IACzCgM,EAAgBA,EAAgBhM,EAAQ,SAEpCA,EAAQ,UAAY,GAAKgM,EAAgBhM,EAAQ,YACrDgM,EAAgBhM,EAAQ,WAGlBgM,CACR,EAEA1E,SAAO,UAAY,SAAU2E,EAAaC,EAAS,CAG7C,CAAC5E,SAAO,MAAO4E,CAAM,GAAM,eAAe,2BAC9CA,EAAS,eAAe,uBAAwB,EAAC,aAG5CA,IACLA,EAAS,aAGV,IAAIC,EAAOC,MAAQH,EAAaC,CAAM,EAKtC,OAJAC,EAAOA,EAAK,SAIPA,EAAK,UAAY,MAASA,EAAK,QAAS,EAAG,IACxC,KAGDA,CACR,EAEA7E,SAAO,cAAgB,SAAU2E,EAAc,CAE9C,GAAK,CAACA,GAAe,CAAC,eAAe,uBAAsB,EAC1D,OAAO,KAGR,IAAII,EAAc,eAAe,uBAAsB,EAAG,YACtDC,EAAc,eAAe,uBAAwB,EAAC,eAAe,eAAe,yBAAyB,WAAW,EACxHH,EAAOC,MAAQH,EAAaI,EAAc,IAAMC,CAAW,EAAG,SAElE,OAAOH,CAER,EAGA7E,SAAO,uBAAyB,SAAUiF,EAAUC,EAAW,CAG9D,OAAOD,CACR,EAEAjF,SAAO,sBAAwB,SAAU+E,EAAc,CAEtD,IAAII,EAAqB,CACxB,QAAS,SACT,QAAS,UACT,IAAO,QACP,QAAS,WACT,QAAS,UACT,QAAS,UACT,QAAS,WACT,QAAS,UACT,QAAS,WACT,QAAS,UACT,QAAS,WACT,QAAS,WACT,QAAS,SACT,QAAS,UACT,WAAY,eACZ,WAAY,cACZ,WAAY,aACZ,WAAY,aACZ,SAAU,WAEV,QAAS,UACT,QAAS,UACT,MAAO,OACP,UAAW,UACX,QAAS,OAET,UAAW,aACX,UAAW,aACX,QAAS,UACT,YAAa,aACb,UAAW,SACb,EAEC,OAAOA,EAAmBJ,CAAW,CACtC,EAEA/E,SAAO,qBAAuB,SAAUoF,EAAU7B,EAAU,CAC3D,IAAI8B,EAAsBjJ,QAAM,kBAC5BkJ,EAAmBlJ,QAAM,kBAExBmH,GACJ,YAAY,yBAA0BA,GAGvC+B,EAAiB,yBAA0B,CAC1C,SAAU,SAAU3M,EAAS,CAC5B,IAAIE,EAAcF,EAAO,YACzB,eAAe,oBAAsBE,EAErCwM,EAAoB,WAAY,qBAAsB,CACrD,SAAU,SAAUE,EAAkB,CACrC,IAAIC,EAAyBD,EAAgB,YAG7C,eAAe,oBAAoB,eAAiBC,EAEpD,IAAIT,EAAc,eAAe,oBAAoB,YAC/CA,IACLA,EAAc,aAGf,eAAe,oBAAoB,YAAc,eAAe,oBAAoB,eAAeA,CAAW,EAE9G,eAAe,oBAAoB,cAAgB/E,SAAO,sBAAuB+E,CAAW,EAC5F,eAAe,oBAAoB,cAAgB/E,SAAO,sBAAuB,eAAe,oBAAoB,aAEpHqF,EAAoB,WAAY,qBAAsB,CACrD,SAAU,SAAUI,EAAkB,CACrC,IAAIC,EAAyBD,EAAgB,YAE7C,eAAe,oBAAoB,eAAiBC,EAEpD,eAAe,uBAAwB,eAAe,qBAEjDN,GACJA,GAGD,CACP,EAEK,CACL,EACG,CACH,EACA,EAGApF,SAAO,UAAY,SAAU2F,EAAOC,EAAaC,EAAa,CAC7D,GAAKF,IAAU,GAAKC,IAAgB,EACnC,OAAOD,EAGR,IAAIE,EAAaA,GAAc,GAE/B,OAASA,EAAU,CAClB,IAAK,IACJF,EAAUA,EAAUA,EAAQC,EAC5B,MACD,IAAK,IACL,IAAK,IACL,IAAK,IACJ,IAAIE,EACCD,GAAc,IAAMD,GAAe,GACvCE,EAAoBF,EAAc,EACvBC,GAAc,GACzBC,EAAkB9F,SAAO,UAAa4F,EAAc,EAAK,GAAI,IAClDC,GAAc,KACzBC,EAAkB9F,SAAO,UAAa4F,EAAc,EAAK,GAAI,KAGzDD,EAAQ,EAGZA,EAAU,KAAK,OAASA,EAAQG,GAAoBF,CAAW,EAAKA,EAEpED,EAAU,KAAK,MAAQA,EAAQG,GAAoBF,CAAW,EAAKA,EAGpE,MACD,IAAK,IACJD,GAAcA,GAAUC,EAAc,IAAQA,EAAgBA,EAC9D,KACD,CAED,OAAOD,CACR,EAEC3F,SAAO,cAAgB,SAAU+F,EAAWnB,EAAS,CACpD,IAAIA,EAAQmB,EAAWC,EAAYC,EAASC,EAExCH,EAAYA,EAAU,WAEpBnB,IACLA,EAAS,eAAe,uBAAwB,EAAC,kBAElDA,EAAS,SAAUA,GAEnB,IAAIuB,EAAkB,GACjBJ,EAAU,OAAQ,CAAC,GAAM,MAC7BI,EAAkB,IAGnB,IAAIC,EAAsB,IACtBC,EAAoB,IAIxB,OAFAN,EAAYA,EAAU,QAAS,IAAI,OAAQK,EAAqB,KAAO,IAAK,QAAS,IAAI,OAAQ,IAAK,GAAG,EAAI,EAAE,EAAG,QAAS,IAAI,OAAQ,IAAK,KAAO,IAE1IxB,EAAM,CACd,IAAK,IACL,IAAK,IACCmB,EAAU,QAASM,CAAiB,IAAO,IAAMN,EAAU,QAAS,OAAU,GAElFE,EAAUjG,SAAO,cAAe+F,EAAW,EAAE,GAE7CC,EAAaD,EAAU,MAAO,KAExBC,EAAW,CAAC,IACjBA,EAAW,CAAC,EAAI,GAGXA,EAAW,CAAC,IACjBA,EAAW,CAAC,EAAI,GAGXA,EAAW,CAAC,EAGZA,EAAW,CAAC,GAAK,IACrBG,EAAkB,IAHnBH,EAAW,CAAC,EAAI,EAOjBE,EAAkB,IACbF,EAAW,CAAC,EAAE,SAAQ,EAAG,OAAQ,CAAC,GAAM,KAAOA,EAAW,CAAC,EAAI,GAAKA,EAAW,CAAC,EAAI,GAAKA,EAAW,CAAC,EAAI,KAC7GE,EAAkB,IAGnBD,EAAc,KAAK,IAAK,KAAK,MAAOD,EAAW,CAAC,CAAG,GAAK,KAAW,KAAK,IAAK,KAAK,MAAOA,EAAW,CAAC,CAAC,CAAI,EAAG,GAAO,KAAK,IAAKA,EAAW,CAAC,CAAG,EAExIE,GAAmB,KACvBD,EAAYA,EAAU,KAGxB,MACD,IAAK,IACL,IAAK,IACL,IAAK,IACCF,EAAU,QAAS,GAAK,IAAK,GAEjCE,EAAUjG,SAAO,cAAe+F,EAAW,EAAE,EAE7CE,EAAYF,EAAY,KAEzB,MACD,IAAK,IACJE,EAAYF,EAAY,GACxB,MACD,IAAK,IACJE,EAAUF,EAOVI,EAAkB,GAClB,KACD,CAGD,OAAK,KAAK,IAAKF,CAAO,EAAK,OAAO,iBAC1B,OAAO,kBAGVE,GAAmB,KACvBF,EAAUjG,SAAO,UAAWiG,EAAS,EAAE,GAIjCA,EACP,EAEDjG,SAAO,oBAAsB,SAAUiG,EAASK,EAAiBC,EAAgB,CAChF,IAAIL,EAAkB,GAEjBD,EAAU,IACdC,EAAkB,IAGnBD,EAAU,KAAK,IAAKA,GACpB,IAAIO,EAAY,KAAK,MAAOP,EAAU,IAAI,EACtCQ,EAAc,KAAK,MAASR,EAAU,GAAO,IAC7CS,EAAc,QAAST,CAAS,EAAC,IAAK,EAAE,EAEvCM,GAAiB,KACrBE,EAAkBD,EAAY,GAAOC,EACrCD,EAAY,GAGRA,EAAY,KAChBA,EAAY,IAAMA,GAGdC,EAAc,KAClBA,EAAc,IAAMA,GAGhBC,EAAc,KAClBA,EAAc,IAAMA,GAGrB,IAAIxM,EACJ,OAAKqM,GAAiB,GACrBrM,EAAS,CAACuM,EAAaC,CAAW,EAAE,KAAM,GAAG,EAExCJ,GAAmB,GACvBpM,EAAS,CAACsM,EAAWC,EAAaC,CAAW,EAAE,KAAM,KAErDxM,EAAS,CAACsM,EAAWC,CAAW,EAAE,KAAM,GAAG,EAIxCP,GAAmB,KACvBhM,EAAS,IAAMA,GAGTA,CACP,EAGD8F,SAAO,YAAc,SAAUiG,EAASrB,EAAS,CAChD,IAAI1K,EAGA+L,EAAU,WAAYA,GACrB,MAAOA,KACXA,EAAU,GAIX,IAAIrB,EAUJ,OATMA,IACA,eAAe,yBACnBA,EAAS,eAAe,uBAAwB,EAAC,iBAEjDA,EAAS,IAGXA,EAAS,SAAUA,GAEVA,EAAM,CACd,IAAK,IACJ1K,EAAS8F,SAAO,oBAAqBiG,GACrC,MACD,IAAK,IACJ/L,EAAS8F,SAAO,oBAAqBiG,EAAS,EAAI,EAClD,MACD,IAAK,IACJ/L,EAAS8F,SAAO,oBAAqB,KAAK,MAAOiG,CAAS,EAAE,GAAM,IAClE,MACD,IAAK,IACJ/L,GAAW+L,EAAU,MAAO,QAAS,CAAC,EACtC,MACD,IAAK,IACJ/L,GAAW+L,EAAU,MAAO,QAAS,CAAC,EACtC,MACD,IAAK,IACJ/L,GAAW+L,EAAU,MAAO,QAAS,CAAC,EACtC,MACD,IAAK,IACJ/L,GAAW+L,EAAU,IAAK,QAAS,CAAC,EACpC,MACD,IAAK,IACJ/L,EAAS+L,EACT,KACD,CAGD,OAAO/L,CACT,EAEA8F,SAAO,oBAAsB,SAAU7G,EAAOwN,EAAmB,CAIhE,GAHMA,IACLA,EAAmB,GAEfxN,EAAQ,CACZA,EAAQ,WAAYA,GAEpB,IAAIyN,EAAgBzN,EAAM,WAE1B,GAAKyN,EAAc,QAAS,GAAG,EAAK,EAAI,CAEvC,IAAIC,EAAuB,SAAUD,EAAc,MAAO,EAAI,EAAC,QAAS,EAAC,KAAM,EAAE,CAAI,EAAC,SAAQ,EAAG,OAC5FC,GAAwBF,GAAoBE,GAAwB,IACxEF,EAAmBE,EAGpB,CAED,OAAO1N,EAAM,QAASwN,EACtB,CAED,OAAOxN,CACR,EAIA6G,SAAO,kBAAoB,UAAW,CACrC,IAAI2B,EAAO,SAAS,cAAe,QAAQ,EAC3C,MAAO,CAAC,EAAGA,EAAK,YAAcA,EAAK,WAAY,IAAI,EACpD,EAEA3B,SAAO,aAAe,UAAW,CAEhC,IAAI8G,EAAS,KAAK,MAAO,KAAK,OAAM,EAAK,KAEzC,OAAOA,CAER,EAIA9G,SAAO,mBAAqB,SAAU+G,EAAY,CAEjD,GAAK,CAACA,GAAa,CAACA,EAAU,UAC7B,OAAO,KAGR,IAAIrD,EAAc,GAClB,OAASqD,EAAU,UAAS,CAC3B,IAAK,UACJrD,EAAc,eACd,MACD,IAAK,YACJA,EAAc,aACd,MACD,IAAK,gBACJA,EAAc,iBACd,MACD,IAAK,cACJA,EAAc,WACd,MACD,IAAK,iBACJA,EAAc,kBACd,MACD,IAAK,eACJA,EAAc,gBACd,MACD,IAAK,eACJA,EAAc,gBACd,MACD,IAAK,SACJA,EAAc,UACd,MACD,IAAK,eACJA,EAAc,gBACd,MACD,IAAK,yBACJA,EAAc,0BACd,MACD,IAAK,6BACJA,EAAc,8BACd,MACD,IAAK,eACL,IAAK,uBACJA,EAAc,iBACd,MACD,IAAK,aACJA,EAAc,aACd,MACD,IAAK,oBACJA,EAAc,qBACd,MACD,IAAK,eACJA,EAAc,gBACd,MACD,IAAK,cACJA,EAAc,eACd,MACD,IAAK,SACJA,EAAc,UACd,MACD,IAAK,kBACJA,EAAc,mBACd,MACD,IAAK,aACJA,EAAc,cACd,MACD,IAAK,sBACJA,EAAc,mBACd,MACD,IAAK,WACJA,EAAc,cACd,MACD,IAAK,cACJA,EAAc,eACd,MACD,IAAK,mBACJA,EAAc,oBACd,MACD,IAAK,8BACJA,EAAc,+BACd,MAED,IAAK,sCACJA,EAAc,uCACd,MACD,IAAK,cACJA,EAAc,oBACd,MACD,IAAK,iBACJA,EAAc,kBACd,MACD,IAAK,aACJA,EAAc,cACd,MACD,IAAK,cACJA,EAAc,eACd,MACD,IAAK,kBACJA,EAAc,eACd,MACD,IAAK,sBACJA,EAAc,uBACd,MACD,IAAK,iBACJA,EAAc,kBACd,MACD,IAAK,iBACJA,EAAc,kBACd,MACD,IAAK,uBACJA,EAAc,wBACd,MACD,IAAK,aACJA,EAAc,cACd,MACD,IAAK,sBACJA,EAAc,uBACd,MACD,IAAK,mBACJA,EAAc,oBACd,MACD,IAAK,cACJA,EAAc,eACd,MACD,IAAK,SACJA,EAAc,UACd,MACD,IAAK,iBACJA,EAAc,kBACd,MACD,IAAK,oBACJA,EAAc,qBACd,MACD,IAAK,SACJA,EAAc,UACd,MACD,IAAK,uBACJA,EAAc,wBACd,MACD,IAAK,mBACJA,EAAc,oBACd,MACD,IAAK,mBACJA,EAAc,gBACd,MACD,IAAK,kBACJA,EAAc,gBACd,MACD,IAAK,iBACJA,EAAc,kBACd,MACD,IAAK,oBACJA,EAAc,qBACd,MACD,IAAK,eACJA,EAAc,gBACd,MACD,IAAK,2BACJA,EAAc,4BACd,MACD,IAAK,4BACJA,EAAc,4BACd,MACD,IAAK,0BACJA,EAAc,2BACd,MACD,IAAK,yBACJA,EAAc,0BACd,MACD,IAAK,0BACJA,EAAc,0BACd,MACD,IAAK,4BACJA,EAAc,6BACd,MACD,IAAK,2BACJA,EAAc,4BACd,MACD,IAAK,uBACJA,EAAc,wBACd,MACD,IAAK,kBACJA,EAAc,wBACd,MACD,IAAK,oBACJA,EAAc,qBACd,MACD,IAAK,gBACJA,EAAc,iBACd,MACD,IAAK,gBACJA,EAAc,iBACd,MACD,IAAK,YACJA,EAAc,aACd,MACD,IAAK,mBACJA,EAAc,oBACd,MACD,IAAK,iBACJA,EAAc,kBACd,MACD,IAAK,mBACJA,EAAc,oBACd,MACD,IAAK,qBACJA,EAAc,sBACd,MACD,IAAK,aACJA,EAAc,cACd,MACD,IAAK,iBACJA,EAAc,yBACd,MACD,IAAK,oBACJA,EAAc,qBACd,MACD,IAAK,kBACJA,EAAc,mBACd,MACD,IAAK,aACJA,EAAc,cACd,MACD,IAAK,mBACJA,EAAc,oBACd,MACD,IAAK,oBACJA,EAAc,qBACd,MACD,IAAK,eACJA,EAAc,gBACd,MACD,IAAK,sBACJA,EAAc,0BACd,MACD,IAAK,aACJA,EAAc,cACd,MACD,IAAK,wBACJA,EAAc,yBACd,MACD,IAAK,kBACJA,EAAc,mBACd,MACD,IAAK,sBACJA,EAAc,uBACd,MACD,IAAK,+BACJA,EAAc,gCACd,MACD,IAAK,iBACJA,EAAc,kBACd,MACD,IAAK,iBACJA,EAAc,kBACd,MACD,IAAK,6BACJA,EAAc,8BACd,MACD,IAAK,kCACJA,EAAc,mCACd,MACD,IAAK,mBACJA,EAAc,oBACd,MACD,IAAK,0BACJA,EAAc,2BACd,MACD,IAAK,mBACJA,EAAc,oBACd,MACD,IAAK,+BACJA,EAAc,gCACd,MACD,IAAK,iBACJA,EAAc,kBACd,MACD,IAAK,4BACJA,EAAc,6BACd,MACD,IAAK,mBACJA,EAAc,oBACd,MACD,IAAK,aACJA,EAAc,cACd,MACD,IAAK,mBACJA,EAAc,oBACd,MACD,IAAK,gBACJA,EAAc,iBACd,MACD,IAAK,oBACJA,EAAc,qBACd,MACD,IAAK,iBACJA,EAAc,kBACd,MACD,IAAK,mBACJA,EAAc,oBACd,MACD,IAAK,sBACJA,EAAc,uBACd,MACD,IAAK,yBACJA,EAAc,0BACd,MACD,IAAK,oBACJA,EAAc,qBA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AAK,mBACJA,EAAO,+BACP,MACD,IAAK,cACJA,EAAO,sBACP,MACD,IAAK,kBACJA,EAAO,2BACP,MACD,IAAK,aACJA,EAAO,2BACP,MACD,IAAK,sBACL,IAAK,gBACJA,EAAO,8BACP,MACD,IAAK,UACJA,EAAO,0BACP,MACD,IAAK,kBACJA,EAAO,0BACP,MACD,IAAK,iBACJA,EAAO,iCACP,MACD,IAAK,gBACJA,EAAO,0BACP,MACD,IAAK,iBACJA,EAAO,iCACP,MACD,IAAK,aACJA,EAAO,6BACP,MACD,IAAK,YACJA,EAAO,4BACP,MACD,IAAK,cACJA,EAAO,8BACP,MACD,IAAK,eACJA,EAAO,+BACP,MACD,IAAK,YACJA,EAAO,+BACP,MACD,IAAK,WACJA,EAAO,4BACP,MACD,IAAK,+BACJA,EAAO,kDACP,MACD,IAAK,OACJA,EAAO,sBACP,MACD,IAAK,QACJA,EAAO,eACP,MACD,IAAK,YACJA,EAAO,8BACP,MACD,IAAK,QACJA,EAAO,2BACP,MACD,IAAK,2BACJA,EAAO,+CACP,MACD,IAAK,mCACJA,EAAO,wDACP,MACD,IAAK,gBACL,IAAK,WACJA,EAAO,6BACP,MACD,IAAK,UACJA,EAAO,4BACP,MACD,IAAK,iBACJA,EAAO,oCACP,MACD,IAAK,UACJA,EAAO,4BACP,MACD,IAAK,gBACL,IAAK,WACJA,EAAO,8BACP,MACD,IAAK,WACL,IAAK,MACJA,EAAO,wBACP,MACD,IAAK,eACL,IAAK,UACJA,EAAO,6BACP,MACD,IAAK,mBACJA,EAAO,uCACP,MACD,IAAK,YACJA,EAAO,8BACP,MACD,IAAK,cACJA,EAAO,gCACP,MACD,IAAK,iBACJA,EAAO,mCACP,MACD,IAAK,YACJA,EAAO,8BACP,MACD,IAAK,MACJA,EAAO,kBACP,MACD,IAAK,cACJA,EAAO,gCACP,MACD,IAAK,MACJA,EAAO,uBACP,MACD,IAAK,UACJA,EAAO,yBACP,MACD,IAAK,YACJA,EAAO,2BACP,MACD,IAAK,oBACJA,EAAO,mBACP,MACD,IAAK,aACJA,EAAO,6BACP,MACD,IAAK,cACJA,EAAO,8BACP,MACD,IAAK,+BACL,IAAK,0BACJA,EAAO,2CACP,MACD,IAAK,0BACJA,EAAO,2CACP,MACD,IAAK,SACJA,EAAO,wBACP,MACD,IAAK,WACJA,EAAO,2BACP,MACD,IAAK,aACJA,EAAO,4BACP,MACD,IAAK,mBACJA,EAAO,mCACP,MACD,IAAK,YACJA,EAAO,4BACP,MACD,IAAK,cACJA,EAAO,8BACP,MACD,IAAK,WACL,IAAK,eACJA,EAAO,0BACP,MACD,IAAK,oBACJA,EAAO,oCACP,MACD,IAAK,cACJA,EAAO,8BACP,MACD,IAAK,UACJA,EAAO,yBACP,MACD,IAAK,UACJA,EAAO,0BACP,MACD,IAAK,qBACJA,EAAO,sCACP,MACD,IAAK,qBACJA,EAAO,qCACP,MACD,IAAK,UACJA,EAAO,4BACP,MACD,IAAK,iBACJA,EAAO,6BACP,MACD,IAAK,uBACJA,EAAO,0CACP,MACD,IAAK,yBACJA,EAAO,4CACP,MACD,IAAK,iBACJA,EAAO,oCACP,MACD,IAAK,eACJA,EAAO,iCACP,MACD,IAAK,mBACJA,EAAO,iCACP,MACD,IAAK,sBACJA,EAAO,oCACP,MACD,IAAK,mBACL,IAAK,uBACJA,EAAO,4BACP,MACD,IAAK,mBACJA,EAAO,oCACP,MACD,IAAK,4BACJA,EAAO,8CACP,MACD,IAAK,sBACJA,EAAO,wCACP,MACD,IAAK,sBACJA,EAAO,uCACP,MACD,IAAK,cACJA,EAAO,8BACP,MACD,IAAK,cACJA,EAAO,6BACP,MACD,IAAK,UACJA,EAAO,yBACP,MACD,IAAK,mBACJA,EAAO,mCACP,MACD,IAAK,4BACJA,EAAO,6CACP,MACD,IAAK,0BACJA,EAAO,0CACP,MACD,IAAK,sBACJA,EAAO,sCACP,MACD,IAAK,aACJA,EAAO,4BACP,MACD,IAAK,cACJA,EAAO,6BACP,MACD,IAAK,oBACJA,EAAO,oCACP,MACD,IAAK,gBACJA,EAAO,+BACP,MACD,IAAK,iBACJA,EAAO,gCACP,MACD,IAAK,gBACJA,EAAO,+BACP,MACD,IAAK,gBACJA,EAAO,+BACP,MACD,IAAK,yBACJA,EAAO,iCACP,MAED,IAAK,mBACJA,EAAO,kCACP,MACD,IAAK,gBACJA,EAAO,+BACP,MACD,IAAK,UACJA,EAAO,wBACP,MACD,IAAK,iBACJA,EAAO,gCACP,MACD,IAAK,gBACL,IAAK,uBACL,IAAK,4BACJA,EAAO,+BACP,MACD,IAAK,mBACL,IAAK,WACL,IAAK,gBACJA,EAAO,kBACP,MACD,IAAK,QACJA,EAAO,cACP,MACD,IAAK,oBACJA,EAAO,iCACP,MACD,IAAK,oBACJA,EAAO,sCACP,MACD,IAAK,cACJA,EAAO,8BACP,MACD,IAAK,iBACJA,EAAO,iCACP,MACD,IAAK,wBACJA,EAAO,kCACP,MACD,IAAK,yBACL,IAAK,yBACJA,EAAO,mCACP,MACD,IAAK,wBACJA,EAAO,kCACP,MACD,IAAK,qBACJA,EAAO,+BACP,MACD,IAAK,yBACJA,EAAO,mCACP,MACD,IAAK,kCACJA,EAAO,8CACP,MACD,IAAK,uBACJA,EAAO,kCACP,MACD,IAAK,MACL,IAAK,WACL,IAAK,oBACJA,EAAO,gBACP,MACD,IAAK,qBACL,IAAK,gBACL,IAAK,YACL,IAAK,gBACL,IAAK,iBACL,IAAK,cACL,IAAK,eACJA,EAAO,0BACP,MACD,IAAK,iBACL,IAAK,aACL,IAAK,eACL,IAAK,yBACL,IAAK,wBACL,IAAK,uBACL,IAAK,oBACL,IAAK,wBACL,IAAK,yBACL,IAAK,sBACL,IAAK,uBACL,IAAK,0BACJA,EAAO,wBACP,MACD,IAAK,sBACJA,EAAO,gCACP,MACD,IAAK,6BACJA,EAAO,wCACP,MACD,IAAK,uBACJA,EAAO,iCACP,MACD,IAAK,8BACJA,EAAO,yCACP,MACD,IAAK,mBACJA,EAAO,6BACP,MACD,IAAK,oBACJA,EAAO,8BACP,MACD,IAAK,uBACJA,EAAO,0BACP,MACD,IAAK,2BACJA,EAAO,+BACP,MACD,IAAK,kCACJA,EAAO,6CACP,MACD,IAAK,0BACJA,EAAO,oCACP,MACD,IAAK,kBACJA,EAAO,4BACP,MACD,IAAK,mBACJA,EAAO,6BACP,MACD,IAAK,mBACJA,EAAO,6BACP,MACD,IAAK,gBACJA,EAAO,yBACP,MACD,IAAK,gBACJA,EAAO,yBACP,MACD,IAAK,oBACJA,EAAO,0BACP,MACD,IAAK,eACJA,EAAO,wBACP,MACD,IAAK,4BACJA,EAAO,uCACP,MACD,IAAK,eACJA,EAAO,yBACP,MACD,IAAK,cACJA,EAAO,wBACP,MACD,IAAK,uBACJA,EAAO,iCACP,MACD,IAAK,0BACJA,EAAO,uCACP,MACD,IAAK,YACJA,EAAO,gCACP,MACD,IAAK,+BACJA,EAAO,qCACP,MACD,IAAK,8BACJA,EAAO,oCACP,MACD,IAAK,SACJA,EAAO,wBACP,MACD,IAAK,gBACJA,EAAO,gCACP,MACD,IAAK,gBACJA,EAAO,gCACP,MACD,IAAK,qBACJA,EAAO,qCACP,MACD,IAAK,UACJA,EAAO,yBACP,MACD,IAAK,eACJA,EAAO,+BACP,MACD,IAAK,mBACJA,EAAO,4BACP,MACD,IAAK,6BACJA,EAAO,uCACP,MACD,IAAK,wBACJA,EAAO,kCACP,MACD,IAAK,oBACJA,EAAO,yCACP,MACD,IAAK,uBACJA,EAAO,gCACP,MACD,IAAK,+CACJA,EAAO,mCACP,MACD,IAAK,sCACJA,EAAO,6CACP,MACD,IAAK,kBACJA,EAAO,2BACP,MACD,IAAK,mBACJA,EAAO,4BACP,MACD,IAAK,kBACL,IAAK,YACJA,EAAO,2BACP,MACD,IAAK,mBACJA,EAAO,4BACP,MACD,IAAK,kBACJA,EAAO,2BACP,MACD,IAAK,sBACL,IAAK,gBACJA,EAAO,+BACP,MACD,IAAK,mBACJA,EAAO,kCACP,MACD,IAAK,uBACJA,EAAO,uCACP,MACD,IAAK,2BACJA,EAAO,qCACP,MACD,IAAK,sBACJA,EAAO,+BACP,MACD,IAAK,oBACJA,EAAO,6BACP,MACD,IAAK,gBACJA,EAAO,yBACP,MACD,IAAK,gBACJA,EAAO,wBACP,MACD,IAAK,uBACJA,EAAO,iCACP,MACD,IAAK,gBACJA,EAAO,wBACP,MACD,IAAK,mBACJA,EAAO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CJA,EAAqB,WACrB,MACD,IAAK,YACL,IAAK,kBACL,IAAK,sBACL,IAAK,gBACL,IAAK,QACL,IAAK,UACL,IAAK,yBACL,IAAK,YACJA,EAAqB,QACrB,MACD,IAAK,iBACL,IAAK,UACJA,EAAqB,UACrB,MACD,IAAK,MACL,IAAK,WACJA,EAAqB,MACrB,MACD,IAAK,WACL,IAAK,gBACJA,EAAqB,YACrB,MACD,IAAK,cACJA,EAAqB,eACrB,MACD,IAAK,UACJA,EAAqB,WACrB,MACD,IAAK,mBACJA,EAAqB,qBACrB,MACD,IAAK,4BACJA,EAAqB,+BACrB,MACD,IAAK,0BACJA,EAAqB,4BACrB,MACD,IAAK,gBACJA,EAAqB,iBACrB,MACD,IAAK,aACJA,EAAqB,cACrB,MACD,IAAK,gBACJA,EAAqB,iBACrB,MACD,IAAK,cACJA,EAAqB,eACrB,MACD,IAAK,gBACL,IAAK,mBACJA,EAAqB,iBACrB,MACD,IAAK,gBACJA,EAAqB,iBACrB,MACD,IAAK,oBACJA,EAAqB,sBACrB,MACD,IAAK,iBACJA,EAAqB,mBACrB,MACD,IAAK,sBACJA,EAAqB,eACrB,MACD,IAAK,WACL,IAAK,mBACL,IAAK,iBACJA,EAAqB,OACrB,MACD,IAAK,cACJA,EAAqB,eACrB,MACD,IAAK,YACJA,EAAqB,aACrB,MACD,IAAK,YACJA,EAAqB,aACrB,MACD,IAAK,cACJA,EAAqB,eACrB,MACD,IAAK,cACJA,EAAqB,eACrB,MACD,IAAK,0BACJA,EAAqB,4BACrB,MACD,IAAK,iBACJA,EAAqB,UACrB,MACD,IAAK,eACJA,EAAqB,eACrB,MACD,IAAK,OACL,IAAK,YACJA,EAAqB,OACrB,MACD,IAAK,cACJA,EAAqB,eACrB,MACD,IAAK,mBACL,IAAK,cACJA,EAAqB,eACrB,MACD,IAAK,YACJA,EAAqB,aACrB,MACD,IAAK,iBACJA,EAAqB,kBACrB,MACD,IAAK,eACL,IAAK,0BACJA,EAAqB,gBACrB,MACD,IAAK,cACJA,EAAqB,eACrB,MACD,IAAK,iBACJA,EAAqB,kBACrB,MACD,IAAK,gBACJA,EAAqB,iBACrB,MACD,IAAK,iBACL,IAAK,sBACJA,EAAqB,kBACrB,MACD,IAAK,eACJA,EAAqB,gBACrB,MACD,IAAK,UACL,IAAK,YACJA,EAAqB,UACrB,MACD,IAAK,WACJA,EAAqB,YACrB,MACD,IAAK,gBACL,IAAK,qBACJA,EAAqB,gBACrB,MACD,IAAK,oBACL,IAAK,aACJA,EAAqB,sBACrB,MACD,IAAK,mBACL,IAAK,4BACJA,EAAqB,qBACrB,MACD,IAAK,kCACL,IAAK,UACJA,EAAqB,WACrB,MACD,IAAK,SACJA,EAAqB,SACrB,MACD,IAAK,aACJA,EAAqB,aACrB,MACD,IAAK,mBACJA,EAAqB,YACrB,MACD,IAAK,UACJA,EAAqB,UACrB,MACD,IAAK,aACL,IAAK,mBACJA,EAAqB,cACrB,MACD,IAAK,sBACJA,EAAqB,mBACrB,MACD,IAAK,MACJA,EAAqB,MACrB,MACD,IAAK,cACJA,EAAqB,eACrB,MACD,IAAK,WACJA,EAAqB,WACrB,MACD,IAAK,oBACJA,EAAqB,aACrB,MACD,IAAK,sBACJA,EAAqB,wBACrB,MACD,IAAK,mBACJA,EAAqB,qBACrB,MACD,IAAK,UACJA,EAAqB,UACrB,MACD,IAAK,uBACL,IAAK,uBACJA,EAAqB,gBACrB,MACD,IAAK,WACL,IAAK,gBACJA,EAAqB,WACrB,MACD,IAAK,iBACJA,EAAqB,kBACrB,MACD,IAAK,uBACL,IAAK,gBACJA,EAAqB,iBACrB,MACD,IAAK,SACL,IAAK,gBACL,IAAK,kBACL,IAAK,gBACJA,EAAqB,SACrB,MACD,IAAK,qBACJA,EAAqB,cACrB,MACD,IAAK,eACL,IAAK,UACJA,EAAqB,WACrB,MACD,IAAK,cACJA,EAAqB,SACrB,MACD,IAAK,2BACJA,EAAqB,qBACrB,MACD,IAAK,mCACJA,EAAqB,8BACrB,MACD,IAAK,MACL,IAAK,WACJA,EAAqB,MACrB,MACD,IAAK,oBACJA,EAAqB,cACrB,MACD,IAAK,yBACJA,EAAqB,mBACrB,MACD,IAAK,YACJA,EAAqB,aACrB,MACD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","names":["$","__slice","i18n","i18nDict","missingPattern","str","dict","args","p0","p","position","params","_sfc_main","_createElementVNode","_hoisted_2","_createElementBlock","_hoisted_1","_hoisted_3","TTUUID","seed","user_id","sequence","node","tick","timestamp","tf","tl","thav","cshar","csl","uuid","regex","timeLow","timeMid","timeHiAndVersion","clockSeqHiAndReserved","clockSeqLow","hex","bits","time","ts","hm","string","length","z","min","max","random_num","crypto_obj","byte_array","options","result","attrName","result_data","errorInfo","index","errorItem","i","ServiceCaller","value","className","function_name","apiArgsAndResponseObject","lastApiArgsAndResponseObject","apiArgs","responseObject","len","api_args","key","form_data","paramaters","responseObj","message_id","upload_url","retval","property_name","arg","cache_key","apiReturnHandler","is_cachable","$this","base_url","url","async","stack_trace_str","stack_trace","api_called_date","api_stack","jqXHR","request_total_time","api_trace_label","api_trace_raw_request_label","api_trace_response_label","paths","session_data","textStatus","errorThrown","rest_url","object_type","append_csrf","append_cache_buster","ajax_obj","class_name","key_name","obj","target","property_key","method_name","TTAPI","FormItemType","WidgetNamesDic","rate_data","new_time","time_frame_milliseconds","id","opts","createTab","view_id","view_label","tab","view_name","close_btn","tab_map","view_url","scope_id","event_id","event_scope","event_handler","auto_clear_on_exit","mitt_event_id","unique_listener_id","event_data","scope_array","removeIndex","item","stored_event","field","html","output","filename","type","check_class","onResult","html_template","container_id","container_class","tab_bar_id","edit_view_class","is_multi_column","show_permission_div","is_sub","tab_id","mount_id","mount_component","root_props","mount_reference","vue_app_instance","vue_component_instance","step","event","submit_button","res","repeat_count","api_endpoint","response","err","TTVueUtils","login_session_type","Global","InputText","Checkbox","ProgressSpinner","Password","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_openBlock","$options","$data","_toDisplayString","_withDirectives","_createBlock","_component_ProgressSpinner","_createCommentVNode","_createVNode","_component_Password","_cache","$event","_component_Checkbox","_hoisted_8","_normalizeClass","Textarea","_component_InputText","TTEventBus","elem","$elem","$window","docViewTop","docViewBottom","elemTop","element","scroll_div","scroll_bar_width","scroll_bar_height","error_string","from_file","line","col","error_obj","captureScreenShot","error_msg","canvas","image_string","sourceMapStackTrace","stacktrace_callback","stackframes","stringified_stack","sf","sendErrorReport","stacktrace_errback","error","api_authentication","message","timeout_handler","login_user","script_name","pre_login_data","current_company_obj","_a","api","res_data","e","timerIncrement","host","is_sub_domain","widget","val","view_min_tab_bar","word","text","context","content_width","date_string","format","date","moment","date_format","time_format","date_str","time_str","jquery_date_format","callBack","user_preference_api","current_user_aou","jsDateFormatRes","jsDateFormatResultData","jsTimeFormatRes","jsTimeFormatResultData","epoch","round_value","round_type","tmp_round_value","time_unit","time_units","seconds","negative_number","enable_rounding","thousands_separator","decimal_separator","include_seconds","exclude_hours","tmp_hours","tmp_minutes","tmp_seconds","minimum_decimals","trimmed_value","tmp_minimum_decimals","number","api_class","array","parentId","finalArray","childrenArray","selectId","new_row","firstItemType","customLabel","label","last_array_element","columns","order_value","column","return_key_on_null","regex_result","reg","first_item","orderType","record","powered_by_img","powered_by_link","status","average_time","checking_array","setTooltip","doPing","ping","total_time","callback","inUse","start","img","endTime","script_path","split_script_path","scriptPath","successflag","realPath","import_file_name","class_exists","import_path","module","calling_script","path","icon","name","current_company_data","new_url","_callee","_text","_scriptArr","_start","_tempArr","thisArray","otherArray","newArray","a","b","object","layout_name","setWidthCallBack","column_info_array","total_width","view_column_data","column_info","text_width","widgetName","raw_text","input","widget_constructor","responseData","viewId","preloads","fileName","sync","template_type","template_options","url_obj","url_relative_path","include_search","include_hash","keyCode","layout","convert_filter_data","filter_data","content","values","final_value","orderKey","order_type","filterCondition","filter","grid_data","custom_field","mask","utc","format_str","encodedStr","tmp","default_cmp","getCmpFunc","primer","reverse","cmp","sort_by","sort_by_array","fields","n_fields","A","B","l","action","track_address","user_name","company_name","user_properties","event_category","event_action","event_label","context_btn","menu_name","dom_context_menu","dom_context_menu_group","button_id","ui","tab_target","fn","scope","head","link","sheet","cssRules","interval_id","timeout_id","functionToExecute","alert_message","clicked_yes","newDeepLink","alternate_session_data","start_date","end_date","sun","mon","tue","wed","thu","fri","sat","start_date_obj","end_date_obj","days","lang","path_bits","path_current","cookies","year","arr","clean_arr","n","arr1","retarr","argl","k1","k","arr1_keys","decimals","negative","first","error_strings","error_count","method","post_data","tempForm","hideInput","file_name","mime_type","drop_zone_id","drop_zone","drop_zone_tip","verifyDropZone","verify_element","matches","client_id","api_auth","min_time","max_time","wait","immediate","timeout","callback_name","later","call_now","entry","filters","data","makeUnique","accumulator","currentValue","setting","width","scale","meta_tag_viewport","color","flag","default_value","feature_flags","session_type","mfa_data","is_reauthentication","authenticate_callback","success","user_password","cr_text","_0xee93","session_result","session_id","timeout_count","auto_login_timer","tips","clear_all","tooltip_element","tooltip","custom_agreement_data","prompts","country","province","_b","delta_x","max_width","current_width","new_width","ai_body","starting_choices","choice","user_prompt","user_input","completion","DOMPurify","annotations","annotation","quote","annotated_text","guide_link","annotated_element","annotation_content","overlay","rect","overlayWidth","overlayHeight","left_position","top_position","in_progress_message","user_message","role","role_completions","_hoisted_9","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_Fragment","_renderList","_hoisted_10","_hoisted_15","_hoisted_20","_hoisted_21","total","object_types","pending_counts","current_user","support_email_address","seconds_remaining","count","cache_buster","image_url","profile_image_url","force","update_timesheet","menu_id","OverlayPanel","_withScopeId","_component_router_link","_withCtx","_component_OverlayPanel","_vShow","_component_TTTopBar","$props","layoutConfig","layoutState","setScale","setActiveMenuItem","onMenuToggle","onProfileSidebarToggle","onConfigSidebarToggle","isSidebarActive","isDarkTheme","isDesktop","isSlim","isSlimPlus","isHorizontal","route","props","__props","isActiveMenu","itemKey","subMenuRef","menuItemRef","activeItem","handleRouteChange","rootIndex","calculatePosition","newVal","newValue","newPath","itemClick","overlayMenuActive","staticMenuMobileActive","removeAllTooltips","onMouseEnter","left","top","vWidth","vHeight","oWidth","oHeight","scrollbarWidth","height","checkActiveRoute","AppSubmenu","_component_AppSubmenu","findItems","items","suggestions","group_header","filtered_items","AutoComplete","_component_AutoComplete","menu_item_check","menu_output","parent_result","parent_item_check","validated_items","validation_item","items_array","child_item","contains_items","has_destination","is_separator","help_menu","defaultCase","check_connection_timer","user","subMenuId","force_refresh","sub_menu_id_url","regex_pattern","current_user_api","MenuManager","destination","close_view","event_info","parent_view","new_menu","root_sub_menu_list","submenuHeight","show","menu","submenu","ProgressBar","_Transition","_component_TTMenuSearch","_component_TTAppMenu","content_container","layoutMode","results","_component_Toast","_component_TTTopContainer","_component_TTLeftContainer","_component_router_view","_ctx","LocalCacheData","sanitized_val","sanitizeInput","property","pager_data","last","next","end","paging_selector","left_buttons_div","right_buttons_div","left_buttons_enable","right_buttons_enable","current_value","pages_label","page_number","BaseViewController","root_container","new_id","totalRows","grid_selected_id_array","grid_selected_length","items_per_page","totalInfo","context_menu_array","target_type","selector","return_object","default_context_menu_model","context_menu_model","icon_count","addIconToFinalModel","final_context_menu_model","flattenMixedIdObjectArray","x","current_include_element","tmp_included_icon_ids","j","exclude_icon_id","groups","setFocus","menu_attributes","context_parent","context_label","name_prefix","group","state","show_save_and_continue","get_default_api_args","current_api","delete_type","remove_ids","current_grid_source","ignoreWarning","records","commonRecord","mass_edit_record_ids","changed_fields","mass_records","common_record","force_no_confirm","doNext","on_save_done_result","result1","noRefreshUI","record_id","answer","copyIds","save_and_continue_buttons","navigation_div","selectedId","job","job_item_id_col_name","job_item_widget","current_job_item_id","new_arg","setDefaultData","job_id_col_name","job_widget","current_job_id","job_id_field","job_item_id_field","department","department_id_col_name","department_widget","current_department_id","punch_tag_id_col_name","punch_tag_widget","current_punch_tag_ids","punch_tag_result","intersected_values","punch_tag_id","punch_tag","punch_tag_manual_ids","manual_id","punch_tags","get_real_data","manual_ids","cancel_all","doNotValidate","linked_fields","is_linked_field","is_checked","tab_options","tab_model","tab_bar_labels","new_tab_label_li","new_tab_label_li_a","tab_bar_parent","tab_bar_content_divs","tab_content_html","is_sub_view","inferSubViewFromTab","init_callback_string","infer_subview_tab_state","source","model","tab_labels","prev_tab_name","tab_name","sub_view_div","tab_bar","visible_tab_indexes","tab_index","current_url","selectVal","key1","show_warning","details","first_el","$current_doing_context_action","error_list","found_in_current_tab","show_error","isError","parentContainer","is_warning","cleanTimer","result_array","tab0","did_clean_dic","edit_view_file_name","parent_table","type_id","meta_data","custom_field_id","form_item_input","tab0_column1","form_array","widget_container","input_div","widgetContainer","currency","code","navigation_widget_div","left_click","right_click","widgets","firstOrLastRecord","saveFormItemDiv","setResizeEvent","saveFormItemDivKey","hasKeyEvent","customLabelWidget","form_item","form_item_label_div","form_item_label","form_item_input_div","setValidationDic","tab_div","tab_column_div","tab_column_sub_div","item_label_div_width","next_select_item_id","target_node","target_index","current_tab_index","grid_current_page_items","current_navigation_data","current_pager_data","default_args","columnsArr","left_arrow","right_arrow","check_search","selected_index","source_data","cancel_callback","doLeftArrowClick","next_select_item","doRightArrowClick","pId","p_id","parent_context_menu_array","doNotSetFocus","selected_items","search_panel_w","current_view_div","saved_layout_li","e1","api_groups","option","completed_api_calls","new_obj","option_data","option_field_info","tip","h_box","text_box","option_name","field_name","array_name","search_input","default_layout_id","sort_filter","selected_display_columns","do_update","default_layout_name","a_layout_name","field_settings","basic_search_div","column1","column2","column3","already_created_ui","search_field","advSearchDiv","no_adv_ui","form_type","show_search","layout_div","save_btn","update_btn","del_btn","layouts_array","exclude_column","grid","grid_id","layout_data","display_columns","grid_needs_reload","grid_setup","container","rowId","id_array","need_break","column_header","onColumnHeaderClick","validFilterData","select_items","sort","getFromTabIndex","save_temp_filter","search_tab_select_index","target_ui_dic","autoChangeTab","basic_fields_len","search_input_1","t_grid_header","sort_array_len","sort_item","sortField","reset","next_sort","found","set_default_menu","page_action","ids","grid_source_data","new_record","current_data","top_border","bottom_border","header_size","tab_bar_label","tab_width","nav_width","wrap_div","total_tab_width","setArrowStatus","label_wrap","column_filter","enable_system_columns","current_select_layout_name","onGetUserGenericDataResult","columns_result","columns_result_data","sort_by_select_columns","sort_by_unselect_columns","index1","content1","fina_array","new_content","apiDisplayColumnsArray","len1","colModel","selected_item","permission_name","firstColumn","beforeLoadView","afterLoadView","subViewController","show_new_btn","grid_div","place_holder","last_date_stamp","available_balance_value","current_time_value","remaining_balance_value","summary_available_value","row","conversion_rate","iso_code","currency_id","my_currencies","base_currency_iso_code","decimal_places","lat","lng","company_api","country_arr","province_arr","query","tab_contact_info","dates","resultArray","beginDate","endDate","nextDate","offset","ui_id","sub_view_mode","sub_view_grid_autosize","cell_height","rows_to_show","child_context_border","element_id","table_header","bottom_div","total_number_div_height","footer_height","red_border_height","filtered_auto_fill_data","auto_fill_data","new_data","old_data","ignored_keys","old_record","old_item","keys","template","firebaseConfig","request_permission","refresh_token","send_token","registration","currentToken","show_message","device_token","payload","notification_id","foreground","timetrex_data","cookie_value","notification_denied_cookie","arrow","new_system_notifications","manual","amount","playPromise","title","body","priority","notification","notification_header","notification_title","notification_close_button","notification_body","notification_body_text","notification_body_link","active_notification","NotificationConsumer","__publicField","TTWebauthn","new_window","TTSAML","viewName","edit_id","IndexViewController","openEditView","checkIds","initRibbonMenuAndCopyRight","showRibbonMenuAndLoadView","permission_id","view_mode","children","clean","viewController","wizardName","defaultData","wizard_id","source_view","wizard","parent_view_controller","doNextAfterReportRouteChange","$view_controller","action_function","view_controller","TTPromise","category","success_callback","error_callback","onComplete","wait_category","wait_key","onError","pending_promises","c","pending_count","loading_box","layout_content","left_offset","process_number","timer","close_time","circle","message_id_dic","current_process_id","get_progress_timer","first_start_get_progress_timer","start_progress_timer","auto_clear_message_id_dic","last_iteration","temp_message_until_close","second_timer","time_offset","nanoBar","loading_bar_time","no_progress_for_next_call","showOverlay","closeOverlay","cancelProgressBar","removeProgressBar","showProgressBar","auto_clear","instant","getProgressBarProcess","message_label","loadingBoxWidget","loadngBox","close_icon","resetToDefault","complete_info","progress_bar","time_remaining","changeProgressBarMessage","updateProgressbar","percentage","secondDown","noProgressForNextCall","stopProgress","close_time_timeout","showNanobar","removeNanobar","BaseWizardController","title_1","direction","check_box","set_empty","accept_filter","apiClass","allow_multiple","layoutName","set_all","a_combobox","allowMultiple","gridId","allMultipleSelection","column_model","div","ul","button","no_result_box","templateName","report","PermissionManager","validate","permission","getPermissionLevel","subJobApplicationValidate","permission_section","getPermissionSectionByViewId","HelpMenuValidateAdmin","HelpMenuValidateSupervisor","checkTopLevelPermission","importValidate","importValidateFor","countryPermissionValidate","country_array","getPermissionData","TAlertManager","view","isShownNetworkAlert","closeBrowserBanner","showBrowserTopBanner","showNetworkErrorAlert","showPreSessionAlert","removePreSession","backToPreSession","previous_cookie_path","showErrorAlert","showAlert","showWarningAlert","ul_container","li","child_val","has_child","child_key","showConfirmAlert","cContent","remove","callBackFunction","yesLabel","noLabel","showFlexAlert","continue_label","cancel_label","show_cancel_button","showModalAlert","img_src","top_image","additional_body_style","additional_modal_style","button_label","button_color","button_disabled","creation_callback","checkCustomAgreementInput","Button","Menu","_normalizeStyle","_component_PVSButton","_mergeProps","_component_PVSMenu","force_active_item_index","enabled","find_result","item_index","new_item","original_command","new_active_item_index","menu_force_active","first_index","_component_SplitButton","new_array","_component_Menu","_component_Button","find_item_id","group_count","PrimeVueButton","ret_val","visible","not_group_header","not_single_separator","_resolveDynamicComponent","_component_PrimeVueButton","onUpdateMenu","onUpdateItem","onActivateMultiSelectItem","onActivateSplitButtonItem","onFreezeSplitButtonActiveItem","filter_left","filter_center","filter_right","menu_model","item_id","new_item_attributes","recursiveFind","haystack_array","needle_id","_component_TTContextButton","parent_mount_container","parent_context","vue_context","parent_type","parent_id","vue_menu_instance","view_controller_context","parsed_bb_menu","backbone_menu_format","icons","action_groups","parsed_icons","default_command","default_submenu_command","icon_id","sub_key","sub_menu_item","parse_item","action_group_id","check_visible","menu_item","item_attributes","reverse_action","ContextMenuManager","validation_field","error_tip_box","mass_edit_mode","need_parser_date","need_parser_sec","parsed_value","validate_timer","no_validate_timer","no_validate_timer_sec","disable_keyup_event","mode","is_static_width","static_width","original_static_width","do_validate","is_first_resize","errStr","isWarning","sec","example_width","padding","o","validate_sec","is_valid_input","select_value","set_any","set_select_item_when_set_source_data","valueKey","labelKey","customFirstItemLabel","set_index","html2canvas","StackTrace","Toast","c_value","file","password_wizard","selectAll","gridScrollTop","gridScrollDown","ui_clicked_date","ui_stack","loginData","initApps","initAnalytics","gtag_script","current_company","script","handleVisibilityChange","is_hidden","cookie_session_id","alert","content_div","range","selection","rxhtmlTag","el","email","tpl","uploader","document_name","file_data","document_revision_id","api_payroll_remittance_agency_event","step_obj","external_data","table_rows","row_data","column_one_keys","column_two_keys","upper_bound","tr","row_contents","event_result","api_payroll_remittance_agency","agency_result","render_type","report_name","w"],"ignoreList":[],"sources":["../../framework/jquery.i18n.js","../../components/LegacyView.vue","../../components/main_ui_router.js","../../global/TTUUID.js","../../model/Base.js","../../model/ResponseObject.js","../../model/APIReturnHandler.js","../../services/ServiceCaller.js","../../services/TimeTrexClientAPI.js","../../global/widgets/search_panel/FormItemType.js","../../global/RateLimit.js","../../global/widgets/view_min_tab/ViewMinTabBar.js","../../services/TTEventBus.js","../../services/HtmlTemplates.js","../../services/TTVueUtils.js","../../theme/default/images/bell_permissions.svg","../../components/login/TTMultiFactorAuthentication.vue","../../components/login/TTCustomAccept.vue","../../global/Global.js","../../components/TTAssistant.vue","../../components/TTTopbar.vue","../../components/TTTopContainer.vue","../../framework/apollo-vue/src/layout/composables/layout.js","../../framework/apollo-vue/src/layout/AppMenuItem.vue","../../components/main_menu/TTAppMenu.vue","../../components/main_menu/TTMenuSearch.vue","../../components/main_menu/MenuManager.js","../../components/TTLeftContainer.vue","../../components/TTMainUI.vue","../../global/LocalCacheData.js","../../views/TTBackboneView.js","../../views/BaseWindowController.js","../../global/widgets/paging/Paging2.js","../../views/BaseViewController.js","../../services/NotificationConsumer.js","../../services/TTWebauthn.js","../../services/TTSAML.js","../../IndexController.js","../../global/TTPromise.js","../../global/ProgressBarManager.js","../../views/wizard/BaseWizardController.js","../../global/PermissionManager.js","../../global/TAlertManager.js","../../components/context_menu/PrimeVueSplitButton.vue","../../components/context_menu/TTSplitButton.vue","../../components/context_menu/TTOverlayMenuButton.vue","../../components/context_menu/TTOverlayMultiSelectButton.vue","../../components/context_menu/TTContextButton.vue","../../components/context_menu/TTContextMenu.vue","../../components/context_menu/ContextMenuManager.js","../../global/widgets/text_input/TTextInput.js","../../global/widgets/text_input/TPasswordInput.js","../../global/widgets/combobox/TComboBox.js","../../main.js","../../views/portal/sign_in/PortalForgotPasswordController.js","../../views/portal/header/HeaderUploadResumeWidget.js","../../views/portal/hr/recruitment/PortalJobVacancyRowController.js","../../views/quick_punch/QuickPunchBaseViewController.js","../../global/widgets/wizard/Wizard.js","../../views/payroll/process_transactions_wizard/ProcessTransactionsWizard.js","../../views/payroll/remittance_wizard/PayrollRemittanceAgencyEventWizard.js","../../views/quick_punch/header/HeaderViewController.js"],"sourcesContent":["/*!\n * jQuery i18n plugin\n * @requires jQuery v1.1 or later\n *\n * See https://github.com/recurser/jquery-i18n\n *\n * Licensed under the MIT license.\n *\n * Version: <%= pkg.version %> (<%= meta.date %>)\n */\n(function($) {\n\t/**\n\t * i18n provides a mechanism for translating strings using a jscript dictionary.\n\t *\n\t */\n\n\tvar __slice = Array.prototype.slice;\n\n\t/*\n\t * i18n property list\n\t */\n\tvar i18n = {\n\n\t\tdict: null,\n\t\tmissingPattern: null,\n\n\t\t/**\n\t\t * load()\n\t\t *\n\t\t * Load translations.\n\t\t *\n\t\t * @param  property_list i18nDict : The dictionary to use for translation.\n\t\t */\n\t\tload: function(i18nDict, missingPattern) {\n\t\t\tif (this.dict !== null) {\n\t\t\t\t$.extend(this.dict, i18nDict);\n\t\t\t} else {\n\t\t\t\tthis.dict = i18nDict;\n\t\t\t}\n\n\t\t\tif (missingPattern) {\n\t\t\t\tthis.missingPattern = missingPattern;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * unload()\n\t\t *\n\t\t * Unloads translations and clears the dictionary.\n\t\t */\n\t\tunload: function() {\n\t\t\tthis.dict           = null;\n\t\t\tthis.missingPattern = null;\n\t\t},\n\n\t\t/**\n\t\t * _()\n\t\t *\n\t\t * Looks the given string up in the dictionary and returns the translation if\n\t\t * one exists. If a translation is not found, returns the original word.\n\t\t *\n\t\t * @param  string str           : The string to translate.\n\t\t * @param  property_list params.. : params for using printf() on the string.\n\t\t *\n\t\t * @return string               : Translated word.\n\t\t */\n\t\t_: function (str) {\n\t\t\tvar dict = this.dict;\n\t\t\tif (dict && dict.hasOwnProperty(str)) {\n\t\t\t\tstr = dict[str];\n\t\t\t} else if (this.missingPattern !== null) {\n\t\t\t\treturn this.printf(this.missingPattern, str);\n\t\t\t}\n\t\t\tvar args = __slice.call(arguments);\n\t\t\targs[0] = str;\n\t\t\t// Substitute any params.\n\t\t\treturn this.printf.apply(this, args);\n\t\t},\n\n\t\t/*\n\t\t * printf()\n\t\t *\n\t\t * Substitutes %s with parameters given in list. %%s is used to escape %s.\n\t\t *\n\t\t * @param  string str    : String to perform printf on.\n\t\t * @param  string args   : Array of arguments for printf.\n\t\t *\n\t\t * @return string result : Substituted string\n\t\t */\n\t\tprintf: function(str, args) {\n\t\t\tif (arguments.length < 2) return str;\n\t\t\tvar args = $.isArray(args) ? args : __slice.call(arguments, 1);\n\t\t\treturn str.replace(/([^%]|^)%(?:(\\d+)\\$)?s/g, function(p0, p, position) {\n\t\t\t\tif (position) {\n\t\t\t\t\treturn p + args[parseInt(position)-1];\n\t\t\t\t}\n\t\t\t\treturn p + args.shift();\n\t\t\t}).replace(/%%s/g, '%s');\n\t\t}\n\n\t};\n\n\t/*\n\t * _t()\n\t *\n\t * Allows you to translate a jQuery selector.\n\t *\n\t * eg $('h1')._t('some text')\n\t *\n\t * @param  string str           : The string to translate .\n\t * @param  property_list params : Params for using printf() on the string.\n\t *\n\t * @return element              : Chained and translated element(s).\n\t*/\n\t$.fn._t = function(str, params) {\n\t\treturn $(this).html(i18n._.apply(i18n, arguments));\n\t};\n\n\t$.i18n = i18n;\n})(jQuery);","<template>\n    <div id=\"contentContainer\" class=\"content-container\">\n        <div class=\"loading-view\">\n            <div class=\"progress-bar-div\">\n                <progress class=\"progress-bar\" max=\"100\" value=\"10\">\n                    <strong>Progress: 100% Complete.</strong>\n                </progress>\n                <span class=\"progress-label\">Initializing...</span>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\n\nexport default {\n    name: \"LegacyView\",\n    components: {}\n};\n</script>\n\n<style>\n</style>","// import { createRouter, createWebHistory } from 'vue-router'\nimport { createRouter, createMemoryHistory } from 'vue-router'\n\nimport LegacyView from '@/components/LegacyView';\n// import ReportView from '@/components/ReportView';\n\n//const lazy_load_test = () => import(/* webpackChunkName: \"dynamic-testview\" */'@/components/TTTestView'); // #VUETEST\n\n// Can also import this from another file.\nconst routes = [\n\t// { path: '/test', name: 'test', component: lazy_load_test, props:true }, // #VUETEST Lazy loaded, so not loaded normally. Only when used with `VueRouter.push('test')` or via dev tools.\n\t// { path: '/view/:viewId', name: 'view', component: LegacyView, props:true },\n\t// { path: '/report/:viewId', name: 'report', component: ReportView, props:true },\n\t// { path: '/report/:reportId', name: 'report', component: LegacyView },\n\t// { path: '/wizard/:wizardId', name: 'wizard', component: LegacyView },\n\t{ path: '/:pathMatch(.*)*', name: 'catch-all', component: LegacyView },\n\t// { path: '/#!m=Login', name: 'not-found', component: LegacyView },\n\t// { path: '/#!m=:viewId&*:restOf(.*)', name: 'not-found', component: LegacyView },\n\n];\n\nconst main_ui_router = createRouter({\n\t// history: createWebHistory(),\n\thistory: createMemoryHistory(),\n\troutes,\n});\n\nexport default main_ui_router;\n","export var TTUUID = function() {\n};\n\nTTUUID.zero_id = '00000000-0000-0000-0000-000000000000';\nTTUUID.not_exist_id = 'ffffffff-ffff-ffff-ffff-ffffffffffff';\n\nTTUUID.counter = 0;\n\nTTUUID.generateUUID = function( seed ) {\n\tif ( !seed && LocalCacheData && LocalCacheData.loginUser && LocalCacheData.loginUser.id ) {\n\t\tvar user_id = LocalCacheData.loginUser.id.split( '-' );\n\t\tseed = user_id[1] + user_id[2] + user_id[3];\n\t}\n\n\tif ( seed == null || seed.length != 12 ) {\n\t\tseed = ( TTUUID.randomUI08() | 1 ) * 0x10000000000 + TTUUID.randomUI40();\n\t}\n\n\tvar sequence = TTUUID.randomUI14();\n\tvar node = seed;\n\tvar tick = TTUUID.randomUI04();\n\tvar timestamp = new Date().getTime();\n\n\t//Helps ensure no duplicate UUIDs in a tight loop.\n\ttimestamp += TTUUID.counter;\n\tTTUUID.counter += 1;\n\n\tvar tf = TTUUID.getTimeFieldValues( timestamp );\n\tvar tl = tf.low + tick;\n\tvar thav = ( tf.hi & 0xFFF ) | 0x1000;\n\n\tsequence &= 0x3FFF;\n\tvar cshar = ( sequence >>> 8 ) | 0x80;\n\tvar csl = sequence & 0xFF;\n\n\treturn TTUUID.fromParts( tl, tf.mid, thav, cshar, csl, node );\n};\n\nTTUUID.castUUID = function( uuid ) {\n\t//allow nulls for cases where the column allows it.\n\tif ( uuid === null || TTUUID.isUUID( uuid ) == true ) {\n\t\treturn uuid;\n\t}\n\n\treturn TTUUID.zero_id;\n};\n\nTTUUID.isUUID = function( uuid ) {\n\tvar regex = new RegExp( '[a-zA-Z0-9]{8}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{12}' );\n\tif ( uuid != '' && regex.test( uuid ) ) {\n\t\treturn true;\n\t}\n\n\treturn false;\n};\n\nTTUUID.fromParts = function( timeLow, timeMid, timeHiAndVersion, clockSeqHiAndReserved, clockSeqLow, node ) {\n\tvar hex =\n\t\tTTUUID.paddedString( timeHiAndVersion.toString( 16 ), 4 ) + TTUUID.paddedString( timeMid.toString( 16 ), 4 )\n\t\t+ '-' + TTUUID.paddedString( timeLow.toString( 16 ).substring( 0, 4 ), 4 )\n\t\t+ '-' + TTUUID.paddedString( timeLow.toString( 16 ).substring( 5, 8 ), 4 )\n\t\t+ '-' + TTUUID.paddedString( clockSeqHiAndReserved.toString( 16 ), 2 ) + TTUUID.paddedString( clockSeqLow.toString( 16 ), 2 )\n\t\t+ '-' + node.toString().substring( 0, 12 );\n\n\treturn hex;\n};\n\nTTUUID.maxFromBits = function( bits ) {\n\treturn Math.pow( 2, bits );\n};\n\nTTUUID.limitUI04 = TTUUID.maxFromBits( 4 );\nTTUUID.limitUI08 = TTUUID.maxFromBits( 8 );\nTTUUID.limitUI14 = TTUUID.maxFromBits( 14 );\nTTUUID.limitUI16 = TTUUID.maxFromBits( 16 );\nTTUUID.limitUI40 = TTUUID.maxFromBits( 40 );\n\nTTUUID.randomUI04 = function() {\n\treturn TTUUID.getRandomInt( 0, ( TTUUID.limitUI04 - 1 ) );\n};\n\nTTUUID.randomUI08 = function() {\n\treturn TTUUID.getRandomInt( 0, ( TTUUID.limitUI08 - 1 ) );\n};\n\nTTUUID.randomUI14 = function() {\n\treturn TTUUID.getRandomInt( 0, ( TTUUID.limitUI14 - 1 ) );\n};\n\nTTUUID.randomUI40 = function() {\n\treturn ( 0 | Math.random() * ( 1 << 30 ) ) + ( 0 | Math.random() * ( 1 << 40 - 30 ) ) * ( 1 << 30 );\n};\n\nTTUUID.getTimeFieldValues = function( time ) {\n\tvar ts = time - Date.UTC( 1582, 9, 15 );\n\tvar hm = ( ( ts / 0x100000000 ) * 10000 ) & 0xFFFFFFF;\n\treturn { low: ( ( ts & 0xFFFFFFF ) * 10000 ) % 0x100000000, mid: hm & 0xFFFF, hi: hm >>> 16, timestamp: ts };\n};\n\nTTUUID.paddedString = function( string, length, z ) {\n\tstring = String( string );\n\tz = ( !z ) ? '0' : z;\n\tvar i = length - string.length;\n\tfor ( ; i > 0; i >>>= 1, z += z ) {\n\t\tif ( i & 1 ) {\n\t\t\tstring = z + string;\n\t\t}\n\t}\n\treturn string;\n};\n\nTTUUID.getRandomInt = function( min, max ) {\n\tvar random_num;\n\n\tvar crypto_obj = window.crypto || window.msCrypto; // for IE 11\n\tif ( crypto_obj ) {\n\t\tvar byte_array = new Uint8Array( 1 );\n\t\tcrypto_obj.getRandomValues( byte_array );\n\n\t\trandom_num = '0.' + byte_array[0].toString();\n\t} else {\n\t\trandom_num = Math.random();\n\t}\n\n\trandom_num = Math.floor( random_num * ( max - min + 1 ) ) + min;\n\n\treturn random_num;\n};","export class Base extends Backbone.Model {\n\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t} );\n\n\t\tsuper( options );\n\t}\n}\n","import { Base } from './Base';\n\nexport class ResponseObject extends Base {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tonResult: null,\n\t\t\tonError: null,\n\t\t\tdelegate: null,\n\t\t\tasync: null\n\t\t} );\n\t\tsuper( options );\n\t}\n}\n","/*\n\n To be the common  data model for data return from api\n\n */\nimport { Base } from './Base';\n\nexport class APIReturnHandler extends Base {\n\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tresult_data: null,\n\t\t\tdelegate: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tisValid() {\n\t\tif ( Global.isSet( this.get( 'result_data' ).api_retval ) && this.get( 'result_data' ).api_retval === false ) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetDetails() {\n\t\tif ( Global.isSet( this.get( 'result_data' ).api_details ) && Global.isSet( this.get( 'result_data' ).api_details.details ) ) {\n\t\t\treturn this.get( 'result_data' ).api_details.details;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetPagerData() {\n\t\tif ( Global.isSet( this.get( 'result_data' ).api_details ) && Global.isSet( this.get( 'result_data' ).api_details.pager ) ) {\n\t\t\treturn this.get( 'result_data' ).api_details.pager;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetResult() {\n\n\t\tvar result;\n\t\tif ( Global.isSet( this.get( 'result_data' ).api_retval ) ) {\n\t\t\tresult = this.get( 'result_data' ).api_retval;\n\t\t} else {\n\t\t\tresult = this.get( 'result_data' );\n\t\t}\n\n\t\tif ( typeof result === 'undefined' ) {\n\t\t\tresult = null;\n\t\t} else if ( $.type( result ) === 'array' && result.length === 0 ) {\n\t\t\tresult = {};\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tgetCode() {\n\t\tif ( Global.isSet( this.get( 'result_data' ).api_details ) && Global.isSet( this.get( 'result_data' ).api_details.code ) ) {\n\t\t\treturn this.get( 'result_data' ).api_details.code;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetDescription() {\n\t\tif ( Global.isSet( this.get( 'result_data' ).api_details ) && Global.isSet( this.get( 'result_data' ).api_details.description ) ) {\n\t\t\treturn this.get( 'result_data' ).api_details.description;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetRecordDetails() {\n\t\tif ( Global.isSet( this.get( 'result_data' ).api_details ) && Global.isSet( this.get( 'result_data' ).api_details.record_details ) ) {\n\t\t\treturn this.get( 'result_data' ).api_details.record_details;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetTotalRecords() {\n\t\tif ( Global.isSet( this.get( 'result_data' ).api_details ) && Global.isSet( this.get( 'result_data' ).api_details.record_details ) &&\n\t\t\tGlobal.isSet( this.get( 'result_data' ).api_details.record_details.total_records ) ) {\n\t\t\treturn this.get( 'result_data' ).api_details.record_details.total_records;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetValidRecords() {\n\t\tif ( Global.isSet( this.get( 'result_data' ).api_details ) && Global.isSet( this.get( 'result_data' ).api_details.record_details ) &&\n\t\t\tGlobal.isSet( this.get( 'result_data' ).api_details.record_details.valid_records ) ) {\n\t\t\treturn this.get( 'result_data' ).api_details.record_details.valid_records;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetInValidRecords() {\n\t\tif ( Global.isSet( this.get( 'result_data' ).api_details ) && Global.isSet( this.get( 'result_data' ).api_details.record_details ) &&\n\t\t\tGlobal.isSet( this.get( 'result_data' ).api_details.record_details.invalid_records ) ) {\n\t\t\treturn this.get( 'result_data' ).api_details.record_details.invalid_records;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetAttributeInAPIDetails( attrName ) {\n\t\tlet result_data = this.get( 'result_data' );\n\n\t\tif ( result_data && result_data.api_details ) {\n\t\t\treturn result_data.api_details[attrName];\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetDetailsAsString() {\n\t\tvar errorInfo = '';\n\n\t\t$.each( this.getDetails(), function( index, errorItem ) {\n\n\t\t\tfor ( var i in errorItem ) {\n\t\t\t\terrorInfo += errorItem[i][0] + '\\r';\n\t\t\t}\n\t\t} );\n\n\t\treturn errorInfo;\n\t}\n\n}\n","import { ResponseObject } from '@/model/ResponseObject';\nimport { TTUUID } from '@/global/TTUUID';\nimport { APIReturnHandler } from '@/model/APIReturnHandler';\n\nexport class ServiceCaller extends Backbone.Model {\n\tconstructor() {\n\t\t$.xhrPool = [];\n\t\tsuper();\n\t}\n\n\tgetMessageId() {\n\t\tif ( this.message_id ) {\n\t\t\treturn this.message_id\n\t\t} else {\n\t\t\tthis.setMessageId( TTUUID.generateUUID() );\n\t\t\treturn this.message_id;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsetMessageId( value ) {\n\t\tthis.message_id = value;\n\n\t\treturn true;\n\t}\n\n\tgetIsIdempotent() {\n\t\tif ( this.is_idempotent ) {\n\t\t\treturn this.is_idempotent\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsetIsIdempotent( value ) {\n\t\tthis.is_idempotent = value;\n\n\t\treturn true;\n\t}\n\n\targumentsHandler() {\n\t\tvar className = arguments[0];\n\t\tvar function_name = arguments[1];\n\t\tvar apiArgsAndResponseObject = arguments[2];\n\t\tvar lastApiArgsAndResponseObject = arguments[2][( apiArgsAndResponseObject.length - 1 )];\n\t\tvar apiArgs = {};\n\t\tvar responseObject;\n\t\tvar len;\n\n\t\tif ( Global.isSet( lastApiArgsAndResponseObject.onResult ) || Global.isSet( lastApiArgsAndResponseObject.async ) ) {\n\t\t\tlen = ( apiArgsAndResponseObject.length - 1 );\n\n\t\t\tresponseObject = new ResponseObject( lastApiArgsAndResponseObject );\n\n\t\t} else {\n\t\t\tlen = apiArgsAndResponseObject.length;\n\t\t\tresponseObject = null;\n\t\t}\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tapiArgs[i] = apiArgsAndResponseObject[i];\n\n\t\t\tif ( i === 0 && len === 1 &&\n\t\t\t\tGlobal.isSet( apiArgs[i] ) &&\n\t\t\t\tGlobal.isSet( apiArgs[i].second_parameter ) ) {\n\t\t\t\tapiArgs[1] = apiArgs[i].second_parameter;\n\t\t\t}\n\n\t\t}\n\n\t\treturn this.call( className, function_name, responseObject, apiArgs );\n\t}\n\n\tgetOptionsCacheKey( api_args, key ) {\n\n\t\t$.each( api_args, function( index, value ) {\n\n\t\t\tif ( $.type( value ) === 'object' ) {\n\t\t\t\tkey = key + '_' + JSON.stringify( value );\n\t\t\t} else {\n\t\t\t\tkey = key + '_' + value;\n\t\t\t}\n\n\t\t} );\n\n\t\treturn key;\n\n\t}\n\n\trepeatAPICall( className, function_name, apiArgs, responseObject ) {\n\t\tlet params = Object.values( JSON.parse( apiArgs.json ) );\n\t\tTTAPI[className][function_name]( ...params, responseObject.attributes );\n\t}\n\n\tuploadFile( form_data, paramaters, responseObj ) {\n\t\tvar message_id = this.getMessageId();\n\t\tvar upload_url = ServiceCaller.getURLByObjectType( 'upload' ) + '?' + paramaters + '&' + Global.getSessionIDKey() + '=' + LocalCacheData.getSessionID() +'&MessageID='+ message_id;\n\n\t\tProgressBar.showProgressBar( message_id );\n\t\tProgressBar.changeProgressBarMessage( $.i18n._( 'File Uploading' ) );\n\n\t\t$.ajax( {\n\t\t\turl: upload_url, //Server script to process data\n\t\t\theaders: {\n\t\t\t\t//Handle CSRF tokens and related headers here.\n\t\t\t\t'X-Client-ID': 'Browser-TimeTrex',\n\t\t\t\t'X-CSRF-Token': getCookie( 'CSRF-Token' ),\n\t\t\t},\n\t\t\ttype: 'POST',\n\n//\t\t\txhr: function() {     // Custom XMLHttpRequest\n//\t\t\t\tvar myXhr = $.ajaxSettings.xhr();\n//\t\t\t\tif ( myXhr.upload ) { // Check if upload property exists\n//\t\t\t\t\tmyXhr.upload.addEventListener( 'progress', progressHandlingFunction, false ); // For handling the progress of the upload\n//\t\t\t\t}\n//\n//\t\t\t\tfunction progressHandlingFunction() {\n//\t\t\t\t}\n//\n//\t\t\t\treturn myXhr;\n//\n//\t\t\t},\n\n\t\t\tsuccess: function( result ) {\n\t\t\t\tif ( result && result.toString().toLocaleLowerCase() !== 'true' ) {\n\t\t\t\t\tTAlertManager.showAlert( result );\n\t\t\t\t}\n\n\t\t\t\tif ( responseObj.onResult ) {\n\t\t\t\t\tresponseObj.onResult( result );\n\t\t\t\t}\n\n\t\t\t\tProgressBar.removeProgressBar();\n\t\t\t},\n\t\t\t// Form data\n\t\t\tdata: form_data,\n\t\t\tcache: false,\n\t\t\tcontentType: false,\n\t\t\tprocessData: false\n\t\t} );\n\n\t}\n\n\tprettyPrintAPIArguments( apiArgs ) {\n\t\tif ( apiArgs && apiArgs.json ) {\n\t\t\tvar retval = [];\n\t\t\tvar args = JSON.parse( apiArgs.json );\n\t\t\tfor ( var property_name in args ) {\n\t\t\t\tvar arg = args[property_name];\n\t\t\t\tretval.push( JSON.stringify( arg, null, 2 ) ); //Pretty print JSON\n\t\t\t}\n\n\t\t\treturn retval.join( ', ' );\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetCache( cache_key, responseObject, function_name, apiArgs ) {\n\t\tlet result = LocalCacheData.result_cache[cache_key];\n\t\t//Debug.Arr(result, 'Response from cached result. Key: '+cache_key, 'ServiceCaller.js', 'ServiceCaller', 'call', 10);\n\n\t\tlet apiReturnHandler = new APIReturnHandler();\n\n\t\tapiReturnHandler.set( 'result_data', result );\n\t\tapiReturnHandler.set( 'delegate', responseObject.get( 'delegate' ) );\n\t\tapiReturnHandler.set( 'function_name', function_name );\n\t\tapiReturnHandler.set( 'args', apiArgs );\n\n\t\tif ( responseObject.get( 'onResult' ) ) {\n\t\t\tresponseObject.get( 'onResult' )( apiReturnHandler );\n\t\t}\n\n\t\treturn apiReturnHandler;\n\t};\n\n\tisCachableFunction( function_name ) {\n\t\tlet is_cachable = false;\n\n\t\tswitch ( function_name ) {\n\t\t\tcase 'getOptions':\n\t\t\tcase 'isBranchAndDepartmentAndJobAndJobItemAndPunchTagEnabled':\n\t\t\tcase 'getUserGroup':\n\t\t\tcase 'getJobGroup':\n\t\t\tcase 'getJobItemGroup':\n\t\t\tcase 'getProductGroup':\n\t\t\tcase 'getDocumentGroup':\n\t\t\tcase 'getQualificationGroup':\n\t\t\tcase 'getKPIGroup':\n\t\t\tcase 'getHierarchyControlOptions':\n\t\t\t\tis_cachable = true;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn is_cachable;\n\t}\n\n\tcall( className, function_name, responseObject, apiArgs ) {\n\t\tvar $this = this;\n\t\tvar message_id;\n\t\tvar base_url = ServiceCaller.getAPIURL( 'Class=' + className + '&Method=' + function_name + '&v=2' );\n\t\tvar url = base_url;\n\t\tif ( LocalCacheData.getAllURLArgs() ) {\n\t\t\tif ( LocalCacheData.getAllURLArgs().hasOwnProperty( 'user_id' ) ) {\n\t\t\t\turl = url + '&user_id=' + LocalCacheData.getAllURLArgs().user_id;\n\t\t\t}\n\t\t\tif ( LocalCacheData.getAllURLArgs().hasOwnProperty( 'company_id' ) ) {\n\t\t\t\turl = url + '&company_id=' + LocalCacheData.getAllURLArgs().company_id;\n\t\t\t}\n\t\t}\n\t\tif ( Global.getStationID() ) {\n\t\t\turl = url + '&StationID=' + Global.getStationID();\n\t\t}\n\n\t\tvar apiReturnHandler;\n\t\tvar async;\n\n\t\tif ( responseObject && responseObject.get( 'async' ) === false ) {\n\t\t\tasync = responseObject.get( 'async' );\n\t\t} else {\n\t\t\tasync = true;\n\t\t}\n\t\tvar cache_key;\n\t\tswitch ( function_name ) {\n\t\t\tcase 'getOptions':\n\t\t\tcase 'isBranchAndDepartmentAndJobAndJobItemAndPunchTagEnabled':\n\t\t\tcase 'getHierarchyControlOptions':\n\t\t\tcase 'getUserGroup':\n\t\t\tcase 'getJobGroup':\n\t\t\tcase 'getJobItemGroup':\n\t\t\tcase 'getProductGroup':\n\t\t\tcase 'getDocumentGroup':\n\t\t\tcase 'getQualificationGroup':\n\t\t\tcase 'getKPIGroup':\n\n\t\t\t\tif ( function_name === 'getUserGroup' ) {\n\t\t\t\t\tcache_key = className + '.' + 'userGroup';\n\t\t\t\t} else if ( function_name === 'getJobGroup' ) {\n\t\t\t\t\tcache_key = className + '.' + 'jobGroup';\n\t\t\t\t} else if ( function_name === 'getJobItemGroup' ) {\n\t\t\t\t\tcache_key = className + '.' + 'jobItemGroup';\n\t\t\t\t} else if ( function_name === 'getProductGroup' ) {\n\t\t\t\t\tcache_key = className + '.' + 'productGroup';\n\t\t\t\t} else if ( function_name === 'getDocumentGroup' ) {\n\t\t\t\t\tcache_key = className + '.' + 'documentGroup';\n\t\t\t\t} else if ( function_name === 'getQualificationGroup' ) {\n\t\t\t\t\tcache_key = className + '.' + 'qualificationGroup';\n\t\t\t\t} else if ( function_name === 'getKPIGroup' ) {\n\t\t\t\t\tcache_key = className + '.' + 'kPIGroup';\n\t\t\t\t} else if ( function_name === 'getHierarchyControlOptions' ) {\n\t\t\t\t\tcache_key = 'getHierarchyControlOptions';\n\t\t\t\t} else {\n\t\t\t\t\tcache_key = this.getOptionsCacheKey( apiArgs, className + '.' + function_name );\n\t\t\t\t}\n\t\t\t\tif ( responseObject.get( 'noCache' ) === true ) {\n\t\t\t\t\tLocalCacheData.result_cache[cache_key] = false;\n\t\t\t\t}\n\n\t\t\t\tif ( cache_key && LocalCacheData.result_cache[cache_key] ) {\n\t\t\t\t\t//Use a promise to help prevent identical calls from being made before the first one returns and sets the cache.\n\t\t\t\t\tif ( LocalCacheData.result_cache[cache_key].pending ) {\n\t\t\t\t\t\tTTPromise.add( 'ServiceCaller', cache_key );\n\t\t\t\t\t\tTTPromise.wait( 'ServiceCaller', cache_key, function() {\n\t\t\t\t\t\t\tthis.getCache( cache_key, responseObject, function_name, apiArgs );\n\t\t\t\t\t\t}.bind( this ) );\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn this.getCache( cache_key, responseObject, function_name, apiArgs );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn apiReturnHandler;\n\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'setUserGroup':\n\t\t\tcase 'deleteUserGroup':\n\t\t\t\tcache_key = className + '.' + 'userGroup';\n\t\t\t\tLocalCacheData.result_cache[cache_key] = false;\n\t\t\t\tbreak;\n\t\t\tcase 'setJobGroup':\n\t\t\tcase 'deleteJobGroup':\n\t\t\t\tcache_key = className + '.' + 'jobGroup';\n\t\t\t\tLocalCacheData.result_cache[cache_key] = false;\n\t\t\t\tbreak;\n\t\t\tcase 'setJobItemGroup':\n\t\t\tcase 'deleteJobItemGroup':\n\t\t\t\tcache_key = className + '.' + 'jobItemGroup';\n\t\t\t\tLocalCacheData.result_cache[cache_key] = false;\n\t\t\t\tbreak;\n\t\t\tcase 'setProductGroup':\n\t\t\tcase 'deleteProductGroup':\n\t\t\t\tcache_key = className + '.' + 'productGroup';\n\t\t\t\tLocalCacheData.result_cache[cache_key] = false;\n\t\t\t\tbreak;\n\t\t\tcase 'setDocumentGroup':\n\t\t\tcase 'deleteDocumentGroup':\n\t\t\t\tcache_key = className + '.' + 'documentGroup';\n\t\t\t\tLocalCacheData.result_cache[cache_key] = false;\n\t\t\t\tbreak;\n\t\t\tcase 'setQualificationGroup':\n\t\t\tcase 'deleteQualificationGroup':\n\t\t\t\tcache_key = className + '.' + 'qualificationGroup';\n\t\t\t\tLocalCacheData.result_cache[cache_key] = false;\n\t\t\t\tbreak;\n\t\t\tcase 'setKPIGroup':\n\t\t\tcase 'deleteKPIGroup':\n\t\t\t\tcache_key = className + '.' + 'kPIGroup';\n\t\t\t\tLocalCacheData.result_cache[cache_key] = false;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tmessage_id = this.getMessageId();\n\n\t\tTTPromise.add( 'ServiceCaller', message_id );\n\n\t\tif ( className !== 'APIProgressBar' && function_name !== 'Logout' ) {\n\t\t\turl = url + '&MessageID=' + message_id;\n\t\t}\n\n\t\tif ( this.getIsIdempotent() == true ) {\n\t\t\turl = url + '&idempotent=1';\n\t\t}\n\n\t\tif ( ServiceCaller.extra_url ) {\n\t\t\turl = url + ServiceCaller.extra_url;\n\t\t}\n\n\t\tif ( !apiArgs ) {\n\t\t\tapiArgs = {};\n\n\t\t}\n\n\t\tapiArgs = { json: JSON.stringify( apiArgs ) };\n\n\t\t//Try to get a stack trace for each function call so if an error occurs we know exactly what triggered the call.\n\t\tvar stack_trace_str = null;\n\t\tif ( typeof Error !== 'undefined' ) {\n\t\t\tvar stack_trace = ( new Error() );\n\t\t\tif ( typeof stack_trace === 'object' && stack_trace.stack && typeof stack_trace.stack === 'string' ) {\n\t\t\t\tstack_trace_str = stack_trace.stack.split( '\\n' ); //This is eventually JSONified so convert it to an array for better formatting.\n\t\t\t} else {\n\t\t\t\tstack_trace_str = null;\n\t\t\t}\n\t\t\tstack_trace = null; // Previously null was 'delete' but not valid in JS strict mode.\n\t\t}\n\n\t\tvar api_called_date = new Date();\n\t\tvar api_stack = {\n\t\t\tapi: className + '.' + function_name,\n\t\t\targs: apiArgs.json,\n\t\t\tmessage_id: this.getMessageId(),\n\t\t\tapi_called_date: api_called_date.toISOString(),\n\t\t\tstack_trace: stack_trace_str\n\t\t};\n\t\tstack_trace_str = null; // Previously null was 'delete' but not valid in JS strict mode.\n\n\t\tif ( LocalCacheData.api_stack.length === 16 ) {\n\t\t\tLocalCacheData.api_stack.pop();\n\t\t}\n\n\t\tif ( function_name !== 'sendErrorReport' ) {\n\t\t\tLocalCacheData.api_stack.unshift( api_stack );\n\t\t}\n\n\t\tif ( className !== 'APIProgressBar' && function_name !== 'Login' && function_name !== 'getPreLoginData' && function_name !== 'listenForMultiFactorAuthentication' ) {\n\t\t\tProgressBar.showProgressBar( message_id );\n\t\t}\n\n\t\tif ( this.isCachableFunction( function_name ) === true ) {\n\t\t\tLocalCacheData.result_cache[cache_key] = { pending: true };\n\t\t}\n\n\t\t$.ajax(\n\t\t\t{\n\t\t\t\tdataType: 'JSON',\n\t\t\t\tdata: apiArgs,\n\t\t\t\theaders: {\n\t\t\t\t\t//#1568  -  Add \"fragment\" to POST variables in API calls so the server can get it...\n\t\t\t\t\t//Encoding is a must, otherwise HTTP requests will be corrupted on some web browsers (ie: Mobile Safari)\n\t\t\t\t\t//This caused the corrupted requests for things like: \"POST_/api/json/api_php?Class\"\n\t\t\t\t\t//Also it must use dashes instead of underscores for separators.\n\t\t\t\t\t'Request-Uri-Fragment': encodeURIComponent( LocalCacheData.fullUrlParameterStr ),\n\n\t\t\t\t\t//Handle CSRF tokens and related headers here.\n\t\t\t\t\t'X-Client-ID': 'Browser-TimeTrex',\n\t\t\t\t\t'X-CSRF-Token': getCookie( 'CSRF-Token' ),\n\t\t\t\t},\n\t\t\t\ttype: 'POST',\n\t\t\t\tasync: async,\n\t\t\t\turl: url,\n\t\t\t\tbeforeSend: function( jqXHR ) {\n\t\t\t\t\t$.ajax.request_start_time = Date.now();\n\t\t\t\t\tthis.jqXHR = jqXHR;\n\t\t\t\t\t$.xhrPool.push( this ); //Track all pending AJAX requests so we can cancel them if needed.\n\t\t\t\t},\n\t\t\t\tcomplete: function( jqXHR ) {\n\t\t\t\t\tvar index = $.xhrPool.indexOf( this );\n\t\t\t\t\tif ( index > -1 ) {\n\t\t\t\t\t\t$.xhrPool.splice( index, 1 ); //Remove completed AJAX request from pool.\n\t\t\t\t\t}\n\n\t\t\t\t\tvar request_total_time = ( Date.now() - $.ajax.request_start_time ); //milliseconds\n\t\t\t\t\tif ( request_total_time > 1000 ) { //Only log API calls that are slow.\n\t\t\t\t\t\tif ( typeof ( gtag ) !== 'undefined' && APIGlobal.pre_login_data.analytics_enabled === true ) {\n\t\t\t\t\t\t\tgtag( 'event', 'api_call', {\n\t\t\t\t\t\t\t\tclass: className,\n\t\t\t\t\t\t\t\tmethod: function_name,\n\t\t\t\t\t\t\t\tresponse_time: request_total_time\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\tDebug.Text( 'AJAX Response: Class: ' + className + ' Method: ' + function_name + ' Time: ' + request_total_time + 'ms', 'ServiceCaller.js', 'ServiceCaller', 'complete', 11 );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsuccess: function( result ) {\n\t\t\t\t\t//Debug.Arr(result, 'Response from API. message_id: '+ message_id, 'ServiceCaller.js', 'ServiceCaller', null, 10);\n\n\t\t\t\t\t//Resets message_id so it changes on the next API call. Only do this on success, so idempotent requests that error out don't get a new key on the next call.\n\t\t\t\t\t// FIXME: async API calls on the same api object can conflict with one another though.\n\t\t\t\t\t//        Take for instance onFormItemChange() triggering async api.Validate*(), when api.set*() is called, the idempotent=1 can be enabled for the validation with the same key.\n\t\t\t\t\t//        Then the set*() might incorrectly return the result from the validate()\n\t\t\t\t\t//        This is partially fixed by ignoring idempotency on all validate*() calls in the API, which it probably should anyways. However we need a proper fix for this in JS.\n\t\t\t\t\t$this.setMessageId( null );\n\n\t\t\t\t\tif ( Global.enable_api_tracing == true ) {\n\t\t\t\t\t\tvar api_trace_label = '%cAPI Request:%c ' + className + '->' + function_name + '(...) [Expand for Details]';\n\t\t\t\t\t\tconsole.groupCollapsed( api_trace_label, 'font-weight: bold', 'font-weight: normal' );\n\t\t\t\t\t\tconsole.log( '%c' + className + '->' + function_name + '%c(' + $this.prettyPrintAPIArguments( apiArgs ) + ')', 'font-weight: bold', 'font-weight: normal' );\n\n\t\t\t\t\t\tvar api_trace_raw_request_label = '%cRaw Request:%c [Expand for Details]';\n\t\t\t\t\t\tconsole.groupCollapsed( api_trace_raw_request_label, 'font-weight: bold', 'font-weight: normal' );\n\t\t\t\t\t\tconsole.log( '%cURL:%c ' + url, 'font-weight: bold', 'font-weight: normal' );\n\t\t\t\t\t\tconsole.log( '%cRaw POST Body (non-URLEncoded):%c json=' + apiArgs.json + '', 'font-weight: bold', 'font-weight: normal' );\n\t\t\t\t\t\tconsole.log( '%ccURL Command:%c curl -k --location --request POST --cookie \"' + Global.getSessionIDKey() + '=<SessionID>\" --form \\'json=' + apiArgs.json + '\\' \"' + base_url + '\"', 'font-weight: bold', 'font-weight: normal' );\n\t\t\t\t\t\tconsole.groupEnd( api_trace_raw_request_label );\n\n\t\t\t\t\t\tvar api_trace_response_label = '%cResponse:%c [Expand for Details]';\n\t\t\t\t\t\tconsole.groupCollapsed( api_trace_response_label, 'font-weight: bold', 'font-weight: normal' );\n\t\t\t\t\t\tconsole.log( JSON.stringify( result, null, 2 ) );\n\t\t\t\t\t\tconsole.groupEnd( api_trace_response_label );\n\n\t\t\t\t\t\tconsole.groupEnd( api_trace_label );\n\t\t\t\t\t\tapi_trace_raw_request_label = null; // Previously null was 'delete' but not valid in JS strict mode.\n\t\t\t\t\t\tapi_trace_response_label = null; // Previously null was 'delete' but not valid in JS strict mode.\n\t\t\t\t\t\tapi_trace_label = null; // Previously null was 'delete' but not valid in JS strict mode.\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !Global.isSet( result ) ) {\n\t\t\t\t\t\tresult = true;\n\t\t\t\t\t}\n\t\t\t\t\tif ( className !== 'APIProgressBar' && function_name !== 'Login' && function_name !== 'getPreLoginData' && function_name !== 'listenForMultiFactorAuthentication' ) {\n\t\t\t\t\t\tProgressBar.removeProgressBar( message_id );\n\t\t\t\t\t}\n\n\t\t\t\t\tapiReturnHandler = new APIReturnHandler();\n\t\t\t\t\tapiReturnHandler.set( 'result_data', result );\n\t\t\t\t\tapiReturnHandler.set( 'delegate', responseObject.get( 'delegate' ) );\n\t\t\t\t\tapiReturnHandler.set( 'function_name', function_name );\n\t\t\t\t\tapiReturnHandler.set( 'args', apiArgs );\n\n\t\t\t\t\tif ( !apiReturnHandler.isValid() && ( apiReturnHandler.getCode() === 'EXCEPTION' || apiReturnHandler.getCode() === 'EXCEPTION_CSRF' ) ) {\n\t\t\t\t\t\tDebug.Text( 'api-exception: Code: ' + apiReturnHandler.getCode() + ' Error: ' + apiReturnHandler.getDescription() +' Message ID: '+ message_id, 'ServiceCaller.js', 'ServiceCaller', null, 10);\n\t\t\t\t\t\tif ( apiReturnHandler.getCode() === 'EXCEPTION_CSRF' ) { //Don't bother recording CSRF exceptions.\n\t\t\t\t\t\t\tGlobal.sendAnalyticsEvent( 'service-caller', 'error:api-exception', 'api-exception: Code: ' + apiReturnHandler.getCode() + ' Error: ' + apiReturnHandler.getDescription() );\n\t\t\t\t\t\t\tTAlertManager.showAlert( apiReturnHandler.getDescription(), 'Error', function() {\n\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tGlobal.sendErrorReport( 'api-exception: Code: ' + apiReturnHandler.getCode() + ' Error: ' + apiReturnHandler.getDescription(), 'ServiceCaller.js' );\n\t\t\t\t\t\t\tTAlertManager.showAlert( $.i18n._( 'API Exception' ) + ': ' + apiReturnHandler.getDescription(), 'Error' );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//Error: Uncaught ReferenceError: promise_key is not defined\n\t\t\t\t\t\tif ( typeof promise_key != 'undefined' ) {\n\t\t\t\t\t\t\tTTPromise.reject( 'ServiceCaller', message_id );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tDebug.Text( 'ERROR: Unable to release promise because key is NULL.', 'ServiceCaller.js', 'ServiceCaller', null, 10 );\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else if ( !apiReturnHandler.isValid() && apiReturnHandler.getCode() === 'SESSION' ) {\n\t\t\t\t\t\t//Debug.Text('API returned session expired: '+ message_id, 'ServiceCaller.js', 'ServiceCaller', null, 10);\n\t\t\t\t\t\tGlobal.Logout(); //clearSessionCookie() in Logout() helps skip other API calls or prevent the UI from thinking we are still logged in.\n\t\t\t\t\t\tServiceCaller.cancel_all_error = true;\n\t\t\t\t\t\tLocalCacheData.login_error_string = $.i18n._( 'Session expired, please login again.' );\n\t\t\t\t\t\tif ( window.location.href == Global.getBaseURL() + '#!m=' + 'Login' ) {\n\t\t\t\t\t\t\t// Prevent a partially loaded login screen when SessionID cookie is set but not valid on server.\n\t\t\t\t\t\t\t//   However if the session is expired on the server, and the user tries to navigate to some other page,\n\t\t\t\t\t\t\t//   there could be multiple API calls queued up, which causes this reload() to be triggered many times,\n\t\t\t\t\t\t\t//   and network requests to be aborted, which triggers error messages. Disable the reload for now as in theory it shouldn't be needed.\n\t\t\t\t\t\t\t//   This reload also gets rid of the \"Session expired, please login again\" error message, which is not ideal.\n\t\t\t\t\t\t\t//window.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar paths = Global.getBaseURL().replace( ServiceCaller.root_url, '' ).split( '/' );\n\t\t\t\t\t\t\tif ( paths.indexOf( 'quick_punch' ) > 0 ) {\n\t\t\t\t\t\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + '#!m=' + 'QuickPunchLogin' );\n\t\t\t\t\t\t\t} else if ( paths.indexOf( 'portal' ) > 0 ) {\n\t\t\t\t\t\t\t\tif ( LocalCacheData.getAllURLArgs().company_id ) {\n\t\t\t\t\t\t\t\t\tLocalCacheData.setPortalLoginUser( null );\n\t\t\t\t\t\t\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + '#!m=PortalJobVacancy&company_id=' + LocalCacheData.getAllURLArgs().company_id );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif ( !LocalCacheData.getAllURLArgs().company_id ) {\n\t\t\t\t\t\t\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + '#!m=' + 'Login' );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tTTPromise.resolve( 'ServiceCaller', message_id );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else if ( !apiReturnHandler.isValid() && apiReturnHandler.getCode() === 'DOWN_FOR_MAINTENANCE' ) {\n\t\t\t\t\t\tGlobal.sendAnalyticsEvent( 'service-caller', 'error:down-for-maintenance', 'error:down-for-maintenance: Code: ' + apiReturnHandler.getCode() + ' Error: ' + apiReturnHandler.getDescription() );\n\n\t\t\t\t\t\t//Before the location.replace because after that point we can't be sure of execution.\n\t\t\t\t\t\tTTPromise.resolve( 'ServiceCaller', message_id );\n\t\t\t\t\t\t//replace instead of assignment to ensure that the DOWN_FOR_MAINTENANCE page does not end up in the back button history.\n\t\t\t\t\t\twindow.location.replace( ServiceCaller.root_url + LocalCacheData.loginData.base_url + 'html5/DownForMaintenance.php?exception=DOWN_FOR_MAINTENANCE' );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else if ( apiReturnHandler.getCode() === 'REAUTHENTICATE' ) {\n\t\t\t\t\t\tlet session_data = apiReturnHandler.getResult();\n\n\t\t\t\t\t\tif ( session_data.mfa.type_id == 100 ) {\n\t\t\t\t\t\t\tTTWebauthn.loginUser( LocalCacheData.getLoginUser().id, LocalCacheData.getLoginUser().user_name, () => $this.repeatAPICall( className, function_name, apiArgs, responseObject ) );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tGlobal.showAuthenticationModal( LocalCacheData.current_open_primary_controller.viewId, session_data.session_type, session_data.mfa, true, ( result ) => {\n\t\t\t\t\t\t\t\tDebug.Text( 'User Reauthenticated: ' + result, 'ServiceCaller.js', 'ServiceCaller', 'call', 10 );\n\t\t\t\t\t\t\t\tGlobal.hideAuthenticationModal();\n\n\t\t\t\t\t\t\t\t//After authentication is complete, reattempt the API call automatically so that the user does not need to click \"Save\" or repeat the action.\n\t\t\t\t\t\t\t\t$this.repeatAPICall( className, function_name, apiArgs, responseObject );\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tTTPromise.resolve( 'ServiceCaller', message_id );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//Debug.Text('API returned result: '+ message_id, 'ServiceCaller.js', 'ServiceCaller', null, 10);\n\n\t\t\t\t\t\t//only cache data when api return is successful and can be trusted (ie not logged out or session expired.)\n\t\t\t\t\t\tif ( $this.isCachableFunction( function_name ) === true ) {\n\t\t\t\t\t\t\tLocalCacheData.result_cache[cache_key] = result;\n\t\t\t\t\t\t\tTTPromise.resolve( 'ServiceCaller', cache_key );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//Error: Function expected in /interface/html5/services/ServiceCaller.js?v=9.0.0-20150822-090205 line 269\n\t\t\t\t\t\tif ( responseObject.get( 'onResult' ) && typeof ( responseObject.get( 'onResult' ) ) == 'function' ) {\n\t\t\t\t\t\t\tresponseObject.get( 'onResult' )( apiReturnHandler );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tTTPromise.resolve( 'ServiceCaller', message_id );\n\t\t\t\t},\n\n\t\t\t\terror: function( jqXHR, textStatus, errorThrown ) {\n\t\t\t\t\tTTPromise.reject( 'ServiceCaller', message_id );\n\t\t\t\t\tif ( className !== 'APIProgressBar' && function_name !== 'Login' && function_name !== 'getPreLoginData' && function_name !== 'listenForMultiFactorAuthentication' ) {\n\t\t\t\t\t\tProgressBar.removeProgressBar( message_id );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( $this.isCachableFunction( function_name ) === true && LocalCacheData.result_cache[cache_key] && LocalCacheData.result_cache[cache_key].pending ) {\n\t\t\t\t\t\t//Issue #3185 - getOptions() calls were not rejecting promises when an error occurred.\n\t\t\t\t\t\t//Such as when the factory did not have unique_columns in _getFactoryOptions.\n\t\t\t\t\t\tdelete LocalCacheData.result_cache[cache_key];\n\t\t\t\t\t\tTTPromise.reject( 'ServiceCaller', cache_key );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ServiceCaller.cancel_all_error ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tDebug.Text( 'AJAX Request Error: ' + errorThrown + ' Message: ' + textStatus + ' HTTP Code: ' + jqXHR.status, 'ServiceCaller.js', 'ServiceCaller', 'call', 10 );\n\t\t\t\t\tif ( jqXHR.responseText && jqXHR.responseText.indexOf( 'User not authenticated' ) >= 0 ) {\n\t\t\t\t\t\tServiceCaller.cancel_all_error = true;\n\n\t\t\t\t\t\tLocalCacheData.login_error_string = $.i18n._( 'Session timed out, please login again.' );\n\n\t\t\t\t\t\tGlobal.clearSessionCookie();\n\t\t\t\t\t\t//$.cookie( 'SessionID', null, {expires: 30, path: LocalCacheData.cookie_path} );\n\t\t\t\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + '#!m=' + 'Login' );\n\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( jqXHR.responseText && $.type( jqXHR.responseText ) === 'string' ) {\n\t\t\t\t\t\t\tTAlertManager.showNetworkErrorAlert( jqXHR, textStatus, errorThrown );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( jqXHR.status === 200 && !jqXHR.responseText ) {\n\t\t\t\t\t\tapiReturnHandler = new APIReturnHandler();\n\t\t\t\t\t\tapiReturnHandler.set( 'result_data', true );\n\t\t\t\t\t\tapiReturnHandler.set( 'delegate', responseObject.get( 'delegate' ) );\n\t\t\t\t\t\tapiReturnHandler.set( 'function_name', function_name );\n\t\t\t\t\t\tapiReturnHandler.set( 'args', apiArgs );\n\n\t\t\t\t\t\tif ( responseObject.get( 'onResult' ) ) {\n\t\t\t\t\t\t\tresponseObject.get( 'onResult' )( apiReturnHandler );\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn apiReturnHandler;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( jqXHR.status === 0 || ( jqXHR.status >= 400 && jqXHR.status <= 599 ) ) {\n\t\t\t\t\t\t\t//Status=0 (No response from server at all), 4xx/5xx is critical server failure.\n\t\t\t\t\t\t\t//Server can't respond properly due to 4xx/5xx error code, so display a message to the user. Can't redirect to down_for_maintenance page as that could be a 404 as well.\n\t\t\t\t\t\t\tTAlertManager.showNetworkErrorAlert( jqXHR, textStatus, errorThrown );\n\t\t\t\t\t\t\tProgressBar.cancelProgressBar();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( responseObject.get( 'onError' ) && typeof ( responseObject.get( 'onError' ) ) == 'function' ) {\n\t\t\t\t\t\t\tresponseObject.get( 'onError' )( apiReturnHandler );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\treturn apiReturnHandler;\n\t}\n}\n\nServiceCaller.getAPIURL = function( rest_url ) {\n\treturn ServiceCaller.base_url + ServiceCaller.base_api_url + '?' + rest_url;\n};\n\nServiceCaller.getURLByObjectType = function( object_type ) {\n\tvar append_csrf = false;\n\tvar append_cache_buster = false;\n\n\tvar retval = null;\n\n\tvar base_url = ServiceCaller.base_url + 'interface/send_file.php?api=1';\n\n\tswitch ( object_type.toLowerCase() ) {\n\t\tcase 'upload':\n\t\t\tretval = ServiceCaller.base_url + 'interface/upload_file.php';\n\t\t\tappend_csrf = false;\n\t\t\tbreak;\n\t\tcase 'import_csv_example':\n\t\t\tretval = ServiceCaller.base_url + 'interface/html5/views/wizard/import_csv/';\n\t\t\tappend_csrf = false;\n\t\t\tbreak;\n\t\tcase 'file_download':\n\t\t\tretval = base_url; //Must allow for appending '&object_type=...' on the end.\n\t\t\tappend_csrf = true;\n\t\t\tbreak;\n\t\tcase 'company_logo':\n\t\t\tretval = base_url + '&object_type=company_logo';\n\t\t\tappend_csrf = true;\n\t\t\tappend_cache_buster = true;\n\t\t\tbreak;\n\t\tcase 'legal_entity_logo':\n\t\t\tretval = base_url + '&object_type=legal_entity_logo';\n\t\t\tappend_csrf = true;\n\t\t\tappend_cache_buster = true;\n\t\t\tbreak;\n\t\tcase 'invoice_config':\n\t\t\tretval = base_url + '&object_type=invoice_config';\n\t\t\tappend_csrf = true;\n\t\t\tbreak;\n\t\tcase 'user_photo':\n\t\t\tretval = base_url + '&object_type=user_photo';\n\t\t\tappend_csrf = true;\n\t\t\tbreak;\n\t\tcase 'remittance_source_account':\n\t\t\tretval = base_url + '&object_type=remittance_source_account';\n\t\t\tappend_csrf = true;\n\t\t\tappend_cache_buster = true;\n\t\t\tbreak;\n\n\t\tcase 'primary_company_logo':\n\t\t\tretval = base_url + '&object_type=primary_company_logo';\n\t\t\tbreak;\n\t\tcase 'smcopyright':\n\t\t\tretval = base_url + '&object_type=smcopyright';\n\t\t\tbreak;\n\t\tcase 'copyright':\n\t\t\tretval = base_url + '&object_type=copyright';\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tDebug.Text( 'Object Type is unknown: '+ object_type, 'ServiceCaller.js', 'ServiceCaller', 'getURLByObjectType', 10 );\n\t\t\tbreak;\n\t}\n\n\t//Append CSRF-Token.\n\tif ( append_csrf == true ) {\n\t\tretval += '&X-CSRF-Token=' + getCookie( 'CSRF-Token' );\n\t}\n\n\tif ( append_cache_buster == true ) {\n\t\tretval += '&t=' + new Date().getTime();\n\t}\n\n\treturn retval;\n};\n\n//Abort in-flight AJAX calls on logout.\nServiceCaller.abortAll = function() {\n\t$.each( $.xhrPool, function( index, ajax_obj ) {\n\t\tif ( typeof ajax_obj == 'object' && ajax_obj.jqXHR && typeof ajax_obj.jqXHR == 'object' && typeof ajax_obj.jqXHR.abort === 'function' ) {\n\t\t\tif ( ajax_obj.url && ajax_obj.url.indexOf( 'Method=Logout' ) == -1 ) { //Don't abort the Logout call.\n\t\t\t\tDebug.Text( ' Aborting API call: ' + ajax_obj.url, 'ServiceCaller.js', 'ServiceCaller', 'abortAll', 10 );\n\t\t\t\tajax_obj.jqXHR.abort();\n\t\t\t} else {\n\t\t\t\tDebug.Text( 'Not aborting Logout API call...', 'ServiceCaller.js', 'ServiceCaller', 'abortAll', 10 );\n\t\t\t}\n\t\t}\n\t} );\n};\n\nServiceCaller.base_url = null;\nServiceCaller.base_api_url = null;\nServiceCaller.root_url = null;\nServiceCaller.cancel_all_error = false;\nServiceCaller.extra_url = false;\n","import { ServiceCaller } from '@/services/ServiceCaller';\n\nclass TimeTrexClientAPI extends ServiceCaller {\n\tconstructor( class_name, key_name ) {\n\t\tsuper();\n\n\t\tthis.className = class_name;\n\n\t\tif ( !key_name ) {\n\t\t\tkey_name = class_name.replace( 'API', '' );\n\t\t}\n\t\tthis.key_name = key_name;\n\n\t\treturn this.enableNoSuchMethod( this );\n\t}\n\n\tenableNoSuchMethod( obj ) {\n\t\treturn new Proxy( obj, {\n\t\t\tget( target, property_key ) {\n\t\t\t\tif ( property_key in target ) {\n\t\t\t\t\treturn target[property_key];\n\t\t\t\t} else if ( typeof target.__noSuchMethod__ == 'function' ) {\n\t\t\t\t\treturn function( ...args ) {\n\t\t\t\t\t\treturn target.__noSuchMethod__.call( target, property_key, args );\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n}\n\nTimeTrexClientAPI.prototype.__noSuchMethod__ = function( method_name, args ) {\n\t//Debug.Text('Magic Method: '+ method_name + ' Class: '+ this.service_caller.className +' Args: '+ args, 'TimeTrexClientAPI.js', 'TimeTrexClientAPI', '__noSuchMethod__', 11);\n\treturn this.argumentsHandler( this.className, method_name, args );\n};\n\nconst tt_api_target = {};\nconst tt_api_class_handler = {\n\tget( target, class_name ) {\n\t\t//Debug.Text('Proxy Handler: Class: ' + class_name, 'TimeTrexClientAPI.js', 'TimeTrexClientAPI', 'get', 11);\n\t\treturn new TimeTrexClientAPI( class_name );\n\t},\n};\n\nexport const TTAPI = new Proxy( tt_api_target, tt_api_class_handler );\n\n","export var FormItemType = function() {\n\n};\n\nFormItemType.TEXT = 'text';\nFormItemType.AWESOME_BOX = 'awesomeBox';\nFormItemType.AWESOME_DROPDOWN = 'awesomeDropdown';\nFormItemType.FORMULA_BUILDER = 'formulaBuilder';\nFormItemType.COMBO_BOX = 'comboBox';\nFormItemType.LIST = 'list';\nFormItemType.TEXT_INPUT = 'textInput';\nFormItemType.TIME_PICKER = 'timePicker';\nFormItemType.FEEDBACK_BOX = 'feedbackBox';\nFormItemType.PASSWORD_INPUT = 'passwordInput';\nFormItemType.TEXT_AREA = 'textArea';\nFormItemType.TINYMCE_TEXT_AREA = 'tinymceTextArea';\nFormItemType.TAG_INPUT = 'tagInput';\nFormItemType.DATE_PICKER = 'datePicker';\nFormItemType.RANGE_PICKER = 'range_date_picker';\nFormItemType.CHECKBOX = 'checkbox';\nFormItemType.SEPARATED_BOX = 'separatedBox';\nFormItemType.FILE_BROWSER = 'fileBrowser';\nFormItemType.IMAGE_BROWSER = 'imageBrowser';\nFormItemType.IMAGE_AVD_BROWSER = 'imageADVBrowser';\nFormItemType.CAMERA_BROWSER = 'cameraBrowser';\nFormItemType.IMAGE_CUT = 'imageCutArea';\nFormItemType.INSIDE_EDITOR = 'insideEditor';\nFormItemType.IMAGE = 'image';\nFormItemType.COLOR_PICKER = 'colorPicker';\n\nexport var WidgetNamesDic = function() {\n\n};\n\nWidgetNamesDic.ERROR_TOOLTIP = 'errorToolTip';\n\nWidgetNamesDic.EDIT_VIEW_FORM_ITEM = 'editViewFormItem';\nWidgetNamesDic.EDIT_VIEW_SUB_FORM_ITEM = 'editViewSubFormItem';\nWidgetNamesDic.PAGING = 'paging';\nWidgetNamesDic.PAGING_2 = 'paging_2';\nWidgetNamesDic.NO_RESULT_BOX = 'no_result_box';\nWidgetNamesDic.VIEW_MIN_TAB_BAR = 'view_min_tab_bar';\nWidgetNamesDic.VIEW_MIN_TAB = 'view_min_tab';","/**\n * RateLimit class\n * Based on classes/modules/core/RateLimit.class.php\n *\n * id: string to group similar calls\n * allowed_calls: integer that represents the number of calls in the time_frame\n * time_frame: integer number of seconds in which defined number of allowed_calls of specified id may be made\n *\n * Basic use case:\n *\n *    RateLimit.setID( 101 ); //unique identifier for this group of calls\n *    RateLimit.setAllowedCalls( 10 ); //max number of calls in time frame\n *    RateLimit.setTimeFrame( 900 ); //15 minutes in seconds\n *    if ( RateLimit.check() ) {\n *          //do rate limited activity\n *    } else {\n *          //do not do rate limited activity\n *    }\n *\n */\nexport var RateLimit = function() {\n};\n\n//attributes\nRateLimit.memory = {};\nRateLimit.id = '';\nRateLimit.allowed_calls = 10;\nRateLimit.time_frame = 3600; //1 hr\n\nRateLimit.getID = function() {\n\treturn this.id;\n};\nRateLimit.setID = function( value ) {\n\tif ( value != '' ) {\n\t\tthis.id = value;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nRateLimit.getAllowedCalls = function() {\n\treturn this.allowed_calls;\n};\nRateLimit.setAllowedCalls = function( value ) {\n\tif ( value != '' ) {\n\t\tthis.allowed_calls = value;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nRateLimit.getTimeFrame = function() {\n\treturn this.time_frame;\n};\nRateLimit.setTimeFrame = function( value ) {\n\tif ( value != '' ) {\n\t\tthis.time_frame = value;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nRateLimit.getRateData = function() {\n\tif ( typeof ( this.memory[this.id] ) == 'undefined' ) {\n\t\treturn null;\n\t}\n\treturn this.memory[this.id];\n};\nRateLimit.setRateData = function( value ) {\n\tif ( typeof ( this.memory[this.id] ) == 'undefined' ) {\n\t\tthis.memory[this.id] = {};\n\t}\n\tif ( value != '' ) {\n\t\tthis.memory[this.id] = value;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nRateLimit.getAttempts = function() {\n\tvar rate_data = this.getRateData();\n\tif ( Global.isSet( rate_data['attempts'] ) ) {\n\t\treturn rate_data['attempts'];\n\t}\n\n\treturn false;\n};\n\n/**\n * @returns {boolean}\n */\nRateLimit.check = function() {\n\tif ( this.getID() != '' ) {\n\t\tvar rate_data = this.getRateData();\n\t\tvar new_time = ( new Date() ).getTime();\n\n\t\tif ( Global.isSet( rate_data ) == false ) {\n\t\t\trate_data = {\n\t\t\t\tfirst_date: new_time,\n\t\t\t\tattempts: 0\n\t\t\t};\n\t\t} else if ( Global.isSet( rate_data ) ) {\n\n\t\t\tvar time_frame_milliseconds = this.getTimeFrame() * 1000;\n\t\t\tif ( rate_data.attempts > this.getAllowedCalls() && rate_data.first_date >= ( new_time - time_frame_milliseconds ) ) {\n\t\t\t\tDebug.Text( 'RateLimit limiting [' + rate_data.attempts + '/' + this.getAllowedCalls() + '] in ' + ( Math.floor( ( new_time - rate_data.first_date ) / 1000 ) ) + '/' + this.getTimeFrame() + 'sec', 'RateLimit.js', 'RateLimit', 'check', 10 );\n\t\t\t\treturn false;\n\t\t\t} else if ( rate_data.first_date < new_time - time_frame_milliseconds ) {\n\t\t\t\trate_data = {\n\t\t\t\t\tfirst_date: new_time,\n\t\t\t\t\tattempts: 0\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\trate_data.attempts++;\n\t\tthis.setRateData( rate_data );\n\t}\n\treturn true;\n};\n\nRateLimit.delete = function( id ) {\n\tif ( id != null ) {\n\t\tthis.id = id;\n\t}\n\tdelete this.memory[this.id];\n};\n","( function( $ ) {\n\n\t$.fn.ViewMinTabBar = function( options ) {\n\t\tvar opts = $.extend( {}, $.fn.ViewMinTabBar.defaults, options );\n\n\t\tvar $this = this;\n\n\t\tGlobal.addCss( 'global/widgets/view_min_tab/ViewMinTab.css' );\n\n\t\tvar createTab = function( view_id, view_label, url ) {\n\t\t\tvar tab = $( Global.loadWidgetByName( WidgetNamesDic.VIEW_MIN_TAB ) );\n\t\t\tvar view_name = tab.find( '.view-name' );\n\t\t\tview_name.text( view_label );\n\t\t\ttab.attr( 'id', 'min_tab_' + view_id );\n\n\t\t\ttab.attr( 'view_url', url );\n\n\t\t\tsetTimeout( function() {\n\t\t\t\ttab.addClass( 'show' );\n\t\t\t}, 100 );\n\n\t\t\tvar close_btn = tab.find( '.close-btn' );\n\n\t\t\ttab.unbind( 'click' ).click( function() {\n\t\t\t\tGlobal.setUINotready();\n\t\t\t\tvar view_id = $( this ).attr( 'id' ).replace( 'min_tab_', '' );\n\t\t\t\tvar url = $( this ).attr( 'view_url' );\n\t\t\t\tGlobal.removeViewTab( view_id );\n\n\t\t\t\tswitch ( view_id ) {\n\t\t\t\t\tcase 'ProcessPayrollWizard':\n\t\t\t\t\t\tIndexViewController.openWizard( view_id );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'PayrollRemittanceAgencyEventWizardController':\n\t\t\t\t\t\tIndexViewController.openWizardController( 'PayrollRemittanceAgencyEventWizardController' );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n//\t\t\t\t\t\tIndexViewController.goToView( view_id );\n\t\t\t\t\t\tGlobal.setURLToBrowser( url );\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\tclose_btn.unbind( 'click' ).click( function() {\n\t\t\t\tvar view_id = $( this ).parent().attr( 'id' ).replace( 'min_tab_', '' );\n\t\t\t\tGlobal.removeViewTab( view_id );\n\t\t\t} );\n\n\t\t\t$this.append( tab );\n\t\t};\n\n\t\tthis.buildTabs = function( tab_map ) {\n\n\t\t\t//$this.empty();\n\t\t\tvar i = 0;\n\t\t\tfor ( var key in tab_map ) {\n\t\t\t\tif ( tab_map.hasOwnProperty( key ) && key.indexOf( '_url' ) === -1 ) {\n\t\t\t\t\tvar view_id = key;\n\t\t\t\t\tvar view_label = tab_map[key];\n\t\t\t\t\tvar view_url = tab_map[key + '_url'];\n\t\t\t\t\tif ( $( '#min_tab_' + view_id ).length === 0 ) {\n\t\t\t\t\t\tcreateTab( view_id, view_label, view_url );\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\ti = i + 1;\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.each( function() {\n\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.ViewMinTabBar.defaults = {};\n\t$.fn.ViewMinTabBar.html = {\n\t\ttab: `\n\t\t<div class=\"p-button p-component view-min-tab animated\">\n\t\t\t<span class=\"view-name\"></span>\n\t\t\t<span class=\"tticon tticon-cancel_black_24dp close-btn\"></span>\n\t\t</div>`,\n\t\ttab_bar: `<div class=\"view-min-tab-bar\"></div>`\n\t};\n\n} )( jQuery );","import mitt from 'mitt';\nconst EventBus = mitt();\n\n//Issue #3049 - Moved class static fields outside of main TTEventBus class as Safari v14.1 and older do not support class field declarations.\nwindow.TTEventBusStatics = { AUTO_CLEAR_ON_EXIT: true, mitt: EventBus, _events_by_listener_scope: {} }; //Constants and external libraries\n//_events_by_listener_scope  - Internal data element, only to be accessed/changed via functions in this class. Static as its shared across scope_id's.\n\n/**\n * How to understand the ID's used in this class.\n * this.scope_id:\tis tied to the owner of the instance of TTEventBus.\n * \t\t\t\t\tso that they can be removed when the owner of that scope is unloaded/unmounted.\n * mitt_event_id:\tis passed to the mitt event library. It uses the event scope id rather than stored instance scope_id,\n * \t\t\t\t\tbecause listeners within a view/component might listen to different scope_id's depending on event.\n * unique_listener_id: is only needed for debugging currently, to be able to differentiate between two different listeners\n * \t\t\t\t\tlistening to the same event on the same scope, but using different event handler functions.\n *\n *\n */\nclass TTEventBus {\n\t// Standard mitt calls we want to expose for backwards compatibility to our old code.\n\t// static on = TTEventBusStatics.mitt.on;\n\t// static off = TTEventBusStatics.mitt.off;\n\n\tconstructor( options = {} ) {\n\t\t// TTEventBus will happily works for both Views and Vue Components using a single id variable, but tracking them both might be more useful in the future.\n\t\tthis._options = options; // Unlikely to use directly, but will store here for debugging and future options.\n\t\tthis.scope_id = null; //scope_id of the listening view or component. Not neccessarily the scope of an event. When this scope unloads, we want to clear listener events related to that scope.\n\t\tthis._setInstanceScopeId( this.generateScopeIdFromOptions( options ) );\n\t\tDebug.Text( 'constructor called ('+ this.scope_id +').', 'TTEventBus.js', 'TTEventBus', 'constructor', 11 );\n\t}\n\n\t/**\n\t * Scope is created depending on availability of view id and component id. In most cases, the standard is to either use the view_id or component_id, to use both would overcomplicate storage of the components id's in the views..\n\t * @param options\n\t * @returns {string|boolean}\n\t */\n\tgenerateScopeIdFromOptions( options ) {\n\t\t// E.g. Schedule.vue-schedule-control-bar\n\t\t// var scope_string = '';\n\t\t// if( options?.view_id ) {\n\t\t// \tscope_string += options.view_id;\n\t\t// }\n\t\t// if( options?.component_id ) {\n\t\t// \tif( scope_string !== '' ) { scope_string += '.' }\n\t\t// \tscope_string += options.component_id;\n\t\t// }\n\t\t//\n\t\t// return scope_string;\n\t\tif ( options && options.view_id && options.component_id ) {\n\t\t\tDebug.Warn( 'Are you sure you want to set both view and component id? This complicates things.', 'TTEventBus.js', 'TTEventBus', 'generateScopeIdFromOptions', 2 );\n\t\t\treturn options.view_id + '.' + options.component_id;\n\t\t} else if ( options && options.view_id ) {\n\t\t\treturn options.view_id;\n\t\t} else if ( options && options.component_id ) {\n\t\t\treturn options.component_id;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t/**\n\t * Don't call this directly, as we need to generate the scope_id via generateScopeFromOptions first.\n\t * @param scope_id\n\t * @private\n\t */\n\t_setInstanceScopeId( scope_id ) {\n\t\treturn this.scope_id = scope_id;\n\t}\n\n\tgetInstanceScopeId() {\n\t\treturn this.scope_id;\n\t}\n\n\tgenerateMittId( scope_id, event_id ) {\n\t\t// E.g. Schedule.vue-schedule-control-bar.scheduleModeOnChange\n\t\treturn scope_id + '.' + event_id;\n\t}\n\n\t/**\n\t * Event that should only last for that view/vue component and be removed when scope is destroyed/unloaded.\n\t * @param event_scope The scope_id related to the event.\n\t * @param event_id id of the event, should be unique within the provided scope.\n\t * @param event_handler Function to call when event is triggered.\n\t * @param auto_clear_on_exit Specifies if this event should not be auto cleared when the vue/component is unloaded. Set using TTEventBusStatics.AUTO_CLEAR_ON_EXIT\n\t */\n\ton( event_scope, event_id, event_handler, auto_clear_on_exit ) {\n\t\tTTEventBusStatics._events_by_listener_scope[ this.scope_id ] = TTEventBusStatics._events_by_listener_scope[ this.scope_id ] || [];\n\n\t\t// If we want unique ID's then use TTUUID.generateUUID(), but we want unique to a scope, so that duplicates can be prevented.\n\t\tvar mitt_event_id = this.generateMittId( event_scope, event_id);\n\t\tvar unique_listener_id = this.scope_id + ':' + mitt_event_id + ':' + TTUUID.generateUUID();\n\n\t\tTTEventBusStatics._events_by_listener_scope[ this.scope_id ].push( {\n\t\t\tunique_listener_id: unique_listener_id,\n\t\t\tmitt_event_id: mitt_event_id,\n\t\t\tevent_scope: event_scope,\n\t\t\tevent_id: event_id,\n\t\t\tevent_handler: event_handler,\n\t\t\tauto_clear_on_exit: auto_clear_on_exit\n\t\t} );\n\t\tTTEventBusStatics.mitt.on( mitt_event_id, event_handler );\n\t\tDebug.Text( this.scope_id + ': Listener created for ('+ unique_listener_id +').', 'TTEventBus.js', 'TTEventBus', 'on', 11 );\n\n\t\treturn unique_listener_id;\n\t}\n\n\t/**\n\t * Trigger EventBus event, but converts the scope_id and event_id into the mitt event id that the event is registered with.\n\t * @param event_scope The scope_id related to the event.\n\t * @param event_id id of the event, should be unique within the provided scope.\n\t * @param event_data Object containing event data as parameters.\n\t */\n\temit( event_scope, event_id, event_data ) {\n\t\tvar mitt_event_id = this.generateMittId( event_scope, event_id);\n\t\tDebug.Text( this.scope_id + ': Event emitted for ('+ mitt_event_id +').', 'TTEventBus.js', 'TTEventBus', 'emit', 11 );\n\n\t\treturn TTEventBusStatics.mitt.emit( mitt_event_id, event_data );\n\t}\n\n\t/**\n\t * TODO: UNFINISHED.\n\t * TODO: Improve this by adding ability to remove by scope and name, or scope, name and callback, or by unique ID.\n\t * Warning: This will remove all events that match the scope_id and event_id, even if there are multiple.\n\t * @param scope_id the scope of the event that needs to be switched off.\n\t * @param event_id the event_id of the event tyhat needs to be switched off.\n\t * @returns {void|number}\n\t */\n\toff( scope_id, event_id ) {\n\t\tvar scope_array = TTEventBusStatics._events_by_listener_scope[ scope_id ];\n\t\tif( scope_array === undefined ) {\n\t\t\t// scope_id not found.\n\t\t\tDebug.Error( 'Error: invalid params passed. scope_id not found.', 'TTEventBus.js', 'EventBus', 'off', 1 );\n\t\t\treturn -1;\n\t\t}\n\t\tvar removeIndex = scope_array.map( item => item.event_id ).indexOf( event_id ); // TODO: Will only match the FIRST found, problem for multiple listeners like in Schedule.scheduleModeOnChange\n\t\tif( removeIndex >= 0 ) {\n\t\t\tvar stored_event = scope_array[ removeIndex ];\n\t\t\tscope_array.splice(removeIndex, 1);\n\t\t\tDebug.Text( this.scope_id + ': Listener removed for ('+ stored_event.mitt_event_id +').', 'TTEventBus.js', 'EventBus', 'off', 11 );\n\n\t\t\treturn TTEventBusStatics.mitt.off( stored_event.mitt_event_id, stored_event.event_handler );\n\t\t} else {\n\t\t\t// event_id not found in array.\n\t\t\tDebug.Error( 'Error: invalid params passed. event_id not found.', 'TTEventBus.js', 'EventBus', 'off', 1 );\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\t/**\n\t * Used to trigger allOff() when unloading a view/component, using stored scope_id.\n\t * @returns {number|boolean}\n\t */\n\tautoClear() {\n\t\tDebug.Text( 'Auto off triggered for ('+ this.scope_id +').', 'TTEventBus.js', 'EventBus', 'autoClear', 11 );\n\t\treturn this.allOff( this.scope_id );\n\t}\n\t/**\n\t * This removes all events registered on the given scope. This will only apply to events that have the AUTO_CLEAR_ON_EXIT flag.\n\t * @param scope_id\n\t */\n\tallOff( scope_id ) {\n\t\tvar scope_array = TTEventBusStatics._events_by_listener_scope[ scope_id ];\n\t\tif( scope_array === undefined ) {\n\t\t\t// scope_id not found.\n\t\t\tDebug.Text( 'Scope not found. But could be normal if this is a global function triggered on a scope with no events.', 'TTEventBus.js', 'EventBus', 'allOff', 2 );\n\n\t\t\treturn -1;\n\t\t}\n\n\t\t//Loop in reverse to easily remove array values.\n\t\tfor ( let i = scope_array.length - 1; i >= 0; i-- ) {\n\t\t\tif ( scope_array[i].auto_clear_on_exit ) {\n\t\t\t\t// Remove event\n\t\t\t\tTTEventBusStatics.mitt.off( scope_array[i].mitt_event_id, scope_array[i].event_handler );\n\t\t\t\tDebug.Text( 'Auto removed ' + scope_array[i].mitt_event_id + ' event on scope close.', 'TTEventBus.js', 'EventBus', 'allOff', 2 );\n\t\t\t\tscope_array.splice( i, 1 );\n\t\t\t} else {\n\t\t\t\tDebug.Text( 'Event does not have AUTO_CLEAR_ON_EXIT. Skipping ' + scope_array[i].mitt_event_id, 'TTEventBus.js', 'EventBus', 'allOff', 2 );\n\t\t\t}\n\t\t}\n\n\t\tif ( !TTEventBusStatics._events_by_listener_scope[ scope_id ] || TTEventBusStatics._events_by_listener_scope[ scope_id ].length === 0 ) {\n\t\t\t//Remove empty scope array.\n\t\t\tdelete TTEventBusStatics._events_by_listener_scope[ scope_id ];\n\t\t}\n\n\t\treturn true;\n\t}\n}\n\nexport default TTEventBus;\n","class HtmlTemplates {\n\n\tconstructor() {\n\t}\n\n\t/**\n\t * Conditionally insert variable or html. Can be used in two ways.\n\t * Either 1) pass html, and if so it will use the html if the field is true.\n\t * Or, 2) if the field is a value (and truthy), and html is undefined/not provided, then return the field value.\n\t * Instead of 2), you can also reference a variable directly, but risk outputting 'undefined' into the output html.\n\t * @param field Either a data value evaluating as truthy, or a Boolean.\n\t * @param html Optional html field to use if field is Boolean.\n\t * @returns {string|*}\n\t */\n\toutputif( field, html ) { // function to be called outputif, or printif\n\t\tif ( field ) {\n\t\t\treturn html ? html : field;\n\t\t} else {\n\t\t\treturn '';\n\t\t}\n\t}\n\n\t/***\n\t * Conditionally output options passed to the view controller constructor. Wrapper for outputif to handle multiple options.\n\t * @param options\n\t * @returns {string}\n\t */\n\toutputOptions( options ) {\n\t\tlet output = [];\n\t\tfor ( var i = 0; i < options.length; i++ ) {\n\t\t\tlet result = this.outputif( options[i].option, options[i].html );\n\t\t\tif ( result ) {\n\t\t\t\toutput.push( result );\n\t\t\t}\n\t\t}\n\t\treturn output.length > 0 ? '{ ' + output.join( ', ' ) + ' }' : '';\n\t}\n\n\t/**\n\t * PascalCase to snake_case\n\t */\n\tconvertPascalCase2SnakeCase( string ) {\n\t\t// all lowercase separated by _\n\t\treturn string.split( /(?=[A-Z][a-z])/ ).join( '_' ).toLowerCase(); // Fix: [A-Z][a-z] is needed to not split on all caps like ROEView. But this wont handle single caps at the end though.\n\t}\n\n\t/**\n\t * PascalCase to kebab-case\n\t */\n\tconvertPascalCase2KebabCase( string ) {\n\t\t// all lowercase separated by -\n\t\treturn string.split( /(?=[A-Z][a-z])/ ).join( '-' ).toLowerCase(); // Fix: [A-Z][a-z] is needed to not split on all caps like ROEView. But this wont handle single caps at the end though.\n\t}\n\n\tgetTemplateTypeFromFilename( filename ) {\n\t\tvar type;\n\n\t\tswitch ( true ) { // known as 'overloaded switch'\n\t\t\t// The following views will use the new templating logic. Order of these statements is important, first rule to match is used.\n\t\t\tcase this.checkViewClassForInlineHtmlbyFilename( filename ) !== false: // If success, it will return a String with the html.\n\t\t\t\t// If a view class contains a static html_template value, then use this as an override instead of any specific type template matched by filename.\n\t\t\t\ttype = TemplateType.INLINE_HTML;\n\t\t\t\tbreak;\n\t\t\tcase filename.indexOf( 'Sub' ) === 0: // Checks 'Sub' at start of filename. Must come before ReportView, otherwise it will conflict for SubSavedReportView.html\n\t\t\t\ttype = TemplateType.SUB_VIEW;\n\t\t\t\tbreak;\n\t\t\tcase filename.indexOf( 'EditView.html' ) !== -1: // Must come before List Views, otherwise it will match for those due to both ending in View.html\n\t\t\t\ttype = TemplateType.EDIT_VIEW;\n\t\t\t\tbreak;\n\t\t\tcase filename.indexOf( 'ReportView.html' ) !== -1 && filename.includes( 'Saved' ) === false: // Must come before List Views, and after 'Sub' otherwise reports will be loaded as list views. However make sure SavedReport is loaded as a list view.\n\t\t\t\ttype = TemplateType.REPORT_VIEW;\n\t\t\t\tbreak;\n\t\t\tcase filename.indexOf( 'View.html' ) !== -1: // Must come more or less last, otherwise it will conflict with other files containing View.html, like EditView.html and ReportView.html\n\t\t\t\ttype = TemplateType.LIST_VIEW;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t// If no template types are matched, treat as legacy html.\n\t\t\t\ttype = TemplateType.LEGACY_HTML; // This results in the relevant html file being loaded via the network. The new tab parsing logic may still run!\n\t\t}\n\n\t\treturn type;\n\t}\n\n\t//Certain views do not fall under the rules of 'getTemplateTypeFromFilename()' and require special handling.\n\t//This can be removed once we switch how views are loaded and can apply these rules directly on the view itself.\n\tgetTemplateOptionsFromViewId( view_id ) {\n\t\tlet options = {\n\t\t\tview_id: view_id,\n\t\t\t// Remember, sub_view_mode is not included here as not yet available here; view controller has not yet been loaded. Sub View Mode will be determined by template_type using the file name data. Will be applied as an option in HtmlTemplates.getGenericListViewHtml\n\t\t};\n\n\t\t//The following tax reports require an additional tab.\n\t\tlet reports_require_form_setup = ['RemittanceSummaryReport', 'T4SummaryReport', 'T4ASummaryReport', 'Form941Report', 'Form940Report', 'Form1099NecReport', 'FormW2Report', 'AffordableCareReport', 'USStateUnemploymentReport', 'USPERSReport','USEEOReport'];\n\t\tif ( reports_require_form_setup.includes( view_id ) ) {\n\t\t\toptions.report_form_setup = true;\n\t\t}\n\n\t\tlet sub_view_require_warning_message = [`UserDateTotal`];\n\t\tif ( sub_view_require_warning_message.includes( view_id ) ) {\n\t\t\toptions.sub_view_warning_message = true;\n\t\t}\n\n\t\t//Issue #3158 - If these controllers are cached then side effects can occur.\n\t\t//Such as permission denied alerts after opening login view on Invoice -> Client view.\n\t\tlet view_do_not_cache_controller = [`LoginUserWizard`, 'LoginUser', 'FindAvailableWizard', 'FindAvailable'];\n\t\tif ( view_do_not_cache_controller.includes( view_id ) ) {\n\t\t\toptions.do_not_cache_controller = true;\n\t\t}\n\n\t\t//Audit log is both a TemplateType.INLINE_HTML and a TemplateType.SUB_VIEW under the current HTML2JS system.\n\t\t//Once we switch to loading ViewControllers before HTML this special case can be removed.\n\t\tif( view_id === 'Log' ) {\n\t\t\toptions.is_sub_view = true;\n\t\t}\n\n\t\t//Views extending BaseTreeViewController have slightly different requirments such as not show total number div.\n\t\t//Once we switch to loading ViewControllers before the HTML this can be conditional by checking if the controller has tree_mode set to true.\n\t\tlet base_tree_views = ['JobGroup', 'JobItemGroup', 'PunchTagGroup', 'UserGroup', 'DocumentGroup', 'KPIGroup', 'ClientGroup', 'ProductGroup'];\n\t\tif ( base_tree_views.includes( view_id ) ) {\n\t\t\toptions.base_tree_view = true;\n\t\t}\n\n\t\treturn options;\n\t}\n\n\tcheckViewClassForInlineHtmlbyFilename( filename ) {\n\t\t// Lets see if this view class contains a html_template override, which should precede any type definitions.\n\t\tlet check_class = window[ filename.replace(/\\.html$/,'') + 'Controller' ];\n\t\tif( check_class !== undefined && typeof check_class.html_template === 'string' ) {\n\t\t\treturn check_class.html_template;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param {TemplateType} type\n\t * @param {Object} options\n\t * @param {Function} [onResult]\n\t */\n\tgetTemplate( type, options = {}, onResult ) {\n\n\t\tvar html_template;\n\n\t\tswitch ( type ) {\n\t\t\tcase TemplateType.LIST_VIEW:\n\t\t\t\thtml_template = this.getGenericListViewHtml( options );\n\t\t\t\tbreak;\n\t\t\tcase TemplateType.SUB_VIEW:\n\t\t\t\toptions.is_sub_view = true; // Force this to be true, as it's a sub_view after all. (This switch data is based off html filename request)\n\t\t\t\thtml_template = this.getGenericListViewHtml( options );\n\t\t\t\tbreak;\n\t\t\tcase TemplateType.EDIT_VIEW:\n\t\t\t\t// code block\n\t\t\t\thtml_template = HtmlTemplatesGlobal.genericEditView( options );\n\t\t\t\tbreak;\n\t\t\tcase TemplateType.REPORT_VIEW:\n\t\t\t\t// code block\n\t\t\t\thtml_template = HtmlTemplatesGlobal.genericReportEditView( options );\n\t\t\t\tbreak;\n\t\t\tcase TemplateType.INLINE_HTML:\n\t\t\t\thtml_template = this.getViewScriptTagHtml( options ) + this.checkViewClassForInlineHtmlbyFilename( options.filename );\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tDebug.Error( 'HTML2JS: Error occured getting template. No matches for ' + options.view_id, 'HtmlTemplates.js', 'HtmlTemplates.js', 'getTemplate', 1 );\n\t\t\t\treturn -1;\n\t\t}\n\n\t\t// If callback onResult exists, call the function, else return html.\n\t\tif ( onResult ) {\n\t\t\tonResult( html_template ); // should we put this outside the switch? Depends how similar the other switch statements are.\n\t\t} else {\n\t\t\treturn html_template;\n\t\t}\n\t}\n\n\t/**\n\t * This also handles subview script tags, if options.is_sub_view is true.\n\t * @param options\n\t * @returns {string}\n\t */\n\tgetGenericListViewHtml( options = {} ) {\n\t\tDebug.Text( 'HTML2JS: Template retrieved for ' + options.view_id, 'HtmlTemplates.js', 'HtmlTemplates.js', 'getGenericListViewHtml', 10 );\n\t\t// Prepend the <script> tag to the html template, so it can be executed when inserted into the DOM later on in the onResult.\n\t\treturn this.getViewScriptTagHtml( options ) + HtmlTemplatesGlobal.genericListView( options );\n\t}\n\n\tgetViewScriptTagHtml( options = {} ) {\n\n\t\t/*\n\t\t* Note: In the legacy html load, the view controller would get instantiated via the <script> tag at the top of the html file, when this got loaded into the DOM.\n\t\t* This would have happened in the onResult() function, one of such is BaseViewController.loadView -> doNext().\n\t\t* Rather than insert a check there to trigger the view controller, or prepend the script tag, we can also try to just do that AFTER the onResult.\n\t\t* We should not do it before, as there is still cleanup code run by IndexController.removeCurrentView\n\t\t*\n\t\t* However, for now currently the best option is to pre-append the script tag info, because the onResult function won't always be from BaseViewController.loadView\n\t\t* */\n\n\t\tlet class_name = options.view_id + 'ViewController';\n\t\tlet html_view_script_tag = `<!-- JS2HTML ${this.outputif( options.is_sub_view, 'SUB_VIEW ' )}--><script type=\"text/javascript\">\n\t\t\t\t\t\t\t\t\t\t\t\tvar ${this.outputif( options.is_sub_view, 'sub_' )}${this.convertPascalCase2SnakeCase( options.view_id )}_view_controller = new ${class_name}(${this.outputOptions( [\n\t\t\t{ option: options.is_sub_view, html: 'sub_view_mode: true' },\n\t\t\t{ option: options.do_not_cache_controller, html: 'can_cache_controller: false' },\n\t\t] )});\n\t\t\t\t\t\t\t\t\t\t\t</script>`;\n\n\t\t// Prepend the <script> tag to the html template, so it can be executed when inserted into the DOM later on in the onResult.\n\t\t// html_template = html_view_script_tag + html_template;\n\t\t//\n\t\t// debugger; // A good debug point when you get errors around view controller instances not defined. But could also mean parent controller needs manual html insertion into the tab_model, as the subview doesnt have the right columns in the generic template, thus the container (to which the html initializing the controller) is attached, does not exist.\n\t\treturn html_view_script_tag;\n\t}\n\n\tgenericListView( options = {} ) {\n\n\t\t// Prepare the required data for the html template\n\t\tlet container_id = this.convertPascalCase2SnakeCase( options.view_id ) + '_view_container'; // E.g. branch_view_container. all lowercase separated by _ (Later in code, an id is added at the end of the string, like '_318') - Fix: [A-Z][a-z] is needed to not split on all caps like ROEView. But this wont handle single caps at the end though. // Also in most view.el\n\t\tlet container_class = this.convertPascalCase2KebabCase( options.view_id ) + '-view'; // E.g. branch-view. all lowercase separated by -\n\t\tlet view_template = `\n\t\t\t<div class=\"view js-generic-list-view ${this.outputif( container_class )}${this.outputif( options.is_sub_view, ' sub-view' )}\" id=\"${this.outputif( container_id )}\">\n\t\t\t\t${this.outputif( options.sub_view_warning_message, '<span class=\"warning-message\"></span>' )}\n\t\t\t\t<div class=\"clear-both-div\"></div>\n\t\t\t\t${this.genericListGrid( options )}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn view_template;\n\t}\n\n\tgenericListGrid( options = {} ) {\n\t\t// let sub_view = options.is_sub_view;\n\t\tlet grid_template = `\n\t\t<div class=\"grid-div js-generic-grid\">\n\t\t\t${this.outputif( !options.is_sub_view && !options.base_tree_view, '<div class=\"total-number-div\"><span class=\"total-number-span\"></span></div>' )}\n\t\t\t<div class=\"grid-top-border\"></div>\n\n\t\t\t${this.outputif( options.is_sub_view, '<div class=\"sub-grid-view-div\">' )}\n\t\t\t\t<table id=\"grid\"></table>\n\t\t\t${this.outputif( options.is_sub_view, '</div>' )}\n\n\t\t\t<div class=\"bottom-div\">\n\t\t\t\t<div class=\"grid-bottom-border\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`;\n\n\t\treturn grid_template;\n\t}\n\n\tgenericEditView( options = {} ) {\n\t\t// Currently just for User Title Edit.\n\t\t// viewId: UserTitle\n\t\t// fileName: UserTitleEditView.html\n\t\t// Prepare the required data for the html template\n\t\tlet tab_bar_id = this.convertPascalCase2SnakeCase( options.view_id ) + '_edit_view_tab_bar'; // e.g. user_title_edit_view_tab_bar - all lowercase separated by _ - Fix: [A-Z][a-z] is needed to not split on all caps like ROEView. But this wont handle single caps at the end though.\n\t\tlet edit_view_class = options.view_id + 'EditView'; // e.g. UserTitleEditView\n\t\tlet edit_view_template = `\n\t\t\t<div class=\"js-generic-edit-view edit-view ${this.outputif( edit_view_class )}\">\n\t\t\t\t<div class=\"edit-view-tab-bar\" id=\"${this.outputif( tab_bar_id )}\">\n\t\t\t\t\t<div class=\"navigation-div\" style=\"display: none\">\n\t\t\t\t\t\t<span class=\"navigation-label\"></span>\n\t\t\t\t\t\t<img class=\"left-click arrow\"/>\n\t\t\t\t\t\t<div class=\"navigation-widget-div\"></div>\n\t\t\t\t\t\t<img class=\"right-click arrow\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span class=\"close-icon\">x</span>\n\t\t\t\t\t<ul class=\"edit-view-tab-bar-label\"></ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn edit_view_template;\n\t}\n\n\tgenericTab( options = {} ) {\n\t\tlet is_multi_column = options.is_multi_column;\n\t\tlet show_permission_div = options.show_permission_div;\n\t\tlet is_sub = options.is_sub_view || false;\n\t\tlet tab_id = options.tab_id;\n\n\t\tlet save_continue_sub_view = `\n\t\t\t<div class=\"save-and-continue-div\">\n\t\t\t\t<span class=\"message\"></span>\n\t\t\t\t<div class=\"save-and-continue-button-div\">\n\t\t\t\t\t<button class=\"tt-button p-button p-component\" type=\"button\">\n\t\t\t\t\t\t<span class=\"icon\"></span>\n\t\t\t\t\t\t<span class=\"p-button-label\"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\tlet permission_div = `\n\t\t\t\t<div class=\"save-and-continue-div permission-defined-div\">\n\t\t\t\t\t<span class=\"message permission-message\"></span>\n\t\t\t\t</div>`;\n\t\tlet template = `\n\t\t\t<div id=\"${tab_id}\" class=\"html2js_flag edit-view-tab-outside${this.outputif( is_sub, '-sub-view' )}\">\n\t\t\t\t<div class=\"edit-view-tab\" id=\"${tab_id}_content_div\">\n\t\t\t\t\t<div class=\"first-column${this.outputif( is_sub, '-sub-view' )}${this.outputif( !is_multi_column, ' full-width-column' )}\"></div>\n\t\t\t\t\t${this.outputif( is_multi_column, '<div class=\"second-column\"></div>' )}\n\n\t\t\t\t\t${this.outputif( is_sub, save_continue_sub_view )}\n\t\t\t\t\t${this.outputif( show_permission_div, permission_div )}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn template;\n\t}\n\n\tauditTab( options = {} ) {\n\t\tlet template = `\n\t\t\t<div id=\"tab_audit\" class=\"html2js_flag_audit edit-view-tab-outside-sub-view\">\n\t\t\t\t<div class=\"edit-view-tab\" id=\"tab_audit_content_div\">\n\t\t\t\t\t<div class=\"first-column-sub-view\"></div>\n\t\t\t\t\t<div class=\"save-and-continue-div\">\n\t\t\t\t\t\t<span class=\"message\"></span>\n\t\t\t\t\t\t<div class=\"save-and-continue-button-div\">\n\t\t\t\t\t\t\t<button class=\"tt-button p-button p-component\" type=\"button\">\n\t\t\t\t\t\t\t\t<span class=\"icon\"></span>\n\t\t\t\t\t\t\t\t<span class=\"p-button-label\"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn template;\n\t}\n\n\tgenericReportEditView( options = {} ) {\n\t\t// Some examples of the differences. Interestingly, all checked templates so far all had the main div class set to active-shift-report-view.\n\t\t// ActiveShiftReportView.html : view_id=ActiveShiftReport : id=active_shift_report_view_tab_bar\n\t\t// UserSummaryReportView.html : id=user_summary_report_view_tab_bar\n\t\t// PayStubTransactionSummaryReportView.html : id=pay_stub_summary_report_view_tab_bar\n\n\t\tlet tab_bar_id = this.convertPascalCase2SnakeCase( options.view_id ) + '_view_tab_bar';\n\t\tlet edit_view_template = `\n\t\t\t<div class=\"js-generic-report-edit-view edit-view active-shift-report-view\">\n\t\t\t\t<div class=\"edit-view-tab-bar\" id=\"${this.outputif( tab_bar_id )}\">\n\t\t\t\t\t<div class=\"navigation-div\" style=\"display: none\">\n\t\t\t\t\t\t<span class=\"navigation-label\"></span>\n\t\t\t\t\t\t<img class=\"left-click arrow\"/>\n\t\t\t\t\t\t<div class=\"navigation-widget-div\"></div>\n\t\t\t\t\t\t<img class=\"right-click arrow\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span class=\"close-icon\">x</span>\n\t\t\t\t\t<ul class=\"edit-view-tab-bar-label\">\n\t\t\t\t\t\t<li><a ref=\"tab_report\" href=\"#tab_report\"></a></li>\n\t\t\t\t\t\t<li><a ref=\"tab_setup\" href=\"#tab_setup\"></a></li>\n\t\t\t\t\t\t<li><a ref=\"tab_chart\" href=\"#tab_chart\"></a></li>\n\t\t\t\t\t\t${this.outputif( options.report_form_setup || ( options.view_id && options.view_id === 'PayrollExportReport' ), '<li><a ref=\"tab_form_setup\" href=\"#tab_form_setup\"></a></li>' )}\n\t\t\t\t\t\t<li><a ref=\"tab_custom_columns\" href=\"#tab_custom_columns\"></a></li>\n\t\t\t\t\t\t<li><a ref=\"tab_saved_reports\" href=\"#tab_saved_reports\"></a></li>\n\t\t\t\t\t</ul>\n\t\t\t\t\t<div id=\"tab_report\" class=\"edit-view-tab-outside\">\n\t\t\t\t\t\t<div class=\"edit-view-tab\" id=\"tab_report_content_div\">\n\t\t\t\t\t\t\t<div class=\"first-column full-width-column\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id=\"tab_setup\" class=\"edit-view-tab-outside\">\n\t\t\t\t\t\t<div class=\"edit-view-tab\" id=\"tab_setup_content_div\">\n\t\t\t\t\t\t\t<div class=\"first-column full-width-column\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id=\"tab_chart\" class=\"edit-view-tab-outside\">\n\t\t\t\t\t\t<div class=\"edit-view-tab\" id=\"tab_chart_content_div\">\n\t\t\t\t\t\t\t<div class=\"first-column full-width-column\"></div>\n\t\t\t\t\t\t\t<div class=\"save-and-continue-div permission-defined-div\">\n\t\t\t\t\t\t\t\t<span class=\"message permission-message\"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.outputif( options.report_form_setup, `\n\t\t\t\t\t\t<div id=\"tab_form_setup\" class=\"edit-view-tab-outside\">\n\t\t\t\t\t\t\t<div class=\"edit-view-tab\" id=\"tab_form_setup_content_div\">\n\t\t\t\t\t\t\t\t<div class=\"first-column full-width-column\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>`\n\t\t\t\t\t)}\n\t\t\t\t\t${this.outputif( options.view_id && options.view_id === 'PayrollExportReport', `\n\t\t\t\t\t\t<div id=\"tab_form_setup\" class=\"edit-view-tab-outside\">\n\t\t\t\t\t\t\t<div class=\"edit-view-tab\" id=\"tab_form_setup_content_div\">\n\t\t\t\t\t\t\t\t<div class=\"first-row first-column full-width-column\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"inside-editor-div full-width-column\">\n\t\t\t\t\t\t\t\t\t<div class=\"grid-div\">\n\t\t\t\t\t\t\t\t\t\t<table id=\"export_grid\"></table>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>`\n\t\t\t\t\t)}\n\t\t\t\t\t<div id=\"tab_custom_columns\" class=\"edit-view-tab-outside-sub-view\">\n\t\t\t\t\t\t<div class=\"edit-view-tab\" id=\"tab_custom_columns_content_div\">\n\t\t\t\t\t\t\t<div class=\"first-column-sub-view\"></div>\n\t\t\t\t\t\t\t<div class=\"save-and-continue-div\">\n\t\t\t\t\t\t\t\t<span class=\"message\"></span>\n\t\t\t\t\t\t\t\t<div class=\"save-and-continue-button-div\">\n\t\t\t\t\t\t\t\t\t<button class=\"tt-button p-button p-component\" type=\"button\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"icon\"></span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"p-button-label\"></span>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"save-and-continue-div permission-defined-div\">\n\t\t\t\t\t\t\t\t<span class=\"message permission-message\"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id=\"tab_saved_reports\" class=\"edit-view-tab-outside-sub-view\">\n\t\t\t\t\t\t<div class=\"edit-view-tab\" id=\"tab_saved_reports_content_div\">\n\t\t\t\t\t\t\t<div class=\"first-column-sub-view\"></div>\n\t\t\t\t\t\t\t<div class=\"save-and-continue-div\">\n\t\t\t\t\t\t\t\t<span class=\"message\"></span>\n\t\t\t\t\t\t\t\t<div class=\"save-and-continue-button-div\">\n\t\t\t\t\t\t\t\t\t<button class=\"tt-button p-button p-component\" type=\"button\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"icon\"></span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"p-button-label\"></span>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn edit_view_template;\n\t}\n\n\n\n\n\t// This might still work, but put on hold as we chose to focus on the list, edit and sub views and tabs\n\t// getEditViewFormItem( options = {} ) {\n\t// \tlet sub_view = options.is_sub_view || false;\n\t// \tlet template = `\n\t// \t<div class=\"edit-view-form-item-div\">\n\t// \t\t<div class=\"edit-view-form-item-${ sub_view ? 'sub-' : ''}label-div\"><span class=\"edit-view-form-item-label\"></span></div>\n\t// \t\t<div class=\"edit-view-form-item-input-div\"></div>\n\t// \t</div>\n\t// `;\n\t//\n\t// \treturn template;\n\t// }\n}\n\n/**\n *\n * @type {Readonly<{string, symbol}>}\n */\nconst TemplateType = Object.freeze( {\n\tLIST_VIEW: Symbol( 'LIST_VIEW'),\n\tSUB_VIEW: Symbol( 'SUB_VIEW'),\n\tEDIT_VIEW: Symbol( 'EDIT_VIEW'),\n\tREPORT_VIEW: Symbol( 'REPORT_VIEW'),\n\tINLINE_HTML: Symbol( 'INLINE_HTML'),\n\tLEGACY_HTML: Symbol( 'LEGACY_HTML'),\n} );\n\nconst HtmlTemplatesGlobal = new HtmlTemplates();\nwindow.TT_HTML_G = HtmlTemplatesGlobal; // TODO: Temp for dev, remove after all done.\nexport {\n\tHtmlTemplatesGlobal,\n\t// HtmlTemplates as HtmlTemplatesClass, // Not yet used as we are sharing the one global instance across scripts at the moment.\n\tTemplateType,\n};","/*\n * This file houses any common utils that will be used by Vue.\n * Similar to Global.js but class based, and Vue specific.\n */\n\n\nimport { createApp } from 'vue';\nimport main_ui_router from '@/components/main_ui_router';\nimport PrimeVue from 'primevue/config';\nimport Tooltip from 'primevue/tooltip';\n\nclass TTVueUtils {\n\tconstructor() {\n\t\tthis._dynamic_vue_components = {};\n\t}\n\n\tmountComponent( mount_id, mount_component, root_props ) {\n\t\tif( mount_id === undefined ) {\n\t\t\tDebug.Error( 'Error: Invalid parameters passed to function.', 'TTVueUtils.js', 'TTVueUtils', 'mountComponent', 1 );\n\t\t\treturn false;\n\t\t}\n\n\t\tif( document.getElementById( mount_id ) === null ) {\n\t\t\tDebug.Error( 'Error: mount_id \"'+ mount_id + '\" does not exist in the DOM.', 'TTVueUtils.js', 'TTVueUtils', 'mountComponent', 1 );\n\t\t\treturn false;\n\t\t}\n\n\t\tif( this._dynamic_vue_components[ mount_id ] !== undefined ) {\n\t\t\tDebug.Error( 'Error: component ('+ mount_id +') already exists and mounted.', 'TTVueUtils.js', 'TTVueUtils', 'mountComponent', 1 );\n\t\t\treturn false;\n\t\t}\n\n\t\troot_props = root_props || {};\n\t\troot_props.component_id = root_props.component_id || mount_id;\n\t\tlet mount_reference = '#' + mount_id;\n\t\tlet vue_app_instance = createApp( mount_component, root_props ); // rootProps is useful to pass in data without the need for EventBus.\n\n\t\tvue_app_instance.use( PrimeVue, { ripple: true, inputStyle: 'filled' }); // From: AppConfig.vue this.$primevue.config.inputStyle value is filled/outlined as we dont use AppConfig in TT.\n\t\tvue_app_instance.use( main_ui_router ); // #VueContextMenu# FIXES: Failed to resolve component: router-link when TTOverlayMenuButton is opened. Because each component is a separate Vue instance, and they did not globally 'use' the Router, only in main ui.\n\t\tvue_app_instance.directive('tooltip', Tooltip);\n\n\t\tlet vue_component_instance = vue_app_instance.mount( mount_reference ); // e.g. '#tt-edit-view-test'\n\n\t\tthis._dynamic_vue_components[ mount_id ] = {\n\t\t\tmount_id: mount_id,\n\t\t\t_vue_app_instance: vue_app_instance, // Be very careful using these from outside Vue. Could make for messy code!\n\t\t\t_vue_component_instance: vue_component_instance // Be very careful using these from outside Vue. Could make for messy code!\n\t\t};\n\n\t\treturn this._dynamic_vue_components[ mount_id ];\n\t}\n\tunmountComponent ( mount_id ) {\n\t\tif( this._dynamic_vue_components[ mount_id ] && this._dynamic_vue_components[ mount_id ]._vue_component_instance ) {\n\t\t\tthis._dynamic_vue_components[ mount_id ]._vue_app_instance.unmount();\n\t\t\tdelete this._dynamic_vue_components[ mount_id ];\n\t\t\tDebug.Text( 'Component successfully unmounted ('+ mount_id +').', 'TTVueUtils.js', 'TTVueUtils', 'unmountComponent', 2 );\n\t\t\treturn true;\n\t\t} else {\n\t\t\tDebug.Text( 'Unable to unmount component. Component not found ('+ mount_id +'). Maybe already removed?', 'TTVueUtils.js', 'TTVueUtils', 'unmountComponent', 2 );\n\t\t\treturn false;\n\t\t}\n\t}\n\n}\n\nexport default new TTVueUtils() // Export this way to share one instance of the class across the app.","export default \"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20fill='%2332689b'%20class='bi%20bi-bell'%20viewBox='0%200%2016%2016'%3e%3cpath%20d='M8%2016a2%202%200%200%200%202-2H6a2%202%200%200%200%202%202zM8%201.918l-.797.161A4.002%204.002%200%200%200%204%206c0%20.628-.134%202.197-.459%203.742-.16.767-.376%201.566-.663%202.258h10.244c-.287-.692-.502-1.49-.663-2.258C12.134%208.197%2012%206.628%2012%206a4.002%204.002%200%200%200-3.203-3.92L8%201.917zM14.22%2012c.223.447.481.801.78%201H1c.299-.199.557-.553.78-1C2.68%2010.2%203%206.88%203%206c0-2.42%201.72-4.44%204.005-4.901a1%201%200%201%201%201.99%200A5.002%205.002%200%200%201%2013%206c0%20.88.32%204.2%201.22%206z'/%3e%3c/svg%3e\"","<template>\n    <div class=\"mfa-modal\">\n        <div class=\"mfa-modal-content\">\n            <span @click=\"closeModal\" class=\"mfa-modal-close\"></span><img class=\"mfa-modal-image\" :src=\"bell_img\">\n            <h2 class=\"mfa-modal-title\">{{ labels.title }}</h2>\n            <p v-show=\"this.step != 'password'\" class=\"mfa-modal-body\">{{ labels.body }}</p>\n            <ProgressSpinner v-if=\"show_spinner\" style=\"width:50px;height:50px\" strokeWidth=\"5\" animationDuration=\"2s\"/>\n            <form @submit=\"onFormSubmit\" class=\"form-container\" id=\"login-form\">\n                <div v-show=\"this.step === 'password'\" class=\"p-float-label password-container\">\n                    <h5 class=\"password-label\">{{ labels.current_password }}</h5>\n                    <Password id=\"password-input\" :placeholder=\"labels.password\" v-model=\"user_password\" ref=\"password_input\" :feedback=\"false\" toggleMask></Password>\n                </div>\n                <div v-show=\"show_trusted_device_checkbox\" class=\"checkbox-container\">\n                    <Checkbox inputId=\"remember-me\" @change=\"toggleTrustedDevice\" v-model=\"enable_trusted_device\" :binary=\"true\"/>\n                    <label class=\"checkbox-center\" for=\"remember-me\">{{ labels.remember_me }}</label>\n                </div>\n                <button type=\"submit\" id=\"mfa-submit-button\" class=\"mfa-modal-button\" :class=\"{ 'resend-button': this.step === 'start_listen' }\" @click=\"onFormSubmit\">{{ button_text }}</button>\n            </form>\n        </div>\n    </div>\n</template>\n<script>\nimport InputText from 'primevue/inputtext';\nimport Checkbox from 'primevue/checkbox';\nimport { Global } from '@/global/Global';\nimport TTVueUtils from '@/services/TTVueUtils';\nimport ProgressSpinner from 'primevue/progressspinner';\nimport Password from 'primevue/password';\nimport bell_img from \"@/theme/default/images/bell_permissions.svg\";\n\nexport default {\n    created() {\n        this.event_bus = new TTEventBus( {\n            component_id: this.component_id,\n        } );\n    },\n    mounted() {\n        this.onMFAStepChange();\n    },\n    props: { // passed in via root props when component is mounted\n        view_id: {\n            type: String,\n            default: null\n        },\n        component_id: { /* Note: This is passed in via TTVueUtils.mountComponent param, and auto added to root_props. */\n            type: String,\n            default: null\n        },\n        session_type: {\n            type: String,\n            default: 'user_name'\n        },\n        user_name: {\n            type: String,\n            default: ''\n        },\n        mfa_data: {\n            type: Object,\n            default: {}\n        },\n        authenticate_callback: {\n            type: Function,\n            default: null\n        },\n        is_reauthentication: {\n            type: Boolean,\n            default: false\n        },\n    },\n    data() {\n        return {\n            doing_login: false,\n            show_spinner: false,\n            resending_notification: false,\n            step: this.mfa_data.step,\n            type_id: this.mfa_data.type_id,\n            user_password: '',\n            authentication_api: TTAPI.APIAuthentication,\n            enable_trusted_device: getCookie( 'TrustedDevice' ) !== '', //If cookie is set, default checkbox to true.\n            bell_img: bell_img,\n            labels: {\n                title: $.i18n._( 'Authentication Required' ),\n                body: this.mfa_data.user_action_message,\n                password: $.i18n._( 'Password' ),\n                current_password: $.i18n._( 'Current Password' ),\n                remember_me: $.i18n._( 'This is a trusted device. Remember Me' ),\n            }\n        };\n    },\n    computed: {\n        button_text() {\n            if ( this.resending_notification === true ) {\n                return $.i18n._( 'Resending...' );\n            } else if ( this.step === 'password' ) {\n                return $.i18n._( 'Confirm Password' );\n            } else if ( this.step === 'start_listen' ) {\n                return $.i18n._( 'Resend' );\n            } else if ( this.step === 'saml' ) {\n                return $.i18n._( 'Verify' );\n            }\n        },\n        show_trusted_device_checkbox() {\n            //If cookie is set, don't show checkbox. Also only show during login and not re-authentication.\n            return getCookie( 'TrustedDevice' ) === '' && ( this.step === 'password' || this.step === 'start_listen' ) && this.is_reauthentication === false;\n        }\n    },\n    methods: {\n        onMFAStepChange() {\n            switch ( this.step ) {\n                case 'saml':\n                case 'password':\n                    break;\n                case 'start_listen':\n                    this.doMultiFactorAuthentication();\n                    break;\n                case 'login':\n                    this.login();\n                    break;\n            }\n        },\n        setMFAStep( step ) {\n            this.step = step;\n            setTimeout( () => {\n                //Timeout so that Vue triggers and udates form layout before we interact with the form.\n                this.onMFAStepChange();\n            }, 100 );\n        },\n        onFormSubmit( event ) {\n            event.preventDefault();\n\n            switch ( this.step ) {\n                case 'saml':\n                    TTSAML.loginUser( this.user_name, this.mfa_data.redirect_url, true );\n                    this.startSAMLListen();\n                    break;\n                case 'password':\n                    this.login();\n                    break;\n                case 'start_listen': //Resend\n                    this.sendMultiFactorNotification();\n                    let submit_button = document.querySelector( '#mfa-submit-button' );\n                    submit_button.disabled = true;\n                    this.resending_notification = true;\n                    setTimeout( () => {\n                        submit_button.disabled = false;\n                        this.resending_notification = false;\n                    }, 3000 );\n                    break;\n            }\n        },\n        toggleTrustedDevice() {\n            //Cancels the server listen loop and immediately restarts with $enable_trusted_device set to the users choice.\n            //This simplifies the process of notifying the server that the user wants to use a trusted device during an otherwise long running loop.\n            this.authentication_api.validateMultiFactor( false, LocalCacheData.getSessionID(), '', { restart_listen: true }, {\n                onResult: ( res ) => {\n                    //We are not doing anything with this result.\n                }\n            } );\n        },\n        sendMultiFactorNotification() {\n            this.authentication_api.sendMultiFactorNotification( {\n                onResult: ( res ) => {\n                    //We are not doing anything with this result.\n                }\n            } );\n        },\n        startMultiFactorListen( repeat_count ) {\n            let api_endpoint = 'listenForMultiFactorAuthentication';\n\n            if ( this.type_id >= 1000 ) {\n                api_endpoint = 'listenForReauthentication';\n            }\n            this.authentication_api[api_endpoint]( this.enable_trusted_device, {\n                onResult: ( response ) => {\n                    if ( response.isValid() ) {\n                        let result = response.getResult();\n                        if ( result.status === 'completed' ) {\n                            this.closeModal();\n                            this.authenticate_callback( true );\n                        } else if ( result.status === 'restart_listen' ) {\n                            this.restartListen( repeat_count );\n                        } else if ( result.status === 'cancelled' ) {\n                            this.closeModal();\n                            TAlertManager.showAlert( $.i18n._( 'Multifactor authentication has been cancelled. Please try again.', $.i18n._( 'Multifactor Authentication Cancelled' ) ) );\n                        }\n                    } else {\n                        this.closeModal();\n                    }\n                },\n                onError: ( err ) => {\n                    this.closeModal();\n                }\n            } );\n        },\n        restartListen( repeat_count ) {\n            if ( repeat_count < 12 ) {\n                this.startMultiFactorListen( repeat_count + 1 );\n            } else {\n                this.closeModal();\n                TAlertManager.showAlert( $.i18n._( 'Multifactor authentication timed out. Please try again.', $.i18n._( 'Multifactor Authentication Timed Out' ) ) );\n            }\n        },\n        doMultiFactorAuthentication() {\n            this.show_spinner = true;\n            this.sendMultiFactorNotification();\n            this.startMultiFactorListen( 1 );\n\n            ProgressBar.removeProgressBar();\n        },\n        startSAMLListen() {\n            this.show_spinner = true;\n            this.startMultiFactorListen( 1 );\n\n            ProgressBar.removeProgressBar();\n        },\n        cancelMultiFactorListen() {\n            if ( Array.isArray( $.xhrPool ) ) {\n                for ( let i = 0; i < $.xhrPool.length; i++ ) {\n                    if ( $.xhrPool[i].url.includes( 'listenForMultiFactorAuthentication' ) ) {\n                        $.xhrPool[i].jqXHR.abort();\n                    }\n                }\n            }\n        },\n        closeModal() {\n            this.event_bus.emit( 'tt_login', 'user_closed_mfa_modal', {\n                status: true\n            } );\n            this.show_spinner = false;\n            this.cancelMultiFactorListen();\n            TTVueUtils.unmountComponent( this.component_id );\n        },\n        login() {\n            if ( this.doing_login == true ) {\n                return;\n            }\n\n            this.doing_login = true;\n\n            let login_session_type = this.session_type;\n            //Force session type MFA. This is required for initial MFA setup and upgrading normal sessions to MFA sessions.\n            if ( this.session_type != 'user_name_multifactor' && this.type_id > 0 ) {\n                login_session_type = 'user_name_multifactor';\n            }\n\n            Global.login( this.user_name, this.user_password, login_session_type, this.is_reauthentication, ( res ) => {\n                this.doing_login = false;\n\n                if ( res.isValid() ) {\n                    let result = res.getResult();\n\n                    if ( this.type_id == 0 ) { //0 = Password (Not MFA)\n                        this.doing_login = false;\n                        this.authenticate_callback( true );\n                    } else if ( this.type_id == 10 && result.mfa.step == 'start_listen' ) { // 10 = MFA App\n                        this.setMFAStep( 'start_listen' );\n                    }\n                }\n            } );\n        },\n    },\n    components: {\n        InputText,\n        Checkbox,\n        ProgressSpinner,\n        Password\n    }\n};\n</script>\n<style scoped>\n.checkbox-container {\n    display: table;\n    margin-top: 0.25rem;\n}\n\n.checkbox-container .checkbox-center {\n    display: table-cell;\n    vertical-align: middle;\n}\n\n.mfa-modal {\n    background: rgba(0, 0, 0, .6);\n    position: fixed;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    z-index: 1000;\n}\n\n.mfa-modal-content {\n    background-color: #f8f8f8;\n    height: 30rem;\n    width: 26rem;\n    position: fixed;\n    top: 50%;\n    left: 50%;\n    margin-top: -15rem;\n    margin-left: -13rem;\n    box-shadow: 5px 5px 8px 0px rgba(0, 0, 0, 0.3), 0 0 60px 5px rgba(0, 0, 0, 0.38);\n}\n\n.mfa-modal-close {\n    font-size: 1.5rem;\n    position: absolute;\n    right: 0;\n    margin: .75rem;\n    cursor: pointer\n}\n\n.mfa-modal-button {\n    background: #426d9d;\n    border: 0px solid #a1a3a6;\n    color: #ffffff;\n    width: 17rem;\n    font-size: 1.15rem;\n    border-radius: 4px;\n    margin-bottom: 1rem;\n    height: 3.25rem;\n    position: absolute;\n    left: 4.5rem;\n    bottom: .5rem;\n    text-decoration: none;\n    font-weight: 1000;\n}\n\n.mfa-modal-image {\n    display: block;\n    margin: 25px auto 15px auto;\n    width: 80px;\n    height: 80px;\n}\n\n.mfa-modal-title {\n    text-align: center;\n    font-weight: 1000;\n}\n\n.mfa-modal-body {\n    text-align: center;\n    height: 5rem;\n    display: -webkit-flex;\n    display: flex;\n    align-items: center;\n    padding-left: 3rem;\n    padding-right: 3rem;\n    font-size: 1.2rem;\n}\n\n.form-container .password-container {\n    position: absolute;\n    top: 55%;\n    width: 100%;\n    left: 4.5rem;\n    width: 17rem;\n}\n\n.form-container .checkbox-container {\n    position: absolute;\n    width: 100%;\n    bottom: 6.5rem;\n    left: 4.5rem;\n}\n\n.resend-button {\n    background: #ffffff;\n    color: #000000;\n    border: 1px solid #000000;\n}\n\n.password-label {\n    margin: 0 0 1px 0;\n    font-size: 1rem;\n    font-weight: lighter;\n}\n\n::v-deep(.mfa-modal-content .p-password input) {\n    width: 17rem;\n}\n\n::v-deep(.p-progress-spinner-circle) {\n    animation: p-progress-spinner-dash 1.5s ease-in-out infinite, custom-progress-spinner-color 6s ease-in-out infinite;\n}\n\n@keyframes custom-progress-spinner-color {\n    100%,\n    0% {\n        stroke: #000000;\n    }\n    40% {\n        stroke: #000000;\n    }\n    66% {\n        stroke: #000000;\n    }\n    80%,\n    90% {\n        stroke: #000000;\n    }\n}\n\n::v-deep(.p-progress-spinner-svg) {\n    width: 50px;\n    height: 50px;\n    margin-bottom: 80px;\n}\n\n::v-deep(.p-progress-spinner) {\n    position: relative;\n    top: 16%;\n    left: 44%;\n}\n</style>","<template>\n    <div class=\"custom-agreement-modal\">\n        <div class=\"custom-agreement-modal-content\">\n            <span v-if=\"!this.require_input\" @click=\"closeModal\" class=\"custom-agreement-modal-close\"></span><img class=\"custom-agreement-modal-image\" :src=\"bell_img\">\n            <h2 class=\"custom-agreement-modal-title\">{{ labels.title }}</h2>\n            <form @submit=\"onFormSubmit\" class=\"form-container\" id=\"agreement-form\">\n                <div class=\"p-float-label agreement-container\">\n                    <div id=\"agreement-body\" v-html=\"labels.body\"></div>\n                    <h5 v-if=\"this.require_input\" class=\"agreement-label\">{{ agreement_phrase_hint }}</h5>\n                    <InputText v-if=\"this.require_input\" id=\"passwor`d-input\" autocomplete=\"off\" :placeholder=\"labels.agreement_phrase\" v-model=\"user_input_text\" ref=\"agreement_input\" :feedback=\"false\" toggleMask></InputText>\n                </div>\n                <button type=\"submit\" id=\"custom-agreement-submit-button\" ref=\"accept_button\" class=\"custom-agreement-modal-button\" @click=\"onFormSubmit\">{{ button_text }}</button>\n            </form>\n        </div>\n    </div>\n</template>\n<script>\nimport InputText from 'primevue/inputtext';\nimport Textarea from 'primevue/textarea';\nimport Checkbox from 'primevue/checkbox';\nimport { Global } from '@/global/Global';\nimport TTVueUtils from '@/services/TTVueUtils';\nimport ProgressSpinner from 'primevue/progressspinner';\nimport bell_img from \"@/theme/default/images/bell_permissions.svg\";\n\nexport default {\n    created() {\n        this.event_bus = new TTEventBus( {\n            component_id: this.component_id,\n        } );\n    },\n    mounted() {\n        this.onVerifyInput();\n    },\n    props: { // passed in via root props when component is mounted\n        view_id: {\n            type: String,\n            default: null\n        },\n        component_id: { /* Note: This is passed in via TTVueUtils.mountComponent param, and auto added to root_props. */\n            type: String,\n            default: null\n        },\n        session_type: {\n            type: String,\n            default: 'user_name'\n        },\n        user_name: {\n            type: String,\n            default: ''\n        },\n        custom_agreement_data: {\n            type: Object,\n            default: {}\n        },\n        authenticate_callback: {\n            type: Function,\n            default: null\n        },\n        is_reauthentication: {\n            type: Boolean,\n            default: false\n        },\n    },\n    data() {\n        return {\n            step: this.custom_agreement_data.step,\n            type_id: this.custom_agreement_data.type_id,\n            require_input: this.custom_agreement_data.require_input,\n            user_input_text: '',\n            bell_img: bell_img,\n            labels: {\n                title: this.custom_agreement_data.title,\n                body: this.custom_agreement_data.body ,\n                agreement_phrase : this.custom_agreement_data.agreement_phrase,\n            }\n        };\n    },\n    computed: {\n        button_text() {\n            if ( this.step === 'accept_terms' ) {\n                return $.i18n._( 'Continue' );\n            }\n\n            return $.i18n._( 'I agree' );\n        },\n        user_accepted() {\n            return !this.require_input || this.user_input_text === this.labels.agreement_phrase;\n        },\n        agreement_phrase_hint() {\n            return $.i18n.printf( 'Type \"%s\" below to continue.', [ this.labels.agreement_phrase ] );\n        }\n\n    },\n    watch: {\n        user_input_text() {\n            this.onVerifyInput();\n        }\n    },\n    methods: {\n        onVerifyInput() {\n            if ( this.user_accepted ) {\n                if ( this.require_input ) {\n                    this.$refs.agreement_input.$el.classList.remove( 'p-invalid' );\n                }\n                this.$refs.accept_button.disabled = false;\n                this.$refs.accept_button.style.backgroundColor = '#426d9d';\n                return true;\n            } else {\n                if ( this.require_input ) {\n                    this.$refs.agreement_input.$el.classList.add( 'p-invalid' );\n                }\n                this.$refs.accept_button.disabled = true;\n                this.$refs.accept_button.style.backgroundColor = '#a1a3a6';\n                return false;\n            }\n        },\n        onFormSubmit( event ) {\n            event.preventDefault();\n\n            switch ( this.step ) {\n                case 'accept_terms':\n                    if ( this.user_accepted ) {\n                        if ( this.authenticate_callback ) {\n                            this.authenticate_callback( true );\n                        }\n\n                        this.closeModal();\n                    }\n                    break;\n            }\n        },\n        closeModal() {\n            TTVueUtils.unmountComponent( this.component_id );\n        },\n    },\n    components: {\n        InputText,\n        Textarea,\n        Checkbox,\n        ProgressSpinner\n    }\n};\n</script>\n<style scoped>\n.custom-agreement-modal {\n    background: rgba(0, 0, 0, .6);\n    position: fixed;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    z-index: 1000;\n}\n\n.custom-agreement-modal-content {\n    background-color: #f8f8f8;\n    height: auto;\n    width: 26rem;\n    position: fixed;\n    top: 50%;\n    left: 50%;\n    margin-top: -15rem;\n    margin-left: -13rem;\n    box-shadow: 5px 5px 8px 0px rgba(0, 0, 0, 0.3), 0 0 60px 5px rgba(0, 0, 0, 0.38);\n}\n\n.custom-agreement-modal-close {\n    font-size: 1.5rem;\n    position: absolute;\n    right: 0;\n    margin: .75rem;\n    cursor: pointer\n}\n\n.custom-agreement-modal-button {\n    background: #426d9d;\n    border: 0px solid #a1a3a6;\n    color: #ffffff;\n    width: 17rem;\n    font-size: 1.15rem;\n    border-radius: 4px;\n    margin-bottom: 1rem;\n    height: 3.25rem;\n    margin-left: 4.5rem;\n    margin-top: 2rem;\n    text-decoration: none;\n    font-weight: 1000;\n}\n\n.custom-agreement-modal-image {\n    display: block;\n    margin: 25px auto 15px auto;\n    width: 80px;\n    height: 80px;\n}\n\n.custom-agreement-modal-title {\n    text-align: center;\n    font-weight: 1000;\n}\n\n.custom-agreement-modal-body {\n    text-align: center;\n    height: 5rem;\n    display: -webkit-flex;\n    display: flex;\n    align-items: center;\n    padding-left: 3rem;\n    padding-right: 3rem;\n    font-size: 1.2rem;\n}\n\n.form-container .agreement-container {\n    height: auto;\n    width: 100%;\n    left: 4.5rem;\n    width: 17rem;\n}\n\n.agreement-label {\n    margin: 1rem 0 1px 0;\n    font-size: 0.90rem;\n    font-weight: lighter;\n}\n\n::v-deep(.p-inputtextarea), ::v-deep(.p-inputtext) {\n    width: 100%;\n}\n</style>","// import { LocalCacheData } from 'exports-loader?exports=LocalCacheData!@/global/LocalCacheData';\nimport { TTUUID } from '@/global/TTUUID';\nimport { TTAPI } from '@/services/TimeTrexClientAPI';\nimport { FormItemType, WidgetNamesDic } from '@/global/widgets/search_panel/FormItemType'; // TODO: duplicated in merged js files.\nimport { RateLimit } from '@/global/RateLimit';\nimport '@/global/widgets/view_min_tab/ViewMinTabBar';\nimport { ServiceCaller } from '@/services/ServiceCaller';\nimport TTEventBus from '@/services/TTEventBus';\nimport { HtmlTemplatesGlobal, TemplateType } from '@/services/HtmlTemplates';\nimport TTVueUtils from '@/services/TTVueUtils';\nimport TTMultiFactorAuthentication from '@/components/login/TTMultiFactorAuthentication.vue';\nimport TTCustomAccept from '@/components/login/TTCustomAccept.vue';\nimport { Decimal } from 'decimal.js';\nimport moment from 'moment';\n// import { createApp } from 'vue'; // Currently only used by Global.initEditTest\n// import TTEditView from '@/components/TTEditView'; // Used by Global.initEditTest which is currently commented out as its for testing only.\n\n//Global variables and functions will be used everywhere\nexport var Global = function() {\n};\nGlobal.event_bus = new TTEventBus({ view_id: 'global' });\nGlobal.sortOrderRegex = /^-([0-9]{3,9})-/;\nGlobal.current_ping = -1;\n\nGlobal.UNIT_TEST_MODE = false;\n\nGlobal.app_min_width = 990;\n\nGlobal.theme = 'default';\n\n/**\n * UIReadyStatus:\n * 0 - Global.setUINotready() - the UI is not ready\n * 1 - Global.setUIReady() - the overlay is out of the way but ui is not done rendering\n * 2 - Global.setUIInitComplete() the overlay is done rendering\n */\nGlobal.UIReadyStatus = 0;\n\nGlobal.signal_timer = null;\n\nGlobal.isScrolledIntoView = function( elem ) {\n\tvar $elem = elem;\n\tvar $window = $( window );\n\tvar docViewTop = $window.scrollTop();\n\tvar docViewBottom = docViewTop + $window.height();\n\tif ( !$elem.offset() ) {\n\t\treturn true;\n\t}\n\tvar elemTop = $elem.offset().top;\n\t//var elemBottom = elemTop + $elem.height();\n\t//((elemBottom <= (docViewBottom + 200)) && (elemTop >= docViewTop));\n\treturn elemTop < docViewBottom;\n};\n\n//Check if the DOM (not jQuery) element requires a vertical scrollbar.\nGlobal.isVerticalScrollBarRequired = function( element ) {\n\treturn element && element.scrollHeight > element.clientHeight;\n};\n\n//Check if the DOM (not jQuery) element requires a horizontal scrollbar.\nGlobal.isHorizontalScrollBarRequired = function( element ) {\n\treturn element && element.scrollWidth > element.clientWidth;\n};\n\n//Gets the width of the browsers scrollbar. This value depends on the users OS/browser.\nGlobal.getScrollbarWidth = function() {\n\tif ( LocalCacheData.getScrollbarWidth() > 0 ) {\n        return LocalCacheData.getScrollbarWidth();\n    }\n\n\tlet scroll_div = document.createElement(\"div\");\n\tscroll_div.style.visibility = 'hidden';\n\tscroll_div.style.overflow = 'scroll';\n\tdocument.body.appendChild(scroll_div);\n\tlet scroll_bar_width = scroll_div.offsetWidth - scroll_div.clientWidth;\n\tdocument.body.removeChild(scroll_div);\n\n\t//If for some reason we cannot get the width, default the width to 17 which is most common value. (Windows\n\tif ( !scroll_bar_width ) {\n        scroll_bar_width = 17;\n    }\n\n\tLocalCacheData.setScrollBarWidth( scroll_bar_width );\n\n\treturn scroll_bar_width;\n}\n\n//Gets the height of the browsers scrollbar. This value depends on the users OS/browser.\nGlobal.getScrollbarHeight = function() {\n\tif ( LocalCacheData.getScrollbarHeight() > 0 ) {\n\t\treturn LocalCacheData.getScrollbarHeight();\n\t}\n\n\tlet scroll_div = document.createElement(\"div\");\n\tscroll_div.style.visibility = 'hidden';\n\tscroll_div.style.overflow = 'scroll';\n\tdocument.body.appendChild(scroll_div);\n\tlet scroll_bar_height = scroll_div.offsetHeight - scroll_div.clientHeight;\n\tdocument.body.removeChild(scroll_div);\n\n\t//If for some reason we cannot get the height, default the height to 17 which is most common value. (Windows\n\tif ( !scroll_bar_height ) {\n\t\tscroll_bar_height = 17;\n    }\n\n\tLocalCacheData.setScrollBarHeight( scroll_bar_height );\n\n\treturn scroll_bar_height;\n}\n\nGlobal.KEYCODES = {\n\t'48': '0',\n\t'49': '1',\n\t'50': '2',\n\t'51': '3',\n\t'52': '4',\n\t'53': '5',\n\t'54': '6',\n\t'55': '7',\n\t'56': '8',\n\t'59': '9',\n\t'65': 'a',\n\t'66': 'b',\n\t'67': 'c',\n\t'68': 'd',\n\t'69': 'e',\n\t'70': 'f',\n\t'71': 'g',\n\t'72': 'h',\n\t'73': 'i',\n\t'74': 'j',\n\t'75': 'k',\n\t'76': 'l',\n\t'77': 'm',\n\t'78': 'n',\n\t'79': 'o',\n\t'80': 'p',\n\t'81': 'q',\n\t'82': 'r',\n\t'83': 's',\n\t'84': 't',\n\t'85': 'u',\n\t'86': 'v',\n\t'87': 'w',\n\t'88': 'x',\n\t'89': 'y',\n\t'90': 'z'\n};\n\nGlobal.needReloadBrowser = false; // Need reload browser after set new cookie. To make router work for new session.\n\n// this attribute use to block UI in speical case that we allow users to click part of them and block other parts.\n// For example, when open edit view to block context menu.\nGlobal.block_ui = false;\n\nGlobal.sendErrorReport = function() {\n\tvar error_string = arguments[0];\n\tvar from_file = arguments[1];\n\tvar line = arguments[2];\n\tvar col = arguments[3];\n\tvar error_obj = arguments[4]; //Error object.\n\n\tRateLimit.setID( 'sendErrorReport' );\n\tRateLimit.setAllowedCalls( 6 );\n\tRateLimit.setTimeFrame( 7200 ); //2hrs\n\n\tif ( RateLimit.check() ) {\n\t\tvar captureScreenShot = function( error_msg, error_obj ) {\n\t\t\tif ( Global.isCanvasSupported() && typeof Promise !== 'undefined' ) { //HTML2Canvas requires promises, which IE11 does not have.\n\t\t\t\thtml2canvas( document.body ).then( function( canvas ) {\n\t\t\t\t\tvar image_string = canvas.toDataURL().split( ',' )[1];\n\t\t\t\t\tsourceMapStackTrace( error_msg, error_obj, image_string );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tsourceMapStackTrace( error_msg, error_obj, null );\n\t\t\t}\n\t\t};\n\n\t\tvar sourceMapStackTrace = function( error_msg, error_obj, image_string ) {\n\t\t\tif ( error_obj ) {\n\t\t\t\tvar stacktrace_callback = function( stackframes, error_msg, error_obj, image_string ) {\n\t\t\t\t\tvar stringified_stack = stackframes.map( function( sf ) {\n\t\t\t\t\t\treturn '  ' + sf.toString(); //Indent stack trace.\n\t\t\t\t\t} ).join( '\\n' );\n\n\t\t\t\t\terror_msg = error_msg + '\\n\\n\\n' + 'Stack Trace (Mapped): \\n' + error_obj.name + ': ' + error_obj.message + '\\n' + stringified_stack;\n\t\t\t\t\terror_msg = error_msg + '\\n\\n\\n' + 'Stack Trace (Raw): \\n' + error_obj.stack;\n\n\t\t\t\t\tsendErrorReport( error_msg, error_obj, image_string );\n\t\t\t\t};\n\n\t\t\t\tvar stacktrace_errback = function( error_msg, error_obj, image_string ) {\n\t\t\t\t\tconsole.error( 'ERROR: Unable to source map stack trace!' );\n\t\t\t\t\tsendErrorReport( error_msg, error_obj, image_string );\n\t\t\t\t};\n\n\t\t\t\tStackTrace.fromError( error_obj ).then( stackframes => stacktrace_callback( stackframes, error_msg, error_obj, image_string ) ).catch( error => stacktrace_errback( error_msg, error_obj, image_string ) );\n\t\t\t} else {\n\t\t\t\tsendErrorReport( error_msg, error_obj, image_string );\n\t\t\t}\n\t\t};\n\n\t\tvar sendErrorReport = function( error_msg, error_obj, image_string ) {\n\t\t\tDebug.Text( 'ERROR: ' + error_msg, 'Global.js', '', 'sendErrorReport', 1 );\n\n\t\t\tvar api_authentication = TTAPI.APIAuthentication;\n\t\t\tapi_authentication.sendErrorReport( error_msg, image_string, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\tif ( !Global.dont_check_browser_cache && APIGlobal.pre_login_data.production === true && result.getResult() !== APIGlobal.pre_login_data.application_build ) {\n\t\t\t\t\t\tresult = result.getResult();\n\t\t\t\t\t\tvar message = $.i18n._( 'Your web browser is caching incorrect data, please press the refresh button on your web browser or log out, clear your web browsers cache and try logging in again.' ) + '<br><br>' + $.i18n._( 'Local Version' ) + ':  ' + result + '<br>' + $.i18n._( 'Remote Version' ) + ': ' + APIGlobal.pre_login_data.application_build;\n\t\t\t\t\t\tGlobal.dont_check_browser_cache = true;\n\t\t\t\t\t\tGlobal.sendErrorReport( 'Your web browser is caching incorrect data. Local Version' + ':  ' + result + ' Remote Version' + ': ' + APIGlobal.pre_login_data.application_build, ServiceCaller.root_url, '', '', '' );\n\n\t\t\t\t\t\tvar timeout_handler = window.setTimeout( function() {\n\t\t\t\t\t\t\twindow.location.reload( true );\n\t\t\t\t\t\t}, 120000 );\n\n\t\t\t\t\t\tTAlertManager.showAlert( message, '', function() {\n\t\t\t\t\t\t\tLocalCacheData.loadedScriptNames = {};\n\t\t\t\t\t\t\tDebug.Text( 'Incorrect cache... Forcing reload after JS exception...', 'Global.js', 'Global', 'cachingIncorrectData', 10 );\n\t\t\t\t\t\t\twindow.clearTimeout( timeout_handler );\n\t\t\t\t\t\t\twindow.location.reload( true );\n\t\t\t\t\t\t} );\n\t\t\t\t\t} else if ( Global.dont_check_browser_cache ) {\n\t\t\t\t\t\tGlobal.dont_check_browser_cache = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t};\n\n\t\tvar login_user = LocalCacheData.getLoginUser();\n\n\t\t/*\n\t\t * JavaScript exception ignore list\n\t\t */\n\t\tif ( from_file && typeof from_file == 'string' && from_file.indexOf( 'extension://' ) >= 0 ) { //Error happened in some Chrome Extension, ignore.\n\t\t\tconsole.error( 'Ignoring javascript exception from browser extension outside of our control...' );\n\t\t\treturn;\n\t\t}\n\n\t\tif ( error_string.indexOf( 'Script error' ) >= 0 || //Script error. in:  line: 0 -- Likely browser extensions or errors from injected or outside javascript.\n\t\t\terror_string.indexOf( 'Unspecified error' ) >= 0 || //From IE: Unspecified error. in N/A line 1\n\t\t\terror_string.indexOf( 'TypeError: \\'null\\' is not an object' ) >= 0 ||\n\t\t\terror_string.indexOf( '_avast_submit' ) >= 0 || //Errors from anti-virus extension\n\t\t\terror_string.indexOf( 'ResizeObserver loop limit exceeded' ) >= 0 ||\n\t\t\terror_string.indexOf( 'ResizeObserver loop completed with undelivered notifications' ) >= 0 ||\n\t\t\terror_string.indexOf( 'googletag' ) >= 0 || //Errors from google tag extension -- Uncaught TypeError: Cannot redefine property: googletag\n\t\t\terror_string.indexOf( 'NS_ERROR_' ) >= 0 ||\n\t\t\terror_string.indexOf( 'NS_ERROR_OUT_OF_MEMORY' ) >= 0 ||\n\t\t\terror_string.indexOf( 'NPObject' ) >= 0 //Error calling method on NPObject - likely caused by an extension or plugin in the browser\n\t\t\t) {\n\t\t\tconsole.error( 'Ignoring javascript exception outside of our control...' );\n\t\t\treturn;\n\t\t}\n\n\t\tif ( Global.idle_time > 15 ) {\n\t\t\tDebug.Text( 'User inactive more than 15 mins, not sending error report.', 'Global.js', '', 'sendErrorReport', 1 );\n\t\t\tif ( typeof ( gtag ) !== 'undefined' && APIGlobal.pre_login_data.analytics_enabled === true ) {\n\t\t\t\tgtag( 'event', 'exception', {\n\t\t\t\t\t'exDescription': 'Session Idle: ' + error_string + ' File: ' + ( ( from_file ) ? from_file.replace( Global.getBaseURL(), '' ) : 'N/A' ) + ' Line: ' + line,\n\t\t\t\t\t'exFatal': false\n\t\t\t\t} )\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tvar error;\n\n\t\t//BUG#2066 - allow this function to be called earlier.\n\t\tvar script_name = '~unknown~';\n\t\tif ( Global.isSet( LocalCacheData ) && Global.isSet( LocalCacheData.current_open_primary_controller ) && Global.isSet( LocalCacheData.current_open_primary_controller.script_name ) ) {\n\t\t\tscript_name = LocalCacheData.current_open_primary_controller.script_name;\n\t\t}\n\n\t\tvar pre_login_data;\n\t\tif ( APIGlobal.pre_login_data ) {\n\t\t\tpre_login_data = APIGlobal.pre_login_data;\n\t\t} else {\n\t\t\tpre_login_data = null;\n\t\t}\n\n\t\tvar current_company_obj;\n\t\tif ( Global.isSet( LocalCacheData ) && LocalCacheData['current_company'] ) { //getCurrentCompany() which in turn calls getRequiredLocalCache(), which can call sendErroReport causing a loop. So try to prevent that by checking LocalCacheData['current_company'] first.\n\t\t\tcurrent_company_obj = LocalCacheData.getCurrentCompany();\n\t\t} else {\n\t\t\tcurrent_company_obj = null;\n\t\t}\n\n\t\tif ( login_user && Debug.varDump ) {\n\t\t\terror = 'Client Version: ' + APIGlobal.pre_login_data.application_build + '\\n\\nUncaught Error From: ' + script_name + '\\n\\nError: ' + error_string + ' in: ' + from_file + ' line: ' + line + ':' + col + '\\n\\nUser: ' + login_user.user_name + '\\n\\nURL: ' + window.location.href + '\\n\\nUser-Agent: ' + navigator.userAgent + ' ' + '\\n\\nCurrent Ping: ' + Global.current_ping + '\\n\\nIdle Time: ' + Global.idle_time + '\\n\\nSession ID Key: ' + LocalCacheData.getSessionID() + '\\n\\nCurrent User Object: \\n' + Debug.varDump( login_user ) + '\\n\\nCurrent Company Object: \\n' + Debug.varDump( current_company_obj ) + '\\n\\nPreLogin: \\n' + Debug.varDump( pre_login_data ) + ' ';\n\t\t} else {\n\t\t\terror = 'Client Version: ' + APIGlobal.pre_login_data.application_build + '\\n\\nUncaught Error From: ' + script_name + '\\n\\nError: ' + error_string + ' in: ' + from_file + ' line: ' + line + ':' + col + '\\n\\nUser: N/A' + '\\n\\nURL: ' + window.location.href + ' ' + '\\n\\nUser-Agent: ' + navigator.userAgent;\n\t\t}\n\n\t\tconsole.error( 'JAVASCRIPT EXCEPTION:\\n---------------------------------------------\\n' + error + '\\n---------------------------------------------' );\n\t\tdebugger;\n\n\t\t//When not in production mode, popup alert box anytime an exception appears so it can't be missed.\n\t\tif ( APIGlobal.pre_login_data.production !== true && APIGlobal.pre_login_data.demo_mode !== true && APIGlobal.pre_login_data.sandbox !== true ) {\n\t\t\talert( 'JAVASCRIPT EXCEPTION:\\n---------------------------------------------\\n' + error + '\\n---------------------------------------------' );\n\t\t}\n\n\t\tif ( typeof ( gtag ) !== 'undefined' && APIGlobal.pre_login_data.analytics_enabled === true ) {\n\t\t\t// Send an exception hit to Google Analytics. Must be 8192 bytes or smaller.\n\t\t\t// Strip the domain part off the URL on 'from_file' to better account for similar errors.\n\t\t\tgtag( 'event', 'exception', {\n\t\t\t\t'exDescription': error_string + ' File: ' + ( ( from_file ) ? from_file.replace( Global.getBaseURL(), '' ) : 'N/A' ) + ' Line: ' + line + ':' + col,\n\t\t\t\t'exFatal': false\n\t\t\t} )\n\t\t}\n\n\t\tif ( typeof ( clarity ) !== 'undefined' && APIGlobal.pre_login_data.analytics_enabled === true ) {\n\t\t\tclarity('set', 'exception', 'true' );\n\t\t\tclarity('set', 'userId', LocalCacheData?.getLoginUser()?.id );\n\t\t}\n\n\t\t//Don't send error report if exception not happens in our codes.\n\t\t//from_file should always contains the root url\n\t\t//If URL is not sent by IE, assume its our own code and report the error still.\n\t\t// Modern browsers won't send error reports from other domains due to security issues now, so I think this can be removed.\n\t\t// if ( from_file && from_file.indexOf( ServiceCaller.root_url ) < 0 ) {\n\t\t// \tDebug.Text( 'Exception caught from unauthorized source, not sending report. Source: \"' + ServiceCaller.root_url + '\" Script: ' + from_file, 'Global.js', '', 'sendErrorReport', 1 );\n\t\t// \treturn;\n\t\t// }\n\n\t\tif ( current_company_obj ) { //getCurrentCompany() which in turn calls getRequiredLocalCache(), which can call sendErroReport causing a loop. So try to prevent that by checking LocalCacheData['current_company'] first.\n\t\t\terror = error + '\\n\\n' + 'Product Edition: ' + current_company_obj.product_edition_id;\n\t\t}\n\n\t\terror = error + '\\n\\n\\n' + 'Clicked target stacks: ' + JSON.stringify( LocalCacheData.ui_click_stack, undefined, 2 );\n\t\terror = error + '\\n\\n\\n' + 'API stacks: ' + JSON.stringify( LocalCacheData.api_stack, undefined, 2 );\n\n\t\tcaptureScreenShot( error, error_obj );\n\t}\n};\n\nGlobal.initStaticStrings = function() {\n\tGlobal.network_lost_msg = $.i18n._( 'The network connection was lost. Please check your network connection then try again.' );\n\n\tGlobal.any_item = '-- ' + $.i18n._( 'Any' ) + ' --';\n\n\tGlobal.all_item = '-- ' + $.i18n._( 'All' ) + ' --';\n\n\tGlobal.root_item = $.i18n._( 'Root' );\n\n\tGlobal.loading_label = '...';\n\n\tGlobal.customize_item = '-- ' + $.i18n._( 'Customize' ) + ' --';\n\n\tGlobal.default_item = '-- ' + $.i18n._( 'Default' ) + ' --';\n\n\tGlobal.selected_item = '-- ' + $.i18n._( 'Selected' ) + ' --';\n\n\tGlobal.open_item = '-- ' + $.i18n._( 'Open' ) + ' --';\n\n\tGlobal.empty_item = '-- ' + $.i18n._( 'None' ) + ' --';\n\n\tGlobal.view_mode_message = $.i18n._( 'You are currently in \\'View\\' mode' );\n\n\tGlobal.view_mode_edit_message = $.i18n._( 'instead click the \\'Edit\\' icon to modify fields' ); //Does not start with a capital as it is appended text.\n\n\tGlobal.no_result_message = $.i18n._( 'No Results Found' );\n\n\tGlobal.save_and_continue_message = $.i18n._( 'Please save this record before modifying any related data' );\n\n\tGlobal.no_hierarchy_message = $.i18n._( 'No Hierarchies Defined' );\n\n\tGlobal.modify_alert_message = $.i18n._( 'You have modified data without saving, are you sure you want to continue and lose your changes?' );\n\n\tGlobal.not_modify_alert_message = $.i18n._( 'No changes were detected in this record, but saving may modify related data. If you do not want to make changes, you may use the Cancel button instead. <br><br>Would you still like to save without changes?' );\n\n\tGlobal.confirm_on_exit_message = $.i18n._( 'Are you sure you want to continue without saving?' );\n\n\tGlobal.delete_confirm_message = $.i18n._( 'You are about to delete data, once data is deleted it can not be recovered.<br>Are you sure you wish to continue?' );\n\n\tGlobal.delete_dashlet_confirm_message = $.i18n._( 'You are about to delete this dashlet, once a dashlet is deleted it can not be recovered.<br>Are you sure you wish to continue?' );\n\n\tGlobal.copy_multiple_confirm_message = $.i18n._( 'You are about to copy multiple records.<br>Are you sure you wish to continue?' );\n\n\tGlobal.auto_arrange_dashlet_confirm_message = $.i18n._( 'You are about to restore all dashlets to their default size/layout.<br>Are you sure you wish to continue?' );\n\n\tGlobal.rese_all_dashlet_confirm_message = $.i18n._( 'You are about to remove all your customized dashlets and restore them back to the defaults.<br>Are you sure you wish to continue?' );\n};\n\nGlobal.getUpgradeMessage = function() {\n\tvar message = $.i18n._( 'This functionality is only available in' ) +\n\t\t' ' + LocalCacheData.getLoginData().application_name + ' ';\n\n\tif ( Global.getProductEdition() < 15 ) {\n\t\t//Do not mention professional if user is on professional edition.\n\t\tmessage += $.i18n._( 'Professional, Corporate, or Enterprise Editions.' );\n\t} else if ( Global.getProductEdition() < 20 ) {\n\t\t//Do not mention corporate if user is on corporate edition.\n\t\tmessage += $.i18n._( 'Corporate or Enterprise Editions.' );\n\t} else {\n\t\tmessage += $.i18n._( 'Enterprise Editions.' );\n\t}\n\n\tmessage += ' ' + $.i18n._( 'For more information please visit' ) + ' <a href=\"https://coreapi.timetrex.com/r?id=810\" target=\"_blank\">www.timetrex.com</a>';\n\n\tGlobal.trackView( 'CommunityUpgrade' );\n\treturn message;\n};\n\nGlobal.doPingIfNecessary = function() {\n\tif ( Global.idle_time < Math.min( 15, APIGlobal.pre_login_data.session_idle_timeout / 60 ) ) { //idle_time is minutes, session_idle_timeout is seconds.\n\t\tGlobal.idle_time = 0;\n\t\treturn;\n\t}\n\n\tDebug.Text( 'User is active again after idle for: ' + Global.idle_time + '... Resetting idle to 0', 'Global.js', '', 'doPingIfNecessary', 1 );\n\tGlobal.idle_time = 0;\n\n\tif ( LocalCacheData.current_open_primary_controller.viewId === 'LoginView' ) {\n\t\treturn;\n\t}\n\n\tvar api = TTAPI.APIAuthentication;\n\tapi.isLoggedIn( false, {\n\t\tonResult: function( result ) {\n\t\t\tvar res_data = result.getResult();\n\n\t\t\tif ( res_data !== true ) {\n\t\t\t\t//Don't do Logout here, as we need to display a \"Session Expired\" message to the user, which is triggered from the ServiceCaller.\n\t\t\t\t//  In order to trigger that though, we need to make an *Authenticated* API call to APIMisc.Ping(), rather than UnAuthenticated call to APIAuthentication.Ping()\n\t\t\t\tvar api = TTAPI.APIMisc;\n\t\t\t\tapi.ping( {\n\t\t\t\t\tonResult: function() {\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t} );\n};\n\nGlobal.setupPing = function() {\n\tGlobal.idle_time = 0;\n\t$( 'body' ).mousemove( Global.debounce( function setupPingMouseMoveEvent( e ) {\n\t\tGlobal.doPingIfNecessary();\n\t}, 1000 ) );\n\t$( 'body' ).keypress( Global.debounce( function setupPingKeyPressEvent( e ) {\n\t\tGlobal.doPingIfNecessary();\n\t}, 1000 ) );\n\n\tsetInterval( timerIncrement, 60000 ); // 1 minute\n\tfunction timerIncrement() {\n\t\tGlobal.idle_time = Global.idle_time + 1;\n\t\tif ( Global.idle_time >= Math.min( 15, APIGlobal.pre_login_data.session_idle_timeout / 60 ) ) {\n\t\t\tDebug.Text( 'User is idle: ' + Global.idle_time, 'Global.js', '', 'setupPing', 1 );\n\t\t}\n\t}\n};\n\nGlobal.clearCache = function( function_name ) {\n\tfor ( var key in LocalCacheData.result_cache ) {\n\t\tif ( key.indexOf( function_name ) >= 0 ) {\n\t\t\tdelete LocalCacheData.result_cache[key];\n\t\t}\n\t}\n};\n\nGlobal.getHost = function( host ) {\n\tif ( !host ) {\n\t\thost = window.location.hostname;\n\t}\n\n\t//Make sure its not an IPv4 address, and if its a domain has more than 1 dot in it before parsing off the sub-domain part.\n\t// So both IPv4 addresses and domains like: localhost (no dot at all), mycompany.com should not be modified at all. Only: sub.mycompany.com, sub.sub2.mycompany.com\n\tvar is_sub_domain = host.match( /\\./g );\n\tif ( /^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/.test( host ) == false && is_sub_domain && is_sub_domain.length > 1 ) {\n\t\thost = host.substring( ( host.indexOf( '.' ) + 1 ) );\n\t}\n\n\treturn host;\n};\n\nGlobal.setWidgetEnabled = function( widget, val ) {\n\tif ( widget ) {\n\t\tif ( !val ) {\n\t\t\twidget.attr( 'disabled', 'true' );\n\t\t\twidget.addClass( 'disable-filter' );\n\t\t} else {\n\t\t\twidget.removeAttr( 'disabled' );\n\t\t\twidget.removeClass( 'disable-filter' );\n\t\t}\n\t}\n};\n\nGlobal.createViewTabs = function() {\n\t//JS load Optimize\n\tif ( typeof WidgetNamesDic == 'undefined' ) {\n\t\treturn;\n\t}\n\tif ( LocalCacheData.loadViewRequiredJSReady ) {\n\t\tif ( !LocalCacheData.view_min_tab_bar ) {\n\t\t\tvar view_min_tab_bar = Global.loadWidgetByName( WidgetNamesDic.VIEW_MIN_TAB_BAR );\n\t\t\tview_min_tab_bar = $( view_min_tab_bar ).ViewMinTabBar();\n\t\t\t$( '.layout-content-wrapper' ).append( view_min_tab_bar );\n\n\t\t\tLocalCacheData.view_min_tab_bar = view_min_tab_bar;\n\t\t}\n\n\t\tLocalCacheData.view_min_tab_bar.buildTabs( LocalCacheData.view_min_map );\n\t}\n};\n\nGlobal.addViewTab = function( view_id, view_name, url ) {\n\tLocalCacheData.view_min_map[view_id] = view_name;\n\n\tLocalCacheData.view_min_map[view_id + '_url'] = url;\n\n\tGlobal.createViewTabs();\n};\n\nGlobal.removeViewTab = function( view_id ) {\n\tdelete LocalCacheData.view_min_map[view_id];\n\t$( '#min_tab_' + view_id ).remove();\n};\n\nGlobal.cleanViewTab = function() {\n\tLocalCacheData.view_min_map = {};\n\tGlobal.createViewTabs();\n};\n\n/*\n * Capitalize the first letter of each word in a string\n */\nGlobal.ucwords = function( str ) {\n\tif ( typeof str == 'string' ) { //in case null or false is passed, we should check the type.\n\t\tlet words = str.split( ' ' ); // split string into words\n\n\t\tlet result = words.map( function( word ) { // iterate over words\n\t\t\treturn word.charAt( 0 ).toUpperCase() + word.slice( 1 ); // change case of first letter and concatenate with rest of word\n\t\t} );\n\n\t\treturn result.join( ' ' ); // join words back into string\n\t}\n\n\treturn str;\n};\n\n/*\n * Capitalize the first letter of a string\n */\nGlobal.upCaseFirstLetter = function( str ) {\n\tif ( typeof str == 'string' ) { //in case null or false is passed, we should check the type.\n\t\tstr = str.charAt( 0 ).toUpperCase() + str.slice( 1 );\n\t}\n\treturn str;\n};\n\n/*\n * This function is used to calculate the width of a text string in pixels.\n *   It uses a canvas for performance reasons, as it prevents all forced reflows, and seems to be generally faster overall.\n */\nGlobal.calculateTextWidth = function( text, options ) {\n\tif ( typeof options === 'undefined' ) {\n\t\toptions = {};\n\t}\n\n\tif ( !options.fontSize ) {\n\t\toptions.fontSize = '12px';\n\t}\n\n\tif ( !options.fontFamily ) {\n\t\toptions.fontFamily = window.getComputedStyle( document.body ).fontFamily; //Use default font family from CSS.\n\t}\n\n\tlet canvas = Global.calculateTextWidth.canvas || ( Global.calculateTextWidth.canvas = document.createElement( 'canvas' ) );\n\tlet context = canvas.getContext( '2d' );\n\n\tif ( options.fontFamily ) {\n\t\toptions.fontFamily = options.fontFamily;\n\t} else {\n\t\toptions.fontFamily = '';\n\t}\n\n\tif ( options.fontWeight ) {\n\t\toptions.fontWeight = options.fontWeight;\n\t} else {\n\t\toptions.fontWeight = '';\n\t}\n\n\tif ( options.wordBreak ) {\n\t\toptions.wordBreak = options.wordBreak;\n\t} else {\n\t\toptions.wordBreak = '';\n\t}\n\n\tcontext.font = options.fontWeight + ' ' + options.fontSize + ' ' + options.fontFamily;\n\n\tvar content_width = context.measureText( text ).width;\n\n\tif ( options.min_width && options.min_width > 0 && content_width < options.min_width ) {\n\t\tcontent_width = options.min_width;\n\t}\n\tif ( options.padding && options.padding > 0 ) {\n\t\tcontent_width = content_width + options.padding;\n\t}\n\tif ( options.max_width > 0 && content_width > options.max_width ) {\n\t\tcontent_width = options.max_width;\n\t}\n\n\treturn content_width;\n};\n\nGlobal.strToDate = function( date_string, format ) {\n\n\t//better to use Date.parse, let's see\n\tif ( !Global.isSet( format ) && LocalCacheData.getLoginUserPreference() ) {\n\t\tformat = LocalCacheData.getLoginUserPreference().date_format;\n\t}\n\n\tif ( !format ) {\n\t\tformat = 'DD-MMM-YY';\n\t}\n\n\tvar date = moment( date_string, format );\n\tdate = date.toDate();\n\n\t//The moment will pass everything as a date. Judge if the year less 1000 than 1900 or beyond 1000 of 1900,\n\t//we think it's a invalid year\n\tif ( date.getYear() < -1000 || date.getYear() > 1000 ) {\n\t\treturn null;\n\t}\n\n\treturn date;\n};\n\nGlobal.strToDateTime = function( date_string ) {\n\t//Error: TypeError: Global.strToDateTime(...) is null in /interface/html5/framework/jquery.min.js?v=8.0.0-20141117-153515 line 4862\n\tif ( !date_string || !LocalCacheData.getLoginUserPreference() ) {\n\t\treturn null;\n\t}\n\n\tvar date_format = LocalCacheData.getLoginUserPreference().date_format;\n\tvar time_format = LocalCacheData.getLoginUserPreference().js_time_format[LocalCacheData.getLoginUserPreference().time_format];\n\tvar date = moment( date_string, date_format + ' ' + time_format ).toDate();\n\n\treturn date;\n\t//return Date.parse( date_string );\n};\n\n//Convert all kinds of date time to mm/dd/yyyy so Date.parse can parse it correct\nGlobal.getStandardDateTimeStr = function( date_str, time_str ) {\n\t//var result = Global.strToDate( date_str ).format( 'MM/DD/YYYY' ) + ' ' + time_str;\n\n\treturn date_str;\n};\n\nGlobal.convertTojQueryFormat = function( date_format ) {\n\t//For moment date parser\n\tvar jquery_date_format = {\n\t\t'd-M-y': 'dd-M-y',\n\t\t'd-M-Y': 'dd-M-yy',\n\t\t'dMY': 'ddMyy',\n\t\t'd/m/Y': 'dd/mm/yy',\n\t\t'd/m/y': 'dd/mm/y',\n\t\t'd-m-y': 'dd-mm-y',\n\t\t'd-m-Y': 'dd-mm-yy',\n\t\t'm/d/y': 'mm/dd/y',\n\t\t'm/d/Y': 'mm/dd/yy',\n\t\t'm-d-y': 'mm-dd-y',\n\t\t'm-d-Y': 'mm-dd-yy',\n\t\t'Y-m-d': 'yy-mm-dd',\n\t\t'M-d-y': 'M-dd-y',\n\t\t'M-d-Y': 'M-dd-yy',\n\t\t'l, F d Y': 'DD, MM dd yy',\n\t\t'D, F d Y': 'D, MM dd yy',\n\t\t'D, M d Y': 'D, M dd yy',\n\t\t'D, d-M-Y': 'D, dd-M-yy',\n\t\t'D, dMY': 'D, ddMyy',\n\n\t\t'g:i A': 'h:mm TT',\n\t\t'g:i a': 'h:mm tt',\n\t\t'G:i': 'H:mm',\n\t\t'g:i A T': 'h:mm TT',\n\t\t'G:i T': 'H:mm',\n\n\t\t'g:i:s A': 'h:mm:ss TT',\n\t\t'g:i:s a': 'h:mm:ss tt',\n\t\t'G:i:s': 'H:mm:ss',\n\t\t'g:i:s A T': 'h:mm:ss TT',\n\t\t'G:i:s T': 'H:mm:ss'\n\t};\n\n\treturn jquery_date_format[date_format];\n};\n\nGlobal.updateUserPreference = function( callBack, message ) {\n\tvar user_preference_api = TTAPI.APIUserPreference;\n\tvar current_user_aou = TTAPI.APIAuthentication;\n\n\tif ( message ) {\n\t\tProgressBar.changeProgressBarMessage( message );\n\t}\n\n\tcurrent_user_aou.getCurrentUserPreference( {\n\t\tonResult: function( result ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tLocalCacheData.loginUserPreference = result_data;\n\n\t\t\tuser_preference_api.getOptions( 'moment_date_format', {\n\t\t\t\tonResult: function( jsDateFormatRes ) {\n\t\t\t\t\tvar jsDateFormatResultData = jsDateFormatRes.getResult();\n\n\t\t\t\t\t//For moment date parser\n\t\t\t\t\tLocalCacheData.loginUserPreference.js_date_format = jsDateFormatResultData;\n\n\t\t\t\t\tvar date_format = LocalCacheData.loginUserPreference.date_format;\n\t\t\t\t\tif ( !date_format ) {\n\t\t\t\t\t\tdate_format = 'DD-MMM-YY';\n\t\t\t\t\t}\n\n\t\t\t\t\tLocalCacheData.loginUserPreference.date_format = LocalCacheData.loginUserPreference.js_date_format[date_format];\n\n\t\t\t\t\tLocalCacheData.loginUserPreference.date_format_1 = Global.convertTojQueryFormat( date_format ); //TDatePicker, TRangePicker\n\t\t\t\t\tLocalCacheData.loginUserPreference.time_format_1 = Global.convertTojQueryFormat( LocalCacheData.loginUserPreference.time_format ); //TTimePicker\n\n\t\t\t\t\tuser_preference_api.getOptions( 'moment_time_format', {\n\t\t\t\t\t\tonResult: function( jsTimeFormatRes ) {\n\t\t\t\t\t\t\tvar jsTimeFormatResultData = jsTimeFormatRes.getResult();\n\n\t\t\t\t\t\t\tLocalCacheData.loginUserPreference.js_time_format = jsTimeFormatResultData;\n\n\t\t\t\t\t\t\tLocalCacheData.setLoginUserPreference( LocalCacheData.loginUserPreference );\n\n\t\t\t\t\t\t\tif ( callBack ) {\n\t\t\t\t\t\t\t\tcallBack();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t} );\n};\n\n/* jshint ignore:start */\nGlobal.roundTime = function( epoch, round_value, round_type ) {\n\tif ( epoch === 0 || round_value === 0 ) {\n\t\treturn epoch;\n\t}\n\n\tvar round_type = round_type || 20;\n\n\tswitch ( round_type ) {\n\t\tcase 10: //Down\n\t\t\tepoch = ( epoch - ( epoch % round_value ) );\n\t\t\tbreak;\n\t\tcase 20: //Average\n\t\tcase 25: //Average (round split seconds up)\n\t\tcase 27: //Average (round split seconds down)\n\t\t\tvar tmp_round_value;\n\t\t\tif ( round_type == 20 || round_value <= 60 ) {\n\t\t\t\ttmp_round_value = ( round_value / 2 );\n\t\t\t} else if ( round_type == 25 ) { //Average (Partial Min. Down)\n\t\t\t\ttmp_round_value = Global.roundTime( ( round_value / 2 ), 60, 10 ); //This is opposite rounding\n\t\t\t} else if ( round_type == 27 ) { //Average (Partial Min. Up)\n\t\t\t\ttmp_round_value = Global.roundTime( ( round_value / 2 ), 60, 30 );\n\t\t\t}\n\n\t\t\tif ( epoch > 0 ) {\n\t\t\t\t//When doing a 15min average rounding, US law states 7mins and 59 seconds can be rounded down in favor of the employer, and 8mins and 0 seconds must be rounded up.\n\t\t\t\t//So if the round interval is not an even number, round it up to the nearest minute before doing the calculations to avoid issues with seconds.\n\t\t\t\tepoch = ( Math.floor( ( epoch + tmp_round_value ) / round_value ) * round_value );\n\t\t\t} else {\n\t\t\t\tepoch = ( Math.ceil( ( epoch - tmp_round_value ) / round_value ) * round_value );\n\t\t\t}\n\n\t\t\tbreak;\n\t\tcase 30: //Up\n\t\t\tepoch = ( ( ( epoch + ( round_value - 1 ) ) / round_value ) * round_value );\n\t\t\tbreak;\n\t}\n\n\treturn epoch;\n},\n\n\tGlobal.parseTimeUnit = function( time_unit, format ) {\n\t\tvar format, time_unit, time_units, seconds, negative_number;\n\n\t\tvar time_unit = time_unit.toString(); //Needs to be a string so we can use .charAt and .replace below.\n\n\t\tif ( !format ) {\n\t\t\tformat = LocalCacheData.getLoginUserPreference().time_unit_format;\n\t\t}\n\t\tformat = parseInt( format );\n\n\t\tvar enable_rounding = true;\n\t\tif ( time_unit.charAt( 0 ) == '\"' ) {\n\t\t\tenable_rounding = false;\n\t\t}\n\n\t\tvar thousands_separator = ',';\n\t\tvar decimal_separator = '.';\n\n\t\ttime_unit = time_unit.replace( new RegExp( thousands_separator, 'g' ), '' ).replace( new RegExp( ' ', 'g' ), '' ).replace( new RegExp( '\"', 'g' ), '' ); //Need to use regex to replace all instances.\n\n\t\tswitch ( format ) {\n\t\t\tcase 10: //hh:mm\n\t\t\tcase 12: //hh:mm:ss\n\t\t\t\tif ( time_unit.indexOf( decimal_separator ) !== -1 && time_unit.indexOf( ':' ) === -1 ) { //Hybrid mode, they passed a decimal format HH:MM, try to handle properly.\n\t\t\t\t\t//time_unit = Global.getTimeUnit( Global.parseTimeUnit( time_unit, 20 ), format );\n\t\t\t\t\tseconds = Global.parseTimeUnit( time_unit, 20 ); //Parse directly to seconds, this avoids rounding to the nearest fraction of an hour.\n\t\t\t\t} else {\n\t\t\t\t\ttime_units = time_unit.split( ':' );\n\n\t\t\t\t\tif ( !time_units[0] ) {\n\t\t\t\t\t\ttime_units[0] = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !time_units[1] ) {\n\t\t\t\t\t\ttime_units[1] = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !time_units[2] ) {\n\t\t\t\t\t\ttime_units[2] = 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( time_units[2] != 0 ) {\n\t\t\t\t\t\t\tenable_rounding = false; //Since seconds were specified, don't round to nearest minute.\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tnegative_number = false;\n\t\t\t\t\tif ( time_units[0].toString().charAt( 0 ) == '-' || time_units[0] < 0 || time_units[1] < 0 || time_units[2] < 0 ) {\n\t\t\t\t\t\tnegative_number = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tseconds = ( ( Math.abs( Math.floor( time_units[0] ) ) * 3600 ) + ( Math.abs( Math.floor( time_units[1] ) ) * 60 ) + Math.abs( time_units[2] ) ); //Allow seconds to be a decimal.\n\n\t\t\t\t\tif ( negative_number == true ) {\n\t\t\t\t\t\tseconds = ( seconds * -1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 20: //hours\n\t\t\tcase 22: //hours [Precise]\n\t\t\tcase 23: //hours [Super Precise]\n\t\t\t\tif ( time_unit.indexOf( ':' ) !== -1 ) { //Hybrid mode, they passed a decimal format HH:MM, try to handle properly.\n\t\t\t\t\t//time_unit = Global.getTimeUnit( Global.parseTimeUnit( time_unit, 23 ), format );\n\t\t\t\t\tseconds = Global.parseTimeUnit( time_unit, 10 ); //Parse directly to seconds, this avoids rounding to the nearest fraction of an hour.\n\t\t\t\t} else {\n\t\t\t\t\tseconds = ( time_unit * 3600 );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 30: //minutes\n\t\t\t\tseconds = ( time_unit * 60 );\n\t\t\t\tbreak;\n\t\t\tcase 40: //seconds\n\t\t\t\tseconds = time_unit;\n\n\t\t\t\t//Always allow decimal with seconds when parsing, so we can properly handle accrual balances with fractions of a second.\n\t\t\t\t// if ( enable_rounding == true ) {\n\t\t\t\t// \tseconds = Math.round( seconds ); //Round to nearest whole number by default.\n\t\t\t\t// }\n\n\t\t\t\tenable_rounding = false; //Since seconds were specified, don't round to nearest minute. Also for accruals might need to allow decimal seconds.\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// Add check to prevent scientific notation which could occur with: Global.parseTimeUnit( '999999999999999999', 10 )\n\t\tif ( Math.abs( seconds ) > Number.MAX_SAFE_INTEGER ) {\n\t\t\treturn Number.MAX_SAFE_INTEGER;\n\t\t}\n\n\t\tif ( enable_rounding == true ) {\n\t\t\tseconds = Global.roundTime( seconds, 60 );\n\t\t}\n\n\t\t//Debug.Text( 'Time Unit: '+ time_unit +' Retval: '+ seconds, 'Global.js', '', 'parseTimeUnit', 10 );\n\t\treturn seconds;\n\t},\n\n\tGlobal.convertSecondsToHMS = function( seconds, include_seconds, exclude_hours ) {\n\t\tvar negative_number = false;\n\n\t\tif ( seconds < 0 ) {\n\t\t\tnegative_number = true;\n\t\t}\n\n\t\tseconds = Math.abs( seconds );\n\t\tvar tmp_hours = Math.floor( seconds / 3600 );\n\t\tvar tmp_minutes = Math.floor( ( seconds / 60 ) % 60 );\n\t\tvar tmp_seconds = Decimal( seconds ).mod( 60 );\n\n\t\tif ( exclude_hours == true ) { //Convert hours to minutes before we pad it.\n\t\t\ttmp_minutes = ( ( tmp_hours * 60 ) + tmp_minutes );\n\t\t\ttmp_hours = 0;\n\t\t}\n\n\t\tif ( tmp_hours < 10 ) {\n\t\t\ttmp_hours = '0' + tmp_hours;\n\t\t}\n\n\t\tif ( tmp_minutes < 10 ) {\n\t\t\ttmp_minutes = '0' + tmp_minutes;\n\t\t}\n\n\t\tif ( tmp_seconds < 10 ) {\n\t\t\ttmp_seconds = '0' + tmp_seconds;\n\t\t}\n\n\t\tvar retval;\n\t\tif ( exclude_hours == true ) {\n\t\t\tretval = [tmp_minutes, tmp_seconds].join( ':' );\n\t\t} else {\n\t\t\tif ( include_seconds == true ) {\n\t\t\t\tretval = [tmp_hours, tmp_minutes, tmp_seconds].join( ':' );\n\t\t\t} else {\n\t\t\t\tretval = [tmp_hours, tmp_minutes].join( ':' );\n\t\t\t}\n\t\t}\n\n\t\tif ( negative_number == true ) {\n\t\t\tretval = '-' + retval;\n\t\t}\n\n\t\treturn retval;\n\t},\n\n//Was: Global.secondToHHMMSS\n\tGlobal.getTimeUnit = function( seconds, format ) {\n\t\tvar retval;\n\n\t\t//always return hh:ss. if we can't parse to float, then work with 0 tmp_seconds\n\t\tvar seconds = parseFloat( seconds );\n\t\tif ( isNaN( seconds ) ) {\n\t\t\tseconds = 0;\n\t\t}\n\n\t\t//FIXES BUG#2071 - don't check the local cache data for default value, or it will fail and cause errors when unauthenticated. For example in the installer.\n\t\tvar format;\n\t\tif ( !format ) {\n\t\t\tif ( LocalCacheData.getLoginUserPreference() ) {\n\t\t\t\tformat = LocalCacheData.getLoginUserPreference().time_unit_format;\n\t\t\t} else {\n\t\t\t\tformat = 10;\n\t\t\t}\n\t\t}\n\t\tformat = parseInt( format );\n\n\t\tswitch ( format ) {\n\t\t\tcase 10:\n\t\t\t\tretval = Global.convertSecondsToHMS( seconds );\n\t\t\t\tbreak;\n\t\t\tcase 12:\n\t\t\t\tretval = Global.convertSecondsToHMS( seconds, true );\n\t\t\t\tbreak;\n\t\t\tcase 99: //For local use only, in progress bar always show tmp_minutes and tmp_seconds\n\t\t\t\tretval = Global.convertSecondsToHMS( Math.floor( seconds ), true, true );\n\t\t\t\tbreak;\n\t\t\tcase 20:\n\t\t\t\tretval = ( seconds / 3600 ).toFixed( 2 );\n\t\t\t\tbreak;\n\t\t\tcase 22:\n\t\t\t\tretval = ( seconds / 3600 ).toFixed( 3 );\n\t\t\t\tbreak;\n\t\t\tcase 23:\n\t\t\t\tretval = ( seconds / 3600 ).toFixed( 4 );\n\t\t\t\tbreak;\n\t\t\tcase 30:\n\t\t\t\tretval = ( seconds / 60 ).toFixed( 0 );\n\t\t\t\tbreak;\n\t\t\tcase 40:\n\t\t\t\tretval = seconds;\n\t\t\t\tbreak;\n\t\t}\n\n\t\t//Debug.Text( 'Seconds: '+ seconds +' Retval: '+ retval, 'Global.js', '', 'getTimeUnit', 10 );\n\t\treturn retval;\n\t};\n\nGlobal.removeTrailingZeros = function( value, minimum_decimals ) {\n\tif ( !minimum_decimals ) {\n\t\tminimum_decimals = 2;\n\t}\n\tif ( value ) {\n\t\tvalue = parseFloat( value ); // first to remove the zero after the point.\n\n\t\tvar trimmed_value = value.toString();\n\n\t\tif ( trimmed_value.indexOf( '.' ) > 0 ) {\n\t\t\t// If after removed has the point, then reverse it.\n\t\t\tvar tmp_minimum_decimals = parseInt( trimmed_value.split( '' ).reverse().join( '' ) ).toString().length;\n\t\t\tif ( tmp_minimum_decimals >= minimum_decimals && tmp_minimum_decimals <= 4 ) {\n\t\t\t\tminimum_decimals = tmp_minimum_decimals;\n\t\t\t}\n\n\t\t}\n\n\t\treturn value.toFixed( minimum_decimals );\n\t}\n\n\treturn value;\n};\n\n/* jshint ignore:end */\n\nGlobal.isCanvasSupported = function() {\n\tvar elem = document.createElement( 'canvas' );\n\treturn !!( elem.getContext && elem.getContext( '2d' ) );\n};\n\nGlobal.getRandomNum = function() {\n\n\tvar number = Math.floor( Math.random() * 999 );//0-23\n\n\treturn number;\n\n};\n\n/* jshint ignore:start */\n\nGlobal.getScriptNameByAPI = function( api_class ) {\n\n\tif ( !api_class || !api_class.className ) {\n\t\treturn null;\n\t}\n\n\tvar script_name = '';\n\tswitch ( api_class.className ) {\n\t\tcase 'APIUser':\n\t\t\tscript_name = 'EmployeeView';\n\t\t\tbreak;\n\t\tcase 'APIBranch':\n\t\t\tscript_name = 'BranchView';\n\t\t\tbreak;\n\t\tcase 'APIDepartment':\n\t\t\tscript_name = 'DepartmentView';\n\t\t\tbreak;\n\t\tcase 'APIUserWage':\n\t\t\tscript_name = 'WageView';\n\t\t\tbreak;\n\t\tcase 'APIUserContact':\n\t\t\tscript_name = 'UserContactView';\n\t\t\tbreak;\n\t\tcase 'APIUserTitle':\n\t\t\tscript_name = 'UserTitleView';\n\t\t\tbreak;\n\t\tcase 'APIWageGroup':\n\t\t\tscript_name = 'WageGroupView';\n\t\t\tbreak;\n\t\tcase 'APILog':\n\t\t\tscript_name = 'LogView';\n\t\t\tbreak;\n\t\tcase 'APIUserGroup':\n\t\t\tscript_name = 'UserGroupView';\n\t\t\tbreak;\n\t\tcase 'APIPayStubEntryAccount':\n\t\t\tscript_name = 'PayStubEntryAccountView';\n\t\t\tbreak;\n\t\tcase 'APIPayStubEntryAccountLink':\n\t\t\tscript_name = 'PayStubEntryAccountLinkView';\n\t\t\tbreak;\n\t\tcase 'APIPayPeriod':\n\t\tcase 'APIPayPeriodSchedule':\n\t\t\tscript_name = 'PayPeriodsView';\n\t\t\tbreak;\n\t\tcase 'APIAccrual':\n\t\t\tscript_name = 'APIAccrual';\n\t\t\tbreak;\n\t\tcase 'APIAccrualBalance':\n\t\t\tscript_name = 'AccrualBalanceView';\n\t\t\tbreak;\n\t\tcase 'APIException':\n\t\t\tscript_name = 'ExceptionView';\n\t\t\tbreak;\n\t\tcase 'APIJobGroup':\n\t\t\tscript_name = 'JobGroupView';\n\t\t\tbreak;\n\t\tcase 'APIJob':\n\t\t\tscript_name = 'JobView';\n\t\t\tbreak;\n\t\tcase 'APIJobItemGroup':\n\t\t\tscript_name = 'JobItemGroupView';\n\t\t\tbreak;\n\t\tcase 'APIJobItem':\n\t\t\tscript_name = 'JobItemView';\n\t\t\tbreak;\n\t\tcase 'APIJobItemAmendment':\n\t\t\tscript_name = 'JobItemAmendment';\n\t\t\tbreak;\n\t\tcase 'APIPunch':\n\t\t\tscript_name = 'PunchesView';\n\t\t\tbreak;\n\t\tcase 'APIPunchTag':\n\t\t\tscript_name = 'PunchTagView';\n\t\t\tbreak;\n\t\tcase 'APIPunchTagGroup':\n\t\t\tscript_name = 'PunchTagGroupView';\n\t\t\tbreak;\n\t\tcase 'APIRecurringScheduleControl':\n\t\t\tscript_name = 'RecurringScheduleControlView';\n\t\t\tbreak;\n\n\t\tcase 'APIRecurringScheduleTemplateControl':\n\t\t\tscript_name = 'RecurringScheduleTemplateControlView';\n\t\t\tbreak;\n\t\tcase 'APISchedule':\n\t\t\tscript_name = 'ScheduleShiftView';\n\t\t\tbreak;\n\t\tcase 'APIBankAccount':\n\t\t\tscript_name = 'BankAccountView';\n\t\t\tbreak;\n\t\tcase 'APICompany':\n\t\t\tscript_name = 'CompanyView';\n\t\t\tbreak;\n\t\tcase 'APICurrency':\n\t\t\tscript_name = 'CurrencyView';\n\t\t\tbreak;\n\t\tcase 'APICurrencyRate':\n\t\t\tscript_name = 'CurrencyRate';\n\t\t\tbreak;\n\t\tcase 'APIHierarchyControl':\n\t\t\tscript_name = 'HierarchyControlView';\n\t\t\tbreak;\n\t\tcase 'APIEthnicGroup':\n\t\t\tscript_name = 'EthnicGroupView';\n\t\t\tbreak;\n\t\tcase 'APICustomField':\n\t\t\tscript_name = 'CustomFieldView';\n\t\t\tbreak;\n\t\tcase 'APIPermissionControl':\n\t\t\tscript_name = 'PermissionControlView';\n\t\t\tbreak;\n\t\tcase 'APIStation':\n\t\t\tscript_name = 'StationView';\n\t\t\tbreak;\n\t\tcase 'APIDocumentRevision':\n\t\t\tscript_name = 'DocumentRevisionView';\n\t\t\tbreak;\n\t\tcase 'APIDocumentGroup':\n\t\t\tscript_name = 'DocumentGroupView';\n\t\t\tbreak;\n\t\tcase 'APIDocument':\n\t\t\tscript_name = 'DocumentView';\n\t\t\tbreak;\n\t\tcase 'APIROE':\n\t\t\tscript_name = 'ROEView';\n\t\t\tbreak;\n\t\tcase 'APIUserDefault':\n\t\t\tscript_name = 'UserDefaultView';\n\t\t\tbreak;\n\t\tcase 'APIUserPreference':\n\t\t\tscript_name = 'UserPreferenceView';\n\t\t\tbreak;\n\t\tcase 'APIKPI':\n\t\t\tscript_name = 'KPIView';\n\t\t\tbreak;\n\t\tcase 'APIUserReviewControl':\n\t\t\tscript_name = 'UserReviewControlView';\n\t\t\tbreak;\n\t\tcase 'APIQualification':\n\t\t\tscript_name = 'QualificationView';\n\t\t\tbreak;\n\t\tcase 'APIUserEducation':\n\t\t\tscript_name = 'UserTitleView';\n\t\t\tbreak;\n\t\tcase 'APIUserLanguage':\n\t\t\tscript_name = 'UserTitleView';\n\t\t\tbreak;\n\t\tcase 'APIUserLicense':\n\t\t\tscript_name = 'UserLicenseView';\n\t\t\tbreak;\n\t\tcase 'APIUserMembership':\n\t\t\tscript_name = 'UserMembershipView';\n\t\t\tbreak;\n\t\tcase 'APIUserSkill':\n\t\t\tscript_name = 'UserSkillView';\n\t\t\tbreak;\n\t\tcase 'APIJobApplicantEducation':\n\t\t\tscript_name = 'JobApplicantEducationView';\n\t\t\tbreak;\n\t\tcase 'APIJobApplicantEmployment':\n\t\t\tscript_name = 'JobApplicantEducationView';\n\t\t\tbreak;\n\t\tcase 'APIJobApplicantLanguage':\n\t\t\tscript_name = 'JobApplicantLanguageView';\n\t\t\tbreak;\n\t\tcase 'APIJobApplicantLicense':\n\t\t\tscript_name = 'JobApplicantLicenseView';\n\t\t\tbreak;\n\t\tcase 'APIJobApplicantLocation':\n\t\t\tscript_name = 'JobApplicantLicenseView';\n\t\t\tbreak;\n\t\tcase 'APIJobApplicantMembership':\n\t\t\tscript_name = 'JobApplicantMembershipView';\n\t\t\tbreak;\n\t\tcase 'APIJobApplicantReference':\n\t\t\tscript_name = 'JobApplicantReferenceView';\n\t\t\tbreak;\n\t\tcase 'APIJobApplicantSkill':\n\t\t\tscript_name = 'JobApplicantSkillView';\n\t\t\tbreak;\n\t\tcase 'APIJobApplicant':\n\t\t\tscript_name = 'JobApplicantSkillView';\n\t\t\tbreak;\n\t\tcase 'APIJobApplication':\n\t\t\tscript_name = 'JobApplicationView';\n\t\t\tbreak;\n\t\tcase 'APIJobVacancy':\n\t\t\tscript_name = 'JobVacancyView';\n\t\t\tbreak;\n\t\tcase 'APIAreaPolicy':\n\t\t\tscript_name = 'JobVacancyView';\n\t\t\tbreak;\n\t\tcase 'APIClient':\n\t\t\tscript_name = 'ClientView';\n\t\t\tbreak;\n\t\tcase 'APIClientContact':\n\t\t\tscript_name = 'ClientContactView';\n\t\t\tbreak;\n\t\tcase 'APIClientGroup':\n\t\t\tscript_name = 'ClientGroupView';\n\t\t\tbreak;\n\t\tcase 'APIClientPayment':\n\t\t\tscript_name = 'ClientPaymentView';\n\t\t\tbreak;\n\t\tcase 'APIInvoiceDistrict':\n\t\t\tscript_name = 'InvoiceDistrictView';\n\t\t\tbreak;\n\t\tcase 'APIInvoice':\n\t\t\tscript_name = 'InvoiceView';\n\t\t\tbreak;\n\t\tcase 'APITransaction':\n\t\t\tscript_name = 'InvoiceTransactionView';\n\t\t\tbreak;\n\t\tcase 'APIPaymentGateway':\n\t\t\tscript_name = 'PaymentGatewayView';\n\t\t\tbreak;\n\t\tcase 'APIProductGroup':\n\t\t\tscript_name = 'ProductGroupView';\n\t\t\tbreak;\n\t\tcase 'APIProduct':\n\t\t\tscript_name = 'ProductView';\n\t\t\tbreak;\n\t\tcase 'APIInvoiceConfig':\n\t\t\tscript_name = 'InvoiceConfigView';\n\t\t\tbreak;\n\t\tcase 'APIShippingPolicy':\n\t\t\tscript_name = 'ShippingPolicyView';\n\t\t\tbreak;\n\t\tcase 'APITaxPolicy':\n\t\t\tscript_name = 'TaxPolicyView';\n\t\t\tbreak;\n\t\tcase 'APICompanyDeduction':\n\t\t\tscript_name = 'CompanyTaxDeductionView';\n\t\t\tbreak;\n\t\tcase 'APIPayStub':\n\t\t\tscript_name = 'PayStubView';\n\t\t\tbreak;\n\t\tcase 'APIPayStubTransaction':\n\t\t\tscript_name = 'PayStubTransactionView';\n\t\t\tbreak;\n\t\tcase 'APIPayStubEntry':\n\t\t\tscript_name = 'PayStubEntryView';\n\t\t\tbreak;\n\t\tcase 'APIPayStubAmendment':\n\t\t\tscript_name = 'PayStubAmendmentView';\n\t\t\tbreak;\n\t\tcase 'APIRecurringPayStubAmendment':\n\t\t\tscript_name = 'RecurringPayStubAmendmentView';\n\t\t\tbreak;\n\t\tcase 'APIUserExpense':\n\t\t\tscript_name = 'UserExpenseView';\n\t\t\tbreak;\n\t\tcase 'APILegalEntity':\n\t\t\tscript_name = 'LegalEntityView';\n\t\t\tbreak;\n\t\tcase 'APIPayrollRemittanceAgency':\n\t\t\tscript_name = 'PayrollRemittanceAgencyView';\n\t\t\tbreak;\n\t\tcase 'APIPayrollRemittanceAgencyEvent':\n\t\t\tscript_name = 'PayrollRemittanceAgencyViewEvent';\n\t\t\tbreak;\n\t\tcase 'APIAbsencePolicy':\n\t\t\tscript_name = 'AbsencePolicyView';\n\t\t\tbreak;\n\t\tcase 'APIAccrualPolicyAccount':\n\t\t\tscript_name = 'AccrualPolicyAccountView';\n\t\t\tbreak;\n\t\tcase 'APIAccrualPolicy':\n\t\t\tscript_name = 'AccrualPolicyView';\n\t\t\tbreak;\n\t\tcase 'APIAccrualPolicyUserModifier':\n\t\t\tscript_name = 'AccrualPolicyUserModifierView';\n\t\t\tbreak;\n\t\tcase 'APIBreakPolicy':\n\t\t\tscript_name = 'BreakPolicyView';\n\t\t\tbreak;\n\t\tcase 'APIExceptionPolicyControl':\n\t\t\tscript_name = 'ExceptionPolicyControlView';\n\t\t\tbreak;\n\t\tcase 'APIExpensePolicy':\n\t\t\tscript_name = 'ExpensePolicyView';\n\t\t\tbreak;\n\t\tcase 'APIHoliday':\n\t\t\tscript_name = 'HolidayView';\n\t\t\tbreak;\n\t\tcase 'APIHolidayPolicy':\n\t\t\tscript_name = 'HolidayPolicyView';\n\t\t\tbreak;\n\t\tcase 'APIMealPolicy':\n\t\t\tscript_name = 'MealPolicyView';\n\t\t\tbreak;\n\t\tcase 'APIOvertimePolicy':\n\t\t\tscript_name = 'OvertimePolicyView';\n\t\t\tbreak;\n\t\tcase 'APIPolicyGroup':\n\t\t\tscript_name = 'PolicyGroupView';\n\t\t\tbreak;\n\t\tcase 'APIPremiumPolicy':\n\t\t\tscript_name = 'PremiumPolicyView';\n\t\t\tbreak;\n\t\tcase 'APIRecurringHoliday':\n\t\t\tscript_name = 'RecurringHolidayView';\n\t\t\tbreak;\n\t\tcase 'APIRoundIntervalPolicy':\n\t\t\tscript_name = 'RoundIntervalPolicyView';\n\t\t\tbreak;\n\t\tcase 'APISchedulePolicy':\n\t\t\tscript_name = 'SchedulePolicyView';\n\t\t\tbreak;\n\t\tcase 'APIUserReportData':\n\t\t\tscript_name = 'UserReportDataView';\n\t\t\tbreak;\n\t\tcase 'APIInstall':\n\t\t\tscript_name = 'InstallView';\n\t\t\tbreak;\n\t}\n\n\treturn script_name;\n};\n\n/* jshint ignore:end */\n\nGlobal.isObject = function( obj ) {\n\tif ( obj !== null && typeof obj === 'object' ) {\n\t\treturn true;\n\t}\n\n\treturn false;\n};\n\nGlobal.isArray = function( obj ) {\n\n\tif ( Object.prototype.toString.call( obj ) !== '[object Array]' ) {\n\t\treturn false;\n\t}\n\n\treturn true;\n};\n\nGlobal.isString = function( obj ) {\n\n\tif ( Object.prototype.toString.call( obj ) !== '[object String]' ) {\n\t\treturn false;\n\t}\n\n\treturn true;\n};\n\nGlobal.isValidDate = function( obj ) {\n\tif ( obj instanceof Date && !isNaN( obj ) ) {\n\t\treturn true;\n\t}\n\n\treturn false;\n};\n\nGlobal.decodeCellValue = function( val ) {\n\tif ( !val || _.isObject( val ) ) {\n\t\treturn val;\n\t}\n\tval = val.toString();\n\tval = val.replace( /\\n|\\r|(\\r\\n)|(\\u0085)|(\\u2028)|(\\u2029)/g, '<br>' );\n\tval = val.replace( /\\n|\\r|(\\r\\n)|(\\u0085)|(\\u2028)|(\\u2029)/g, '<br>' );\n\tval = Global.htmlEncode( val );\n\tval = val.replace( /&lt;br&gt;/g, '<br>' );\n\n\treturn val;\n};\n\nGlobal.buildTreeRecord = function( array, parentId ) {\n\tvar finalArray = [];\n\n\t$.each( array, function( key, item ) {\n\t\titem.expanded = true;\n\t\titem.loaded = true;\n\n\t\tif ( Global.isSet( parentId ) ) {\n\t\t\titem.parent = parentId;\n\t\t}\n\n\t\tfinalArray.push( item );\n\n\t\tif ( Global.isSet( item.children ) ) {\n\t\t\tvar childrenArray = Global.buildTreeRecord( item.children, item.id );\n\t\t\tfinalArray = finalArray.concat( childrenArray );\n\t\t} else {\n\t\t\titem.isLeaf = true;\n\t\t}\n\n\t} );\n\n\treturn finalArray;\n};\n\nGlobal.getParentIdByTreeRecord = function( array, selectId ) {\n\n\tvar retval = [];\n\tfor ( var i = 0; i < array.length; i++ ) {\n\t\tvar item = array[i];\n\t\tif ( item.id.toString() === selectId.toString() ) {\n\t\t\tvar new_row = {};\n\t\t\tif ( typeof item.parent != 'undefined' ) {\n\t\t\t\tnew_row = { parent_id: item.parent.toString(), name: item.name };\n\t\t\t} else {\n\t\t\t\tnew_row = { name: item.name };\n\t\t\t}\n\n\t\t\t//Without created and updated info, audit tab shows N/A for both\n\t\t\tif ( typeof item.created_by != 'undefined' ) {\n\t\t\t\tnew_row.created_by = item.created_by;\n\t\t\t\tnew_row.created_date = item.created_date;\n\t\t\t\tnew_row.updated_by = item.updated_by;\n\t\t\t\tnew_row.updated_date = item.updated_date;\n\t\t\t}\n\n\t\t\tretval.push( new_row );\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn retval;\n\n};\n\nGlobal.addFirstItemToArray = function( array, firstItemType, customLabel ) {\n\t//Error: Unable to get property 'unshift' of undefined or null reference in /interface/html5/global/Global.js?v=8.0.0-20141230-153942 line 903\n\tvar label;\n\tif ( array ) {\n\t\tif ( firstItemType === 'any' ) {\n\t\t\tif ( customLabel ) {\n\t\t\t\tlabel = customLabel;\n\t\t\t} else {\n\t\t\t\tlabel = Global.any_item;\n\t\t\t}\n\t\t\t//#2301 - don't duplicate the --Any-- case when the array is recycled.\n\t\t\tif ( !array[0] || array[0].value != TTUUID.not_exist_id ) {\n\t\t\t\tarray.unshift( {\n\t\t\t\t\tlabel: label,\n\t\t\t\t\tvalue: TTUUID.not_exist_id,\n\t\t\t\t\tfullValue: TTUUID.not_exist_id,\n\t\t\t\t\torderValue: ''\n\t\t\t\t} );\n\t\t\t}\n\t\t} else if ( firstItemType === 'empty' ) {\n\t\t\tif ( customLabel ) {\n\t\t\t\tlabel = customLabel;\n\t\t\t} else {\n\t\t\t\tlabel = Global.empty_item;\n\t\t\t}\n\t\t\t//#2301 - don't duplicate the --None-- case when the array is recycled.\n\t\t\tif ( !array[0] || array[0].value != TTUUID.zero_id ) {\n\t\t\t\tarray.unshift( {\n\t\t\t\t\tlabel: label,\n\t\t\t\t\tvalue: TTUUID.zero_id,\n\t\t\t\t\tfullValue: TTUUID.zero_id,\n\t\t\t\t\torderValue: ''\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t}\n\n\treturn array;\n};\n\n//Add item on to the end of the array, but make sure its not already there and therefore never duplicated.\nGlobal.addLastItemToArray = function( array, key, label ) {\n\tvar label;\n\tif ( array ) {\n\t\tvar last_array_element = array[( array.length - 1 )];\n\t\tif ( last_array_element.value != key ) {\n\t\t\tarray.push( {\n\t\t\t\tfullValue: key,\n\t\t\t\tvalue: key,\n\t\t\t\tlabel: label,\n\t\t\t\tid: 2000\n\t\t\t} );\n\t\t}\n\t}\n\n\treturn array;\n};\n\nGlobal.convertRecordArrayToOptions = function( array ) {\n\tvar len = array.length;\n\tvar options = {};\n\n\tfor ( var i = 0; i < len; i++ ) {\n\t\tvar item = array[i];\n\n\t\toptions[item.value] = item.label;\n\t}\n\n\treturn options;\n};\n\nGlobal.buildColumnArray = function( array ) {\n\tvar columns = [];\n\tvar id = 1000;\n\n\tfor ( var key in array ) {\n\t\tvar order_value = Global.getSortValue( key, true );\n\t\tvar column = {\n\t\t\tlabel: array[key],\n\t\t\tvalue: Global.removeSortPrefix( key ),\n\t\t\torderValue: order_value,\n\t\t\tid: id\n\t\t};\n\t\tcolumns.push( column );\n\t\tid = id + 1;\n\t}\n\treturn columns;\n};\n\nGlobal.removeSortPrefixFromArray = function( array ) {\n\tvar finalArray = {};\n\n\tif ( Global.isSet( array ) ) {\n\n\t\t$.each( array, function( key, item ) {\n\t\t\tfinalArray[Global.removeSortPrefix( key )] = item;\n\t\t} );\n\n\t\treturn finalArray;\n\t}\n\n\treturn array;\n};\n\nGlobal.removeSortPrefix = function( key ) {\n\tif ( typeof key == 'string' && key.match( Global.sortOrderRegex ) ) {\n\t\tkey = key.replace( Global.sortOrderRegex, '' );\n\t}\n\treturn key;\n};\n\nGlobal.getSortValue = function( key, return_key_on_null ) {\n\tvar order_value = 999;\n\tif ( typeof key == 'string' ) {\n\t\tvar regex_result = key.match( Global.sortOrderRegex );\n\t\tif ( regex_result == null ) {\n\t\t\tif ( return_key_on_null === true ) {\n\t\t\t\torder_value = key;\n\t\t\t}\n\t\t} else if ( regex_result[1] ) {\n\t\t\torder_value = regex_result[1];\n\t\t} else {\n\t\t\tDebug.Error( 'Error: Unable to parse order_value', 'Global', 'Global', 'buildColumnArray', 10 );\n\t\t}\n\t}\n\treturn order_value;\n};\n\nGlobal.convertToNumberIfPossible = function( val ) {\n\t//if value is number convert to number type\n\tvar reg = new RegExp( '^[0-9]*$' );\n\n\tif ( reg.test( val ) && val !== '00' ) {\n\t\tval = parseFloat( val );\n\t}\n\n\tif ( val === '-1' || val === -1 ) {\n\t\tval = -1;\n\t}\n\n\treturn val;\n};\n\nGlobal.buildRecordArray = function( array, first_item, orderType ) {\n\tvar finalArray = [];\n\n\tif ( first_item ) {\n\t\tfinalArray.push( first_item );\n\t}\n\n\tvar id = 1000;\n\n\tif ( Global.isSet( array ) ) {\n\n\t\tfor ( var key in array ) {\n\t\t\tvar item = array[key];\n\t\t\tvar value = Global.removeSortPrefix( key );\n\t\t\tvar order_value = Global.getSortValue( key );\n\n\t\t\t// 6/4 changed id to same as value to make flex show correct data when show search result saved in html5, flex use id if it existed.\n\t\t\tvar record = { label: item, value: value, fullValue: key, orderValue: order_value, id: value };\n\n\t\t\tid = id + 1;\n\n\t\t\tfinalArray.push( record );\n\n\t\t}\n\n\t}\n\n\treturn finalArray;\n\n};\n\nGlobal.topContainer = function() {\n\treturn $( '#topContainer' );\n};\n\nGlobal.overlay = function() {\n\treturn $( '#overlay' );\n};\n\nGlobal.bottomContainer = function() {\n\treturn $( '#bottomContainer' );\n};\n\nGlobal.bottomFeedbackLinkContainer = function() {\n\treturn $( '#feedbackLinkContainer' );\n};\n\nGlobal.showPoweredBy = function() {\n\tvar powered_by_img = $( '#powered_by' );\n\tpowered_by_img.show();\n\tpowered_by_img.attr( 'src', ServiceCaller.getURLByObjectType( 'copyright' ) );\n\tpowered_by_img.attr( 'alt', LocalCacheData.loginData.application_name + ' Workforce Management Software' );\n\tvar powered_by_link = $( '<a target=\"_blank\" href=\"https://' + LocalCacheData.getLoginData().organization_url + '\"></a>' );\n\tpowered_by_link.addClass( 'powered-by-img-seo' );\n\tpowered_by_img.wrap( powered_by_link );\n};\n\nGlobal.setSignalStrength = function() {\n\tif ( Global.signal_timer ) {\n\t\treturn;\n\t}\n\t$( '.signal-strength' ).css( 'display', 'block' );\n\tvar status = '......';\n\tvar average_time = 0;\n\tvar checking_array = [];\n\tvar single_strength = null;\n\tvar single_strength_tooltip = null;\n\n\tsetTooltip();\n\n\tsetTimeout( function() {\n\t\tdoPing();\n\t}, 10000 );\n\tGlobal.signal_timer = setInterval( function() {\n\t\tdoPing();\n\t}, 60000 );\n\n\tfunction doPing() {\n\t\tif ( ( LocalCacheData.current_open_primary_controller && LocalCacheData.current_open_primary_controller.viewId === 'LoginView' ) || Global.idle_time >= Math.min( 15, APIGlobal.pre_login_data.session_idle_timeout / 60 ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tping( ServiceCaller.base_url + 'interface/ping.html?t=' + new Date().getTime(), function( time ) {\n\t\t\t$( '.signal-strength-empty' ).removeClass( 'signal-strength-empty' );\n\n\t\t\tif ( checking_array.length >= 3 ) {\n\t\t\t\tchecking_array.shift();\n\t\t\t}\n\t\t\tchecking_array.push( time );\n\t\t\tvar total_time = 0;\n\t\t\tfor ( var i = 0; i < checking_array.length; i++ ) {\n\t\t\t\ttotal_time = checking_array[i] + total_time;\n\t\t\t}\n\t\t\taverage_time = total_time / checking_array.length;\n\t\t\tDebug.Text( 'Current Ping: ' + time + 'ms Average: ' + average_time + 'ms Date: ' + ( new Date ).toISOString().replace( /z|t/gi, ' ' ), 'Global.js', '', 'doPing', 6 );\n\t\t\tGlobal.current_ping = average_time;\n\t\t\tstatus = $.i18n._( 'Good' );\n\t\t\t//do not allow signal strength variation in unit test mode\n\t\t\tif ( Global.UNIT_TEST_MODE == false ) {\n\t\t\t\tif ( average_time > 400 ) {\n\t\t\t\t\t$( '.signal-strength-pretty-strong' ).addClass( 'signal-strength-empty' );\n\t\t\t\t\t$( '.signal-strength-strong' ).addClass( 'signal-strength-empty' );\n\t\t\t\t\t$( '.signal-strength-weak' ).addClass( 'signal-strength-empty' );\n\t\t\t\t\tstatus = $.i18n._( 'Poor' );\n\t\t\t\t} else if ( average_time > 250 ) {\n\t\t\t\t\t$( '.signal-strength-pretty-strong' ).addClass( 'signal-strength-empty' );\n\t\t\t\t\t$( '.signal-strength-strong' ).addClass( 'signal-strength-empty' );\n\t\t\t\t\tstatus = $.i18n._( 'Below Average' );\n\t\t\t\t} else if ( average_time > 150 ) {\n\t\t\t\t\t$( '.signal-strength-pretty-strong' ).addClass( 'signal-strength-empty' );\n\t\t\t\t\tstatus = $.i18n._( 'Average' );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetTooltip();\n\n\t\t} );\n\t}\n\n\tfunction setTooltip() {\n\t\tvar html = '<div>' + $.i18n._( 'Your Network Connection is' ) + ' ' + status + ' (' + $.i18n._( 'Latency' ) + ': ' + ( average_time > 0 ? average_time.toFixed( 0 ) + 'ms' : $.i18n._( 'Calculating...' ) ) + ')' + '</div>';\n\t\t$( '.signal-strength' ).qtip( {\n\t\t\tid: 'single_strength',\n\t\t\tcontent: {\n\t\t\t\ttext: html\n\t\t\t},\n\t\t\tposition: {\n\t\t\t\tmy: 'bottom left',\n\t\t\t\tat: 'top right'\n\t\t\t}\n\t\t} );\n\t}\n\n\tfunction ping( url, callback ) {\n\t\tvar inUse, start, img, timer;\n\t\tif ( !inUse ) {\n\t\t\tinUse = true;\n\t\t\timg = new Image();\n\t\t\timg.onload = function() {\n\t\t\t\tvar endTime = new Date().getTime();\n\t\t\t\tinUse = false;\n\t\t\t\tcallback( ( endTime - start ) );\n\n\t\t\t};\n\t\t\timg.onerror = function( e ) {\n\t\t\t\tif ( inUse ) {\n\t\t\t\t\tinUse = false;\n\t\t\t\t\tvar endTime = new Date().getTime();\n\t\t\t\t\tcallback( ( endTime - start ) );\n\t\t\t\t}\n\n\t\t\t};\n\t\t\tstart = new Date().getTime();\n\t\t\timg.src = url;\n\t\t\ttimer = setTimeout( function() {\n\t\t\t\tif ( inUse ) {\n\t\t\t\t\tvar endTime = new Date().getTime();\n\t\t\t\t\tinUse = false;\n\t\t\t\t\tcallback( ( endTime - start ) );\n\t\t\t\t}\n\t\t\t}, 5000 );\n\t\t}\n\t}\n};\n\nGlobal.contentContainer = function() {\n\treturn $( '#contentContainer' );\n};\n\nGlobal.bodyWidth = function() {\n\treturn $( window ).width();\n};\n\nGlobal.bodyHeight = function() {\n\treturn $( window ).height();\n};\n\nGlobal.hasRequireLoaded = function( script_path ) {\n\tvar split_script_path = script_path.split( '/' );\n\n\tvar id = split_script_path[split_script_path.length - 1];\n\tid = id.replace( '.js', '' );\n\n\t//Check alternative script names (ie: with/without the .js) when a full path is specified to see if it was loaded in different ways with requireJS and make sure its not loaded twice.\n\tif ( script_path.indexOf( '.js' ) == -1 ) {\n\t\tvar alternative_script_path = script_path + '.js';\n\t} else {\n\t\tvar alternative_script_path = script_path.replace( '.js', '' );\n\t}\n\n\t//Make sure the function is both specified and defined. This helps cases where the user is on a Slow 3G network and double clicks Attendance -> In/Out.\n\t//  In this case the same InOutViewController.js file is in the process of being loaded, then is cancelled,\n\t//  and another one tries to load and the success callback where the class is instantiated is called before it can be instantiated, causing a JS exception (ReferenceError: InOutViewController is not defined).\n\t//  Better double-click prevention would also help.\n\t// if ( typeof require === 'function' && typeof require.specified === 'function' && ( require.specified( id ) || require.specified( script_path ) || require.specified( alternative_script_path ) ) ) {\n\t// if ( typeof require === 'function' && typeof require.defined === 'function' && ( require.defined( id ) || require.defined( script_path ) || require.defined( alternative_script_path ) ) ) {\n\t// \treturn true;\n\t// //}\n\n\treturn false;\n};\n\nGlobal.loadScript = function( scriptPath, onResult ) {\n\tif ( typeof scriptPath !== 'string' ) {\n\t\t// Not ideal fix but this is to handle the scriptPath.split is not a function error in #2696. if the path is not a string, split does not exist as a function.\n\t\t// Hard to find root-cause/reproduce, so this fix is to reduce the occurances of the JS exceptions related to it.\n\t\treturn false;\n\t}\n\n\tvar async = true;\n\tif ( typeof ( onResult ) === 'undefined' ) {\n\t\tasync = false;\n\t}\n\n\tif ( Global.hasRequireLoaded( scriptPath ) ) {\n\t\tif ( async ) {\n\t\t\tonResult();\n\t\t}\n\t\treturn true;\n\t}\n\n\t//Ensures that the js cached scripts are not loaded twice\n\tif ( async ) {\n\t\tif ( LocalCacheData.loadedScriptNames[scriptPath] ) {\n\t\t\tonResult();\n\t\t\treturn;\n\t\t}\n\t} else {\n\t\tif ( LocalCacheData.loadedScriptNames[scriptPath] ) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tvar successflag = false;\n\n\tvar realPath = scriptPath;\n\n\t// Mainly used in the async code, but put here to also catch duplicate declared classes in both async and synchronous calls.\n\tvar split_script_path = realPath.split( '/' );\n\tvar import_file_name = split_script_path[split_script_path.length - 1].replace( '.js', '' );\n\t//var import_path = realPath.replace('views/', '');\n\n\t//var class_exists = eval(\"typeof \"+ import_file_name +\" === 'function'\");\n\tvar class_exists = typeof window[import_file_name] === 'function';\n\tif ( class_exists ) {\n\t\t// This means class already exists on the window object, so it must have been already loaded.\n\t\t// DEV NOTE: This should NOT happen. If it happens, it means script is being loaded twice. Check manual loading calls like requirejs or Webpack MergeIntoSingleFilePlugin plugin\n\t\t// In all likelyhood, it is listed in the concatenation array for MergeIntoSingleFilePlugin. Best to try to remove it from there, as long as its correctly loaded on demand in all relevant places. See what else uses the class to be sure.\n\t\tGlobal.sendAnalyticsEvent( 'error:scriptload:duplicate_class', 'load', 'error:scriptload:duplicate:'+ scriptPath );\n\t\tDebug.Error( 'Duplicate class declaration: '+ import_file_name, 'Global.js', 'Global', 'loadScript', 1 );\n\t\treturn true;\n\t}\n\n\tif ( Global.url_offset ) {\n\t\trealPath = Global.getBaseURL( Global.url_offset + realPath );\n\t}\n\n\tif ( async ) {\n\t\tDebug.Text( 'ASYNC-LOADING: ' + scriptPath, 'Global.js', 'Global', 'loadScript', 10 );\n\n\t\tvar import_path;\n\t\tif ( scriptPath.indexOf('views') !== -1 ) {\n\t\t\timport_path = scriptPath.replace( 'views/', '' ).replace( '.js', '' ); // This is to ensure the variable in the dynamic webpack import() is a single variable rather than a full path.\n\t\t\timport( `@/views/${import_path}` ).then( ( module ) => {\n\t\t\t\tif ( module && module[import_file_name] ) {\n\t\t\t\t\twindow[import_file_name] = module[import_file_name]; // After html2js this may not be needed anymore. But leave for now as this allows the legacy html files to trigger the 'new MyViewController()' code in their html files.\n\n\t\t\t\t\tLocalCacheData.loadedScriptNames[scriptPath] = true;\n\t\t\t\t\tonResult();\n\t\t\t\t} else {\n\t\t\t\t\tif ( import_file_name === 'debugPanelController' ) {\n\t\t\t\t\t\t// debugPanel is coded different, with no classes/constructor, so this is not a fail.\n\t\t\t\t\t\tLocalCacheData.loadedScriptNames[scriptPath] = true;\n\t\t\t\t\t\tonResult();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Loading class failed.\n\t\t\t\t\t\t// If there is not an attribute matching the class on the module result, then this suggests a missing export on the class. There will also be a default attribute with an empty object to show no default classes exported.\n\t\t\t\t\t\tDebug.Error( 'Loading view class failed. Potential missing export for: ' + import_file_name, 'Global.js', 'Global', 'loadScript', 1 );\n\n\t\t\t\t\t\tonResult(); // To allow callbacks to work for non-module scripts like debugPanelController.\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} ).catch( Global.importErrorHandler );\n\t\t} else if ( scriptPath.indexOf('global/widgets') !== -1 ) {\n\t\t\tDebug.Text( 'SYNC-LOADING: ' + scriptPath, 'Global.js', 'Global', 'loadScript', 10 );\n\t\t\timport_path = scriptPath.replace('global/widgets/', '').replace( '.js', '' ); // This is to ensure the variable in the dynamic webpack import() is a single variable rather than a full path.\n\t\t\timport( `@/global/widgets/${import_path}` ).then( ( module ) => {\n\t\t\t\tif ( module && module[import_file_name] ) {\n\t\t\t\t\twindow[import_file_name] = module[import_file_name];\n\t\t\t\t\tLocalCacheData.loadedScriptNames[scriptPath] = true;\n\t\t\t\t\tonResult();\n\t\t\t\t} else {\n\t\t\t\t\t// Loading class failed.\n\t\t\t\t\t// If there is not an attribute matching the class on the module result, then this suggests a missing export on the class. There will also be a default attribute with an empty object to show no default classes exported.\n\t\t\t\t\t// This could also be a widget that is historically meant to load synchronously with the jQuery.ajax code further down. If this is the case, refactor the callback to load the widget syncronously instead.\n\t\t\t\t\tDebug.Error( 'Loading widget class failed. Potential missing export for: ' + import_file_name, 'Global.js', 'Global', 'loadScript', 1 );\n\t\t\t\t}\n\t\t\t} ).catch( Global.importErrorHandler );\n\t\t} else {\n\t\t\tDebug.Error( 'Loading class failed. Unhandled file type path request: '+ scriptPath, 'Global.js', 'Global', 'loadScript', 1 );\n\t\t}\n\n\t} else {\n\t\tvar calling_script = '';\n\t\tif ( LocalCacheData.current_open_primary_controller && LocalCacheData.current_open_primary_controller.viewId ) {\n\t\t\tcalling_script = ' from ' + LocalCacheData.current_open_primary_controller.viewId + 'ViewController';\n\t\t}\n\t\tDebug.Text( 'SYNC-LOADING: ' + scriptPath + calling_script );\n\n\t\tvar id = scriptPath.split( '/' );\n\t\tvar id = id[id.length - 1];\n\t\tid = id.replace( '.js', '' );\n\t\tif ( !window.badScripts ) {\n\t\t\twindow.badScripts = [];\n\t\t}\n\t\twindow.badScripts.push( id ); //When the page is done loading punch \"badScripts into the console to see a nice array of all the scripts that were not loaded async.\n\n\t\t/**\n\t\t * this seems to work, but causes the script erro at line 0 problem.\n\t\t * try to refactor to not use jquery.ajax\n\t\t */\n\t\tjQuery.ajax( {\n\t\t\tasync: false,\n\t\t\ttype: 'GET',\n\t\t\turl: realPath + '?v=' + APIGlobal.pre_login_data.application_build,\n\t\t\tcrossOrigin: false,\n\t\t\tdata: null,\n\t\t\tcache: true,\n\t\t\tsuccess: function() {\n\t\t\t\tsuccessflag = true;\n\t\t\t\tif ( async ) {\n\t\t\t\t\tLocalCacheData.loadedScriptNames[scriptPath] = true;\n\t\t\t\t\tonResult();\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function( jqXHR, textStatus, errorThrown ) {\n\t\t\t\tTAlertManager.showNetworkErrorAlert( jqXHR, textStatus, errorThrown );\n\t\t\t},\n\t\t\tdataType: 'script'\n\t\t} );\n\t}\n\n\tif ( !async ) {\n\t\tLocalCacheData.loadedScriptNames[scriptPath] = true;\n\t\treturn ( successflag );\n\t}\n\n};\n\nGlobal.importErrorHandler = function( error ) {\n\tif ( error.message.toLowerCase().includes( '404' ) || error.message.toLowerCase().includes( 'not found' ) || error.message.toLowerCase().includes( 'failed' ) || error.message.toLowerCase().includes( 'unknown' ) ) {\n\t\tif ( window.script_error_shown === undefined ) {\n\t\t\twindow.script_error_shown = 1;\n\t\t\t//There is no pretty errorbox at this time. You may only have basic javascript.\n\t\t\t//if ( confirm( 'Unable to download required data. Your internet connection may have failed. Click Ok to reload.' ) ) {\n\t\t\tif ( confirm( 'A new version of TimeTrex is available. Click OK to update and reload.' ) ) { //Hardcode name, as if a internet connection failure is occurring, might localcachedata might not be populated. Also unlikely to be able to translate this string.\n\t\t\t\t//For testing, so that there's time to turn internet back on after confirm is clicked.\n\t\t\t\t//window.setTimeout(function() {window.location.reload()},5000);\n\n\t\t\t\t//This can also happen if the user manually modifies the URL to be a bogus ViewId (ie: #!m=homeABC)\n\t\t\t\t//So try to redirect back to the home page first, otherwise try to do a browser reload.\n\t\t\t\tif ( ServiceCaller.root_url && APIGlobal.pre_login_data.base_url ) {\n\t\t\t\t\tGlobal.setURLToBrowser( ServiceCaller.root_url + APIGlobal.pre_login_data.base_url );\n\t\t\t\t} else {\n\t\t\t\t\twindow.location.reload();\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\tconsole.debug( error.message );\n\t\t//Stop error from bubbling up.\n\t\t// delete e; // commented out from old code as webpack complains about deleting local variable in strict mode.\n\t} else {\n\t\tDebug.Error( 'Error loading script during import(): ' + error, 'Global.js', 'Global', 'importErrorHandler', 1 );\n\t\t// Throw general error?\n\t}\n};\n\nGlobal.getRealImagePath = function( path ) {\n\n\tvar realPath = 'theme/' + Global.theme + '/' + path;\n\n\tif ( Global.url_offset ) {\n\t\trealPath = Global.url_offset + realPath;\n\t}\n\n\treturn realPath;\n};\n\nGlobal.getRibbonIconRealPath = function( icon ) {\n\tvar realPath = 'theme/' + Global.theme + '/css/global/widgets/ribbon/icons/' + icon;\n\n\tif ( Global.url_offset ) {\n\t\trealPath = Global.url_offset + realPath;\n\t}\n\n\treturn realPath;\n};\n\nGlobal.loadLanguage = function( name ) {\n\tvar successflag = false;\n\tvar message_id = TTUUID.generateUUID();\n\tProgressBar.showProgressBar( message_id );\n\tvar res_data = {};\n\n\tif ( LocalCacheData.getI18nDic() ) {\n\t\tProgressBar.removeProgressBar( message_id );\n\t\treturn LocalCacheData.getI18nDic();\n\t}\n\n\tvar realPath = '../locale/' + name + '/LC_MESSAGES/messages.json' + '?v=' + APIGlobal.pre_login_data.application_build;\n\n\tif ( Global.url_offset ) {\n\t\trealPath = Global.url_offset + realPath;\n\t}\n\n\tjQuery.ajax( {\n\t\tasync: false,\n\t\ttype: 'GET',\n\t\turl: realPath,\n\t\tdata: null,\n\t\tcache: true,\n\t\tconverters: {\n\t\t\t//Because this is a dataType: script, and jquery will blindy try to eval() any result returned by the server, including a HTML 404 error message.\n\t\t\t// resulting in\" Uncaught SyntaxError: Unexpected token < in  line 1\" being triggered.\n\t\t\t// Instead just return the raw result and eval() it in the success function ourselves instead.\n\t\t\t'text script': function( text ) {\n\t\t\t\treturn text;\n\t\t\t}\n\t\t},\n\t\tsuccess: function( result ) {\n\t\t\tif ( result.startsWith( 'i18n_dictionary' ) == true ) { //Check to make sure the text returned is actually a the javascript variable we are expecting and not some server error message.\n\t\t\t\tjQuery.globalEval( result );\n\t\t\t\tif ( window.i18n_dictionary !== undefined && Global.isObject( i18n_dictionary ) ) {\n\t\t\t\t\tsuccessflag = true;\n\t\t\t\t} else {\n\t\t\t\t\tDebug.Text( 'Unable to eval Locale dictionary: '+ name, 'Global.js', '', 'loadLanguage', 10 );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tDebug.Text( 'Unable to parse Locale: '+ name, 'Global.js', '', 'loadLanguage', 10 );\n\t\t\t}\n\t\t},\n\t\terror: function( jqXHR, textStatus, errorThrown ) {\n\t\t\t//Unable to load or parse i18n dictionary. Could be due to a 404 error?\n\t\t\tDebug.Text( 'Unable to load Locale: ' + errorThrown, 'Global.js', '', 'loadLanguage', 10 );\n\t\t\tsuccessflag = false;\n\t\t},\n\t\tdataType: 'script'\n\t} );\n\n\tProgressBar.removeProgressBar( message_id );\n\n\tif ( successflag ) {\n\t\tLocalCacheData.setI18nDic( i18n_dictionary );\n\t} else {\n\t\tDebug.Text( 'i18n Dictionary did not load for Locale: '+ name, 'Global.js', '', 'loadLanguage', 10 );\n\t\tLocalCacheData.setI18nDic( {} );\n\t}\n\n\treturn successflag;\n};\n\nGlobal.getProductEdition = function() {\n\tvar current_company_data = LocalCacheData.getCurrentCompany();\n\n\tif ( current_company_data && current_company_data.product_edition_id ) {\n\t\treturn current_company_data.product_edition_id;\n\t}\n\n\treturn 10; //Community\n};\n\nGlobal.setURLToBrowser = function( new_url ) {\n\tif ( new_url != window.location.href ) {\n\t\tDebug.Text( 'Changing URL to: ' + new_url, 'Global.js', 'Global', 'setURLToBrowser', 9 );\n\t\twindow.location = new_url;\n\t}\n};\n\nGlobal.clone = function( obj ) {\n\treturn jQuery.extend( true, {}, obj ); // true means deep clone, omit for shallow, false is not an option\n};\n\nGlobal.getFirstKeyFromObject = function( obj ) {\n\tfor ( var key in obj ) {\n\n\t\tif ( obj.hasOwnProperty( key ) ) {\n\t\t\treturn key;\n\t\t}\n\n\t}\n};\n\nGlobal.getFuncName = function( _callee ) {\n\tvar _text = _callee.toString();\n\tvar _scriptArr = document.scripts;\n\tfor ( var i = 0; i < _scriptArr.length; i++ ) {\n\t\tvar _start = _scriptArr[i].text.indexOf( _text );\n\t\tif ( _start !== -1 ) {\n\t\t\tif ( /^function\\s*\\(.*\\).*\\r\\n/.test( _text ) ) {\n\t\t\t\tvar _tempArr = _scriptArr[i].text.substr( 0, _start ).split( '\\r\\n' );\n\t\t\t\treturn _tempArr[( _tempArr.length - 1 )].replace( /(var)|(\\s*)/g, '' ).replace( /=/g, '' );\n\t\t\t} else {\n\t\t\t\treturn _text.match( /^function\\s*([^\\(]+).*\\r\\n/ )[1];\n\t\t\t}\n\t\t}\n\t}\n};\n\nGlobal.concatArraysUniqueWithSort = function( thisArray, otherArray ) {\n\tvar newArray = thisArray.concat( otherArray ).sort( function( a, b ) {\n\t\treturn a > b ? 1 : a < b ? -1 : 0;\n\t} );\n\n\treturn newArray.filter( function( item, index ) {\n\t\treturn newArray.indexOf( item ) === index;\n\t} );\n};\n\nGlobal.addCss = function( path, callback ) {\n\tif ( LocalCacheData.loadedScriptNames[path] ) {\n\t\tif ( callback ) {\n\t\t\tcallback();\n\t\t}\n\t\treturn true;\n\t}\n\tLocalCacheData.loadedScriptNames[path] = true;\n\tvar realPath = 'theme/' + Global.theme + '/css/' + path;\n\tif ( Global.url_offset ) {\n\t\trealPath = Global.url_offset + realPath;\n\t}\n\trealPath = realPath + '?v=' + APIGlobal.pre_login_data.application_build;\n\tGlobal.loadStyleSheet( realPath, callback );\n};\n\n//JS think 0 is false, so use this to get 0 correctly.\nGlobal.isFalseOrNull = function( object ) {\n\n\tif ( object === false || object === null || object === 0 || object === '0' || object == TTUUID.zero_id ) {\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n\n};\n\nGlobal.isSet = function( object ) {\n\n\tif ( _.isUndefined( object ) || _.isNull( object ) ) {\n\t\treturn false;\n\t} else {\n\t\treturn true;\n\t}\n\n};\n\nGlobal.getIconPathByContextName = function( id ) {\n\n\tswitch ( id ) {\n\t\tcase 'add':\n\t\t\treturn Global.getRealImagePath( 'css/global/widgets/ribbon/icons/copy-35x35.png' );\n\t}\n};\n\nGlobal.isEmpty = function( obj ) {\n\n\t// null and undefined are \"empty\"\n\tif ( obj === null ) {\n\t\treturn true;\n\t}\n\n\t// Assume if it has a length property with a non-zero value\n\t// that that property is correct.\n\tif ( obj.length > 0 ) {\n\t\treturn false;\n\t}\n\tif ( obj.length === 0 ) {\n\t\treturn true;\n\t}\n\n\t// Otherwise, does it have any properties of its own?\n\t// Note that this doesn't handle\n\t// toString and valueOf enumeration bugs in IE < 9\n\tfor ( var key in obj ) {\n\t\tif ( hasOwnProperty.call( obj, key ) ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n\n};\n\nGlobal.convertColumnsTojGridFormat = function( columns, layout_name, setWidthCallBack ) {\n\tvar column_info_array = [];\n\tvar len = columns.length;\n\n\tvar total_width = 0;\n\tfor ( var i = 0; i < len; i++ ) {\n\t\tvar view_column_data = columns[i];\n\t\tvar column_info;\n\n\t\tvar text_width = Global.calculateTextWidth( view_column_data.label );\n\n\t\ttotal_width = total_width + text_width;\n\n\t\tif ( view_column_data.label === '' ) {\n\t\t\tcolumn_info = {\n\t\t\t\tname: view_column_data.value,\n\t\t\t\tindex: view_column_data.value,\n\t\t\t\tlabel: view_column_data.label,\n\t\t\t\tkey: true,\n\t\t\t\twidth: 100,\n\t\t\t\tsortable: false,\n\t\t\t\thidden: true,\n\t\t\t\ttitle: false\n\t\t\t};\n\t\t} else if ( layout_name === 'global_sort_columns' ) {\n\n\t\t\tif ( view_column_data.value === 'sort' ) {\n\t\t\t\tcolumn_info = {\n\t\t\t\t\tname: view_column_data.value,\n\t\t\t\t\tindex: view_column_data.value,\n\t\t\t\t\tlabel: view_column_data.label,\n\t\t\t\t\twidth: 100,\n\t\t\t\t\tsortable: false,\n\t\t\t\t\tformatter: 'select',\n\t\t\t\t\teditable: true,\n\t\t\t\t\ttitle: false,\n\t\t\t\t\tedittype: 'select',\n\t\t\t\t\teditoptions: { value: 'asc:ASC;desc:DESC' }\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tcolumn_info = {\n\t\t\t\t\tname: view_column_data.value,\n\t\t\t\t\tindex: view_column_data.value,\n\t\t\t\t\tlabel: view_column_data.label,\n\t\t\t\t\twidth: 100,\n\t\t\t\t\tsortable: false,\n\t\t\t\t\ttitle: false\n\t\t\t\t};\n\t\t\t}\n\n\t\t} else {\n\t\t\tcolumn_info = {\n\t\t\t\tname: view_column_data.value,\n\t\t\t\tindex: view_column_data.value,\n\t\t\t\tlabel: view_column_data.label,\n\t\t\t\twidth: 100,\n\t\t\t\tsortable: false,\n\t\t\t\ttitle: false\n\t\t\t};\n\t\t}\n\n\t\tcolumn_info_array.push( column_info );\n\t}\n\n\tif ( setWidthCallBack ) {\n\t\tsetWidthCallBack( total_width );\n\t}\n\n\treturn column_info_array;\n};\n/* jshint ignore:start */\nGlobal.loadWidgetByName = function( widgetName, raw_text ) {\n\tvar input = false;\n\tvar widget_path = false;\n\tvar widget_constructor = false;\n\tvar raw_text = false;\n\tswitch ( widgetName ) {\n\t\tcase FormItemType.COLOR_PICKER:\n\t\t\tinput = $.fn.TColorPicker.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.FORMULA_BUILDER:\n\t\t\tinput = $.fn.FormulaBuilder.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.AWESOME_BOX:\n\t\t\tinput = $.fn.AComboBox.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.AWESOME_DROPDOWN:\n\t\t\tinput = $.fn.ADropDown.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.TEXT_INPUT:\n\t\t\tinput = $.fn.TTextInput.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.PASSWORD_INPUT:\n\t\t\tinput = $.fn.TPasswordInput.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.TEXT:\n\t\t\tinput = $.fn.TText.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.CHECKBOX:\n\t\t\tinput = $.fn.TCheckbox.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.COMBO_BOX:\n\t\t\tinput = $.fn.TComboBox.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.LIST: //Does not seem to be used anywhere.\n\t\t\tinput = $.fn.TList.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.TAG_INPUT:\n\t\t\tinput = $.fn.TTagInput.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.DATE_PICKER:\n\t\tcase FormItemType.RANGE_PICKER:\n\t\t\tinput = $.fn.TDatePicker.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.TIME_PICKER:\n\t\t\tinput = $.fn.TTimePicker.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.TEXT_AREA:\n\t\t\tinput = $.fn.TTextArea.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.TINYMCE_TEXT_AREA:\n\t\t\tinput = $.fn.TTextArea.tinymce_html_template;\n\t\t\traw_text = true;\n\t\t\tbreak;\n\t\tcase FormItemType.SEPARATED_BOX:\n\t\t\tinput = $.fn.SeparatedBox.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.IMAGE_BROWSER:\n\t\t\tinput = $.fn.TImageBrowser.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.FILE_BROWSER:\n\t\t\t//To show more of a custom file browser and text we set display: none on the actual file browser.\n\t\t\t//The visible custom file browser when clicked will trigger the hidden file browser to open.\n\t\t\tinput = `<div class=\"file-browser\">\n\t\t\t\t\t\t<img class=\"image\">\n\t\t\t\t\t\t<form enctype=\"multipart/form-data\" class=\"browser-form custom-file-browser\">\n\t\t\t\t\t\t\t<button class=\"p-button p-component tt-button\" type=\"button\"><span class=\"tticon tticon-add_black_24dp p-button-icon p-button-icon-left\"></span><span class=\"p-button-label\">Upload</span><span class=\"p-ink\"></span></button>\n\t\t\t\t\t\t\t<label for=\"file-browser\" class=\"file-browser-label\">${$.i18n._( 'or drag file here.' )}</label>\n\t\t\t\t\t\t\t<input name=\"file_data\" class=\"browser\" type=\"file\" style=\"display:none;\"/>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t</div>`;\n\t\t\tbreak;\n\t\tcase FormItemType.IMAGE_AVD_BROWSER:\n\t\t\tinput = $.fn.TImageAdvBrowser.html_template;\n\t\t\twidget_constructor = 'TImageAdvBrowser';\n\t\t\tbreak;\n\t\tcase FormItemType.CAMERA_BROWSER:\n\t\t\tinput = $.fn.CameraBrowser.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.IMAGE_CUT:\n\t\t\tinput = $.fn.TImageCutArea.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.IMAGE:\n\t\t\tinput = '<img class=\\'t-image\\'>';\n\t\t\tbreak;\n\t\tcase FormItemType.INSIDE_EDITOR:\n\t\t\tinput = $.fn.InsideEditor.html_template;\n\t\t\tbreak;\n\t\tcase WidgetNamesDic.PAGING:\n\t\t\t// widget_path = 'global/widgets/paging/Paging.html'; // TODO: #3023: Delete this line once all widget html converted and no longer need this quick reference for the old format.\n\t\t\tinput = $.fn.Paging2.html.paging;\n\t\t\tbreak;\n\t\tcase WidgetNamesDic.PAGING_2:\n\t\t\t// widget_path = 'global/widgets/paging/Paging2.html'; // TODO: #3023: Delete this line once all widget html converted and no longer need this quick reference for the old format.\n\t\t\tinput = $.fn.Paging2.html.paging2;\n\t\t\tbreak;\n\t\tcase WidgetNamesDic.ERROR_TOOLTIP:\n\t\t\tinput = $.fn.ErrorTipBox.html_template;\n\t\t\tbreak;\n\t\tcase FormItemType.FEEDBACK_BOX:\n\t\t\tinput = $.fn.TFeedback.html_template;\n\t\t\tbreak;\n\t\tcase WidgetNamesDic.EDIT_VIEW_FORM_ITEM: //There is no file browser JS file for this widget.\n\t\t\tinput = `\n\t\t\t<div class=\"edit-view-form-item-div\">\n\t\t\t\t<div class=\"edit-view-form-item-label-div\"><span class=\"edit-view-form-item-label\"></span></div>\n\t\t\t\t<div class=\"edit-view-form-item-input-div\"></div>\n\t\t\t</div>`;\n\t\t\tbreak;\n\t\tcase WidgetNamesDic.EDIT_VIEW_SUB_FORM_ITEM: //There is no file browser JS file for this widget.\n\t\t\tinput = `\n\t\t\t<div class=\"edit-view-form-item-div\">\n\t\t\t\t<div class=\"edit-view-form-item-sub-label-div\"><span class=\"edit-view-form-item-label\"></span></div>\n\t\t\t\t<div class=\"edit-view-form-item-input-div\"></div>\n\t\t\t</div>`;\n\t\t\tbreak;\n\t\tcase WidgetNamesDic.NO_RESULT_BOX:\n\t\t\tinput = $.fn.NoResultBox.html_template;\n\t\t\tbreak;\n\t\tcase WidgetNamesDic.VIEW_MIN_TAB:\n\t\t\tinput = $.fn.ViewMinTabBar.html.tab;\n\t\t\tbreak;\n\t\tcase WidgetNamesDic.VIEW_MIN_TAB_BAR:\n\t\t\tinput = $.fn.ViewMinTabBar.html.tab_bar;\n\t\t\tbreak;\n\t}\n\n\tif ( widget_path != false ) {\n\t\tinput = Global.loadWidget( widget_path );\n\t}\n\n\tif ( input && raw_text == true ) {\n\t\treturn input;\n\t} else {\n\t\t//#2571 - Error: Unable to get property 'indexOf' of undefined or null reference\n\t\tif ( input && input.indexOf( '<' ) != -1 ) {\n\t\t\tif ( !raw_text ) {\n\t\t\t\tinput = $( input );\n\n\t\t\t\tif ( widget_constructor && !input[widget_constructor] ) {\n\t\t\t\t\tvar error_string = $.i18n._( 'Class could not be found for' ) + ': ' + widgetName + '. ' + $.i18n._( 'Check that class is properly required.' );\n\t\t\t\t\tthrow( new Error( error_string ) );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t//See comment in Global.loadWidget() regarding return null return values.\n\t\t\tvar error_string = $.i18n._( 'Network error, failed to load' ) + ': ' + widgetName + ' ' + $.i18n._( 'Result' ) + ': \"' + input + '\"';\n\t\t\tTAlertManager.showNetworkErrorAlert( { status: 999 }, error_string, null ); //Show the user an error popoup.\n\t\t\tthrow( new Error( error_string ) ); //Halt execution and ensure that the email has a good error message because of failure of web server to provide the requested file.\n\t\t}\n\n\t\treturn input;\n\t}\n};\n\n/* jshint ignore:end */\n\nGlobal.loadWidget = function( url ) {\n\tif ( LocalCacheData.loadedWidgetCache[url] ) {\n\t\treturn ( LocalCacheData.loadedWidgetCache[url] );\n\t}\n\n\tvar realPath = url + '?v=' + APIGlobal.pre_login_data.application_build;\n\n\tif ( Global.url_offset ) {\n\t\trealPath = Global.url_offset + realPath;\n\t}\n\n\tvar message_id = TTUUID.generateUUID();\n\tProgressBar.showProgressBar( message_id );\n\tvar successflag = false;\n\tvar responseData = $.ajax( {\n\t\tasync: false,\n\t\ttype: 'GET',\n\t\turl: realPath,\n\t\tdata: null,\n\t\tcache: true,\n\t\tsuccess: function() {\n\t\t\tsuccessflag = true;\n\t\t},\n\t\terror: function( jqXHR, textStatus, errorThrown ) {\n\t\t\tTAlertManager.showNetworkErrorAlert( jqXHR, textStatus, errorThrown );\n\t\t}\n\t} );\n\n\tProgressBar.removeProgressBar( message_id );\n\t//Error: Uncaught ReferenceError: responseText is not defined in interface/html5/global/Global.js?v=9.0.2-20151106-092147 line 1747\n\t//  Upon further investigation (IRC discussions on #jQuery) it was suggested to stop using 'async: false' as that could be whats causing a null return value when we are expecting a jqXHR object.\n\t//  Since the ultimate goal is to refactor things so .html is embedded in the .js files anyways, may as well just wait for that.\n\tif ( !responseData ) {\n\t\treturn null;\n\t} else {\n\t\tLocalCacheData.loadedWidgetCache[url] = responseData.responseText;\n\t\treturn ( responseData.responseText );\n\t}\n\n};\n\nGlobal.removeCss = function( path ) {\n\tvar realPath = 'theme/' + Global.theme + '/css/' + path;\n\n\tif ( Global.url_offset ) {\n\t\trealPath = Global.url_offset + realPath;\n\t}\n\n\t$( 'link[href=\\'\\' + realPath + \\'?v=\\' + APIGlobal.pre_login_data.application_build + \\'\\']' ).remove();\n};\n\n/* jshint ignore:start */\n\nGlobal.getViewPathByViewId = function( viewId ) {\n\tvar path;\n\tswitch ( viewId ) {\n\t\t//Recruitment Portal\n\t\tcase 'GridTest':\n\t\tcase 'WidgetTest':\n\t\tcase 'AwesomeboxTest':\n\t\t\tpath = 'views/developer_tools/';\n\t\t\tbreak;\n\t\tcase 'MyProfile':\n\t\t\tpath = 'views/portal/hr/my_profile/';\n\t\t\tbreak;\n\t\tcase 'MyJobApplication':\n\t\t\tpath = 'views/portal/hr/my_jobapplication/';\n\t\t\tbreak;\n\t\tcase 'MyProfileEmployment':\n\t\t\tpath = 'views/portal/hr/my_profile/';\n\t\t\tbreak;\n\n\t\tcase 'Map':\n\t\t\tpath = 'views/attendance/map/';\n\t\t\tbreak;\n\t\tcase 'ManualTimeSheet':\n\t\t\tpath = 'views/attendance/manual_timesheet/';\n\t\t\tbreak;\n\t\tcase 'Home':\n\t\t\tpath = 'views/home/dashboard/';\n\t\t\tbreak;\n\t\tcase 'PortalJobVacancyDetail':\n\t\tcase 'PortalJobVacancy':\n\t\t\tpath = 'views/portal/hr/recruitment/';\n\t\t\tbreak;\n\t\tcase 'PortalLogin':\n\t\t\tpath = 'views/portal/login/';\n\t\t\tbreak;\n\t\tcase 'QuickPunchLogin':\n\t\t\tpath = 'views/quick_punch/login/';\n\t\t\tbreak;\n\t\tcase 'QuickPunch':\n\t\t\tpath = 'views/quick_punch/punch/';\n\t\t\tbreak;\n\t\tcase 'UserDateTotalParent':\n\t\tcase 'UserDateTotal':\n\t\t\tpath = 'views/attendance/timesheet/';\n\t\t\tbreak;\n\t\tcase 'Product':\n\t\t\tpath = 'views/invoice/products/';\n\t\t\tbreak;\n\t\tcase 'InvoiceDistrict':\n\t\t\tpath = 'views/invoice/district/';\n\t\t\tbreak;\n\t\tcase 'PaymentGateway':\n\t\t\tpath = 'views/invoice/payment_gateway/';\n\t\t\tbreak;\n\t\tcase 'InvoiceConfig':\n\t\t\tpath = 'views/invoice/settings/';\n\t\t\tbreak;\n\t\tcase 'ShippingPolicy':\n\t\t\tpath = 'views/invoice/shipping_policy/';\n\t\t\tbreak;\n\t\tcase 'AreaPolicy':\n\t\t\tpath = 'views/invoice/area_policy/';\n\t\t\tbreak;\n\t\tcase 'TaxPolicy':\n\t\t\tpath = 'views/invoice/tax_policy/';\n\t\t\tbreak;\n\t\tcase 'ClientGroup':\n\t\t\tpath = 'views/invoice/client_group/';\n\t\t\tbreak;\n\t\tcase 'ProductGroup':\n\t\t\tpath = 'views/invoice/product_group/';\n\t\t\tbreak;\n\t\tcase 'Exception':\n\t\t\tpath = 'views/attendance/exceptions/';\n\t\t\tbreak;\n\t\tcase 'Employee':\n\t\t\tpath = 'views/employees/employee/';\n\t\t\tbreak;\n\t\tcase 'RemittanceDestinationAccount':\n\t\t\tpath = 'views/employees/remittance_destination_account/';\n\t\t\tbreak;\n\t\tcase 'Wage':\n\t\t\tpath = 'views/company/wage/';\n\t\t\tbreak;\n\t\tcase 'Login':\n\t\t\tpath = 'views/login/';\n\t\t\tbreak;\n\t\tcase 'TimeSheet':\n\t\t\tpath = 'views/attendance/timesheet/';\n\t\t\tbreak;\n\t\tcase 'InOut':\n\t\t\tpath = 'views/attendance/in_out/';\n\t\t\tbreak;\n\t\tcase 'RecurringScheduleControl':\n\t\t\tpath = 'views/attendance/recurring_schedule_control/';\n\t\t\tbreak;\n\t\tcase 'RecurringScheduleTemplateControl':\n\t\t\tpath = 'views/attendance/recurring_schedule_template_control/';\n\t\t\tbreak;\n\t\tcase 'ScheduleShift':\n\t\tcase 'Schedule':\n\t\t\tpath = 'views/attendance/schedule/';\n\t\t\tbreak;\n\t\tcase 'Accrual':\n\t\t\tpath = 'views/attendance/accrual/';\n\t\t\tbreak;\n\t\tcase 'AccrualBalance':\n\t\t\tpath = 'views/attendance/accrual_balance/';\n\t\t\tbreak;\n\t\tcase 'Punches':\n\t\t\tpath = 'views/attendance/punches/';\n\t\t\tbreak;\n\t\tcase 'PunchTagGroup':\n\t\tcase 'PunchTag':\n\t\t\tpath = 'views/attendance/punch_tag/';\n\t\t\tbreak;\n\t\tcase 'JobGroup':\n\t\tcase 'Job':\n\t\t\tpath = 'views/attendance/job/';\n\t\t\tbreak;\n\t\tcase 'JobItemGroup':\n\t\tcase 'JobItem':\n\t\t\tpath = 'views/attendance/job_item/';\n\t\t\tbreak;\n\t\tcase 'JobItemAmendment':\n\t\t\tpath = 'views/attendance/job_item_amendment/';\n\t\t\tbreak;\n\t\tcase 'UserTitle':\n\t\t\tpath = 'views/employees/user_title/';\n\t\t\tbreak;\n\t\tcase 'UserContact':\n\t\t\tpath = 'views/employees/user_contact/';\n\t\t\tbreak;\n\t\tcase 'UserPreference':\n\t\t\tpath = 'views/employees/user_preference/';\n\t\t\tbreak;\n\t\tcase 'UserGroup':\n\t\t\tpath = 'views/employees/user_group/';\n\t\t\tbreak;\n\t\tcase 'Log':\n\t\t\tpath = 'views/core/log/';\n\t\t\tbreak;\n\t\tcase 'UserDefault':\n\t\t\tpath = 'views/employees/user_default/';\n\t\t\tbreak;\n\t\tcase 'ROE':\n\t\t\tpath = 'views/employees/roe/';\n\t\t\tbreak;\n\t\tcase 'Company':\n\t\t\tpath = 'views/company/company/';\n\t\t\tbreak;\n\t\tcase 'Companies':\n\t\t\tpath = 'views/company/companies/';\n\t\t\tbreak;\n\t\tcase 'PayPeriodSchedule':\n\t\t\tpath = 'views/payperiod/';\n\t\t\tbreak;\n\t\tcase 'PayPeriods':\n\t\t\tpath = 'views/payroll/pay_periods/';\n\t\t\tbreak;\n\t\tcase 'LegalEntity':\n\t\t\tpath = 'views/company/legal_entity/';\n\t\t\tbreak;\n\t\tcase 'PayrollRemittanceAgencyEvent':\n\t\tcase 'PayrollRemittanceAgency':\n\t\t\tpath = 'views/company/payroll_remittance_agency/';\n\t\t\tbreak;\n\t\tcase 'RemittanceSourceAccount':\n\t\t\tpath = 'views/company/remittance_source_account/';\n\t\t\tbreak;\n\t\tcase 'Branch':\n\t\t\tpath = 'views/company/branch/';\n\t\t\tbreak;\n\t\tcase 'GEOFence':\n\t\t\tpath = 'views/company/geo_fence/';\n\t\t\tbreak;\n\t\tcase 'Department':\n\t\t\tpath = 'views/company/department/';\n\t\t\tbreak;\n\t\tcase 'HierarchyControl':\n\t\t\tpath = 'views/company/hierarchy_control/';\n\t\t\tbreak;\n\t\tcase 'WageGroup':\n\t\t\tpath = 'views/company/wage_group/';\n\t\t\tbreak;\n\t\tcase 'EthnicGroup':\n\t\t\tpath = 'views/company/ethnic_group/';\n\t\t\tbreak;\n\t\tcase 'Currency':\n\t\tcase 'CurrencyRate':\n\t\t\tpath = 'views/company/currency/';\n\t\t\tbreak;\n\t\tcase 'PermissionControl':\n\t\t\tpath = 'views/company/permission_control/';\n\t\t\tbreak;\n\t\tcase 'CustomField':\n\t\t\tpath = 'views/company/custom_field/';\n\t\t\tbreak;\n\t\tcase 'Station':\n\t\t\tpath = 'views/company/station/';\n\t\t\tbreak;\n\t\tcase 'PayStub':\n\t\t\tpath = 'views/payroll/pay_stub/';\n\t\t\tbreak;\n\t\tcase 'PayStubTransaction':\n\t\t\tpath = 'views/payroll/pay_stub_transaction/';\n\t\t\tbreak;\n\t\tcase 'GovernmentDocument':\n\t\t\tpath = 'views/payroll/government_document/';\n\t\t\tbreak;\n\t\tcase 'Request':\n\t\t\tpath = 'views/my_account/request/';\n\t\t\tbreak;\n\t\tcase 'ChangePassword':\n\t\t\tpath = 'views/my_account/password/';\n\t\t\tbreak;\n\t\tcase 'RequestAuthorization':\n\t\t\tpath = 'views/my_account/request_authorization/';\n\t\t\tbreak;\n\t\tcase 'TimeSheetAuthorization':\n\t\t\tpath = 'views/my_account/timesheet_authorization/';\n\t\t\tbreak;\n\t\tcase 'MessageControl':\n\t\t\tpath = 'views/my_account/message_control/';\n\t\t\tbreak;\n\t\tcase 'Notification':\n\t\t\tpath = 'views/my_account/notification/';\n\t\t\tbreak;\n\t\tcase 'LoginUserContact':\n\t\t\tpath = 'views/my_account/user_contact/';\n\t\t\tbreak;\n\t\tcase 'LoginUserPreference':\n\t\t\tpath = 'views/my_account/user_preference/';\n\t\t\tbreak;\n\t\tcase 'LoginUserExpense':\n\t\tcase 'ExpenseAuthorization':\n\t\t\tpath = 'views/my_account/expense/';\n\t\t\tbreak;\n\t\tcase 'PayStubAmendment':\n\t\t\tpath = 'views/payroll/pay_stub_amendment/';\n\t\t\tbreak;\n\t\tcase 'RecurringPayStubAmendment':\n\t\t\tpath = 'views/payroll/recurring_pay_stub_amendment/';\n\t\t\tbreak;\n\t\tcase 'PayStubEntryAccount':\n\t\t\tpath = 'views/payroll/pay_stub_entry_account/';\n\t\t\tbreak;\n\t\tcase 'CompanyTaxDeduction':\n\t\t\tpath = 'views/payroll/company_tax_deduction/';\n\t\t\tbreak;\n\t\tcase 'UserExpense':\n\t\t\tpath = 'views/payroll/user_expense/';\n\t\t\tbreak;\n\t\tcase 'PolicyGroup':\n\t\t\tpath = 'views/policy/policy_group/';\n\t\t\tbreak;\n\t\tcase 'PayCode':\n\t\t\tpath = 'views/policy/pay_code/';\n\t\t\tbreak;\n\t\tcase 'PayFormulaPolicy':\n\t\t\tpath = 'views/policy/pay_formula_policy/';\n\t\t\tbreak;\n\t\tcase 'ContributingPayCodePolicy':\n\t\t\tpath = 'views/policy/contributing_pay_code_policy/';\n\t\t\tbreak;\n\t\tcase 'ContributingShiftPolicy':\n\t\t\tpath = 'views/policy/contributing_shift_policy/';\n\t\t\tbreak;\n\t\tcase 'RoundIntervalPolicy':\n\t\t\tpath = 'views/policy/round_interval_policy/';\n\t\t\tbreak;\n\t\tcase 'MealPolicy':\n\t\t\tpath = 'views/policy/meal_policy/';\n\t\t\tbreak;\n\t\tcase 'BreakPolicy':\n\t\t\tpath = 'views/policy/break_policy/';\n\t\t\tbreak;\n\t\tcase 'RegularTimePolicy':\n\t\t\tpath = 'views/policy/regular_time_policy/';\n\t\t\tbreak;\n\t\tcase 'ExpensePolicy':\n\t\t\tpath = 'views/policy/expense_policy/';\n\t\t\tbreak;\n\t\tcase 'OvertimePolicy':\n\t\t\tpath = 'views/policy/overtime_policy/';\n\t\t\tbreak;\n\t\tcase 'AbsencePolicy':\n\t\t\tpath = 'views/policy/absence_policy/';\n\t\t\tbreak;\n\t\tcase 'PremiumPolicy':\n\t\t\tpath = 'views/policy/premium_policy/';\n\t\t\tbreak;\n\t\tcase 'ExceptionPolicyControl':\n\t\t\tpath = 'views/policy/exception_policy/';\n\t\t\tbreak;\n\n\t\tcase 'RecurringHoliday':\n\t\t\tpath = 'views/policy/recurring_holiday/';\n\t\t\tbreak;\n\t\tcase 'HolidayPolicy':\n\t\t\tpath = 'views/policy/holiday_policy/';\n\t\t\tbreak;\n\t\tcase 'Holiday':\n\t\t\tpath = 'views/policy/holiday/';\n\t\t\tbreak;\n\t\tcase 'SchedulePolicy':\n\t\t\tpath = 'views/policy/schedule_policy/';\n\t\t\tbreak;\n\t\tcase 'AccrualPolicy':\n\t\tcase 'AccrualPolicyAccount':\n\t\tcase 'AccrualPolicyUserModifier':\n\t\t\tpath = 'views/policy/accrual_policy/';\n\t\t\tbreak;\n\t\tcase 'DocumentRevision':\n\t\tcase 'Document':\n\t\tcase 'DocumentGroup':\n\t\t\tpath = 'views/document/';\n\t\t\tbreak;\n\t\tcase 'About':\n\t\t\tpath = 'views/help/';\n\t\t\tbreak;\n\t\tcase 'ActiveShiftReport':\n\t\t\tpath = 'views/reports/whos_in_summary/';\n\t\t\tbreak;\n\t\tcase 'UserSummaryReport':\n\t\t\tpath = 'views/reports/employee_information/';\n\t\t\tbreak;\n\t\tcase 'SavedReport':\n\t\t\tpath = 'views/reports/saved_report/';\n\t\t\tbreak;\n\t\tcase 'ReportSchedule':\n\t\t\tpath = 'views/reports/report_schedule/';\n\t\t\tbreak;\n\t\tcase 'ScheduleSummaryReport':\n\t\t\tpath = 'views/reports/schedule_summary/';\n\t\t\tbreak;\n\t\tcase 'TimeSheetSummaryReport':\n\t\tcase 'TimesheetSummaryReport':\n\t\t\tpath = 'views/reports/timesheet_summary/';\n\t\t\tbreak;\n\t\tcase 'TimesheetDetailReport':\n\t\t\tpath = 'views/reports/timesheet_detail/';\n\t\t\tbreak;\n\t\tcase 'PunchSummaryReport':\n\t\t\tpath = 'views/reports/punch_summary/';\n\t\t\tbreak;\n\t\tcase 'ExceptionSummaryReport':\n\t\t\tpath = 'views/reports/exception_summary/';\n\t\t\tbreak;\n\t\tcase 'PayStubTransactionSummaryReport':\n\t\t\tpath = 'views/reports/pay_stub_transaction_summary/';\n\t\t\tbreak;\n\t\tcase 'PayStubSummaryReport':\n\t\t\tpath = 'views/reports/pay_stub_summary/';\n\t\t\tbreak;\n\t\tcase 'KPI':\n\t\tcase 'KPIGroup':\n\t\tcase 'UserReviewControl':\n\t\t\tpath = 'views/hr/kpi/';\n\t\t\tbreak;\n\t\tcase 'QualificationGroup':\n\t\tcase 'Qualification':\n\t\tcase 'UserSkill':\n\t\tcase 'UserEducation':\n\t\tcase 'UserMembership':\n\t\tcase 'UserLicense':\n\t\tcase 'UserLanguage':\n\t\t\tpath = 'views/hr/qualification/';\n\t\t\tbreak;\n\t\tcase 'JobApplication':\n\t\tcase 'JobVacancy':\n\t\tcase 'JobApplicant':\n\t\tcase 'JobApplicantEmployment':\n\t\tcase 'JobApplicantReference':\n\t\tcase 'JobApplicantLocation':\n\t\tcase 'JobApplicantSkill':\n\t\tcase 'JobApplicantEducation':\n\t\tcase 'JobApplicantMembership':\n\t\tcase 'JobApplicantLicense':\n\t\tcase 'JobApplicantLanguage':\n\t\tcase 'RecruitmentPortalConfig':\n\t\t\tpath = 'views/hr/recruitment/';\n\t\t\tbreak;\n\t\tcase 'PayrollExportReport':\n\t\t\tpath = 'views/reports/payroll_export/';\n\t\t\tbreak;\n\t\tcase 'GeneralLedgerSummaryReport':\n\t\t\tpath = 'views/reports/general_ledger_summary/';\n\t\t\tbreak;\n\t\tcase 'ExpenseSummaryReport':\n\t\t\tpath = 'views/reports/expense_summary/';\n\t\t\tbreak;\n\t\tcase 'AccrualBalanceSummaryReport':\n\t\t\tpath = 'views/reports/accrual_balance_summary/';\n\t\t\tbreak;\n\t\tcase 'JobSummaryReport':\n\t\t\tpath = 'views/reports/job_summary/';\n\t\t\tbreak;\n\t\tcase 'JobAnalysisReport':\n\t\t\tpath = 'views/reports/job_analysis/';\n\t\t\tbreak;\n\t\tcase 'JobInformationReport':\n\t\t\tpath = 'views/reports/job_info/';\n\t\t\tbreak;\n\t\tcase 'JobItemInformationReport':\n\t\t\tpath = 'views/reports/job_item_info/';\n\t\t\tbreak;\n\t\tcase 'InvoiceTransactionSummaryReport':\n\t\t\tpath = 'views/reports/invoice_transaction_summary/';\n\t\t\tbreak;\n\t\tcase 'RemittanceSummaryReport':\n\t\t\tpath = 'views/reports/remittance_summary/';\n\t\t\tbreak;\n\t\tcase 'T4SummaryReport':\n\t\t\tpath = 'views/reports/t4_summary/';\n\t\t\tbreak;\n\t\tcase 'T4ASummaryReport':\n\t\t\tpath = 'views/reports/t4a_summary/';\n\t\t\tbreak;\n\t\tcase 'TaxSummaryReport':\n\t\t\tpath = 'views/reports/tax_summary/';\n\t\t\tbreak;\n\t\tcase 'Form940Report':\n\t\t\tpath = 'views/reports/form940/';\n\t\t\tbreak;\n\t\tcase 'Form941Report':\n\t\t\tpath = 'views/reports/form941/';\n\t\t\tbreak;\n\t\tcase 'Form1099NecReport':\n\t\t\tpath = 'views/reports/form1099/';\n\t\t\tbreak;\n\t\tcase 'FormW2Report':\n\t\t\tpath = 'views/reports/formw2/';\n\t\t\tbreak;\n\t\tcase 'USStateUnemploymentReport':\n\t\t\tpath = 'views/reports/us_state_unemployment/';\n\t\t\tbreak;\n\t\tcase 'USPERSReport':\n\t\t\tpath = 'views/reports/us_pers/';\n\t\t\tbreak;\n\t\tcase 'USEEOReport':\n\t\t\tpath = 'views/reports/us_eeo/';\n\t\t\tbreak;\n\t\tcase 'AffordableCareReport':\n\t\t\tpath = 'views/reports/affordable_care/';\n\t\t\tbreak;\n\t\tcase 'UserQualificationReport':\n\t\t\tpath = 'views/reports/qualification_summary/';\n\t\t\tbreak;\n\t\tcase 'KPIReport':\n\t\t\tpath = 'views/reports/review_summary/';\n\t\t\tbreak;\n\t\tcase 'UserRecruitmentSummaryReport':\n\t\t\tpath = 'views/reports/recruitment_summary/';\n\t\t\tbreak;\n\t\tcase 'UserRecruitmentDetailReport':\n\t\t\tpath = 'views/reports/recruitment_detail/';\n\t\t\tbreak;\n\t\tcase 'Client':\n\t\t\tpath = 'views/invoice/client/';\n\t\t\tbreak;\n\t\tcase 'ClientContact':\n\t\t\tpath = 'views/invoice/client_contact/';\n\t\t\tbreak;\n\t\tcase 'ClientPayment':\n\t\t\tpath = 'views/invoice/client_payment/';\n\t\t\tbreak;\n\t\tcase 'InvoiceTransaction':\n\t\t\tpath = 'views/invoice/invoice_transaction/';\n\t\t\tbreak;\n\t\tcase 'Invoice':\n\t\t\tpath = 'views/invoice/invoice/';\n\t\t\tbreak;\n\t\tcase 'CustomColumn':\n\t\t\tpath = 'views/reports/custom_column/';\n\t\t\tbreak;\n\t\tcase 'AuditTrailReport':\n\t\t\tpath = 'views/reports/audittrail/';\n\t\t\tbreak;\n\t\tcase 'ReCalculateTimeSheetWizard':\n\t\t\tpath = 'views/wizard/re_calculate_timesheet/';\n\t\t\tbreak;\n\t\tcase 'GeneratePayStubWizard':\n\t\t\tpath = 'views/wizard/generate_pay_stub/';\n\t\t\tbreak;\n\t\tcase 'UserGenericStatus':\n\t\t\tpath = 'views/wizard/user_generic_data_status/';\n\t\t\tbreak;\n\t\tcase 'ProcessPayrollWizard':\n\t\t\tpath = 'views/wizard/process_payroll/';\n\t\t\tbreak;\n\t\tcase 'PayrollRemittanceAgencyEventWizardController':\n\t\t\tpath = 'views/payroll/remittance_wizard/';\n\t\t\tbreak;\n\t\tcase 'ProcessTransactionsWizardController':\n\t\t\tpath = 'views/payroll/process_transactions_wizard/';\n\t\t\tbreak;\n\t\tcase 'ImportCSVWizard':\n\t\t\tpath = 'views/wizard/import_csv/';\n\t\t\tbreak;\n\t\tcase 'JobInvoiceWizard':\n\t\t\tpath = 'views/wizard/job_invoice/';\n\t\t\tbreak;\n\t\tcase 'LoginUserWizard':\n\t\tcase 'LoginUser':\n\t\t\tpath = 'views/wizard/login_user/';\n\t\t\tbreak;\n\t\tcase 'QuickStartWizard':\n\t\t\tpath = 'views/wizard/quick_start/';\n\t\t\tbreak;\n\t\tcase 'UserPhotoWizard':\n\t\t\tpath = 'views/wizard/user_photo/';\n\t\t\tbreak;\n\t\tcase 'FindAvailableWizard':\n\t\tcase 'FindAvailable':\n\t\t\tpath = 'views/wizard/find_available/';\n\t\t\tbreak;\n\t\tcase 'PermissionWizard':\n\t\t\tpath = 'views/wizard/permission_wizard/';\n\t\t\tbreak;\n\t\tcase 'FormulaBuilderWizard':\n\t\t\tpath = 'views/wizard/formula_builder_wizard/';\n\t\t\tbreak;\n\t\tcase 'ReCalculateAccrualWizard':\n\t\t\tpath = 'views/wizard/re_calculate_accrual/';\n\t\t\tbreak;\n\t\tcase 'ResetPasswordWizard':\n\t\t\tpath = 'views/wizard/reset_password/';\n\t\t\tbreak;\n\t\tcase 'ShareReportWizard':\n\t\t\tpath = 'views/wizard/share_report/';\n\t\t\tbreak;\n\t\tcase 'PayCodeWizard':\n\t\t\tpath = 'views/wizard/pay_code/';\n\t\t\tbreak;\n\t\tcase 'InstallWizard':\n\t\t\tpath = 'views/wizard/install/';\n\t\t\tbreak;\n\t\tcase 'PayStubAccountWizard':\n\t\t\tpath = 'views/wizard/pay_stub_account/';\n\t\t\tbreak;\n\t\tcase 'DashletWizard':\n\t\t\tpath = 'views/wizard/dashlet/';\n\t\t\tbreak;\n\t\tcase 'ReportViewWizard':\n\t\t\tpath = 'views/wizard/report_view/';\n\t\t\tbreak;\n\t\tcase 'PortalApplyJobWizard':\n\t\t\tpath = 'views/wizard/portal_apply_job/';\n\t\t\tbreak;\n\t\tcase 'ForgotPasswordWizard':\n\t\t\tpath = 'views/wizard/forgot_password/';\n\t\t\tbreak;\n\t\tcase 'ResetForgotPasswordWizard':\n\t\t\tpath = 'views/wizard/reset_forgot_password/';\n\t\t\tbreak;\n\t\tcase 'DeveloperTools':\n\t\t\tpath = 'views/developer_tools/';\n\t\t\tbreak;\n\t\tcase 'UIKitSample':\n\t\tcase 'UIKitChildSample':\n\t\t\tpath = 'views/ui_kit_sample/';\n\t\t\tbreak;\n\t}\n\treturn path;\n};\n/* jshint ignore:end */\n\n//returns exact filepaths for class dependencies\nGlobal.getViewPreloadPathByViewId = function( viewId ) {\n\t// DEPRECATED: Moved the loading of these preloads to post-login-main_ui-dependancies.js\n\n\tvar preloads = [];\n\t// switch ( viewId ) {\n\t// \tcase 'Request':\n\t// \tcase 'RequestAuthorization':\n\t// \t\tpreloads = ['views/common/AuthorizationHistoryCommon.js', 'views/common/RequestViewCommonController.js', 'views/common/EmbeddedMessageCommon.js'];\n\t// \t\tbreak;\n\t// \tcase 'ExpenseAuthorization':\n\t// \tcase 'UserExpense':\n\t// \tcase 'LoginUserExpense':\n\t// \tcase 'TimeSheetAuthorization':\n\t// \t\tpreloads = ['views/common/AuthorizationHistoryCommon.js'];\n\t// \t\tbreak;\n\t// }\n\treturn preloads;\n};\n\nGlobal.removeViewCss = function( viewId, fileName ) {\n\tGlobal.removeCss( Global.getViewPathByViewId( viewId ) + fileName );\n};\n\nGlobal.sanitizeViewId = function( viewId ) {\n\tif ( typeof viewId === 'string' || viewId instanceof String ) {\n\t\treturn viewId.replace( '/', '' ).replace( '\\\\', '' );\n\t}\n\n\treturn viewId;\n};\n\nGlobal.loadViewSource = function( viewId, fileName, onResult, sync ) {\n\tvar viewId = Global.sanitizeViewId( viewId );\n\tvar path = Global.getViewPathByViewId( viewId );\n\n\tif ( fileName.indexOf( '.js' ) > 0 ) {\n\t\tvar preloads = Global.getViewPreloadPathByViewId( viewId );\n\t\tif ( preloads.length > 0 ) {\n\t\t\tfor ( var p in preloads ) {\n\t\t\t\tGlobal.loadScript( preloads[p] );\n\t\t\t}\n\t\t}\n\n\t\tif ( path ) {\n\t\t\tif ( sync ) {\n\t\t\t\treturn Global.loadScript( path + fileName );\n\t\t\t} else {\n\t\t\t\tGlobal.loadScript( path + fileName, onResult );\n\t\t\t}\n\t\t} else {\n\t\t\t//Invalid viewId, redirect to home page?\n\t\t\tconsole.debug( 'View does not exist! ViewId: ' + viewId + ' File Name: ' + fileName );\n\t\t\tif ( ServiceCaller.root_url && APIGlobal.pre_login_data.base_url ) {\n\t\t\t\tGlobal.setURLToBrowser( ServiceCaller.root_url + APIGlobal.pre_login_data.base_url );\n\t\t\t}\n\t\t}\n\n\t} else if ( fileName.indexOf( '.css' ) > 0 ) {\n\t\tGlobal.addCss( path + fileName );\n\t} else {\n\t\tif ( path ) {\n\t\t\t// HTML2JS\n\t\t\tvar template_type = HtmlTemplatesGlobal.getTemplateTypeFromFilename( fileName );\n\t\t\tvar template_options = HtmlTemplatesGlobal.getTemplateOptionsFromViewId( viewId );\n\n\t\t\tif( template_type === TemplateType.INLINE_HTML ) {\n\t\t\t\ttemplate_options.filename = fileName; // Needed by HtmlTemplates.checkViewClassForInlineHtmlbyFilename() which uses filename, not view id.\n\t\t\t}\n\t\t\tif ( sync ) {\n\t\t\t\t// Note: for #HTML2JS This path is taken for things such as: CompanyInformation, CompanyEditView.html, and general edit views.\n\n\t\t\t\t// Check if we should use the new templating logic, or legacy html load.\n\t\t\t\tif( template_type !== TemplateType.LEGACY_HTML ) {\n\t\t\t\t\t// Use new HTML2JS template class\n\t\t\t\t\treturn HtmlTemplatesGlobal.getTemplate( template_type, template_options, null ); // no onResult, as its syncronous.\n\t\t\t\t} else {\n\t\t\t\t\t// Legacy html file load for syncronous files.\n\t\t\t\t\treturn Global.loadPageSync( path + fileName );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Check if we should use the new templating logic, or legacy html load.\n\t\t\t\tif( template_type !== TemplateType.LEGACY_HTML ) {\n\t\t\t\t\t// Use new HTML2JS template class\n\t\t\t\t\tHtmlTemplatesGlobal.getTemplate( template_type, template_options, onResult );\n\t\t\t\t} else {\n\t\t\t\t\t// Legacy html file load\n\t\t\t\t\tGlobal.loadPage( path + fileName, onResult );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t//Invalid viewId, redirect to home page?\n\t\t\tconsole.debug( 'View does not exist! ViewId: ' + viewId + ' File Name: ' + fileName );\n\t\t\tif ( ServiceCaller.root_url && APIGlobal.pre_login_data.base_url ) {\n\t\t\t\tGlobal.setURLToBrowser( ServiceCaller.root_url + APIGlobal.pre_login_data.base_url );\n\t\t\t}\n\t\t}\n\t}\n};\n\nGlobal.loadPageSync = function( url ) {\n\n\tvar realPath = url + '?v=' + APIGlobal.pre_login_data.application_build;\n\n\tif ( Global.url_offset ) {\n\t\trealPath = Global.url_offset + realPath;\n\t}\n\tvar message_id = TTUUID.generateUUID();\n\tProgressBar.showProgressBar( message_id );\n\tvar successflag = false;\n\tvar responseData = $.ajax( {\n\t\tasync: false,\n\t\ttype: 'GET',\n\t\turl: realPath,\n\t\tdata: null,\n\t\tcache: true,\n\t\tsuccess: function() {\n\t\t\tsuccessflag = true;\n\t\t},\n\n\t\terror: function( jqXHR, textStatus, errorThrown ) {\n\t\t\tTAlertManager.showNetworkErrorAlert( jqXHR, textStatus, errorThrown );\n\t\t}\n\t} );\n\n\tProgressBar.removeProgressBar( message_id );\n\n\treturn ( responseData.responseText );\n\n};\n\nGlobal.loadPage = function( url, onResult ) {\n\n\tvar realPath = url + '?v=' + APIGlobal.pre_login_data.application_build;\n\tvar message_id = TTUUID.generateUUID();\n\tif ( Global.url_offset ) {\n\t\trealPath = Global.url_offset + realPath;\n\t}\n\n\tProgressBar.showProgressBar( message_id );\n\t$.ajax( {\n\t\tasync: true,\n\t\ttype: 'GET',\n\t\turl: realPath,\n\t\tdata: null,\n\t\tcache: true,\n\t\tsuccess: function( result ) {\n\t\t\tProgressBar.removeProgressBar( message_id );\n\t\t\tonResult( result );\n\t\t},\n\t\terror: function( jqXHR, textStatus, errorThrown ) {\n\t\t\tTAlertManager.showNetworkErrorAlert( jqXHR, textStatus, errorThrown );\n\t\t}\n\t} );\n\n};\n\nGlobal.getRootURL = function( url ) {\n\tif ( !url ) {\n\t\turl = location.href;\n\t}\n\n\t//Rather than parse the URL ourselves, lets use the URL API and build it back up from its components.\n\tvar url_obj = new URL( url );\n\tvar retval = url_obj.protocol + '//' + url_obj.host;\n\n\treturn retval;\n};\n\nGlobal.getBaseURL = function( url_relative_path, include_search = true, include_hash = false ) {\n\t//Rather than parse the URL ourselves, lets use the URL API and build it back up from its components.\n\tvar url_obj = new URL( location.href );\n\tvar retval = url_obj.protocol + '//' + url_obj.host + url_obj.pathname;\n\n\t//Resolve any specified relative path here, so we can append the search component of the URL after.\n\t//  This is needed for the recruitment portal to work if Facebook or some other 3rd party appends search components on the URL, ie: ?test=1#!m=PortalJobVacancyDetail&id=05a45d0b-b982-2a1f-2003-21ea65522bf3&company_id=ABC\n\tif ( url_relative_path ) {\n\t\tretval = new URL( url_relative_path, retval ).href;\n\t}\n\n\tif ( include_search == true ) {\n\t\tretval += url_obj.search; //Can't put the search component back on when getting BaseURL.\n\t}\n\tif ( include_hash == true ) {\n\t\tretval += url_obj.hash;\n\t}\n\n\n\treturn retval;\n};\n\nGlobal.isArrayAndHasItems = function( object ) {\n\n\tif ( $.type( object ) === 'array' && object.length > 0 ) {\n\t\treturn true;\n\t}\n\n\treturn false;\n\n};\n\nGlobal.isValidInputCodes = function( keyCode ) {\n\tvar result = true;\n\tswitch ( keyCode ) {\n\t\tcase 9:\n\t\tcase 16:\n\t\tcase 17:\n\t\tcase 18:\n\t\tcase 19:\n\t\tcase 20:\n\t\tcase 33:\n\t\tcase 34:\n\t\t// case 37:\n\t\t// case 38:\n\t\t// case 39:\n\t\t// case 40:\n\t\tcase 45:\n\t\tcase 91:\n\t\tcase 92:\n\t\tcase 93:\n\t\t\tresult = false;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tif ( keyCode >= 112 && keyCode <= 123 ) {\n\t\t\t\tresult = false;\n\t\t\t}\n\t}\n\treturn result;\n};\n\n/* jshint ignore:start */\nGlobal.convertLayoutFilterToAPIFilter = function( layout ) {\n\tvar convert_filter_data = {};\n\n\tif ( !layout ) {\n\t\treturn null;\n\t}\n\n\tvar filter_data = layout.data.filter_data;\n\n\tif ( !filter_data ) {\n\t\treturn null;\n\t}\n\n\t$.each( filter_data, function( key, content ) {\n\t\t// Cannot read property 'value' of undefined\n\t\tif ( !content ) {\n\t\t\treturn;//continue;\n\t\t}\n\t\tif ( ( content.value instanceof Array && content.value.length > 0 ) || ( content.value instanceof Object ) ) {\n\t\t\tvar values = [];\n\t\t\tvar obj = content.value;\n\t\t\tif ( content.value instanceof Array ) {\n\n\t\t\t\tvar len = content.value.length;\n\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\n\t\t\t\t\tif ( Global.isSet( content.value[i].value ) ) {\n\t\t\t\t\t\tvalues.push( content.value[i].value ); //Options,\n\t\t\t\t\t} else if ( content.value[i].id || content.value[i].id === 0 || content.value[i].id === '0' ) {\n\t\t\t\t\t\tvalues.push( content.value[i].id ); //Awesomebox\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalues.push( content.value[i] ); // default_filter_data_for_next_view\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tconvert_filter_data[key] = values;\n\t\t\t\t//only add search filter which not equal to false, see if this cause any bugs\n\t\t\t} else if ( content.value instanceof Object ) {\n\t\t\t\tvar final_value = '';\n\t\t\t\tif ( Global.isSet( content.value.value ) ) {\n\t\t\t\t\tfinal_value = content.value.value; //Options,\n\t\t\t\t} else if ( content.value.id || content.value.id === 0 || content.value.id === '0' ) {\n\t\t\t\t\tfinal_value = content.value.id; //Awesomebox\n\t\t\t\t} else {\n\t\t\t\t\tfinal_value = content.value; // default_filter_data_for_next_view\n\t\t\t\t}\n\n\t\t\t\tconvert_filter_data[key] = final_value;\n\n\t\t\t} else if ( obj.value === false ) {\n\t\t\t\treturn;//continue;\n\t\t\t} else {\n\t\t\t\tif ( Global.isSet( obj.value ) ) {\n\n\t\t\t\t\tconvert_filter_data[key] = obj.value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else if ( filter_data[key].value === false ) {\n\t\t\treturn; //continue;\n\t\t} else if ( Global.isSet( filter_data[key].value ) ) {\n\t\t\tconvert_filter_data[key] = filter_data[key].value;\n\t\t} else {\n\t\t\tconvert_filter_data[key] = filter_data[key];\n\t\t}\n\t} );\n\n\tif ( LocalCacheData.extra_filter_for_next_open_view ) { //MUST removed this when close the view which used this attribute.\n\n\t\tfor ( var key in LocalCacheData.extra_filter_for_next_open_view.filter_data ) {\n\t\t\tconvert_filter_data[key] = LocalCacheData.extra_filter_for_next_open_view.filter_data[key];\n\t\t}\n\n\t}\n\n\treturn convert_filter_data;\n\n};\n/* jshint ignore:end */\n\n//ASC\nGlobal.compare = function( a, b, orderKey, order_type ) {\n\n\tif ( !Global.isSet( order_type ) ) {\n\t\torder_type = 'asc';\n\t}\n\n\tif ( order_type === 'asc' ) {\n\t\tif ( a[orderKey] < b[orderKey] ) {\n\t\t\treturn -1;\n\t\t}\n\t\tif ( a[orderKey] > b[orderKey] ) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t} else {\n\t\tif ( a[orderKey] < b[orderKey] ) {\n\t\t\treturn 1;\n\t\t}\n\t\tif ( a[orderKey] > b[orderKey] ) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn 0;\n\t}\n\n};\n\nGlobal.buildFilter = function() {\n\tvar filterCondition = arguments[0];\n\tvar filter = [];\n\n\tif ( filterCondition ) {\n\n\t\tfor ( var key in filterCondition ) {\n\t\t\tfilter[key] = filterCondition[key];\n\t\t}\n\n\t}\n\n\treturn filter;\n\n};\n\nGlobal.getLoginUserDateFormat = function() {\n\tvar format = 'DD-MMM-YY';\n\n\tif ( LocalCacheData.getLoginUserPreference() ) {\n\t\tformat = LocalCacheData.getLoginUserPreference().date_format;\n\t}\n\n\treturn format;\n};\n/* jshint ignore:start */\nGlobal.formatGridData = function( grid_data, key_name ) {\n\n\tif ( $.type( grid_data ) !== 'array' ) {\n\t\treturn grid_data;\n\t}\n\n\tfor ( var i = 0; i < grid_data.length; i++ ) {\n\t\tfor ( var key in grid_data[i] ) {\n\n\t\t\tif ( !grid_data[i].hasOwnProperty( key ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t//Need to convert custom fields time_unit to string\n\t\t\tif ( key.indexOf( 'custom_field' ) === 0 && Array.isArray( LocalCacheData.current_open_primary_controller.custom_fields ) ) {\n\t\t\t\tlet custom_field = LocalCacheData.current_open_primary_controller.custom_fields.find( ( field ) => {\n\t\t\t\t\treturn field.id === key.replace( 'custom_field-', '' );\n\t\t\t\t} );\n\n\t\t\t\tif ( custom_field && custom_field.type_id == 1300 ) {\n\t\t\t\t\tif ( Global.isNumeric( grid_data[i][key] ) ) {\n\t\t\t\t\t\tgrid_data[i][key] = Global.getTimeUnit( grid_data[i][key] );\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// The same format for all views.\n\t\t\tswitch ( key ) {\n\t\t\t\tcase 'maximum_shift_time':\n\t\t\t\tcase 'new_day_trigger_time':\n\t\t\t\tcase 'trigger_time':\n\t\t\t\tcase 'minimum_punch_time':\n\t\t\t\tcase 'maximum_punch_time':\n\t\t\t\tcase 'window_length':\n\t\t\t\tcase 'start_window':\n\t\t\t\tcase 'round_interval':\n\t\t\t\tcase 'grace':\n\t\t\t\tcase 'estimate_time':\n\t\t\t\tcase 'minimum_time':\n\t\t\t\tcase 'maximum_time':\n\t\t\t\tcase 'total_time':\n\t\t\t\tcase 'start_stop_window':\n\t\t\t\t\tif ( Global.isNumeric( grid_data[i][key] ) ) {\n\t\t\t\t\t\tgrid_data[i][key] = Global.getTimeUnit( grid_data[i][key] );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgrid_data[i][key] = null; //Prevent string \"false\" from being returned when the column isn't defined on the server side.\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'include_break_punch_time':\n\t\t\t\tcase 'include_multiple_breaks':\n\t\t\t\tcase 'include_lunch_punch_time':\n\t\t\t\tcase 'is_default':\n\t\t\t\tcase 'is_base':\n\t\t\t\tcase 'auto_update':\n\t\t\t\tcase 'currently_employed':\n\t\t\t\tcase 'criminal_record':\n\t\t\t\tcase 'immediate_drug_test':\n\t\t\t\tcase 'is_current_employer':\n\t\t\t\tcase 'is_contact_available':\n\t\t\t\tcase 'enable_pay_stub_balance_display':\n\t\t\t\tcase 'enable_login':\n\t\t\t\tcase 'ytd_adjustment':\n\t\t\t\tcase 'authorized':\n\t\t\t\tcase 'is_reimbursable':\n\t\t\t\tcase 'reimbursable':\n\t\t\t\tcase 'tainted':\n\t\t\t\tcase 'auto_fill':\n\t\t\t\tcase 'private':\n\t\t\t\t\tif ( grid_data[i][key] === true ) {\n\t\t\t\t\t\tgrid_data[i][key] = $.i18n._( 'Yes' );\n\t\t\t\t\t} else if ( grid_data[i][key] === false ) {\n\t\t\t\t\t\tgrid_data[i][key] = $.i18n._( 'No' );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'override':\n\t\t\t\t\tif ( grid_data[i][key] === true ) {\n\t\t\t\t\t\tgrid_data[i][key] = $.i18n._( 'Yes' );\n\t\t\t\t\t\tgrid_data[i]['is_override'] = true;\n\t\t\t\t\t} else if ( grid_data[i][key] === false ) {\n\t\t\t\t\t\tgrid_data[i][key] = $.i18n._( 'No' );\n\t\t\t\t\t\tgrid_data[i]['is_override'] = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'is_scheduled':\n\t\t\t\t\tif ( grid_data[i][key] === '1' ) {\n\t\t\t\t\t\tgrid_data[i][key] = $.i18n._( 'Yes' );\n\t\t\t\t\t} else if ( grid_data[i][key] === '0' ) {\n\t\t\t\t\t\tgrid_data[i][key] = $.i18n._( 'No' );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'in_use':\n\t\t\t\t\tif ( grid_data[i][key] === '1' ) {\n\t\t\t\t\t\tgrid_data[i][key] = $.i18n._( 'Yes' );\n\t\t\t\t\t\tgrid_data[i]['is_in_use'] = true;\n\t\t\t\t\t} else if ( grid_data[i][key] === '0' ) {\n\t\t\t\t\t\tgrid_data[i][key] = $.i18n._( 'No' );\n\t\t\t\t\t\tgrid_data[i]['is_in_use'] = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif ( grid_data[i][key] === false ) {\n\t\t\t\t\t\tgrid_data[i][key] = '';\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// Handle the specially format columns which are not different with others.\n\t\t\tswitch ( key_name ) {\n\t\t\t\tcase 'AccrualPolicyUserModifier':\n\t\t\t\t\tswitch ( key ) {\n\t\t\t\t\t\tcase 'annual_maximum_time_modifier':\n\t\t\t\t\t\t\tif ( grid_data[i]['type_id'] === 20 ) {\n\t\t\t\t\t\t\t\tgrid_data[i][key] = $.i18n._( 'N/A' );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'BreakPolicy':\n\t\t\t\tcase 'MealPolicy':\n\t\t\t\tcase 'Accrual':\n\t\t\t\t\tswitch ( key ) {\n\t\t\t\t\t\tcase 'amount':\n\t\t\t\t\t\t\tif ( Global.isNumeric( grid_data[i][key] ) ) {\n\t\t\t\t\t\t\t\tgrid_data[i][key] = Global.getTimeUnit( grid_data[i][key] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'accrual_balance_summary':\n\t\t\t\tcase 'AccrualBalance':\n\t\t\t\t\tswitch ( key ) {\n\t\t\t\t\t\tcase 'balance':\n\t\t\t\t\t\t\tif ( Global.isNumeric( grid_data[i][key] ) ) {\n\t\t\t\t\t\t\t\tgrid_data[i][key] = Global.getTimeUnit( grid_data[i][key] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'RecurringScheduleControl':\n\t\t\t\t\tswitch ( key ) {\n\t\t\t\t\t\tcase 'end_date':\n\t\t\t\t\t\t\tif ( grid_data[i][key] === '' ) {\n\t\t\t\t\t\t\t\tgrid_data[i][key] = 'Never';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\t}\n\n\treturn grid_data;\n\n};\n/* jshint ignore:end */\n\n// Commented out as we have now fully refactored the old _super and __super references in the new ES6 code.\n// //make backone support a simple super funciton\n// Backbone.Model.prototype._super = function( funcName ) {\n// \treturn this.constructor.__super__[funcName].apply( this, _.rest( arguments ) );\n// };\n//\n// //make backone support a simple super function\n// Backbone.View.prototype._super = function( funcName ) {\n// \t// Note: If 'Maximum call stack size exceeded' error encountered, and view is extending twice (BaseView->ReportBaseView->SomeRandomView), then make sure you define `this.real_this` at the 2nd level extend. See reportBaseViewController init for example.\n// \tif ( this.real_this && this.real_this.constructor.__super__[funcName] ) {\n// \t\treturn this.real_this.constructor.__super__[funcName].apply( this, _.rest( arguments ) );\n// \t} else {\n// \t\treturn this.constructor.__super__[funcName].apply( this, _.rest( arguments ) );\n// \t}\n//\n// };\n//\n// //make backone support a simple super funciton for second level class\n// Backbone.View.prototype.__super = function( funcName ) {\n// \tif ( !this.real_this ) {\n// \t\tthis.real_this = this.constructor.__super__;\n// \t}\n//\n// \treturn this.constructor.__super__[funcName].apply( this, _.rest( arguments ) );\n//\n// };\n\n/*\n * Date Format 1.2.3\n * (c) 2007-2009 Steven Levithan <stevenlevithan.com>\n * MIT license\n *\n * Includes enhancements by Scott Trenda <scott.trenda.net>\n * and Kris Kowal <cixar.com/~kris.kowal>\n *\n * Accepts a date, a mask, or a date and a mask.\n * Returns a formatted version of the given date.\n * The date defaults to the current date/time.\n * The mask defaults to dateFormat.masks.default.\n */\n\nvar dateFormat = function() {\n\tvar token = /d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\\1?|[LloSZ]|'[^']*\"|'[^']*'/g,\n\t\ttimezone = /\\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\\d{4})?)\\b/g,\n\t\ttimezoneClip = /[^-+\\dA-Z]/g,\n\t\tpad = function( val, len ) {\n\t\t\tval = String( val );\n\t\t\tlen = len || 2;\n\t\t\twhile ( val.length < len ) {\n\t\t\t\tval = '0' + val;\n\t\t\t}\n\t\t\treturn val;\n\t\t};\n\n\t// Regexes and supporting functions are cached through closure\n\n\t/* jshint ignore:start */\n\treturn function( date, mask, utc ) {\n\t\tvar dF = dateFormat;\n\n\t\t// You can't provide utc if you skip other args (use the 'UTC:' mask prefix)\n\t\tif ( arguments.length === 1 && Object.prototype.toString.call( date ) === '[object String]' && !/\\d/.test( date ) ) {\n\t\t\tmask = date;\n\t\t\tdate = undefined;\n\t\t}\n\n\t\t// Passing date through Date applies Date.parse, if necessary\n\t\tdate = date ? new Date( date ) : new Date();\n\t\tif ( isNaN( date ) ) {\n\t\t\tthrow SyntaxError( 'invalid date' );\n\t\t}\n\n\t\tmask = String( dF.masks[mask] || mask || dF.masks['default'] );\n\n\t\t// Allow setting the utc argument via the mask\n\t\tif ( mask.slice( 0, 4 ) === 'UTC:' ) {\n\t\t\tmask = mask.slice( 4 );\n\t\t\tutc = true;\n\t\t}\n\n\t\tvar _ = utc ? 'getUTC' : 'get',\n\t\t\td = date[_ + 'Date'](),\n\t\t\tD = date[_ + 'Day'](),\n\t\t\tm = date[_ + 'Month'](),\n\t\t\ty = date[_ + 'FullYear'](),\n\t\t\tH = date[_ + 'Hours'](),\n\t\t\tM = date[_ + 'Minutes'](),\n\t\t\ts = date[_ + 'Seconds'](),\n\t\t\tL = date[_ + 'Milliseconds'](),\n\t\t\to = utc ? 0 : date.getTimezoneOffset(),\n\t\t\tflags = {\n\t\t\t\td: d,\n\t\t\t\tdd: pad( d ),\n\t\t\t\tddd: dF.i18n.dayNames[D],\n\t\t\t\tdddd: dF.i18n.dayNames[D + 7],\n\t\t\t\tm: m + 1,\n\t\t\t\tmm: pad( m + 1 ),\n\t\t\t\tmmm: dF.i18n.monthNames[m],\n\t\t\t\tmmmm: dF.i18n.monthNames[m + 12],\n\t\t\t\tyy: String( y ).slice( 2 ),\n\t\t\t\tyyyy: y,\n\t\t\t\th: H % 12 || 12,\n\t\t\t\thh: pad( H % 12 || 12 ),\n\t\t\t\tH: H,\n\t\t\t\tHH: pad( H ),\n\t\t\t\tM: M,\n\t\t\t\tMM: pad( M ),\n\t\t\t\ts: s,\n\t\t\t\tss: pad( s ),\n\t\t\t\tl: pad( L, 3 ),\n\t\t\t\tL: pad( L > 99 ? Math.round( L / 10 ) : L ),\n\t\t\t\tt: H < 12 ? 'a' : 'p',\n\t\t\t\ttt: H < 12 ? 'am' : 'pm',\n\t\t\t\tT: H < 12 ? 'A' : 'P',\n\t\t\t\tTT: H < 12 ? 'AM' : 'PM',\n\t\t\t\tZ: utc ? 'UTC' : ( String( date ).match( timezone ) || [''] ).pop().replace( timezoneClip, '' ),\n\t\t\t\to: ( o > 0 ? '-' : '+' ) + pad( Math.floor( Math.abs( o ) / 60 ) * 100 + Math.abs( o ) % 60, 4 ),\n\t\t\t\tS: ['th', 'st', 'nd', 'rd'][d % 10 > 3 ? 0 : ( d % 100 - d % 10 !== 10 ) * d % 10]\n\t\t\t};\n\n\t\treturn mask.replace( token, function( $0 ) {\n\t\t\treturn $0 in flags ? flags[$0] : $0.slice( 1, $0.length - 1 );\n\t\t} );\n\t};\n\t/* jshint ignore:end */\n}();\n\n// Some common format strings\ndateFormat.masks = {\n\t'default': 'ddd mmm dd yyyy HH:MM:ss',\n\tshortDate: 'm/d/yy',\n\tmediumDate: 'mmm d, yyyy',\n\tlongDate: 'mmmm d, yyyy',\n\tfullDate: 'dddd, mmmm d, yyyy',\n\tshortTime: 'h:MM TT',\n\tmediumTime: 'h:MM:ss TT',\n\tlongTime: 'h:MM:ss TT Z',\n\tisoDate: 'yyyy-mm-dd',\n\tisoTime: 'HH:MM:ss',\n\tisoDateTime: 'yyyy-mm-dd\\'T\\'HH:MM:ss',\n\tisoUtcDateTime: 'UTC:yyyy-mm-dd\\'T\\'HH:MM:ss\\'Z\\''\n};\n\n// Internationalization strings\ndateFormat.i18n = {\n\tdayNames: [\n\t\t'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat',\n\t\t'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'\n\t],\n\tmonthNames: [\n\t\t'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec',\n\t\t'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'\n\t]\n};\n\n// For convenience...\nDate.prototype.format = function( mask, utc ) {\n\t//JS Exception: Uncaught TypeError: Cannot read properties of undefined (reading 'date_format')\n\tif ( !Global.isSet( mask ) && LocalCacheData.getLoginUserPreference() ) {\n\t\tmask = LocalCacheData.getLoginUserPreference().date_format;\n\t}\n\n\tif ( !mask ) {\n\t\tmask = 'DD-MMM-YY';\n\t}\n\n\tvar format_str = moment( this ).format( mask );\n\n\treturn format_str;\n};\n\nwindow.RightClickMenuType = function() {\n\n};\n\nRightClickMenuType.LISTVIEW = '1';\nRightClickMenuType.EDITVIEW = '2';\nRightClickMenuType.NORESULTBOX = '3';\nRightClickMenuType.ABSENCE_GRID = '4';\nRightClickMenuType.VIEW_ICON = '5';\n\n/**\n * Decoding encoded html enitities (ie: \"&gt;\")\n * to avoid XSS vulnerabilities do not eval anything that has gone through this function\n *\n * @param str\n * @returns {*|jQuery}\n */\nGlobal.htmlDecode = function( str ) {\n\treturn $( '<textarea></textarea>' ).html( str ).text();\n};\n\nGlobal.htmlEncode = function( str ) {\n\tvar encodedStr = str;\n\n\tif ( encodedStr ) {\n\t\t// This replaces 'S' in 'MST' with the encoded value, which is invalid.\n\t\t// encodedStr = str.replace( /[\\u00A0-\\u9999<>\\'\"\\&]/gim, function( i ) {\n\t\t// \treturn '&#' + i.charCodeAt( 0 ) + ';';\n\t\t// } );\n\t\t// encodedStr = encodedStr.replace( /&#60;br&#62;/g, '<br>' );\n\t\t// return encodedStr;\n\n\t\tvar tmp = document.createElement( 'div' );\n\t\ttmp.textContent = encodedStr;\n\n\t\treturn tmp.innerHTML;\n\t} else {\n\t\treturn encodedStr;\n\t}\n};\n\n//Sort by module\n\nGlobal.m_sort_by = ( function() {\n\t// utility functions\n\n\tvar default_cmp = function( a, b ) {\n\n\t\t\tif ( a === b ) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\t//Speical handle OPEN option to make it always stay together\n\t\t\tif ( a === false || a === 'OPEN' ) {\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\tif ( b === false || b === 'OPEN' ) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\treturn a < b ? -1 : 1;\n\t\t},\n\t\tgetCmpFunc = function( primer, reverse ) {\n\t\t\tvar cmp = default_cmp;\n\t\t\tif ( primer ) {\n\t\t\t\tcmp = function( a, b ) {\n\t\t\t\t\treturn default_cmp( primer( a ), primer( b ) );\n\t\t\t\t};\n\t\t\t}\n\t\t\tif ( reverse ) {\n\t\t\t\treturn function( a, b ) {\n\t\t\t\t\treturn -1 * cmp( a, b );\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn cmp;\n\t\t};\n\n\t// actual implementation\n\tvar sort_by = function( sort_by_array ) {\n\t\tvar fields = [],\n\t\t\tn_fields = sort_by_array.length,\n\t\t\tfield, name, reverse, cmp;\n\n\t\t// preprocess sorting options\n\t\tfor ( var i = 0; i < n_fields; i++ ) {\n\t\t\tfield = sort_by_array[i];\n\t\t\tif ( typeof field === 'string' ) {\n\t\t\t\tname = field;\n\t\t\t\tcmp = default_cmp;\n\t\t\t} else {\n\t\t\t\tname = field.name;\n\t\t\t\tcmp = getCmpFunc( field.primer, field.reverse );\n\t\t\t}\n\t\t\tfields.push( {\n\t\t\t\tname: name,\n\t\t\t\tcmp: cmp\n\t\t\t} );\n\t\t}\n\n\t\treturn function( A, B ) {\n\t\t\tvar a, b, name, cmp, result;\n\t\t\tfor ( var i = 0, l = n_fields; i < l; i++ ) {\n\t\t\t\tresult = 0;\n\t\t\t\tfield = fields[i];\n\t\t\t\tname = field.name;\n\t\t\t\tcmp = field.cmp;\n\n\t\t\t\tresult = cmp( A[name], B[name] );\n\t\t\t\tif ( result !== 0 ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t};\n\t};\n\n\treturn sort_by;\n\n}() );\n\n$.fn.invisible = function() {\n\treturn this.each( function() {\n\t\t$( this ).css( 'opacity', '0' );\n\t} );\n};\n$.fn.visible = function() {\n\treturn this.each( function() {\n\t\t$( this ).css( 'opacity', '1' );\n\t} );\n};\n\nGlobal.trackView = function( name, action ) {\n\tif ( APIGlobal.pre_login_data.analytics_enabled === true ) {\n\t\tvar track_address;\n\n\t\t//Hostname is already sent separately, so this should just be the view/action in format:\n\t\t// '#!m=' + name + '&a=' + action\n\t\tif ( name ) {\n\t\t\ttrack_address = '#!m=' + name;\n\n\t\t\tif ( action ) {\n\t\t\t\ttrack_address += '&a=' + action;\n\t\t\t}\n\t\t} else {\n\t\t\t//Default to only data after (and including) the #.\n\t\t\ttrack_address = window.location.hash.substring( 1 );\n\t\t}\n\n\t\t//Track address is sent in sendAnalytics as the 3rd parameter.\n\t\tGlobal.sendAnalyticsPageview( track_address );\n\t}\n};\n\nGlobal.setAnalyticDimensions = function( user_name, company_name ) {\n\tif ( APIGlobal.pre_login_data.analytics_enabled === true ) {\n\t\tif ( typeof ( gtag ) !== 'undefined' ) {\n\t\t\ttry {\n\t\t\t\t//All names must be mapped in main.js 'custom_map'\n\t\t\t\tvar user_properties = {\n\t\t\t\t\t'application_version': APIGlobal.pre_login_data.application_version,\n\t\t\t\t\t'http_host': APIGlobal.pre_login_data.http_host,\n\t\t\t\t\t'product_edition_name': APIGlobal.pre_login_data.product_edition_name,\n\t\t\t\t\t'registration_key': APIGlobal.pre_login_data.registration_key,\n\t\t\t\t\t'primary_company_name': APIGlobal.pre_login_data.primary_company_name,\n\t\t\t\t};\n\n\t\t\t\tif ( user_name !== 'undefined' && user_name !== null ) {\n\t\t\t\t\tif ( APIGlobal.pre_login_data.production !== true ) {\n\t\t\t\t\t\tDebug.Text( 'Analytics User: ' + user_name, 'Global.js', '', 'doPing', 1 );\n\t\t\t\t\t}\n\t\t\t\t\tuser_properties.user_name = user_name;\n\t\t\t\t}\n\n\t\t\t\tif ( company_name !== 'undefined' && company_name !== null ) {\n\t\t\t\t\tif ( APIGlobal.pre_login_data.production !== true ) {\n\t\t\t\t\t\tDebug.Text( 'Analytics Company: ' + company_name, 'Global.js', '', 'setAnalyticDimensions', 1 );\n\t\t\t\t\t}\n\t\t\t\t\tuser_properties.company_name = company_name;\n\t\t\t\t}\n\n\t\t\t\tgtag( 'set', 'user_properties', user_properties );\n\t\t\t} catch ( e ) {\n\t\t\t\tthrow e; //Attempt to catch any errors thrown by Google Analytics.\n\t\t\t}\n\t\t}\n\t}\n};\n\nGlobal.sendAnalyticsPageview = function( track_address ) {\n\tif ( APIGlobal.pre_login_data.analytics_enabled === true ) {\n\t\t// Call this delay so view load goes first\n\t\tif ( typeof ( gtag ) !== 'undefined' ) {\n\t\t\tsetTimeout( function() {\n\t\t\t\ttry {\n\t\t\t\t\tgtag( 'event', 'page_view', { page_path: track_address } )\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t}, 500 );\n\t\t}\n\n\t}\n};\n\n/**\n * This function is used to actually submit the analytics request to google.\n * @param {string} event_category - Category relating to the event tracked, e.g. feedback or context_menu\n * @param {string} event_action - What triggered the event. E.g. click, cancel.\n * @param {string} event_label - This is often a combo of the actual value string combined with some of the above fields, for clarity. e.g. submit:feedback:sad\n */\nGlobal.sendAnalyticsEvent = function( event_category, event_action, event_label ) {\n\tif ( typeof ( gtag ) !== 'undefined' && APIGlobal.pre_login_data.analytics_enabled === true ) {\n\t\t//Debug.Arr( fieldsObject, 'Sending analytics event payload. Event: ' + event_category + ', Action: ' + event_action + ', Label: ' + event_label, 'Global.js', 'Global', 'sendAnalyticsEvent', 11 );\n\t\ttry {\n\t\t\tgtag( 'event', event_category, { action: event_action, label: event_label } )\n\t\t} catch ( e ) {\n\t\t\tthrow e;\n\t\t}\n\t}\n};\n\n/**\n *\n * @param context_btn - the jQuery element that triggered the click event on the context menu\n * @param {string} menu_name - the name of the icon if the click event was triggered by the right click context menu\n */\nGlobal.triggerAnalyticsContextMenuClick = function( context_btn, menu_name ) {\n\t// If more detail is needed above and beyond contextmenu name, then use 'LocalCacheData.current_open_view_id' in addition, but not instead of, as they are different.\n\tvar dom_context_menu = LocalCacheData.currentShownContextMenuName || 'error-with-context-menu'; // '||' is for graceful fail. identify correct context menu (vs DOM search, where there could be multiple inactive context menus)\n\tvar dom_context_menu_group;\n\tvar button_id;\n\tvar event_category;\n\tvar event_action;\n\tvar event_label;\n\n\tif ( context_btn ) {\n\t\tif ( context_btn.group && context_btn.group.label ) {\n\t\t\tdom_context_menu_group = context_btn.group.label;\n\t\t} else {\n\t\t\tdom_context_menu_group = context_btn.action_group;\n\t\t}\n\t\tevent_category = 'navigation:context_menu';\n\t\tbutton_id = context_btn.id || 'error-with-icon';\n\t} else {\n\t\t// If context_btn is null, then this is likely a right click context menu call.\n\t\tevent_category = 'navigation:right_click_menu';\n\t\tdom_context_menu_group = 'right_click';\n\t\tbutton_id = menu_name || 'error-with-rightclick-icon';\n\t}\n\n\t// Beautify output\n\tdom_context_menu = dom_context_menu.replace( 'ContextMenu', '' );\n\tbutton_id = button_id.replace( 'Icon', '' ); //Remove \"icon\" from button_id.\n\n\tevent_action = 'click';\n\tevent_label = dom_context_menu + ':' + dom_context_menu_group + '|' + button_id;\n\n\t// Debug.Text( 'Context Menu: Category: navigation_context_menu Action: ' + event_action + ' Label: ' + event_label, 'Global.js', 'Global', 'triggerAnalyticsContextMenuClick', 10 );\n\tGlobal.sendAnalyticsEvent( event_category, event_action, event_label );\n};\n\n/**\n *\n * @param {string} context - Explains what element triggered the event\n * @param {string} view_id - Name of the current view in which element was triggered\n */\nGlobal.triggerAnalyticsEditViewNavigation = function( context, view_id ) {\n\t// context in this case can be 'left-arrow', 'right-arrow', or 'awesomebox'\n\tvar event_action = 'click';\n\tvar event_label = view_id + ':' + context;\n\n\t// Debug.Text( 'Context Menu: Category: navigation_edit_view_navigation Action: ' + event_action + ' Label: ' + event_label, 'Global.js', 'Global', 'triggerAnalyticsContextMenuClick', 10 );\n\tGlobal.sendAnalyticsEvent( 'navigation:edit_view_navigation', event_action, event_label );\n};\n\n/**\n *\n * @param event - the event object from the jQuery UI tabs. Currently expecting it to be triggered by the activate event\n * @param ui - the ui object from jQuery UI tabs, contains prev and target tab info\n */\nGlobal.triggerAnalyticsTabs = function( event, ui ) {\n\t// activate event triggered, ensure all required values are set\n\tif ( event && event.type && ui && ui.newTab ) {\n\t\tvar tab_target = ui.newTab.find( '.ui-tabs-anchor' ).attr( 'ref' ) || 'tab-target-error'; // '||' is for gracful fail\n\t\tvar viewId = LocalCacheData.current_open_view_id || 'error-viewid'; // '||' is for graceful fail\n\n\t\t// Beautify output\n\t\ttab_target = tab_target.replace( 'tab_', '' );\n\n\t\tvar event_action = 'click';\n\t\tvar event_label = viewId + ':tabs:' + tab_target;\n\n\t\t// Debug.Text( 'Context Menu: Category: navigation_tabs Action: ' + event_action + ' Label: ' + event_label, 'Global.js', 'Global', 'triggerAnalyticsContextMenuClick', 10 );\n\t\tGlobal.sendAnalyticsEvent( 'navigation:tabs', event_action, event_label );\n\t} else {\n\t\tGlobal.sendAnalyticsEvent( 'error:navigation:tabs', 'error-tabs', 'error' ); // Should never be triggered. If this appears in analytics results, investigate.\n\t}\n};\n\n/**\n *\n * @param {string} context - the label of the object involved in the event. E.g. close button for click event\n * @param {string} action - the action type of the event. E.g. click.\n * @param {string} view_id - the viewId in which the event occurred. E.g. TimeSheet.\n */\nGlobal.triggerAnalyticsNavigationOther = function( context, action, view_id ) {\n\tvar event_action = action;\n\tvar event_label = view_id + ':' + context;\n\n\t// Debug.Text( 'Context Menu: Category: navigation_other Action: ' + event_action + ' Label: ' + event_label, 'Global.js', 'Global', 'triggerAnalyticsContextMenuClick', 10 );\n\tGlobal.sendAnalyticsEvent( 'navigation:other', event_action, event_label );\n};\n\nGlobal.getSessionIDKey = function() {\n\tif ( LocalCacheData.getAllURLArgs() ) {\n\t\tif ( LocalCacheData.getAllURLArgs().hasOwnProperty( 'company_id' ) ) {\n\t\t\treturn 'SessionID-JA';\n\t\t}\n\t}\n\treturn 'SessionID';\n};\n\nGlobal.loadStyleSheet = function( path, fn, scope ) {\n\tvar head = document.getElementsByTagName( 'head' )[0], // reference to document.head for appending/ removing link nodes\n\t\tlink = document.createElement( 'link' );           // create the link node\n\tlink.setAttribute( 'href', path );\n\tlink.setAttribute( 'rel', 'stylesheet' );\n\tlink.setAttribute( 'type', 'text/css' );\n\tvar sheet, cssRules;\n\t// get the correct properties to check for depending on the browser\n\tif ( 'sheet' in link ) {\n\t\tsheet = 'sheet';\n\t\tcssRules = 'cssRules';\n\t} else {\n\t\tsheet = 'styleSheet';\n\t\tcssRules = 'rules';\n\t}\n\tvar interval_id = setInterval( function() {                     // start checking whether the style sheet has successfully loaded\n\t\t\ttry {\n\t\t\t\tif ( link[sheet] && link[sheet][cssRules].length ) { // SUCCESS! our style sheet has loaded\n\t\t\t\t\tclearInterval( interval_id );                      // clear the counters\n\t\t\t\t\tclearTimeout( timeout_id );\n\t\t\t\t\tif ( typeof fn == 'function' ) {\n\t\t\t\t\t\tfn.call( scope || window, true, link );           // fire the callback with success == true\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch ( e ) {\n\t\t\t} finally {\n\t\t\t}\n\t\t}, 10 ),                                                   // how often to check if the stylesheet is loaded\n\t\ttimeout_id = setTimeout( function() {       // start counting down till fail\n\t\t\tclearInterval( timeout_id );             // clear the counters\n\t\t\tclearTimeout( timeout_id );\n\t\t\thead.removeChild( link );                // since the style sheet didn't load, remove the link node from the DOM\n\t\t\tif ( typeof fn == 'function' ) {\n\t\t\t\tfn.call( scope || window, false, link ); // fire the callback with success == false\n\t\t\t}\n\t\t}, 15000 );                                 // how long to wait before failing\n\thead.appendChild( link );  // insert the link node into the DOM and start loading the style sheet\n\treturn link; // return the link node;\n};\n\nGlobal.getSessionIDKey = function() {\n\tif ( LocalCacheData.getAllURLArgs() ) {\n\t\tif ( LocalCacheData.getAllURLArgs().hasOwnProperty( 'company_id' ) ) {\n\t\t\treturn 'SessionID-JA';\n\t\t}\n\t\tif ( LocalCacheData.getAllURLArgs().hasOwnProperty( 'punch_user_id' ) ) {\n\t\t\treturn 'SessionID-QP';\n\t\t}\n\t}\n\treturn 'SessionID';\n};\n\n//don't let the user leave without clicking OK.\n//uses localcachedata so that it will work in the ribbon\nGlobal.checkBeforeExit = function( functionToExecute ) {\n\tvar alert_message = Global.modify_alert_message;\n\tif ( LocalCacheData.current_open_edit_only_controller && LocalCacheData.current_open_edit_only_controller.confirm_on_exit && LocalCacheData.current_open_edit_only_controller.is_changed === false ) {\n\t\talert_message = Global.confirm_on_exit_message;\n\t}\n\n\tTAlertManager.showConfirmAlert( alert_message, null, function( clicked_yes ) {\n\t\tif ( clicked_yes === true ) {\n\t\t\tfunctionToExecute( clicked_yes );\n\t\t}\n\t} );\n};\n\nGlobal.detectMobileBrowser = function() {\n\treturn /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test( navigator.userAgent );\n};\n\nGlobal.getBrowserVendor = function() {\n\treturn APIGlobal.pre_login_data.user_agent_data.browser;\n};\n/**\n * Allowing deep linking\n * @type {boolean}\n */\nGlobal.deeplink = false;\n\nGlobal.getDeepLink = function() {\n\treturn Global.deeplink;\n};\n\n/**\n * Retrieves the deeplink from the current url.\n */\nGlobal.setDeepLink = function() {\n\tvar newDeepLink = window.location.href.split( '#!m=' )[1];\n\n\t//Because we add step to browser during login now so that the browser back button works, we need to check for that or login can fail leaving the user stuck.\n\tif ( newDeepLink == 'Login' || ( newDeepLink && newDeepLink.startsWith( 'Login&' ) == true ) ) { //We are not just checking startsWith because potential other views start with \"Login\" in the future\n\t\tvar alternate_session_data = getCookie( 'AlternateSessionData' );\n\t\tif ( alternate_session_data ) {\n\t\t\ttry { //Prevent JS exception if we can't parse alternate_session_data for some reason.\n\t\t\t\talternate_session_data = JSON.parse( alternate_session_data );\n\t\t\t\tif ( alternate_session_data && alternate_session_data.previous_session_view ) {\n\t\t\t\t\tGlobal.deeplink = alternate_session_data.previous_session_view;\n\t\t\t\t}\n\t\t\t} catch ( e ) {\n\t\t\t\tDebug.Text( e.message, 'Global.js', 'Global', 'setDeepLink', 10 );\n\t\t\t}\n\t\t}\n\t} else if ( newDeepLink != undefined ) {\n\t\tGlobal.deeplink = newDeepLink;\n\t}\n};\n\n/**\n sorts items for the ribbon menu\n **/\nGlobal.compareMenuItems = function( a, b ) {\n\tif ( a.attributes.sort_order == undefined ) {\n\t\ta.attributes.sort_order = 1000;\n\t}\n\tif ( b.attributes.sort_order == undefined ) {\n\t\tb.attributes.sort_order = 1000;\n\t}\n\n\tif ( a.attributes.sort_order < b.attributes.sort_order ) {\n\t\treturn -1;\n\t}\n\n\tif ( a.attributes.sort_order > b.attributes.sort_order ) {\n\t\treturn 1;\n\t}\n\n\tif ( a.attributes.sort_order == b.attributes.sort_order ) {\n\t\tif ( a.attributes.add_order < b.attributes.add_order ) {\n\t\t\treturn -1;\n\t\t}\n\t\tif ( a.attributes.add_order > b.attributes.add_order ) {\n\t\t\treturn 1;\n\t\t}\n\t}\n\n\treturn 0;\n};\n\nGlobal.getDaysInSpan = function( start_date, end_date, sun, mon, tue, wed, thu, fri, sat ) {\n\tvar start_date_obj = Global.strToDate( start_date );\n\tvar end_date_obj = Global.strToDate( end_date );\n\n\tif ( start_date_obj == null ) {\n\t\treturn 0;\n\t}\n\n\tif ( end_date_obj == null ) {\n\t\treturn 0;\n\t}\n\n\tvar days = Math.round( Math.abs( ( start_date_obj.getTime() - end_date_obj.getTime() ) / ( 86400 * 1000 ) ) ) + 1;\n\n\t//Need to loop over the whole range to ensure proper counting of effective days on ranges that span multiple weeks.\n\twhile ( start_date_obj <= end_date_obj ) {\n\t\tswitch ( start_date_obj.getDay() ) {\n\t\t\tcase 0:\n\t\t\t\tif ( !sun ) {\n\t\t\t\t\tdays -= 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tif ( !mon ) {\n\t\t\t\t\tdays -= 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tif ( !tue ) {\n\t\t\t\t\tdays -= 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tif ( !wed ) {\n\t\t\t\t\tdays -= 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tif ( !thu ) {\n\t\t\t\t\tdays -= 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 5:\n\t\t\t\tif ( !fri ) {\n\t\t\t\t\tdays -= 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 6:\n\t\t\t\tif ( !sat ) {\n\t\t\t\t\tdays -= 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\tstart_date_obj.setDate( start_date_obj.getDate() + 1 ); //Increment to next day and continue the loop.\n\t}\n\n\treturn days;\n};\n\n/**\n * Sets the language cookie to root cookie url\n * @param lang\n */\nGlobal.setLanguageCookie = function( lang ) {\n\tsetCookie( 'language', lang, 10000, APIGlobal.pre_login_data.cookie_base_url );\n};\n\n/**\n * Removes cookies from all paths. Put in specifically to move the language cookies to root.\n * @param name\n */\nGlobal.eraseCookieFromAllPaths = function( name ) {\n\tvar value = getCookie( name );\n\n\t// This function will attempt to remove a cookie from all paths\n\tvar path_bits = location.pathname.split( '/' );\n\tvar path_current = ' path=';\n\n\t// Do a simple pathless delete first\n\tdocument.cookie = name + '=; expires=Thu, 01-Jan-1970 00:00:01 GMT;';\n\tfor ( var i = 0; i < path_bits.length; i++ ) {\n\t\tpath_current += ( ( path_current.substr( -1 ) != '/' ) ? '/' : '' ) + path_bits[i];\n\t\tDebug.Text( '---' + i + '. Deleting cookie: ' + name + ' with value: ' + value + ' and path: ' + path_current, 'Global.js', 'Global', 'eraseCookieFromAllPaths', 10 );\n\t\tdocument.cookie = name + '=; expires=Thu, 01-Jan-1970 00:00:01 GMT; ' + path_current + '/;';\n\t\tdocument.cookie = name + '=; expires=Thu, 01-Jan-1970 00:00:01 GMT; ' + path_current + ';';\n\t}\n\n\tDebug.Text( 'Deleting cookie: ' + name + ' with value:' + value + ' and path:' + path_current, 'Global.js', 'Global', 'eraseCookieFromAllPaths', 10 );\n\treturn value;\n};\n\n/**\n * Moves specific app cookies from all over to the root cookie path so that they will be accessible from everywhere\n */\nGlobal.moveCookiesToNewPath = function() {\n\tDebug.Arr( document.cookie, 'COOKIE BEFORE CONTENT: ', 'Global.js', 'Global', 'moveCookiesToNewPath', 10 );\n\tvar cookies = ['language', 'StationID', 'SessionID'];\n\tvar year = new Date().getFullYear();\n\tfor ( var i = 0; i < cookies.length; i++ ) {\n\t\tvar val = Global.eraseCookieFromAllPaths( cookies[i] );\n\t\tif ( val && val.length > 0 ) {\n\t\t\tDebug.Text( 'Setting cookie:' + cookies[i] + ' with value:' + val + ' and path:' + APIGlobal.pre_login_data.cookie_base_url, 'Global.js', 'Global', 'moveCookiesToNewPath', 10 );\n\t\t\tdocument.cookie = cookies[i] + '=' + val + '; expires=Thu, 01-Jan-' + ( year + 10 ) + ' 00:00:01 GMT; path=' + APIGlobal.pre_login_data.cookie_base_url + ';';\n\t\t} else {\n\t\t\tDebug.Text( 'NOT Setting cookie:' + cookies[i] + ' with value:' + val + ' and path:' + APIGlobal.pre_login_data.cookie_base_url, 'Global.js', 'Global', 'moveCookiesToNewPath', 10 );\n\t\t}\n\t}\n\tDebug.Arr( document.cookie, 'COOKIE AFTER CONTENT: ', 'Global.js', 'Global', 'moveCookiesToNewPath', 10 );\n};\n\nGlobal.clearSessionCookie = function() {\n\tGlobal.moveCookiesToNewPath();\n\tdeleteCookie( Global.getSessionIDKey() );\n};\nGlobal.array_unique = function( arr ) {\n\tif ( Global.isArray( arr ) == false ) {\n\t\treturn arr;\n\t}\n\tvar clean_arr = [];\n\tfor ( var n in arr ) {\n\t\tif ( clean_arr.indexOf( arr[n] ) == -1 ) {\n\t\t\tclean_arr.push( arr[n] );\n\t\t}\n\t}\n\treturn clean_arr;\n};\n\n//Returns property keys that have different values or that don't exist. Similar to PHP's array_diff_assoc() function.\nGlobal.ArrayDiffAssoc = function( arr1 ) {\n\tconst retarr = {};\n\tconst argl = arguments.length;\n\tlet k1 = '';\n\tlet i = 1;\n\tlet k = '';\n\tlet arr = {};\n\n\tarr1_keys: for ( k1 in arr1 ) {\n\t\tfor ( i = 1; i < argl; i++ ) {\n\t\t\tarr = arguments[i];\n\n\t\t\tfor ( k in arr ) {\n\t\t\t\tif ( arr[k] === arr1[k1] && k === k1 ) {\n\t\t\t\t\t// If it reaches here, it was found in at least one array, so try next value\n\t\t\t\t\tcontinue arr1_keys;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tretarr[k1] = arr1[k1];\n\t\t}\n\t}\n\n\treturn retarr;\n};\n\n//Special rounding function that handles values like 1.005 or 1.0049999999999999 properly, see: http://stackoverflow.com/questions/11832914/round-to-at-most-2-decimal-places\nGlobal.MoneyRound = function( number, decimals ) {\n\tif ( isNaN( number ) ) {\n\t\tnumber = 0;\n\t}\n\n\tif ( !decimals ) {\n\t\tdecimals = 2;\n\t}\n\n\t//#2294 - We must round the absolute value or negative numbers will round toward zero.\n\tvar negative = false;\n\tif ( number < 0 ) {\n\t\tnegative = true;\n\t}\n\tnumber = Math.abs( number );\n\n\tvar retval = +( Math.round( number + 'e+' + decimals ) + 'e-' + decimals );\n\n\tif ( negative ) {\n\t\tretval = retval * -1;\n\t}\n\n\treturn retval.toFixed( decimals );\n};\n\nGlobal.getUIReadyStatus = function() {\n\treturn Global.UIReadyStatus;\n};\nGlobal.setUINotready = function() {\n\tGlobal.UIReadyStatus = 0;\n\tDebug.Text( 'Global ready status changed: 0', 'Global.js', 'Global', 'setUIReadyStatus', 10 );\n};\nGlobal.setUIReady = function() {\n\t//need to check the document isn't already complete and ready for a screenshot.'\n\tif ( Global.UIReadyStatus == 0 ) {\n\t\tGlobal.UIReadyStatus = 1;\n\t\tDebug.Text( 'Global ready status changed: 1', 'Global.js', 'Global', 'setUIReady', 10 );\n\t}\n};\nGlobal.setUIInitComplete = function() {\n\tGlobal.UIReadyStatus = 2;\n\tDebug.Text( 'Global ready status changed: 2', 'Global.js', 'Global', 'setUIReadyStatus', 10 );\n};\n\nGlobal.setUnitTestMode = function() {\n\tGlobal.UNIT_TEST_MODE = true;\n\t$( 'body' ).addClass( 'UNIT_TEST_MODE' );\n\tDebug.setEnable( true );\n\tDebug.setVerbosity( 11 );\n};\n\nGlobal.convertValidationErrorToString = function( object ) {\n\t//Debug.Arr(object,'Converting Error to String: ','Global.js', 'Global', 'convertValidationErrorToString', 10);\n\tvar retval = '';\n\n\t// #2288 - If you are deleting several records and records 2 and 4 contain errors, those are the object keys that will need to be referenced here.\n\t// To fix this we need to grab the first element independent of the index number.\n\tif ( Object.keys( object ).length > 0 ) {\n\t\tfor ( var first in object ) {\n\t\t\tobject = object[first];\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tvar error_strings = [];\n\tif ( typeof object == 'string' ) {\n\t\t//#2290 - error objects are not always uniform and can sometimes cause malformed error tips (see screenshot) if we do not check each level for string type\n\t\terror_strings.push( object );\n\t} else {\n\t\tfor ( var index in object ) {\n\t\t\tif ( typeof object[index] == 'string' ) {\n\t\t\t\terror_strings.push( object[index] );\n\t\t\t} else {\n\t\t\t\tfor ( var key in object[index] ) {\n\t\t\t\t\tif ( typeof ( object[index][key] ) == 'string' ) {\n\t\t\t\t\t\terror_strings.push( object[index][key] );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor ( var i in object[index][key] ) {\n\t\t\t\t\t\t\terror_strings.push( object[index][key][i] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( error_strings.length > 1 ) {\n\t\tvar error_count = 1;\n\t\tfor ( var index in error_strings ) {\n\t\t\tretval += error_count + '. ' + error_strings[index] + '.<br>';\n\t\t\terror_count++;\n\t\t}\n\t} else if ( typeof error_strings[0] == 'string' ) {\n\t\tretval = error_strings[0] + '.';\n\t}\n\n\treturn retval;\n};\n\nGlobal.APIFileDownload = function( class_name, method, post_data, url ) {\n\tif ( url == undefined ) {\n\t\turl = ServiceCaller.getAPIURL( 'Class=' + class_name + '&Method=' + method );\n\t}\n\n\tvar message_id = TTUUID.generateUUID();\n\turl = url + '&MessageID=' + message_id;\n\n\tvar tempForm = $( '<form></form>' );\n\ttempForm.attr( 'id', 'temp_form' );\n\ttempForm.attr( 'method', 'POST' );\n\ttempForm.attr( 'action', url );\n\n\ttempForm.attr( 'target', is_browser_iOS ? '_blank' : 'hideReportIFrame' ); //hideReportIFrame\n\n\ttempForm.append( $( '<input type=\\'hidden\\' name=\\'X-Client-ID\\' value=\\'Browser-TimeTrex\\'>' ) );\n\ttempForm.append( $( '<input type=\\'hidden\\' name=\\'X-CSRF-Token\\' value=\\'' + getCookie( 'CSRF-Token' ) + '\\'>' ) );\n\n\ttempForm.css( 'display', 'none' );\n\tif ( post_data ) {\n\t\tvar hideInput = $( '<input type=\\'hidden\\' name=\\'json\\'>' );\n\t\thideInput.val( JSON.stringify( post_data ) );\n\t\ttempForm.append( hideInput );\n\t}\n\ttempForm.appendTo( 'body' );\n\ttempForm.css( 'display', 'none' );\n\ttempForm.submit();\n\ttempForm.remove();\n\n\tif ( !is_browser_iOS ) {\n\t\tProgressBar.showProgressBar( message_id, true );\n\t}\n};\n\nGlobal.JSFileDownload = function( file_name, content, mime_type ) {\n\tvar a = document.createElement( 'a' );\n\tmime_type = mime_type || 'application/octet-stream';\n\n\tif ( URL && 'download' in a ) { //html5 A[download]\n\t\ta.href = URL.createObjectURL( new Blob( [content], {\n\t\t\ttype: mime_type\n\t\t} ) );\n\t\ta.setAttribute( 'download', file_name );\n\t\tdocument.body.appendChild( a );\n\t\ta.click();\n\t\tdocument.body.removeChild( a );\n\t} else {\n\t\tlocation.href = 'data:application/octet-stream,' + encodeURIComponent( content ); // only this mime type is supported\n\t}\n};\n\nGlobal.initFileDragAndDrop = function( element, callback ) {\n\tlet drop_zone_id = `dropzone-${Global.getRandomNum()}`;\n\n\tlet drop_zone = document.createElement( 'div' );\n\tdrop_zone.className = 'file-drop-zone-highlight';\n\tdrop_zone.style.display = 'none';\n\tdrop_zone.id = drop_zone_id;\n\n\tlet drop_zone_tip = document.createElement( 'div' );\n\tdrop_zone_tip.className = 'file-drop-zone-tip';\n\tdrop_zone_tip.style.pointerEvents = 'none';\n\tdrop_zone_tip.style.zIndex = '0';\n\n\tlet icon = document.createElement( 'div' );\n\ticon.className = 'tticon tticon-file_upload_black_24dp file-drop-zone-highlight-icon';\n\n\t//Don't trigger pointer events to prevent flashing when dragleave is triggered on child elements\n\ticon.style.pointerEvents = 'none';\n\ticon.style.zIndex = '0';\n\n\tlet text = document.createElement( 'div' );\n\ttext.textContent = $.i18n._( 'Drop files here to upload' );\n\n\t//Don't trigger pointer events to prevent flashing when dragleave is triggered on child elements\n\ttext.style.pointerEvents = 'none';\n\ttext.style.zIndex = '0';\n\n\tdrop_zone_tip.appendChild( icon );\n\tdrop_zone_tip.appendChild( text );\n\tdrop_zone.appendChild( drop_zone_tip );\n\telement.appendChild( drop_zone );\n\n\t//Check to help make sure the correct drop zone/highlight is shown when on views with multiple drop zones.\n\t//For example if a user was on \"New\" document view they could drag and drop files outside of the edit screen and the\n\t//list view drop zone would be highlighted instead of the edit screen drop zone.\n\tlet verifyDropZone = ( drop_zone_id, target ) => {\n\t\tlet verify_element = target.querySelector( '.file-drop-zone-highlight' );\n\n\t\tif ( verify_element && verify_element.id !== drop_zone_id ) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t};\n\n\t//This is required to prevent the browser from opening the file when dropped on the page.\n\telement.addEventListener( 'dragover', ( e ) => {\n\t\tif ( !verifyDropZone( drop_zone_id, e.target ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\n\t\tdrop_zone.style.display = 'flex';\n\t} );\n\n\tdrop_zone.addEventListener( 'dragleave', ( e ) => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\n\t\tdrop_zone.style.display = 'none';\n\t} );\n\n\tdrop_zone.addEventListener( 'drop', ( e ) => {\n\t\tif ( !verifyDropZone( drop_zone_id, e.target ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\n\t\tdrop_zone.style.display = 'none';\n\n\t\tif ( e.dataTransfer.files.length > 0 ) {\n\t\t\tcallback( e.dataTransfer.files );\n\t\t}\n\t} );\n}\n\n//Get a refreshed CSRF token cookie in case it expires prior to the user clicking the login button. This helps avoid showing an error message and triggering a full browser refresh.\nGlobal.refreshCSRFToken = function( callback ) {\n\tif ( getCookie( 'CSRF-Token' ) == '' ) {\n\t\tDebug.Text( 'CSRF Token cookie does not exist, refreshing...', 'Global.js', '', 'refreshCSRFToken', 10 );\n\t\tthis.authentication_api = TTAPI.APIAuthentication;\n\t\tthis.authentication_api.sendCSRFTokenCookie( {\n\t\t\t\tonResult: function( e ) {\n\t\t\t\t\tDebug.Text( 'CSRF Refresh success!...', null, null, 'refreshCSRFToken', 10 );\n\t\t\t\t\tcallback();\n\t\t\t\t},\n\t\t\t\tonError: function( e ) {\n\t\t\t\t\tDebug.Text( 'CSRF Refresh Error...', null, null, 'refreshCSRFToken', 10 );\n\t\t\t\t\tcallback();\n\t\t\t\t},\n\t\t\t});\n\t} else {\n\t\tcallback();\n\t}\n\n\treturn true;\n};\n\nGlobal.refreshPermissions = function() {\n\tthis.authentication_api = TTAPI.APIPermission;\n\tthis.authentication_api.getPermissions( {\n\t\tonResult: function( response ) {\n\t\t\tlet result = response.getResult();\n\t\t\tif ( result !== false ) {\n\t\t\t\tLocalCacheData.setPermissionData( result );\n\t\t\t\tDebug.Text( 'Permissions Refreshed!', 'Global.js', null, 'refreshPermissions', 10 );\n\t\t\t}\n\t\t},\n\t});\n};\n\nGlobal.setStationID = function( val ) {\n\tif ( val !== false && val != 'false' ) { //Make sure we don't save a cookie that is 'false' or (bool)false\n\t\tsetCookie( 'StationID', val, 10000 );\n\t}\n};\n\nGlobal.getStationID = function() {\n\tvar retval = getCookie( 'StationID' );\n\n\t//Check to see if there is a \"sticky\" user agent based Station ID defined.\n\tif ( navigator.userAgent.indexOf( 'StationID:' ) != -1 ) {\n\t\tvar regex = /StationID:\\s?([a-zA-Z0-9]{30,64})/i;\n\t\tvar matches = regex.exec( navigator.userAgent );\n\t\tif ( matches[1] ) {\n\t\t\tDebug.Text( 'Found StationID in user agent, forcing to that instead!', 'Global.js', '', 'getStationID', 11 );\n\t\t\tretval = matches[1];\n\t\t}\n\t}\n\n\treturn retval;\n};\n\n//#2342 - Close all open edit views from one place.\nGlobal.closeEditViews = function( callback ) {\n\t//Don't check the .is_changed flag, as that will prevent edit views from being closed if no data has been changed.\n\t//  For example if you go to MyAccount -> Request Authorization, View any request, click the \"TimeSheet\" icon, then click the Request timesheet cell (just below the punches) to navigate back to the requests.\n\tif ( LocalCacheData.current_open_report_controller ) { //&& LocalCacheData.current_open_report_controller.is_changed == true ) {\n\t\tLocalCacheData.current_open_report_controller.onCancelClick( null, null, function() {\n\t\t\tGlobal.closeEditViews( callback );\n\t\t} );\n\t} else if ( LocalCacheData.current_open_edit_only_controller ) { //&& LocalCacheData.current_open_edit_only_controller.is_changed == true ) {\n\t\tLocalCacheData.current_open_edit_only_controller.onCancelClick( null, null, function() {\n\t\t\tGlobal.closeEditViews( callback );\n\t\t} );\n\t} else if ( LocalCacheData.current_open_sub_controller && LocalCacheData.current_open_sub_controller.edit_view ) { //&& LocalCacheData.current_open_sub_controller.is_changed == true ) {\n\t\tLocalCacheData.current_open_sub_controller.onCancelClick( null, null, function() {\n\t\t\tGlobal.closeEditViews( callback );\n\t\t} );\n\t} else if ( LocalCacheData.current_open_primary_controller && LocalCacheData.current_open_primary_controller.edit_view ) { //&& LocalCacheData.current_open_primary_controller.is_changed == true ) {\n\t\tLocalCacheData.current_open_primary_controller.onCancelClick( null, null, function() {\n\t\t\tGlobal.closeEditViews( callback );\n\t\t} );\n\t} else if ( LocalCacheData.current_open_primary_controller &&\n\t\tLocalCacheData.current_open_primary_controller.viewId === 'TimeSheet' &&\n\t\tLocalCacheData.current_open_primary_controller.getPunchMode() === 'manual' ) {\n\t\tLocalCacheData.current_open_primary_controller.doNextIfNoValueChangeInManualGrid( function() {\n\t\t\t//#2567 Must conclude here. Recursion would be infinite\n\t\t\tif ( callback ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t} );\n\t} else {\n\t\tif ( callback ) {\n\t\t\tcallback();\n\t\t}\n\t}\n};\n\n//#2351 - red border for sandbox mode\nGlobal.styleSandbox = function() {\n\tif ( APIGlobal.pre_login_data['sandbox'] && APIGlobal.pre_login_data['sandbox'] == true ) {\n\t\t$( 'body' ).addClass( 'sandbox_container' );\n\t}\n};\n\n//#2351 - Used for logging in as employee/client or switching to sandbox mode.\nGlobal.NewSession = function( user_id, client_id ) {\n\tvar api_auth = TTAPI.APIAuthentication;\n\tapi_auth.newSession( user_id, client_id, {\n\t\tonResult: function( result ) {\n\t\t\tif ( !result || !result.isValid() ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data && result_data.url ) {\n\t\t\t\tvar url = result_data.url;\n\t\t\t\tif ( url.indexOf( 'http' ) === -1 ) {\n\t\t\t\t\turl = window.location.protocol + '//' + url;\n\t\t\t\t}\n\n\t\t\t\tvar alternate_session_data = {\n\t\t\t\t\tnew_session_id: result_data.session_id,\n\t\t\t\t\tprevious_session_id: getCookie( Global.getSessionIDKey() ),\n\t\t\t\t\tprevious_session_url: Global.getBaseURL(),\n\t\t\t\t\tprevious_session_view: window.location.href.split( '#!m=' )[1],\n\t\t\t\t\tprevious_cookie_path: LocalCacheData.cookie_path\n\t\t\t\t};\n\n\t\t\t\tsetCookie( 'AlternateSessionData', JSON.stringify( alternate_session_data ), 1, result_data.cookie_base_url, Global.getHost() );\n\n\t\t\t\tGlobal.setURLToBrowser( url + 'html5/#!m=Login' );\n\t\t\t\tGlobal.needReloadBrowser = true;\n\t\t\t} else {\n\t\t\t\tTAlertManager.showAlert( $.i18n._( 'ERROR: Unable to perform action, please contact your %s administrator immediately.', LocalCacheData.getApplicationName() ), $.i18n._( 'ERROR' ) );\n\t\t\t}\n\t\t}\n\t} );\n\n};\n\nGlobal.isNumeric = function( value ) {\n\tvar retval = false;\n\n\tvalue = parseFloat( value );\n\tif ( typeof value == 'number' && !isNaN( value ) ) {\n\t\tretval = true;\n\t}\n\n\treturn retval;\n};\n\n//Calculates a \"smart\" debounce time based on the network ping time.\n//Debounce on at least 1.5x the round-trip ping time. ( 333 * 1.5 = 500ms. )\n//Because a user on a really slow connection could click Save 1s apart and the packets could arrive close to each other and cause duplicate request errors still.\nGlobal.calcDebounceWaitTimeBasedOnNetwork = function( min_time = null, max_time = null ) {\n\tvar ping = Global.current_ping;\n\n\tif ( !min_time ) {\n\t\tvar min_time = 500; //Turns into 500ms after 1.5x\n\t}\n\n\tif ( !max_time ) {\n\t\tvar max_time = 10000; //Turns into 10s after 1.5x\n\t}\n\n\tvar retval = ( ping * 1.5 );\n\n\tif ( retval < min_time ) {\n\t\tretval = min_time;\n\t}\n\n\tif ( retval > max_time ) {\n\t\tretval = max_time;\n\t}\n\n\treturn retval;\n}\n\n// Returns a function, that, as long as it continues to be invoked, will not be triggered. The function will be called after it stops being called for N milliseconds.\n// If `immediate` is passed, trigger the function on the leading edge, instead of the trailing.\nGlobal.debounce = function( callback, wait, immediate ) {\n\tvar timeout;\n\n\treturn function() {\n\t\tvar context = this;\n\t\tvar args = arguments;\n\n\t\tvar callback_name = ( callback.name ) ? callback.name : 'N/A';\n\n\t\tvar later = function() {\n\t\t\ttimeout = null;\n\t\t\tif ( !immediate ) {\n\t\t\t\tDebug.Text( 'Calling after debounce wait: ' + callback_name + ' Wait Time: ' + wait, 'Global.js', 'Global', 'debounce', 10 );\n\t\t\t\tcallback.apply( context, args );\n\t\t\t} else {\n\t\t\t\tDebug.Text( 'Skipping due to debounce: ' + callback_name + ' Wait Time: ' + wait, 'Global.js', 'Global', 'debounce', 11 );\n\t\t\t}\n\t\t};\n\n\t\tvar call_now = immediate && !timeout;\n\n\t\tclearTimeout( timeout );\n\n\t\ttimeout = setTimeout( later, wait );\n\n\t\tif ( call_now ) {\n\t\t\tDebug.Text( 'Calling immediate debounce: ' + callback_name + ' Wait Time: ' + wait, 'Global.js', 'Global', 'debounce', 10 );\n\t\t\tcallback.apply( context, args );\n\t\t} else {\n\t\t\tDebug.Text( 'Skipping due to debounce: ' + callback_name + ' Wait Time: ' + wait, 'Global.js', 'Global', 'debounce', 11 );\n\t\t}\n\t};\n};\n\n/**\n * Filter output to prevent the user from seeing strings such as undefined, false or null.\n * @param {string} entry the string that needs to be sanitized.\n * @param {Array} [filters] optional array of filters. If none is supplied, defaults will be used.\n * @returns {string} returns the sanitized string result\n */\nGlobal.filterOutput = function( entry, filters ) {\n\t// default filters can be overridden by passing in a second param\n\n\tif ( !filters ) {\n\t\tfilters = [false, undefined, null, 'false', 'undefined', 'null'];\n\t}\n\n\t// if filter matches, replace contents with empty string\n\tif ( ( filters.indexOf( entry ) !== -1 ) ) {\n\t\treturn '';\n\t} else {\n\t\treturn entry;\n\t}\n};\n\n/**\n * groupArrayDataByKey - This function is used to group data by object key - used (so far) for the geofence filters\n * @param {Object[]} data - the array dataset\n * @param {boolean} [makeUnique] - true will only output one occurance per key. false or ommiting will return all occurances\n * @returns {*}\n */\nGlobal.groupArrayDataByKey = function( data, makeUnique ) {\n\n\treturn data.reduce( function( accumulator, currentValue ) {\n\t\t// get a list of all object keys for data object, then iterate through each\n\t\tObject.entries( currentValue ).forEach( function( key ) {\n\t\t\taccumulator[key[0]] = accumulator[key[0]] || [];\n\n\t\t\t// check if value exists or add anyway if makeUnique is false\n\t\t\tif ( accumulator[key[0]].indexOf( key[1] ) === -1 || !makeUnique ) {\n\t\t\t\taccumulator[key[0]].push( key[1] );\n\t\t\t}\n\t\t} );\n\t\treturn accumulator;\n\t}, {} );\n};\n\n/**\n * Used to modify the viewport meta tag in the index.php head section. This controls the 'virtual' device viewport on mobile devices.\n * More info: https://developers.google.com/web/updates/2015/01/What-the-Viewport\n * @param {string} setting - name of pre-defined viewport setting\n * @returns {string} returns the new content value for the viewport meta tag\n * @example A use case is Setting mobile view on login, then back to desktop (990px virtual) after login, to allow pan & zoom, as not whole app is mobile optimized.\n */\nGlobal.setVirtualDeviceViewport = function( setting ) {\n\tvar width;\n\tvar scale;\n\tvar meta_tag_viewport = $( 'meta[name=viewport]' );\n\n\tif ( !setting || !meta_tag_viewport || meta_tag_viewport.length !== 1 ) {\n\t\tDebug.Text( 'Error: Missing params in function call', 'Global.js', 'Global', 'setVirtualDeviceViewport', 1 );\n\t\treturn undefined;\n\t}\n\tif ( setting === 'mobile' ) {\n\t\twidth = 'device-width';\n\t\tscale = 1;\n\t} else if ( setting === 'desktop' ) {\n\t\twidth = 990; // Minium application width which was previously used elsewhere.\n\t\tscale = 0.5;\n\t} else {\n\t\tDebug.Text( 'Error: Invalid setting passed to function', 'Global.js', 'Global', 'setVirtualDeviceViewport', 1 );\n\t\treturn undefined;\n\t}\n\tif ( width && scale ) {\n\t\tmeta_tag_viewport.attr( 'content', 'width=' + width + ', initial-scale=' + scale );\n\t\treturn meta_tag_viewport.attr( 'content' );\n\t} else {\n\t\tDebug.Text( 'Error: Invalid device settings. Either width or scale is invalid', 'Global.js', 'Global', 'setVirtualDeviceViewport', 1 );\n\t\treturn undefined;\n\t}\n};\n\n//Clear all session and local cache data for logout.\nGlobal.Logout = function() {\n\tServiceCaller.abortAll(); //Abort any pending AJAX requests so their callbacks don't get triggered and cause all kind of weirdness.\n\tLocalCacheData.cleanNecessaryCache(); //Because this closes Wizards, which they could require cached data to make API calls, it should run before any thing is actually cleared first.\n\tGlobal.clearSessionCookie();\n\tLocalCacheData.setSessionID( '' );\n\tLocalCacheData.current_open_view_id = ''; //#1528  -  Logout icon not working.\n\t//LocalCacheData.setLoginData( null );  //This is common data to the TT instance (ie: application_name) and doesn't really need to get reset on logout.\n\tLocalCacheData.setLoginUser( null );\n\tLocalCacheData.setLoginUserPreference( null );\n\tLocalCacheData.setLogoutSettings( null );\n\tLocalCacheData.setPermissionData( null );\n\tLocalCacheData.setCurrentCompany( null );\n\tLocalCacheData.setLastPunchTime( null );\n\tLocalCacheData.setJobQueuePunchData( null );\n\tsessionStorage.clear();\n\n\tGlobal.event_bus.emit( 'global', 'reset_vue_data' ); // Reset vue data to default values. Otherwise user data from previous session will remain.\n\tGlobal.event_bus.emit( 'global', 'close_tt_assistant' ); // Close TT Assistant to prevent sensetive data from being displayed after logout.\n\n\t//Don't reload or change views, allow that to be done by the caller.\n\n\treturn true;\n};\n\nGlobal.glowAnimation = {\n\tstart: function( element, color ) {\n\t\tif ( !element ) {\n\t\t\treturn false;\n\t\t}\n\t\tif ( !color ) {\n\t\t\t// Set default color to green. Remember this affects the text color of the element too. Might want to disable this default in future if we want to set color separately or use inherited/existing.\n\t\t\tcolor = '#00ff00';\n\t\t}\n\t\treturn element\n\t\t\t.css( 'color', color ) // sets the font color of the element. The glow then uses this value via 'currentColor'\n\t\t\t.addClass( 'animate-glow' );\n\t},\n\tstop: function( element ) {\n\t\tif ( !element ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn element.removeClass( 'animate-glow' );\n\t}\n};\n\nGlobal.buildArgDic = function( array ) {\n\tvar len = array.length;\n\tvar result = {};\n\tfor ( var i = 0; i < len; i++ ) {\n\t\tvar item = array[i];\n\t\titem = item.split( '=' );\n\t\tvar key = decodeURIComponent( item[0] );\n\t\tvar value = decodeURIComponent( item[1] );\n\n\t\t// Check if the key ends with \"[]\", indicating it's an array parameter\n\t\tif ( key.endsWith( '[]' ) ) {\n\t\t\tkey = key.slice( 0, -2 );  // Remove the \"[]\" from the key\n\t\t\tif ( !result[key] ) {  // If the key does not exist yet, create an array for it\n\t\t\t\tresult[key] = [value];\n\t\t\t} else {  // If the key already exists, push the new value into the array\n\t\t\t\tresult[key].push( value );\n\t\t\t}\n\t\t} else {\n\t\t\tresult[key] = value;\n\t\t}\n\t}\n\treturn result;\n};\n\nGlobal.getFeatureFlag = function( flag, default_value ) {\n\tlet feature_flags = LocalCacheData.getFeatureFlagData();\n\n\t//Post login has updated feature flags and are specific to the current company.\n\tif ( feature_flags && feature_flags.hasOwnProperty( flag ) ) {\n\t\treturn feature_flags[flag];\n\t}\n\n\t//If we only have pre-login dqta, use the feature flags for the installed company.\n\tif ( APIGlobal.pre_login_data && APIGlobal.pre_login_data.feature_flags && APIGlobal.pre_login_data.feature_flags.hasOwnProperty( flag ) ) {\n\t\treturn APIGlobal.pre_login_data.feature_flags[flag];\n\t}\n\n\treturn default_value;\n};\n\nGlobal.showAuthenticationModal = function( view_id, session_type, mfa_data, is_reauthentication, authenticate_callback, error_string = '', mount_id = 'tt_authenticate_ui' ) {\n\tTTVueUtils.mountComponent( mount_id, TTMultiFactorAuthentication, {\n\t\tview_id: view_id,\n\t\tsession_type: session_type,\n\t\tcomponent_id: mount_id,\n\t\tmfa_data: mfa_data,\n\t\tuser_name: LocalCacheData.getLoginUser() ? LocalCacheData.getLoginUser().user_name : '',\n\t\terror_string: LocalCacheData.login_error_string || LocalCacheData.getAllURLArgs().error_message || error_string,\n\t\tauthenticate_callback: authenticate_callback || function( success ) {\n\t\t\tGlobal.hideAuthenticationModal();\n\t\t\treturn success;\n\t\t},\n\t\tis_reauthentication: is_reauthentication\n\t} );\n};\n\nGlobal.hideAuthenticationModal = function( mount_id = 'tt_authenticate_ui' ) {\n\tTTVueUtils.unmountComponent( mount_id );\n};\n\nGlobal.getSessionTypeForLogin = function( user_name, callback ) {\n\tTTAPI.APIAuthentication.getSessionTypeForLogin( user_name, {\n\t\tonResult: ( result ) => {\n\t\t\tif ( result && result.isValid() ) {\n\t\t\t\tcallback( result.getResult() );\n\t\t\t} else {\n\t\t\t\tcallback( false );\n\t\t\t}\n\t\t}\n\t} );\n};\n\nGlobal.login = function( user_name, user_password, session_type, is_reauthentication, callback ) {\n\t//Catch blank username/passwords as early as possible. This may catch some bots from attempting to login as well.\n\tif ( user_name == '' || user_password == '' ) {\n\t\tTAlertManager.showAlert( $.i18n._( 'Please enter a user name and password.' ) );\n\t\tcallback( false );\n\t\treturn;\n\t}\n\n\tif ( LocalCacheData.current_open_primary_controller.viewId == 'LoginView' ) {\n\t\tvar cr_text = $( \"\\x23\\x6C\\x6F\\x67\\x69\\x6E\\x5F\\x63\\x6F\\x70\\x79\\x5F\\x72\\x69\\x67\\x68\\x74\\x5F\\x69\\x6E\\x66\\x6F\" ).text();\n\t\tvar _0xee93 = [\"\\x6F\\x6E\\x6C\\x6F\\x61\\x64\", \"\\x74\\x6F\\x74\\x61\\x6C\", \"\\x43\\x6F\\x70\\x79\\x72\\x69\\x67\\x68\\x74\\x20\", \"\\x69\\x6E\\x64\\x65\\x78\\x4F\\x66\", \"\\x6F\\x72\\x67\\x61\\x6E\\x69\\x7A\\x61\\x74\\x69\\x6F\\x6E\\x5F\\x6E\\x61\\x6D\\x65\", \"\\x6C\\x6F\\x67\\x69\\x6E\\x44\\x61\\x74\\x61\", \"\\x41\\x6C\\x6C\\x20\\x52\\x69\\x67\\x68\\x74\\x73\\x20\\x52\\x65\\x73\\x65\\x72\\x76\\x65\\x64\", \"\\x45\\x52\\x52\\x4F\\x52\\x3A\\x20\\x54\\x68\\x69\\x73\\x20\\x69\\x6E\\x73\\x74\\x61\\x6C\\x6C\\x61\\x74\\x69\\x6F\\x6E\\x20\\x6F\\x66\\x20\", \"\\x61\\x70\\x70\\x6C\\x69\\x63\\x61\\x74\\x69\\x6F\\x6E\\x5F\\x6E\\x61\\x6D\\x65\", \"\\x20\\x69\\x73\\x20\\x69\\x6E\\x20\\x76\\x69\\x6F\\x6C\\x61\\x74\\x69\\x6F\\x6E\\x20\\x6F\\x66\\x20\\x74\\x68\\x65\\x20\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x20\\x61\\x67\\x72\\x65\\x65\\x6D\\x65\\x6E\\x74\\x21\", \"\\x73\\x68\\x6F\\x77\\x41\\x6C\\x65\\x72\\x74\", \"\\x67\\x65\\x74\\x52\\x65\\x73\\x70\\x6f\\x6e\\x73\\x65\\x48\\x65\\x61\\x64\\x65\\x72\", \"\\x43\\x6f\\x6e\\x74\\x65\\x6e\\x74\\x2d\\x4c\\x65\\x6e\\x67\\x74\\x68\", \"\\x54\\x69\\x6D\\x65\\x54\\x72\\x65\\x78\", \"\\x23\\x70\\x6F\\x77\\x65\\x72\\x65\\x64\\x5F\\x62\\x79\", \"\\x6E\\x61\\x74\\x75\\x72\\x61\\x6C\\x57\\x69\\x64\\x74\\x68\", \"\\x6E\\x61\\x74\\x75\\x72\\x61\\x6C\\x48\\x65\\x69\\x67\\x68\\x74\"];\n\t\tif ( ( !$( _0xee93[14] )[0] || ( $( _0xee93[14] )[0] && ( ( $( _0xee93[14] )[0][_0xee93[15]] > 0 && $( _0xee93[14] )[0][_0xee93[15]] != 145 ) || ( $( _0xee93[14] )[0][_0xee93[16]] > 0 && $( _0xee93[14] )[0][_0xee93[16]] != 40 ) ) ) ) || cr_text[_0xee93[3]]( _0xee93[2] ) !== 0 || LocalCacheData[_0xee93[5]][_0xee93[8]][_0xee93[3]]( _0xee93[13] ) !== 0 || cr_text[_0xee93[3]]( _0xee93[13] ) !== 17 ) {\n\t\t\tGlobal.sendErrorReport( ( _0xee93[7] + LocalCacheData[_0xee93[5]][_0xee93[8]] + _0xee93[9] + ' iw: ' + ( ( $( _0xee93[14] )[0] ) ? $( _0xee93[14] )[0][_0xee93[15]] : 0 ) + ' ih: ' + ( ( $( _0xee93[14] )[0] ) ? $( _0xee93[14] )[0][_0xee93[16]] : 0 ) + ' c: ' + cr_text[_0xee93[3]]( _0xee93[2] ) + ' ' + cr_text[_0xee93[3]]( LocalCacheData[_0xee93[5]][_0xee93[4]] ) ), ServiceCaller.root_url, '', '', '' );\n\t\t}\n\t}\n\n\t//Check to make sure a CSRF token cookie exists, if not refresh it.\n\tGlobal.refreshCSRFToken( () => {\n\t\tTTAPI.APIAuthentication.login( user_name, user_password, session_type, is_reauthentication, {\n\t\t\tonResult: ( result ) => {\n\t\t\t\tif ( result && result.isValid() ) {\n\t\t\t\t\tlet session_result = result.getResult();\n\t\t\t\t\tlet session_id = session_result.session_id;\n\t\t\t\t\tLocalCacheData.setSessionID( session_id );\n\t\t\t\t\tsetCookie( Global.getSessionIDKey(), session_id );\n\t\t\t\t\tif ( LocalCacheData.loadViewRequiredJSReady ) {\n\t\t\t\t\t\tDebug.Text( 'Login Success (first try)', null, null, 'onLoginBtnClick', 10 );\n\t\t\t\t\t\tif ( session_result.mfa && session_result.mfa.step != false && is_reauthentication == false ) {\n\t\t\t\t\t\t\tGlobal.showAuthenticationModal( this.viewId, session_result.session_type, session_result.mfa, false,( success ) => {\n\t\t\t\t\t\t\t\tcallback( result );\n\t\t\t\t\t\t\t}, );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcallback( result );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar timeout_count = 0;\n\t\t\t\t\t\tvar auto_login_timer = setInterval( () => {\n\t\t\t\t\t\t\tif ( timeout_count == 100 ) {\n\t\t\t\t\t\t\t\tclearInterval( auto_login_timer );\n\t\t\t\t\t\t\t\tTAlertManager.showAlert( $.i18n._( 'The network connection was lost. Please check your network connection then try again.' ) );\n\t\t\t\t\t\t\t\tDebug.Text( 'Login Failure', 'Global.js', '', 'login', 10 );\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttimeout_count = timeout_count + 1;\n\t\t\t\t\t\t\tif ( LocalCacheData.loadViewRequiredJSReady ) {\n\t\t\t\t\t\t\t\tif ( session_result.mfa && session_result.mfa.step != false && is_reauthentication == false ) {\n\t\t\t\t\t\t\t\t\tGlobal.showAuthenticationModal( this.viewId, session_result.session_type, session_result.mfa, false, ( success ) => {\n\t\t\t\t\t\t\t\t\t\tcallback( result );\n\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tcallback( result );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tDebug.Text( 'Login Success after retry: ' + timeout_count, 'Global.js', '', 'login', 10 );\n\t\t\t\t\t\t\t\tclearInterval( auto_login_timer );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 600 );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ( result.getDetails()[0] && result.getDetails()[0].hasOwnProperty( 'password' ) ) {\n\t\t\t\t\t\tGlobal.showCompromisedPasswordModal( user_name, result.getDetailsAsString() );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tTAlertManager.showErrorAlert( result );\n\t\t\t\t\t}\n\t\t\t\t\tcallback( result );\n\t\t\t\t}\n\t\t\t},\n\t\t\tonError: ( e ) => {\n\t\t\t\tDebug.Text( 'Login Error...', 'Global.js', '', 'login', 10 );\n\t\t\t\tcallback( false );\n\t\t\t},\n\t\t} );\n\t} );\n\n\tGlobal.showCompromisedPasswordModal = function( user_name, message, callback ) {\n\t\tGlobal.getSessionTypeForLogin( user_name, ( result ) => {\n\t\t\tif ( result.mfa_type_id > 0 ) {\n\t\t\t\t//MFA users must reset password before login, otherwise simply having the password would bypass MFA.\n\t\t\t\tIndexViewController.openWizard( 'ForgotPasswordWizard', { message: message }, function() {\n\t\t\t\t\tTAlertManager.showAlert( $.i18n._( 'An email has been sent to you with instructions on how to reset your password.' ) );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\t//None MFA users can change password by supplying their username, current password and new password.\n\t\t\t\tIndexViewController.openWizard( 'ResetPasswordWizard', {\n\t\t\t\t\tuser_name: user_name,\n\t\t\t\t\tmessage: message\n\t\t\t\t}, function() {\n\t\t\t\t\tTAlertManager.showAlert( $.i18n._( 'Password has been changed successfully, you may now login.' ) );\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\t}\n};\n\nGlobal.refreshCustomFieldCache = function() {\n\tTTAPI.APIAuthentication.getCustomFieldData( {}, {\n\t\tonResult: function( response ) {\n\t\t\tLocalCacheData.setCustomFieldData( response.getResult() );\n\t\t}\n\t});\n}\n\n//This is primarily for Bootstrap error tips on the recruitment portal. As there are various exceptions that can occur,\n//and we need to remove them in a consistent manner to consolidate the changes in one place.\nGlobal.removeErrorTips = function( tips, clear_all = true ) {\n\tfor ( let i = 0; i < tips.length; i++ ) {\n\t\tconst tooltip_element = tips[i];\n\t\tif ( ( tooltip_element && tooltip_element.value !== '' ) || clear_all ) {\n\t\t\tconst tooltip = bootstrap.Tooltip.getInstance( tooltip_element );\n\t\t\tif ( tooltip ) {\n\t\t\t\ttooltip_element.classList.remove( 'error-tip' );\n\t\t\t\ttooltip_element.addEventListener( 'hidden.bs.tooltip', event => {\n\t\t\t\t\tif ( tooltip ) {\n\t\t\t\t\t\ttooltip.disable();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\ttooltip.hide();\n\t\t\t}\n\t\t}\n\t}\n};\n\nGlobal.showCustomAgreeModal = function( custom_agreement_data = {}, authenticate_callback = null, mount_id = 'tt_authenticate_ui' ) {\n\tTTVueUtils.mountComponent( mount_id, TTCustomAccept, {\n\t\tcustom_agreement_data: {\n\t\t\trequire_input: custom_agreement_data.require_input ?? true,\n\t\t\ttitle: custom_agreement_data.title ?? $.i18n._( 'IMPORTANT NOTICE!' ),\n\t\t\tbody: custom_agreement_data.body ?? $.i18n._( '<h6>TimeTrex version (v'+ LocalCacheData.getLoginData().application_version +') is severely out of date and may no longer be supported! <br><br>Please upgrade to the latest version as soon as possible to avoid security issues and invalid calculations.<br><br>By continuing, you acknowledge that you are knowingly risking data security by not applying the latest updates.</h6>' ),\n\t\t\tagreement_phrase: custom_agreement_data.agreement_phrase ?? 'Yes, I understand.',\n\n\t\t\tstep: custom_agreement_data.step ?? 'accept_terms',\n\t\t\ttype_id: custom_agreement_data.type_id ?? 0\n\t\t},\n\t\tauthenticate_callback: authenticate_callback ?? null\n\t} );\n};","<template>\n    <div class=\"ai-modal\" ref=\"modal\" v-show=\"is_visible\" @mouseleave=\"hideAnnotation\">\n        <span @click=\"hideModal\" class=\"ai-modal-close\"></span>\n        <div\n            class=\"ai-modal-resize-handle\"\n            @mousedown=\"startResizing\"\n        ></div>\n        <h2 class=\"ai-modal-title\">{{ labels.title }}</h2>\n        <div class=\"annotation-overlay\" ref=\"annotation_overlay\" @mouseleave=\"hideAnnotation\"></div>\n        <div class=\"ai-modal-body\" ref=\"ai-body\" v-if=\"!is_community_edition\">\n            <div class=\"conversation-history\" v-for=\"item in completions\" @mouseover=\"showAnnotation\" @mouseleave=\"hideAnnotation\">\n                <div v-if=\"item.type === 'choice'\" :id=\"'ai-msg-'+item.id\" class=\"conversation-message card border-info mb-3\">\n                    <p v-html=\"item.result\"></p>\n                    <ul class=\"ai-choice-list\">\n                        <li class=\"ai-choice\" v-for=\"choice in item.choices\" @click=\"selectedChoice(choice)\">{{ choice.message }}</li>\n                    </ul>\n                </div>\n                <div v-else-if=\"item.role === 'assistant'\" :id=\"'ai-msg-'+item.id\" class=\"conversation-message card border-primary mb-3\" v-html=\"item.result\"></div>\n                <div v-else-if=\"item.role === 'user'\" :id=\"'ai-msg-'+item.id\" class=\"conversation-message card border-secondary mb-3\" v-html=\"item.result\"></div>\n                <div v-else-if=\"item.role === 'system'\" :id=\"'ai-msg-'+item.id\" class=\"conversation-message card border-warning mb-3\" v-html=\"item.result\"></div>\n            </div>\n        </div>\n        <div v-if=\"is_community_edition\" class=\"ai-modal-body\">\n            <div class=\"conversation-history\">\n                <div class=\"conversation-message card border-warning mb-3\">\n                    <p v-html=\"this.labels.upgrade_message\"></p>\n                </div>\n            </div>\n        </div>\n        <div class=\"spinner-holder\">\n            <ProgressSpinner v-if=\"show_spinner\" style=\"width:25px;height:25px\" strokeWidth=\"5\" animationDuration=\"2s\"/>\n        </div>\n        <div class=\"ai-modal-footer\" v-if=\"!is_community_edition\">\n            <form @submit=\"userSubmitPrompt\" class=\"form-container ai-form\">\n                <button type=\"reset\" id=\"clear-button\" class=\"clear-button\" @click=\"clearContext\">\n                    <span class=\"ttassistant-icon\">\n                        <i class=\"tticon tticon-new_chat_black_24dp p-mr-4 p-text-secondary\" v-tooltip.top=\"labels.new_chat\"></i>\n                    </span>\n                </button>\n                <div class=\"input-wrapper\">\n                    <InputText class=\"ai-input\" v-model=\"user_prompt\" ref=\"user_prompt_input\" :disabled=\"input_disabled\" autocomplete=\"false\" toggleMask></InputText>\n                    <div class=\"send-icon\" @click=\"userSubmitPrompt\">\n                        <i class=\"tticon tticon-send_black_24dp p-mr-4 p-text-secondary\" ></i>\n                    </div>\n                </div>\n            </form>\n        </div>\n        <div class=\"ai-disclaimer\" v-if=\"!is_community_edition\">\n            <small>{{ labels.ai_disclaimer }}</small>\n        </div>\n    </div>\n</template>\n<script>\nimport InputText from 'primevue/inputtext';\nimport Checkbox from 'primevue/checkbox';\nimport ProgressSpinner from 'primevue/progressspinner';\nimport { Global } from '@/global/Global';\nimport TTVueUtils from '@/services/TTVueUtils';\nimport DOMPurify from 'dompurify';\nimport { marked } from 'marked';\n\nexport default {\n    created() {\n        this.event_bus = new TTEventBus( {\n            component_id: this.component_id,\n        } );\n        this.event_bus.on( 'tt_assistant', 'show_tt_assistant', () => {\n            this.showModal();\n        } );\n        this.event_bus.on( 'global', 'reset_vue_data', this.resetData );\n\n        this.createStartingMessage();\n    },\n    mounted() {\n        document.querySelector( '.layout-content' ).style.marginRight = '400px';\n        this.dispatchResizeEvent();\n    },\n    props: { // passed in via root props when component is mounted\n        view_id: {\n            type: String,\n            default: null\n        },\n        component_id: { /* Note: This is passed in via TTVueUtils.mountComponent param, and auto added to root_props. */\n            type: String,\n            default: null\n        },\n    },\n    data() {\n        return {\n            user_prompt: '',\n            tt_assistant_api: TTAPI.APITTAssistant,\n            completions: [],\n            show_spinner: false,\n            thread_id: null,\n            run_id: null,\n            input_disabled: false,\n            is_resizing: false,\n            last_x: 0,\n            is_visible: true,\n            starting_prompt_choices: (() => {\n                const prompts = [\n                    { message: $.i18n._( 'How do I fix a missing punch?' ) },\n                    { message: $.i18n._( 'How do I give an employee a $100 bonus?' ) },\n                    { message: $.i18n._( 'How do I create an overtime policy?' ) },\n                    { message: $.i18n._( 'How do I process payroll?' ) },\n                    { message: $.i18n._( 'Can I change the date and time format?' ) },\n                ];\n\n                if ( LocalCacheData && LocalCacheData.getLoginUser() ) {\n                    const country = LocalCacheData.getLoginUser()?.country;\n                    const province = LocalCacheData.getLoginUser()?.province;\n                    if ( country === 'US' && province != '' ) {\n                        prompts.push( { message: $.i18n._( 'Explain overtime laws in ' + province + ', United States.' ) } );\n                        prompts.push( { message: $.i18n._( 'Explain US federal overtime laws.' ) } );\n                    } else if ( country === 'CA' && province != '' ) {\n                        prompts.push( { message: $.i18n._( 'Explain overtime laws in ' + province + ', Canada.' ) } );\n                        prompts.push( { message: $.i18n._( 'Explain vacation pay laws in ' + province + ', Canada.' ) } );\n                    }\n                }\n\n                return prompts;\n            })(),\n            labels: {\n                title: $.i18n._( 'AI Assistant' ) + ' (' + $.i18n._( 'Beta' ) + ')',\n                new_chat: $.i18n._( 'New Chat' ),\n                ai_disclaimer: $.i18n._( 'Inaccurate information may be provided, double-check all responses.' ),\n                upgrade_message: Global.getUpgradeMessage(),\n            }\n        };\n    },\n    computed: {\n        is_community_edition() {\n            return ( Global.getProductEdition() == 10 );\n        }\n    },\n    methods: {\n        resetData() {\n            Object.assign( this.$data, this.$options.data() );\n            this.hideModal();\n        },\n        startResizing( event ) {\n            this.is_resizing = true;\n            this.last_x = event.clientX;\n\n            document.addEventListener( 'mousemove', this.onMouseMove );\n            document.addEventListener( 'mouseup', this.onMouseUp );\n        },\n        onMouseMove( event ) {\n            if ( !this.is_resizing ) {\n                return;\n            }\n\n            const delta_x = event.clientX - this.last_x;\n            const max_width = window.innerWidth * 0.5; // 50% of the window width\n            const current_width = this.$refs.modal.getBoundingClientRect().width - delta_x;\n            const new_width = Math.min( Math.max( 400, current_width ), max_width );\n\n            this.$refs.modal.style.width = `${new_width}px`;\n            this.last_x = event.clientX;\n        },\n        onMouseUp() {\n            this.is_resizing = false;\n\n            document.removeEventListener( 'mousemove', this.onMouseMove );\n            document.removeEventListener( 'mouseup', this.onMouseUp );\n        },\n        scrollToBottom() {\n            setTimeout( () => {\n                const ai_body = this.$refs['ai-body'];\n                if ( ai_body ) {\n                    ai_body.scrollTop = ai_body.scrollHeight;\n                }\n            }, 300 );\n        },\n        clearContext() {\n            this.cancelTTAssistant();\n            this.thread_id = null;\n            this.run_id = null;\n            this.show_spinner = false;\n            this.input_disabled = false;\n            this.completions = [];\n            this.user_prompt = '';\n\n            this.createStartingMessage();\n        },\n        createStartingMessage() {\n            let starting_choices = {\n                role: 'system',\n                type: 'choice',\n                result: $.i18n._( `Hello ${LocalCacheData.getLoginUser().first_name},<br><br>I'm your AI assistant, ready to help with your questions. The more <a href=\"https://help.timetrex.com/latest/enterprise/Introduction/How-to-use-AI-Assistant.htm\" target=\"_blank\">detailed your questions</a>, the better assistance I can provide.<br><br>How can I help you today?` ),\n                choices: this.starting_prompt_choices.sort( () => 0.5 - Math.random() ).slice( 0, 4 )\n            };\n\n            this.completions.push( starting_choices );\n        },\n        selectedChoice( choice ) {\n            this.user_prompt = choice.message;\n            this.userSubmitPrompt(null);\n        },\n        sendPrompt( user_prompt, user_input = {} ) {\n            if ( user_prompt != '' ) {\n\n                user_prompt = user_prompt.trim();\n                this.addUserMessageToConversationHistory( user_prompt );\n                this.getCompletion( user_prompt, user_input );\n                this.user_prompt = '';\n            }\n        },\n        getCompletion( user_prompt, user_input ) {\n            user_input = this.addContext( user_prompt, user_input );\n            this.input_disabled = true;\n            this.show_spinner = true;\n            this.tt_assistant_api.getCompletion( user_input, {\n                onResult: ( res ) => {\n                    this.show_spinner = false;\n                    this.input_disabled = false;\n\n                    let completion = res.getResult();\n\n                    if ( typeof completion !== 'object' ) {\n                        completion = {\n                            role: 'assistant',\n                            result: $.i18n._( 'Sorry, I encountered an error. Please try again later.' ),\n                            message_id: this.tt_assistant_api.getMessageId()\n                        };\n\n                        this.tt_assistant_api.setMessageId( null ); //Reset message id, if we do not do this we can update the wrong message in UI conversation history when hitting server error.\n                    }\n\n                    completion['result'] = DOMPurify.sanitize( marked.parse( completion['result'] ) );\n                    completion = this.parseAnnotations( completion );\n\n                    this.thread_id = completion.thread_id;\n                    this.run_id = completion.run_id;\n\n                    // completion.type = this.categorizeCompletion( completion );\n                    this.addCompletionToConversationHistory( completion );\n                    this.scrollToBottom();\n                    this.processAction( completion );\n                }\n            } );\n\n            ProgressBar.removeProgressBar( this.tt_assistant_api.getMessageId() );\n            this.addInProgressMessageToConversationHistory( this.tt_assistant_api.getMessageId() );\n            this.scrollToBottom();\n            setTimeout( () => {\n                this.trackProgress( this.tt_assistant_api.getMessageId() );\n            }, 2000 );\n        },\n        parseAnnotations( completion ) {\n            if ( Array.isArray( completion.annotations ) && completion.annotations.length > 0 ) {\n                let annotations = completion.annotations;\n                let result = completion.result;\n\n                for ( let i = 0; i < annotations.length; i++ ) {\n                    let annotation = annotations[i];\n\n                    if ( annotation.type === 'file_path' ) {\n                        // From the OpenAI Documentation: File path annotations are created by the code_interpreter tool and contain references to the files generated by the tool.\n                        // We do not use this type of annotation. Replace the annotation text with nothing.\n                        result = result.replace( annotation.text, '' );\n                    } else if ( annotation.type === 'file_citation' ) {\n                        // From the OpenAI Documentation: File citations are created by the retrieval tool and define references to a specific quote in a specific file that was uploaded and used by the Assistant to generate the response.\n                        let quote = annotation.file_citation.quote ?? null;\n\n                        if ( !quote ) {\n                            result = result.replace( annotation.text, '' );\n                        } else {\n                            let annotated_text = `<div class=\"annotated-text\" data-anotation-id=\"${completion.id}\"> [Source]<span class=\"annotation-content\">${quote}</span></div>`;\n                            result = result.replace( annotation.text, annotated_text );\n                        }\n                    }\n                }\n\n                completion.result = result;\n            }\n\n            //AI will sometimes reference the TimeTrex admin (the docx file assistant has) guide in ways like this: \"These steps will guide you to where you can find the email within the TimeTrex software0timetrex_admin_guide_ai.docx.\"\n            //This is NOT marked as an annotation by OpenAI API, but we still want to replace it with a link to the documentation.\n            let guide_link = '';\n\n            if ( PermissionManager.HelpMenuValidateAdmin() ) {\n                guide_link = 'https://www.timetrex.com/h?id=admin_guide&v=' + LocalCacheData.getLoginData().application_version + '&e=' + Global.getProductEdition();\n            } else if ( PermissionManager.HelpMenuValidateSupervisor() ) {\n                guide_link = 'https://www.timetrex.com/h?id=supervisor_guide&v=' + LocalCacheData.getLoginData().application_version + '&e=' + Global.getProductEdition();\n            } else {\n                guide_link = 'https://www.timetrex.com/h?id=employee_guide&v=' + LocalCacheData.getLoginData().application_version + '&e=' + Global.getProductEdition();\n            }\n\n            completion.result = completion.result.replace(/.*?\\.docx/g, ' <a href=\"' + guide_link + '\" target=\"_blank\">' + $.i18n._( 'View TimeTrex Documentation' ) + '</a>' );\n\n            return completion;\n        },\n        showAnnotation(event) {\n            let annotated_element = event.target.closest('.annotated-text');\n\n            if ( !annotated_element ) {\n                return;\n            }\n\n            let annotation_content = annotated_element.querySelector('.annotation-content');\n\n            if ( !annotation_content ) {\n                return;\n            }\n\n            let overlay = this.$refs.annotation_overlay;\n            if ( !overlay ) {\n                return;\n            }\n\n            overlay.innerHTML = annotation_content.innerHTML;\n            overlay.style.visibility = 'visible';\n            overlay.style.opacity = '1';\n            overlay.style.pointerEvents = 'auto';\n\n            // Wait for the next DOM update cycle to ensure the overlay's dimensions are updated\n            this.$nextTick(() => {\n                let rect = annotated_element.getBoundingClientRect();\n                let overlayWidth = overlay.offsetWidth;\n                let overlayHeight = overlay.offsetHeight;\n\n                let left_position = Math.max(rect.right - overlayWidth - 20, 0); // Ensure it doesn't go off-screen to the left\n                let top_position = rect.top + window.scrollY - overlayHeight;\n\n                overlay.style.top = `${top_position}px`;\n                overlay.style.left = `${left_position}px`;\n            });\n        },\n        hideAnnotation( event ) {\n            let overlay = this.$refs.annotation_overlay;\n            if ( !overlay ) {\n                return;\n            }\n\n            // Determine if the mouse is moving to an element within the ai-modal\n            let moving_within_ai_modal = event.relatedTarget && event.relatedTarget.closest( '.ai-modal' );\n\n            // Only hide the overlay if we're not moving to another element within the ai-modal\n            if ( !moving_within_ai_modal ) {\n                overlay.style.visibility = 'hidden';\n                overlay.style.opacity = '0';\n                overlay.innerHTML = '';\n            }\n        },\n        trackProgress( message_id ) {\n            TTAPI.APIProgressBar.getProgressBar( message_id, {\n                onResult: ( result ) => {\n                    let res_data = result.getResult();\n                    //Means error in progress bar\n                    if ( res_data.hasOwnProperty( 'status_id' ) && res_data.status_id === 9999 ) {\n                        return; //Progress updates have stopped\n                    } else {\n                        if ( res_data === true ||\n                            ( Array.isArray( res_data ) && res_data.length === 0 ) || !res_data.total_iterations ||\n                            typeof res_data.total_iterations !== 'number' ) {\n                            return; //Progress updates have stopped\n                        } else {\n                            let in_progress_message = this.getCompletionByMessageId( message_id );\n                            if ( in_progress_message ) {\n                                if ( in_progress_message.result !== res_data.message && !in_progress_message.id ) {\n                                    in_progress_message = Object.assign( in_progress_message, { result: res_data.message } );\n                                }\n                                setTimeout( () => {\n                                    if ( this.show_spinner ) { //Only track progress if still waiting for response\n                                        this.trackProgress( message_id );\n                                    }\n                                }, 2000 );\n                            } else {\n                                Debug.Text( 'No message found.', 'TTAssistant.vue', 'TTAssistant', 'trackProgress', 11 );\n                                return; //Progress updates have stopped\n                            }\n                        }\n                    }\n                }\n            } );\n        },\n        addInProgressMessageToConversationHistory( message_id ) {\n            let in_progress_message = {\n                role: 'assistant',\n                result: $.i18n._( 'Typing...' ),\n                id: null,\n                message_id: message_id\n            };\n\n            this.completions.push( in_progress_message );\n        },\n        addCompletionToConversationHistory( completion ) {\n            let in_progress_message = this.getCompletionByMessageId( completion.message_id );\n            if ( in_progress_message ) {\n                in_progress_message = Object.assign( in_progress_message, completion );\n            }\n\n            //If there is no in_progress_message then the user cleared the conversation history but this message came in right after.\n            //Just ignore it, as user no longer wants to see it if they cleared the history. Otherwise, it can be odd to see a message appear after clearing the history.\n\n            // else {\n            //     this.completions.push( completion );\n            // }\n        },\n        addUserMessageToConversationHistory( user_prompt ) {\n            let user_message = {\n                role: 'user',\n                result: user_prompt\n            };\n\n            this.completions.push( user_message );\n        },\n        processAction( completion ) {\n            if ( completion.action === 'edit_record' || completion.action === 'add_record' || completion.action === 'view_report' ) {\n                LocalCacheData.setAutoFillData( completion.values );\n            }\n\n            if ( completion.redirect ) {\n                Global.closeEditViews( () => {\n                    if ( completion.action === 'view_report' ) {\n                        IndexViewController.openReport( LocalCacheData.current_open_primary_controller, completion.section );\n                    } else {\n                        //Global.setURLToBrowser fails if already on the list view, therefore we just open the edit view directly.\n                        if ( LocalCacheData.current_open_primary_controller.viewId === completion.section ) {\n                            if ( completion.action === 'add_record' ) {\n                                LocalCacheData.current_open_primary_controller.onAddClick();\n                            } else {\n                                LocalCacheData.current_open_primary_controller.onEditClick( completion.record_id );\n                            }\n                        } else {\n                            Global.setURLToBrowser( completion.redirect );\n                        }\n                    }\n                } );\n            }\n        },\n        addContext( user_prompt, user_input ) {\n            // let last_assistant_completion = this.getLastCompletionByRole( 'assistant' );\n\n            user_input.prompt = user_prompt;\n\n            //Without storing messages in database, we need to pass the context back (if required) to the API with each prompt.\n            user_input.thread_id = this.thread_id;\n            user_input.run_id = this.run_id;\n\n            return user_input;\n        },\n        getCompletionById( id ) {\n            return this.completions.find( ( completion ) => {\n                return completion.id === id;\n            } );\n        },\n        getCompletionByMessageId( message_id ) {\n            return this.completions.find( ( completion ) => {\n                return completion.message_id === message_id;\n            } );\n        },\n        getLastCompletionByRole( role ) {\n            let role_completions = this.completions.filter( ( completion ) => {\n                return completion.role === role;\n            } );\n\n            return role_completions[role_completions.length - 1] || null;\n        },\n        getPromptSettings() {\n            let prompt_settings = {};\n\n            return prompt_settings;\n        },\n        userSubmitPrompt( e ) {\n            e?.preventDefault();\n            this.sendPrompt( this.user_prompt, this.getPromptSettings() );\n        },\n        cancelTTAssistant() {\n            if ( Array.isArray( $.xhrPool ) ) {\n                for ( let i = 0; i < $.xhrPool.length; i++ ) {\n                    if ( $.xhrPool[i].url.includes( 'Class=APITTAssistant&Method=getCompletion' ) ) {\n                        debugger;\n                        $.xhrPool[i].jqXHR.abort();\n                    }\n                }\n            }\n        },\n        dispatchResizeEvent() {\n            setTimeout( () => {\n                window.dispatchEvent( new Event( 'resize' ) );\n            }, 250 );\n        },\n        hideModal() {\n            this.is_visible = false;\n            document.querySelector( '.layout-content' ).style.marginRight = null;\n            this.dispatchResizeEvent();\n        },\n        showModal() {\n            this.is_visible = true;\n            document.querySelector( '.layout-content' ).style.marginRight = '400px';\n            this.dispatchResizeEvent();\n        },\n    },\n    components: {\n        InputText,\n        Checkbox,\n        ProgressSpinner,\n    }\n};\n</script>\n<style scoped>\n.ai-modal {\n    background-color: #f8f8f8;\n    box-shadow: 5px 5px 8px 0px rgba(0, 0, 0, 0.3), 0 0 60px 5px rgba(0, 0, 0, 0.38);\n    position: fixed;\n    top: 50px;\n    right: 0;\n    width: 400px;\n    height: calc(100vh - 50px);\n    z-index: 100;\n    display: flex;\n    flex-direction: column;\n    user-select: text;\n}\n\n.ai-modal-resize-handle {\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    width: 10px;\n    cursor: ew-resize;\n    z-index: 10;\n}\n\n.ai-modal-body {\n    padding: 1rem;\n    flex-grow: 1;\n    overflow-y: auto; /* Adds scrolling if the content is too long */\n}\n\n.spinner-holder {\n    height: 25px;\n}\n\n.ai-modal-footer {\n    padding: 1rem;\n    height: auto;\n}\n\n.ai-input {\n    margin-left: 0.5rem;\n    flex-grow: 1;\n    width: 100%;\n    padding-right: 40px; /* Prevent text from being hidden under the send icon */\n}\n\n.input-wrapper {\n    position: relative;\n    display: flex;\n    align-items: center;\n    width: 100%;\n}\n\n.send-icon {\n    margin-left: 0.5rem;\n    cursor: pointer;\n}\n\n.ai-modal-close {\n    font-size: 2rem;\n    position: absolute;\n    right: 1rem;\n    cursor: pointer\n}\n\n.ai-modal-title {\n    text-align: center;\n    font-weight: 1000;\n}\n\n.conversation-history {\n    margin: 1rem;\n}\n\n.conversation-message {\n    padding: 1rem;\n    border-radius: 3px;\n}\n\n.clear-button {\n    background: #426d9d;\n    border: 0px solid #a1a3a6;\n    color: #ffffff;\n    width: 3rem;\n    font-size: 1rem;\n    border-radius: 4px;\n    text-decoration: none;\n    font-weight: 1000;\n    padding: 3px;\n}\n\n.ttassistant-icon .tticon {\n    color: #ffffff;\n    font-size: 1.75rem !important;\n}\n\n.send-icon i {\n    color: #426d9d;\n}\n\n.form-container.ai-form {\n    display: flex;\n    align-items: center;\n}\n\n::v-deep(.p-progress-spinner-circle) {\n    animation: p-progress-spinner-dash 1.5s ease-in-out infinite, custom-progress-spinner-color 6s ease-in-out infinite;\n}\n\n@keyframes custom-progress-spinner-color {\n    100%,\n    0% {\n        stroke: #000000;\n    }\n    40% {\n        stroke: #000000;\n    }\n    66% {\n        stroke: #000000;\n    }\n    80%,\n    90% {\n        stroke: #000000;\n    }\n}\n\n::v-deep(.p-progress-spinner-svg) {\n    width: 25px;\n    height: 25px;\n}\n\n::v-deep(.p-progress-spinner) {\n    position: relative;\n    left: 44%;\n}\n\n.ai-choice-list {\n    list-style-type: none;\n    padding: 0;\n}\n\n.ai-choice {\n    padding: 0.5rem;\n    margin-top: 0.5rem;\n    cursor: pointer;\n    background: #5382b7;\n    border-radius: 3px;\n    color: #fff;\n}\n\n.ai-choice:hover {\n    background-color: #426d9d;\n}\n\n.ai-disclaimer {\n    text-align: center;\n    margin-bottom: 5px;\n}\n\n::v-deep(.annotated-text) {\n    position: relative;\n    display: inline-block;\n    color: #007bff;\n    cursor: pointer;\n}\n\n::v-deep(.annotation-content) {\n    display: none;\n}\n\n.annotation-overlay {\n    position: fixed;\n    z-index: 1000;\n    background-color: #fff;\n    border: 1px solid #000;\n    border-radius: 2px;\n    padding: 7px;\n    visibility: hidden;\n    opacity: 0;\n    transition: opacity 0.3s;\n    pointer-events: none;\n    width: 500px;\n    height: 300px;\n    overflow-y: auto;\n}\n\n</style>","<!-- This file is originally from the primevue apollo layout, but has been copied into our components for customization -->\n<template>\n    <div class=\"topbar layout-topbar\">\n        <div class=\"left-group\">\n            <button class=\"p-link menu-button\" @click=\"onMenuButtonClick\">\n                <i class=\"pi pi-bars\"></i>\n            </button>\n            <div class=\"company-logo-container\">\n                <router-link to=\"/\" class=\"logo-link\">\n                    <img class=\"logo\" id=\"topbar-company-logo\" :src=\"company_logo\" alt=\"company logo\" @click=\"onCompanyLogoClicked\"/>\n                </router-link>\n            </div>\n            <div class=\"slash-line company-name\">{{ company_name }}</div>\n            <span class=\"topbar-icon topbar-feedback\" v-if=\"show_feedback\">\n                <i class=\"tticon tticon-heart_red_24dp p-mr-4 p-text-secondary\" id=\"profile-feedback\" v-tooltip.bottom=\"tooltips.feedback\" @click=\"onFeedbackClick\"></i>\n            </span>\n        </div>\n        <div class=\"middle-group\">\n            <div v-if=\"isSandboxMode()\" class=\"sandbox-title\">{{ sandbox_mode_text }}</div>\n        </div>\n        <div class=\"right-group\">\n            <ProgressSpinner class=\"job-queue-spinner\" v-if=\"progress_bar_visible\" v-tooltip.bottom=\"tooltips.job_queue\" style=\"width:30px;height:30px\" strokeWidth=\"5\" animationDuration=\"2s\" @click=\"toggleJobQueuePanel\"/>\n            <OverlayPanel ref=\"job-queue-panel\" @show=\"getRunningJobsData\" @hide=\"onHideJobQueuePanel\">\n                <ul class=\"job-queue-list\">\n                    <div class=\"job-queue-item\" v-if=\"pending_job_queue_tasks.length === 0\">{{ job_queue_complete_text }}</div>\n                    <div class=\"job-queue-item\" v-for=\"item in pending_job_queue_tasks\">\n                        <div class=\"job-queue-item-summary\">{{ item.name }}</div>\n                        <div class=\"job-queue-item-detail\">Started {{ item.elapsed_time }} ago</div>\n                    </div>\n                </ul>\n            </OverlayPanel>\n            <span class=\"topbar-icon topbar-inout\" v-if=\"show_punch_in_out\">\n                <i class=\"tticon tticon-timer_black_24dp p-mr-4 p-text-secondary\" id=\"profile-in-out\" v-tooltip.bottom=\"tooltips.in_out\" @click=\"onInOutClick\"></i>\n            </span>\n            <span class=\"topbar-icon topbar-notification-bell\">\n                <i v-if=\"notification_count === 0\" class=\"tticon tticon-notifications_black_24dp p-mr-4 p-text-secondary\" id=\"profile-notifications\" v-tooltip.bottom=\"tooltips.notifications\" @click=\"onNotificationBellClick\"></i>\n                <i v-else class=\"tticon tticon-notifications_black_24dp p-mr-4 p-text-secondary\" id=\"profile-notifications\" v-tooltip.bottom=\"tooltips.notifications\" v-badge.info=\"notification_count\" @click=\"onNotificationBellClick\"></i>\n            </span>\n            <span class=\"topbar-icon topbar-assistant icon-get-attention\" v-if=\"show_assistant\">\n                <i class=\"tticon tticon-stars_black_24dp p-mr-4 p-text-secondary\" id=\"profile-assistant\" v-tooltip.bottom=\"tooltips.assistant\" @click=\"onAssistantClick\"></i>\n            </span>\n            <span class=\"topbar-icon topbar-help\" v-show=\"help_menu_items.length > 0\">\n                <i class=\"tticon tticon-help_center_black_24dp p-mr-4 p-text-secondary\" id=\"profile-help\" v-tooltip.bottom=\"tooltips.help\" @click=\"onTopbarMenuButtonClickHelp\"></i>\n            </span>\n            <!-- Help Menu -->\n            <ul :class=\"topbarItemsClassHelp\" role=\"menu\" id=\"profile-help-items\">\n                <li class=\"profile-menu-item\" v-for=\"item in help_menu_items\">\n                    <div v-if=\"item.separator === true\" class=\"profile-menu-separator\"></div>\n                    <button v-else class=\"p-link\" :id=\"createMenuId(item.id)\" @click=handleMenuClick(item)>\n                        <i class=\"topbar-icon\" :class=\"item.icon\"></i>\n                        <span class=\"topbar-item-name\">{{ item.label }}</span>\n                        <span v-if=\"item.badge_number\" v-badge.info=\"item.badge_number\"></span>\n                    </button>\n                </li>\n            </ul>\n            <div class=\"slash-line\">&nbsp;</div> <!--None breaking space required to show slash-->\n            <button class=\"p-link profile\" id=\"profile-button\" @click=\"onTopbarMenuButtonClickProfile\" v-tooltip.bottom=\"tooltips.profile\">\n                <span class=\"username\">{{ current_user.first_name }} {{ current_user.last_name }}</span>\n                <div class=\"profile-image-holder\">\n                    <img class=\"profile-image\" :src=\"profile_image_url\" alt=\"apollo-layout\"/>\n                </div>\n                <i v-if=\"totalPendingCount === 0\" class=\"pi pi-angle-down\"></i>\n                <i v-else class=\"pi pi-angle-down\" v-badge.info=\"totalPendingCount\"></i>\n            </button>\n            <!-- My Profile Menu -->\n            <ul :class=\"topbarItemsClassProfile\" role=\"menu\" id=\"profile-menu-items\">\n                <li class=\"profile-menu-item\" v-for=\"item in profile_menu_items\">\n                    <div v-if=\"item.separator === true\" class=\"profile-menu-separator\"></div>\n                    <button v-else class=\"p-link\" :id=\"createMenuId(item.id)\" @click=handleMenuClick(item)>\n                        <i class=\"topbar-icon\" :class=\"item.icon\"></i>\n                        <span class=\"topbar-item-name\">{{ item.label }}</span>\n                        <span v-if=\"item.badge_number\" v-badge.info=\"item.badge_number\"></span>\n                    </button>\n                </li>\n            </ul>\n        </div>\n    </div>\n</template>\n<script>\nimport InputText from 'primevue/inputtext';\nimport { Global } from '@/global/Global';\nimport ProgressSpinner from 'primevue/progressspinner';\nimport OverlayPanel from 'primevue/overlaypanel';\nimport TTVueUtils from '@/services/TTVueUtils';\nimport TTAssistant from '@/components/TTAssistant';\n\nexport default {\n    created() {\n        this.event_bus = new TTEventBus( {\n            component_id: this.component_id,\n        } );\n        this.event_bus.on( this.component_id, 'notification_bell', ( event_data ) => {\n            this.updateNotificationCount( event_data.notification_count );\n        } );\n        this.event_bus.on( this.component_id, 'open_assistant', ( event_data ) => {\n            this.onAssistantClick();\n        } );\n        this.event_bus.on( this.component_id, 'refresh_login_data', this.refreshCompanyAndUserInfo );\n        this.event_bus.on( this.component_id, 'refresh_profile_image', ( event_data ) => {\n            this.profile_image_url = this.getProfileImage( true, event_data.image_url );\n        } );\n        this.event_bus.on( this.component_id, 'profile_menu_data', ( event_data ) => {\n            // Get the account menu data from the main menu (MenuManager)\n            this.refreshProfileMenuData( event_data.profile_menu_data );\n        } );\n        this.event_bus.on( this.component_id, 'help_menu_data', ( event_data ) => {\n            // Get the help menu data from the main menu (MenuManager)\n            this.refreshHelpMenuData( event_data.help_menu_data );\n        } );\n        this.event_bus.on( this.component_id, 'profile_pending_counts', ( event_data ) => {\n            // Get the number of pending authorizations, notifications and messages for the current user.\n            this.updateProfilePendingTotals( event_data.object_types );\n        } );\n        this.event_bus.on( 'global', 'reset_vue_data', this.resetData );\n        this.event_bus.on( this.component_id, 'toggle_job_queue_spinner', ( event_data ) => {\n            if ( event_data.get_job_data ) {\n                this.getRunningJobsData();\n            }\n            if ( event_data.show ) {\n                this.showJobQueueSpinner();\n            }\n            if ( event_data.check_completed ) {\n                this.checkForJobQueuePendingTasks();\n            }\n        } );\n        TTPromise.resolve( 'VueMenu', 'waitOnTopBarCreated' ); //Final promise before main menu is built, as this component needs to be created first.\n        this.refreshCompanyAndUserInfo();\n    },\n    beforeUnmount() {\n        this.hideJobQueueSpinner( false );\n    },\n    props: {\n        topbarMenuActive: Boolean,\n        activeTopbarItem: String\n    },\n    data() {\n        return {\n            component_id: 'tt_topbar',\n            company_name: '',\n            company_logo: '',\n            current_user: {},\n            profile_image_url: '',\n            notification_count: 0,\n            profile_menu_items: [],\n            help_menu_items: [],\n            pending_job_queue_tasks: [],\n            progress_bar_visible: false,\n            show_punch_in_out: true, //See refreshCompanyAndUserInfo()\n            show_feedback: false, //See refreshCompanyAndUserInfo()\n            show_assistant: true, //See refreshCompanyAndUserInfo()\n            active_dropdown_menu: '', //Instead of using activeTopbarItem prop, only need to set active_dropdown_menu in this component.\n            has_mounted_tt_assistant: false,\n            tooltips: {\n                assistant: $.i18n._( 'AI Assistant' ),\n                feedback: $.i18n._( 'Show your support!' ),\n                in_out: $.i18n._( 'In/Out' ),\n                notifications: $.i18n._( 'Notifications' ),\n                help: $.i18n._( 'Help' ),\n                profile: $.i18n._( 'Employee Profile' ),\n                job_queue: $.i18n._( 'Running Tasks' ),\n            },\n            sandbox_mode_text: $.i18n._( 'Sandbox Mode' ),\n            job_queue_complete_text: $.i18n._( 'All Tasks Completed' )\n        };\n    },\n    interval: null,\n    computed: {\n        topbarItemsClassProfile() {\n            return ['topbar-menu fadeInDown', {\n                'topbar-menu-visible': this.topbarMenuActive && this.active_dropdown_menu === 'profile',\n            }];\n        },\n        topbarItemsClassHelp() {\n            return ['topbar-menu fadeInDown', {\n                'topbar-menu-visible': this.topbarMenuActive && this.active_dropdown_menu === 'help',\n            }];\n        },\n        totalPendingCount() {\n            return this.profile_menu_items.filter( ( item ) => item.badge_number > 0 ).reduce( ( total, item ) => total + item.badge_number, 0 );\n        }\n        /*notificationsCount() {\n            Notifications currently are not shown on profile dropdown but we may wish to show it there in the future;\n            let notification_item = this.profile_menu_items.find( ( item ) => item.id === 'notification' );\n            return notification_item && notification_item.badge_number ? notification_item.badge_number : 0;\n        },*/\n    },\n    methods: {\n        resetData() {\n            this.hideJobQueueSpinner( false ); //Make sure job queue spinner is hidden and cancelled (especially during logout).\n            Object.assign( this.$data, this.$options.data() );\n        },\n        handleMenuClick( item ) {\n            item.command();\n        },\n        refreshProfileMenuData( data ) {\n            this.profile_menu_items.length = 0;\n            this.profile_menu_items.push( ...data );\n        },\n        refreshHelpMenuData( data ) {\n            this.help_menu_items.length = 0;\n            this.help_menu_items.push( ...data );\n        },\n        updateProfilePendingTotals( object_types ) {\n            TTAPI.APIUser.getUserPendingTotals( object_types, {\n                onResult: ( result ) => {\n                    let pending_counts = result.getResult();\n\n                    //Assign totals to the corresponding profile menu item badge number.\n                    this.profile_menu_items.forEach( item => {\n                        if ( pending_counts[item.id] || pending_counts[item.id] === 0 ) {\n                            if ( Global.UNIT_TEST_MODE == true ) {\n                                pending_counts[item.id] = 999;\n                            }\n                            item.badge_number = pending_counts[item.id];\n                        }\n                    } );\n\n                    if ( pending_counts['notification'] ) {\n                        if ( Global.UNIT_TEST_MODE == true ) {\n                            pending_counts['notification'] = 999;\n                        }\n                        this.notification_count = pending_counts['notification'];\n                    }\n                }\n            } );\n        },\n        onMenuButtonClick( event ) {\n            this.$emit( 'menubutton-click', event );\n        },\n        onTopbarMenuButtonClickProfile( event ) {\n            this.active_dropdown_menu = 'profile';\n            if ( this.profile_menu_items.length === 0 ) {\n                //This should never happen. It previously would happen consistently on FireFox and rarely Chrome/Other Browsers due to race conditions.\n                Debug.Error( 'Error: Profile Menu Items are empty. Rebuilding the menu.', 'ContextMenuManager.js', 'ContextMenuManager', 'getMenuModelByMenuId', 1 );\n                this.event_bus.emit( 'tt_left_container', 'rebuild_menu' );\n            }\n            this.$emit( 'topbar-menubutton-click', event );\n        },\n        onTopbarMenuButtonClickHelp( event ) {\n            this.active_dropdown_menu = 'help';\n            this.$emit( 'topbar-menubutton-click', event );\n        },\n        onCompanyLogoClicked() {\n            Global.closeEditViews( function() {\n                MenuManager.goToView( 'Home' );\n            } );\n        },\n        onNotificationBellClick() {\n            Global.closeEditViews( function() {\n                MenuManager.goToView( 'Notification' );\n            } );\n        },\n        onFeedbackClick() {\n            var current_user = LocalCacheData.getLoginUser();\n\n            TAlertManager.showConfirmAlert( LocalCacheData.getLoginData().application_name + ' ' + $.i18n._( 'is <strong>free</strong> because of people like you, ' + current_user.first_name + '!<br><br>Show your support with a 5-star review!<br><br>' ), $.i18n._( 'Show your support!' ), function( flag ) {\n                if ( flag === true ) {\n                    Global.sendAnalyticsEvent( 'feedback', 'review', 'review:feedback:yes' );\n\n                    var support_email_address = ( current_user.work_email != '' ? current_user.work_email : ( current_user.home_email != '' ? current_user.home_email : 'EmailNotSpecified@NoDomain.com' ) ); //Fall back to a bogus email address otherwise the live chat will be rejected, and some people have complained about that.\n                    var url = 'https://www.timetrex.com/community-reviews?v=' + LocalCacheData.getLoginData().application_version + '&e=' + Global.getProductEdition() + '&registration_key=' + LocalCacheData.getLoginData().registration_key + '&email=' + support_email_address + '&first_name=' + current_user.first_name + '#reviews';\n                    window.open( url, '_blank' );\n                } else {\n                    Global.sendAnalyticsEvent( 'feedback', 'review', 'review:feedback:no' );\n                }\n            }, $.i18n._( 'Leave a Review!' ), $.i18n._( 'No, thanks.' ) );\n\n            Global.sendAnalyticsEvent( 'feedback', 'review', 'review:feedback:click' );\n        },\n        onAssistantClick() {\n            if ( !this.has_mounted_tt_assistant ) {\n                TTVueUtils.mountComponent( 'tt-assistant-ui', TTAssistant, {\n                    view_id: 'tt-assistant-view',\n                    component_id: 'tt-assistant-ui',\n                } );\n\n                this.has_mounted_tt_assistant = true;\n            } else {\n                this.event_bus.emit( 'tt_assistant', 'show_tt_assistant' );\n            }\n        },\n        onInOutClick() {\n            if ( LocalCacheData.getLastPunchTime() === null || ( ( new Date().getTime() - LocalCacheData.getLastPunchTime() ) / 1000 ) > 60 ) {\n                Global.closeEditViews( function() {\n                    MenuManager.openSelectView( 'InOut' );\n                } );\n            } else {\n                let seconds_remaining = ( 60 - ( new Date().getTime() - LocalCacheData.getLastPunchTime() ) / 1000 );\n                TAlertManager.showAlert( $.i18n._( 'Please wait at least ' ) + Math.round( seconds_remaining ) + $.i18n._( ' seconds to punch again.' ) );\n            }\n        },\n        updateNotificationCount( count ) {\n            if ( Global.UNIT_TEST_MODE == true ) {\n                count = 999;\n            }\n            this.notification_count = count;\n        },\n        getProfileImage( cache_buster = false, image_url = null ) {\n            let profile_image_url = '';\n\n            if ( image_url ) {\n                //Image was provided by event bus from EmployeeViewController when image was updated.\n                profile_image_url = image_url;\n            } else {\n                //User logged in and we need to get the image from the server.\n                profile_image_url = ServiceCaller.getURLByObjectType( 'user_photo' ) + '&object_id=' + this.current_user.id;\n                if ( cache_buster ) {\n                    //Helps useds see their profile image update when they change it we need to update the URL, as Vue does not detect the change.\n                    profile_image_url += '&refresh_id=' + TTUUID.generateUUID();\n                }\n            }\n\n            return profile_image_url;\n        },\n        refreshCompanyAndUserInfo( force ) {\n            if ( !this.company_name || force ) {\n                if ( !this.current_user.id || ( this.current_user.id && LocalCacheData.getLoginUser().id !== this.current_user.id ) ) {\n                    //This condition triggers when a new user logs in or page is refreshed.\n\n                    //Setup notifications and ping check for the new user.\n                    IndexViewController.initializeNotifications( 'login' );\n                    Global.setupPing();\n\n                    //This ensures the main menu updates and shows the correct menu items for the current users permissions.\n                    //Otherwise the user may see menu items from the last logged in user.\n                    this.event_bus.emit( 'tt_left_container', 'rebuild_menu' );\n                    this.updateProfilePendingTotals( [] );\n                }\n                this.company_name = LocalCacheData.getCurrentCompany().name;\n                this.current_user = LocalCacheData.getLoginUser();\n                this.profile_image_url = this.getProfileImage();\n                this.company_logo = ServiceCaller.getURLByObjectType( 'company_logo' );\n                this.show_punch_in_out = PermissionManager.validate( 'punch', 'punch_in_out' );\n                this.show_assistant = Global.getFeatureFlag( 'assistant' ) && ( PermissionManager.getPermissionLevel() >= 40 );\n                this.show_feedback = ( Global.getProductEdition() == 10 && LocalCacheData.deployment_on_demand == true && APIGlobal.pre_login_data.demo_mode == false && Global.getFeatureFlag( 'support_chat' ) == true && Global.getFeatureFlag( 'show_feedback' ) == true && PermissionManager.getPermissionLevel() >= 40 );\n                this.event_bus.emit( 'tt_main_ui', 'get_user_saved_layout_mode' );\n            }\n        },\n        isSandboxMode() {\n            return APIGlobal.pre_login_data['sandbox'];\n        },\n        toggleJobQueuePanel( event ) {\n            this.$refs['job-queue-panel'].toggle( event );\n        },\n        showJobQueueSpinner() {\n            this.progress_bar_visible = true;\n            this.startIntervalJobQueueTimer();\n        },\n        hideJobQueueSpinner( update_timesheet ) {\n            this.progress_bar_visible = false;\n            this.pending_job_queue_tasks = [];\n            clearInterval( this.interval );\n            this.interval = null;\n            this.$refs['job-queue-panel'].hide();\n\n            LocalCacheData.setJobQueuePunchData( null );\n\n            if ( update_timesheet && LocalCacheData.current_open_primary_controller && LocalCacheData.current_open_primary_controller.viewId === 'TimeSheet' ) {\n                LocalCacheData.current_open_primary_controller.search();\n            }\n        },\n        getRunningJobsData() {\n            let data = {};\n            data.filter_data = { user_id: this.current_user.id, status_id: [10, 20] };\n            TTAPI.APISystemJobQueue.getSystemJobQueue( data, {\n                onResult: ( result ) => {\n                    if ( result.isValid() ) {\n                        let result_data = result.getResult();\n                        if ( Array.isArray( result_data ) ) {\n                            this.pending_job_queue_tasks = result_data;\n                        } else {\n                            this.pending_job_queue_tasks = [];\n                        }\n                    }\n                }\n            } );\n        },\n        startIntervalJobQueueTimer() {\n            clearInterval( this.interval );\n            this.interval = setInterval( () => {\n                this.checkForJobQueuePendingTasks();\n            }, 60000 );\n        },\n        checkForJobQueuePendingTasks() {\n            TTAPI.APISystemJobQueue.getPendingAndRunningSystemJobQueue( {\n                onResult: ( result ) => {\n                    let pending_counts = result.getResult();\n                    if ( pending_counts == 0 ) {\n                        this.hideJobQueueSpinner( true );\n                    }\n                }\n            } );\n        },\n        onHideJobQueuePanel() {\n            if ( this.pending_job_queue_tasks.length === 0 ) {\n                this.hideJobQueueSpinner( true );\n            }\n        },\n        createMenuId( menu_id ) {\n            return 'profile-menu-' + menu_id;\n        },\n    },\n    components: {\n        InputText, // Added by RT\n        ProgressSpinner,\n        OverlayPanel\n    }\n};\n</script>\n<style scoped>\n.layout-container .topbar {\n    padding: 0;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.left-group {\n    display: flex;\n    align-items: center;\n    /* No padding-left here, as it's put in the menu-button to make for better shaped selection border/accessibility border) */\n}\n\n.right-group {\n    display: flex;\n    align-items: center;\n    padding-right: 5px;\n}\n\n.topbar-icon {\n    margin: 5px 7px;\n}\n\n.topbar-icon .tticon {\n    color: #ffffff;\n    font-size: 2rem !important;\n    cursor: pointer;\n}\n\n.layout-container .topbar .username {\n    font-weight: 700;\n    font-size: 13px;\n}\n\n.layout-container .topbar .company-name {\n    font-size: 13px;\n    font-weight: bold;\n}\n\n.layout-container .topbar .topbar-menu {\n    right: 5px; /* Bring it closer to the edge, so it looks less like its under the bell, and more under the profile menu. */\n}\n\n.layout-container .topbar {\n    width: 100%;\n}\n\n.topbar .topbar-item-name {\n    font-size: 13px;\n}\n\n.profile-image-holder {\n    width: 40px;\n    height: 40px;\n    vertical-align: middle;\n    overflow: hidden;\n    margin-right: 8px;\n    display: inline-block;\n    border-radius: 50%;\n}\n\n.profile-image {\n    height: 40px;\n    object-fit: cover;\n}\n\n.profile-menu-separator {\n    border-top: 1px solid #dee2e6;\n    margin: .25rem 0;\n}\n\n.sandbox-title {\n    font-size: 24px;\n    color: white;\n}\n\n::v-deep(.profile .p-overlay-badge .p-badge) {\n    right: 23px;\n    top: -5px;\n}\n\n::v-deep(.topbar-notification-bell .p-badge) {\n    top: 1px; /* This is to ensure notification badge is at same height as the profile badge */\n    right: 3px; /* Reduce overlap with help icon */\n}\n\n.topbar .profile-menu-item .p-link {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.job-queue-spinner {\n    margin-right: 5px;\n}\n\n.job-queue-list {\n    padding: 0 10px 0 10px;\n}\n\n.job-queue-item {\n    margin: 10px;\n}\n\n.job-queue-item-summary {\n    font-weight: 600;\n}\n\n.job-queue-item-detail {\n    color: #6c757d;\n}\n\n\n::v-deep(.p-progress-spinner-circle) {\n    animation: p-progress-spinner-dash 1.5s ease-in-out infinite, custom-progress-spinner-color 6s ease-in-out infinite;\n}\n\n@keyframes custom-progress-spinner-color {\n    100%,\n    0% {\n        stroke: #ffffff;\n    }\n    40% {\n        stroke: #ffffff;\n    }\n    66% {\n        stroke: #ffffff;\n    }\n    80%,\n    90% {\n        stroke: #ffffff;\n    }\n}\n\n/* Topbar menu classes taken from Apollo Vue 3.3 */\n\n.layout-container .topbar {\n    background-color: #32679b;\n    /* padding: 10px 16px; */\n    height: 50px;\n    box-sizing: border-box;\n    position: fixed;\n    top: 0px;\n    width: 100%;\n    z-index: 102;\n    -webkit-box-sizing: border-box;\n    -moz-box-sizing: border-box;\n    box-sizing: border-box;\n}\n\n.layout-container .topbar .menu-button {\n    cursor: pointer;\n    vertical-align: top;\n    height: 50px;\n    width: 50px;\n    line-height: 50px;\n    text-align: center;\n    margin-top: -10px;\n    margin-left: 30px;\n    color: #ffffff;\n    user-select: none;\n    transition: background-color 0.2s;\n}\n\n.layout-container .topbar .menu-button i {\n    font-size: 28px;\n    line-height: inherit;\n}\n\n.layout-container .topbar .menu-button:hover {\n    background-color: #69b9f7;\n}\n\n.layout-container .topbar .profile {\n    float: right;\n    text-align: right;\n    margin-top: -5px;\n    font-weight: 700;\n    cursor: pointer;\n}\n\n.layout-container .topbar .profile img {\n    vertical-align: middle;\n    width: 40px;\n    margin-right: 8px;\n}\n\n.layout-container .topbar .profile .username {\n    vertical-align: middle;\n    margin-right: 8px;\n    color: #ffffff;\n}\n\n.layout-container .topbar .profile .pi {\n    font-size: 16px;\n    vertical-align: middle;\n    color: #ffffff;\n}\n\n.layout-container .topbar .topbar-menu {\n    display: none;\n    position: absolute;\n    cursor: pointer;\n    /* right: 0; */\n    top: 50px;\n    width: 250px;\n    list-style-type: none;\n    padding: 0;\n    margin: 0;\n    background-color: #32679b;\n    animation-duration: 0.2s;\n}\n\n.layout-container .topbar .topbar-menu.topbar-menu-visible {\n    display: block;\n}\n\n.layout-container .topbar .topbar-menu > li button {\n    width: 100%;\n    font-family: \"Source Sans Pro\", Arial, sans-serif;\n    font-size: 14px;\n    color: #ffffff;\n    padding: 10px 16px;\n}\n\n.layout-container .topbar .topbar-menu > li button i {\n    font-size: 16px;\n    display: inline-block;\n    vertical-align: middle;\n}\n\n.layout-container .topbar .topbar-menu > li button span {\n    margin-left: 6px;\n    display: inline-block;\n    vertical-align: middle;\n}\n\n.layout-container .topbar .topbar-menu > li button img {\n    display: inline-block;\n    vertical-align: middle;\n}\n\n.layout-container .topbar .topbar-menu > li button .topbar-badge {\n    float: right;\n    background-color: #ffffff;\n    display: block;\n    color: #39a3f4;\n    width: 18px;\n    height: 18px;\n    line-height: 18px;\n    text-align: center;\n    margin-top: 1px;\n    border-radius: 50%;\n}\n\n.layout-container .topbar .topbar-menu > li button:hover {\n    background-color: #69b9f7;\n}\n\n.layout-container .topbar .topbar-menu > li ul {\n    list-style-type: none;\n    padding: 0;\n    margin: 0;\n}\n\n.layout-container .topbar .topbar-menu > li ul button {\n    padding-left: 32px;\n}\n\n.layout-container.layout-overlay .topbar .menu-button, .layout-container.layout-static .topbar .menu-button {\n    display: inline-block;\n}\n\n.layout-container.layout-slim .topbar .menu-button, .layout-container.layout-horizontal .topbar .menu-button {\n    display: inline-block;\n}\n\n/* Profile Menu Overrides */\n\n.layout-container .topbar .topbar-menu {\n    border-top: 1px solid #264e74;\n    border-top-width: 1px;\n    border-top-style: solid;\n}\n\n.profile-menu-item .topbar-item-name {\n    flex: 1;\n}\n\n.topbar .profile-menu-item .p-overlay-badge {\n    margin-right: 9px;\n}\n\n.layout-container .topbar .menu-button {\n    width: auto;\n    margin-top: 0; /* This overrides the apollo -10px but does not work with our flexbox model */\n    margin-left: 5px; /* This overrides the apollo margin-left: 30px and balances the left and right spacing around the menu button in static and overlay menu mode. */\n    margin-right: 5px;\n    padding-left: 10px;\n    padding-right: 10px;\n}\n\n.layout-container .topbar .menu-button:focus {\n    outline: none;\n    box-shadow: none;\n}\n\n.layout-container.layout-slim .topbar .menu-button, .layout-content-wrapper.layout-horizontal .topbar .menu-button {\n    display: inline-block; /* Override hidden on slim and horizontal layout. Matches the behaviour for static menu, so that the menu button is visible on slim and horizontal mode, and we can use it to toggle between static, slim and horizontal. */\n}\n\n.layout-container .topbar .menu-button i {\n    font-size: 20px;\n}\n\n.layout-container .topbar .logo-link {\n    /* Overrides the fixed 185px width for the logo from PrimeVue */\n    width: auto;\n    max-width: 185px;\n}\n\n.company-logo-container {\n    background: #ffffff;\n    margin-left: 5px; /* Separates the logo from the left egde of the page in Slim Menu mode. */\n    padding: 5px;\n    border-radius: 4px;\n}\n\n.slash-line {\n    position: relative;\n    display: inline-block;\n    margin-left: 20px;\n    color: #ffffff;\n}\n\n.slash-line:before {\n    content: \"\";\n    position: absolute;\n    top: -50%;\n    left: -10px;\n    height: 200%;\n    width: 1px;\n    background: #ffffff;\n}\n\n.profile {\n    padding-left: 8px; /* Ensures the active outline box for accessibility looks nicer with a slight gap all around rather than no gap between border and text. */\n    padding-right: 5px; /* Ensures the active outline box for accessibility looks nicer with a slight gap all around rather than no gap between border and text. */\n    margin-right: 5px;\n    margin-top: 0 !important;\n}\n\n.layout-container .topbar .logo-link .logo {\n    height: 30px;\n}\n\n.topbar .profile-menu-item .p-link {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.layout-container.layout-overlay .topbar, .layout-container.layout-static .topbar {\n    box-shadow: 0 2px 4px #0000004d;\n}\n\n::v-deep(.p-badge.p-badge-info) {\n    background-color: #0288d1;\n    color: #ffffff;\n}\n\n::v-deep(.p-badge) {\n    background: #32689b;\n    color: #ffffff;\n    font-size: .75rem;\n    font-weight: 700;\n    min-width: 1.5rem;\n    height: 1.5rem;\n    line-height: 1.5rem;\n}\n\n.layout-container .topbar .left-group .menu-button:hover {\n    background-color: #3f82c1;\n}\n\n.layout-container .topbar .topbar-menu>li button:hover {\n    background-color: #3f82c1;\n}\n\n.icon-get-attention {\n    animation: shrinkGrow 2s 15 ease-in-out;\n}\n\n@keyframes shrinkGrow {\n    0% {\n        transform: scale(1);\n    }\n    50% {\n        transform: scale(1.25);\n    }\n    100% {\n        transform: scale(1);\n    }\n}\n</style>","<template>\n    <div class=\"tt-top layout-topbar\">\n        <TTTopBar v-if=\"ready_to_load_top_bar\"\n                  :topbarMenuActive=\"topbarMenuActive\"\n                  :activeTopbarItem=\"activeTopbarItem\"\n                  @menubutton-click=\"onMenuButtonClick\"\n                  @topbar-menubutton-click=\"onTopbarMenuButtonClick\"\n                  @topbar-item-click=\"onTopbarItemClick\"></TTTopBar>\n    </div>\n</template>\n<script>\nimport TTTopBar from '@/components/TTTopbar';\n\nexport default {\n    created() {\n        this.event_bus = new TTEventBus( {\n            component_id: this.component_id,\n        } );\n        this.event_bus.on( this.component_id, 'ready_to_load_top_bar', ( event_data ) => {\n            this.ready_to_load_top_bar = true;\n        } );\n    },\n    data() {\n        return {\n            component_id: 'tt_top_container',\n            ready_to_load_top_bar: false,\n        };\n    },\n    props: {\n        topbarMenuActive: Boolean,\n        activeTopbarItem: String\n    },\n    methods: {\n        onMenuButtonClick( event ) {\n            this.$emit( 'menubutton-click', event );\n        },\n        onTopbarMenuButtonClick( event ) {\n            this.$emit( 'topbar-menubutton-click', event );\n        },\n        onTopbarItemClick( event ) {\n            this.$emit( 'topbar-item-click', event );\n        }\n    },\n    components: {\n        TTTopBar: TTTopBar,\n    }\n};\n</script>\n<style scoped>\n.layout-topbar {\n    height: 50px;\n    margin-bottom: 0;\n    /*padding: 16px 20px 0 20px;*/\n    /*background: #32679b;*/\n}\n\n.tt-top {\n    width: 100%;\n}\n</style>\n","import { toRefs, reactive, computed } from 'vue';\n\nconst layoutConfig = reactive({\n    menuMode: 'static',\n    menuTheme: 'colorScheme',\n    colorScheme: 'light',\n    theme: 'indigo',\n    scale: 14\n});\n\nconst layoutState = reactive({\n    staticMenuDesktopInactive: false,\n    overlayMenuActive: false,\n    sidebarActive: false,\n    anchored: false,\n    overlaySubmenuActive: false,\n    profileSidebarVisible: false,\n    configSidebarVisible: false,\n    staticMenuMobileActive: false,\n    menuHoverActive: false,\n    activeMenuItem: null\n});\n\nexport function useLayout() {\n    const setScale = (scale) => {\n        layoutConfig.scale = scale;\n    };\n\n    const setActiveMenuItem = (item) => {\n        layoutState.activeMenuItem = item.value || item;\n    };\n\n    const onMenuToggle = () => {\n        if (layoutConfig.menuMode === 'overlay') {\n            layoutState.overlayMenuActive = !layoutState.overlayMenuActive;\n        }\n\n        if (window.innerWidth > 991) {\n            layoutState.staticMenuDesktopInactive = !layoutState.staticMenuDesktopInactive;\n        } else {\n            layoutState.staticMenuMobileActive = !layoutState.staticMenuMobileActive;\n        }\n    };\n\n    const onProfileSidebarToggle = () => {\n        layoutState.profileSidebarVisible = !layoutState.profileSidebarVisible;\n    };\n\n    const onConfigSidebarToggle = () => {\n        layoutState.configSidebarVisible = !layoutState.configSidebarVisible;\n    };\n\n    const isSidebarActive = computed(() => layoutState.overlayMenuActive || layoutState.staticMenuMobileActive || layoutState.overlaySubmenuActive);\n\n    const isDarkTheme = computed(() => layoutConfig.darkTheme);\n\n    const isDesktop = computed(() => window.innerWidth > 991);\n\n    const isSlim = computed(() => layoutConfig.menuMode === 'slim');\n    const isSlimPlus = computed(() => layoutConfig.menuMode === 'slim-plus');\n\n    const isHorizontal = computed(() => layoutConfig.menuMode === 'horizontal');\n\n    return {\n        layoutConfig: toRefs(layoutConfig),\n        layoutState: toRefs(layoutState),\n        setScale,\n        onMenuToggle,\n        isSidebarActive,\n        isDarkTheme,\n        setActiveMenuItem,\n        onProfileSidebarToggle,\n        onConfigSidebarToggle,\n        isSlim,\n        isSlimPlus,\n        isHorizontal,\n        isDesktop\n    };\n}\n","<script setup>\nimport { ref, onBeforeMount, watch, nextTick } from 'vue';\nimport { useRoute } from 'vue-router';\nimport { useLayout } from './composables/layout';\nimport { DomHandler } from 'primevue/utils';\nconst route = useRoute();\n\nconst { layoutConfig, layoutState, setActiveMenuItem, onMenuToggle, isHorizontal, isSlim, isSlimPlus, isDesktop } = useLayout();\n\nconst props = defineProps({\n    item: {\n        type: Object,\n        default: () => ({})\n    },\n    index: {\n        type: Number,\n        default: 0\n    },\n    root: {\n        type: Boolean,\n        default: true\n    },\n    parentItemKey: {\n        type: String,\n        default: null\n    }\n});\n\nconst isActiveMenu = ref(false);\nconst itemKey = ref(null);\nconst subMenuRef = ref(null);\nconst menuItemRef = ref(null);\n\nonBeforeMount(() => {\n    itemKey.value = props.parentItemKey ? props.parentItemKey + '-' + props.index : String(props.index);\n\n    const activeItem = layoutState.activeMenuItem.value;\n\n    isActiveMenu.value = activeItem === itemKey.value || activeItem ? activeItem.startsWith(itemKey.value + '-') : false;\n    handleRouteChange(route.path);\n});\n\nwatch(\n    () => isActiveMenu.value,\n    () => {\n        const rootIndex = props.root ? props.index : parseInt(`${props.parentItemKey}`[0], 10);\n        const overlay = document.querySelectorAll('.layout-root-submenulist')[rootIndex];\n        const target = document.querySelectorAll('.layout-root-menuitem')[rootIndex];\n\n        if ((isSlim.value || isSlimPlus.value || isHorizontal.value) && isDesktop) {\n            nextTick(() => {\n                calculatePosition(overlay, target);\n            });\n        }\n    }\n);\n\nwatch(\n    () => layoutState.activeMenuItem.value,\n    (newVal) => {\n        isActiveMenu.value = newVal === itemKey.value || newVal.startsWith(itemKey.value + '-');\n    }\n);\n\nwatch(\n    () => layoutConfig.menuMode.value,\n    () => {\n        isActiveMenu.value = false;\n    }\n);\n\nwatch(\n    () => layoutState.overlaySubmenuActive.value,\n    (newValue) => {\n        if (!newValue) {\n            isActiveMenu.value = false;\n        }\n    }\n);\n\nwatch(() => route.path, handleRouteChange);\n\nwatch(\n    () => route.path,\n    (newPath) => {\n        if (!(isSlim.value || isSlimPlus.value || isHorizontal.value) && props.item.to && props.item.to === newPath) {\n            setActiveMenuItem(itemKey);\n        } else if (isSlim.value || isSlimPlus.value || isHorizontal.value) {\n            isActiveMenu.value = false;\n        }\n    }\n);\nconst itemClick = async (event, item) => {\n    if (item.disabled) {\n        event.preventDefault();\n        return;\n    }\n\n    const { overlayMenuActive, staticMenuMobileActive } = layoutState;\n\n    if ((item.to || item.url) && (staticMenuMobileActive.value || overlayMenuActive.value)) {\n        onMenuToggle();\n    }\n\n    if (item.command) {\n        item.command({ originalEvent: event, item: item });\n    }\n\n    if (item.items) {\n        if (props.root && isActiveMenu.value && (isSlim.value || isSlimPlus.value || isHorizontal.value)) {\n            layoutState.overlaySubmenuActive.value = false;\n            layoutState.menuHoverActive.value = false;\n\n            return;\n        }\n\n        setActiveMenuItem(isActiveMenu.value ? props.parentItemKey : itemKey);\n\n        if (props.root && !isActiveMenu.value && (isSlim.value || isSlimPlus.value || isHorizontal.value)) {\n            layoutState.overlaySubmenuActive.value = true;\n            layoutState.menuHoverActive.value = true;\n            isActiveMenu.value = true;\n\n            removeAllTooltips();\n        }\n    } else {\n        if (!isDesktop) {\n            layoutState.staticMenuMobileActive.value = !layoutState.staticMenuMobileActive.value;\n        }\n\n        if (isSlim.value || isSlimPlus.value || isHorizontal.value) {\n            layoutState.overlaySubmenuActive.value = false;\n            layoutState.menuHoverActive.value = false;\n\n            return;\n        }\n\n        setActiveMenuItem(itemKey);\n    }\n};\n\nfunction handleRouteChange(newPath) {\n    if (!(isSlim.value || isSlimPlus.value || isHorizontal.value) && props.item.to && props.item.to === newPath) {\n        setActiveMenuItem(itemKey);\n    } else if (isSlim.value || isSlimPlus.value || isHorizontal.value) {\n        isActiveMenu.value = false;\n    }\n}\n\nconst onMouseEnter = () => {\n    if (props.root && (isSlim.value || isSlimPlus.value || isHorizontal.value) && isDesktop) {\n        if (!isActiveMenu.value && layoutState.menuHoverActive.value) {\n            setActiveMenuItem(itemKey);\n        }\n    }\n};\nconst removeAllTooltips = () => {\n    const tooltips = document.querySelectorAll('.p-tooltip');\n    tooltips.forEach((tooltip) => {\n        tooltip.remove();\n    });\n};\nconst calculatePosition = (overlay, target) => {\n    if (overlay) {\n        const { left, top } = target.getBoundingClientRect();\n        const { width: vWidth, height: vHeight } = DomHandler.getViewport();\n        const [oWidth, oHeight] = [overlay.offsetWidth, overlay.offsetHeight];\n        const scrollbarWidth = DomHandler.calculateScrollbarWidth();\n\n        // reset\n        overlay.style.top = overlay.style.left = '';\n\n        if (isHorizontal.value) {\n            const width = left + oWidth + scrollbarWidth;\n            overlay.style.left = vWidth < width ? `${left - (width - vWidth)}px` : `${left}px`;\n        } else if (isSlim.value || isSlimPlus.value) {\n            const height = top + oHeight;\n            overlay.style.top = vHeight < height ? `${top - (height - vHeight)}px` : `${top}px`;\n        }\n    }\n};\n\nconst checkActiveRoute = (item) => {\n    return route.path === item.to;\n};\n</script>\n\n<template>\n    <li ref=\"menuItemRef\" :class=\"{ 'layout-root-menuitem': root, 'active-menuitem': isActiveMenu }\">\n        <div v-if=\"root && item.visible !== false\" class=\"layout-menuitem-root-text\">{{ item.label }}</div>\n        <a\n            v-if=\"(!item.to || item.items) && item.visible !== false\"\n            :href=\"item.url\"\n            @click=\"itemClick($event, item, index)\"\n            :class=\"item.class\"\n            :target=\"item.target\"\n            tabindex=\"0\"\n            @mouseenter=\"onMouseEnter\"\n            v-tooltip.hover=\"isSlim && root && !isActiveMenu ? item.label : null\"\n        >\n            <i :class=\"item.icon\" class=\"layout-menuitem-icon\"></i>\n            <span class=\"layout-menuitem-text\">{{ item.label }}</span>\n            <i class=\"pi pi-fw pi-angle-down layout-submenu-toggler\" v-if=\"item.items\"></i>\n        </a>\n        <router-link\n            v-if=\"item.to && !item.items && item.visible !== false\"\n            @click=\"itemClick($event, item, index)\"\n            :class=\"[item.class, { 'active-route': checkActiveRoute(item) }]\"\n            tabindex=\"0\"\n            :to=\"item.to\"\n            @mouseenter=\"onMouseEnter\"\n            v-tooltip.hover=\"(isSlim || isSlimPlus) && root && !isActiveMenu ? item.label : null\"\n        >\n            <i :class=\"item.icon\" class=\"layout-menuitem-icon\"></i>\n            <span class=\"layout-menuitem-text\">{{ item.label }}</span>\n            <i class=\"pi pi-fw pi-angle-down layout-submenu-toggler\" v-if=\"item.items\"></i>\n        </router-link>\n\n        <ul ref=\"subMenuRef\" :class=\"{ 'layout-root-submenulist': root }\" v-if=\"item.items && item.visible !== false\">\n            <AppMenuItem v-for=\"(child, i) in item.items\" :key=\"child\" :index=\"i\" :item=\"child\" :parentItemKey=\"itemKey\" :root=\"false\"></AppMenuItem>\n        </ul>\n    </li>\n</template>\n","<template>\n\t<AppSubmenu ref=\"appSubMenu\" id=\"main-menu\" class=\"layout-menu layout-main-menu clearfix\"\n                :model=\"model\"\n                :layoutMode=\"layoutMode\"\n                :menuActive=\"active\"\n                :root=\"false\"\n                :parentMenuItemActive=\"true\"\n                :mobileMenuActive=\"mobileMenuActive\"/>\n</template>\n\n<script>\nimport AppSubmenu from '@/framework/apollo-vue/src/layout/AppSubMenu.vue';\n\nexport default {\n    created() {\n        this.event_bus = new TTEventBus( {\n            component_id: this.component_id,\n        } );\n        this.event_bus.on( this.component_id, 'set_active_index', ( event_data ) => {\n            this.$refs.appSubMenu.activeIndex = event_data.index;\n        } );\n    },\n    data() {\n        return {\n            component_id: 'app_menu',\n        }\n    },\n\tprops: {\n\t\tmodel: Array,\n\t\tlayoutMode: String,\n\t\tactive: Boolean,\n        mobileMenuActive: Boolean\n\t},\n\tcomponents: {\n\t\t'AppSubmenu': AppSubmenu\n\t}\n}\n</script>\n\n<style scoped>\n\n</style>","<template>\n    <div class=\"tt-menu-search-container\">\n        <AutoComplete class=\"tt-menu-search\" placeholder=\"Search Menu\" v-model=\"terms\" :suggestions=\"searchSuggestions\"\n                      optionGroupLabel=\"label\" optionGroupChildren=\"items\"\n                      @complete=\"searchMenu($event)\" @item-select=\"selectItem($event)\" field=\"label\" :minLength=\"minLength\"/>\n    </div>\n    <div class=\"search-separator\"></div>\n</template>\n<script>\nimport AutoComplete from 'primevue/autocomplete';\n\nexport default {\n    name: 'TTMenuSearch',\n    props: {\n        model: Array,\n        search: String,\n    },\n    data() {\n        return {\n            terms: null,\n            searchSuggestions: null,\n            minLength: 2\n        };\n    },\n    methods: {\n        searchMenu( event ) {\n            let findItems = ( items, suggestions, group_header ) => {\n                let filtered_items = [];\n                for ( let i = 0; i < items.length; i++ ) {\n                    //If item is a valid menu link compare the label to the search term and add to filtered items if matches.\n                    if ( items[i].parent_id && items[i].command && items[i].label && items[i].label.toLowerCase().includes( event.query.toLowerCase() ) ) {\n                        filtered_items.push( items[i] );\n                    }\n                    //If item is a header and has child items, recursively search child items.\n                    if ( items[i].items && items[i].items.length > 0 ) {\n                        suggestions = findItems( items[i].items, suggestions, items[i].label );\n                    }\n                    //Finally add all items from that group to the suggestions by the group header.\n                    if ( i === items.length - 1 && filtered_items.length > 0 && group_header ) {\n                        suggestions.push( { label: group_header, items: filtered_items } );\n                    }\n                }\n                return suggestions;\n            };\n\n            this.searchSuggestions = findItems( this.model, [] );\n        },\n        selectItem( event ) {\n            event.value.command();\n        },\n    },\n    components: {\n        AutoComplete\n    }\n};\n</script>\n<style scoped>\n.tt-menu-search-container {\n    margin: 5px;\n    width: 100%;\n}\n\n.search-separator {\n    border-top: 1px solid #dee2e6;\n}\n\n::v-deep(.tt-menu-search) {\n    width: calc(100% - 10px);\n}\n\n::v-deep(.p-inputtext) {\n    width: 100%;\n}\n</style>\n","// Imports\n// Relies on Debug in @/global/Debug.js imported as a global in HTML tags.\n// Relies on TopMenuManager imported as a global in main.js\nimport TTEventBus from '@/services/TTEventBus';\n\n// TODO: Add in the wizards and dialog (In/Out) options etc.\n// TODO: Check all items are present, compared to old menu. Check permissions!\n// TODO: Fix the group duplicate/missing errors in console. This was just after the big menu update of all items.\n// TODO: - Previously the link was parent -> subgroup -> item.\n// TODO: - And now, the item needs to link direct to the parent, and that association has to be edited manually, so quite a lot to get through.\n// TODO: Fix the menu width when the browser is resized down to mobile. This is related to the width override. Perhaps change the width in the SCSS source files.\n// TODO: Do the colour of the topbar correctly using SCSS 'theme' files so that the theme can be properly changed in future.\n// TODO: Add Account Menu dividers.\n// TODO: Build new context menu with PrimeVue buttons, spend about 20 mins on seeing if we can edit an existing button.\n// Otherwise use v-if vue options to show hide the Save and Save Next as diff buttons.\n// right click menu mirrors the context menu. it has to be completely flat, rather than the grouping for context.\n// context manager that controls both formats. start with the main menu class?\n// TODO: later on: the CSS changes together with moving the company name and support chat links\n// TODO: back burner: Ordering logic needs to be done for main menu. Do this after context menu.\n\nclass MenuManager {\n\tconstructor() {\n\t\tthis.event_bus = new TTEventBus( {\n\t\t\tcomponent_id: 'menu_manager',\n\t\t} );\n\t\tthis.menu_items = [];\n\t\tthis.menu_locked = false; // Track state of menu built/unbuilt. Menu must be reset before items can be added. Otherwise there will be a mix of built and unbuilt items.\n\t\twindow._main_menu = this; // TODO: Temp for local debugging.\n\t}\n\n\tlockMenu() {\n\t\tthis.menu_locked = true;\n\t}\n\tunlockMenu() {\n\t\tthis.menu_locked = false;\n\t}\n\tisMenuLocked() {\n\t\treturn Boolean( this.menu_locked );\n\t}\n\taddItem( item ) {\n\t\tif( this.menu_locked ) {\n\t\t\tDebug.Error( 'Menu is built and locked. Reset menu before adding new items.', 'MenuManager.js', 'MenuManager', 'addItem', 2 );\n\t\t\treturn false;\n\t\t}\n\t\tif( typeof item !== 'object' || item === null || item === undefined ) {\n\t\tDebug.Error( 'Invalid menu item', 'MenuManager.js', 'MenuManager', 'addItem', 2 );\n\t\t\treturn false;\n\t\t}\n\t\tif( this.menu_items.filter( ( menu_item_check ) => menu_item_check.id === item.id ).length !== 0 ) {\n\t\t\tDebug.Error( 'Duplicate menu item. Item ID ('+ item.id +') already exists in menu.', 'MenuManager.js', 'MenuManager', 'addItem', 2 );\n\t\t\treturn false;\n\t\t}\n\t\titem = new TTMenuItem( item );\n\t\tthis.menu_items.push( item );\n\t}\n\n\t/**\n\t * Get the previously built menu model in PrimeVue format without rebuilding the menu on every request.\n\t * @returns {boolean|[]}\n\t */\n\tgetMenu() {\n\t\tif( !this.menu_locked ) {\n\t\t\tDebug.Error( 'Menu has not been built yet. Run convertMenuItemsToPrimeVueFormat() or rebuildMenu()', 'MenuManager.js', 'MenuManager', 'getMenu', 2 );\n\t\t\treturn false;\n\t\t}\n\t\treturn this.menu_items;\n\t}\n\n\trebuildMenu() {\n\t\tthis.initDefaultMenuItems();\n\t\tthis.getMenu();\n\t\treturn this.menu_items;\n\t}\n\n\tconvertMenuItemsToPrimeVueFormat() {\n\t\tif( this.menu_locked ) {\n\t\t\tDebug.Error( 'Menu is already built and locked. Reset menu before rebuilding.', 'MenuManager.js', 'MenuManager', 'convertMenuItemsToPrimeVueFormat', 2 );\n\t\t\treturn false;\n\t\t}\n\n\t\t// Starting build process, lock menu.\n\t\tthis.lockMenu();\n\n\t\tvar menu_output = [];\n\n\t\tthis.menu_items.forEach(( item ) => {\n\t\t\t// Make a copy of the item, by creating a TTMenuItem. Otherwise when items are added to group headers, the item[] array will keep growing on each generation run. Using a class instance also helps be more Object Orientated.\n\t\t\t//item = new TTMenuItem( item );\n\n\t\t\t// Handle tt_link data.\n\t\t\tif ( item.destination && item.tt_link ) {\n\t\t\t\titem.parseTTLink();\n\t\t\t}\n\n\t\t\tif ( item.url_type === 'view' && item.destination ) {\n\t\t\t\titem.url = Global.getBaseURL() + '#!m=' + item.destination;\n\t\t\t} else if ( item.url_type === 'sub_view' && item.destination ) {\n\t\t\t\titem.url = Global.getBaseURL() + '#!m=Home&sm=' + item.destination;\n\t\t\t} else if ( !item.url && item.destination ) {\n\t\t\t\titem.url = Global.getBaseURL() + '#!m=Home'; //If view cannot be reached by a URL, go to Home.\n\t\t\t}\n\n\t\t\t// check if permissions allow this icon for this user.\n\t\t\tif( item.permission_result === false ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Check if item already exists in menu.\n\t\t\tif( menu_output.filter( ( menu_item_check ) => menu_item_check.id === item.id ).length !== 0 ) {\n\t\t\t\t// Error: Item already exists.\n\t\t\t\tDebug.Error( 'Menu item ('+ item.id +') already exists. Duplicate warning.', 'MenuManager.js', 'MenuManager', 'convertMenuItemsToPrimeVueFormat', 2 );\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif ( item.hide_in_main_menu ) {\n\t\t\t\titem.visible = false; //We do not want to show menu items that have been moved elsewhere (such as topbar) in the main menu.\n\t\t\t}\n\n\t\t\t// Grouping. Add item to a parent group, or if no group, add as a root menu element.\n\t\t\tif( item.parent_id ) {\n\n\t\t\t\t// Check if needle_value with that group already exists in output. If not error out and say groups must come before items.\n\n\t\t\t\t// menu_output.forEach(( array_item ) => {\n\t\t\t\t// var group_check = menu_output.map(copy).filter( function recursiveFilter( array_item ) {\n\n\t\t\t\tvar parent_result = this.menu_items.filter( ( parent_item_check ) => parent_item_check.id === item.parent_id )\n\n\t\t\t\tif ( parent_result.length === 1 ) {\n\t\t\t\t\t// Group exists. Add item to the group.\n\t\t\t\t\tparent_result[0].items = parent_result[0].items || []; // By creating a new items array here, rather than earlier (or during addItem), it will always be a fresh array reference on every menu model generation run.\n\t\t\t\t\tparent_result[0].items.push( item ); // relies on JS pass-by-reference to add the items.\n\t\t\t\t} else {\n\t\t\t\t\t// Error: Group either does not exist or duplicates.\n\t\t\t\t\tDebug.Error( 'Menu group ('+ item.parent_id +') for ('+ item.id +') does not exist or there are duplicates. Check addItem() ordering, as group must be added to menu before items can be added.', 'MenuManager.js', 'MenuManager', 'convertMenuItemsToPrimeVueFormat', 2 );\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\t// Item has no parent_id, treat as root menu element.\n\t\t\t\tmenu_output.push( item );\n\t\t\t}\n\t\t});\n\n\t\t// Return only menu item groups that have passed the following checks.\n\t\tvar validated_items = menu_output.filter( ( validation_item ) => {\n\t\t\tif ( validation_item.items ) {\n\t\t\t\t//Each report menu item is a potential dropdown with an array of items if permission checks succeed.\n\t\t\t\t//Checking one level deeper to remove those items if they do not contain items or are a link / separator themselves.\n\t\t\t\tvalidation_item.items = validation_item.items.filter( ( item, index, items_array ) => {\n\t\t\t\t\tif ( item.parent_id && !item.destination && !item.separator && ( !item.items || item.items.every( child_item => child_item.separator ) ) ) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\t//This fixes issues where due to user permissions there might be unwanted separators.\n\t\t\t\t\t//For example there might be multiple separators in a row or the first/last item might be a separator.\n\t\t\t\t\tif ( item.separator && ( index === 0 || index === items_array.length - 1 || items_array[index - 1].separator ) ) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tvar contains_items = Boolean( validation_item.items !== undefined && validation_item.items.length !== 0\n\t\t\t\t&& validation_item.items.some( item => !item.separator ) ); //Make sure top level contains an actual menu item and not only separators.\n\t\t\tvar has_destination = Boolean( validation_item.destination );\n\t\t\tvar is_separator = Boolean( validation_item.separator );\n\n\t\t\treturn ( contains_items || has_destination || is_separator );\n\t\t} );\n\n\t\tthis.menu_items = validated_items;\n\t}\n\n\tinitDefaultMenuItems() {\n\t\t// reset menu before building.\n\t\tthis.menu_items = [];\n\t\tthis.unlockMenu();\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Dashboard' ),\n\t\t\tid: 'home',\n\t\t\torder: 1000,\n\t\t\ticon: 'tticon tticon-speed_black_24dp',\n\t\t\tdestination: 'Home',\n\t\t\turl_type: 'view'\n\t\t} );\n\n\t\t//Attendance Menu\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Attendance' ),\n\t\t\tid: 'attendance_menu',\n\t\t\torder: 100000,\n\t\t\ticon: 'tticon tticon-schedule_black_24dp',\n\t\t} );\n\n\t\t//Attendance Group Sub Menu\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'TimeSheet' ),\n\t\t\tid: 'TimeSheet',\n\t\t\tdestination: 'TimeSheet',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'attendance_menu',\n\t\t\tsub_group_id: 'attendance_attendance',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'TimeSheet' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Punches' ),\n\t\t\tid: 'Punches',\n\t\t\tdestination: 'Punches',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'attendance_menu',\n\t\t\tsub_group_id: 'attendance_attendance',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Punches' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Exceptions' ),\n\t\t\tid: 'Exception',\n\t\t\tdestination: 'Exception',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'attendance_menu',\n\t\t\tsub_group_id: 'attendance_attendance',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Exception' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Accrual Balances' ),\n\t\t\tid: 'AccrualBalance',\n\t\t\tdestination: 'AccrualBalance',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'attendance_menu',\n\t\t\tsub_group_id: 'attendance_attendance',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'AccrualBalance' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Accruals' ),\n\t\t\tid: 'Accrual',\n\t\t\tdestination: 'Accrual',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'attendance_menu',\n\t\t\tsub_group_id: 'attendance_attendance',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Accrual' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tid: 'separator_attendance_1',\n\t\t\tparent_id: 'attendance_menu',\n\t\t\tseparator: true,\n\t\t\tclass: 'p-menu-separator'\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Jobs' ),\n\t\t\tid: 'Job',\n\t\t\tdestination: 'Job',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'attendance_menu',\n\t\t\tsub_group_id: 'attendance_job_tracking',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Job' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Tasks' ),\n\t\t\tid: 'JobItem',\n\t\t\tdestination: 'JobItem',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'attendance_menu',\n\t\t\tsub_group_id: 'attendance_job_tracking',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'JobItem' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Punch Tags' ),\n\t\t\tid: 'PunchTag',\n\t\t\tdestination: 'PunchTag',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'attendance_menu',\n\t\t\tsub_group_id: 'attendance_job_tracking',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PunchTag' )\n\t\t} );\n\n\t\t//GeoFencing\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'GEO Fences' ),\n\t\t\tid: 'attendance_GEOFence',\n\t\t\tdestination: 'GEOFence',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'attendance_menu',\n\t\t\tsub_group_id: 'attendance_job_tracking',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'GEOFence' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Job Groups' ),\n\t\t\tid: 'JobGroup',\n\t\t\tdestination: 'JobGroup',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'attendance_menu',\n\t\t\tsub_group_id: 'attendance_job_tracking',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'JobGroup' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Task Groups' ),\n\t\t\tid: 'JobItemGroup',\n\t\t\tdestination: 'JobItemGroup',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'attendance_menu',\n\t\t\tsub_group_id: 'attendance_job_tracking',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'JobItemGroup' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Punch Tag Groups' ),\n\t\t\tid: 'PunchTagGroup',\n\t\t\tdestination: 'PunchTagGroup',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'attendance_menu',\n\t\t\tsub_group_id: 'attendance_job_tracking',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PunchTagGroup' )\n\t\t} );\n\n\t\t//Schedule Menu\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Schedule' ),\n\t\t\tid: 'schedule_menu',\n\t\t\ticon: 'tticon tticon-calendar_today_black_24dp',\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Schedules' ),\n\t\t\tid: 'Schedule',\n\t\t\tdestination: 'Schedule',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'schedule_menu',\n\t\t\tsub_group_id: 'attendance_schedule',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Schedule' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Scheduled Shifts' ),\n\t\t\tid: 'ScheduleShift',\n\t\t\tdestination: 'ScheduleShift',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'schedule_menu',\n\t\t\tsub_group_id: 'attendance_schedule',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ScheduleShift' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Recurring Schedules' ),\n\t\t\tid: 'RecurringScheduleControl',\n\t\t\tdestination: 'RecurringScheduleControl',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'schedule_menu',\n\t\t\tsub_group_id: 'attendance_schedule',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'RecurringScheduleControl' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Recurring Templates' ),\n\t\t\tid: 'RecurringScheduleTemplateControl',\n\t\t\tdestination: 'RecurringScheduleTemplateControl',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'schedule_menu',\n\t\t\tsub_group_id: 'attendance_schedule',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'RecurringScheduleTemplateControl' )\n\t\t} );\n\n\t\t//Employee Menu\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Employee' ),\n\t\t\tid: 'employee_menu',\n\t\t\ticon: 'tticon tticon-people_alt_black_24dp',\n\t\t} );\n\n\t\t//Employee group Sub Menu\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Employees' ),\n\t\t\tid: 'Employee',\n\t\t\tdestination: 'Employee',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'employee_menu',\n\t\t\tsub_group_id: 'employee_employee',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Employee' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Employee Contacts' ),\n\t\t\tid: 'UserContact',\n\t\t\tdestination: 'UserContact',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'employee_menu',\n\t\t\tsub_group_id: 'employee_employee',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'UserContact' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Preferences' ),\n\t\t\tid: 'UserPreference',\n\t\t\tdestination: 'UserPreference',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'employee_menu',\n\t\t\tsub_group_id: 'employee_employee',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'UserPreference' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Wages' ),\n\t\t\tid: 'Wage',\n\t\t\tdestination: 'Wage',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'employee_menu',\n\t\t\tsub_group_id: 'employee_employee',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Wage' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Pay Methods' ),\n\t\t\tid: 'RemittanceDestinationAccount',\n\t\t\tdestination: 'RemittanceDestinationAccount',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'employee_menu',\n\t\t\tsub_group_id: 'employee_employee',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'RemittanceDestinationAccount' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Titles' ),\n\t\t\tid: 'UserTitle',\n\t\t\tdestination: 'UserTitle',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'employee_menu',\n\t\t\tsub_group_id: 'employee_employee',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'UserTitle' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Employee Groups' ),\n\t\t\tid: 'UserGroup',\n\t\t\tdestination: 'UserGroup',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'employee_menu',\n\t\t\tsub_group_id: 'employee_employee',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'UserGroup' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Ethnic Groups' ),\n\t\t\tid: 'EthnicGroup',\n\t\t\tdestination: 'EthnicGroup',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'employee_menu',\n\t\t\tsub_group_id: 'employee_employee',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'EthnicGroup' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'New Hire Defaults' ),\n\t\t\tid: 'UserDefault',\n\t\t\tdestination: 'UserDefault',\n\t\t\turl_type: Global.getProductEdition() > 10 ? 'view' : 'sub_view',\n\t\t\tparent_id: 'employee_menu',\n\t\t\tsub_group_id: 'employee_employee',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'UserDefault' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Record of Employment' ),\n\t\t\tid: 'ROE',\n\t\t\tdestination: 'ROE',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'employee_menu',\n\t\t\tsub_group_id: 'employee_employee',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ROE' )\n\t\t} );\n\n\t\t//Company Menu\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Company' ),\n\t\t\tid: 'company_menu',\n\t\t\ticon: 'tticon tticon-business_black_24dp'\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Companies' ),\n\t\t\tid: 'Companies',\n\t\t\tdestination: 'Companies',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'company_menu',\n\t\t\tsub_group_id: 'company_company',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Companies' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Company Information' ),\n\t\t\tid: 'Company',\n\t\t\tdestination: 'Company',\n\t\t\turl_type: 'sub_view',\n\t\t\tparent_id: 'company_menu',\n\t\t\tsub_group_id: 'company_company',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Company' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: ( Global.getProductEdition() >= 15 ) ? $.i18n._( 'Legal Entities' ) : $.i18n._( 'Legal Entity' ),\n\t\t\tid: 'LegalEntity',\n\t\t\tdestination: 'LegalEntity',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'company_menu',\n\t\t\tsub_group_id: 'company_company',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'LegalEntity' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Branches' ),\n\t\t\tid: 'Branch',\n\t\t\tdestination: 'Branch',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'company_menu',\n\t\t\tsub_group_id: 'company_company',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Branch' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Departments' ),\n\t\t\tid: 'Department',\n\t\t\tdestination: 'Department',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'company_menu',\n\t\t\tsub_group_id: 'company_company',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Department' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Hierarchy' ),\n\t\t\tid: 'HierarchyControl',\n\t\t\tdestination: 'HierarchyControl',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'company_menu',\n\t\t\tsub_group_id: 'company_company',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'HierarchyControl' )\n\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Secondary Wage Groups' ),\n\t\t\tid: 'WageGroup',\n\t\t\tdestination: 'WageGroup',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'company_menu',\n\t\t\tsub_group_id: 'company_company',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'WageGroup' )\n\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Stations' ),\n\t\t\tid: 'Station',\n\t\t\tdestination: 'Station',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'company_menu',\n\t\t\tsub_group_id: 'company_company',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Station' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Permission Groups' ),\n\t\t\tid: 'PermissionControl',\n\t\t\tdestination: 'PermissionControl',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'company_menu',\n\t\t\tsub_group_id: 'company_company',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PermissionControl' )\n\t\t} );\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Currencies' ),\n\t\t\tid: 'Currency',\n\t\t\tdestination: 'Currency',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'company_menu',\n\t\t\tsub_group_id: 'company_company',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Currency' )\n\n\t\t} );\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Custom Fields' ),\n\t\t\tid: 'CustomField',\n\t\t\tdestination: 'CustomField',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'company_menu',\n\t\t\tsub_group_id: 'company_company',\n\t\t\tpermission_result: ( PermissionManager.checkTopLevelPermission( 'CustomField' ) && Global.getFeatureFlag( 'custom_field' ) == true )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tid: 'separator_company_1',\n\t\t\tparent_id: 'company_menu',\n\t\t\tseparator: true,\n\t\t\tclass: 'p-menu-separator'\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Import' ),\n\t\t\tid: 'ImportCSV',\n\t\t\tdestination: 'ImportCSV',\n\t\t\tparent_id: 'company_menu',\n\t\t\tsub_group_id: 'company_other',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ImportCSV' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Quick Start' ),\n\t\t\tid: 'QuickStartWizard',\n\t\t\tdestination: 'QuickStartWizard',\n\t\t\tparent_id: 'company_menu',\n\t\t\tsub_group_id: 'company_other',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'QuickStartWizard' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Payroll' ),\n\t\t\tid: 'payroll_menu',\n\t\t\ticon: 'tticon tticon-attach_money_black_24dp'\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Process Payroll' ),\n\t\t\tid: 'ProcessPayrollWizard',\n\t\t\tdestination: 'ProcessPayrollWizard',\n\t\t\tparent_id: 'payroll_menu',\n\t\t\tsub_group_id: 'payroll_payroll',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PayrollProcessWizard' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Tax Wizard' ),\n\t\t\tid: 'PayrollRemittanceAgencyEventWizardController',\n\t\t\tdestination: 'PayrollRemittanceAgencyEventWizardController',\n\t\t\tparent_id: 'payroll_menu',\n\t\t\tsub_group_id: 'payroll_payroll',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PayrollProcessWizard' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Pay Stubs' ),\n\t\t\tid: 'PayStub',\n\t\t\tdestination: 'PayStub',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'payroll_menu',\n\t\t\tsub_group_id: 'payroll_payroll',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PayStub' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Pay Stub Transactions' ),\n\t\t\tid: 'PayStubTransaction',\n\t\t\tdestination: 'PayStubTransaction',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'payroll_menu',\n\t\t\tsub_group_id: 'payroll_payroll',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PayStubTransaction' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Government Documents' ),\n\t\t\tid: 'GovernmentDocument',\n\t\t\tdestination: 'GovernmentDocument',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'payroll_menu',\n\t\t\tsub_group_id: 'payroll_payroll',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'GovernmentDocument' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Pay Periods' ),\n\t\t\tid: 'PayPeriods',\n\t\t\tdestination: 'PayPeriods',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'payroll_menu',\n\t\t\tsub_group_id: 'payroll_payroll',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PayPeriods' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Pay Stub Amendments' ),\n\t\t\tid: 'PayStubAmendment',\n\t\t\tdestination: 'PayStubAmendment',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'payroll_menu',\n\t\t\tsub_group_id: 'payroll_payroll',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PayStubAmendment' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Pay Period Schedules' ),\n\t\t\tid: 'payroll_PayPeriodSchedule',\n\t\t\tdestination: 'PayPeriodSchedule',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'payroll_menu',\n\t\t\tsub_group_id: 'payroll_payroll',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PayPeriodSchedule' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Pay Stub Accounts' ),\n\t\t\tid: 'PayStubEntryAccount',\n\t\t\tdestination: 'PayStubEntryAccount',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'payroll_menu',\n\t\t\tsub_group_id: 'payroll_payroll',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PayStubEntryAccount' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Taxes & Deductions' ),\n\t\t\tid: 'CompanyTaxDeduction',\n\t\t\tdestination: 'CompanyTaxDeduction',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'payroll_menu',\n\t\t\tsub_group_id: 'payroll_payroll',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'CompanyTaxDeduction' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Remittance Agencies' ),\n\t\t\tid: 'PayrollRemittanceAgency',\n\t\t\tdestination: 'PayrollRemittanceAgency',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'payroll_menu',\n\t\t\tsub_group_id: 'payroll_payroll',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PayrollRemittanceAgency' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Remittance Sources' ),\n\t\t\tid: 'RemittanceSourceAccount',\n\t\t\tdestination: 'RemittanceSourceAccount',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'payroll_menu',\n\t\t\tsub_group_id: 'payroll_payroll',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'RemittanceSourceAccount' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Expenses' ),\n\t\t\tid: 'UserExpense',\n\t\t\tdestination: 'UserExpense',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'payroll_menu',\n\t\t\tsub_group_id: 'payroll_payroll',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'UserExpense' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Policy' ),\n\t\t\tid: 'policy_menu',\n\t\t\ticon: 'tticon tticon-rule_folder_black_24dp'\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Policy Groups' ),\n\t\t\tid: 'PolicyGroup',\n\t\t\tdestination: 'PolicyGroup',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_building_blocks',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PolicyGroup' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tid: 'separator_policy_1',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tseparator: true,\n\t\t\tclass: 'p-menu-separator'\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Pay Codes' ),\n\t\t\tid: 'PayCode',\n\t\t\tdestination: 'PayCode',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_building_blocks',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PayCode' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Pay Formulas' ),\n\t\t\tid: 'PayFormulaPolicy',\n\t\t\tdestination: 'PayFormulaPolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_building_blocks',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PayFormulaPolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Contributing Pay Codes' ),\n\t\t\tid: 'ContributingPayCodePolicy',\n\t\t\tdestination: 'ContributingPayCodePolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_building_blocks',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ContributingPayCodePolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Contributing Shifts' ),\n\t\t\tid: 'ContributingShiftPolicy',\n\t\t\tdestination: 'ContributingShiftPolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_building_blocks',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ContributingShiftPolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Accrual Accounts' ),\n\t\t\tid: 'AccrualPolicyAccount',\n\t\t\tdestination: 'AccrualPolicyAccount',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_building_blocks',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'AccrualPolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Recurring Holidays' ),\n\t\t\tid: 'RecurringHoliday',\n\t\t\tdestination: 'RecurringHoliday',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_building_blocks',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'RecurringHoliday' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tid: 'separator_policy_2',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tseparator: true,\n\t\t\tclass: 'p-menu-separator'\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Schedule Policies' ),\n\t\t\tid: 'SchedulePolicy',\n\t\t\tdestination: 'SchedulePolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_policy',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'SchedulePolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Rounding Policies' ),\n\t\t\tid: 'RoundIntervalPolicy',\n\t\t\tdestination: 'RoundIntervalPolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_policy',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'RoundIntervalPolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Meal Policies' ),\n\t\t\tid: 'MealPolicy',\n\t\t\tdestination: 'MealPolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_policy',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'MealPolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Break Policies' ),\n\t\t\tid: 'BreakPolicy',\n\t\t\tdestination: 'BreakPolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_policy',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'BreakPolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Regular Time  Policies' ),\n\t\t\tid: 'RegularTimePolicy',\n\t\t\tdestination: 'RegularTimePolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_policy',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'RegularTimePolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Overtime Policies' ),\n\t\t\tid: 'OvertimePolicy',\n\t\t\tdestination: 'OvertimePolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_policy',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'OvertimePolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Premium Policies' ),\n\t\t\tid: 'PremiumPolicy',\n\t\t\tdestination: 'PremiumPolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_policy',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PremiumPolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Exception Policies' ),\n\t\t\tid: 'ExceptionPolicyControl',\n\t\t\tdestination: 'ExceptionPolicyControl',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_policy',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ExceptionPolicyControl' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Accrual Policies' ),\n\t\t\tid: 'AccrualPolicy',\n\t\t\tdestination: 'AccrualPolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_policy',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'AccrualPolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Absence Policies' ),\n\t\t\tid: 'AbsencePolicy',\n\t\t\tdestination: 'AbsencePolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_policy',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'AbsencePolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Expense Policies' ),\n\t\t\tid: 'ExpensePolicy',\n\t\t\tdestination: 'ExpensePolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_policy',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ExpensePolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Holiday Policies' ),\n\t\t\tid: 'HolidayPolicy',\n\t\t\tdestination: 'HolidayPolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'policy_menu',\n\t\t\tsub_group_id: 'policy_policy',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'HolidayPolicy' )\n\t\t} );\n\n\t\t// Invoice group\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Invoice' ),\n\t\t\tid: 'invoice_menu',\n\t\t\ticon: 'tticon tticon-receipt_long_black_24dp'\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Clients' ),\n\t\t\tid: 'Client',\n\t\t\tdestination: 'Client',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tsub_group_id: 'invoice_invoice',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Client' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Client Contacts' ),\n\t\t\tid: 'ClientContact',\n\t\t\tdestination: 'ClientContact',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tsub_group_id: 'invoice_invoice',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ClientContact' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Invoices' ),\n\t\t\tid: 'Invoice',\n\t\t\tdestination: 'Invoice',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tsub_group_id: 'invoice_invoice',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Invoice' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Transactions' ),\n\t\t\tid: 'InvoiceTransaction',\n\t\t\tdestination: 'InvoiceTransaction',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tsub_group_id: 'invoice_invoice',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'InvoiceTransaction' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Payment Methods' ),\n\t\t\tid: 'ClientPayment',\n\t\t\tdestination: 'ClientPayment',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tsub_group_id: 'invoice_invoice',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ClientPayment' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Products' ),\n\t\t\tid: 'Product',\n\t\t\tdestination: 'Product',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tsub_group_id: 'invoice_invoice',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Product' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Districts' ),\n\t\t\tid: 'InvoiceDistrict',\n\t\t\tdestination: 'InvoiceDistrict',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tsub_group_id: 'invoice_invoice',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'InvoiceDistrict' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tid: 'separator_invoice_1',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tseparator: true,\n\t\t\tclass: 'p-menu-separator'\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Client Groups' ),\n\t\t\tid: 'ClientGroup',\n\t\t\tdestination: 'ClientGroup',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tsub_group_id: 'invoice_groups',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Client' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Product Groups' ),\n\t\t\tid: 'ProductGroup',\n\t\t\tdestination: 'ProductGroup',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tsub_group_id: 'invoice_groups',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Product' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tid: 'separator_invoice_2',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tseparator: true,\n\t\t\tclass: 'p-menu-separator'\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Tax Policies' ),\n\t\t\tid: 'TaxPolicy',\n\t\t\tdestination: 'TaxPolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tsub_group_id: 'invoice_policies',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'TaxPolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Shipping Policies' ),\n\t\t\tid: 'ShippingPolicy',\n\t\t\tdestination: 'ShippingPolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tsub_group_id: 'invoice_policies',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ShippingPolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Area Policies' ),\n\t\t\tid: 'AreaPolicy',\n\t\t\tdestination: 'AreaPolicy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tsub_group_id: 'invoice_policies',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'AreaPolicy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tid: 'separator_invoice_3',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tseparator: true,\n\t\t\tclass: 'p-menu-separator'\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Payment Gateway' ),\n\t\t\tid: 'PaymentGateway',\n\t\t\tdestination: 'PaymentGateway',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tsub_group_id: 'invoice_settings',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PaymentGateway' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Settings' ),\n\t\t\tid: 'InvoiceConfig',\n\t\t\tdestination: 'InvoiceConfig',\n\t\t\turl_type: 'sub_view',\n\t\t\tparent_id: 'invoice_menu',\n\t\t\tsub_group_id: 'invoice_settings',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'InvoiceConfig' )\n\t\t} );\n\n\t\t//HR Menu\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'HR' ),\n\t\t\tid: 'hr_menu',\n\t\t\ticon: 'tticon tticon-business_center_black_24dp'\n\t\t} );\n\n\t\t//reviews Group Sub Menu\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Reviews' ),\n\t\t\tid: 'UserReviewControl',\n\t\t\tdestination: 'UserReviewControl',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'hr_menu',\n\t\t\tsub_group_id: 'hr_reviews',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'UserReviewControl' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'KPI' ),\n\t\t\tid: 'KPI',\n\t\t\tdestination: 'KPI',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'hr_menu',\n\t\t\tsub_group_id: 'hr_reviews',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'KPI' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'KPI Groups' ),\n\t\t\tid: 'KPIGroup',\n\t\t\tdestination: 'KPIGroup',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'hr_menu',\n\t\t\tsub_group_id: 'hr_reviews',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'KPIGroup' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tid: 'separator_hr_1',\n\t\t\tparent_id: 'hr_menu',\n\t\t\tseparator: true,\n\t\t\tclass: 'p-menu-separator'\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Qualifications' ),\n\t\t\tid: 'Qualification',\n\t\t\tdestination: 'Qualification',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'hr_menu',\n\t\t\tsub_group_id: 'hr_qualifications',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Qualification' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Qualification Groups' ),\n\t\t\tid: 'QualificationGroup',\n\t\t\tdestination: 'QualificationGroup',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'hr_menu',\n\t\t\tsub_group_id: 'hr_qualifications',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'QualificationGroup' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Skills' ),\n\t\t\tid: 'UserSkill',\n\t\t\tdestination: 'UserSkill',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'hr_menu',\n\t\t\tsub_group_id: 'hr_qualifications',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'UserSkill' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Education' ),\n\t\t\tid: 'UserEducation',\n\t\t\tdestination: 'UserEducation',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'hr_menu',\n\t\t\tsub_group_id: 'hr_qualifications',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'UserEducation' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Memberships' ),\n\t\t\tid: 'UserMembership',\n\t\t\tdestination: 'UserMembership',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'hr_menu',\n\t\t\tsub_group_id: 'hr_qualifications',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'UserMembership' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Licenses' ),\n\t\t\tid: 'UserLicense',\n\t\t\tdestination: 'UserLicense',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'hr_menu',\n\t\t\tsub_group_id: 'hr_qualifications',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'UserLicense' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Languages' ),\n\t\t\tid: 'UserLanguage',\n\t\t\tdestination: 'UserLanguage',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'hr_menu',\n\t\t\tsub_group_id: 'hr_qualifications',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'UserLanguage' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Recruitment' ),\n\t\t\tid: 'recruitment_menu',\n\t\t\ticon: 'tticon tticon-switch_account_black_24dp'\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Job Vacancies' ),\n\t\t\tid: 'JobVacancy',\n\t\t\tdestination: 'JobVacancy',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'recruitment_menu',\n\t\t\tsub_group_id: 'hr_recruitment',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'JobVacancy' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Job Applicants' ),\n\t\t\tid: 'JobApplicant',\n\t\t\tdestination: 'JobApplicant',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'recruitment_menu',\n\t\t\tsub_group_id: 'hr_recruitment',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'JobApplicant' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Job Applications' ),\n\t\t\tid: 'JobApplication',\n\t\t\tdestination: 'JobApplication',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'recruitment_menu',\n\t\t\tsub_group_id: 'hr_recruitment',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'JobApplication' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Portal Settings' ),\n\t\t\tid: 'RecruitmentPortalConfig',\n\t\t\tdestination: 'RecruitmentPortalConfig',\n\t\t\turl_type: 'sub_view',\n\t\t\tparent_id: 'recruitment_menu',\n\t\t\tsub_group_id: 'hr_recruitment',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'JobApplicant' )\n\t\t} );\n\n\n\t\t// TODO: Above is done - next: Documents\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Document' ),\n\t\t\tid: 'document_menu',\n\t\t\ticon: 'tticon tticon-feed_black_24dp'\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Documents' ),\n\t\t\tid: 'Document',\n\t\t\tdestination: 'Document',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'document_menu',\n\t\t\tsub_group_id: 'documentsGroup',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Document' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Document Groups' ),\n\t\t\tid: 'DocumentGroup',\n\t\t\tdestination: 'DocumentGroup',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'document_menu',\n\t\t\tsub_group_id: 'documentsGroup',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'DocumentGroup' )\n\t\t} );\n\n\t\t// TODO: Above is done - next: Reports\n\n\t\t//Reports\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Report' ),\n\t\t\tid: 'report_menu',\n\t\t\ticon: 'tticon tticon-show_chart_black_24dp'\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Saved Reports' ),\n\t\t\tid: 'report_saved_reports',\n\t\t\tdestination: 'SavedReport',\n\t\t\turl_type: 'view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'view' // the legacy 'saved reports' triggered the closeEditViews, setSelectSubMenu and openSelectView. Same as the wizard code in parseTTLink etc. Which is currently triggered by 'view'\n\t\t\t},\n\t\t\tparent_id: 'report_menu',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'SavedReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tid: 'separator_report_saved_reports_1',\n\t\t\tparent_id: 'report_menu',\n\t\t\tseparator: true,\n\t\t\tclass: 'p-menu-separator'\n\t\t} );\n\n\t\t/**************************************************/\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Employee Reports' ),\n\t\t\tid: 'report_employee_reports',\n\t\t\tparent_id: 'report_menu',\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Whos In Summary' ),\n\t\t\tid: 'ActiveShiftReport',\n\t\t\tdestination: 'ActiveShiftReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_employee_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ActiveShiftReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Employee Information' ),\n\t\t\tid: 'UserSummaryReport',\n\t\t\tdestination: 'UserSummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_employee_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'UserSummaryReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Audit Trail' ),\n\t\t\tid: 'AuditTrailReport',\n\t\t\tdestination: 'AuditTrailReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_employee_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'AuditTrailReport' )\n\t\t} );\n\n\t\t/**************************************************/\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'TimeSheet Reports' ),\n\t\t\tid: 'report_timesheet_reports',\n\t\t\tparent_id: 'report_menu',\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Schedule Summary' ),\n\t\t\tid: 'ScheduleSummaryReport',\n\t\t\tdestination: 'ScheduleSummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_timesheet_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ScheduleSummaryReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'TimeSheet Summary' ),\n\t\t\tid: 'TimesheetSummaryReport',\n\t\t\tdestination: 'TimesheetSummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_timesheet_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'TimesheetSummaryReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'TimeSheet Detail' ),\n\t\t\tid: 'TimesheetDetailReport',\n\t\t\tdestination: 'TimesheetDetailReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_timesheet_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'TimesheetDetailReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Punch Summary' ),\n\t\t\tid: 'PunchSummaryReport',\n\t\t\tdestination: 'PunchSummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_timesheet_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PunchSummaryReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Accrual Balance Summary' ),\n\t\t\tid: 'AccrualBalanceSummaryReport',\n\t\t\tdestination: 'AccrualBalanceSummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_timesheet_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'AccrualBalanceSummaryReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Exception Summary' ),\n\t\t\tid: 'ExceptionSummaryReport',\n\t\t\tdestination: 'ExceptionSummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_timesheet_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ExceptionSummaryReport' )\n\t\t} );\n\n\t\t/**************************************************/\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Payroll Reports' ),\n\t\t\tid: 'report_payroll_reports',\n\t\t\tparent_id: 'report_menu',\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Pay Stub Summary' ),\n\t\t\tid: 'PayStubSummaryReport',\n\t\t\tdestination: 'PayStubSummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_payroll_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PayStubSummaryReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Pay Stub Transaction Summary' ),\n\t\t\tid: 'PayStubTransactionSummaryReport',\n\t\t\tdestination: 'PayStubTransactionSummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_payroll_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PayStubSummaryReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Payroll Export' ),\n\t\t\tid: 'PayrollExportReport',\n\t\t\tdestination: 'PayrollExportReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_payroll_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'PayrollExportReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'General Ledger Summary' ),\n\t\t\tid: 'GeneralLedgerSummaryReport',\n\t\t\tdestination: 'GeneralLedgerSummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_payroll_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'GeneralLedgerSummaryReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Expense Summary' ),\n\t\t\tid: 'ExpenseSummaryReport',\n\t\t\tdestination: 'ExpenseSummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_payroll_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ExpenseSummaryReport' )\n\t\t} );\n\n\t\t/**************************************************/\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Job Tracking Reports' ),\n\t\t\tid: 'report_job_tracking_reports',\n\t\t\tparent_id: 'report_menu',\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Job Summary' ),\n\t\t\tid: 'JobSummaryReport',\n\t\t\tdestination: 'JobSummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_job_tracking_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'JobSummaryReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Job Analysis' ),\n\t\t\tid: 'JobAnalysisReport',\n\t\t\tdestination: 'JobAnalysisReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_job_tracking_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'JobAnalysisReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Job Information' ),\n\t\t\tid: 'JobInformationReport',\n\t\t\tdestination: 'JobInformationReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_job_tracking_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'JobInformationReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Task Information' ),\n\t\t\tid: 'JobItemInformationReport',\n\t\t\tdestination: 'JobItemInformationReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_job_tracking_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'JobItemInformationReport' )\n\t\t} );\n\n\t\t/**************************************************/\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Invoice Reports' ),\n\t\t\tid: 'report_invoice_reports',\n\t\t\tparent_id: 'report_menu',\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Transaction Summary' ),\n\t\t\tid: 'InvoiceTransactionSummaryReport',\n\t\t\tdestination: 'InvoiceTransactionSummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_invoice_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'InvoiceTransactionSummaryReport' )\n\t\t} );\n\n\t\t/**************************************************/\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Tax Reports' ),\n\t\t\tid: 'report_tax_reports',\n\t\t\tparent_id: 'report_menu',\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Tax Summary (Generic)' ),\n\t\t\tid: 'TaxSummaryReport',\n\t\t\tdestination: 'TaxSummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_tax_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'TaxSummaryReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tid: 'separator_report_tax_reports_1',\n\t\t\tparent_id: 'report_tax_reports',\n\t\t\tseparator: true,\n\t\t\tclass: 'p-menu-separator'\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Remittance Summary' ),\n\t\t\tid: 'RemittanceSummaryReport',\n\t\t\tdestination: 'RemittanceSummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_tax_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'RemittanceSummaryReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'T4 Summary' ),\n\t\t\tid: 'T4SummaryReport',\n\t\t\tdestination: 'T4SummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_tax_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'T4SummaryReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'T4A Summary' ),\n\t\t\tid: 'T4ASummaryReport',\n\t\t\tdestination: 'T4ASummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_tax_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'T4ASummaryReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tid: 'separator_report_tax_reports_2',\n\t\t\tparent_id: 'report_tax_reports',\n\t\t\tseparator: true,\n\t\t\tclass: 'p-menu-separator',\n\t\t\tpermission_result: ( PermissionManager.checkTopLevelPermission( 'RemittanceSummaryReport' ) && PermissionManager.checkTopLevelPermission( 'Form941Report' ) ) //Only show the 2nd separator if Canada and US tax forms are displayed too. Otherwise the separator is doubled up.\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'US State Unemployment' ),\n\t\t\tid: 'USStateUnemploymentReport',\n\t\t\tdestination: 'USStateUnemploymentReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_tax_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'USStateUnemploymentReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Form 941' ),\n\t\t\tid: 'Form941Report',\n\t\t\tdestination: 'Form941Report',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_tax_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Form941Report' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Form 940' ),\n\t\t\tid: 'Form940Report',\n\t\t\tdestination: 'Form940Report',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_tax_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Form940Report' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Form 1099-NEC' ),\n\t\t\tid: 'Form1099NecReport',\n\t\t\tdestination: 'Form1099NecReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_tax_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Form1099NecReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Form W2/W3' ),\n\t\t\tid: 'FormW2Report',\n\t\t\tdestination: 'FormW2Report',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_tax_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'FormW2Report' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Affordable Care' ),\n\t\t\tid: 'AffordableCareReport',\n\t\t\tdestination: 'AffordableCareReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_tax_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'AffordableCareReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'US EEO' ),\n\t\t\tid: 'USEEOReport',\n\t\t\tdestination: 'USEEOReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_tax_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'USEEOReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'US PERS' ),\n\t\t\tid: 'USPERSReport',\n\t\t\tdestination: 'USPERSReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_tax_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'USPERSReport' )\n\t\t} );\n\n\t\t/**************************************************/\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'HR Reports' ),\n\t\t\tid: 'report_hr_reports',\n\t\t\tparent_id: 'report_menu',\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Qualification Summary' ),\n\t\t\tid: 'UserQualificationReport',\n\t\t\tdestination: 'UserQualificationReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_hr_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'UserQualificationReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Review Summary' ),\n\t\t\tid: 'KPIReport',\n\t\t\tdestination: 'KPIReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_hr_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'KPIReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Recruitment Summary' ),\n\t\t\tid: 'UserRecruitmentSummaryReport',\n\t\t\tdestination: 'UserRecruitmentSummaryReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_hr_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'UserRecruitmentSummaryReport' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Recruitment Detail' ),\n\t\t\tid: 'UserRecruitmentDetailReport',\n\t\t\tdestination: 'UserRecruitmentDetailReport',\n\t\t\turl_type: 'sub_view',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'report'\n\t\t\t},\n\t\t\tparent_id: 'report_hr_reports',\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'UserRecruitmentDetailReport' )\n\t\t} );\n\n\t\t/**************************************************/\n\n\t\t// End of reports\n\n\t\t/**************************************************/\n\n\t\t//My Account group\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'My Account' ),\n\t\t\tid: 'my_account_menu',\n\t\t\ticon: 'tticon tticon-person_black_24dp',\n\t\t\thide_in_main_menu: true,\n\t\t} );\n\n\t\t// this.addItem( {\n\t\t// \tlabel: $.i18n._( 'Notifications' ),\n\t\t// \tid: 'notification',\n\t\t// \tdestination: 'Notification',\n\t\t// \tparent_id: 'my_account_menu',\n\t\t// \tsub_group_id: 'myAccountGroup',\n\t\t// \thide_in_main_menu: true,\n\t\t// \tpermission_result: true, // Notification always returns true as notifications should always be enabled.\n\t\t// } );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Messages' ),\n\t\t\tid: 'message',\n\t\t\tdestination: 'MessageControl',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'my_account_menu',\n\t\t\tsub_group_id: 'myAccountGroup',\n\t\t\thide_in_main_menu: true,\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'MessageControl' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Requests' ),\n\t\t\tid: 'request',\n\t\t\tdestination: 'Request',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'my_account_menu',\n\t\t\tsub_group_id: 'myAccountGroup',\n\t\t\thide_in_main_menu: true,\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'Request' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Expenses' ),\n\t\t\tid: 'LoginUserExpense',\n\t\t\tdestination: 'LoginUserExpense',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'my_account_menu',\n\t\t\tsub_group_id: 'myAccountGroup',\n\t\t\thide_in_main_menu: true,\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'LoginUserExpense' )\n\t\t} );\n\n\t\t/**************************************************/\n\n\t\tthis.addItem( {\n\t\t\tid: 'separator_my_account_1',\n\t\t\tparent_id: 'my_account_menu',\n\t\t\tseparator: true,\n\t\t} );\n\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Request Authorizations' ),\n\t\t\tid: 'request_authorization',\n\t\t\tdestination: 'RequestAuthorization',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'my_account_menu',\n\t\t\tsub_group_id: 'authorization',\n\t\t\thide_in_main_menu: true,\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'RequestAuthorization' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'TimeSheet Authorizations' ),\n\t\t\tid: 'timesheet_authorization',\n\t\t\tdestination: 'TimeSheetAuthorization',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'my_account_menu',\n\t\t\tsub_group_id: 'authorization',\n\t\t\thide_in_main_menu: true,\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'TimeSheetAuthorization' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Expense Authorizations' ),\n\t\t\tid: 'expense_authorization',\n\t\t\tdestination: 'ExpenseAuthorization',\n\t\t\turl_type: 'view',\n\t\t\tparent_id: 'my_account_menu',\n\t\t\tsub_group_id: 'authorization',\n\t\t\thide_in_main_menu: true,\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ExpenseAuthorization' )\n\t\t} );\n\n\t\t/**************************************************/\n\n\t\tthis.addItem( {\n\t\t\tid: 'separator_my_account_2',\n\t\t\tparent_id: 'my_account_menu',\n\t\t\tseparator: true,\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Preferences' ),\n\t\t\tid: 'LoginUserPreference',\n\t\t\tdestination: 'LoginUserPreference',\n\t\t\turl_type: 'sub_view',\n\t\t\tparent_id: 'my_account_menu',\n\t\t\tsub_group_id: 'myAccountGroup',\n\t\t\thide_in_main_menu: true,\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'LoginUserPreference' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Contact Information' ),\n\t\t\tid: 'LoginUserContact',\n\t\t\tdestination: 'LoginUserContact',\n\t\t\turl_type: 'sub_view',\n\t\t\tparent_id: 'my_account_menu',\n\t\t\tsub_group_id: 'myAccountGroup',\n\t\t\thide_in_main_menu: true,\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'LoginUserContact' )\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Passwords / Security' ),\n\t\t\tid: 'ChangePassword',\n\t\t\tdestination: 'ChangePassword',\n\t\t\turl_type: 'sub_view',\n\t\t\tparent_id: 'my_account_menu',\n\t\t\tsub_group_id: 'securityGroup',\n\t\t\thide_in_main_menu: true,\n\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ChangePassword' )\n\t\t} );\n\n\t\t/**************************************************/\n\n\t\tthis.addItem( {\n\t\t\tid: 'separator_my_account_4',\n\t\t\tparent_id: 'my_account_menu',\n\t\t\tseparator: true,\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Sign Out' ),\n\t\t\tid: 'Logout',\n\t\t\ticon: 'tticon tticon-logout_black_24dp',\n\t\t\tdestination: 'Logout',\n\t\t\tparent_id: 'my_account_menu',\n\t\t\tsub_group_id: 'logoutGroup',\n\t\t\thide_in_main_menu: true,\n\t\t\tpermission_result: true,\n\t\t} );\n\n\t\t//Help group\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Help' ),\n\t\t\tid: 'help_menu',\n\t\t\ticon: 'tticon tticon-help_center_black_24dp',\n\t\t\tpermission_result: true,\n\t\t\thide_in_main_menu: true,\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'AI Assistant' ),\n\t\t\tid: 'AIAssistant',\n\t\t\tdestination: 'AIAssistant',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'view_no_close'\n\t\t\t},\n\t\t\tparent_id: 'help_menu',\n\t\t\tsub_group_id: 'help_group',\n\t\t\tpermission_result: Global.getFeatureFlag( 'assistant' ) && ( PermissionManager.getPermissionLevel() >= 40 ),\n\t\t\thide_in_main_menu: true,\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Administrator Guide' ),\n\t\t\tid: 'AdminGuide',\n\t\t\tdestination: 'AdminGuide',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'view_no_close'\n\t\t\t},\n\t\t\tparent_id: 'help_menu',\n\t\t\tsub_group_id: 'help_group',\n\t\t\tpermission_result: PermissionManager.HelpMenuValidateAdmin(),\n\t\t\thide_in_main_menu: true,\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Supervisor Guide' ),\n\t\t\tid: 'SupervisorGuide',\n\t\t\tdestination: 'SupervisorGuide',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'view_no_close'\n\t\t\t},\n\t\t\tparent_id: 'help_menu',\n\t\t\tsub_group_id: 'help_group',\n\t\t\tpermission_result: PermissionManager.HelpMenuValidateSupervisor(),\n\t\t\thide_in_main_menu: true,\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Employee Guide' ),\n\t\t\tid: 'EmployeeGuide',\n\t\t\tdestination: 'EmployeeGuide',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'view_no_close'\n\t\t\t},\n\t\t\tparent_id: 'help_menu',\n\t\t\tsub_group_id: 'help_group',\n\t\t\tpermission_result: true,\n\t\t\thide_in_main_menu: true,\n\t\t} );\n\n\t\t//Only display one \"FAQ\" entry for the highest permission level they have. This keeps the menu a little smaller and less confusing.\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'FAQs' ),\n\t\t\tid: 'AdminFAQS',\n\t\t\tdestination: 'AdminFAQS',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'view_no_close'\n\t\t\t},\n\t\t\tparent_id: 'help_menu',\n\t\t\tsub_group_id: 'help_group',\n\t\t\tpermission_result: PermissionManager.HelpMenuValidateAdmin(),\n\t\t\thide_in_main_menu: true,\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'FAQs' ), //Supervisor FAQ\n\t\t\tid: 'SupervisorFAQS',\n\t\t\tdestination: 'SupervisorFAQS',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'view_no_close'\n\t\t\t},\n\t\t\tparent_id: 'help_menu',\n\t\t\tsub_group_id: 'help_group',\n\t\t\tpermission_result: ( PermissionManager.HelpMenuValidateSupervisor() && !PermissionManager.HelpMenuValidateAdmin() ), //Supervisor FAQ\n\t\t\thide_in_main_menu: true,\n\t\t} );\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'FAQs' ), //Employee FAQ\n\t\t\tid: 'EmployeeFAQS',\n\t\t\tdestination: 'EmployeeFAQS',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'view_no_close'\n\t\t\t},\n\t\t\tparent_id: 'help_menu',\n\t\t\tsub_group_id: 'help_group',\n\t\t\tpermission_result: ( !PermissionManager.HelpMenuValidateSupervisor() && !PermissionManager.HelpMenuValidateAdmin() ), //Employee FAQ\n\t\t\thide_in_main_menu: true,\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Chat w/Support' ),\n\t\t\tid: 'LiveChat',\n\t\t\tdestination: 'LiveChat',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'view_no_close'\n\t\t\t},\n\t\t\tparent_id: 'help_menu',\n\t\t\tsub_group_id: 'help_group',\n\t\t\tpermission_result: ( ( PermissionManager.HelpMenuValidateAdmin() || PermissionManager.HelpMenuValidateSupervisor() ) && Global.getFeatureFlag( 'support_chat' ) == true && APIGlobal.pre_login_data.demo_mode === false && Global.getProductEdition() >= 15 ),\n\t\t\thide_in_main_menu: true,\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: ( Global.getProductEdition() >= 15 ) ? $.i18n._( 'Email Support' ) : $.i18n._( 'Community Forums' ),\n\t\t\tid: 'EmailHelp',\n\t\t\tdestination: 'EmailHelp',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'view_no_close'\n\t\t\t},\n\t\t\tparent_id: 'help_menu',\n\t\t\tsub_group_id: 'help_group',\n\t\t\tpermission_result: ( ( PermissionManager.HelpMenuValidateAdmin() || PermissionManager.HelpMenuValidateSupervisor() ) && ( Global.getProductEdition() == 10 || APIGlobal.pre_login_data.support_email.trim() != '' ) ),\n\t\t\thide_in_main_menu: true,\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Screen Share Download' ),\n\t\t\tid: 'ScreenSharing',\n\t\t\tdestination: 'ScreenSharing',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'view_no_close'\n\t\t\t},\n\t\t\tparent_id: 'help_menu',\n\t\t\tsub_group_id: 'help_group',\n\t\t\tpermission_result: ( ( PermissionManager.HelpMenuValidateAdmin() || PermissionManager.HelpMenuValidateSupervisor() ) && Global.getFeatureFlag( 'support_chat' ) == true && APIGlobal.pre_login_data.demo_mode === false && Global.getProductEdition() >= 15 ),\n\t\t\thide_in_main_menu: true,\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Testing Sandbox' ),\n\t\t\tid: 'Sandbox',\n\t\t\tdestination: 'Sandbox',\n\t\t\tparent_id: 'help_menu',\n\t\t\tsub_group_id: 'help_group',\n\t\t\tpermission_result: ( PermissionManager.HelpMenuValidateAdmin() && Global.getProductEdition() >= 15 && APIGlobal.pre_login_data['sandbox_url'] && APIGlobal.pre_login_data['sandbox_url'] != false && APIGlobal.pre_login_data['sandbox_url'].length > 0 && !APIGlobal.pre_login_data['sandbox'] ),\n\t\t\thide_in_main_menu: true,\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'What\\'s New' ),\n\t\t\tid: 'WhatsNew',\n\t\t\tdestination: 'WhatsNew',\n\t\t\ttt_link: {\n\t\t\t\ttype: 'view_no_close'\n\t\t\t},\n\t\t\tparent_id: 'help_menu',\n\t\t\tsub_group_id: 'help_group',\n\t\t\tpermission_result: ( PermissionManager.HelpMenuValidateAdmin() || PermissionManager.HelpMenuValidateSupervisor() ),\n\t\t\thide_in_main_menu: true,\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'About' ),\n\t\t\tid: 'About',\n\t\t\tdestination: 'About',\n\t\t\tparent_id: 'help_menu',\n\t\t\tsub_group_id: 'help_group',\n\t\t\tpermission_result: PermissionManager.HelpMenuValidateAdmin(),\n\t\t\thide_in_main_menu: true,\n\t\t} );\n\n\t\t//UI Tests\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'UI Kit Sample' ),\n\t\t\tid: 'ui_kit',\n\t\t\ticon: 'tticon tticon-verified_black_24dp',\n\t\t\tpermission_result: APIGlobal.pre_login_data && APIGlobal.pre_login_data.production == false && Global.UNIT_TEST_MODE == true\n\t\t} );\n\n\t\tthis.addItem( {\n\t\t\tlabel: $.i18n._( 'Sample List' ),\n\t\t\tid: 'sample_list',\n\t\t\tdestination: 'UIKitSample',\n\t\t\tparent_id: 'ui_kit',\n\t\t\tsub_group_id: 'ui_kit',\n\t\t\tpermission_result: true, //Will not show unless parent is shown.\n\t\t} );\n\n\t\t// Once all menu items added to this.menu_items in raw format, then convert to PrimeVue format.\n\t\tthis.convertMenuItemsToPrimeVueFormat();\n\n\t\t// Once menu data is generated, update the profile menu with the items for the 'My Account' sub menu.\n\t\tthis.event_bus.emit( 'tt_topbar','profile_menu_data', {\n\t\t\t// Extract the my account menu data and pass it to profile menu.\n\t\t\tprofile_menu_data: this.menu_items\n\t\t\t\t.find( ( item ) => item.id === 'my_account_menu' ).items\n\t\t} );\n\n\t\t//Not all employees can view help menu, so make sure items exist before attempting to send to tttopbar.\n\t\tlet help_menu = this.menu_items.find( ( item ) => item.id === 'help_menu' );\n\t\tif ( help_menu ) {\n\t\t\tthis.event_bus.emit( 'tt_topbar', 'help_menu_data', {\n\t\t\t\t// Extract the help menu data and pass it to the topbar help icon.\n\t\t\t\thelp_menu_data: help_menu.items\n\t\t\t} );\n\t\t}\n\t}\n\n\t//TODO: Jeremy -> Temporarily put the following code here that was originally in ribbonViewController and other files.\n\t//Do we want to export a MenuManager instance? (Currently exporting)\n\t//Have these functions be static?\n\t//Have them in another file?\n\t//The functions in question are - openSelectView(), goToView(), isCurrentView(), doLogout(), setCompanyLogo().\n\n\t//Replace this switch statement with something else?\n\topenSelectView( name ) {\n\t\tvar $this = this;\n\t\tGlobal.setUINotready();\n\t\tswitch ( name ) {\n\t\t\tcase 'ImportCSV':\n\t\t\t\tIndexViewController.openWizard( 'ImportCSVWizard', null, function() {\n\t\t\t\t\t//Error: TypeError: LocalCacheData.current_open_primary_controller.search is not a function in interface/html5/framework/jquery.min.js?v=9.0.0-20151016-110437 line 2 > eval line 248\n\t\t\t\t\tif ( LocalCacheData.current_open_primary_controller && typeof LocalCacheData.current_open_primary_controller.search === 'function' ) {\n\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.search();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\tcase 'QuickStartWizard':\n\t\t\t\tif ( PermissionManager.checkTopLevelPermission( 'QuickStartWizard' ) ) {\n\t\t\t\t\tIndexViewController.openWizard( 'QuickStartWizard' );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'UserDefault':\n\t\t\t\t//Community editions can only have 1 new hire default. For those editions do not show the list view.\n\t\t\t\tif ( Global.getProductEdition() > 10 ) {\n\t\t\t\t\tdefaultCase( name );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t//Fall through to below cases.\n\t\t\tcase 'InOut':\n\t\t\tcase 'Company':\n\t\t\tcase 'LoginUserContact':\n\t\t\tcase 'LoginUserPreference':\n\t\t\tcase 'ChangePassword':\n\t\t\tcase 'InvoiceConfig':\n\t\t\tcase 'RecruitmentPortalConfig':\n\t\t\tcase 'About':\n\t\t\t\tif ( LocalCacheData.current_open_edit_only_controller && LocalCacheData.current_open_edit_only_controller.viewId == name ) { //#2557 - A - Ensure that opening edit only views on top of same edit only view just resets the edit menu\n\t\t\t\t\tLocalCacheData.current_open_edit_only_controller.setEditMenu();\n\t\t\t\t} else if ( LocalCacheData.current_open_edit_only_controller ) { //#2557 - B - Ensure that opening edit only views on top of different edit only  view sets the parent to the existing edit only view\n\t\t\t\t\tIndexViewController.openEditView( LocalCacheData.current_open_edit_only_controller, name );\n\t\t\t\t} else {\n\t\t\t\t\tIndexViewController.openEditView( LocalCacheData.current_open_primary_controller, name ); //#2557 - C - Ensure that opening edit views as normal works as before\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Logout':\n\t\t\t\tthis.doLogout();\n\t\t\t\tbreak;\n\t\t\tcase 'AIAssistant':\n\t\t\t\t$this.event_bus.emit( 'tt_topbar', 'open_assistant' );\n\t\t\t\tbreak;\n\t\t\tcase 'AdminGuide':\n\t\t\t\tvar url = 'https://www.timetrex.com/h?id=admin_guide&v=' + LocalCacheData.getLoginData().application_version + '&e=' + Global.getProductEdition();\n\t\t\t\twindow.open( url, '_blank' );\n\t\t\t\tbreak;\n\t\t\tcase 'SupervisorGuide':\n\t\t\t\tvar url = 'https://www.timetrex.com/h?id=supervisor_guide&v=' + LocalCacheData.getLoginData().application_version + '&e=' + Global.getProductEdition();\n\t\t\t\twindow.open( url, '_blank' );\n\t\t\t\tbreak;\n\t\t\tcase 'EmployeeGuide':\n\t\t\t\tvar url = 'https://www.timetrex.com/h?id=employee_guide&v=' + LocalCacheData.getLoginData().application_version + '&e=' + Global.getProductEdition();\n\t\t\t\twindow.open( url, '_blank' );\n\t\t\t\tbreak;\n\t\t\tcase 'AdminFAQS':\n\t\t\t\turl = 'https://www.timetrex.com/h?id=admin_faq&v=' + LocalCacheData.getLoginData().application_version + '&e=' + Global.getProductEdition();\n\t\t\t\twindow.open( url, '_blank' );\n\t\t\t\tbreak;\n\t\t\tcase 'SupervisorFAQS':\n\t\t\t\turl = 'https://www.timetrex.com/h?id=supervisor_faq&v=' + LocalCacheData.getLoginData().application_version + '&e=' + Global.getProductEdition();\n\t\t\t\twindow.open( url, '_blank' );\n\t\t\t\tbreak;\n\t\t\tcase 'EmployeeFAQS':\n\t\t\t\turl = 'https://www.timetrex.com/h?id=employee_faq&v=' + LocalCacheData.getLoginData().application_version + '&e=' + Global.getProductEdition();\n\t\t\t\twindow.open( url, '_blank' );\n\t\t\t\tbreak;\n\t\t\tcase 'WhatsNew':\n\t\t\t\turl = 'https://www.timetrex.com/h?id=changelog&v=' + LocalCacheData.getLoginData().application_version + '&e=' + Global.getProductEdition();\n\t\t\t\twindow.open( url, '_blank' );\n\t\t\t\tbreak;\n\t\t\tcase 'EmailHelp':\n\t\t\t\tif ( Global.getProductEdition() >= 15 ) {\n\t\t\t\t\tlocation.href = 'mailto:' + APIGlobal.pre_login_data.support_email + '?subject=Company: ' + LocalCacheData.getCurrentCompany().name + '&body=Company: ' + LocalCacheData.getCurrentCompany().name + '  ' + 'Registration Key: ' + LocalCacheData.getLoginData().registration_key;\n\t\t\t\t} else {\n\t\t\t\t\turl = 'https://www.timetrex.com/r?id=29';\n\t\t\t\t\twindow.open( url, '_blank' );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'LiveChat':\n\t\t\t\tif ( APIGlobal.pre_login_data.demo_mode === false && Global.getProductEdition() >= 15 )  {\n\t\t\t\t\tvar current_user = LocalCacheData.getLoginUser();\n\t\t\t\t\tIndexViewController.testInternetConnection();\n\t\t\t\t\tif ( PermissionManager.getPermissionLevel() > 40 ) { //40=Supervisor (Subordinates Only)\n\t\t\t\t\t\tvar check_connection_timer = setInterval( function() {\n\t\t\t\t\t\t\tif ( !is_testing_internet_connection ) {\n\t\t\t\t\t\t\t\tclearInterval( check_connection_timer );\n\t\t\t\t\t\t\t\tif ( internet_connection_available && current_user ) {\n\t\t\t\t\t\t\t\t\timport(/* webpackChunkName: \"live-chat\" */'@/global/widgets/live-chat/live-chat' )\n\t\t\t\t\t\t\t\t\t.then(function( module ) {\n\t\t\t\t\t\t\t\t\t\twindow.LHCChatOptions = module.LHCChatOptions;\n\t\t\t\t\t\t\t\t\t\twindow.openSupportChat = module.openSupportChat;\n\t\t\t\t\t\t\t\t\t\twindow.openSupportChat();\n\t\t\t\t\t\t\t\t\t} ).catch( Global.importErrorHandler );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tTAlertManager.showAlert( $.i18n._( 'No internet connection found. Cannot use live chat support.' ), $.i18n._( 'Live Chat Support' ) );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 500 );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'ScreenSharing':\n\t\t\t\turl = 'https://www.timetrex.com/r.php?id=quicksupport&v=' + LocalCacheData.getLoginData().application_version + '&e=' + Global.getProductEdition();\n\t\t\t\twindow.open( url, '_blank' );\n\t\t\t\tbreak;\n\t\t\tcase 'Sandbox':\n\t\t\t\tif ( APIGlobal.pre_login_data['sandbox_url'] && APIGlobal.pre_login_data['sandbox_url'].length > 0 ) {\n\t\t\t\t\tvar user = LocalCacheData.getLoginUser();\n\t\t\t\t\tGlobal.NewSession( user.user_name, 'SANDBOX', true );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'ProcessPayrollWizard':\n\t\t\t\tIndexViewController.openWizard( 'ProcessPayrollWizard', null, function() {\n\t\t\t\t\t//Error: TypeError: LocalCacheData.current_open_primary_controller.search is not a function in interface/html5/framework/jquery.min.js?v=9.0.0-20151016-110437 line 2 > eval line 248\n\t\t\t\t\tif ( LocalCacheData.current_open_primary_controller && typeof LocalCacheData.current_open_primary_controller.search === 'function' ) {\n\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.search();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\tcase 'PayrollRemittanceAgencyEventWizardController':\n\t\t\t\tIndexViewController.openWizardController( 'PayrollRemittanceAgencyEventWizardController', null, function() {\n\t\t\t\t\t//Error: TypeError: LocalCacheData.current_open_primary_controller.search is not a function in interface/html5/framework/jquery.min.js?v=9.0.0-20151016-110437 line 2 > eval line 248\n\t\t\t\t\tif ( LocalCacheData.current_open_primary_controller && typeof LocalCacheData.current_open_primary_controller.search === 'function' ) {\n\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.search();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\tcase 'ProcessTransactionsWizard':\n\t\t\t\tIndexViewController.openWizardController( 'ProcessTransactionsWizard', null, function() {\n\t\t\t\t\t//Error: TypeError: LocalCacheData.current_open_primary_controller.search is not a function in interface/html5/framework/jquery.min.js?v=9.0.0-20151016-110437 line 2 > eval line 248\n\t\t\t\t\tif ( LocalCacheData.current_open_primary_controller && typeof LocalCacheData.current_open_primary_controller.search === 'function' ) {\n\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.search();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\tcase 'LegalEntity':\n\t\t\t\tif ( Global.getProductEdition() >= 15 ) {\n\t\t\t\t\tdefaultCase( name );\n\t\t\t\t} else {\n\t\t\t\t\tIndexViewController.openEditView( LocalCacheData.current_open_primary_controller, name, false );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdefaultCase( name );\n\t\t\t\tbreak;\n\t\t}\n\n\t\t//To mitigate duplicate code the default case has been made into it's own function.\n\t\t//Some cases have multiple pathways. Such as a view that uses a list view or an edit only view.\n\t\tfunction defaultCase( name ) {\n\t\t\t//#2557 - When opening a view from the submenus, ensure that similarily named edit only views are cancelled (with confirm) first.\n\t\t\tif ( LocalCacheData.current_open_edit_only_controller && LocalCacheData.current_open_edit_only_controller.viewId == name ) {\n\t\t\t\tLocalCacheData.current_open_edit_only_controller.onCancelClick();\n\t\t\t\tTTPromise.wait( 'base', 'onCancelClick', function() {\n\t\t\t\t\t$this.goToView( name );\n\t\t\t\t}.bind( $this ) );\n\t\t\t} else {\n\t\t\t\t$this.goToView( name );\n\t\t\t}\n\t\t}\n\t}\n\n\tgoToView( subMenuId, force_refresh ) {\n\t\tif ( this.isCurrentView( subMenuId ) && force_refresh ) {\n\t\t\tIndexViewController.instance.router.reloadView( subMenuId );\n\t\t} else {\n\t\t\tdeleteCookie( 'OverrideUserPreference' ); //TimeSheet view has ability to override user preferences for using the employees timezone, make sure we clear this everytime we go to another view.\n\n\t\t\t//#2157 - needed for selenium screenshot test to prevent hanging on\n\t\t\t//various combinations of ribbon and topmenu clicks that are not a change to the hash\n\t\t\t//  Check that we aren't trying to redirect back to the login screen, causing an infinite loop on logout in some cases.\n\t\t\tif ( subMenuId != 'Login' && location.hash == ( '#!m=' + subMenuId ) ) {\n\t\t\t\tTTPromise.wait();\n\t\t\t\t//TODO: Replace this jQuery selector.\n\t\t\t\t$( '#refreshBtn:visible' ).click();\n\t\t\t}\n\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + '#!m=' + subMenuId );\n\t\t}\n\t}\n\n\tisCurrentView( subMenuId ) {\n\t\tvar sub_menu_id_url = Global.getBaseURL() + '#!m=' + subMenuId;\n\t\tDebug.Text( 'URL: Current: ' + window.location.href + ' Switching To: ' + sub_menu_id_url, 'MenuManager.js', 'MenuManager', 'isCurrentView', 10 );\n\n\t\t//window.location.href.indexOf( sub_menu_id_url ) == 0 doesn't work here, as .../html5/#!m=PayStub matches when on .../html5/#!m=PayStubTransaction view.\n\t\t//So instead use a RegEx to match the end of the string, or a & in case there are more URL arguments.\n\t\tvar regex_pattern = sub_menu_id_url.replace( /[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&' ) + '(&.*)?$'; //replace() escapes the URL chars.\n\n\t\tif ( window.location.href.match( regex_pattern ) !== null ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tdoLogout() {\n\t\tthis.event_bus.emit( 'app_menu', 'set_active_index', {\n\t\t\tindex: null\n\t\t} );\n\n\t\tif ( LocalCacheData.getLogoutSettings().slo_url ) {\n\t\t\tTTSAML.logoutUser( LocalCacheData.getLoginUser().user_name, Global.getBaseURL( '../../', false ) + 'api/saml/api.php?action=slo' );\n\t\t\treturn;\n\t\t} else {\n\t\t\t//Don't wait for result of logout in case of slow or disconnected internet. Just clear local cookies and move on.\n\t\t\tvar current_user_api = TTAPI.APIAuthentication;\n\t\t\tif ( typeof current_user_api.Logout !== 'undefined' ) { //Fix JS exception: Uncaught TypeError: current_user_api.Logout is not a function -- Which can occur when offline and clicking Logout.\n\t\t\t\tcurrent_user_api.Logout( {\n\t\t\t\t\tonResult() {\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t\tGlobal.setAnalyticDimensions();\n\n\t\t//A bare \"if\" wrapped around lh_inst doesn't work here for some reason.\n\t\tif ( typeof ( lh_inst ) != 'undefined' ) {\n\t\t\t//stop the update loop for live chat with support\n\t\t\tclearTimeout( lh_inst.timeoutStatuscheck );\n\t\t}\n\n\t\tGlobal.Logout();\n\t\tthis.goToView( 'Login' );\n\n\t\tTAlertManager.showBrowserTopBanner();\n\t}\n\n}\n\nexport default new MenuManager()\nexport {\n\tMenuManager\n}\n\n/**\n * A menu item in TimeTrex format. Will contain PrimeVue and TT attributes.\n * @property {string} label - Item label\n * @property {string} id - Unique menu item reference to use in automated testing.\n * @property {string} [parent_id] - ID of the parent group for the item.\n * @property {string} [sub_group_id] - legacy id of the ribbon menu groupings. Could be used to decide when a line needs to be placed between nav items.\n * @property {string} [destination] - Destination for router when link is clicked.\n * @property {boolean} [permission_result] - Decides if a user has access to this icon. Normally controlled by PermissionManager.checkTopLevelPermission()\n * @property {TTMenuLink} [tt_link] - Object containing link info.\n * @property {TTMenuItem[]} [items] - Array of further sub-menu items.\n */\nclass TTMenuItem {\n\tconstructor( options ) {\n\t\tif( options && options.destination ) {\n\t\t\t// Set default link handling logic if a destination is provided.\n\t\t\toptions.tt_link = options.tt_link || {};\n\t\t\t_.defaults( options.tt_link, {\n\t\t\t\t// destination is required, no default.\n\t\t\t\ttype: 'view', // view, wizard, report\n\t\t\t\ttarget: 'main' // main, left, right, footer, popup\n\t\t\t} );\n\t\t}\n\n\t\tObject.keys( options ).forEach( ( key ) => {\n\t\t\tthis[key] = options[key];\n\t\t} );\n\n\t\treturn this;\n\t}\n\n\tparseTTLink() {\n\t\tif( !this.destination || !this.tt_link.type || !this.tt_link.target ) {\n\t\t\tDebug.Error( 'Unable to parse TTLink without all parameters.', 'MenuManager.js', 'MenuManager', 'convertMenuItemsToPrimeVueFormat', 2 );\n\t\t\treturn false;\n\t\t}\n\n\t\tswitch ( this.tt_link.type ) {\n\t\t\tcase 'view':\n\t\t\t\tObject.assign( this, this.parseViewLink( this.destination, true ) );\n\t\t\t\tbreak;\n\t\t\tcase 'view_no_close':\n\t\t\t\t//Certain links such as \"What's New\", \"Email Support\" etc should not close edit views as they do not open new views.\n\t\t\t\t//Kept \"view\" in type name to be consistent as these types of links have always gone through \"openSelectView()\"\n\t\t\t\t//But we can rename to something else in future if we break up the \"openSelectView()\" function.\n\t\t\t\tObject.assign( this, this.parseViewLink( this.destination, false ) );\n\t\t\t\tbreak;\n\t\t\tcase 'report':\n\t\t\t\tObject.assign( this, this.parseReportLink( this.destination ) );\n\t\t\t\tbreak;\n\t\t\tdefault:\n\n\t\t}\n\t\treturn true;\n\t}\n\n/* For the different views, reference the following:\n * RibbonViewController.onSubMenuNavClick\n * RibbonViewController.setSelectSubMenu // might not need this. Is this related to just highlighting the currently clicked menu? Might be a simpler way to do it in vue.\n * RibbonViewController.openSelectView // theres lots of intricate logic here. Re-visit and check what we need here.\n *\n*/\n\n\t// Add all the various routing type parsers here.\n\tparseViewLink( destination, close_view ) {\n\t\treturn {\n\t\t\tcommand: ( event_info ) => {\n\t\t\t\tevent_info?.originalEvent?.preventDefault();\n\n\t\t\t\tif ( close_view ) {\n\t\t\t\t\t//TODO: After we decide on where openSelectView() should exist. Stop using temp _main_menu variable.\n\t\t\t\t\tGlobal.closeEditViews( function() {\n\t\t\t\t\t\t_main_menu.openSelectView( destination );\n\t\t\t\t\t} );\n\t\t\t\t} else {\n\t\t\t\t\t//Certain links such as \"What's new\", \"Email Support\" etc should not close edit views as they do not open new views.\n\t\t\t\t\t_main_menu.openSelectView( destination );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tparseReportLink( destination ) {\n\t\treturn {\n\t\t\tcommand: ( event_info ) => {\n\t\t\t\tevent_info?.originalEvent?.preventDefault();\n\n\t\t\t\tGlobal.closeEditViews( function() {\n\t\t\t\t\tif ( destination === 'AffordableCareReport' && !( Global.getProductEdition() >= 15 ) ) {\n\t\t\t\t\t\tTAlertManager.showAlert( Global.getUpgradeMessage() );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar parent_view = LocalCacheData.current_open_edit_only_controller ? LocalCacheData.current_open_edit_only_controller : LocalCacheData.current_open_primary_controller;\n\t\t\t\t\t\tIndexViewController.openReport( parent_view, destination );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t}\n\n\tparseWizardLink( destination ) {\n\t\treturn {\n\t\t\tcommand: ( event_info ) => {\n\t\t\t\tevent_info?.originalEvent?.preventDefault();\n\n\t\t\t\tGlobal.closeEditViews( function() {\n\t\t\t\t\t//TODO: After we decide on where openSelectView() should exist. Stop using temp _main_menu variable.\n\t\t\t\t\t_main_menu.openSelectView( destination );\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t}\n\n}\n\n/*\nCustom types for JSDoc\n */\n\n/**\n * A TT link object containing link info as well as TT specific attributes.\n * @typedef {Object} TTMenuLink\n * @property {string} type - view, wizard, report, popup.\n * @property {string} destination - The old-style TT hash reference for destination.\n * @property {string} target - Which Vue view container should this link open in. main, right, footer.\n */\n\n// Add the above to an actual class definition of the same. See namespace with defaults on https://jsdoc.app/tags-property.html\n\n/*\nSample Data\n\n{\n  label: TTi18n::getText(Employee),\n  icon: null|myicon.svg,\n  tt_id: 'employee', // Maybe make this ID match the destination by default? but its lowercase.\n  tt_link: null|{ type: wizard|report|view, destination: employee, target: null|main|left|right|footer }\n  items: [ {},{},... ]\n}\n\n*/\n","<template>\n    <transition name=\"layout-menu-container\">\n        <div class=\"layout-menu-container\" @click=\"onMenuClick\" v-show=\"isMenuVisible\">\n            <TTMenuSearch v-if=\"layoutMode === 'static'\" :model=\"menu_model_for_layout_mode\"></TTMenuSearch>\n            <div ref=\"layout-menu-content\" class=\"layout-menu-content\" @mouseover=\"onMenuContentMouseOver\" @mouseleave=\"onMenuContentMouseLeave\">\n                <!-- <div class=\"layout-menu-title\">MENU</div>-->\n                <TTAppMenu :key=\"'appmsenu'\"\n                           :model=\"menu_model_for_layout_mode\"\n                           :layoutMode=\"layoutMode\"\n                           :active=\"menuActive\"\n                           :mobileMenuActive=\"staticMenuMobileActive\"\n                           @root-menuitem-click=\"onRootMenuItemClick\"></TTAppMenu>\n                <div class=\"layout-menu-footer\">\n                    <!-- <div class=\"layout-menu-footer-title\"></div>-->\n                    <div class=\"layout-menu-footer-content\">\n                        <a id=\"copy_right_logo_link\" class=\"copy-right-logo-link\" target=\"_blank\"><img id=\"copy_right_logo\" class=\"copy-right-logo\"></a>\n                        <div class=\"signal-copyright-container\">\n                            <div><ul class=\"signal-strength\">\n                                <li class=\"signal-strength-very-weak\">\n                                    <div></div>\n                                </li>\n                                <li class=\"signal-strength-weak\">\n                                    <div></div>\n                                </li>\n                                <li class=\"signal-strength-strong\">\n                                    <div></div>\n                                </li>\n                                <li class=\"signal-strength-pretty-strong\">\n                                    <div></div>\n                                </li>\n                            </ul></div>\n                            <div class=\"copyright-container\">\n                                <!-- REMOVING OR CHANGING THIS COPYRIGHT NOTICE IS IN STRICT VIOLATION OF THE LICENSE AND COPYRIGHT AGREEMENT -->\n                                <span v-html=\"copyright_notice\" id=\"copy_right_info_1\" class=\"copy-right-info\" style=\"display: none\"></span>\n                            </div>\n                        </div>\n                        <div v-if=\"disable_feedback === false\" id=\"feedbackLinkContainer\" class=\"feedback-link-container\">\n                            <span id=\"feedback-link\">Send feedback to {{ application_name }}</span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </transition>\n</template>\n<script>\nimport TTAppMenu from './main_menu/TTAppMenu';\nimport TTMenuSearch from './main_menu/TTMenuSearch';\nimport ProgressBar from 'primevue/progressbar';\nimport { MenuManager } from './main_menu/MenuManager';\n\nexport default {\n    beforeCreate() {\n        this.main_menu = new MenuManager();\n        // Set a promise to wait for login to complete\n        TTPromise.add( 'VueMenu', 'waitOnLoginSuccess' );\n        TTPromise.add( 'VueMenu', 'waitOnTopBarCreated' );\n        TTPromise.wait( 'VueMenu', null, () => {\n            // We wait for login, as initDefaultMenuItems() within MenuManager needs permission data from login. If run too soon, no icons are shown, as permission_results will all return false.\n            // Also needs to wait for TTTopbar to be created first so we do not run into race condition problems.\n            this.main_menu.initDefaultMenuItems();\n            this.menu_model = this.main_menu.getMenu(); // adding to [0] as there is a hidden top level menu in the PrimeVue menu. Can't replace whole menu as JS reference to menu object will be lost.\n        } );\n    },\n    created() {\n        this.event_bus = new TTEventBus( {\n            component_id: this.component_id,\n        } );\n        this.event_bus.on( this.component_id, 'rebuild_menu', () => {\n            this.rebuildMenu();\n        } );\n        this.event_bus.on( this.component_id,'reset_slim_offsets', () => {\n            this.resetSlimSubmenuOffsets();\n        } );\n        this.event_bus.on( 'global','reset_vue_data', () => {\n            // Reset the Vue data when the user logs out.\n            this.resetData();\n        } );\n    },\n    data() {\n        return {\n            component_id: 'tt_left_container',\n            menuActive: false,\n            application_name: window.APPLICATION_NAME,\n            copyright_notice: APIGlobal.pre_login_data.copyright_notice,\n            menu_model: [ // While we wait for login, initiatize the base menu model.\n                {\n                    label: 'Navigation',\n                    items: [{ // The items array here is what we will be dynamically updating via updateMenu(). If auto update through TTPromise fails, menu can be updated using this menu option.\n                        label: 'Update Menu',\n                        icon: 'pi pi-fw pi-refresh',\n                        command: this.rebuildMenu\n                    }]\n                }\n            ],\n            disable_feedback: APIGlobal.pre_login_data.disable_feedback\n        };\n    },\n    props: {\n        isMenuVisible: Boolean,\n        layoutMode: String,\n        staticMenuMobileActive: Boolean,\n    },\n    computed: {\n        menu_model_for_layout_mode() {\n            //Apollo menu works diffrently depending on the layout mode. In static mode it seems to require a top level menu item.\n            //This may be a temporary fix, but was required to get menu to work right now. Further investigation is required.\n            let new_menu = null;\n\n            if ( this.layoutMode === 'static' || this.layoutMode === 'overlay' ) {\n                new_menu = {\n                    label: 'Navigation',\n                    icon: 'pi pi-home',\n                    items: []\n                };\n\n                new_menu.items = this.menu_model;\n\n                return [new_menu];\n            } else {\n                return this.menu_model;\n            }\n        },\n    },\n    methods: {\n        resetData() {\n            Object.assign( this.$data, this.$options.data() );\n        },\n        rebuildMenu() {\n            this.menu_model = this.main_menu.rebuildMenu();\n        },\n        isSubMenuClick( event ) {\n            return event?.target?.closest('.layout-root-submenulist') !== null;\n        },\n        onMenuClick( event ) {\n            this.$emit( 'menu-click', event );\n            if ( this.layoutMode === 'slim' ) {\n                let root_sub_menu_list = document.querySelector( '.layout-main-menu .active-menuitem .layout-root-submenulist' );\n                if ( root_sub_menu_list ) {\n                    if ( !this.isSubMenuClick( event ) && event.target.closest('a') ) { //In slim mode reposition the active menu dropdown to the mouse position.\n                        root_sub_menu_list.style.top = ( event.target.closest('a').getBoundingClientRect().top - 50 ) + 'px'; //50 is the offset of the side menu from the top of the screen (topbar height)\n                    }\n                    if ( root_sub_menu_list.getBoundingClientRect().bottom > window.innerHeight ) { //If the submenu is going off the screen, reposition it just above the bottom of the screen.\n                        let submenuHeight = root_sub_menu_list.offsetHeight;\n                        root_sub_menu_list.style.top = `calc(100% - ${submenuHeight}px - 10px)`;\n                    }\n                }\n            } else if ( this.layoutMode === 'horizontal' && !this.isSubMenuClick( event ) ) {\n                let root_sub_menu_list = document.querySelector( '.layout-main-menu .active-menuitem .layout-root-submenulist' );\n                if ( root_sub_menu_list && event.target.closest( 'a' ) ) {\n                    root_sub_menu_list.style.top = ( event.target.closest( 'a' ).getBoundingClientRect().top - 10 ) + 'px'; //50 is the offset of the side menu from the top of the screen (topbar height)\n                }\n            } else if ( this.layoutMode === 'static' || this.layoutMode === 'overlay' ) {\n                //A slight delay is required before calculating if the scroll bar should be shown as the dropdown does not expand instantly until it's transition is complete.\n                setTimeout( () => {\n                    if ( Global.isVerticalScrollBarRequired( this.$refs['layout-menu-content'] ) ) {\n                        this.toggleScrollBar( true );\n                    } else {\n                        this.toggleScrollBar( false );\n                    }\n                }, 250 );\n            }\n        },\n        onRootMenuItemClick( event ) {\n            this.$emit( 'root-menuitem-click', event );\n        },\n        onTopbarItemClick( event ) {\n            this.$emit( 'topbar-item-click', event );\n        },\n        onMenuContentMouseOver() {\n            if ( Global.isVerticalScrollBarRequired( this.$refs['layout-menu-content'] ) ) {\n                this.toggleScrollBar( true );\n            } else {\n                this.toggleScrollBar( false );\n            }\n        },\n        onMenuContentMouseLeave() {\n            this.toggleScrollBar( false );\n        },\n        toggleScrollBar( show ) {\n            if ( show == true || Global.UNIT_TEST_MODE == true ) {\n                this.$refs['layout-menu-content'].style.maskPosition = 'left top';\n                this.$refs['layout-menu-content'].style.webkitMaskPosition = 'left top';\n            } else {\n                this.$refs['layout-menu-content'].style.maskPosition = 'left bottom';\n                this.$refs['layout-menu-content'].style.webkitMaskPosition = 'left bottom';\n            }\n        },\n        resetSlimSubmenuOffsets() {\n            let menu = document.querySelector( '.layout-main-menu' );\n            let submenu = null;\n\n            //In slim mode we offset submenus to prevent the menu from going off screen.\n            //This needs to be reset when switching from slim so that the changes do not carry over to other layout modes.\n            for ( let i = 0; i < menu.childNodes.length; i++ ) {\n                if ( menu.children[i] && menu.children[i].children[1] ) {\n                    submenu = menu.children[i].children[1];\n                    submenu.style.top = '';\n                    submenu.style.maxHeight = '';\n                    submenu.style.overflowY = '';\n                }\n            }\n        }\n    },\n    components: {\n        TTAppMenu,\n        TTMenuSearch,\n        ProgressBar\n    }\n};\n</script>\n<style>\n/* Warning: These styles get applied globally. They are not scoped. */\n\n/* TODO: Future refactor: Worth moving a lot of these menu styles over to the actual components/main_menu/TTAppMenu.vue file as some are more directly relevant there to the menu rather than the left container. */\n\n/* Overrides for left menu up/down in/out transitions */\n.layout-container .layout-menu-container .layout-menu li ul.layout-submenu-container-leave-active {\n    transition-duration: 0s; /* Overrides Apollo default: 0.45s */\n}\n\n.layout-container .layout-menu-container .layout-menu li ul.layout-submenu-container-enter-active {\n    /*transition: max-height 1s ease-in-out;*/\n    transition-duration: 0.2s; /* Overrides Apollo default: 1s */\n}\n\n.layout-container .layout-menu-container.layout-menu-container-enter-to {\n    transition-duration: 0.2s!important; /* Overrides Apollo default: 1s */\n}\n\n/* Hide left main menu scrollbar with a mask until user mouseovers the menu and the menu is large enough to warrant a scrollbar. Mouseover and size check done in JavaScript */\n.layout-static .layout-menu-content, .layout-overlay .layout-menu-content {\n    overflow-y: scroll;\n    mask-image: linear-gradient(0deg, transparent, #000000), linear-gradient(270deg, transparent 17px, #000000 0);\n    mask-size: 100% 20000px;\n    mask-position: left bottom;\n    -webkit-mask-image: linear-gradient(0deg, transparent, #000000), linear-gradient(270deg, transparent 17px, #000000 0);\n    -webkit-mask-size: 100% 20000px;\n    -webkit-mask-position: left bottom;\n    transition: mask-position 0.3s, -webkit-mask-position 0.3s;\n}\n\n/*.layout-container.layout-overlay .layout-menu-container,\n.layout-container.layout-static .layout-menu-container {\n    overflow-y: scroll; !* Force permanent vertical scrollbar space so that the content like menu arrows dont flash/move around when toggling between open/closed menu groups *!\n}*/\n\n/* --- Animation and style settings for menu mode toggle from static to slim and back --- */\n\n/* Do not animate width change from slim to static, no matter now fast, text still gets squashed/wrapped. */\n/*.layout-container.layout-static .layout-menu-container {*/\n/*    transition: width 0.01s; !* From static to slim, do it fast, so the text is not squashed/wrapped during animation. *!*/\n/*}*/\n\n.layout-container.layout-slim .layout-menu-container {\n    transition: width 0.2s; /* From static to slim, can be slow, but not too slow, because the text dissappears before animation finishes. */\n}\n\n.layout-container.layout-slim .layout-menu-container .layout-menu>li>a {\n    text-align: left; /* Without this, text jumps left/right during menu state change width animation */\n    /* padding-left: 12px; With the text align left above, this ensures icon is still centered in slim mode during and after animation. Trial & error value. */\n}\n.layout-container .layout-menu-container .layout-menu li>a i {\n    line-height: 22px; /* Sets icon line height equal to .layout-menuitem-toggler so that the icons dont move up/down during transition to/from slim/static mode */\n}\n\n.layout-container.layout-slim .layout-menu-container {\n    width: 42px; /* Sets width of slim menu via a trial & error value that ensures icon stays in same place between slim/static mode toggle. */\n}\n\n.layout-container.layout-slim .layout-sidebar {\n    width: 42px; /* Sets width of slim menu via a trial & error value that ensures icon stays in same place between slim/static mode toggle. */\n}\n\n.layout-container.layout-slim .layout-menu-container .layout-menu>li>a i:first-child {\n    font-size: 14px; /* Matches font size for static mode, so icon size stays consistent during mode toggle */\n}\n\n.layout-container.layout-slim .layout-menu a {\n    border: 1px solid transparent;\n    margin-bottom: 0.10rem;\n}\n\n.layout-container.layout-slim .layout-sidebar .layout-menu .layout-root-menuitem > a {\n    width: 3rem;\n    height: 3rem;\n    margin: 0.5rem auto 0.5rem auto;\n}\n\n.layout-container.layout-overlay .layout-menu-container .layout-menu-title, .layout-container.layout-static .layout-menu-container .layout-menu-title {\n    padding: 8px; /* To bring the menu header border-bottom line more inline with the bottom of the context menu */\n}\n\n.layout-container.layout-static .layout-menu-container .layout-menu-footer {\n    padding-bottom: 0;\n}\n.feedback-link-container {\n    margin-top: 10px;\n}\n.layout-menu-footer-content {\n    padding: 10px 12px;\n}\n.layout-menu-footer-content,\n.layout-container.layout-overlay .layout-menu-container .layout-menu-footer .layout-menu-footer-content,\n.layout-container.layout-static .layout-menu-container .layout-menu-footer .layout-menu-footer-content {\n    /* Override the base primevue styles */\n    border-top: 1px solid #dee2e6;\n    text-align: center;\n}\n.signal-copyright-container {\n    margin-top: 5px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n.copy-right-info {\n    margin-top: 2px;\n    font-size: 10px;\n    padding-top: 5px;\n}\n.layout-container .layout-menu-container .layout-menu-content .layout-menu li>a {\n    font-size: 13px;\n    color: #3b3b3b;\n}\n\n.layout-static .layout-main-menu .layout-root-submenulist > li.active-menuitem {\n    border: 1px solid #dbdee1;\n    border-radius: 2px;\n}\n\n.layout-static .layout-main-menu > li {\n    margin-left: 5px;\n    margin-right: 5px;\n    border: 1px solid transparent;\n}\n\n#tt_main_ui .layout-container.layout-static .layout-menu-container .layout-menu li.p-menu-separator {\n    margin-left: 5px;\n    margin-right: 5px;\n}\n\n.layout-container.layout-horizontal .layout-menu-container .layout-menu > li > a {\n    padding: 9px; /* Centers the vertical alignment of the horizontal menu items */\n}\n\n.layout-menu .active-menuitem>ul {\n    z-index: 10; /* #3065 Ensures the active menu items are shown properly and not transparently mixing in with the main menu items behind it, making the active menu items unreadable. Especially in horizontal menu mode. */\n}\n\n.layout-container.layout-static .layout-menu-container .layout-menu-content {\n    height: calc(100% - 37px); /*Adjustment required to take into account the search bar height*/\n}\n\n.layout-sidebar .layout-menu ul a {\n    padding: 10px 12px;\n}\n\n.layout-sidebar .layout-menu ul li {\n    border: 1px solid transparent;\n}\n\n.layout-menuitem-root-text {\n    display: none;\n}\n\n.layout-sidebar .layout-menu ul a .layout-submenu-toggler {\n    font-size: 1rem;\n}\n\n.layout-container.layout-slim .layout-menu-footer, .layout-container.layout-horizontal .layout-menu-footer {\n    display: none;\n}\n\n.layout-container .layout-menu-container li a.p-menu-separator {\n    border-top: 1px solid #dee2e6;\n    border-radius: 0 !important;\n    width: 95%;\n    display: block;\n    margin: 0.25rem auto -30px;\n    padding-bottom: 0;\n    background-color: #fff !important;\n    pointer-events: none;\n}\n\n.layout-container.layout-static .layout-root-submenulist {\n    margin-left: -1px;\n}\n.layout-container.layout-overlay .layout-menu-container .layout-menu li a>span, .layout-container.layout-static .layout-menu-container .layout-menu li a>span {\n    vertical-align: middle;\n    display: inline-block;\n    margin-left: -1px;\n    line-height: 15px;\n}\n\n.layout-container.layout-slim .layout-root-submenulist li span:empty, .layout-container.layout-horizontal .layout-root-submenulist li span:empty {\n    background-color: #fff;\n}\n\n.layout-container.layout-overlay .layout-menu-container .layout-menu>li ul li a, .layout-container.layout-static .layout-menu-container .layout-menu>li ul li a {\n    padding-left: 24px;\n}\n\n.layout-container.layout-overlay .layout-menu-container .layout-menu>li ul.layout-root-submenulist>li>a, .layout-container.layout-static .layout-menu-container .layout-menu>li ul.layout-root-submenulist>li>a {\n    padding-left: 12px;\n}\n\n.layout-container.layout-overlay .layout-menu-container .layout-menu li a, .layout-container.layout-static .layout-menu-container .layout-menu li a {\n    padding: 10px 12px;\n}\n\n.layout-container.layout-overlay .layout-menu-container .layout-menu li a:not(.p-disabled):hover, .layout-container.layout-slim .layout-menu-container .layout-menu li a:not(.p-disabled):hover, .layout-container.layout-static .layout-menu-container .layout-menu li a:not(.p-disabled):hover {\n    background-color: #32689b !important;\n    color: #fff !important;\n}\n\n.layout-container.layout-static .layout-menu-container .layout-menu li a:not(.p-disabled):hover .layout-menuitem-icon {\n    background-color: #32689b !important;\n    color: #fff !important;\n}\n\n.layout-container.layout-static .layout-menu-container .layout-menu li a:not(.p-disabled):hover .layout-submenu-toggler {\n    background-color: #32689b !important;\n    color: #fff !important;\n}\n\n.layout-container ul li a {\n    transition: none !important;\n}\n\n.layout-container.layout-horizontal .layout-menu .layout-root-menuitem > ul a:hover {\n    background-color: #32689b;\n    color: #fff;\n    border-radius: 0;\n}\n\n.layout-container.layout-slim .layout-menu-container .layout-menu li a {\n    border-radius: 0;\n}\n\n.layout-container.layout-static .layout-sidebar .layout-menu ul ul {\n    border-radius: 0;\n}\n\n.layout-container.layout-horizontal .layout-menu-container .layout-menu>li>a:not(.p-disabled):hover {\n    border-bottom: 2px solid #32689b;\n    color: #32689b;\n}\n\n.layout-container.layout-horizontal .layout-menu-container .layout-menu>li.layout-root-menuitem.active-menuitem>a {\n    border-bottom: 2px solid #32689b;\n    border-radius: 0;\n    background-color: #32689b;\n    color: #fff;\n}\n\n.layout-container.layout-horizontal .layout-menu-container .layout-menu>li>a:not(.p-disabled) {\n    border-bottom: 2px solid transparent;\n}\n\n.layout-container .layout-sidebar .layout-menu ul.layout-root-submenulist>li:hover>a>i {\n    color: #fff;\n}\n\n.layout-container .layout-sidebar .layout-menu-container .layout-menu .layout-root-submenulist li.active-menuitem>a {\n    background-color: #fff;\n    color: #32689b;\n}\n\n.layout-container.layout-static .layout-menu-container .layout-menu li.active-menuitem>a .layout-menuitem-icon, .layout-container.layout-static .layout-menu-container .layout-menu li.active-menuitem>a .layout-submenu-toggler {\n    background-color: #fff;\n    color: inherit;\n}\n\n.layout-container.layout-horizontal .layout-menu-container .layout-menu li.active-menuitem>a .layout-menuitem-icon {\n    color: inherit;\n}\n\n.layout-container.layout-slim .layout-sidebar .layout-menu-container .layout-menu-content .layout-menu li .layout-menuitem-icon {\n    color: inherit;\n}\n\n.layout-container.layout-slim .layout-sidebar .layout-menu-container .layout-menu-content .layout-root-menuitem.active-menuitem {\n    background-color: #32689b;\n    color: #fff;\n}\n.layout-container.layout-slim .layout-sidebar .layout-menu-container .layout-menu-content .layout-root-menuitem.active-menuitem .layout-menuitem-icon {\n    color: #fff;\n}\n\n.layout-container.layout-slim .layout-sidebar .layout-menu .layout-root-menuitem > ul, .layout-container.layout-horizontal .layout-sidebar .layout-menu .layout-root-menuitem > ul {\n    box-shadow: 0 2px 4px #0000004d;\n    max-height: 75vh;\n    padding: 0;\n    border: none;\n    border-radius: 0;\n}\n\n.layout-container.layout-slim .layout-sidebar .layout-menu ul li, .layout-container.layout-horizontal .layout-sidebar .layout-menu ul li {\n    border: none;\n    margin-bottom: 0;\n}\n\n.layout-container.layout-horizontal .layout-sidebar  .layout-menu {\n    display: flex;\n    flex-wrap: wrap;\n    flex-direction: row;\n    align-items: center;\n    height: 100%;\n}\n\n.layout-container.layout-horizontal .layout-root-submenulist {\n    margin-top: 50px; /* Adjustment for topbar height */\n    left: inherit !important;\n}\n\n.layout-container .layout-sidebar .layout-menu ul ul {\n    transition: max-height 0.05s cubic-bezier(0.86, 0, 0.07, 1);\n}\n\n.layout-container .layout-sidebar a {\n    user-select: none;\n    -webkit-user-drag: none;\n}\n\n.layout-container li span {\n    font-size: 13px;\n}\n\n.layout-sidebar .layout-menu li.active-menuitem > ul {\n    max-height: inherit;\n}\n\n@media screen and (max-width: 1130px) {\n    .layout-container .layout-sidebar {\n        z-index: 999;\n        transform: translateX(-100%);\n        transition: transform var(--transition-duration);\n        box-shadow: none;\n    }\n}\n</style>\n","<template>\n    <div v-show=\"showUI\" :class=\"containerClass\" @click=\"onDocumentClick\">\n        <Toast/>\n        <TTTopContainer class=\"hide-in-login\"\n                        :topbarMenuActive=\"topbarMenuActive\"\n                        :activeTopbarItem=\"activeTopbarItem\"\n                        @menubutton-click=\"onMenuButtonClick\"\n                        @topbar-menubutton-click=\"onTopbarMenuButtonClick\"\n                        @topbar-item-click=\"onTopbarItemClick\"/>\n        <div class=\"layout-content\">\n            <div class=\"layout-sidebar hide-in-login\" ref=\"sidebar\">\n                <TTLeftContainer class=\"hide-in-login\"\n                                 :isMenuVisible=\"isMenuVisible()\"\n                                 :layoutMode=\"layoutMode\"\n                                 @menuitem-click=\"onMenuItemClick\"/>\n            </div>\n            <div class=\"layout-content-wrapper\">\n                <div class=\"layout-content-container\">\n                    <!--        <router-view></router-view>router-view-->\n                    <router-view :key=\"$route.fullPath\"></router-view> <!-- The router view is setup with this :key to allow the LegacyView component to be re-used instead of cached, ensuring unique component state for each view. -->\n                </div>\n                <div v-if=\"staticMenuMobileActive\" class=\"layout-mask\"></div>\n                <div id=\"tt-assistant-ui\"></div>\n            </div>\n        </div>\n    </div>\n</template>\n<script>\n// TODO: Bug: Noticed on a refresh that the main logo in top left flashes with the Apollo logo before showing the company logo.\n\nimport TTTopContainer from '@/components/TTTopContainer';\nimport TTLeftContainer from '@/components/TTLeftContainer';\nimport { useLayout } from '@/framework/apollo-vue/src/layout/composables/layout';\nconst { layoutConfig, layoutState, isSidebarActive } = useLayout();\n\nexport default {\n    created() {\n        this.event_bus = new TTEventBus( {\n            component_id: this.component_id\n        } );\n\n        this.event_bus.on( 'global', 'reset_vue_data', this.resetData );\n        this.event_bus.on( this.component_id, 'get_user_saved_layout_mode', this.getSavedLayoutMode );\n        this.event_bus.on( this.component_id, 'toggle_ui', this.getSavedLayoutMode );\n    },\n    data() {\n        return {\n            component_id: 'tt_main_ui',\n            savedLayoutId: '',\n            showUI: true,\n            topbarMenuActive: false,\n            activeTopbarItem: null,\n            menuActive: false,\n            window_width: window.innerWidth,\n            previous_layout_mode: null\n        };\n    },\n    methods: {\n        resetData() {\n            Object.assign( this.$data, this.$options.data() );\n        },\n        onDocumentClick( event ) {\n            if ( event.target.classList.contains( 'menu-button' ) || event.target.classList.contains( 'pi-bars' ) ) {\n                return;\n            }\n\n            if ( !this.topbarItemClick ) {\n                this.activeTopbarItem = null;\n                this.topbarMenuActive = false;\n            }\n\n            if ( this.isOutsideClicked( event ) && ( this.isHorizontal() || this.isSlim() || this.isOverlay() ) ) {\n                layoutState.overlayMenuActive.value = false;\n                layoutState.overlaySubmenuActive.value = false;\n                layoutState.staticMenuMobileActive.value = false;\n                layoutState.menuHoverActive.value = false;\n\n                this.hideOverlayMenu();\n            }\n\n            this.topbarItemClick = false;\n            this.menuClick = false;\n        },\n        isOutsideClicked( event ) {\n            return !this.$refs.sidebar.contains( event?.target );\n        },\n        onMenuClick() {\n            this.menuClick = true;\n        },\n        onMenuButtonClick( event ) {\n            this.menuClick = true;\n            this.topbarMenuActive = false;\n\n            if ( layoutConfig.menuMode.value === 'overlay' ) {\n                layoutState.overlayMenuActive.value = !layoutState.overlayMenuActive.value;\n                layoutState.staticMenuMobileActive.value = layoutState.overlayMenuActive.value;\n            } else {\n                if ( this.isLargeWidth() ) {\n                    // layoutState.staticMenuDesktopInactive.value = !layoutState.staticMenuDesktopInactive.value;\n                    //Close open menus when switching menu layout mode.\n                    this.event_bus.emit( 'app_menu', 'set_active_index', {\n                        index: null\n                    } );\n                    if ( layoutConfig.menuMode.value === 'slim' ) {\n                        //In slim mode we offset submenus to prevent the menu from going off screen.\n                        //This needs to be reset when switching from slim so that the changes do not carry over to layout modes.\n                        this.event_bus.emit( 'tt_left_container', 'reset_slim_offsets' );\n                    }\n                    // Override PrimeVue behaviour to use burger button to toggle menu between static, slim and horizontal layouts.\n                    layoutConfig.menuMode.value = layoutConfig.menuMode.value === 'static' ? 'slim' : layoutConfig.menuMode.value === 'slim' ? 'horizontal' : 'static';\n                    this.saveLayoutMode( layoutConfig.menuMode.value );\n                } else {\n                    layoutState.staticMenuMobileActive.value = !layoutState.staticMenuMobileActive.value;\n                }\n            }\n\n            this.dispatchResizeEvent();\n            event.preventDefault();\n        },\n        rebuildMenu() {\n            if ( LocalCacheData.getLoginUser() === null ) {\n                //We cannot rebuild the menu if the user is not logged in yet, especially due to LocalCacheData.getRequiredLocalCache throwing exceptions causing infinite browser reloads as company and other data is checked when rebuilding the menu.\n                return;\n            }\n\n            //Without this delay the slim menu does not build correctly.\n            setTimeout( () => {\n                this.event_bus.emit( 'tt_left_container', 'rebuild_menu' );\n            }, 15 );\n        },\n        onTopbarMenuButtonClick( event ) {\n            this.topbarItemClick = true;\n            this.topbarMenuActive = !this.topbarMenuActive;\n            this.hideOverlayMenu();\n            event.preventDefault();\n        },\n        onTopbarItemClick( event ) {\n            this.topbarItemClick = true;\n\n            if ( this.activeTopbarItem === event.item )\n                this.activeTopbarItem = null;\n            else\n                this.activeTopbarItem = event.item;\n\n            event.originalEvent.preventDefault();\n        },\n        isLargeWidth() {\n            return window.innerWidth >= 1131;\n        },\n        isSmallWidth() {\n            return window.innerWidth <= 1130;\n        },\n        isHorizontal() {\n            return layoutConfig.menuMode.value === 'horizontal';\n        },\n        isSlim() {\n            return layoutConfig.menuMode.value === 'slim';\n        },\n        isOverlay() {\n            return layoutConfig.menuMode.value === 'overlay';\n        },\n        hideOverlayMenu() {\n            layoutState.overlayMenuActive.value = false;\n            layoutState.staticMenuMobileActive.value = false;\n        },\n        onMenuItemClick( event ) {\n            if ( !event.item.items ) {\n                this.event_bus.emit( this.component_id, 'reset-active-index' );\n                this.hideOverlayMenu();\n            } else {\n                this.menuClick = true;\n            }\n            if ( !event.item.items && ( this.isHorizontal() || this.isSlim() || this.isOverlay() ) ) {\n                this.menuActive = false;\n            }\n        },\n        onRootMenuItemClick() {\n            this.menuActive = !this.menuActive;\n        },\n        isMenuVisible() {\n            if ( this.isLargeWidth() ) {\n                if ( layoutConfig.menuMode.value === 'static' ) {\n                    // return !layoutState.staticMenuDesktopInactive.value;\n                    return true; // Always want to show the contents of the left menu, so that when it slides in/out, the menu doesn't just flash away, but properly slides away with the container.\n                } else if ( layoutConfig.menuMode.value === 'overlay' )\n                    return layoutState.overlayMenuActive.value;\n                else\n                    return true;\n            } else {\n                return true;\n            }\n        },\n        toggleConfigurator() {\n            this.configuratorActive = !this.configuratorActive;\n        },\n        hideConfigurator() {\n            this.configuratorActive = false;\n        },\n        resizeContentLayout() {\n            //Need to resize main content area to account for height changes when horizontal bar stacks on lower widths.\n            if ( this.isHorizontal() ) {\n                setTimeout( () => {\n                    let content_container = document.querySelector( '.content-container-after-login' );\n                    if ( !content_container ) {\n                        return;\n                    }\n                    //Horizontal menu is only shown on desktop resolutions (1024px+).\n                    if ( this.isLargeWidth() ) {\n                        let height = window.innerHeight - document.querySelector( '.layout-menu-container ' ).getBoundingClientRect().bottom;\n                        content_container.style.height = height + 'px';\n                    } else {\n                        let height = window.innerHeight - document.querySelector( '.layout-topbar ' ).getBoundingClientRect().bottom;\n                        content_container.style.height = height + 'px';\n                    }\n                }, 15 );\n            }\n\n            this.window_width = window.innerWidth;\n        },\n        dispatchResizeEvent() {\n            //Trigger resize events such as dashlet resizing on homeview.\n            //Delay used to trigger event after layout change to help prevent issues.\n            setTimeout( () => {\n                window.dispatchEvent( new Event( 'resize' ) );\n            }, 15 );\n        },\n        saveLayoutMode( layoutMode ) {\n            let args = {};\n            args.script = 'global_main_menu';\n            args.name = 'settings';\n            args.is_default = false;\n            args.data = {};\n            args.data.layout_mode = layoutMode;\n\n            this.previous_layout_mode = layoutConfig.menuMode.value;\n\n            if ( this.savedLayoutId ) { //If we have a saved layout id, then the api call is an update and not a create.\n                args.id = this.savedLayoutId;\n            }\n\n            TTAPI.APIUserGenericData.setUserGenericData( args, {\n                onResult: function( res ) {\n                    if ( !res.isValid() ) {\n                        Debug.Error( 'Error: Saving user layout mode selectiin failed', 'TTMainUI.vue', 'TTMainUI', 'saveLayoutMode', 10 );\n                    }\n                }\n            } );\n\n            layoutConfig.menuMode.value = layoutMode;\n\n            this.resizeContentLayout();\n        },\n        getSavedLayoutMode() {\n            let $this = this;\n            let filter_data = {};\n            filter_data.script = 'global_main_menu';\n            filter_data.name = 'settings';\n            filter_data.deleted = false;\n\n            TTAPI.APIUserGenericData.getUserGenericData( { filter_data: filter_data }, {\n                onResult: ( results ) => {\n                    var result_data = results.getResult();\n                    if ( result_data && result_data.length > 0 ) {\n                        if ( result_data[0].data.layout_mode ) {\n                            layoutConfig.menuMode.value = result_data[0].data.layout_mode;\n                            this.previous_layout_mode = layoutConfig.menuMode.value;\n                            $this.savedLayoutId = result_data[0].id;\n                        }\n                    }\n\n                    //Do not show main ui until user layout mode selection retrieved. Otherwise page contents would briefly\n                    //shift around going from default width of the static menu to the other layout modes.\n                    $this.toggleUI( true );\n                    $this.resizeContentLayout();\n                }\n            } );\n        },\n        toggleUI( show ) {\n            this.showUI = show;\n        },\n    },\n    computed: {\n        containerClass() {\n            return ['layout-container', 'layout-light', {\n                'layout-light': layoutConfig.colorScheme.value === 'light',\n                'layout-dim': layoutConfig.colorScheme.value === 'dim',\n                'layout-dark': layoutConfig.colorScheme.value === 'dark',\n                'layout-colorscheme-menu': layoutConfig.menuTheme.value === 'colorScheme',\n                'layout-primarycolor-menu': layoutConfig.menuTheme.value === 'primaryColor',\n                'layout-transparent-menu': layoutConfig.menuTheme.value === 'transparent',\n                'layout-overlay': layoutConfig.menuMode.value === 'overlay',\n                'layout-static': layoutConfig.menuMode.value === 'static',\n                'layout-slim': layoutConfig.menuMode.value === 'slim',\n                'layout-slim-plus': layoutConfig.menuMode.value === 'slim-plus',\n                'layout-horizontal': layoutConfig.menuMode.value === 'horizontal',\n                'layout-reveal': layoutConfig.menuMode.value === 'reveal',\n                'layout-drawer': layoutConfig.menuMode.value === 'drawer',\n                'layout-static-inactive': layoutState.staticMenuDesktopInactive.value && layoutConfig.menuMode.value === 'static',\n                'layout-overlay-active': layoutState.overlayMenuActive.value,\n                'layout-mobile-active': layoutState.staticMenuMobileActive.value,\n                // 'p-input-filled': $primevue.config.inputStyle === 'filled',\n                // 'p-ripple-disabled': $primevue.config.ripple === false,\n                'layout-sidebar-active': layoutState.sidebarActive.value,\n                'layout-sidebar-anchored': layoutState.anchored.value,\n                'p-input-filled': this.$primevue.config.inputStyle === 'filled',\n                'p-ripple-disabled': this.$primevue.config.ripple === false\n            }];\n        },\n        layoutMode() {\n            if ( this.window_width <= 1130 ) {\n                layoutConfig.menuMode.value = 'overlay';\n                this.rebuildMenu();\n            } else if ( layoutConfig.menuMode.value === 'overlay' ) {\n                layoutConfig.menuMode.value = this.previous_layout_mode;\n                this.rebuildMenu();\n            }\n\n            return layoutConfig.menuMode.value;\n        },\n        staticMenuMobileActive() {\n            return layoutState.staticMenuMobileActive.value;\n        }\n    },\n    components: {\n        TTTopContainer: TTTopContainer,\n        TTLeftContainer: TTLeftContainer\n    }\n};\n</script>\n<style>\n.login-bg .hide-in-login {\n    display: none;\n}\n\n.layout-container.layout-static .layout-content {\n    padding-top: 0 !important; /* This is just TEMP to remove the padding for unused breadcrumb. */\n}\n\n.bottom-container {\n    margin-left: 245px; /* TODO this needs to be adjusted. But this footer will likely go into the left menu bottom. */\n}\n\n.layout-container .layout-content .layout-content-container {\n    display: flex; /* To accompany the flex: 1 1 0 coming from PrimeVue styling. This will correctly align the child components. */\n    padding: 0; /* Remove padding around the main content area. Conflicting with apollo theming. */\n}\n\n/* TODO: Possibly temp styles below. Doing this for horizontal menu mode */\n.layout-container.layout-horizontal .layout-content {\n    padding-top: 1px;\n}\n\n@media (min-width: 1024px) {\n    .layout-container.layout-horizontal .layout-menu-container {\n        position: static;\n        top: auto;\n        left: auto;\n    }\n}\n\n.layout-container.layout-horizontal .layout-menu-container .layout-menu > li > a {\n    height: 40px; /* To override the 50px forced height in PrimeVue, which makes the menu taller than it needs to be. */\n}\n\n.layout-container.layout-horizontal .layout-menu-container .layout-menu > li.active-menuitem > ul {\n    top: 40px; /* To match to the adjusted height above of .layout-content */\n    z-index: 100; /* To ensure the dropdown menu items are always on top of edit views. */\n}\n\n.layout-container.layout-slim .layout-content {\n    padding-top: 0;\n    margin-left: 42px; /* Match new slim menu width. */\n}\n\n.layout-container.layout-slim .layout-menu-container .layout-menu > li > ul {\n    left: 42px; /* Match new slim menu width. TODO: Best to update this in the primevue scss source file instead, but dont want to do that until we have to import the whole menu code, as it complicated upgrade steps upon new versions. */\n}\n\n.layout-container.layout-static .layout-menu-container {\n    overflow: visible;\n}\n\n/* TODO: temp to move config menu button out of the way */\n.layout-config .layout-config-content .layout-config-button {\n    top: initial;\n    bottom: 100px;\n    opacity: 0.8;\n}\n\n/* Color overrides. Should eventually go into the SCSS sources */\n.layout-container .topbar {\n    background-color: #32689b;\n}\n\n#tt_main_ui .layout-container .topbar .menu-button {\n    margin-left: 0;\n    margin-right: 0;\n    width: 42px;\n}\n\n/* Hide bottom red border, as everything in here should now have moved to the left menu. Note, this also affects the pagination controls at the bottom. */\n/* This may need to be expanded to remove the html grid-bottom-border and bottom-div */\n.view .bottom-div,\n.edit-view .grid-bottom-border, .view .grid-bottom-border,\n.grid-bottom-border {\n    display: none;\n    background: none;\n    height: 0;\n}\n\n/* Sub Views need bottom paging div to be visible. */\n.view.sub-view .bottom-div {\n    display: block;\n    height: auto;\n}\n\n/* Styles to hide the topbar during the transition period */\n/* Note: The ribbon menu top bar height is 30px */\n/*.top-container .ui-tabs .ui-tabs-nav,*/\n/*.top-container .right-tab-bg,*/\n/*.ribbon-view .right-logo,*/\n/*.ribbon-view .left-logo {*/\n/*  display: none;*/\n/*}*/\n/*.top-container {*/\n/*  height: 134px; !* 164px - 30 *!*/\n/*}*/\n\n/* Context Menu - Some context menu styles here because overlay menu dropdown attaches to body so needs global styling, and hence want to keep the font sizing all in one place. */\n.context-menu-bar span,\n.p-menu-overlay span {\n    font-size: 13px;\n    font-weight: 400;\n}\n.context-menu-bar .p-button-icon {\n    font-size: 14px;\n}\n.p-button.p-button-icon-only {\n    width: 2.357rem !important; /* Apollo vue is now default 3rem, but we want to keep the old size. */\n}\n.p-button {\n    padding: 0.5rem 1rem;\n    font-size: 1rem;\n    transition: background-color .2s, color .2s, border-color .2s, box-shadow .2s;\n    border-radius: 3px;\n}\n.layout-container .p-inputtext {\n    font-family: Source Sans Pro, Arial, sans-serif;\n    font-size: 0.9rem;\n    color: #495057;\n    background: #f8f9fa;\n    padding: 0.5rem;\n    border: 1px solid #ced4da;\n    transition: background-color .2s, color .2s, border-color .2s, box-shadow .2s;\n    -webkit-appearance: none;\n    -moz-appearance: none;\n    appearance: none;\n    border-radius: 3px;\n}\n\n.layout-content {\n    width: 100% !important; /* This is to ensure the content area takes up the full width of the screen. */\n}\n\n.layout-container.layout-overlay .layout-menu-container, .layout-container.layout-static .layout-menu-container {\n    width: 230px;\n    overflow: hidden;\n}\n.layout-container.layout-static .layout-menu-content {\n    display: flex;\n    flex-direction: column;\n    align-items: stretch;\n}\n.layout-container.layout-static .layout-menu-content .layout-menu {\n    flex-grow: 1;\n}\n.layout-container.layout-static .layout-menu-content .layout-menu-footer {\n    position: relative;\n    bottom: 0;\n    height: auto;\n}\n.layout-content .layout-sidebar {\n    padding: 0;\n    width: 230px;\n    height: calc(100% - 50px);\n}\n\n.layout-container.layout-static .layout-content-wrapper {\n    padding: 0;\n    margin-left: 16.5rem;\n}\n\n.layout-container.layout-slim .layout-content-wrapper {\n    margin-left: 1rem;\n    margin-top: -2rem;\n}\n\n.layout-container.layout-overlay .layout-content .layout-content-wrapper {\n    margin-left: -2rem;\n    margin-top: -1rem;\n}\n\n@media (max-width: 1999px) {\n    .layout-container.layout-slim .layout-content-wrapper {\n        margin-left: -2rem;\n        margin-top: -2rem;\n        width: 100%;\n    }\n}\n\n@media (max-width: 1130px) {\n    .layout-container.layout-static .layout-content-wrapper {\n        margin-left: 0;\n    }\n}\n\n@media (max-width: 1130px) {\n    .layout-container.layout-slim .layout-content-wrapper {\n        margin-left: -5rem;\n    }\n}\n\n.layout-container.layout-horizontal .layout-content-wrapper {\n    margin-left: -2rem;\n    margin-top: -1.9rem;\n}\n\n.layout-container.layout-horizontal .layout-menu-container {\n    padding: 0 20px;\n    width: 100%;\n}\n\n.layout-container.layout-horizontal .layout-content-wrapper, .layout-container.layout-slim .layout-content-wrapper {\n    padding: 2rem 0 2rem 2rem;\n}\n\n.layout-container.layout-horizontal .layout-menuitem-text  {\n    margin-left: 6px!important;\n    margin-right: 0!important;\n}\n\n.layout-sidebar .layout-menu-container {\n    background-color: #fff;\n}\n\n.layout-sidebar {\n    box-shadow: 0 2px 4px #0000004d;\n    z-index: 10;\n}\n\n.layout-container.layout-slim .topbar {\n    box-shadow: 0 2px 4px #0000004d;\n}\n\n.layout-static .layout-sidebar, .layout-slim .layout-sidebar {\n    margin-top: 50px;\n}\n\nbody a {\n    text-decoration: none;\n    color: #32689b;\n}\n\n.layout-container .layout-menu-container .layout-menu-content .layout-menu li .layout-menuitem-icon {\n    /* Override menu icon color in all modes */\n    color: #3b3b3b;\n}\n\n.p-tooltip .p-tooltip-text {\n    background: #495057;\n    color: #fff;\n    padding: 0.5rem;\n    box-shadow: 0 2px 4px -1px #0003, 0 4px 5px #00000024, 0 1px 10px #0000001f;\n    border-radius: 3px;\n}\n\n.p-button:enabled:hover {\n    background: #2d5e8c;\n    color: #fff;\n    border-color: #2d5e8c;\n}\n\n.p-component {\n    font-family: Arial, Helvetica, sans-serif;\n}\n\n.layout-container.layout-static .layout-sidebar .layout-menu-container {\n    padding-bottom: 0;\n}\n\n.p-menu .p-menuitem:not(.p-highlight):not(.p-disabled).p-focus > .p-menuitem-content {\n    /* .p-focus makes the first menu item in a dropdown always look selected when menu is initialy opened. */\n    color: inherit;\n    background: inherit;\n}\n\n.p-menu .p-menuitem:not(.p-highlight):not(.p-disabled) > .p-menuitem-content:hover {\n    color: #fff;\n    background: #32689b;\n}\n\n.p-menu .p-menuitem:not(.p-highlight):not(.p-disabled) > .p-menuitem-content:hover a span {\n    color: #fff;\n}\n\n.layout-overlay.layout-overlay-active .layout-sidebar, .layout-mobile.mobile-active .layout-sidebar {\n    margin-top: 50px;\n    transition: none;\n}\n\n.layout-overlay.layout-overlay-active .layout-menu-container, .layout-overlay.layout-overlay-active .layout-menu-container {\n    overflow-y: scroll;\n}\n</style>\n","export var LocalCacheData = function() {\n\n};\n\nLocalCacheData.view_layout_cache = {};\n\nLocalCacheData.i18nDic = null;\n\nLocalCacheData.ui_click_stack = [];\n\nLocalCacheData.api_stack = [];\n\nLocalCacheData.last_timesheet_selected_date = null;\n\nLocalCacheData.last_timesheet_selected_user = null;\n\nLocalCacheData.last_schedule_selected_date = null;\n\nLocalCacheData.current_open_wizard_controllers = []; //Multiple wizards can be open at once such as tax wizard and report wizard\n\nLocalCacheData.default_filter_for_next_open_view = null;\n\nLocalCacheData.extra_filter_for_next_open_view = null;\n\nLocalCacheData.default_edit_id_for_next_open_edit_view = null; //First use in save report jump to report\n\nLocalCacheData.current_open_view_id = ''; // Save current open view's id. set in BaseViewController.loadView\n\nLocalCacheData.login_error_string = ''; //Error message show on Login Screen\n\nLocalCacheData.all_url_args = {}; //All args from URL\n\nLocalCacheData.current_open_primary_controller = null; // Save current open view's id. set in BaseViewController.loadView\n\nLocalCacheData.current_open_sub_controller = null; // Save current open view's id. set in BaseViewController.loadView\n\nLocalCacheData.current_open_edit_only_controller = null; // Save current open view's id. set in BaseViewController.loadView\n\nLocalCacheData.current_open_report_controller = null; //save open report view controller\n\nLocalCacheData.current_doing_context_action = ''; //Save what context action is doing right now\n\nLocalCacheData.current_select_date = ''; // Save\n\nLocalCacheData.edit_id_for_next_open_view = '';\n\nLocalCacheData.url_args = null;\n\nLocalCacheData.result_cache = {};\n\nLocalCacheData.paging_type = 10;  //0 is CLick to show more, 10 is normal paging\n\nLocalCacheData.currentShownContextMenuName = '';\n\nLocalCacheData.isSupportHTML5LocalCache = false;\n\nLocalCacheData.loginData = null;\n\nLocalCacheData.currentLanguage = 'en_us';\n\nLocalCacheData.currentLanguageDic = {};\n\nLocalCacheData.deployment_on_demand = null;\n\nLocalCacheData.productEditionId = null;\n\nLocalCacheData.applicationName = null;\n\nLocalCacheData.loginUser = null;\n\nLocalCacheData.loginUserPreference = null;\n\nLocalCacheData.openAwesomeBox = null; //To help make sure only one Awesomebox is shown at one time. Do mouse click outside job\n\nLocalCacheData.openAwesomeBoxColumnEditor = null; //To Make sure only one column editor of Awesomebox is shown at one time Do mouse click outside job\n\nLocalCacheData.openRibbonNaviMenu = null;\n\nLocalCacheData.loadedWidgetCache = {};\n\nLocalCacheData.loadedScriptNames = {}; //Save load javascript, prevent multiple load\n\nLocalCacheData.permissionData = null;\n\nLocalCacheData.uniqueCountryArray = null;\n\nLocalCacheData.custom_field_data = [];\n\nLocalCacheData.logout_settings = [];\n\nLocalCacheData.currentSelectMenuId = null;\n\nLocalCacheData.currentSelectSubMenuId = null;\n\nLocalCacheData.timesheet_sub_grid_expended_dic = {};\n\nLocalCacheData.view_min_map = {};\n\nLocalCacheData.view_min_tab_bar = null;\n\nLocalCacheData.cookie_path = APIGlobal.pre_login_data.cookie_base_url;\n\nLocalCacheData.domain_name = '';\n\nLocalCacheData.fullUrlParameterStr = '';\n\nLocalCacheData.PayrollRemittanceAgencyEventWizardController = null;\n\nLocalCacheData.resizeable_grids = [];\n\nLocalCacheData.auto_fill_data = null;\n\nLocalCacheData.scroll_bar_width = 0;\nLocalCacheData.scroll_bar_height = 0;\n\nLocalCacheData.last_punch_time = null;\nLocalCacheData.job_queue_punch_data = null;\n\nLocalCacheData.feature_flag_data = {};\n\nLocalCacheData.isStorageAvailable = function() {\n\t//Turn off sessionStorage as its not required and just slows things down anyways. We can store things in memory instead.\n\t// It also has space limitations which can be hit like: QuotaExceededError: DOM Exception 22: An attempt was made to add something to storage that exceeded the quota\n\tLocalCacheData.isSupportHTML5LocalCache = false;\n\n\t// if ( window.sessionStorage ) {\n\t// \ttry {\n\t// \t\t//Test to make sure we can actually store some data. This should help avoid JS exceptions such as: QuotaExceededError: DOM Exception 22: An attempt was made to add something to storage that exceeded the quota\n\t// \t\tvar storage = window['sessionStorage'];\n\t// \t\tvar x = '__storage_test__';\n\t// \t\tstorage.setItem(x, x);\n\t// \t\tstorage.removeItem(x);\n\t//\n\t// \t\tLocalCacheData.isSupportHTML5LocalCache = true;\n\t// \t} catch(e) {\n\t// \t\tLocalCacheData.isSupportHTML5LocalCache = false;\n\t// \t}\n\t// } else {\n\t// \tLocalCacheData.isSupportHTML5LocalCache = false;\n\t// }\n\t//Debug.Text( 'Is sessionStorage available: '+ LocalCacheData.isSupportHTML5LocalCache, 'LocalCacheData.js', 'LocalCacheData', 'isStorageAvailable', 10 );\n\n\treturn LocalCacheData.isSupportHTML5LocalCache;\n};\n\nLocalCacheData.isLocalCacheExists = function( key ) {\n\tif ( LocalCacheData.getLocalCache( key ) !== null ) {\n\t\treturn true;\n\t}\n\n\treturn false;\n};\n\nLocalCacheData.getLocalCache = function( key, format ) {\n\t//BUG#2066 - For testing bad cache. See getRequiredLocalCache()\n\t//if ( key == 'current_company' ){ return null; }\n\tif ( LocalCacheData[key] ) {\n\t\treturn LocalCacheData[key];\n\t} else if ( LocalCacheData.isSupportHTML5LocalCache == true && sessionStorage[key] ) { //Fall back to sessionStorage if available and data exists.\n\t\tvar result = sessionStorage.getItem( key );\n\n\t\tif ( result !== 'undefined' && format === 'JSON' ) {\n\t\t\tresult = JSON.parse( result );\n\t\t}\n\n\t\tif ( result === 'true' ) {\n\t\t\tresult = true;\n\t\t} else if ( result === 'false' ) {\n\t\t\tresult = false;\n\t\t}\n\n\t\tLocalCacheData[key] = result;\n\n\t\treturn LocalCacheData[key];\n\t}\n\n\treturn null;\n};\n\nLocalCacheData.setLocalCache = function( key, val, format ) {\n\tif ( LocalCacheData.isSupportHTML5LocalCache ) {\n\t\tif ( format === 'JSON' ) {\n\t\t\tsessionStorage.setItem( key, JSON.stringify( val ) );\n\t\t} else {\n\t\t\tsessionStorage.setItem( key, val );\n\t\t}\n\t}\n\n\tLocalCacheData[key] = val; //Always set in memory as well.\n\n\treturn true;\n};\n\n/**\n * BUG#2066\n * JavaScript was reporting: TypeError: Cannot read property 'product_edition_id' of null\n *\n * This appears to be caused by a person closing the browser and reopening it with a \"return to where I was\" option active.\n * The browser is trying to load local cache data and it may be incomplete in this scenario, which generates the error. We could not reproduce this reliably.\n * To fix it, we created LocalCacheData.getRequiredLocalCache(), and called it for mission critical cache chunks instead of LocalCacheData.getLocalCache()\n */\nLocalCacheData.getRequiredLocalCache = function( key, format ) {\n\tvar result = LocalCacheData.getLocalCache( key, format );\n\tif ( result == null ) {\n\t\t//There are 2 cases where result can be null.\n\t\t//  First is the cache going dead.\n\t\t//  Second is that a required local cache item is not yet loaded because most of the required data isn't set yet.\n\t\t//  In the second case we need to fail gracefully to show the error and stack trace on the console.\n\t\ttry {\n\t\t\t//If we aren't logged in, there isn't any required data to have, so ignore sending this error.\n\t\t\t//  This can be triggered by setting browser to Fast 3G network speeds, logging in, then going to MyAccount->Logout as soon as possible while API requests are in-flight.\n\t\t\tif ( LocalCacheData.getSessionID() != '' ) {\n\t\t\t\tGlobal.sendErrorReport( 'ERROR: Unable to get required local cache data: ' + key ); //Send error as soon as possible, before any data gets cleared.\n\t\t\t\tGlobal.Logout(); //Only logout if there is a session ID. Otherwise we can get stuck in an infinite loop when LocalCacheData is cleared, and we are still trying to access some of its data.\n\t\t\t}\n\t\t\twindow.location.reload();\n\t\t} catch ( e ) {\n\t\t\t// Early page loads won't have Global or TAlertManager\n\t\t\tconsole.debug( 'ERROR: Unable to get required local cache data: ' + key );\n\t\t\tconsole.debug( 'ERROR: Unable to report error to server: ' + key );\n\t\t\tconsole.debug( e.stack );\n\t\t\tif ( confirm( 'Local cache has expired. Click OK to reload.' ) ) {\n\t\t\t\twindow.location.reload();\n\t\t\t}\n\t\t}\n\n\t\treturn;\n\t}\n\n\treturn result;\n};\n\nLocalCacheData.getI18nDic = function() {\n\treturn LocalCacheData.getLocalCache( 'i18nDic', 'JSON' );\n};\n\nLocalCacheData.setI18nDic = function( val ) {\n\tLocalCacheData.setLocalCache( 'i18nDic', val, 'JSON' );\n};\n\nLocalCacheData.getViewMinMap = function() {\n\treturn LocalCacheData.getLocalCache( 'viewMinMap', 'JSON' );\n};\n\nLocalCacheData.setViewMinMap = function( val ) {\n\tLocalCacheData.setLocalCache( 'viewMinMap', val, 'JSON' );\n};\n\nLocalCacheData.getCopyRightInfo = function() {\n\treturn LocalCacheData.getLocalCache( 'copyRightInfo' );\n};\n\nLocalCacheData.setCopyRightInfo = function( val ) {\n\tLocalCacheData.setLocalCache( 'copyRightInfo', val );\n};\n\nLocalCacheData.getApplicationName = function() {\n\t//return LocalCacheData.getRequiredLocalCache( 'applicationName' );\n\treturn LocalCacheData.getLoginData().application_name;\n};\n\n// LocalCacheData.setApplicationName = function( val ) {\n// \tLocalCacheData.setLocalCache( 'applicationName', val );\n// };\n\nLocalCacheData.getCurrentCompany = function() {\n\treturn LocalCacheData.getRequiredLocalCache( 'current_company', 'JSON' );\n};\n\nLocalCacheData.setCurrentCompany = function( val ) {\n\tLocalCacheData.setLocalCache( 'current_company', val, 'JSON' );\n};\n\nLocalCacheData.getLoginUser = function() {\n\t//Can't be set to required as the data is chekced for null to trigger cache load.\n\t//See loginViewController.onLoginSuccess()\n\treturn LocalCacheData.getLocalCache( 'loginUser', 'JSON' );\n};\n\nLocalCacheData.getPortalLoginUser = function() {\n\t//Can't be set to required as the data is chekced for null to trigger cache load.\n\t//See loginViewController.onLoginSuccess()\n\treturn LocalCacheData.getLocalCache( 'portalLoginUser', 'JSON' );\n};\n\nLocalCacheData.setLoginUser = function( val ) {\n\tLocalCacheData.setLocalCache( 'loginUser', val, 'JSON' );\n};\nLocalCacheData.setPunchLoginUser = function( val ) {\n\tLocalCacheData.setLocalCache( 'punchLoginUser', val, 'JSON' );\n};\n\nLocalCacheData.getPunchLoginUser = function() {\n\treturn LocalCacheData.getLocalCache( 'punchLoginUser', 'JSON' );\n};\n\nLocalCacheData.setPortalLoginUser = function( val ) {\n\tLocalCacheData.setLocalCache( 'portalLoginUser', val, 'JSON' );\n};\n\nLocalCacheData.setPortalLoginUser = function( val ) {\n\tLocalCacheData.setLocalCache( 'portalLoginUser', val, 'JSON' );\n};\n\nLocalCacheData.getCurrentCurrencySymbol = function() {\n\treturn LocalCacheData.getLocalCache( 'currentCurrencySymbol' );\n};\n\nLocalCacheData.setCurrentCurrencySymbol = function( val ) {\n\tLocalCacheData.setLocalCache( 'currentCurrencySymbol', val );\n};\n\nLocalCacheData.getLoginUserPreference = function() {\n\treturn LocalCacheData.getRequiredLocalCache( 'loginUserPreference', 'JSON' );\n};\n\nLocalCacheData.setLoginUserPreference = function( val ) {\n\tLocalCacheData.setLocalCache( 'loginUserPreference', val, 'JSON' );\n};\n\nLocalCacheData.getPermissionData = function() {\n\treturn LocalCacheData.getRequiredLocalCache( 'permissionData', 'JSON' );\n};\n\nLocalCacheData.setPermissionData = function( val ) {\n\tLocalCacheData.setLocalCache( 'permissionData', val, 'JSON' );\n};\n\nLocalCacheData.getUniqueCountryArray = function() {\n\treturn LocalCacheData.getRequiredLocalCache( 'uniqueCountryArray', 'JSON' );\n};\n\nLocalCacheData.setUniqueCountryArray = function( val ) {\n\tLocalCacheData.setLocalCache( 'uniqueCountryArray', val, 'JSON' );\n};\n\nLocalCacheData.getCustomFieldData = function() {\n\treturn LocalCacheData.getRequiredLocalCache( 'custom_field_data', 'JSON' );\n};\n\nLocalCacheData.setCustomFieldData = function( val ) {\n\tLocalCacheData.setLocalCache( 'custom_field_data', val, 'JSON' );\n};\n\nLocalCacheData.getLogoutSettings = function() {\n\treturn LocalCacheData.getRequiredLocalCache( 'logout_settings', 'JSON' );\n};\n\nLocalCacheData.setLogoutSettings = function( val ) {\n\tLocalCacheData.setLocalCache( 'logout_settings', val, 'JSON' );\n};\n\nLocalCacheData.getSessionID = function() {\n\tvar result = LocalCacheData.getLocalCache( Global.getSessionIDKey() );\n\tif ( !result ) {\n\t\tresult = '';\n\t}\n\n\treturn result;\n};\n\nLocalCacheData.setSessionID = function( val ) {\n\tLocalCacheData.setLocalCache( Global.getSessionIDKey(), val );\n};\n\nLocalCacheData.getLoginData = function() {\n\treturn LocalCacheData.getRequiredLocalCache( 'loginData', 'JSON' );\n};\n\nLocalCacheData.setLoginData = function( val ) {\n\tLocalCacheData.setLocalCache( 'loginData', val, 'JSON' );\n};\n\nLocalCacheData.getCurrentSelectMenuId = function() {\n\treturn LocalCacheData.getLocalCache( 'currentSelectMenuId' );\n};\n\nLocalCacheData.setCurrentSelectMenuId = function( val ) {\n\tLocalCacheData.setLocalCache( 'currentSelectMenuId', val );\n};\n\nLocalCacheData.getCurrentSelectSubMenuId = function() {\n\treturn LocalCacheData.getLocalCache( 'currentSelectSubMenuId' );\n};\n\nLocalCacheData.setCurrentSelectSubMenuId = function( val ) {\n\tLocalCacheData.setLocalCache( 'currentSelectSubMenuId', val );\n};\n\nLocalCacheData.getAutoFillData = function() {\n\treturn LocalCacheData.getLocalCache( 'auto_fill_data', 'JSON' );\n};\n\nLocalCacheData.setAutoFillData = function( val ) {\n\tLocalCacheData.setLocalCache( 'auto_fill_data', val, 'JSON' );\n};\n\nLocalCacheData.setAllURLArgs = function( val ) {\n\tlet sanitized_val = {};\n\n\tfunction sanitizeInput( input ) {\n\t\treturn Global.htmlEncode( input )\n\t\t\t.replace( /\"/g, '&quot;' )\n\t\t\t.replace( /'/g, '&#039;' )\n\t\t\t.replace( /:/g, '&#58;' );\n\t}\n\n\t// Only allow objects to be passed in, note that null is recognized as an object and we ignore it.\n\tif ( typeof val === 'object' && val !== null ) {\n\t\tfor ( var key in val ) {\n\t\t\tif ( val.hasOwnProperty( key ) && val[key] !== undefined ) {\n\t\t\t\t// Check if the value is an array GET parameter like: branch_id[]=1&branch_id[]=2\n\t\t\t\tif ( Array.isArray( val[key] ) ) {\n\t\t\t\t\tsanitized_val[key] = val[key].map( item => {\n\t\t\t\t\t\treturn sanitizeInput( item ); // Sanitize each array element\n\t\t\t\t\t} );\n\t\t\t\t} else {\n\t\t\t\t\t// Sanitize values to help prevent against XSS with htmlEncode plus some extra characters: ' \" :\n\t\t\t\t\tsanitized_val[key] = sanitizeInput( val[key] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tLocalCacheData.setLocalCache( 'all_url_args', sanitized_val, 'JSON' );\n};\n\nLocalCacheData.getAllURLArgs = function() {\n\treturn LocalCacheData.getLocalCache( 'all_url_args', 'JSON' );\n};\n\nLocalCacheData.cleanNecessaryCache = function() {\n\tDebug.Text( 'Clearing Cache', 'LocalCacheData.js', 'LocalCacheData', 'cleanNecessaryCache', 10 );\n\tLocalCacheData.last_timesheet_selected_user = null;\n\tLocalCacheData.last_timesheet_selected_date = null;\n\t//JS load Optimize\n\tif ( LocalCacheData.loadViewRequiredJSReady ) {\n\t\tif ( typeof ALayoutCache !== 'undefined' ) {\n\t\t\tALayoutCache.layout_dic = {};\n\t\t}\n\t}\n\tLocalCacheData.view_layout_cache = {};\n\tLocalCacheData.result_cache = {};\n\t//Close any open wizards.\n\tif ( LocalCacheData.current_open_wizard_controllers.length > 0 ) {\n        for ( var i = 0; i < LocalCacheData.current_open_wizard_controllers.length; i++ ) {\n            LocalCacheData.current_open_wizard_controllers[i].onCloseClick();\n        }\n    }\n\tLocalCacheData.current_open_wizard_controllers = [];\n\tGlobal.cleanViewTab();\n};\n\nLocalCacheData.getScrollbarWidth = function() {\n\treturn LocalCacheData.getLocalCache( 'scroll_bar_width' );\n};\n\nLocalCacheData.setScrollBarWidth = function( val ) {\n\tLocalCacheData.setLocalCache( 'scroll_bar_width', val );\n};\n\nLocalCacheData.getScrollbarHeight = function() {\n\treturn LocalCacheData.getLocalCache( 'scroll_bar_height' );\n};\n\nLocalCacheData.setScrollBarHeight = function( val ) {\n\tLocalCacheData.setLocalCache( 'scroll_bar_height', val );\n};\n\nLocalCacheData.getLastPunchTime = function() {\n\treturn LocalCacheData.getLocalCache( 'last_punch_time' );\n};\n\nLocalCacheData.setLastPunchTime = function( val ) {\n\tLocalCacheData.setLocalCache( 'last_punch_time', val );\n};\n\nLocalCacheData.getJobQueuePunchData = function() {\n\treturn LocalCacheData.getLocalCache( 'job_queue_punch_data', 'JSON' );\n};\n\nLocalCacheData.setJobQueuePunchData = function( val ) {\n\tLocalCacheData.setLocalCache( 'job_queue_punch_data', val, 'JSON' );\n};\n\nLocalCacheData.getFeatureFlagData = function() {\n\treturn LocalCacheData.getLocalCache( 'feature_flag_data', 'JSON' );\n};\n\nLocalCacheData.setFeatureFlagData = function( val ) {\n\tLocalCacheData.setLocalCache( 'feature_flag_data', val, 'JSON' );\n};\n\n//Check to see if local storage is actually available.\nLocalCacheData.isStorageAvailable();","/**\n * TTBackboneView is the interface between the TimeTrex BaseViewController and any other classes that need\n * to extend from Backbone.View. It allows common logic such as the hierarchical options and required_files\n * to work as expected.\n *\n * When adding functions to this class, make sure they will be compatible with all files that extend from this.\n * Do a search to see these, they include the main UI views, as well as the portal etc.\n *\n * Usage note: When extending this view in a child view instead of from Backbone.View, make sure that your initialize function in the child view\n * has the super.initialize( options ); line at the start (before the required_files or any other non-backbone values from the options are used).\n */\n\nexport class TTBackboneView extends Backbone.View {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( options ) {\n\t\t//Convert options object to this object properties as early as possible.\n\t\tif ( options && typeof options == 'object' ) {\n\t\t\tfor ( const property in options ) {\n\t\t\t\tif ( options.hasOwnProperty( property ) ) { // #2808 See Safari bug https://bugs.webkit.org/show_bug.cgi?id=212449 This hasOwnProperty check is essential to prevent problems due to a bug in Safari with an inherited 'render' on the options Object interfering with the Views render() function.\n\t\t\t\t\tthis[property] = options[property];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","import { TTBackboneView } from '@/views/TTBackboneView';\n\nexport class BaseWindowController extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( options ) {\n\t\tsuper.initialize( options );\n\n\t\tthis.content_div = $( this.el ).find( '.content' );\n\t\tthis.stepsWidgetDic = {};\n\t\tthis.stepsDataDic = {};\n\n\t\tthis.default_data = BaseWizardController.default_data;\n\t\tthis.call_back = BaseWizardController.call_back;\n\n\t\tBaseWizardController.default_data = null;\n\t\tBaseWizardController.call_back = null;\n\n\t\tif ( typeof this.init == 'function' ) {\n\t\t\t//FIXME: pull this out when all wizards are refactored to the new way #1187\n\t\t\tif ( typeof this.setDefaultDataToSteps == 'function' ) {\n\t\t\t\tthis.setDefaultDataToSteps();\n\t\t\t}\n\t\t\tthis.init( options );\n\t\t\tTTPromise.resolve( 'BaseViewController', 'initialize' );\n\t\t}\n\t}\n\n\trender() {\n\t}\n\n\t// filterRequiredFiles() {\n\t// \tvar retval = [];\n\t// \tvar required_files;\n\t//\n\t// \tif ( typeof this._required_files == 'object' ) {\n\t// \t\trequired_files = this._required_files;\n\t// \t} else {\n\t// \t\trequired_files = this.getRequiredFiles();\n\t// \t}\n\t//\n\t// \tif ( required_files && required_files[0] ) {\n\t// \t\tretval = required_files;\n\t// \t} else {\n\t// \t\tfor ( var edition_id in required_files ) {\n\t// \t\t\tif ( Global.getProductEdition() >= edition_id ) {\n\t// \t\t\t\tretval = retval.concat( required_files[edition_id] );\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\t//\n\t// \tDebug.Arr( retval, 'RETVAL', 'BaseWindowController.js', 'BaseWindowController', 'filterRequiredFiles', 10 );\n\t// \treturn retval;\n\t// }\n\n\tpreInit() {\n\t\t//override in child class\n\t}\n\n}","( function( $ ) {\n\n\t$.fn.Paging2 = function( options ) {\n\t\tvar opts = $.extend( {}, $.fn.Paging2.defaults, options );\n\t\tvar $this = this;\n\t\tvar pager_data;\n\t\tvar start;\n\t\tvar last;\n\t\tvar next;\n\t\tvar end;\n\t\tvar paging_selector;\n\t\tvar left_buttons_div;\n\t\tvar right_buttons_div;\n\n\t\tvar left_buttons_enable;\n\t\tvar right_buttons_enable;\n\n\t\tthis.getPagerData = function() {\n\t\t\treturn pager_data;\n\t\t},\n\n\t\t\tthis.setPagerData = function( value ) {\n\n\t\t\t\tpager_data = value;\n\n\t\t\t\tif ( !pager_data ) {\n\t\t\t\t\t$( this.css( 'display', 'none' ) );\n\t\t\t\t\treturn;\n\t\t\t\t} else {\n\t\t\t\t\t$( this.css( 'display', 'block' ) );\n\t\t\t\t}\n\n\t\t\t\t$( paging_selector ).empty();\n\n\t\t\t\tvar len = pager_data.last_page_number;\n\n\t\t\t\tif ( len === -1 ) {\n\t\t\t\t\t$( paging_selector ).append( '<option value=\"' + 1 + '\">' + 1 + '</option>' );\n\t\t\t\t} else {\n\t\t\t\t\tfor ( var i = 1; i <= len; i++ ) {\n\t\t\t\t\t\t$( paging_selector ).append( '<option value=\"' + i + '\">' + i + '</option>' );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$( $( paging_selector ).find( 'option' ) ).filter( function() {\n\t\t\t\t\tvar current_value = parseInt( $( this ).attr( 'value' ) );\n\n\t\t\t\t\treturn current_value === pager_data.current_page;\n\t\t\t\t} ).prop( 'selected', true ).prop( 'selected', true );\n\n\t\t\t\tif ( pager_data.is_last_page === true ) {\n\t\t\t\t\tright_buttons_div.addClass( 'disabled' );\n\t\t\t\t\tright_buttons_div.addClass( 'disabled-image' );\n\t\t\t\t\tright_buttons_enable = false;\n\t\t\t\t} else {\n\t\t\t\t\tright_buttons_div.removeClass( 'disabled' );\n\t\t\t\t\tright_buttons_div.removeClass( 'disabled-image' );\n\t\t\t\t\tright_buttons_enable = true;\n\t\t\t\t}\n\n\t\t\t\tif ( pager_data.is_first_page ) {\n\t\t\t\t\tleft_buttons_div.addClass( 'disabled' );\n\t\t\t\t\tleft_buttons_div.addClass( 'disabled-image' );\n\t\t\t\t\tleft_buttons_enable = false;\n\n\t\t\t\t} else {\n\t\t\t\t\tleft_buttons_div.removeClass( 'disabled' );\n\t\t\t\t\tleft_buttons_div.removeClass( 'disabled-image' );\n\t\t\t\t\tleft_buttons_enable = true;\n\t\t\t\t}\n\n\t\t\t\tif ( len === -1 || ( pager_data.is_first_page && pager_data.is_last_page ) ) {\n\n\t\t\t\t\tleft_buttons_div.addClass( 'disabled' );\n\t\t\t\t\tleft_buttons_div.addClass( 'disabled-image' );\n\t\t\t\t\tleft_buttons_enable = false;\n\t\t\t\t\tright_buttons_div.addClass( 'disabled' );\n\t\t\t\t\tright_buttons_div.addClass( 'disabled-image' );\n\t\t\t\t\tright_buttons_enable = false;\n\n\t\t\t\t\t$this.hide();\n\t\t\t\t} else {\n\t\t\t\t\t$this.show();\n\t\t\t\t}\n\n\t\t\t};\n\n\t\tthis.each( function() {\n\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\n\t\t\tvar pages_label = $( this ).find( '.page-label-span' );\n\n\t\t\tpages_label.text( $.i18n._( 'Page' ) );\n\n\t\t\tleft_buttons_div = $( this ).find( '.left-buttons-div' );\n\t\t\tright_buttons_div = $( this ).find( '.right-buttons-div' );\n\n\t\t\tstart = $( this ).find( '.start' );\n\t\t\tlast = $( this ).find( '.last' );\n\t\t\tnext = $( this ).find( '.next' );\n\t\t\tend = $( this ).find( '.end' );\n\t\t\tpaging_selector = $( this ).find( '.paging-selector' );\n\n\t\t\tstart.text( $.i18n._( 'Start' ) );\n\t\t\tlast.text( $.i18n._( 'Previous' ) );\n\n\t\t\tnext.text( $.i18n._( 'Next' ) );\n\t\t\tend.text( $.i18n._( 'End' ) );\n\n\t\t\t$( this ).hide();\n\n\t\t\tstart.click( function() {\n\t\t\t\tif ( left_buttons_enable ) {\n\t\t\t\t\t$this.trigger( 'paging', ['start'] );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tlast.click( function() {\n\t\t\t\tif ( left_buttons_enable ) {\n\t\t\t\t\t$this.trigger( 'paging', ['last'] );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tnext.click( function() {\n\t\t\t\tif ( right_buttons_enable ) {\n\t\t\t\t\t$this.trigger( 'paging', ['next'] );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tend.click( function() {\n\t\t\t\tif ( right_buttons_enable ) {\n\t\t\t\t\t$this.trigger( 'paging', ['end'] );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t$( paging_selector ).change( $.proxy( function() {\n\n\t\t\t\t$( paging_selector ).find( 'option:selected' ).each( function() {\n\t\t\t\t\tvar page_number = $( this ).attr( 'value' );\n\t\t\t\t\t$this.trigger( 'paging', ['go_to', page_number] );\n\t\t\t\t} );\n\n\t\t\t}, this ) );\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.Paging2.defaults = {};\n\t$.fn.Paging2.html = {\n\t\tpaging: `<div class=\"paging-div\"><span class=\"paging-span\">CLICK TO SHOW MORE</span></div>`,\n\t\tpaging2: `\n\t\t\t<div class=\"paging-2-div\">\n\t\t\t\t<div class=\"left-buttons-div\">\n\t\t\t\t\t<span class=\"double-left-arrow pi pi-angle-double-left\" title=\"Start\"></span>\n\t\t\t\t\t<span class=\"paging-2-span start\"></span>\n\t\t\t\t\t<span class=\"left-arrow pi pi-angle-left\"></span>\n\t\t\t\t\t<span class=\"paging-2-span last\"></span>\n\t\t\t\t</div>\n\t\t\t\t<span class=\"page-label-span\"></span>\n\t\t\t\t<select class=\"t-select paging-selector\">\n\t\t\t\t</select>\n\t\t\t\t<div class=\"right-buttons-div\">\n\t\t\t\t\t<span class=\"paging-2-span next\"></span>\n\t\t\t\t\t<span class=\"right-arrow pi pi-angle-right\"></span>\n\t\t\t\t\t<span class=\"paging-2-span end\"></span>\n\t\t\t\t\t<span class=\"double-right-arrow pi pi-angle-double-right\"></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`\n\t};\n\n} )\n( jQuery );","import { TTBackboneView } from '@/views/TTBackboneView';\nimport { TTAPI } from '@/services/TimeTrexClientAPI';\nimport { FormItemType, WidgetNamesDic } from '@/global/widgets/search_panel/FormItemType'; // TODO: duplicated in merged js files.\nimport '@/global/widgets/paging/Paging2.js';\nimport { Global } from '@/global/Global';\nimport { HtmlTemplatesGlobal } from '@/services/HtmlTemplates';\n\nwindow.FormItemType = FormItemType; // TODO: Eventually refactor to import only where these are used.\nwindow.WidgetNamesDic = WidgetNamesDic; // TODO: Eventually refactor to import only where these are used.\n\n/* jshint ignore:start */\n\n//Don't check this file for now. Too many issues.\nexport class BaseViewController extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\treal_this: null, //For super call in second level sub class\n\n\t\t\tsub_view_mode: false,\n\n\t\t\tedit_only_mode: false,\n\n\t\t\tcan_cache_controller: true, //if allow to cache current controller\n\n\t\t\tpermission_id: '',\n\t\t\tapi: null,\n\t\t\tuser_generic_data_api: null,\n\t\t\tall_columns: [],\n\t\t\tdisplay_columns: [],\n\t\t\tdefault_display_columns: [],\n\t\t\tscript_name: '',\n\t\t\tfilter_data: null, //current Filter data get from Search panel\n\t\t\ttemp_basic_filter_data: null,\n\t\t\ttemp_adv_filter_data: null,\n\t\t\tsortData: null, //Current Sort data get from search panel\n\t\t\tselect_layout: null,\n\t\t\tlayout_changed: false,\n\t\t\tsearch_panel: null,\n\t\t\tgrid: null,\n\t\t\tcontext_menu_name: '',\n\t\t\tnavigation_label: '',\n\t\t\tcontext_menu_array: [],\n\t\t\tt_grid_header_array: [],\n\n\t\t\t//Column Selector in search panel\n\t\t\tcolumn_selector: null,\n\n\t\t\tsort_by_selector: null,\n\n\t\t\tsave_search_as_input: null,\n\n\t\t\tprevious_saved_layout_selector: null,\n\n\t\t\tprevious_saved_layout_div: null,\n\n\t\t\tneed_select_layout_name: '', //Set this when save new layout to choose the new layout\n\n\t\t\tsearch_fields: null,\n\n\t\t\tbasic_search_field_ui_dic: {}, //Save AwesomeBox when they created\n\n\t\t\tadv_search_field_ui_dic: {}, //Save AwesomeBox when they created\n\n\t\t\tedit_view_ui_dic: {},\n\n\t\t\tedit_view_ui_validation_field_dic: {},\n\n\t\t\tedit_view_form_item_dic: {}, //Whole FormItem\n\n\t\t\tedit_view_error_ui_dic: {},\n\n\t\t\tedit_view: null,\n\n\t\t\tedit_view_tab: null,\n\n\t\t\tcurrent_edit_record: null, //Current edit record\n\n\t\t\trefresh_id: null, //Set this to refresh one record in grid view.\n\n\t\t\tnavigation: null, // Navigation widget in edit view\n\n\t\t\tis_mass_editing: false, //Set when mass edit\n\n\t\t\tis_viewing: false,\n\t\t\tis_viewing_detail: false,\n\t\t\tis_edit: false,\n\t\t\tis_add: false,\n\t\t\tis_report: false,\n\n\t\t\tunique_columns: [], //Set when Mass edit, mark which fields need to be disable\n\n\t\t\tlinked_fields: [],\n\n\t\t\tmass_edit_record_ids: [], // Mass edit records\n\n\t\t\tedit_view_tabs: [],\n\n\t\t\trefresh_sub_view: false,\n\n\t\t\tparent_key: null, //default filter when search\n\n\t\t\tparent_value: null, //default filter when search\n\n\t\t\tparent_edit_record: null,\n\n\t\t\ttotal_display_span: null,\n\n\t\t\tpaging_widget: null,\n\n\t\t\tpaging_widget_2: null, //Put in the bottom of data grid\n\n\t\t\tpager_data: null,\n\n\t\t\tviewId: null,\n\n\t\t\tinit_options_complete: false,\n\n\t\t\tno_result_box: null, // No Result Found Black cover when no result in grid\n\n\t\t\ttable_name_key: null,\n\n\t\t\tsub_log_view_controller: null,\n\n\t\t\tparent_view_controller: null, //Add this to call parent_view_controll cancel action when cancel from sub view\n\n\t\t\tui_id: '',\n\n\t\t\tis_changed: false, // Track if modified any fields in edit view\n\n\t\t\tconfirm_on_exit: false, //confirm before leaving the edit view even if no changes have been made\n\n\t\t\tedit_view_tpl: '', //Edit view html name\n\n\t\t\tsubMenuNavMap: null,\n\n\t\t\ttrySetGridSizeWhenTabShow: false, // Set sub view grid size when tab show instead when tab select\n\n\t\t\tcopied_record_id: '', // When copy as new, save copied reord's id\n\n\t\t\tcustom_field_api: null,\n\n\t\t\tlast_select_ids: null,\n\n\t\t\tsaving_layout_in_layout_tab: false, //Mark if save layout from Saved and layout tab. if so, don't switch tabs when set values to search panel\n\n\t\t\tneed_switch_to_context_menu: false,\n\n\t\t\tshow_search_tab: true,\n\n\t\t\tgrid_total_width: null,\n\n\t\t\tshow_warning_when_validation: false,\n\n\t\t\tpulse_time_dic: false,\n\n\t\t\tedit_view_close_icon: null,\n\n\t\t\tenable_validation: true,\n\n\t\t\t// _required_files: null,\n\n\t\t\ttab_model: null, //Tab definitions and a map to their callbacks.\n\n\t\t\tgrid_parent: null,\n\n\t\t\tcustom_fields: [],\n\n\t\t\tallow_fill_record_keys: null, //Additional keys to fill when fillCurrentRecord() is called. These are fields on this.current_edit_record and not the UI.\n\n\t\t\tauto_fill_data: null //This is a copy of LocalCacheData.getAutoFillData() scoped to the current object so it does not effect views that open at same time.\n\n\t\t} );\n\t\tsuper( options );\n\t}\n\n\t// getRequiredFiles() {\n\t// \t//override in child class\n\t// \treturn [];\n\t// }\n\n\t/**\n\t * When changing this function, you need to look for all occurences of this function because it was needed in several bases\n\t * BaseViewController, HomeViewController, BaseWizardController, QuickPunchBaseViewControler\n\t *\n\t * @returns {Array}\n\t */\n\t// filterRequiredFiles() {\n\t// \tDebug.Warn( 'Deprecated requirejs function. Replace usage immediately with webpack loaders.', 'BaseViewController.js', 'BaseViewController', 'filterRequiredFiles', 2 );\n\t//\n\t// \tvar retval = [];\n\t// \tvar required_files;\n\t//\n\t// \tif ( typeof this._required_files == 'object' ) {\n\t// \t\trequired_files = this._required_files;\n\t// \t} else {\n\t// \t\trequired_files = this.getRequiredFiles();\n\t// \t}\n\t//\n\t// \tif ( required_files && required_files[0] ) {\n\t// \t\tretval = required_files;\n\t// \t} else {\n\t// \t\tfor ( var edition_id in required_files ) {\n\t// \t\t\tif ( Global.getProductEdition() >= edition_id ) {\n\t// \t\t\t\tretval = retval.concat( required_files[edition_id] );\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\t//\n\t// \tDebug.Arr( retval, 'RETVAL', 'BaseViewController.js', 'BaseViewController', 'filterRequiredFiles', 10 );\n\t// \treturn retval;\n\t// }\n\n\tpreInit() {\n\t\t//override in child class\n\t}\n\n\tinitialize( options ) {\n\t\tDebug.Text( 'INITIALIZE', 'BaseViewController.js', 'BaseViewController', 'initialize', 10 );\n\t\tGlobal.setUINotready();\n\n\t\tsuper.initialize( options );\n\n\t\tTTPromise.add( 'init', 'init' );\n\t\tTTPromise.add( 'BaseViewController', 'initialize' );\n\t\t//trigger readystate update\n\t\tTTPromise.wait();\n\n\t\tvar $this = this;\n\t\tthis.layout_changed = false;\n\t\t// var required_files = this.filterRequiredFiles();\n\n\t\t// __non_webpack_require__( required_files, function() { // This is to prevent conflict with the Webpack Node require calls.\n\t\t// Debug.Warn( 'Deprecated requirejs function. Replace usage immediately with webpack loaders.', 'BaseViewController.js', 'BaseViewController', 'initialize', 2 );\n\n\t\tsetTimeout(function() { // #2662 This setTimeout is essential in keeping the code flow the same as when this code block has a requirejs callback. Otherwise it causes issues in many areas like Audit logs going blank, as the subview postInit function is called before its set in afterLoadView().\n\n\t\t\t$this.preInit( options );\n\n\t\t\t$this.options = options;\n\t\t\tif ( $this.options && Global.isSet( $this.options.can_cache_controller ) ) {\n\t\t\t\t$this.can_cache_controller = $this.options.can_cache_controller;\n\t\t\t}\n\n\t\t\tif ( $this.options && Global.isSet( $this.options.edit_only_mode ) ) {\n\t\t\t\t$this.edit_only_mode = $this.options.edit_only_mode;\n\t\t\t}\n\n\t\t\tif ( $this.options && Global.isSet( $this.options.sub_view_mode ) ) {\n\t\t\t\t$this.sub_view_mode = $this.options.sub_view_mode;\n\t\t\t} else {\n\t\t\t\t$this.sub_view_mode = false;\n\t\t\t}\n\n\t\t\tif ( $this.options && Global.isSet( $this.options.parent_view ) ) {\n\t\t\t\t$this.parent_view = $this.options.parent_view;\n\t\t\t}\n\n\t\t\tif ( $this.options && Global.isSet( $this.options.parent_view_controller ) ) {\n\t\t\t\t$this.parent_view_controller = $this.options.parent_view_controller;\n\t\t\t}\n\n\t\t\tif ( !$this.edit_only_mode ) {\n\n\t\t\t\tif ( $this.can_cache_controller ) {\n\t\t\t\t\tif ( !$this.sub_view_mode ) {\n\t\t\t\t\t\tLocalCacheData.current_open_primary_controller = $this;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tLocalCacheData.current_open_sub_controller = $this;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//Reset main container id so it won't duplicate when in sub view. Like Audit view.\n\t\t\t\tvar root_container = $( $this.el );\n\t\t\t\tvar new_id = root_container.attr( 'id' ) + '_' + Global.getRandomNum();\n\t\t\t\troot_container.attr( 'id', new_id );\n\t\t\t\t$this.el = '#' + new_id;\n\t\t\t\t$this.ui_id = new_id;\n\n\t\t\t\t$this.user_generic_data_api = TTAPI.APIUserGenericData;\n\n\t\t\t\t$this.total_display_span = $( $( $this.el ).find( '.total-number-span' )[0] );\n\n\t\t\t\t//$this shouldn't be displayed as it caused \"flashing\" of text and it wasn't translated either.\n\t\t\t\t//if ( $this.total_display_span ) {\n\t\t\t\t//$this.total_display_span.text( 'Displaying 0 - 0 of 0 total. Selected: 0' );\n\t\t\t\t//}\n\n\t\t\t\t//JS load Optimize\n\t\t\t\tif ( LocalCacheData.loadViewRequiredJSReady ) {\n\t\t\t\t\t//Init paging widget, next step, add widget to UI and bind events in setSelectLayout\n\t\t\t\t\tif ( LocalCacheData.paging_type === 0 ) {\n\t\t\t\t\t\t$this.paging_widget = Global.loadWidgetByName( WidgetNamesDic.PAGING );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.paging_widget = Global.loadWidgetByName( WidgetNamesDic.PAGING_2 );\n\t\t\t\t\t\t$this.paging_widget_2 = Global.loadWidgetByName( WidgetNamesDic.PAGING_2 );\n\t\t\t\t\t\t$this.paging_widget = $this.paging_widget.Paging2();\n\t\t\t\t\t\t$this.paging_widget_2 = $this.paging_widget_2.Paging2();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t$this.ui_id = Global.getRandomNum();\n\t\t\t}\n\n\t\t\t//init all dic or array, or it will extends last viewcontroller's value. Why?\n\t\t\t$this.sub_log_view_controller = null;\n\t\t\t$this.edit_view_ui_dic = {};\n\t\t\t$this.edit_view_ui_validation_field_dic = {};\n\t\t\t$this.basic_search_field_ui_dic = {};\n\t\t\t$this.adv_search_field_ui_dic = {};\n\t\t\t$this.edit_view_tabs = [];\n\n\t\t\t$this.custom_field_api = TTAPI.APICustomField;\n\n\t\t\t$this.initKeyboardEvent(); // register keyboard events if it's a main view\n\n\t\t\t$this.init( options );\n\t\t\t$this.postInit( options );\n\n\t\t\tTTPromise.resolve( 'BaseViewController', 'initialize' );\n\t\t\tTTPromise.resolve( 'init', 'init' );\n\t\t}, 1);\n\t}\n\n\tinit() {\n\t\t//override in child class\n\t}\n\n\tpostInit() {\n\t\t//override in child class\n\t}\n\n\tinitKeyboardEvent() {\n\n\t\tvar $this = this;\n\t\tif ( this.sub_view_mode || this.edit_only_mode ) {\n\t\t\treturn;\n\t\t}\n\n//\t\t$( this.el ).unbind( 'keydown' ).bind( 'keydown', function( e ) {\n//\n//\t\t\tif ( e.keyCode === 13 && !$this.search_panel.isCollapsed() ) {\n//\t\t\t\t$this.onSearch();\n//\t\t\t}\n//\n//\t\t} );\n\n\t\t$( this.el ).unbind( 'keyup' ).bind( 'keydown', function( e ) {\n\n\t\t\tif ( e.keyCode === 13 && $this.search_panel && !$this.search_panel.isCollapsed() ) {\n\n\t\t\t\t$this.onSearch();\n\t\t\t\t$( ':focus' ).blur(); //Make focus out of current view. pevent search too much when user keep click enter\n\t\t\t}\n\t\t} );\n\t}\n\n\t//Speical permission check for views, need override\n\tinitPermission() {\n\t}\n\n\t//Set this when setDefault menu\n\tsetTotalDisplaySpan() {\n\t\tif ( !this.total_display_span ) {\n\t\t\treturn;\n\t\t}\n\t\tvar totalRows;\n\t\tvar start;\n\t\tvar end;\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\tvar grid_selected_length = 0;\n\t\t//Uncaught TypeError: Cannot read property 'length' of undefined\n\t\tif ( grid_selected_id_array ) {\n\t\t\tgrid_selected_length = grid_selected_id_array.length;\n\t\t}\n\n\t\tvar items_pre_page = 100;\n\t\tif ( LocalCacheData.getLoginUserPreference() ) {\n\t\t\tvar items_per_page = parseInt( LocalCacheData.getLoginUserPreference().items_per_page );\n\t\t}\n\n\t\tif ( LocalCacheData.paging_type === 0 ) {\n\t\t\tif ( this.pager_data ) {\n\t\t\t\ttotalRows = this.pager_data.total_rows;\n\t\t\t\tstart = 1;\n\t\t\t\tend = this.grid.getData().length;\n\t\t\t} else {\n\t\t\t\ttotalRows = 0;\n\t\t\t\tstart = 0;\n\t\t\t\tend = 0;\n\t\t\t}\n\t\t} else {\n\t\t\tif ( this.pager_data ) {\n\t\t\t\ttotalRows = this.pager_data.total_rows;\n\t\t\t\tstart = 0;\n\t\t\t\tend = 0;\n\n\t\t\t\tif ( this.pager_data.last_page_number > 1 ) {\n\t\t\t\t\tif ( !this.pager_data.is_last_page ) {\n\n\t\t\t\t\t\tstart = ( this.pager_data.current_page - 1 ) * items_per_page + 1;\n\t\t\t\t\t\tend = start + items_per_page - 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstart = ( this.pager_data.current_page - 1 ) * items_per_page + 1;\n\t\t\t\t\t\tend = totalRows;\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tstart = 1;\n\t\t\t\t\tend = totalRows;\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\ttotalRows = 0;\n\t\t\t\tstart = 0;\n\t\t\t\tend = 0;\n\t\t\t}\n\t\t}\n\n\t\t//Counting pages can be disabled, in which case totalRows returns FALSE unless the user is on the last page.\n\t\tvar totalInfo = start + ' - ' + end;\n\t\tif ( totalRows !== false ) {\n\t\t\ttotalInfo = totalInfo + ' ' + $.i18n._( 'of' ) + ' ' + totalRows + ' ' + $.i18n._( 'total' ) + '.';\n\t\t}\n\n\t\tthis.total_display_span.text( $.i18n._( 'Displaying' ) + ' ' + totalInfo + ' [ ' + $.i18n._( 'Selected' ) + ': ' + grid_selected_length + ' ]' );\n\t}\n\n\tisContextIconDisabled( id ) {\n\t\tvar context_menu_array = ContextMenuManager.getMenuModelByMenuId( this.determineContextMenuMountAttributes().id );\n\t\tvar len = context_menu_array.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tlet context_btn = context_menu_array[i];\n\t\t\tif ( context_menu_array[i].id === id ) {\n\t\t\t\tif ( context_btn.disabled || ( context_btn.hasOwnProperty( 'visible' ) && !context_btn.visible ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn true; //Cannot find context menu button, return true as if button is disabled / cannot be used.\n\t}\n\n\tgetViewModeErrorMessage() {\n\t\t//Change error message depending on if edit context menu icon is available or not.\n\t\tif ( this.isContextIconDisabled( 'edit' ) ) {\n\t\t\treturn Global.view_mode_message;\n\t\t}\n\n\t\treturn Global.view_mode_message + ', ' + Global.view_mode_edit_message;\n\t}\n\n\t//Set right click menu for list view grid\n\tinitRightClickMenu( target_type ) {\n\t\t//Error: Object doesn't support property or method 'contextMenu' in /interface/html5/views/BaseViewController.js?v=7.4.6-20141027-132733 line 393\n\t\tif ( !$.hasOwnProperty( 'contextMenu' ) ) {\n\t\t\treturn;\n\t\t}\n\t\tvar $this = this;\n\n\t\tvar selector = '';\n\n\t\tswitch ( target_type ) {\n\t\t\tcase RightClickMenuType.LISTVIEW:\n\t\t\t\tselector = '#gbox_' + this.ui_id + '_grid';\n\t\t\t\tbreak;\n\t\t\tcase RightClickMenuType.EDITVIEW:\n\t\t\t\tselector = '#' + this.ui_id + '_edit_view_tab';\n\t\t\t\tbreak;\n\t\t\tcase RightClickMenuType.NORESULTBOX:\n\t\t\t\tselector = '#' + this.ui_id + '_no_result_box';\n\t\t\t\tbreak;\n\t\t\tcase RightClickMenuType.ABSENCE_GRID:\n\t\t\t\tselector = '#' + this.ui_id + '_absence_grid';\n\t\t\t\tbreak;\n\t\t\tcase RightClickMenuType.VIEW_ICON:\n\t\t\t\tselector = '#' + 'view_html';\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tselector = '#gbox_' + this.ui_id + '_grid';\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( $( selector ).length == 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar items = this.getRightClickMenuItems();\n\n\t\tif ( !items || $.isEmptyObject( items ) ) {\n\t\t\treturn;\n\t\t}\n\t\t$.contextMenu( 'destroy', selector );\n\t\t$.contextMenu( {\n\t\t\tselector: selector,\n\t\t\tcallback: function( key, options ) {\n\t\t\t\t$this.onContextMenuClick( null, key );\n\t\t\t},\n\n\t\t\tonContextMenu: function() {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\titems: items\n\t\t} );\n\t}\n\n\tgetRightClickMenuItems() {\n\t\tvar $this = this;\n\n\t\tvar items = {};\n\t\tvar context_menu_array = ContextMenuManager.getMenuModelByMenuId( this.determineContextMenuMountAttributes().id );\n\t\tvar len = context_menu_array.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = context_menu_array[i];\n\n\t\t\tif ( context_btn.visible === false || context_btn.action_group_header || context_btn.separator || !context_btn.show_on_right_click ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar label = Global.htmlDecode( context_btn.label.replace( '<br>', ' ' ) );\n\t\t\tvar id = context_btn.id;\n\n\t\t\titems[id] = {\n\t\t\t\tname: label,\n\t\t\t\tdisabled: function( key ) {\n\t\t\t\t\treturn $this.isContextIconDisabled( key );\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\treturn items;\n\t}\n\n\t//Don't initOptions if edit_only_mode. Do it in sub views\n\tinitData() {\n\t\tvar $this = this;\n\n\t\t//Work around to init sub view after tab is shown.\n\t\tGlobal.removeViewTab( this.viewId );\n\t\tProgressBar.showOverlay();\n\t\tif ( !$this.edit_only_mode ) {\n\n\t\t\t//Various views expect search fields to be built already, such as initOptions() in PunchesViewController or getAllColumns() in ScheduleViewController.\n\t\t\t//Because of that we need to wait for resolution of getCustomFields promise to avoid exceptions and breaking views.\n\t\t\tTTPromise.wait( 'BaseViewController', 'getCustomFields', function() {\n\t\t\t\t$this.initOptions();\n\t\t\t\t$this.getAllColumns( function() {\n\t\t\t\t\t$this.initLayout();\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\t//When on a sub view mode tab we want to disable certain context menu buttons of the parent view.\n\t\t\t//This is to help prevent users from using context menu buttons for the wrong view and deleting/copying records they did not intend to use.\n\t\t\tthis.onSubViewModeDisableParentContextMenuButtons();\n\t\t}\n\t}\n\n\tinitLayout() {\n\t\tvar $this = this;\n\t\t$this.getAllLayouts( function() {\n\t\t\t$this.getDefaultDisplayColumns( function() {\n\t\t\t\t$this.setSelectLayout();\n\t\t\t\t//$this.setGridColumnsWidth(); //This is done in setSelectLayout() and searchDone(), so no point in doing it multiple times.\n\t\t\t\t$this.search();\n\t\t\t} );\n\t\t} );\n\t}\n\n\t// edit_only_mode call this when open edit view. Not in initData\n\tinitOptions() {\n\t}\n\n\t// TODO: Consolidate id and menu container into one function.\n\t/**\n\t * Determine what id, mount point, and menu type are needed to create the context menu for a specific view/edit view, based on the current view state. Main, Edit View, Sub View etc.\n\t */\n\tdetermineContextMenuMountAttributes() {\n\t\tvar return_object = {\n\t\t\tid: null,\n\t\t\tparent_mount_point: null,\n\t\t\tmenu_type: null,\n\t\t\tparent_id: null\n\t\t};\n\n\t\t// Figure out parent type\n\n\t\t/* Be aware that if something is incorrectly matched here, it may try to match with a wrong menu, or existing other menu,\n\t\t * and thus may have the side effect of closing the wrong menu when a window is closed.\n\t\t * If that symptom happens, check the matching here.\n\t\t */\n\n\t\t// You can see an extensive list in setCurrentEditViewState().\n\t\tif( this.is_add\n\t\t\t|| this.is_viewing\n\t\t\t|| this.is_viewing_detail //Cannot use just LocalCacheData.current_doing_context_action === 'view_detail' as it gets overwritten to cancel.\n\t\t\t|| this.is_edit\n\t\t\t|| this.is_mass_editing\n\t\t\t|| this.is_mass_adding // Not tested, but as all the others from setCurrentEditViewState are now here, might as well add it.\n\t\t\t|| this.edit_only_mode\n\t\t\t|| LocalCacheData.current_doing_context_action === 'view_detail' //With is_viewing_detail we may no longer need this condition.\n\t\t\t|| LocalCacheData.current_doing_context_action === 'delete'\n\t\t) {\n\t\t\treturn_object = this.parseContextMenuEditViewAttributes();\n\t\t} else if( $( this.el ).parents( '.edit-view-tab-outside-sub-view' ).length > 0 && this.ui_id ) {\n\t\t\t// Using this approach rather than this.sub_view_mode, as some views have edit views still showing as subviews.\n\t\t\t// #VueContextMenu#SubViews# Old approach can be found in BaseVC.parseCustomContextModelForSubViews but its better to control it from here in one place.\n\t\t\t// These matches would previously match to main_view, but subviews should be different to main views.\n\t\t\treturn_object = this.parseContextMenuEditSubViewTabAttributes();\n\t\t}\n\t\telse if( this.ui_id ) {\n\t\t\treturn_object = this.parseContextMenuMainViewAttributes();\n\t\t} else {\n\t\t\t// If each view has a unique context menu, then this should never happen, as context menu should only be initiated once.\n\t\t\t// However, there are many cases where tabs repeatedly call this.buildContextMenu, whilst keeping the same view controller, so this is now a warning rather than an error.\n\t\t\tDebug.Error( 'Error: View state for '+ this.viewId +' ('+ this.ui_id +') does not match options.', 'BaseViewController.js', 'BaseViewController', 'determineContextMenuMountAttributes', 1 );\n\t\t}\n\n\t\t// Regardless of editview/main type above, there are some occasions when it detects as main menu, but its still within tabs.\n\t\t// Here it would be Edit View -> Tabs -> Subview. For example Attendance->Accrual Balance -> View.\n\t\t// The top icons are edit view for AccrualBalanceView.\n\t\t// The icons within Accrual tab are seen as a main menu for AccrualView.\n\t\t// Lets add these occurances into another type.\n\n\t\t// Get ID\n\t\treturn_object.id = ContextMenuManager.generateMenuId( return_object.menu_type, return_object.parent_id );\n\n\t\treturn return_object;\n\t}\n\n\tparseContextMenuEditViewAttributes() {\n\t\t// Designed to be overriden by views if behaviour needs to be different.\n\t\t// All the edit_view style windows. Although the edit_only ones have a slightly different this.ui_id value, but the code is the same.\n\t\tif( !this.edit_view_tab ) {\n\t\t\t// If mount point IS needed (not just menu ID), then this is a bug. Check if buildContextMenu is not called before edit_view_tab populated (common in views overriding BaseView functions like openEditView.\n\t\t\tDebug.Text( 'Warning: Unable to get full context menu mount data, edit_view_tab missing. Might be ok if mount point not needed. Check if buildContextMenu is not called before edit_view_tab populated (common in views overriding BaseView functions like openEditView ('+ this.viewId +'/'+ this.ui_id +')', 'BaseViewController.js', 'BaseViewController', 'parseContextMenuEditViewAttributes', 10 );\n\t\t}\n\t\tif( !this.ui_id ) {\n\t\t\tDebug.Error( 'Warning: Unable to get full context menu mount data, ui_id missing. ('+ this.viewId +'/'+ this.ui_id +')', 'BaseViewController.js', 'BaseViewController', 'parseContextMenuEditViewAttributes', 1 );\n\t\t}\n\t\treturn {\n\t\t\tparent_mount_point: this.edit_view_tab, // Note: When this function is called, the edit_view_tab might not be built yet, so parent mount could be null, thats ok if mount point not needed yet.\n\t\t\tparent_id: this.ui_id + '_edit_view_tab',\n\t\t\tmenu_type: 'editview_contextmenu',\n\t\t}\n\t}\n\tparseContextMenuMainViewAttributes() {\n\t\t// Designed to be overriden by views if behaviour needs to be different.\n\t\t// Main views\n\n\t\tif( !this.ui_id ) {\n\t\t\tDebug.Error( 'Warning: Unable to get full context menu mount data, ui_id missing. ('+ this.viewId +'/'+ this.ui_id +')', 'BaseViewController.js', 'BaseViewController', 'parseContextMenuEditViewAttributes', 1 );\n\t\t}\n\n\t\treturn {\n\t\t\tparent_mount_point: $( this.el ),\n\t\t\tparent_id: this.ui_id,\n\t\t\tmenu_type: 'listview_contextmenu',\n\t\t}\n\t}\n\n\tparseContextMenuEditSubViewTabAttributes() {\n\t\t// Designed to be overriden by views if behaviour needs to be different.\n\t\t// Based on main_contextmenu\n\n\t\tif( !this.ui_id ) {\n\t\t\tDebug.Error( 'Warning: Unable to get full context menu mount data, ui_id missing. ('+ this.viewId +'/'+ this.ui_id +')', 'BaseViewController.js', 'BaseViewController', 'parseContextMenuEditViewAttributes', 1 );\n\t\t}\n\n\t\treturn {\n\t\t\tparent_mount_point: $( this.el ),\n\t\t\tparent_id: this.ui_id,\n\t\t\tmenu_type: 'subview_contextmenu',\n\t\t}\n\t}\n\n\tgetDefaultContextMenuModel() {\n\n\t\tvar default_context_menu_model = {\n\t\t\t'groups': {\n\t\t\t\t'editor': {\n\t\t\t\t\tlabel: $.i18n._( 'Editor' ),\n\t\t\t\t\tid: 'editor',\n\t\t\t\t\tsort_order: 1000\n\t\t\t\t},\n\t\t\t\t'navigation': {\n\t\t\t\t\tlabel: $.i18n._( 'Navigation' ),\n\t\t\t\t\tid: 'navigation',\n\t\t\t\t\tsort_order: 8000\n\t\t\t\t},\n\t\t\t\t'other': {\n\t\t\t\t\tlabel: $.i18n._( 'Other' ),\n\t\t\t\t\tid: 'other',\n\t\t\t\t\tsort_order: 9000\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t'icons': {}\n\t\t};\n\n\t\tdefault_context_menu_model['icons']['add'] = {\n\t\t\tlabel: $.i18n._( 'New' ),\n\t\t\tid: 'add',\n\t\t\tgroup: 'editor',\n\t\t\tvue_icon: 'tticon tticon-add_black_24dp',\n\t\t\tshow_on_right_click: true,\n\t\t\tsort_order: 1000\n\t\t};\n\n\t\tdefault_context_menu_model['icons']['view'] = {\n\t\t\tlabel: $.i18n._( 'View' ),\n\t\t\tid: 'view',\n\t\t\tgroup: 'editor',\n\t\t\tvue_icon: 'tticon tticon-visibility_black_24dp',\n\t\t\tshow_on_right_click: true,\n\t\t\tsort_order: 1010\n\t\t};\n\n\t\tdefault_context_menu_model['icons']['edit'] = {\n\t\t\tlabel: $.i18n._( 'Edit' ),\n\t\t\tid: 'edit',\n\t\t\tgroup: 'editor',\n\t\t\tvue_icon: 'tticon tticon-edit_black_24dp',\n\t\t\tshow_on_right_click: true,\n\t\t\tsort_order: 1020,\n\t\t\t//min_width: '85' /* Match with mass_edit so they can toggle without moving any menu items in UI */\n\t\t};\n\n\t\tdefault_context_menu_model['icons']['mass_edit'] = {\n\t\t\tlabel: $.i18n._( 'Mass Edit' ),\n\t\t\tid: 'mass_edit',\n\t\t\tgroup: 'editor',\n\t\t\tvue_icon: 'tticon tticon-edit_note_black_24dp',\n\t\t\tshow_on_right_click: true,\n\t\t\tvisible: false, // Ensures Mass Edit is not shown at start together with Edit. We only want one or the other.\n\t\t\tsort_order: 1030,\n\t\t\t//min_width: '85' /* Match with edit so they can toggle without moving any menu items in UI */\n\t\t};\n\n\t\tdefault_context_menu_model['icons']['delete_icon'] = {\n\t\t\tlabel: $.i18n._( 'Delete' ),\n\t\t\tid: 'delete_icon',\n\t\t\taction_group: 'delete',\n\t\t\tgroup: 'editor',\n\t\t\tvue_icon: 'tticon tticon-delete_black_24dp',\n\t\t\tshow_on_right_click: true,\n\t\t\tsort_order: 1040\n\t\t};\n\n\t\tdefault_context_menu_model['icons']['delete_and_next'] = {\n\t\t\tlabel: $.i18n._( 'Delete & Next' ),\n\t\t\tid: 'delete_and_next',\n\t\t\taction_group: 'delete',\n\t\t\tgroup: 'editor',\n\t\t\tvue_icon: 'tticon tticon-delete_black_24dp',\n\t\t\tsort_order: 1050\n\t\t};\n\n\t\tdefault_context_menu_model['icons']['copy'] = {\n\t\t\tlabel: $.i18n._( 'Copy' ),\n\t\t\tid: 'copy',\n\t\t\taction_group: 'copy',\n\t\t\tgroup: 'editor',\n\t\t\tvue_icon: 'tticon tticon-content_copy_black_24dp',\n\t\t\tshow_on_right_click: true,\n\t\t\tsort_order: 1060\n\t\t};\n\n\t\tdefault_context_menu_model['icons']['copy_as_new'] = {\n\t\t\tlabel: $.i18n._( 'Copy as New' ),\n\t\t\tid: 'copy_as_new',\n\t\t\taction_group: 'copy',\n\t\t\tgroup: 'editor',\n\t\t\tvue_icon: 'tticon tticon-content_copy_black_24dp',\n\t\t\tshow_on_right_click: true,\n\t\t\tsort_order: 1070\n\t\t};\n\n\t\tdefault_context_menu_model['icons']['save'] = {\n\t\t\tlabel: $.i18n._( 'Save' ),\n\t\t\tid: 'save',\n\t\t\taction_group: 'save',\n\t\t\tgroup: 'editor',\n\t\t\tvue_icon: 'tticon tticon-save_black_24dp',\n\t\t\tshow_on_right_click: true,\n\t\t\tsort_order: 1080\n\t\t};\n\n\t\tdefault_context_menu_model['icons']['save_and_continue'] = {\n\t\t\tlabel: $.i18n._( 'Save & Continue' ),\n\t\t\tid: 'save_and_continue',\n\t\t\taction_group: 'save',\n\t\t\tgroup: 'editor',\n\t\t\tvue_icon: 'tticon tticon-save_black_24dp',\n\t\t\tsort_order: 1090\n\t\t};\n\n\t\tdefault_context_menu_model['icons']['save_and_next'] = {\n\t\t\tlabel: $.i18n._( 'Save & Next' ),\n\t\t\tid: 'save_and_next',\n\t\t\taction_group: 'save',\n\t\t\tgroup: 'editor',\n\t\t\tvue_icon: 'tticon tticon-save_black_24dp',\n\t\t\tsort_order: 1100\n\t\t};\n\n\t\tdefault_context_menu_model['icons']['save_and_copy'] = {\n\t\t\tlabel: $.i18n._( 'Save & Copy' ),\n\t\t\tid: 'save_and_copy',\n\t\t\taction_group: 'save',\n\t\t\tgroup: 'editor',\n\t\t\tvue_icon: 'tticon tticon-save_black_24dp',\n\t\t\tsort_order: 1110\n\t\t};\n\n\t\tdefault_context_menu_model['icons']['save_and_new'] = {\n\t\t\tlabel: $.i18n._( 'Save & New' ),\n\t\t\tid: 'save_and_new',\n\t\t\taction_group: 'save',\n\t\t\tgroup: 'editor',\n\t\t\tvue_icon: 'tticon tticon-save_black_24dp',\n\t\t\tsort_order: 1120\n\t\t};\n\n\t\tdefault_context_menu_model['icons']['cancel'] = {\n\t\t\tlabel: $.i18n._( 'Cancel' ),\n\t\t\tid: 'cancel',\n\t\t\tgroup: 'editor',\n\t\t\tvue_icon: 'tticon tticon-cancel_black_24dp',\n\t\t\tsort_order: 1130\n\t\t};\n\n\t\tdefault_context_menu_model['icons']['export_excel'] = {\n\t\t\tlabel: $.i18n._( 'Export' ),\n\t\t\tid: 'export_excel',\n\t\t\tmenu_align: 'right',\n\t\t\taction_group: 'import_export',\n\t\t\tgroup: 'other',\n\t\t\tvue_icon: 'tticon tticon-file_upload_black_24dp',\n\t\t\tsort_order: 9000,\n\t\t\tmenu_force_active: true\n\t\t};\n\n\t\treturn default_context_menu_model;\n\t}\n\n\t// Overriden by ViewControllers with custom context menus.\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\tgroups: {},\n\t\t\texclude: [],\n\t\t\tinclude: ['default']\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\tparseCustomContextModelForEditViews( context_menu_model ) {\n\n\t\t// #VueContextMenu# - Commenting out logic below as we want to have the menu type logic in one place (BaseVC.determineContextMenuMountAttributes)\n\t\t// if( this.is_add\n\t\t// \t|| this.is_viewing\n\t\t// \t|| this.is_edit\n\t\t// \t|| this.is_mass_editing\n\t\t// \t|| this.is_mass_adding // Not tested, but as all the others from setCurrentEditViewState are now here, might as well add it.\n\t\t// \t|| this.edit_only_mode\n\t\t// \t|| LocalCacheData.current_doing_context_action === 'view_detail'\n\t\t// ) {\n\t\tif( this.determineContextMenuMountAttributes().menu_type === 'editview_contextmenu' ) {\n\t\t\tcontext_menu_model.include.push( 'cancel' );\n\t\t}\n\n\t\treturn context_menu_model;\n\t}\n\tparseCustomContextModelForSubViews( context_menu_model ) {\n\t\t// If a view does not want this, override the function in that view and just return the untouched object.\n\t\t// #VueContextMenu#SubViews# Commenting out the logic below as we should just have the controlling logic in one place (BaseVC.determineContextMenuMountAttributes)\n\n\t\t// if( this.determineContextMenuMountAttributes().menu_type === 'subview_contextmenu'\n\t\t// \t|| (this.sub_view_mode\n\t\t// \t&& !this.is_edit\n\t\t// \t&& !this.is_viewing\n\t\t// \t&& LocalCacheData.current_doing_context_action !== 'view' // To ensure view state is carried forward across subview loads, as Accrual Balance -> Accrual View record results in this.is_viewing === false.\n\t\t// \t&& LocalCacheData.current_doing_context_action !== 'edit' // Note: See if these last 2 checks are still needed after subview_contextmenu check addition.\n\t\t// )) { // TODO: Does not seem to work for Audit log, as is_viewing is deliberately set to false.\n\t\tif( this.determineContextMenuMountAttributes().menu_type === 'subview_contextmenu' ) {\n\t\t\tcontext_menu_model.exclude.push( 'cancel' ); // Needed as subview grid menus dont need to be able to close the current window; the main context menu should do that.\n\t\t}\n\n\t\treturn context_menu_model;\n\t}\n\n\tbuildContextMenuModels() {\n\t\t// Note: Currently icons might still be hidden by the permissions code, due to the 'invisible-image' class, especially with this.edit_only_mode. See BaseViewController.setDefaultMenuAddIcon() as an example.\n\n\t\tlet icon_count = 1;\n\t\tlet context_menu_model = this.getCustomContextMenuModel();\n\n\t\t// Override for edit views.\n\t\tcontext_menu_model = this.parseCustomContextModelForEditViews( context_menu_model );\n\n\t\t// Override for subviews, as we want to remove Cancel. This is global, perhaps refactor into the individual getCustomContextMenuModel but that means duplicating the code in 100+ places.\n\t\tcontext_menu_model = this.parseCustomContextModelForSubViews( context_menu_model );\n\n\t\tif ( context_menu_model && ( context_menu_model.include || context_menu_model.exclude ) ) {\n\t\t\t//Context Menu\n\n\t\t\tlet default_context_menu_model = this.getDefaultContextMenuModel();\n\n\t\t\tlet final_context_menu_model = { 'icons': {}, 'groups': {} };\n\n\t\t\tif ( !context_menu_model.groups ) {\n\t\t\t\tcontext_menu_model.groups = {};\n\t\t\t}\n\n\t\t\t//Default to including all default icons.\n\t\t\tif ( !context_menu_model.include ) {\n\t\t\t\tcontext_menu_model.include = ['default'];\n\t\t\t}\n\n\t\t\t//If we don't include default, assume we want to include all default icons.\n\t\t\tif ( context_menu_model.include.indexOf( 'default' ) === -1 ) {\n\t\t\t\tcontext_menu_model.include.unshift( 'default' ); // Add to front, so custom icons can override a default icon id.\n\t\t\t}\n\n\t\t\t//Assign default groups.\n\t\t\tfor ( let x in default_context_menu_model.groups ) {\n\t\t\t\tdefault_context_menu_model.groups[x].sub_menus = [];\n\n\t\t\t\tfinal_context_menu_model.groups[x] = default_context_menu_model.groups[x];\n\t\t\t}\n\n\t\t\tfor ( let x in context_menu_model.groups ) {\n\t\t\t\tcontext_menu_model.groups[x].sub_menus = [];\n\n\t\t\t\tfinal_context_menu_model.groups[x] = context_menu_model.groups[x];\n\t\t\t}\n\n\t\t\t//Filter groups/icons\n\t\t\tif ( context_menu_model.hasOwnProperty( 'include' ) ) {\n\t\t\t\tif ( context_menu_model.include.constructor !== Array ) {\n\t\t\t\t\tcontext_menu_model.include = Array( context_menu_model.include );\n\t\t\t\t}\n\n\t\t\t\tfor ( let i in context_menu_model.include ) {\n\t\t\t\t\tlet current_include_element = context_menu_model.include[i];\n\t\t\t\t\tif( context_menu_model.include.hasOwnProperty( i )) {\n\t\t\t\t\t\tif ( current_include_element == 'default' ) {\n\t\t\t\t\t\t\tDebug.Text( 'Including All Default Icons...', 'BaseViewController.js', 'BaseViewController', 'buildContextMenuModels', 11 );\n\n\t\t\t\t\t\t\tfor ( let x in default_context_menu_model.icons ) {\n\t\t\t\t\t\t\t\taddIconToFinalModel( default_context_menu_model.icons[x] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif ( typeof current_include_element !== 'object' && default_context_menu_model.icons[current_include_element] ) {\n\t\t\t\t\t\t\t\taddIconToFinalModel( default_context_menu_model.icons[current_include_element] );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\taddIconToFinalModel( current_include_element );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction addIconToFinalModel( icon ) {\n\t\t\t\tif( !icon.sort_order && icon.group ) {\n\t\t\t\t\ticon.sort_order = final_context_menu_model.groups[ icon.group ].sort_order; // Rather than setting the default to 1000, lets set it to the start of the icon's group, so it appears in roughly the right area of the menu. Fixes e.g. TimeSheet & Export in Employee->Employees.\n\t\t\t\t}\n\t\t\t\t// TODO: Also need scenario for when there is no sort_order and no group. Currently this is caught as a console error via checks in ContextMenuManager.convertBackBoneMenuModelToPrimeVue.sort_compare\n\n\t\t\t\ticon.add_order = icon_count; // rather than calculating length each time, just track additions, as all icons should be added through here anyway.\n\t\t\t\tfinal_context_menu_model.icons[icon.id] = icon;\n\t\t\t\ticon_count++;\n\n\t\t\t\treturn icon;\n\t\t\t}\n\n\t\t\t// #2644 Include array is a mix of icon id strings and objects, this function flattens it to an array of strings for id comparision.\n\t\t\tfunction flattenMixedIdObjectArray( array ) {\n\t\t\t\treturn array.map( function( item ) {\n\t\t\t\t\treturn item.id || item;\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tlet tmp_included_icon_ids = flattenMixedIdObjectArray( context_menu_model.include );\n\n\t\t\t//Must go after include, so they can include a few icons, then exclude all.\n\t\t\tif ( context_menu_model.hasOwnProperty( 'exclude' ) ) {\n\t\t\t\tif ( context_menu_model.exclude.constructor !== Array ) {\n\t\t\t\t\tcontext_menu_model.exclude = Array( context_menu_model.exclude );\n\t\t\t\t}\n\n\t\t\t\tfor ( let j in context_menu_model.exclude ) {\n\t\t\t\t\tif( context_menu_model.exclude.hasOwnProperty( j )) {\n\t\t\t\t\t\tif ( context_menu_model.exclude[j] == 'default' ) {\n\t\t\t\t\t\t\tDebug.Text( 'Excluding All Default Icons...', 'BaseViewController.js', 'BaseViewController', 'buildContextMenuModels', 10 );\n\n\t\t\t\t\t\t\tfor ( let x in default_context_menu_model.icons ) {\n\t\t\t\t\t\t\t\tif ( tmp_included_icon_ids.indexOf( x ) === -1 ) { //Make sure we don't exclude one that is included. Compare against flattened/extracted include array, otherwise types do not match and all default icons are removed regardless if they exist in include.\n\t\t\t\t\t\t\t\t\tif ( final_context_menu_model.icons[x] ) {\n\t\t\t\t\t\t\t\t\t\tdelete final_context_menu_model.icons[x];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlet exclude_icon_id = context_menu_model.exclude[j];\n\t\t\t\t\t\t\tif ( final_context_menu_model.icons[exclude_icon_id] ) {\n\t\t\t\t\t\t\t\tdelete final_context_menu_model.icons[exclude_icon_id];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//Build Menu\n\t\t\tlet groups = {};\n\t\t\tfor ( let x in final_context_menu_model.groups ) {\n\t\t\t\tgroups[x] = final_context_menu_model.groups[x];\n\t\t\t\tDebug.Text( 'Creating Ribbon Menu Group: ' + final_context_menu_model.groups[x].label, 'BaseViewController.js', 'BaseViewController', 'buildContextMenuModels', 11 );\n\t\t\t}\n\n\t\t\tfor ( let x in final_context_menu_model.icons ) {\n\n\t\t\t\t//Replace group string with object.\n\t\t\t\tif ( final_context_menu_model.icons[x] && final_context_menu_model.icons[x].group ) {\n\t\t\t\t\tif ( final_context_menu_model.icons[x].group.constructor === String ) {\n\t\t\t\t\t\tfinal_context_menu_model.icons[x].group = groups[final_context_menu_model.icons[x].group];\n\t\t\t\t\t} else if ( typeof final_context_menu_model.icons[x].group === 'object' ) {\n\t\t\t\t\t\t//The 2nd time the edit view is opened, icons manually passed in through 'include' already have the groups converted to objects, but the icons don't appear until we re-assign the group object again.\n\t\t\t\t\t\tfinal_context_menu_model.icons[x].group = groups[final_context_menu_model.icons[x].group.get( 'id' )];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( final_context_menu_model.icons[x].hasOwnProperty( 'permission_result' ) == false ) {\n\t\t\t\t\tfinal_context_menu_model.icons[x].permission_result = true;\n\t\t\t\t}\n\t\t\t\tif ( !final_context_menu_model.icons[x].hasOwnProperty( 'permission' ) == false ) {\n\t\t\t\t\tfinal_context_menu_model.icons[x].permission = null;\n\t\t\t\t}\n\n\t\t\t\tDebug.Text( 'Creating Ribbon Menu Icon: ' + final_context_menu_model.icons[x].label, 'BaseViewController.js', 'BaseViewController', 'buildContextMenuModels', 11 );\n\n/*\t\t\t\t// TODO: This not an ideal way to do it, but not worth changing until a bigger refactor of the context menu is done at a later date.\n\t\t\t\tif ( final_context_menu_model.icons[x].items && final_context_menu_model.icons[x].items.length > 0 ) {\n\t\t\t\t\t// We use item to store the pre conversion and post conversion data. Therefore we must re-assign to a temp var, and reset.\n\t\t\t\t\tlet items_to_add = final_context_menu_model.icons[x].items;\n\n\t\t\t\t\t// Still store the original items so that the new Vue Menu can parse these.\n\t\t\t\t\tfinal_context_menu_model.icons[x].original_items = items_to_add;\n\n\t\t\t\t\t// Reset the items attribute to an empty array, ready for RibbonSubMenuNavItem to use later on. Still needs clearing to empty array in ContextMenuManager once the ribbonmenu is done with it.\n\t\t\t\t\tfinal_context_menu_model.icons[x].items = [];\n\t\t\t\t}*/\n\t\t\t}\n\n\t\t\t// #VueContextMenu# Pass the final context menu model to the Vue context menu.\n\t\t\tContextMenuManager.buildContextMenuModelFromBackbone( this.determineContextMenuMountAttributes().id, final_context_menu_model, this );\n\n\t\t} else {\n\t\t\t//Legacy fallback when no context menu model is defined.\n\t\t\tGlobal.sendErrorReport( 'ContextMenuModel error. No valid contextmenu model defined.' );\n\t\t}\n\t}\n\n\tunmountContextMenu() {\n\t\t// This should be able to handle various menu's as the determine menu id function will identify the right menu (view, edit etc)\n\t\tContextMenuManager.unmountContextMenu( this.determineContextMenuMountAttributes().id );\n\t}\n\n\tbuildContextMenu( setFocus ) {\n\t\tif ( this.current_edit_record && this.edit_only_mode == true && LocalCacheData.current_open_edit_only_controller && LocalCacheData.current_open_edit_only_controller.viewId != LocalCacheData.current_open_edit_only_controller.viewId ) { // #2542 - prevent early menu setup for views that have not been loaded into memory yet.\n\t\t\treturn null;\n\t\t}\n\t\tvar $this = this;\n\t\tif ( !Global.isSet( setFocus ) ) {\n\t\t\tsetFocus = true;\n\t\t}\n\n\t\tif ( !this.sub_view_mode ) {\n\t\t\tLocalCacheData.current_open_sub_controller = null; //Clean sub controller if current view is a main view\n\t\t} else {\n\t\t\t//When on a sub view mode tab we want to disable certain context menu buttons of the parent view.\n\t\t\t//This is to help prevent users from using context menu buttons for the wrong view and deleting/copying records they did not intend to use.\n\t\t\tthis.onSubViewModeDisableParentContextMenuButtons();\n\t\t}\n\n\t\t// Vue Context Menu initialization - #2838\n\t\t// Checks for existing menu, because for an edit_view, we dont want to start a new menu, we want to re-use it.\n\t\t// Otherwise we end up treating edit menus like new views, which is more complex given the html templates (report edit views are unique, as we now have a common template).\n\t\tlet menu_attributes = this.determineContextMenuMountAttributes();\n\n\t\tif( ContextMenuManager.getMenu( menu_attributes.id ) === undefined ) {\n\t\t\t// #VueContextMenu#Dynamic-EditView\n\t\t\tContextMenuManager.createAndMountMenu( menu_attributes.id, menu_attributes.parent_mount_point, this );\n\n\t\t\tif( menu_attributes && menu_attributes.parent_mount_point ) {\n\t\t\t\t// #VueContextMenu#context-border creation to put a border around a context menu and the contents it relates to. This will help users understand which context menu belongs to what if there is more than one menu on the page.\n\t\t\t\tvar context_parent = menu_attributes.parent_mount_point; // $('.edit-view-tab-bar');\n\t\t\t\tvar context_label = this.context_menu_name;\n\n\t\t\t\tcontext_parent.prepend('<span class=\"context-border-label\">'+ context_label +'</span>');\n\t\t\t\tcontext_parent.wrapInner('<div class=\"context-border\"></div>');\n\t\t\t} else {\n\t\t\t\t// If mount point is null, then this is a bug. Check if buildContextMenu is not called before edit_view_tab populated (common in views overriding BaseView functions like openEditView.\n\t\t\t\tDebug.Error( 'Error creating context-border for '+this.viewId+' ('+ menu_attributes.id +'/'+ this.ui_id +')', 'BaseViewController.js', 'BaseViewController', 'buildContextMenu', 10 );\n\t\t\t}\n\n\t\t\t// if( ( this.is_add || this.is_edit || this.edit_only_mode ) && this.edit_view_tab || LocalCacheData.current_doing_context_action === 'view_detail' ) { // REMEMBER TO UPDATE determineContextMenuMountAttributes!!\n\t\t\t// \t// #VueContextMenu#Dynamic-EditView - Consolidate this, as View is now in 1 place, and EditView in 2 places. <-- #TODO: is this comment still valid? Search the tag.\n\t\t\t// \t// Pop-up edit views, which overlay across an unrelated view ( appear anywhere basically ).\n\t\t\t// \tthis.context_edit_only_menu_id = ContextMenuManager.createAndMountMenu( menu_attributes.id, this.edit_view_tab, this );\n\t\t\t// } else if( this.ui_id ) {\n\t\t\t// \t// Normal Views\n\t\t\t// \tthis.context_menu_id = ContextMenuManager.createAndMountMenu( menu_attributes.id, $( $this.el ), this );\n\t\t\t// }  else {\n\t\t\t// \t// If each view has a unique context menu, then this should never happen, as context menu should only be initiated once.\n\t\t\t// \t// However, there are many cases where tabs repeatedly call this.buildContextMenu, whilst keeping the same view controller, so this is now a warning rather than an error.\n\t\t\t// \tDebug.Error( 'Error during context menu mount. View state for ( '+ this.viewId +' ) does not match options.', 'BaseViewController.js', 'BaseViewController', 'buildContextMenu', 1 );\n\t\t\t// }\n\t\t} else {\n\t\t\t// This might be normal for situations like closing Edit Views, where the menu will already exist in the main view.\n\t\t\tDebug.Warn( 'Context Menu Manager ('+ menu_attributes.id +') already exists for: '+ this.viewId +' ('+ this.ui_id +')', 'BaseViewController.js', 'BaseViewController', 'buildContextMenu', 10 );\n\t\t}\n\n\t\tthis.buildContextMenuModels();\n\t\tLocalCacheData.currentShownContextMenuName = this.context_menu_name ? this.context_menu_name : menu_attributes.parent_id;\n\n\t}\n\n\tgetContextMenuGroupByName( menu, name, name_prefix ) {\n\t\tvar group;\n\t\tif ( name_prefix == undefined ) {\n\t\t\tname_prefix = this.viewId;\n\t\t}\n\n\t\tfor ( var i = 0; i < menu.attributes.sub_menu_groups.length; i++ ) {\n\t\t\tif ( menu.attributes.sub_menu_groups[i].id == name_prefix + name ) {\n\t\t\t\tgroup = menu.attributes.sub_menu_groups[i];\n\t\t\t}\n\t\t}\n\n\t\treturn group;\n\t}\n\n\tonReportMenuClick( id ) {\n\t}\n\n\t//Overridden in ReportBaseViewController.\n\tonContextMenuClick( context_btn, menu_name ) {\n\t\t// Vue notes: Luckily when Vue calls this menu, it does not need context_btn, as most places that use this function have the Global.isSet( menu_name ) check to just use menu_name as the id. However, MessageControlVC does use it.\n\t\tvar id;\n\t\tif ( Global.isSet( menu_name ) ) {\n\t\t\tid = menu_name;\n\t\t} else {\n\n\t\t\tif ( context_btn.disabled ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tProgressBar.showOverlay();\n\t\t//This flag is turned off in ProgressBarManager::closeOverlay, or 2 seconds whichever happens first. Use 2 seconds as overseas users could see intermittant 2 second latencies and double click Save icons.\n\t\tif ( window.clickProcessing == true ) {\n\t\t\treturn;\n\t\t} else {\n\t\t\twindow.clickProcessing = true;\n\t\t\twindow.clickProcessingHandle = window.setTimeout( function() {\n\t\t\t\t//FIXME: Check to see if the progress bar is visible because a API call is taking a long time, and if so keep the overlay up longer.\n\t\t\t\tif ( window.clickProcessing == true ) {\n\t\t\t\t\twindow.clickProcessing = false;\n\t\t\t\t\tProgressBar.closeOverlay();\n\t\t\t\t\tTTPromise.wait();\n\t\t\t\t}\n\t\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork( 2000 ) );\n\t\t}\n\n\t\t//Debug.Text( 'Context Menu Click: '+ id, 'BaseViewController.js', 'BaseViewController', 'onContextMenuClick', 10 );\n\n\t\t/**\n\t\t *  Here where you see ProgressBar.showOverlay() it is how we prevent doubleclick from firing two single clicks\n\t\t */\n\n\t\tswitch ( id ) {\n\t\t\tcase 'add':\n\t\t\t\tthis.onAddClick();\n\t\t\t\tbreak;\n\t\t\tcase 'view':\n\t\t\t\tthis.onViewClick();\n\t\t\t\tbreak;\n\t\t\tcase 'save':\n\t\t\t\tthis.onSaveClick();\n\t\t\t\tbreak;\n\t\t\tcase 'save_and_next':\n\t\t\t\tthis.onSaveAndNextClick();\n\t\t\t\tbreak;\n\t\t\tcase 'save_and_continue':\n\t\t\t\tthis.onSaveAndContinue();\n\t\t\t\tbreak;\n\t\t\tcase 'save_and_new':\n\t\t\t\tthis.onSaveAndNewClick();\n\t\t\t\tbreak;\n\t\t\tcase 'save_and_copy':\n\t\t\t\tthis.onSaveAndCopy();\n\t\t\t\tbreak;\n\t\t\tcase 'edit':\n\t\t\t\tthis.onEditClick();\n\t\t\t\tbreak;\n\t\t\tcase 'mass_edit':\n\t\t\t\tthis.onMassEditClick();\n\t\t\t\tbreak;\n\t\t\tcase 'delete_icon':\n\t\t\t\tthis.onDeleteClick();\n\t\t\t\tbreak;\n\t\t\tcase 'delete_and_next':\n\t\t\t\tthis.onDeleteAndNextClick();\n\t\t\t\tbreak;\n\t\t\tcase 'copy':\n\t\t\t\tthis.onCopyClick();\n\t\t\t\tbreak;\n\t\t\tcase 'copy_as_new':\n\t\t\t\tthis.onCopyAsNewClick();\n\t\t\t\tbreak;\n\t\t\tcase 'cancel':\n\t\t\t\tthis.onCancelClick();\n\t\t\t\tProgressBar.closeOverlay();\n\t\t\t\tbreak;\n\t\t\tcase 'export_excel':\n\t\t\t\tthis.onExportClick( 'export' + this.api.key_name );\n\t\t\t\tProgressBar.closeOverlay();\n\t\t\t\tbreak;\n\t\t\tcase 'map':\n\t\t\t\tthis.onMapClick();\n\t\t\t\tProgressBar.closeOverlay();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis.onCustomContextClick( id, context_btn );\n\t\t\t\tProgressBar.closeOverlay(); //FIXME: This may be closing the overlay too soon, allowing double-clicks to get through. For example when in Request Authorizations and hammer clicking \"Authorize\".\n\t\t\t\t//Debug.Text( 'Context Menu Click: '+ id +' Overlay closing...', 'BaseViewController.js', 'BaseViewController', 'onContextMenuClick', 10 );\n\t\t\t\tbreak;\n\t\t}\n\n\t\tGlobal.triggerAnalyticsContextMenuClick( context_btn, menu_name );\n\t}\n\n\tonCustomContextClick( id ) {\n\t\treturn false; //FALSE tells onContextMenuClick() to keep processing.\n\t}\n\n\tonNavigationClick( id ) {\n\t\tthis.onContextMenuClick( id );\n\t}\n\n\tgetCurrentAPI() {\n\t\treturn this.api;\n\t}\n\n\tsetCurrentEditViewState( state ) {\n\t\tthis.is_viewing = false;\n\t\tthis.is_viewing_detail = false; //Clicked \"View Detail\" on audit log. Separate logic from regular view.\n\t\tthis.is_edit = false;\n\t\tthis.is_add = false;\n\t\tthis.is_mass_editing = false;\n\t\tthis.is_mass_adding = false;\n\t\tswitch ( state ) {\n\t\t\tcase 'view':\n\t\t\t\tthis.is_viewing = true;\n\t\t\t\tbreak;\n\t\t\tcase 'view_detail':\n\t\t\t\tthis.is_viewing_detail = true;\n\t\t\t\tbreak;\n\t\t\tcase 'new':\n\t\t\t\tthis.is_add = true;\n\t\t\t\tbreak;\n\t\t\tcase 'edit':\n\t\t\t\tthis.is_edit = true;\n\t\t\t\tbreak;\n\t\t\tcase 'mass_edit':\n\t\t\t\tthis.is_mass_editing = true;\n\t\t\t\tbreak;\n\t\t\t// case 'mass_add':\n\t\t\t// \t//this.is_add = true;\n\t\t\t// \tthis.is_mass_adding = true;\n\t\t\t// \tbreak;\n\n\t\t}\n\n\t\tLocalCacheData.previous_doing_context_action = LocalCacheData.current_doing_context_action;\n\t\tLocalCacheData.current_doing_context_action = state;\n\t}\n\n\trevertEditViewState() {\n\t\tthis.setCurrentEditViewState( LocalCacheData.previous_doing_context_action ? LocalCacheData.previous_doing_context_action : '' );\n\t}\n\n\tonAddClick( show_save_and_continue, get_default_api_args = null ) {\n\t\tvar $this = this;\n\t\tthis.setCurrentEditViewState( 'new' );\n\t\t$this.openEditView();\n\t\t$this.doGetDefaultDataAPICall( get_default_api_args, show_save_and_continue );\n\t}\n\n\tdoGetDefaultDataAPICall( api_args, show_save_and_continue ) {\n\t\tvar $this = this;\n\n\t\tvar current_api = this.getCurrentAPI();\n\t\tcurrent_api['get' + $this.api.key_name + 'DefaultData']( api_args, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t$this.onAddResult( result );\n\t\t\t\t\tif ( show_save_and_continue ) {\n\t\t\t\t\t\t//Issue #3111 - If user is on a subview the tab will appear blank and the Save and Continue button will not show unless user switches to another tab.\n\t\t\t\t\t\t//Because of that when coming from a \"Save & New\" action, we need to make sure to show the Save and Continue button.\n\t\t\t\t\t\t$this.showSaveAndContinueButton();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t}\n\n\tonAddResult( result ) {\n\t\tvar $this = this;\n\t\tvar result_data = {};\n\n\t\tif ( result && result.getResult ) {\n\t\t\tresult_data = result.getResult();\n\t\t} else {\n\t\t\t//if not an api result, assume object is already the result of a call to getResult() and we will use it verbatim.\n\t\t\t//useful for passing in default values when adding new records before this function is called.\n\t\t\tresult_data = result;\n\t\t}\n\n\t\tif ( !result_data || result_data === true ) {\n\t\t\tresult_data = [];\n\t\t}\n\n\t\tresult_data.company = LocalCacheData.current_company.name;\n\n\t\tif ( $this.sub_view_mode && $this.parent_key ) {\n\t\t\tresult_data[$this.parent_key] = $this.parent_value;\n\t\t}\n\n\t\t$this.current_edit_record = result_data;\n\t\t$this.initEditView();\n\t}\n\n\tonDeleteAndNextClick() {\n\t\tTAlertManager.showConfirmAlert( Global.delete_confirm_message, null, function( result ) {\n\t\t\t// Using an anonymous function instead of reference, to ensure during debugging it is clear this function is called from DeleteAndNext, and not just Delete.\n\t\t\tthis.doDeleteClick( result, 'delete_and_next' );\n\t\t}.bind( this ) );\n\t}\n\n\tresetNavigationSourceData() {\n\t}\n\n\tgetDeleteSelectedRecordId() {\n\t\tvar retval = [];\n\t\tif ( this.edit_view && this.current_edit_record ) {\n\t\t\tretval.push( this.current_edit_record.id );\n\t\t} else {\n\t\t\tvar grid_selected_id_array = this.getGridSelectIdArray().slice(); //Use .slice() to make a copy of the IDs.\n\t\t\tif ( grid_selected_id_array.length ) {\n\t\t\t\tretval = grid_selected_id_array;\n\t\t\t} else {\n\t\t\t\tretval = null;\n\t\t\t}\n\n\t\t}\n\t\treturn retval;\n\t}\n\n\tdoDeleteClick( result, delete_type ) {\n\t\tif ( result ) {\n\t\t\tProgressBar.showOverlay();\n\t\t\tvar remove_ids = this.getDeleteSelectedRecordId();\n\t\t\tif ( remove_ids === [] ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.setCurrentEditViewState( delete_type ? delete_type : 'delete' );\n\t\t\treturn this.doDeleteAPICall( remove_ids );\n\n\t\t} else {\n\t\t\tProgressBar.closeOverlay();\n\t\t}\n\t}\n\n\tdoDeleteAPICall( remove_ids, callback ) {\n\t\tvar current_api = this.getCurrentAPI();\n\n\t\tif ( !callback ) {\n\t\t\tcallback = {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\tthis.onDeleteResult( result, remove_ids );\n\t\t\t\t}.bind( this )\n\t\t\t};\n\t\t}\n\t\treturn current_api['delete' + current_api.key_name]( remove_ids, callback );\n\t}\n\n\tonDeleteClick() {\n\t\tTAlertManager.showConfirmAlert( Global.delete_confirm_message, null, this.doDeleteClick.bind( this ) );\n\t}\n\n\tonDeleteResult( result, remove_ids ) {\n\t\tvar $this = this;\n\t\tProgressBar.closeOverlay();\n\t\tif ( result && result.isValid() ) {\n\n\t\t\tif ( LocalCacheData.current_doing_context_action === 'delete_and_next' ) {\n\t\t\t\t// store the index of the current item, before refreshing the search and losing the current context due to the deleted records\n\t\t\t\t$this.refresh_id = this.navigation.getNextSelectItemId();\n\n\t\t\t\t// refresh the grid to get the current dataset now that records have been deleted\n\t\t\t\t$this.search( false, null, null, function( result ) {\n\t\t\t\t\tvar current_grid_source = result.getResult();\n\n\t\t\t\t\tif ( $.type( current_grid_source ) !== 'array' || current_grid_source.length < 1 ) {\n\t\t\t\t\t\t// if after delete, there are no more records in the search, close edit view\n\t\t\t\t\t\t$this.removeEditView();\n\t\t\t\t\t\t$this.setDefaultMenu();\n\t\t\t\t\t\t// TODO: Should the above not simulate a cancel click? Could be an area for further refactor.\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// there are still records, load the new data\n\t\t\t\t\t\t$this.navigation.setSourceData( current_grid_source );\n\t\t\t\t\t\t$this.navigation.setPagerData( $this.pager_data );\n\n\t\t\t\t\t\t// if there is a valid id on the next record to load, do it\n\t\t\t\t\t\tif ( $this.refresh_id ) {\n\t\t\t\t\t\t\t$this.onRightOrLeftArrowClickCallBack( $this.refresh_id );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// no valid next record, simulate a cancel click.\n\t\t\t\t\t\t\t$this.onCancelClick();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$this.onDeleteAndNextDone( result );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\t$this.search();\n\t\t\t\t$this.onDeleteDone( result );\n\t\t\t\tif ( $this.edit_view && LocalCacheData.current_doing_context_action === 'delete' ) {\n\t\t\t\t\t$this.removeEditView();\n\t\t\t\t\t$this.setDefaultMenu();\n\t\t\t\t} else if ( !$this.edit_view ) {\n\t\t\t\t\t$this.setCurrentEditViewState( '' );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// If some valid records were deleted, we need to refresh the search grid.\n\t\t\tif ( result.getRecordDetails().valid && result.getRecordDetails().valid > 0 ) {\n\t\t\t\t$this.search();\n\t\t\t}\n\t\t\t$this.revertEditViewState();\n\t\t\tTAlertManager.showErrorAlert( result );\n\t\t}\n\t}\n\n\tremoveDeletedRows( remove_ids ) {\n\t\tvar $this = this;\n\t\t$.each( remove_ids, function( index, value ) {\n\t\t\t$this.grid.grid.deleteRow( value );\n\t\t\t$this.paging_widget.minus();\n\n\t\t} );\n//\n//\t\tif ( this.grid.getGridParam( 'data' ).length === 0 ) {\n//\t\t\tthis.search();\n//\t\t}\n\n//\t\tthis.search();\n\n//\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n//\t\tvar grid_selected_length = grid_selected_id_array.length;\n//\n//\t\tif ( grid_selected_length === 0 ) {\n//\t\t\tthis.search();\n//\t\t}\n\t}\n\n\tclearNavigationData() {\n\t\tif ( this.navigation && this.navigation.setSourceData ) {\n\t\t\tthis.navigation.setSourceData( null );\n\t\t}\n\t}\n\n\tonSaveAndCopy( ignoreWarning ) {\n\t\tvar $this = this;\n\t\tif ( !Global.isSet( ignoreWarning ) ) {\n\t\t\tignoreWarning = false;\n\t\t}\n\t\tthis.is_add = true;\n\t\tthis.is_changed = false;\n\t\tLocalCacheData.current_doing_context_action = 'save_and_copy';\n\t\tvar record = this.current_edit_record;\n\t\trecord = this.uniformVariable( record );\n\n\t\tthis.clearNavigationData();\n\t\tthis.api['set' + this.api.key_name]( record, false, ignoreWarning, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.onSaveAndCopyResult( result );\n\t\t\t\t$this.clearSubViewControllers();\n\t\t\t}\n\t\t} );\n\t}\n\n\tonSaveAndCopyResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result && result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true && $this.current_edit_record && $this.current_edit_record.id ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\t\t\t$this.search( false );\n\t\t\t$this.onCopyAsNewClick();\n\t\t} else {\n\t\t\t$this.setErrorMenu();\n\t\t\t$this.setErrorTips( result );\n\n\t\t}\n\t}\n\n\tonSaveAndNewClick( ignoreWarning ) {\n\t\tvar $this = this;\n\t\tif ( !Global.isSet( ignoreWarning ) ) {\n\t\t\tignoreWarning = false;\n\t\t}\n\t\tthis.setCurrentEditViewState( 'new' );\n\t\tvar record = this.current_edit_record;\n\t\trecord = this.uniformVariable( record );\n\t\tthis.api['set' + this.api.key_name]( record, false, ignoreWarning, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.onSaveAndNewResult( result );\n\t\t\t\tif ( $this.sub_view_mode ) {\n\t\t\t\t\t$this.clearSubViewControllers( false );\n\t\t\t\t} else {\n\t\t\t\t\t$this.clearSubViewControllers( true );\n\t\t\t\t\t$this.showSaveAndContinueButton();\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tonSaveAndNewResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result && result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true && $this.current_edit_record && $this.current_edit_record.id ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) { // as new\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.search( false );\n\t\t\t\t$this.onAddClick( true );\n\t\t\t} );\n\t\t} else {\n\t\t\t$this.setErrorMenu();\n\t\t\t$this.setErrorTips( result );\n\n\t\t}\n\t}\n\n\tonSaveAndContinue( ignoreWarning ) {\n\t\tvar $this = this;\n\t\tif ( !Global.isSet( ignoreWarning ) ) {\n\t\t\tignoreWarning = false;\n\t\t}\n\t\t//Setting is_add false too early can cause determineContextMenuMountAttributes() to have unexpected side effects. However not setting it here might have other side effects.\n\t\t//$this.is_add = false;\n\t\tLocalCacheData.current_doing_context_action = 'save_and_continue';\n\t\tvar record = this.current_edit_record;\n\t\trecord = this.uniformVariable( record );\n\n\t\tthis.doSaveAPICall( record, ignoreWarning, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.onSaveAndContinueResult( result );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tonSaveAndContinueResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result && result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true && $this.current_edit_record && $this.current_edit_record.id ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\n\t\t\t} else if ( result_data && TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\n\t\t\t}\n\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.search( false );\n\t\t\t\t$this.onEditClick( $this.refresh_id, true );\n\t\t\t\t$this.onSaveAndContinueDone( result );\n\t\t\t} );\n\n\t\t} else {\n\t\t\t$this.setErrorTips( result );\n\t\t\t$this.setErrorMenu();\n\t\t}\n\t}\n\n\tonSaveAndNextClick( ignoreWarning ) {\n\t\tvar $this = this;\n\t\tif ( !Global.isSet( ignoreWarning ) ) {\n\t\t\tignoreWarning = false;\n\t\t}\n\t\tthis.is_add = false;\n\t\tthis.is_changed = false;\n\n\t\tvar current_api = this.getCurrentAPI();\n\t\tvar record = this.current_edit_record;\n\t\tLocalCacheData.current_doing_context_action = 'save_and_next';\n\t\trecord = this.uniformVariable( record );\n\t\tcurrent_api['set' + current_api.key_name]( record, false, ignoreWarning, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.onSaveAndNextResult( result );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tonSaveAndNextResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result && result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true && $this.current_edit_record && $this.current_edit_record.id ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t\t\t} else if ( result_data && TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.onRightArrowClick();\n\t\t\t\t$this.search( false );\n\t\t\t\t$this.onSaveAndNextDone( result );\n\t\t\t} );\n\n\t\t} else {\n\t\t\t$this.setErrorMenu();\n\t\t\t$this.setErrorTips( result );\n\n\t\t}\n\t}\n\n\tuniformVariable( records ) {\n\t\treturn records;\n\t}\n\n\tsaveInsideEditorData( callback ) {\n\t\t//override this stub function where neeed. Brought in to consolidate those view controllers that used this.\n\t\t/* Dev Note: #2644 If issues happen, read this:\n\t\t* Functions such as onSaveAndNextResult() had a saveInsideEditorData call, but the base view did not, but the rest of the function was the same.\n\t\t * During refactor of these functions like save and next result into the base view, a stub of saveInsideEditor had to be created as it was not there previously.\n\t\t */\n\n\t\tif ( callback ) {\n\t\t\tcallback();\n\t\t}\n\t}\n\n\tgetChangedFields() {\n\t\tvar retval = {};\n\t\tfor ( var key in this.edit_view_ui_dic ) {\n\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\n\t\t\tif ( Global.isSet( widget.isChecked ) ) {\n\t\t\t\tif ( widget.isChecked() && widget.getEnabled() ) {\n\t\t\t\t\tretval[key] = this.current_edit_record[key]; // Note: Some view controllers use widget.getValue() instead of current_edit_record[key]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn retval;\n\t}\n\n\t// overridden in view controllers where needed\n\t// this base version will simply extract and duplicate current edit record if an array of user_id's exist\n\t// parent function should check to confirm this.is_mass_adding is true\n\tbuildMassAddRecord( record ) {\n\t\tvar retval;\n\t\tif ( Global.isArray( record.user_id ) && record.user_id.length > 0 ) {\n\t\t\tretval = [];\n\t\t\t$.each( this.current_edit_record.user_id, function( index, value ) {\n\n\t\t\t\tvar commonRecord = Global.clone( record );\n\t\t\t\tcommonRecord.user_id = value;\n\t\t\t\tretval.push( commonRecord );\n\n\t\t\t} );\n\t\t} else {\n\t\t\tretval = record;\n\t\t}\n\n\t\treturn retval;\n\t}\n\n\tbuildMassEditSaveRecord( mass_edit_record_ids, changed_fields ) {\n\t\tvar $this = this;\n\t\tvar mass_records = [];\n\n\t\t$.each( mass_edit_record_ids, function( index, value ) {\n\t\t\tvar common_record = Global.clone( changed_fields );\n\t\t\tcommon_record.id = value;\n\t\t\tcommon_record = $this.uniformVariable( common_record );\n\t\t\tmass_records.push( common_record );\n\t\t} );\n\n\t\treturn mass_records;\n\t}\n\n\tonSaveClick( ignoreWarning, force_no_confirm = false ) {\n\t\tvar $this = this;\n\n\t\tif ( !Global.isSet( ignoreWarning ) ) {\n\t\t\tignoreWarning = false;\n\t\t}\n\n\t\tif ( !force_no_confirm && ( $this.is_changed == false ) ) {\n\t\t\tthis.confirm_on_exit = true;\n\t\t} else {\n\t\t\tthis.confirm_on_exit = false;\n\t\t}\n\n\n\t\tvar record;\n\t\t//Setting is_add false too early can cause determineContextMenuMountAttributes() to have unexpected side effects. However not setting it here might have other side effects.\n\t\t//this.is_add = false;\n\t\tLocalCacheData.current_doing_context_action = 'save';\n\n\t\tif ( this.confirm_on_exit == true ) {\n\t\t\tTAlertManager.showConfirmAlert( Global.not_modify_alert_message, null, function( clicked_yes ) {\n\t\t\t\tif ( clicked_yes === true ) {\n\t\t\t\t\tdoNext();\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\tdoNext();\n\t\t}\n\n\t\tfunction doNext() {\n\t\t\tif ( $this.is_mass_editing ) {\n\t\t\t\tvar changed_fields = $this.getChangedFields();\n\t\t\t\trecord = $this.buildMassEditSaveRecord( $this.mass_edit_record_ids, changed_fields );\n\n\t\t\t} else if ( $this.is_mass_adding ) {\n\t\t\t\trecord = $this.buildMassAddRecord( $this.current_edit_record );\n\n\t\t\t} else {\n\t\t\t\trecord = $this.current_edit_record;\n\t\t\t\trecord = $this.uniformVariable( record );\n\t\t\t}\n\n\t\t\t$this.doSaveAPICall( record, ignoreWarning );\n\t\t}\n\n\t\tthis.confirm_on_exit = !this.confirm_on_exit; //If we don't do this, then if the user clicks \"No\", then \"Cancel\", it will think they made changes, so they will get another confirmation box when the click Cancel.\n\t}\n\n\tdoSaveAPICall( record, ignoreWarning, callback ) {\n\t\tvar current_api = this.getCurrentAPI();\n\n\t\tif ( !callback ) {\n\t\t\tcallback = {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\tthis.onSaveResult( result );\n\t\t\t\t}.bind( this )\n\t\t\t};\n\t\t}\n\n\t\t//current_api.setIsIdempotent( true ); //Force to idempotent API call to avoid duplicate network requests from causing errors displayed to the user.\n\t\treturn current_api['set' + current_api.key_name]( record, false, ignoreWarning, callback );\n\t}\n\n\tonSaveResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result && result.isValid() ) {\n\t\t\t//Setting is_add false too early can cause determineContextMenuMountAttributes() to have unexpected side effects. However not setting it here might have other side effects.\n\t\t\t//$this.is_add = false;\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( !this.edit_only_mode ) {\n\t\t\t\tif ( result_data === true && $this.current_edit_record && $this.current_edit_record.id ) {\n\t\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t\t$this.refresh_id = result_data;\n\t\t\t\t} else {\n\t\t\t\t\t$this.refresh_id = null;\n\t\t\t\t}\n\n\t\t\t\t$this.search();\n\t\t\t}\n\n\t\t\tvar on_save_done_result = $this.onSaveDone( result ); //post hook for onSaveResult\n\t\t\tif ( on_save_done_result == undefined || on_save_done_result == true ) {\n\t\t\t\t$this.removeEditView();\n\t\t\t}\n\t\t} else {\n\t\t\t$this.setErrorTips( result );\n\t\t\t$this.setErrorMenu();\n\t\t}\n\t}\n\n\t//post hook for onSaveResult\n\tonSaveDone( result ) {\n\t\treturn true;\n\t}\n\n\tonSaveAndContinueDone( result ) {\n\t}\n\n\tonSaveAndNextDone( result ) {\n\t}\n\n\tonDeleteDone( result ) {\n\t\tthis.removeDeletedRows();\n\t}\n\n\tonDeleteAndNextDone( result ) {\n\t}\n\n\tonMassEditClick() {\n\n\t\tvar $this = this;\n\t\tthis.setCurrentEditViewState( 'mass_edit' );\n\t\t$this.openEditView();\n\t\tvar filter = {};\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\t\tthis.mass_edit_record_ids = [];\n\n\t\t$.each( grid_selected_id_array, function( index, value ) {\n\t\t\t$this.mass_edit_record_ids.push( value );\n\t\t} );\n\n\t\tfilter.filter_data = {};\n\t\tfilter.filter_data.id = this.mass_edit_record_ids;\n\n\t\tthis.api['getCommon' + this.api.key_name + 'Data']( filter, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\tif ( !result_data ) {\n\t\t\t\t\tresult_data = [];\n\t\t\t\t}\n\n\t\t\t\t$this.api['getOptions']( 'unique_columns', {\n\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t$this.unique_columns = result.getResult();\n\t\t\t\t\t\t$this.api['getOptions']( 'linked_columns', {\n\t\t\t\t\t\t\tonResult: function( result1 ) {\n\t\t\t\t\t\t\t\t$this.linked_columns = result1.getResult();\n\t\t\t\t\t\t\t\tif ( $this.linked_columns === true ) {\n\t\t\t\t\t\t\t\t\t//there are no columns, you should be an empty array.\n\t\t\t\t\t\t\t\t\t$this.linked_columns = [];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ( $this.sub_view_mode && $this.parent_key ) {\n\t\t\t\t\t\t\t\t\tresult_data[$this.parent_key] = $this.parent_value;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t$this.current_edit_record = result_data;\n\t\t\t\t\t\t\t\t$this.initEditView();\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\t/*\n\t * View Click handlers - Start\n\t */\n\tgetViewSelectedRecordId( record ) {\n\t\tvar retval = false;\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\n\t\tif ( Global.isSet( record ) ) {\n\t\t\t//Handle cases where record object is passed in, so we can extract the string ID.\n\t\t\t//  As well where the string ID is passed in directly as a UUID and accept that too.\n\t\t\t//  This is required to handle MyAccount -> Request Authorization, view any record, then refresh the browser.\n\t\t\tif ( Global.isObject( record ) && record.id ) {\n\t\t\t\tretval = record.id;\n\t\t\t} else if ( Global.isString( record ) && TTUUID.isUUID( record ) ) {\n\t\t\t\tretval = record;\n\t\t\t}\n\t\t} else {\n\t\t\tif ( grid_selected_length > 0 ) {\n\t\t\t\tretval = grid_selected_id_array[0];\n\t\t\t} else {\n\t\t\t\tretval = null;\n\t\t\t}\n\t\t}\n\n\t\treturn retval;\n\t}\n\n\tdoViewAPICall( filter, api_args ) {\n\t\tvar callback = { onResult: this.handleViewAPICallbackResult.bind( this ) };\n\t\tif ( api_args ) {\n\t\t\t// If api_args specified, use api_args.filter, and ignore function filter parameter.\n\t\t\tapi_args.push( callback );\n\t\t\treturn this.api['get' + this.api.key_name].apply( this.api, api_args );\n\t\t} else {\n\t\t\treturn this.api['get' + this.api.key_name]( filter, callback );\n\t\t}\n\t}\n\n\thandleViewAPICallbackResult( result ) {\n\t\tvar result_data;\n\t\tif ( result && result.getResult ) {\n\t\t\tresult_data = result.getResult();\n\n\t\t\t//Do any result manipulation processes here, such as combining IDs together into a composite.\n\t\t\tresult_data = this.processAPICallbackResult( result_data );\n\n\t\t\tif ( !result_data ) {\n\t\t\t\tresult_data = [];\n\t\t\t}\n\n\t\t\tresult_data = result_data[0];\n\t\t} else {\n\t\t\t//Do not call processAPICallbackResult() here as we assume all processing has been completed earlier.\n\t\t\tresult_data = result;\n\t\t}\n\n\t\tif ( !result_data ) {\n\t\t\tTAlertManager.showAlert( $.i18n._( 'Record does not exist.' ) );\n\t\t\treturn this.onCancelClick();\n\t\t} else {\n\t\t\treturn this.doViewClickResult( result_data );\n\t\t}\n\t}\n\n\tdoViewClickResult( result_data ) {\n\t\tthis.current_edit_record = result_data;\n\t\tthis.initEditView();\n\t\treturn this.clearCurrentSelectedRecord();\n\t}\n\n\tonViewClick( record, noRefreshUI ) {\n\t\tthis.setCurrentEditViewState( 'view' );\n\t\tthis.openEditView();\n\n\t\tvar record_id = this.getViewSelectedRecordId( record );\n\t\tif ( Global.isFalseOrNull( record_id ) ) {\n\t\t\treturn;\n\t\t}\n\t\tthis.setCurrentSelectedRecord( record_id );\n\n\t\tvar filter = this.getAPIFilters();\n\n\t\treturn this.doViewAPICall( filter );\n\t}\n\n\tsetCurrentSelectedRecord( record ) {\n\t\tif ( record ) {\n\t\t\tthis.current_selected_record = record;\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetCurrentSelectedRecord() {\n\t\treturn this.current_selected_record;\n\t}\n\n\tclearCurrentSelectedRecord() {\n\t\tdelete this.current_selected_record;\n\t\treturn true;\n\t}\n\n\t// do we need this, Mike created it but check with him, as it may have just been a potential idea, not used.\n\tgetRecordIdFromRecord( object ) {\n\t\tif ( Global.isObject( object ) ) {\n\t\t\treturn object_id;\n\t\t} else if ( Global.isString( object ) ) {\n\t\t\treturn object;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/*\n\t * View Click handlers - End\n\t */\n\n\t/*\n\t * Common between View and Edit\n\t */\n\tprocessAPICallbackResult( result_data ) {\n\t\treturn result_data;\n\t}\n\n\tgetAPIFilters() {\n\t\t// override this function if view requires more filters\n\t\tvar record_id = this.getCurrentSelectedRecord();\n\t\tvar filter = {};\n\n\t\tfilter.filter_data = {};\n\t\tfilter.filter_data.id = [record_id];\n\n\t\treturn filter;\n\t}\n\n\t/*\n\t * Edit Click handlers - Start\n\t */\n\tgetEditSelectedRecordId( record ) {\n\t\tvar retval = false;\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\n\t\tif ( Global.isSet( record ) ) {\n\t\t\t//Handle cases where record object is passed in, so we can extract the string ID.\n\t\t\t//  As well where the string ID is passed in directly as a UUID and accept that too.\n\t\t\t//  This is required to handle editing any record, then refresh the browser.\n\t\t\tif ( Global.isObject( record ) && record.id ) {\n\t\t\t\tretval = record.id;\n\t\t\t} else if ( Global.isString( record ) && TTUUID.isUUID( record ) ) {\n\t\t\t\tretval = record;\n\t\t\t}\n\t\t} else {\n\t\t\t//Check for is_viewing and is_edit as the state may have changed from viewing to editing immediately before it got here.\n\t\t\t//  Test this with: Attendance -> TimeSheet, Edit Punch, click Station field to view the station, then click \"Edit\" icon.\n\t\t\tif ( ( this.is_viewing || this.is_edit ) && this.current_edit_record && this.current_edit_record.id ) {\n\t\t\t\tretval = this.current_edit_record.id;\n\t\t\t} else if ( grid_selected_length > 0 ) {\n\t\t\t\tretval = grid_selected_id_array[0];\n\t\t\t} else {\n\t\t\t\tretval = null;\n\t\t\t}\n\t\t}\n\t\treturn retval;\n\t}\n\n\tdoEditAPICall( filter, api_args, callback ) {\n\t\tif ( !callback ) {\n\t\t\tcallback = { onResult: this.handleEditAPICallbackResult.bind( this ) };\n\t\t}\n\t\tif ( api_args ) {\n\t\t\t// If api_args specified, use api_args.filter, and ignore function filter parameter.\n\t\t\tapi_args.push( callback );\n\t\t\treturn this.api['get' + this.api.key_name].apply( this.api, api_args );\n\t\t} else {\n\t\t\treturn this.api['get' + this.api.key_name]( filter, callback );\n\t\t}\n\t}\n\n\thandleEditAPICallbackResult( result ) {\n\t\tvar result_data;\n\t\tif ( result && result.getResult ) {\n\t\t\tresult_data = result.getResult();\n\n\t\t\t//Do any result manipulation processes here, such as combining IDs together into a composite.\n\t\t\tresult_data = this.processAPICallbackResult( result_data );\n\n\t\t\tif ( !result_data ) {\n\t\t\t\tresult_data = [];\n\t\t\t}\n\n\t\t\tresult_data = result_data[0];\n\t\t} else {\n\t\t\t//Do not call processAPICallbackResult() here as we assume all processing has been completed earlier.\n\t\t\tresult_data = result;\n\t\t}\n\n\t\tif ( !result_data ) {\n\t\t\tTAlertManager.showAlert( $.i18n._( 'Record does not exist.' ) );\n\t\t\treturn this.onCancelClick();\n\t\t}\n\n\t\tif ( this.sub_view_mode && this.parent_key ) {\n\t\t\tresult_data[this.parent_key] = this.parent_value;\n\t\t}\n\t\treturn this.doEditClickResult( result_data );\n\t}\n\n\tdoEditClickResult( result_data ) {\n\t\tthis.current_edit_record = result_data;\n\t\tthis.initEditView();\n\t}\n\n\tonEditClick( record_id, noRefreshUI ) {\n\t\tthis.setCurrentEditViewState( 'edit' );\n\t\tthis.openEditView();\n\n\t\trecord_id = this.getEditSelectedRecordId( record_id );\n\t\tif ( Global.isFalseOrNull( record_id ) ) {\n\t\t\treturn;\n\t\t}\n\t\tthis.setCurrentSelectedRecord( record_id );\n\n\t\tvar filter = this.getAPIFilters();\n\n\t\treturn this.doEditAPICall( filter );\n\t}\n\n\t/*\n\t * Edit Click handlers - End\n\t */\n\n\tonCopyClick() {\n\t\tif ( this.getGridSelectIdArray().length > 1 ) {\n\t\t\t//Warn user if they are trying to copy multiple records.\n\t\t\tTAlertManager.showConfirmAlert( Global.copy_multiple_confirm_message, null, ( answer ) => {\n\t\t\t\tif ( answer === true ) {\n\t\t\t\t\tthis.doCopyClick();\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\tthis.doCopyClick();\n\t\t}\n\t}\n\n\tdoCopyClick() {\n\t\tvar $this = this;\n\t\tvar copyIds = [];\n\t\t$this.is_add = false;\n\t\tif ( $this.edit_view ) {\n\t\t\tcopyIds.push( $this.current_edit_record.id );\n\t\t\tif ( this.is_changed ) {\n\t\t\t\tTAlertManager.showConfirmAlert( Global.modify_alert_message, null, function( flag ) {\n\t\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t\t$this.is_changed = false;\n\t\t\t\t\t\t$this._continueDoCopy( copyIds );\n\t\t\t\t\t}\n\t\t\t\t\tProgressBar.closeOverlay();\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\t$this._continueDoCopy( copyIds );\n\t\t\t}\n\t\t} else {\n\t\t\tcopyIds = $this.getGridSelectIdArray().slice();\n\t\t\t$this._continueDoCopy( copyIds );\n\t\t}\n\t}\n\n\t_continueDoCopy( copyIds ) {\n\t\tvar $this = this;\n\t\tProgressBar.showOverlay();\n\n\t\t//$this.api.setIsIdempotent( true ); //Force to idempotent API call to avoid duplicate network requests from causing errors displayed to the user.\n\t\t$this.api['copy' + $this.api.key_name]( copyIds, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.onCopyResult( result );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tonCopyResult( result ) {\n\t\tvar $this = this;\n\n\t\tif ( result && result.isValid() ) {\n\t\t\t$this.search();\n\t\t\tif ( $this.edit_view ) {\n\t\t\t\t$this.removeEditView();\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tTAlertManager.showErrorAlert( result );\n\n\t\t\tif ( result.getRecordDetails().total > 1 ) {\n\t\t\t\t$this.search();\n\t\t\t}\n\t\t}\n\t}\n\n\tonCopyAsNewClick() {\n\t\tvar $this = this;\n\t\tif ( this.is_changed ) {\n\t\t\tTAlertManager.showConfirmAlert( Global.modify_alert_message, null, function( flag ) {\n\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t$this._continueDoCopyAsNew();\n\t\t\t\t\tif ( $this.sub_view_mode ) {\n\t\t\t\t\t\t$this.clearSubViewControllers( false );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//Issue #3009 - Copy as new could cause blank tabs or old data to be shown instead of Save and Continue button.\n\t\t\t\t\t\t$this.clearSubViewControllers( true );\n\t\t\t\t\t\t$this.showSaveAndContinueButton();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tProgressBar.closeOverlay();\n\t\t\t} );\n\t\t} else {\n\t\t\tthis._continueDoCopyAsNew();\n\t\t\tif ( this.sub_view_mode ) {\n\t\t\t\tthis.clearSubViewControllers( false );\n\t\t\t} else {\n\t\t\t\t//Issue #3009 - Copy as new could cause blank tabs or old data to be shown instead of Save and Continue button.\n\t\t\t\tthis.clearSubViewControllers( true );\n\t\t\t\tthis.showSaveAndContinueButton();\n\t\t\t}\n\t\t}\n\t}\n\n\tcopyAsNewResetIds( data ) {\n\t\t//override where needed.\n\t\tdata.id = '';\n\t\treturn data;\n\t}\n\n\tshowSaveAndContinueButton() {\n\t\tif ( this.edit_view ) {\n\t\t\tlet save_and_continue_buttons = this.edit_view.find( '.save-and-continue-div' );\n\t\t\tif ( save_and_continue_buttons ) {\n\t\t\t\tsave_and_continue_buttons.css( 'display', 'block' );\n\t\t\t}\n\t\t}\n    }\n\n\tclearSubViewControllers( force ) {\n\t\t//Issue #2915 - Sub view controllers should not be cleared while the user is on a sub view. For example when the user\n\t\t//clicks \"Copy as New\" on a record in the sub view and finishes using that sub view they are returned to\n\t\t//the primary controller and if data is wiped in that scenario the tab would be blank.\n\t\tif ( LocalCacheData.current_open_sub_controller == null || force ) {\n\t\t\t//Issue #2913 - Sub view data would remain on a view if a user viewed a sub view tab before clicking \"Copy as New\", \"Save & New\" and similar saving actions.\n\t\t\t//Clearing out the sub view controllers aims to prevent any old data from remaining.\n\t\t\t//If this does not happen the sub view HTML would remain and overlap with the \"Save & Continue\" message and in general show no longer relevant data.\n\t\t\tfor ( var property in LocalCacheData.current_open_primary_controller ) {\n\t\t\t\tif ( property.match( 'sub_([a-z_]*)view_controller' ) && LocalCacheData.current_open_primary_controller[property] && LocalCacheData.current_open_primary_controller[property].$el ) {\n\t\t\t\t\tDebug.Text( property, 'BaseViewController.js', 'BaseViewController', 'onSaveAndNextClick', 9 );\n\t\t\t\t\tLocalCacheData.current_open_primary_controller[property].$el.remove();\n\t\t\t\t\tLocalCacheData.current_open_primary_controller[property] = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetCopyAsNewFilter( filter ) {\n\t\t// override where needed.\n\t\treturn filter;\n\t}\n\n\t_continueDoCopyAsNew() {\n\t\tvar $this = this;\n\t\tthis.setCurrentEditViewState( 'new' );\n\t\tLocalCacheData.current_doing_context_action = 'copy_as_new';\n\n\t\tif ( Global.isSet( this.edit_view ) ) {\n\t\t\tthis.current_edit_record = this.copyAsNewResetIds( this.current_edit_record );\n\t\t\tvar navigation_div = this.edit_view.find( '.navigation-div' );\n\t\t\tnavigation_div.css( 'display', 'none' );\n\t\t\tthis.setEditMenu();\n\t\t\tthis.setTabStatus(); // Show tabs based on permission. setCurrentEditRecordData has functions to set by record type. See #2687 - setTabStatus() must go before setCurrentEditRecordData(), otherwise Premium Policy Tabs incorrectly shown.\n\t\t\t//Issue #2913 - When using copy and save actions (\"Copy As New\", \"Save & Copy\", etc) on views with sub views such as \"Pay Periods\" on Pay Period Schedules\n\t\t\t//the sub view tab might appear blank. This is because these copy functions do not go through the same order of events as a regular add click.\n\t\t\t//Because of that we need to call onTabShow() to make sure the code that creates the \"Save and continue\" message and button triggers.\n\t\t\tthis.onTabShow();\n\t\t\tif ( !this.editor ) {\n\t\t\t\t// #2687 if an editor exists in the view/tabs, we do not want to call setCurrentEditRecordData() as it wipes out the editor data in one of its child functions initInsideEditorData().\n\t\t\t\tthis.setCurrentEditRecordData();\n\t\t\t}\n\t\t\tthis.is_changed = false;\n\t\t\tProgressBar.closeOverlay();\n\t\t} else {\n\t\t\tvar filter = {};\n\t\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\t\tvar grid_selected_length = grid_selected_id_array.length;\n\t\t\tif ( grid_selected_length > 0 ) {\n\t\t\t\tvar selectedId = grid_selected_id_array[0];\n\t\t\t} else {\n\t\t\t\tTAlertManager.showAlert( $.i18n._( 'No selected record' ) );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfilter.filter_data = {};\n\t\t\tfilter.filter_data.id = [selectedId];\n\n\t\t\tfilter = this.getCopyAsNewFilter( filter );\n\n\t\t\tthis.api['get' + this.api.key_name]( filter, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t$this.onCopyAsNewResult( result );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tonCopyAsNewResult( result ) {\n\t\tvar result_data = result.getResult();\n\n\t\tif ( typeof result_data != 'object' ) {\n\t\t\tthis.onAddClick();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.openEditView(); // Put it here is to avoid if the selected one is not existed in data or have deleted by other pragram. in this case, the edit view should not be opend.\n\n\t\tresult_data = result_data[0];\n\n\t\tresult_data = this.copyAsNewResetIds( result_data );\n\n\t\tif ( this.sub_view_mode && this.parent_key ) {\n\t\t\tresult_data[this.parent_key] = this.parent_value;\n\t\t}\n\n\t\tthis.current_edit_record = result_data;\n\t\tvar $this = this;\n\n\t\t$( '.PunchesEditView .edit-view-tab-bar' ).css( 'opacity', 1 );\n\t\t$( '.PunchesEditView .edit-view-tab' ).css( 'opacity', 1 );\n\t\t$this.initEditView();\n\t}\n\n\t/*\n\t 1. Job is switched.\n\t 2. If a Task is already selected (and its not Task=0), keep it selected *if its available* in the newly populated Task list.\n\t 3. If the task selected is *not* available in the Task list, or the selected Task=0, then check the default_item_id field from the Job and if its *not* 0 also, select that Task by default.\n\n\t 'job' argument must be an object, or false/null\n\t */\n\tsetJobItemValueWhenJobChanged( job, job_item_id_col_name, filter_data ) {\n\t\tvar $this = this;\n\n\t\t//Issue #3327 - When mass editing and checking/unchecking job the value can be null leading to an exception.\n\t\t//This for example could happen when selecting a branch and the current job is not available in the new branch and then unchecking the job.\n\t\tif ( job === null ) {\n\t\t\tjob = TTUUID.zero_id;\n\t\t}\n\n\t\tif ( job_item_id_col_name == undefined ) {\n\t\t\tjob_item_id_col_name = 'job_item_id';\n\t\t}\n\n\t\t//Error: Uncaught TypeError: Cannot set property 'job_item_id' of null in /interface/html5/#!m=TimeSheet&date=20150126&user_id=54286 line 6785\n\t\tif ( !$this.current_edit_record || !$this.edit_view_ui_dic[job_item_id_col_name] ) {\n\t\t\treturn;\n\t\t}\n\n\t\tTTPromise.add( 'BaseViewController', 'setJobItemValueWhenJobChanged' );\n\n\t\tif ( filter_data == undefined ) {\n\t\t\tfilter_data = { status_id: 10 };\n\t\t}\n\n\t\tif ( job != undefined && job != false ) {\n\t\t\tfilter_data['job_id'] = job.id; //Always filter by job\n\t\t}\n\n\t\tvar job_item_widget = $this.edit_view_ui_dic[job_item_id_col_name];\n\t\tvar current_job_item_id = job_item_widget.getValue();\n\t\tjob_item_widget.setSourceData( null );\n\t\tjob_item_widget.setCheckBox( true );\n\t\tthis.edit_view_ui_dic['job_item_quick_search'].setCheckBox( true );\n\n\t\tvar args = {};\n\t\targs.filter_data = filter_data;\n\t\t$this.edit_view_ui_dic[job_item_id_col_name].setDefaultArgs( args );\n\n\t\t//Make sure if current task is selected, that its still available on the new job.\n\t\tif ( current_job_item_id && current_job_item_id != TTUUID.zero_id ) {\n\t\t\tvar new_arg = Global.clone( args );\n\t\t\t//We are checking if the current selected record validates against the job costing criteria.\n\t\t\t//To avoid issues with pagination we are only checking against the current selected record.\n\t\t\tnew_arg.filter_data.id = current_job_item_id;\n\t\t\tnew_arg.filter_data.job_id = job.id;\n\t\t\tnew_arg.filter_columns = $this.edit_view_ui_dic[job_item_id_col_name].getColumnFilter();\n\t\t\t$this.job_item_api.getJobItem( new_arg, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t//Error: Uncaught TypeError: Cannot set property 'job_item_id' of null in /interface/html5/#!m=TimeSheet&date=20150126&user_id=54286 line 6785\n\t\t\t\t\tif ( !$this.current_edit_record ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar data = result.getResult();\n\n\t\t\t\t\t//Data must be an array of allowed id. If no results, data might be true or false from the API.\n\t\t\t\t\t//Convert this to an array so that data can contain TTUUID.not_exist_id.\n\t\t\t\t\t//This allows users to still select \"default\" or a different option that is not a normal record.\n\t\t\t\t\tif ( !Array.isArray( data ) ) {\n\t\t\t\t\t\tdata = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( current_job_item_id === TTUUID.not_exist_id ) {\n\t\t\t\t\t\tdata.push( { id: TTUUID.not_exist_id } );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( current_job_item_id === -2 ) {\n\t\t\t\t\t\tdata.push( { id: -2 } );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( data.length == 0 ) {\n\t\t\t\t\t\tsetDefaultData( job_item_id_col_name );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t} else {\n\t\t\tsetDefaultData( job_item_id_col_name );\n\t\t}\n\n\t\tfunction setDefaultData( job_item_id_col_name ) {\n\t\t\tif ( job_item_id_col_name == undefined ) {\n\t\t\t\tjob_item_id_col_name = 'job_item_id';\n\t\t\t}\n\t\t\tif ( $this.current_edit_record.hasOwnProperty( job_item_id_col_name ) ) {\n\t\t\t\tjob_item_widget.setValue( job.default_item_id );\n\t\t\t\t$this.current_edit_record[job_item_id_col_name] = job.default_item_id;\n\n\t\t\t\tif ( job.default_item_id === false || job.default_item_id === 0 || job.default_item_id === TTUUID.zero_id || job.default_item_id === TTUUID.not_exist_id ) {\n\t\t\t\t\t$this.edit_view_ui_dic.job_item_quick_search.setValue( '' );\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tjob_item_widget.setValue( '' );\n\t\t\t\t$this.current_edit_record[job_item_id_col_name] = false;\n\t\t\t\t$this.edit_view_ui_dic.job_item_quick_search.setValue( '' );\n\t\t\t}\n\n\t\t\tTTPromise.resolve( 'BaseViewController', 'setJobItemValueWhenJobChanged' );\n\t\t}\n\t}\n\n\tsetJobValueWhenCriteriaChanged( job_id_col_name, filter_data ) {\n\t\tvar $this = this;\n\n\t\t//Error: Uncaught TypeError: Cannot set property 'job_id' of null in /interface/html5/#!m=TimeSheet&date=20150126&user_id=54286 line 6785\n\t\tif ( !$this.current_edit_record || !$this.edit_view_ui_dic[job_id_col_name] ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar job_widget = $this.edit_view_ui_dic[job_id_col_name];\n\t\tvar current_job_id = job_widget.getValue();\n\t\tjob_widget.setSourceData( null );\n\t\tjob_widget.setCheckBox( true );\n\t\tthis.edit_view_ui_dic['job_item_quick_search'].setCheckBox( true );\n\n\t\tvar args = {};\n\t\targs.filter_data = filter_data;\n\t\t$this.edit_view_ui_dic[job_id_col_name].setDefaultArgs( args );\n\n\t\t//Make sure if current job is selected, and that its still available after new criteria.\n\t\tif ( current_job_id && current_job_id != TTUUID.zero_id ) {\n\t\t\tvar new_arg = Global.clone( args );\n\t\t\t//We are checking if the current selected record validates against the job costing criteria.\n\t\t\t//To avoid issues with pagination we are only checking against the current selected record.\n\t\t\tnew_arg.filter_data.id = current_job_id;\n\t\t\tnew_arg.filter_columns = $this.edit_view_ui_dic[job_id_col_name].getColumnFilter();\n\t\t\t$this.job_api.getJob( new_arg, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t//Error: Uncaught TypeError: Cannot set property 'job_id' of null in /interface/html5/#!m=TimeSheet&date=20150126&user_id=54286 line 6785\n\t\t\t\t\tif ( !$this.current_edit_record ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar data = result.getResult();\n\n\t\t\t\t\t//Data must be an array of allowed id. If no results, data might be true or false from the API.\n\t\t\t\t\t//Convert this to an array so that data can contain TTUUID.not_exist_id.\n\t\t\t\t\t//This allows users to still select \"default\" or a different option that is not a normal record.\n\t\t\t\t\tif ( !Array.isArray( data ) ) {\n\t\t\t\t\t\tdata = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( current_job_id === TTUUID.not_exist_id ) {\n\t\t\t\t\t\tdata.push( { id: TTUUID.not_exist_id } );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( current_job_id === -2 ) {\n\t\t\t\t\t\tdata.push( { id: -2 } );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( data.length == 0 ) {\n\t\t\t\t\t\tsetDefaultData( job_id_col_name );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t} else {\n\t\t\tsetDefaultData( job_id_col_name );\n\t\t}\n\n\t\tfunction setDefaultData( job_id_col_name ) {\n\t\t\tif ( job_id_col_name == undefined ) {\n\t\t\t\tjob_id_col_name = 'job_id';\n\t\t\t}\n\t\t\tjob_widget.setValue( '' );\n\t\t\t$this.current_edit_record[job_id_col_name] = false;\n\t\t\t$this.edit_view_ui_dic.job_quick_search.setValue( '' );\n\t\t}\n\t}\n\n\tonJobQuickSearch( key, value, job_id_field, job_item_id_field, filter_data ) {\n\t\tvar $this = this;\n\n\t\tvar args = {};\n\n\t\tTTPromise.add( 'BaseViewController', 'onJobQuickSearch' );\n\n\t\tif ( job_id_field == undefined ) {\n\t\t\tjob_id_field = 'job_id';\n\t\t}\n\t\tif ( job_item_id_field == undefined ) {\n\t\t\tjob_item_id_field = 'job_item_id';\n\t\t}\n\n\t\t//Error: Uncaught TypeErro: Cannot read property 'setValue' of undefined in /interface/html5/#!m=TimeSheet&date=20141222&user_id=13566 line 6686\n\t\tif ( !$this.edit_view_ui_dic || !$this.edit_view_ui_dic[job_id_field] ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( key === 'job_quick_search' ) {\n\t\t\targs.filter_data = { manual_id: value, user_id: this.current_edit_record.user_id, status_id: '10' };\n\n\t\t\tif ( this.current_edit_record.branch_id ) {\n\t\t\t\targs.filter_data.punch_branch_id = this.current_edit_record.branch_id;\n\t\t\t}\n\n\t\t\tif ( this.current_edit_record.department_id ) {\n\t\t\t\targs.filter_data.punch_department_id = this.current_edit_record.department_id;\n\t\t\t}\n\n\t\t\tthis.job_api.getJob( args, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t//Error: Uncaught TypeError: Cannot read property 'setValue' of undefined in /interface/html5/#!m=TimeSheet&date=20141222&user_id=13566 line 6686\n\t\t\t\t\tif ( !$this.edit_view_ui_dic || !$this.edit_view_ui_dic[job_id_field] ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\t\tif ( result_data.length > 0 ) {\n\t\t\t\t\t\t$this.edit_view_ui_dic[job_id_field].setValue( result_data[0].id );\n\t\t\t\t\t\t$this.current_edit_record[job_id_field] = result_data[0].id;\n\t\t\t\t\t\t$this.setJobItemValueWhenJobChanged( result_data[0], job_item_id_field, filter_data );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.edit_view_ui_dic[job_id_field].setValue( '' );\n\t\t\t\t\t\t$this.current_edit_record[job_id_field] = false;\n\t\t\t\t\t\t$this.setJobItemValueWhenJobChanged( false, job_item_id_field, filter_data );\n\t\t\t\t\t}\n\n\t\t\t\t\tTTPromise.resolve( 'BaseViewController', 'onJobQuickSearch' );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t$this.edit_view_ui_dic['job_quick_search'].setCheckBox( true );\n\t\t\t$this.edit_view_ui_dic[job_id_field].setCheckBox( true );\n\t\t} else if ( key === 'job_item_quick_search' ) {\n\t\t\targs.filter_data = { manual_id: value, job_id: this.current_edit_record[job_id_field], status_id: '10' };\n\n\t\t\tthis.job_item_api.getJobItem( args, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t//Error: Uncaught TypeError: Cannot read property 'setValue' of undefined in /interface/html5/#!m=TimeSheet&date=20141222&user_id=13566 line 6686\n\t\t\t\t\tif ( !$this.edit_view_ui_dic || !$this.edit_view_ui_dic[job_item_id_field] ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar result_data = result.getResult();\n\t\t\t\t\tif ( result_data.length > 0 ) {\n\t\t\t\t\t\t$this.edit_view_ui_dic[job_item_id_field].setValue( result_data[0].id );\n\t\t\t\t\t\t$this.current_edit_record[job_item_id_field] = result_data[0].id;\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.edit_view_ui_dic[job_item_id_field].setValue( '' );\n\t\t\t\t\t\t$this.current_edit_record[job_item_id_field] = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tTTPromise.resolve( 'BaseViewController', 'onJobQuickSearch' );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tthis.edit_view_ui_dic['job_item_quick_search'].setCheckBox( true );\n\t\t\tthis.edit_view_ui_dic[job_item_id_field].setCheckBox( true );\n\t\t}\n\t}\n\n\tsetDepartmentValueWhenBranchChanged( department, department_id_col_name, filter_data ) {\n\t\tvar $this = this;\n\n\t\tif ( department_id_col_name == undefined ) {\n\t\t\tdepartment_id_col_name = 'department_id';\n\t\t}\n\n\t\tif ( !$this.current_edit_record || !$this.edit_view_ui_dic[department_id_col_name] ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar department_widget = $this.edit_view_ui_dic[department_id_col_name];\n\t\tvar current_department_id = department_widget.getValue();\n\t\tdepartment_widget.setSourceData( null );\n\t\tdepartment_widget.setCheckBox( true );\n\n\t\tvar args = {};\n\t\targs.filter_data = filter_data;\n\t\t$this.edit_view_ui_dic[department_id_col_name].setDefaultArgs( args );\n\n\t\t//Make sure if current department is selected, that its still available on the new job.\n\t\tif ( current_department_id && current_department_id != TTUUID.zero_id ) {\n\t\t\tvar new_arg = Global.clone( args );\n\t\t\t//We are checking if the current selected record validates against the job costing criteria.\n\t\t\t//To avoid issues with pagination we are only checking against the current selected record.\n\t\t\tnew_arg.filter_data.id = current_department_id;\n\t\t\tnew_arg.filter_columns = $this.edit_view_ui_dic[department_id_col_name].getColumnFilter();\n\t\t\t$this.department_api.getDepartment( new_arg, {\n\t\t\t\tonResult: function( result ) {\n\n\t\t\t\t\tif ( !$this.current_edit_record ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar data = result.getResult();\n\n\t\t\t\t\t//Data must be an array of allowed id. If no results, data might be true or false from the API.\n\t\t\t\t\t//Convert this to an array so that data can contain TTUUID.not_exist_id.\n\t\t\t\t\t//This allows users to still select \"default\" or a different option that is not a normal record.\n\t\t\t\t\tif ( !Array.isArray( data ) ) {\n\t\t\t\t\t\tdata = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( current_department_id === TTUUID.not_exist_id ) {\n\t\t\t\t\t\tdata.push( { id: TTUUID.not_exist_id } );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( current_department_id === -2 ) {\n\t\t\t\t\t\tdata.push( { id: -2 } );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( data.length === 0 ) {\n\t\t\t\t\t\tsetDefaultData( department_id_col_name );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t} else {\n\t\t\tsetDefaultData( department_id_col_name );\n\t\t}\n\n\t\tfunction setDefaultData( department_id_col_name ) {\n\t\t\tif ( department_id_col_name == undefined ) {\n\t\t\t\tdepartment_id_col_name = 'department_id';\n\t\t\t}\n\t\t\tif ( $this.current_edit_record.hasOwnProperty( department_id_col_name ) ) {\n\t\t\t\tdepartment_widget.setValue( department.default_item_id );\n\t\t\t\t$this.current_edit_record[department_id_col_name] = department.default_item_id;\n\n\t\t\t\tif ( department.default_item_id === false || department.default_item_id === 0 || department.default_item_id === TTUUID.zero_id || department.default_item_id === TTUUID.not_exist_id ) {\n\t\t\t\t\t$this.edit_view_ui_dic.job_item_quick_search.setValue( '' );\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tdepartment_widget.setValue( '' );\n\t\t\t\t$this.current_edit_record[department_id_col_name] = false;\n\t\t\t\t$this.edit_view_ui_dic.job_item_quick_search.setValue( '' );\n\t\t\t}\n\t\t}\n\t}\n\n\tsetPunchTagValuesWhenCriteriaChanged( filter_data, punch_tag_id_col_name ) {\n\t\tvar $this = this;\n\n\t\tif ( !$this.current_edit_record || !$this.edit_view_ui_dic[punch_tag_id_col_name] ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar punch_tag_widget = $this.edit_view_ui_dic[punch_tag_id_col_name];\n\t\tvar current_punch_tag_ids = punch_tag_widget.getValue();\n\t\tpunch_tag_widget.setSourceData( null );\n\n\t\tvar args = {};\n\t\targs.filter_data = filter_data;\n\t\tpunch_tag_widget.setDefaultArgs( args );\n\n\t\t//Make sure if current punch tags are selected, that they are still available on the new punch tag list.\n\t\tif ( current_punch_tag_ids && current_punch_tag_ids.length > 0 ) {\n\t\t\tvar new_arg = Global.clone( args );\n\t\t\tnew_arg.filter_data.id = current_punch_tag_ids;\n\t\t\t//Disabling paging to the API ($disable_paging = true) so that the user can have more punch tags selected than their preference for items per page.\n\t\t\t//Otherwise if they have 7 punch tags selected and their preference is 5, the api would only return 5 and 2 would be lost and unselected.\n\t\t\t$this.punch_tag_api.getPunchTag( new_arg, true,{\n\t\t\t\tonResult: function( punch_tag_result ) {\n\t\t\t\t\tif ( !$this.current_edit_record ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar data = punch_tag_result.getResult();\n\n\t\t\t\t\t//Data must be an array of allowed punch tags. If no results, data might be true or false from the API.\n\t\t\t\t\t//Convert this to an array so that data can contain TTUUID.not_exist_id.\n\t\t\t\t\t//This allows users to still select \"default\" or a different option that is not a punch tag.\n\t\t\t\t\tif ( !Array.isArray( data ) ) {\n\t\t\t\t\t\tdata = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( Array.isArray( data ) && Array.isArray( current_punch_tag_ids ) && current_punch_tag_ids.includes( TTUUID.not_exist_id ) ) {\n\t\t\t\t\t\tdata.push( { id: TTUUID.not_exist_id } );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( Array.isArray( data ) && data.length > 0 ) {\n\t\t\t\t\t\tif ( current_punch_tag_ids !== TTUUID.zero_id && current_punch_tag_ids.length > 0 && $this.shouldUpdatePunchTags( current_punch_tag_ids, data ) ) {\n\t\t\t\t\t\t\t//Merge in users last selected punch tags in case they switched back to that selection.\n\t\t\t\t\t\t\t//Example: They have selected a New York branch punch tag but switch their selection to a different branch\n\t\t\t\t\t\t\t//and then back to New York. In that case we should reselect the New York punch tag.\n\t\t\t\t\t\t\tcurrent_punch_tag_ids = _.union( current_punch_tag_ids, $this.previous_punch_tag_selection );\n\t\t\t\t\t\t\t//Compare current selected punch tags and the list of punch tags from the API and remove invalid punch tags.\n\t\t\t\t\t\t\tvar intersected_values = current_punch_tag_ids.filter( punch_tag_id => data.some( punch_tag => punch_tag_id === punch_tag.id ) );\n\t\t\t\t\t\t\tpunch_tag_widget.setValue( intersected_values );\n\t\t\t\t\t\t\t$this.current_edit_record[punch_tag_id_col_name] = intersected_values;\n\t\t\t\t\t\t\t//Update manual IDs in punch_tag_quick_search.\n\t\t\t\t\t\t\tvar punch_tag_manual_ids = data.filter( punch_tag => intersected_values.includes( punch_tag.id ) ).map( ( { manual_id } ) => manual_id );\n\t\t\t\t\t\t\t$this.edit_view_ui_dic['punch_tag_quick_search'].setValue( punch_tag_manual_ids.join() );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetDefaultData( punch_tag_id_col_name );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t} else {\n\t\t\tsetDefaultData( punch_tag_id_col_name );\n\t\t}\n\n\t\tfunction setDefaultData( punch_tag_id_col_name ) {\n\t\t\tif ( $this.current_edit_record.hasOwnProperty( punch_tag_id_col_name ) ) {\n\t\t\t\tpunch_tag_widget.setValue( $this.default_punch_tag );\n\t\t\t\t$this.current_edit_record[punch_tag_id_col_name] = $this.default_punch_tag;\n\n\t\t\t\tif ( $this.default_punch_tag.length === 0 ) {\n\t\t\t\t\t$this.edit_view_ui_dic.punch_tag_quick_search.setValue( '' );\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tpunch_tag_widget.setValue( '' );\n\t\t\t\t$this.current_edit_record[punch_tag_id_col_name] = false;\n\t\t\t\t$this.edit_view_ui_dic.punch_tag_quick_search.setValue( '' );\n\t\t\t}\n\t\t}\n\t}\n\n\tshouldUpdatePunchTags( current_punch_tag_ids, data ) {\n\t\t//If the current selected punch tags and previously user selected punch tags do not match we should check and update.\n\t\tif ( Array.isArray( this.previous_punch_tag_selection ) && this.previous_punch_tag_selection.every( punch_tag => current_punch_tag_ids.includes( punch_tag ) ) === false ) {\n\t\t\treturn true;\n\t\t}\n\t\t//If the data returned from the API does not contain every currently selected punch tag then we need to remove invalid tags.\n\t\tif ( current_punch_tag_ids.every( punch_tag_id => data.some( punch_tag => punch_tag.id === punch_tag_id ) ) === false ) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tsetPunchTagQuickSearchManualIds( punch_tags, get_real_data ) {\n\t\tif ( punch_tags == false || !this.edit_view_ui_dic['punch_tag_quick_search'] || ( Array.isArray( punch_tags ) && punch_tags.length === 0 ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( punch_tags === TTUUID.not_exist_id || ( Array.isArray( punch_tags ) && punch_tags.includes( TTUUID.not_exist_id ) ) ) {\n\t\t\tthis.edit_view_ui_dic['punch_tag_quick_search'].setValue( '' );\n\t\t\treturn;\n\t\t}\n\n\t\tif ( get_real_data ) {\n\t\t\tvar $this = this;\n\t\t\tvar args = {};\n\t\t\targs.filter_data = { id: punch_tags };\n\t\t\tthis.punch_tag_api.getPunchTag( args, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\tvar data = result.getResult();\n\t\t\t\t\tvar manual_ids = [];\n\n\t\t\t\t\tfor ( var i = 0; i < data.length; i++ ) {\n\t\t\t\t\t\tmanual_ids.push( data[i].manual_id );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( $this.edit_view_ui_dic && $this.edit_view_ui_dic['punch_tag_quick_search'] ) {\n\t\t\t\t\t\t$this.edit_view_ui_dic['punch_tag_quick_search'].setValue( manual_ids.join() );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\tvar manual_ids = [];\n\t\t\tfor ( var i = 0; i < punch_tags.length; i++ ) {\n\t\t\t\tmanual_ids.push( punch_tags[i].manual_id );\n\t\t\t}\n\n\t\t\tif ( this.edit_view_ui_dic && this.edit_view_ui_dic['punch_tag_quick_search'] ) {\n\t\t\t\tthis.edit_view_ui_dic['punch_tag_quick_search'].setValue( manual_ids.join() );\n\t\t\t}\n\t\t}\n\t}\n\n\tonPunchTagQuickSearch( value, filter_data, punch_tag_id_col_name ) {\n\t\tvar $this = this;\n\n\t\tvar args = {};\n\n\t\tif ( !$this.edit_view_ui_dic || !$this.edit_view_ui_dic[punch_tag_id_col_name] ) {\n\t\t\treturn;\n\t\t}\n\n\t\targs.filter_data = filter_data;\n\t\targs.filter_data.manual_id = value.split( ',' );\n\n\t\tthis.punch_tag_api.GetPunchTag( args, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tif ( !$this.edit_view_ui_dic || !$this.edit_view_ui_dic[punch_tag_id_col_name] ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\t$this.edit_view_ui_dic[punch_tag_id_col_name].setSourceData( null );\n\n\t\t\t\tif ( result_data.length > 0 ) {\n\t\t\t\t\tvar punch_tags = result_data.map( punch_tag => punch_tag.id );\n\t\t\t\t\t$this.edit_view_ui_dic[punch_tag_id_col_name].setValue( punch_tags );\n\t\t\t\t\t$this.current_edit_record[punch_tag_id_col_name] = punch_tags;\n\t\t\t\t\t$this.previous_punch_tag_selection = punch_tags;\n\t\t\t\t} else {\n\t\t\t\t\t$this.edit_view_ui_dic[punch_tag_id_col_name].setValue( '' );\n\t\t\t\t\t$this.current_edit_record[punch_tag_id_col_name] = false;\n\t\t\t\t\t$this.previous_punch_tag_selection = [];\n\t\t\t\t}\n\n\t\t\t\tdelete args['manual_id'];\n\n\t\t\t}\n\t\t} );\n\n\t\tthis.edit_view_ui_dic['punch_tag_quick_search'].setCheckBox( true );\n\t\tthis.edit_view_ui_dic[punch_tag_id_col_name].setCheckBox( true );\n\t}\n\n\tgetPunchTagFilterData() {\n\t\tif ( !this.current_edit_record || !this.current_edit_record.user_id ) {\n\t\t\treturn {};\n\t\t}\n\n\t\tvar filter_data = {\n\t\t\tstatus_id: 10,\n\t\t\tuser_id: this.current_edit_record.user_id,\n\t\t\tbranch_id: this.current_edit_record.branch_id,\n\t\t\tdepartment_id: this.current_edit_record.department_id,\n\t\t\tjob_id: this.current_edit_record.job_id,\n\t\t\tjob_item_id: this.current_edit_record.job_item_id\n\t\t};\n\n\t\treturn filter_data;\n\t}\n\n\tonCancelClick( force_no_confirm, cancel_all, callback ) {\n\t\tTTPromise.add( 'base', 'onCancelClick' );\n\t\tvar $this = this;\n\t\t//#2342 This logic is also in onSubMenuClick click in RibbonViewController\n\t\tif ( !force_no_confirm\n\t\t\t&&\n\t\t\t(\n\t\t\t\t$this.is_changed == true\n\t\t\t\t|| ( LocalCacheData.current_open_primary_controller && LocalCacheData.current_open_primary_controller.edit_view && LocalCacheData.current_open_primary_controller.is_changed == true )\n\t\t\t\t|| ( LocalCacheData.current_open_report_controller && LocalCacheData.current_open_report_controller.is_changed == true )\n\t\t\t\t|| ( LocalCacheData.current_open_edit_only_controller && LocalCacheData.current_open_edit_only_controller.is_changed == true )\n\t\t\t\t|| ( LocalCacheData.current_open_sub_controller && LocalCacheData.current_open_sub_controller.edit_view && LocalCacheData.current_open_sub_controller.is_changed == true )\n\n\t\t\t) ) {\n\t\t\tthis.confirm_on_exit = true;\n\t\t}\n\n\t\tLocalCacheData.current_doing_context_action = 'cancel';\n\t\tif ( this.confirm_on_exit == true ) {\n\t\t\tTAlertManager.showConfirmAlert( Global.modify_alert_message, null, function( clicked_yes ) {\n\t\t\t\tif ( clicked_yes === true ) {\n\t\t\t\t\tdoNext( force_no_confirm, cancel_all, callback );\n\t\t\t\t} else {\n\t\t\t\t\tTTPromise.reject( 'base', 'onCancelClick' );\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\tdoNext( force_no_confirm, cancel_all, callback );\n\t\t}\n\n\t\tfunction doNext( force_no_confirm, cancel_all, callback ) {\n\t\t\tif ( !$this.edit_view && $this.parent_view_controller && $this.sub_view_mode ) {\n\t\t\t\t$this.parent_view_controller.is_changed = false;\n\t\t\t\t$this.parent_view_controller.confirm_on_exit = false;\n\t\t\t\t$this.parent_view_controller.buildContextMenu( true );\n\t\t\t\t$this.parent_view_controller.onCancelClick( true ); //Force no confirm so we don't get two messages when cancelling from Edit Employee -> Wage (tab) -> Edit Wage.\n\t\t\t} else {\n\t\t\t\t$this.removeEditView( true );\n\t\t\t}\n\n\t\t\tif ( cancel_all ) {\n\t\t\t\tif ( LocalCacheData.current_open_edit_only_controller ) {\n\t\t\t\t\tLocalCacheData.current_open_edit_only_controller.onCancelClick( force_no_confirm, cancel_all );\n\t\t\t\t} else if ( LocalCacheData.current_open_sub_controller && LocalCacheData.current_open_sub_controller.edit_view ) {\n\t\t\t\t\tLocalCacheData.current_open_sub_controller.onCancelClick( force_no_confirm, cancel_all );\n\t\t\t\t} else if ( LocalCacheData.current_open_primary_controller && LocalCacheData.current_open_primary_controller.edit_view ) {\n\t\t\t\t\tLocalCacheData.current_open_primary_controller.onCancelClick( force_no_confirm, cancel_all );\n\t\t\t\t} else if ( LocalCacheData.current_open_report_controller ) {\n\t\t\t\t\tLocalCacheData.current_open_report_controller.onCancelClick( force_no_confirm, cancel_all );\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( callback ) {\n\t\t\t\tcallback();\n\t\t\t}\n\n\t\t\tGlobal.setUIInitComplete();\n\t\t\tTTPromise.resolve( 'base', 'onCancelClick' );\n\t\t}\n\t}\n\n\t//Don't call super if override this function.\n\tonFormItemChange( target, doNotValidate ) {\n\t\t// Error: TypeError: this.current_edit_record is undefined in interface/html5/views/BaseViewController.js?v=9.0.7-20160202-113244 line 1691\n\t\tif ( !this.current_edit_record ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\t\tvar key = target.getField();\n\t\tthis.current_edit_record[key] = target.getValue();\n\n\t\tif ( !doNotValidate ) {\n\t\t\tthis.validate();\n\t\t}\n\t}\n\n\tsetIsChanged( target ) {\n\t\tvar key = target.getField();\n\t\tif ( this.current_edit_record && this.current_edit_record[key] != target.getValue() ) {\n\t\t\tthis.is_changed = true;\n\t\t}\n\t}\n\n\tonFormItemKeyUp( target ) {\n\t}\n\n\tonFormItemKeyDown( target ) {\n\t}\n\n\tsetMassEditingFieldsWhenFormChange( target ) {\n\t\tvar $this = this;\n\n\t\tif ( this.is_mass_editing ) {\n\t\t\tvar field = target.getField();\n\t\t\tvar linked_fields = [];\n\t\t\tvar is_linked_field = false;\n\t\t\t$.each( this.linked_columns, function( index, value ) {\n\t\t\t\tif ( value !== field ) {\n\t\t\t\t\tlinked_fields.push( value );\n\t\t\t\t} else {\n\t\t\t\t\tis_linked_field = true;\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tif ( is_linked_field ) {\n\t\t\t\t$.each( linked_fields, function( index, value ) {\n\t\t\t\t\tvar is_checked = $this.edit_view_ui_dic[field].isChecked();\n\t\t\t\t\t$this.edit_view_ui_dic[value].setCheckBox( is_checked );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t}\n\t}\n\n\tinitEditViewTabs( tab_options ) {\n\t\tvar $this = this;\n\t\tif( tab_options === undefined ) {\n\t\t\ttab_options = {\n\t\t\t\tactivate: function( e, ui ) {\n\t\t\t\t\tif ( !$this.edit_view_tab || !$this.edit_view_tab.is( ':visible' ) ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.onTabShow( e, ui );\n\t\t\t\t\tGlobal.triggerAnalyticsTabs( e, ui );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.setTabOVisibility( false );\n\n\t\tthis.edit_view_tab = this.edit_view_tab.tabs( tab_options );\n\n\t\tthis.edit_view_tab.off( 'click' ).on( 'click', function( e ) {\n\t\t\t$this.onTabIndexChange( e );\n\t\t} );\n\t}\n\n\tsetTabHtml( tab_model ) {\n\n\t\t// TODO: Go off tab_model not labels. Will need to do this anyway, as we trigger earlier.\n\t\t// HTML2JS TODO: For now this will just generate the tab labels, and once that works, we move on to the tab content div's.\n\t\t// TODO: This needs to be triggered sooner in BaseView.initEditViewUI as currently it happens after the .tabs() initialization and causing the class styles for tabs not to be added to the right tab elems, as they did not exist at the time to be added.\n\t\t// Maybe directly into initEditViewUI, as theres only 11 overrides for that.\n\n\t\tvar tab_bar_labels = this.edit_view.find( '.edit-view-tab-bar-label' );\n\t\tvar tab_bar_content; // insert after the label element.\n\t\t// find the html first, and check if its not already set.\n\t\tif( tab_bar_labels.children().length === 0 ) { // TODO: Perhaps in future also count number of children and compare against labels. If not matching, clear and start again.\n\t\t\t// No label elements found, likely using the new templating logic. Continue to generate the tab html.\n\n\t\t\t// Notes\n\t\t\t/* Fri Dec 17\n\t\t\tTODO:\n\t\t\t- 1. [Done]. First add the save and continue divs into templates as if subview.\n\t\t\t\t1b. Fix subview state issues on Employee->Employees tabs.\n\t\t\t- 2. then hardcode the hierarchy behaviour into its tab_model\n\t\t\t- 3. also hardcode potentially audit, but it might be covered by 1.\n\t\t\t- 4. qualifactions tab hardcoded with the subview things.\n\t\t\t- 5. sort out the first-column second column.\n\t\t\t--- either hardcode into the tab_model for number of columns or\n\t\t\t--- count the number of child elements in second column, and if zero, remove,\n\t\t\t\tand then add full width into the first column element.\n\t\t\t- 6. what was the subviewcontroller errors on some tabs. might be solved by 1. check employee view tabs.\n\t\t\t */\n\n\t\t\t// search for 'first-column full' - 73+ files\n\t\t\t// search for 'second-column' - 27 files\n\t\t\t// therefore first-column full width will be default, and second column will be specified in view controller, to avoid lots of avoidable editing of view files.\n\t\t\tfor ( let tab_id in tab_model ) {\n\t\t\t\t// Create and insert the label elements.\n\t\t\t\tvar new_tab_label_li = document.createElement( 'li' );\n\t\t\t\tvar new_tab_label_li_a = document.createElement( 'a' );\n\t\t\t\tnew_tab_label_li_a.setAttribute('ref', tab_id );\n\t\t\t\tnew_tab_label_li_a.setAttribute('href', '#' + tab_id );\n\t\t\t\tnew_tab_label_li.appendChild( new_tab_label_li_a );\n\n\t\t\t\ttab_bar_labels.append( new_tab_label_li ); // jQuery append()\n\t\t\t\t// TODO: Could also directly set the label value part here too in future.\n\t\t\t}\n\n\t\t} else {\n\t\t\t// Do nothing, labels already exist, likely from legacy html template loading.\n\t\t}\n\n\t\tvar tab_bar_parent = tab_bar_labels.parent();\n\t\tvar tab_bar_content_divs = tab_bar_parent.find( '.edit-view-tab-outside' );\n\n\t\tif( tab_bar_content_divs.children().length === 0 ) {\n\t\t\t// Create and insert the tab content divs\n\n\n\t\t\tfor ( let tab_id in tab_model ) {\n\t\t\t\t// Create and insert the label elements.\n\t\t\t\tlet tab_content_html = '';\n\t\t\t\tlet tab = tab_model[ tab_id ];\n\t\t\t\tlet is_sub_view = inferSubViewFromTab( tab ); // TODO: HTML2JS: Improve this to avoid inferring, by adding is_sub_view to relevant tab models.\n\n\t\t\t\tif( tab.html_template ) {\n\t\t\t\t\t// html template provided as override, do not use HtmlTemplatesGlobal. Only used for complex one-off tab html's.\n\t\t\t\t\ttab_content_html = tab.html_template;\n\t\t\t\t} else {\n\t\t\t\t\ttab_content_html = $( HtmlTemplatesGlobal.genericTab({\n\t\t\t\t\t\ttab_id: tab_id,\n\t\t\t\t\t\tis_multi_column: tab.is_multi_column ? true : false,\n\t\t\t\t\t\tshow_permission_div: tab.show_permission_div ? true : false,\n\t\t\t\t\t\tis_sub_view: is_sub_view // to convert undefined's to false\n\t\t\t\t\t}));\n\t\t\t\t}\n\n\t\t\t\ttab_bar_parent.append( tab_content_html ); // Insert each new tab content at the end of tab_bar div (and after the ul.edit-view-tab-bar-label element, and other tab contents.)\n\t\t\t}\n\n\t\t\t// tab_bar.append( $( HtmlTemplatesGlobal.auditTab()) ); // after all the tab contents, add the audit tab. (TODO: handle situations where audit not needed). Auctually, audit should be in the list of tabs already. comment out for now.\n\n\t\t\t// switch ( tab_ref_key ) {\n\t\t\t// \tcase x:\n\t\t\t// \t\t// code block\n\t\t\t// \t\tbreak;\n\t\t\t// \tcase y:\n\t\t\t// \t\t// code block\n\t\t\t// \t\tbreak;\n\t\t\t// \tdefault:\n\t\t\t// \t// code block\n\t\t\t// }\n\n\t\t} else {\n\t\t\t// tab_bar_content_divs.length must be greater than 0\n\t\t\t// Do nothing, and no html will be affected.\n\t\t}\n\n\t\tfunction inferSubViewFromTab( tab ) {\n\t\t\tif ( tab.is_sub_view == true ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif( tab.init_callback === undefined ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar init_callback_string = tab.init_callback || '';\n\t\t\tvar infer_subview_tab_state = init_callback_string.toLowerCase().indexOf( 'sub' ) !== -1;\n\t\t\tif ( infer_subview_tab_state === true ) {\n\t\t\t\t// This one is a little more experimental (assumes all sub views have init callback functions named with 'sub'), but might work as temporary during refactor.\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// Nothing matched, return false by default.\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tsetTabLabels( source ) {\n\t\tfor ( var key in source ) {\n\t\t\tthis.edit_view.find( 'a[ref=' + key + ']' ).text( source[key] );\n\t\t}\n\t}\n\n\tgetTabModel() {\n\t\treturn this.tab_model;\n\t}\n\n\tsetTabModel( model ) {\n\t\tvar tab_labels = {};\n\n\t\tfor ( var i in model ) {\n\t\t\t//If the model is \"true\", then use default models for audit/attachment tabs.\n\t\t\tif ( i == 'tab_audit' && model[i] === true ) {\n\t\t\t\tmodel['tab_audit'] = {\n\t\t\t\t\t'label': $.i18n._( 'Audit' ),\n\t\t\t\t\t'init_callback': 'initSubLogView',\n\t\t\t\t\t'display_on_mass_edit': false,\n\t\t\t\t\t'display_on_add': false\n\t\t\t\t};\n\t\t\t} else if ( i == 'tab_attachment' && model[i] === true ) {\n\t\t\t\tmodel['tab_attachment'] = {\n\t\t\t\t\t'label': $.i18n._( 'Attachment' ),\n\t\t\t\t\t'init_callback': 'initSubDocumentView',\n\t\t\t\t\t'display_on_mass_edit': false\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif ( model[i].hasOwnProperty( 'label' ) && model[i].label != '' ) {\n\t\t\t\ttab_labels[i] = model[i].label;\n\t\t\t}\n\t\t}\n\n\t\tthis.tab_model = model;\n\t\tthis.setTabHtml( model );\n\t\tthis.initEditViewTabs();\n\t\tthis.setTabLabels( tab_labels );\n\n\t\treturn true;\n\t}\n\n\tonTabShow( e, ui ) {\n\t\tif ( !this.current_edit_record ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar key = this.getEditViewTabIndex();\n\t\tthis.editFieldResize( key );\n\n\t\tvar tab_model = this.getTabModel();\n\n\t\tif ( tab_model != null ) {\n\t\t\tif ( ui && ui.oldTab ) {\n\t\t\t\tvar prev_tab_name = ui.oldTab.find( 'a' )[0].getAttribute( 'href' ).substring( 1 );\n\t\t\t\tif ( tab_model[prev_tab_name] && tab_model[prev_tab_name].hasOwnProperty( 'on_exit_callback' ) && tab_model[prev_tab_name].on_exit_callback != '' ) {\n\t\t\t\t\tthis[tab_model[prev_tab_name].on_exit_callback]( prev_tab_name ); //Call mapped function to initialize the tab.\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//ReFactored path to handle tabs based on a tab model mapping defined in each view class.\n\t\t\t//This abstracts the entry point for all tabs initializations to help with hiding/showing them and to reduce code duplication.\n\t\t\tvar tab_name = null;\n\t\t\tvar sub_view_div = null;\n\n\t\t\tvar tab_bar = this.edit_view.find( '.edit-view-tab-bar li.ui-tabs-active' ).find( 'a' );\n\t\t\tif ( tab_bar.length > 0 ) {\n\t\t\t\ttab_name = tab_bar[0].getAttribute( 'href' ).substring( 1 ); //Remove the '#';\n\t\t\t\tsub_view_div = this.edit_view_tab.find( '#' + tab_name ).find( '.first-column-sub-view' );\n\t\t\t}\n\n\t\t\tif ( sub_view_div && sub_view_div.length > 0 && this.tab_model[tab_name] && !this.tab_model[tab_name].initialized ) { //Only hide grid on first initialization as it has to load all the data. Otherwise the 2nd time the user goes to the tab they will see some minor \"flashing\"\n\t\t\t\tTTPromise.add( 'BaseViewController', 'onTabShow' );\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'onTabShow', function() {\n\t\t\t\t\tsub_view_div.css( 'opacity', '1' );\n\t\t\t\t} );\n\n\t\t\t\tsub_view_div.css( 'opacity', '0' ); //Hide the grid while its loading/sizing.\n\t\t\t\tthis.tab_model[tab_name].initialized = true;\n\t\t\t}\n\n\t\t\tif ( tab_model[tab_name] ) {\n\t\t\t\t//this.edit_view_tab.find( '#'+ tab_name ).find( '.first-column-sub-view' ).css( 'display', 'block' );\n\t\t\t\t//Call the init_callback even if we are editing an existing record or creating a new one.\n\t\t\t\t// As some views (ie: OverTime Policy) need to control whats shown on each tab regardless of if we are editing or adding.\n\t\t\t\tif ( tab_model[tab_name].hasOwnProperty( 'init_callback' ) && tab_model[tab_name].init_callback != '' ) {\n\t\t\t\t\tthis[tab_model[tab_name].init_callback]( tab_name ); //Call mapped function to initialize the tab.\n\t\t\t\t} else {\n\t\t\t\t\t//Assume primary tab and build context menu.\n\t\t\t\t\tif ( this.current_edit_record.id && this.current_edit_record.id != TTUUID.zero_id ) {\n\t\t\t\t\t\tthis.setEditMenu();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//this.edit_view_tab.find( '#'+ tab_name ).find( '.first-column-sub-view' ).css( 'display', 'none' ); //This would prevent the grid from showing in Attendance -> TimeSheet, Accumulated Time view.\n\t\t\t\t\t\t//this.edit_view_tab.find( '#'+ tab_name ).find( '.first-column-sub-view' ).css( 'display', 'block' );\n\t\t\t\t\t\tthis.showSaveAndContinueButton();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// if ( this.current_edit_record.id ) {\n\t\t\t\t// \t//this.edit_view_tab.find( '#'+ tab_name ).find( '.first-column-sub-view' ).css( 'display', 'block' );\n\t\t\t\t// \tif ( tab_model[tab_name].hasOwnProperty('init_callback') && tab_model[tab_name].init_callback != '' ) {\n\t\t\t\t// \t\tthis[tab_model[tab_name].init_callback]( tab_name ); //Call mapped function to initialize the tab.\n\t\t\t\t// \t} else {\n\t\t\t\t// \t\t//Assume primary tab and build context menu.\n\t\t\t\t// \t\tthis.buildContextMenu( true );\n\t\t\t\t// \t\tthis.setEditMenu();\n\t\t\t\t// \t}\n\t\t\t\t// } else {\n\t\t\t\t// \t//this.edit_view_tab.find( '#'+ tab_name ).find( '.first-column-sub-view' ).css( 'display', 'none' ); //This would prevent the grid from showing in Attendance -> TimeSheet, Accumulated Time view.\n\t\t\t\t// \t//this.edit_view_tab.find( '#'+ tab_name ).find( '.first-column-sub-view' ).css( 'display', 'block' );\n\t\t\t\t// \tthis.edit_view.find( '.save-and-continue-div' ).css( 'display', 'block' );\n\t\t\t\t// }\n\t\t\t} else {\n\t\t\t\t//Assume primary tab and build context menu.\n\t\t\t\tthis.buildContextMenu( true );\n\t\t\t\tthis.setEditMenu();\n\t\t\t}\n\t\t} else {\n\t\t\t//Handle most cases that one tab and on audit tab\n\t\t\tif ( key === 1 ) {\n\n\t\t\t\tif ( this.current_edit_record.id && this.current_edit_record.id != TTUUID.zero_id ) {\n\t\t\t\t\tthis.edit_view_tab.find( '#tab_audit' ).find( '.first-column-sub-view' ).css( 'display', 'block' );\n\t\t\t\t\tthis.initSubLogView( 'tab_audit' );\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.edit_view_tab.find( '#tab_audit' ).find( '.first-column-sub-view' ).css( 'display', 'none' );\n\t\t\t\t\tthis.showSaveAndContinueButton();\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tthis.buildContextMenu( true );\n\t\t\t\tthis.setEditMenu();\n\t\t\t}\n\t\t}\n\t}\n\n\t//When overriding this function, always call super() so it can handle tab_audit/tab_attachment on its own.\n\tcheckTabPermissions( tab ) {\n\t\tvar retval = true; //Most tabs are shown, so default to true.\n\n\t\tswitch ( tab ) {\n\t\t\tcase 'tab_audit':\n\t\t\t\tretval = this.subAuditValidate();\n\t\t\t\tbreak;\n\t\t\tcase 'tab_attachment':\n\t\t\t\tretval = this.subDocumentValidate();\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn retval;\n\t}\n\n\tsetTabStatus() {\n\t\t// exception that edit_view_tab is null\n\t\tif ( !this.edit_view_tab ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar tab_model = this.getTabModel();\n\n\t\tif ( tab_model != null ) {\n\t\t\tvar visible_tab_indexes = Array();\n\n\t\t\t//ReFactored path to handle tabs based on a tab model mapping defined in each view class.\n\t\t\t//This abstracts the entry point for all tabs initializations to help with hiding/showing them and to reduce code duplication.\n\t\t\tfor ( var i in tab_model ) {\n\t\t\t\tvar tab_index = $( this.edit_view_tab.find( 'ul li a[ref=\"' + i + '\"]' ) ).parent().index();\n\n\t\t\t\tif ( ( this.is_mass_editing && tab_model[i].hasOwnProperty( 'display_on_mass_edit' ) && tab_model[i].display_on_mass_edit == false )\n\t\t\t\t\t|| ( ( this.is_add || this.is_mass_adding ) && tab_model[i].hasOwnProperty( 'display_on_add' ) && tab_model[i].display_on_add == false ) ) {\n\t\t\t\t\t$( this.edit_view_tab.find( 'ul li a[ref=\"' + i + '\"]' ) ).parent().hide();\n\t\t\t\t} else {\n\t\t\t\t\tif ( this.checkTabPermissions( i ) == true ) {\n\t\t\t\t\t\t$( this.edit_view_tab.find( 'ul li a[ref=\"' + i + '\"]' ) ).parent().show();\n\t\t\t\t\t\tvisible_tab_indexes.push( tab_index );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$( this.edit_view_tab.find( 'ul li a[ref=\"' + i + '\"]' ) ).parent().hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//Always start with the first tab that actually has permissions to be shown. This is important for sub-views like Edit Employee, Tax, New icon, where it shows only a single tab where there are really 5+ tabs just hidden.\n\t\t\tvisible_tab_indexes = visible_tab_indexes.sort( function( a, b ) {\n\t\t\t\treturn a - b;\n\t\t\t} ); //numeric sort.\n\n\t\t\tif ( visible_tab_indexes[0] ) {\n\t\t\t\ttry {\n\t\t\t\t\tthis.edit_view_tab.tabs( 'option', 'active', visible_tab_indexes[0] );\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\t//Error: cannot call methods on tabs prior to initialization; attempted to call method 'option'\n\t\t\t\t\tDebug.Text( e.message, 'BaseViewController.js', 'setTabStatus', 'BaseViewController', 10 );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t//Handle most cases that one tab and on audit tab\n\t\t\tif ( this.is_mass_editing ) {\n\t\t\t\t$( this.edit_view_tab.find( 'ul li a[ref=\"tab_audit\"]' ) ).parent().hide();\n\t\t\t\tthis.edit_view_tab.tabs( 'option', 'active', 0 );\n\t\t\t} else {\n\t\t\t\tif ( this.subAuditValidate() ) {\n\t\t\t\t\t$( this.edit_view_tab.find( 'ul li a[ref=\"tab_audit\"]' ) ).parent().show();\n\t\t\t\t} else {\n\t\t\t\t\t$( this.edit_view_tab.find( 'ul li a[ref=\"tab_audit\"]' ) ).parent().hide();\n\t\t\t\t\tthis.edit_view_tab.tabs( 'option', 'active', 0 );\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tthis.editFieldResize( 0 );\n\t}\n\n\tonTabIndexChange( e ) {\n\t\tTTPromise.add( 'BaseViewController', 'onTabIndexChange' );\n\t\tTTPromise.wait();\n\n\t\tif ( ( !this.sub_view_mode && !this.edit_only_mode ) || typeof this.initReport == 'function' ) {\n\t\t\tvar current_url = window.location.href;\n\n\t\t\tif ( current_url.indexOf( '&tab' ) > 0 ) {\n\t\t\t\tcurrent_url = current_url.substring( 0, current_url.indexOf( '&tab' ) );\n\t\t\t}\n\t\t\tvar tab_name = this.edit_view_tab.find( '.edit-view-tab-bar-label' ).children().eq( this.getEditViewTabIndex() ).text();\n\t\t\ttab_name = tab_name.replace( /\\/|\\s+/g, '' );\n\t\t\tcurrent_url = current_url + '&tab=' + tab_name;\n\n\t\t\tGlobal.setURLToBrowser( current_url );\n\n\t\t}\n\n\t\tthis.hideErrorTips();\n\t\tTTPromise.resolve( 'BaseViewController', 'onTabIndexChange' );\n\t}\n\n\thideErrorTips() {\n\t\tfor ( var key in this.edit_view_error_ui_dic ) {\n\t\t\t//#2581 - Uncaught TypeError: this.edit_view_error_ui_dic[key].hideErrorTip is not a function\n\t\t\tif ( this.edit_view_error_ui_dic[key] && typeof this.edit_view_error_ui_dic[key].hideErrorTip == 'function' ) {\n\t\t\t\tthis.edit_view_error_ui_dic[key].hideErrorTip();\n\t\t\t}\n\t\t}\n\t\tthis.removeEditViewErrorTip();\n\t}\n\n\t//removed workarounds and comments for qtip1 when upgrading to qtip2.\n\tremoveEditViewErrorTip() {\n\t\tif ( $( '.qtip2-error-tip:visible' ) ) {\n\t\t\t$( '.qtip2-error-tip' ).remove();\n\t\t}\n\n\t}\n\n\tremoveEditViewWarningTip() {\n\t\tif ( $( '.qtip2-warning-tip:visible' ) ) {\n\t\t\t$( '.qtip2-warning-tip' ).remove();\n\t\t}\n\t}\n\n\tonCountryChange() {\n\t\tvar selectVal = this.edit_view_ui_dic['country'].getValue();\n\t\tthis.eSetProvince( selectVal, true );\n\t\tthis.clearErrorTips();\n\t\tthis.setEditMenu();\n\t}\n\n\t//Make sure this.current_edit_record is updated before validate\n\tvalidate( api ) {\n\t\tif ( this.enable_validation ) {\n\t\t\t//Allow alternate api to be validated.\n\t\t\tif ( api == undefined ) {\n\t\t\t\tvar api = this.api;\n\t\t\t}\n\n\t\t\tvar $this = this;\n\t\t\tvar record = {};\n\t\t\tif ( this.is_mass_editing ) {\n\t\t\t\tfor ( var key in this.edit_view_ui_dic ) {\n\n\t\t\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\t\t\tif ( Global.isSet( widget.isChecked ) ) {\n\t\t\t\t\t\tif ( widget.isChecked() && widget.getEnabled() ) {\n\t\t\t\t\t\t\trecord[key] = this.current_edit_record[key]; // Note: Some view controllers use widget.getValue() instead of current_edit_record[key]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trecord = this.current_edit_record;\n\t\t\t}\n\t\t\trecord = this.uniformVariable( record );\n\t\t\tapi['validate' + api.key_name]( record, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t$this.validateResult( result );\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\tDebug.Text( 'Validation disabled', 'BaseViewController.js', 'BaseViewController', 'validate', 10 );\n\t\t}\n\t}\n\n\tvalidateResult( result ) {\n\t\tvar $this = this;\n\t\t$this.clearErrorTips(); //Always clear error\n\t\tif ( !$this.edit_view ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !result ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( result && result.isValid() ) {\n\t\t\t$this.edit_view.attr( 'validate_complete', true );\n\t\t\t$this.setEditMenu();\n\t\t} else {\n\t\t\t$this.setErrorMenu();\n\t\t\t$this.setErrorTips( result, this.show_warning_when_validation );\n\n\t\t}\n\t}\n\n\tclearErrorTips() {\n\n\t\tfor ( var key in this.edit_view_error_ui_dic ) {\n\t\t\t//Error: Uncaught TypeError: Cannot read property 'clearErrorStyle' of undefined in /interface/html5/views/BaseViewController.js?v=8.0.0-20141117-111140 line 1779\n\t\t\tif ( !this.edit_view_error_ui_dic.hasOwnProperty( key ) || !this.edit_view_error_ui_dic[key] ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tthis.edit_view_error_ui_dic[key].clearErrorStyle();\n\t\t}\n\n\t\t// Error: Uncaught TypeError: Cannot read property 'interfaces' of undefined in interface/html5/framework/jquery.qtip.min.js?v=9.0.0-20150918-221906 line 15\n\t\tthis.removeEditViewErrorTip();\n\t\tthis.removeEditViewWarningTip();\n\t\t$( '.error-tab' ).removeClass( 'error-tab' );\n\t\t$( '.error-tab-hide' ).removeClass( 'error-tab-hide' );\n\t\t$( '.warning-tab' ).removeClass( 'warning-tab' );\n\t\t$( '.warning-tab-hide' ).removeClass( 'warning-tab-hide' );\n\t\t// Clear pulse on tabs\n\t\tif ( this.pulse_time_dic ) {\n\t\t\tfor ( var key1 in this.pulse_time_dic ) {\n\t\t\t\tclearInterval( this.pulse_time_dic[key1] );\n\t\t\t}\n\t\t\tthis.pulse_time_dic = {};\n\t\t}\n\t\tthis.edit_view_error_ui_dic = {};\n\n\t\t$( '.qtip .qtip2-error-tip' ).remove();\n\t}\n\n\t//Override this if more than one tab\n\tsetErrorTips( result, show_warning ) {\n\t\tthis.clearErrorTips();\n\t\tif ( !Global.isSet( show_warning ) ) {\n\t\t\tshow_warning = true;\n\t\t}\n\n\t\t//Error: Unable to get property 'find' of undefined or null reference in http://timeclock:8085/interface/html5/views/BaseViewController.js?v=7.4.3-20140926-105827 line 1769\n\t\tif ( !this.edit_view_tab ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar details = result.getDetails();\n\t\t// Only check first item\n\t\t// Error: Uncaught TypeError: Cannot call method 'hasOwnProperty' of undefined in /interface/html5/views/BaseViewController.js?v=9.0.0-20150822-134259 line 1879\n\t\t// Zero is not always the first element;\n\t\tvar first_el = 0;\n\t\tfor ( var first_el in details ) {\n\t\t\tbreak;\n\t\t}\n\n\t\tif ( details && details[first_el] && details[first_el].hasOwnProperty( 'error' ) ) {\n\t\t\tthis.setErrorTipsError( result );\n\t\t} else if ( details && details[first_el] && details[first_el].hasOwnProperty( 'warning' ) ) { //Error: TypeError: details[0] is undefined in https://greenacres.timetrex.com/interface/html5/views/BaseViewController.js?v=9.0.0-20150822-105118 line 1883\n\t\t\tif ( show_warning ) {\n\t\t\t\tthis.setErrorTipsWarning( result );\n\t\t\t}\n\t\t\tthis.setEditMenu();\n\t\t} else if ( result.getCode() == 'PERMISSION' || result.getCode() == 'VALIDATION' ) {\n\t\t\tTAlertManager.showErrorAlert( result );\n\t\t} else {\n\t\t\t// Make sure current codes work.\n\t\t\tthis.setErrorTipsError( result );\n\t\t}\n\t}\n\n\tsetErrorTipsWarning( result ) {\n\t\tvar $this = this;\n\t\tvar widget;\n\t\t// when do validation, only show warning no alert\n\t\tvar $current_doing_context_action = LocalCacheData.current_doing_context_action; //#2474 - LocalCacheData.current_doing_context_action can change to \"validate\" while waiting for user to respond to warning box.\n\t\tif ( $current_doing_context_action != 'validate' ) {\n\t\t\tTAlertManager.showWarningAlert( result, function( flag ) {\n\t\t\t\tif ( flag ) {\n\t\t\t\t\tswitch ( $current_doing_context_action ) {\n\t\t\t\t\t\tcase 'save':\n\t\t\t\t\t\t\t$this.onSaveClick( true, true ); //Force disable \"no changes detected\" confirmation.\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'save_and_continue':\n\t\t\t\t\t\t\t$this.onSaveAndContinue( true );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'save_and_next':\n\t\t\t\t\t\t\t$this.onSaveAndNextClick( true );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'save_and_copy':\n\t\t\t\t\t\t\t$this.onSaveAndCopy( true );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'new':\n\t\t\t\t\t\t\t$this.onSaveAndNewClick( true );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'authorize': //Allow validation warnings to work when authorizing Request/TimeSheet/Expense.\n\t\t\t\t\t\t\t$this.onAuthorizationClick( true );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$this.show_warning_when_validation = true;\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\t//Error: Unable to get property 'warning' of undefined or null reference\n\t\tvar error_list = [];\n\t\tif ( result.getDetails().length == 1 ) {\n\t\t\terror_list = result.getDetails()[0].warning;\n\t\t}\n\t\tvar found_in_current_tab = false;\n\t\tfor ( var key in error_list ) {\n\t\t\tif ( !error_list.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif ( Global.isSet( this.edit_view_ui_dic[key] ) && this.edit_view_ui_dic[key].closest( document.documentElement ).length > 0 ) {\n\t\t\t\twidget = this.edit_view_ui_dic[key];\n\t\t\t} else if ( Global.isSet( this.edit_view_ui_validation_field_dic[key] ) ) {\n\t\t\t\tif ( Global.isArray( this.edit_view_ui_validation_field_dic[key] ) ) {\n\t\t\t\t\tvar len = this.edit_view_ui_validation_field_dic[key].length;\n\t\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\t\t\tvar item = this.edit_view_ui_validation_field_dic[key][i];\n\t\t\t\t\t\tif ( item.closest( document.documentElement ).length > 0 ) {\n\t\t\t\t\t\t\twidget = item;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if ( this.edit_view_ui_validation_field_dic[key].closest( document.documentElement ).length > 0 ) {\n\t\t\t\t\twidget = this.edit_view_ui_validation_field_dic[key];\n\t\t\t\t} else {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t} else if ( key.indexOf( '_id' ) < 0 && Global.isSet( this.edit_view_ui_dic[key + '_id'] ) && this.edit_view_ui_dic[key + '_id'].closest( document.documentElement ).length > 0 ) {\n\t\t\t\twidget = this.edit_view_ui_dic[key + '_id'];\n\t\t\t} else {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif ( error_list[key] ) {\n\t\t\t\tvar show_error = false;\n\t\t\t\tif ( widget.is( ':visible' ) ) {\n\t\t\t\t\tshow_error = true;\n\t\t\t\t\tfound_in_current_tab = true;\n\t\t\t\t}\n\n\t\t\t\tif ( typeof widget.setErrorStyle === 'function' ) { //Fix JS exception: Uncaught TypeError: widget.setErrorStyle is not a function\n\t\t\t\t\twidget.setErrorStyle( error_list[key], show_error, true );\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tthis.showErrorStatusOnTab( widget, false );\n\t\t\tthis.edit_view_error_ui_dic[key] = widget;\n\t\t}\n\t\tif ( !found_in_current_tab ) {\n\t\t\tthis.showEditViewError( result );\n\t\t}\n\t}\n\n\tshowErrorStatusOnTab( widget, isError ) {\n\t\tvar parentContainer = widget.parent();\n\t\tvar i = 0;\n\t\twhile ( !parentContainer.hasClass( 'edit-view-tab-outside' ) && i < 5 ) {\n\t\t\ti = i + 1;\n\t\t\tparentContainer = parentContainer.parent();\n\t\t}\n\t\tif ( parentContainer.hasClass( 'edit-view-tab-outside' ) ) {\n\t\t\tvar id = parentContainer.attr( 'id' );\n\t\t\tvar tab = this.edit_view.find( 'a[ref=\"' + id + '\"]' );\n\t\t\tif ( isError ) {\n\t\t\t\ttab.parent().addClass( 'error-tab' );\n\t\t\t\tthis.startPulse( id, tab.parent() );\n\t\t\t} else {\n\t\t\t\ttab.parent().addClass( 'warning-tab' );\n\t\t\t\tthis.startPulse( id, tab.parent(), true );\n\t\t\t}\n\n\t\t}\n\t}\n\n\tstartPulse( tab_id, target, is_warning ) {\n\t\tvar $this = this;\n\t\tif ( !this.pulse_time_dic ) {\n\t\t\tthis.pulse_time_dic = {};\n\t\t}\n\t\tif ( this.pulse_time_dic[tab_id] ) {\n\t\t\tcleanTimer( tab_id );\n\t\t}\n\t\tthis.pulse_time_dic[tab_id] = setInterval( function() {\n\t\t\tif ( is_warning ) {\n\t\t\t\tif ( target.hasClass( 'warning-tab-hide' ) ) {\n\t\t\t\t\ttarget.removeClass( 'warning-tab-hide' );\n\t\t\t\t} else if ( target.hasClass( 'warning-tab' ) ) {\n\t\t\t\t\ttarget.addClass( 'warning-tab-hide' );\n\t\t\t\t} else {\n\t\t\t\t\tcleanTimer( tab_id );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif ( target.hasClass( 'error-tab-hide' ) ) {\n\t\t\t\t\ttarget.removeClass( 'error-tab-hide' );\n\t\t\t\t} else if ( target.hasClass( 'error-tab' ) ) {\n\t\t\t\t\ttarget.addClass( 'error-tab-hide' );\n\t\t\t\t\tcleanTimer( tab_id );\n\t\t\t\t\tsetTimeout( function() {\n\t\t\t\t\t\tif ( target.hasClass( 'error-tab-hide' ) ) {\n\t\t\t\t\t\t\ttarget.removeClass( 'error-tab-hide' );\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$this.startPulse( tab_id, target, is_warning );\n\t\t\t\t\t}, 1700 );\n\t\t\t\t} else {\n\t\t\t\t\tcleanTimer( tab_id );\n\t\t\t\t}\n\t\t\t}\n\t\t}, 2000 );\n\n\t\tfunction cleanTimer( tab_id ) {\n\t\t\tclearInterval( $this.pulse_time_dic[tab_id] );\n\t\t\t$this.pulse_time_dic[tab_id] = null;\n\t\t}\n\t}\n\n\tsetErrorTipsError( result ) {\n\n\t\t//Error: TypeError: details[0] is undefined in interface/html5/views/BaseViewController.js?v=9.0.0-20150822-105118 line 1883\n\t\t// Zero is not always the firwst index.\n\t\tvar result_array = result.getDetails() ? result.getDetails() : {};\n\t\tvar first_el = 0;\n\t\tfor ( var first_el in result_array ) {\n\t\t\tbreak;\n\t\t}\n\t\tvar error_list = result_array ? result_array[first_el] : {};\n\t\tvar widget;\n\t\tif ( error_list && error_list.hasOwnProperty( 'error' ) ) {\n\t\t\terror_list = error_list.error;\n\t\t}\n\t\tvar found_in_current_tab = false;\n\t\tfor ( var key in error_list ) {\n\t\t\tif ( !error_list.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif ( Global.isSet( this.edit_view_ui_dic[key] ) && this.edit_view_ui_dic[key].closest( document.documentElement ).length > 0 ) {\n\t\t\t\twidget = this.edit_view_ui_dic[key];\n\t\t\t} else if ( Global.isSet( this.edit_view_ui_validation_field_dic[key] ) ) {\n\t\t\t\tif ( Global.isArray( this.edit_view_ui_validation_field_dic[key] ) ) {\n\t\t\t\t\tvar len = this.edit_view_ui_validation_field_dic[key].length;\n\t\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\t\t\tvar item = this.edit_view_ui_validation_field_dic[key][i];\n\t\t\t\t\t\tif ( item.closest( document.documentElement ).length > 0 ) {\n\t\t\t\t\t\t\twidget = item;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if ( this.edit_view_ui_validation_field_dic[key].closest( document.documentElement ).length > 0 ) {\n\t\t\t\t\twidget = this.edit_view_ui_validation_field_dic[key];\n\t\t\t\t} else {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t} else if ( key.indexOf( '_id' ) < 0 && Global.isSet( this.edit_view_ui_dic[key + '_id'] ) && this.edit_view_ui_dic[key + '_id'].closest( document.documentElement ).length > 0 ) {\n\t\t\t\twidget = this.edit_view_ui_dic[key + '_id'];\n\t\t\t} else {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif ( widget.is( ':visible' ) ) {\n\t\t\t\t// Error: Uncaught TypeError: widget.setErrorStyle is not a function\n\t\t\t\tif ( widget.setErrorStyle && typeof widget.setErrorStyle == 'function' ) {\n\t\t\t\t\twidget.setErrorStyle( error_list[key], true );\n\t\t\t\t\tfound_in_current_tab = true;\n\t\t\t\t} else {\n\t\t\t\t\tDebug.Text( 'ERROR: widget.setErrorStyle is not a function.', 'BaseViewController.js', 'BaseViewController', null, 10 );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Error: Uncaught TypeError: widget.setErrorStyle is not a function\n\t\t\t\tif ( widget.setErrorStyle && typeof widget.setErrorStyle == 'function' ) {\n\t\t\t\t\twidget.setErrorStyle( error_list[key] );\n\t\t\t\t} else {\n\t\t\t\t\tDebug.Text( 'ERROR: widget.setErrorStyle is not a function.', 'BaseViewController.js', 'BaseViewController', null, 10 );\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.showErrorStatusOnTab( widget, true );\n\t\t\tthis.edit_view_error_ui_dic[key] = widget;\n\t\t}\n\t\tif ( !found_in_current_tab ) {\n\t\t\tthis.showEditViewError( result );\n\t\t}\n\t}\n\n\tshowEditViewError( result ) {\n\t\tvar details = result.getDetails()[0];\n\t\tvar isError = true;\n\t\t//Error: TypeError: details is undefined in interface/html5/views/BaseViewController.js?v=9.0.0-20150908-081451 line 2078\n\t\tif ( !details ) {\n\t\t\treturn;\n\t\t}\n\t\tif ( details.hasOwnProperty( 'error' ) ) {\n\t\t\tdetails = details.error;\n\t\t\tisError = true;\n\t\t} else if ( details.hasOwnProperty( 'warning' ) ) {\n\t\t\tisError = false;\n\t\t\tdetails = details.warning;\n\t\t}\n\t\tvar error_string = '';\n\t\tvar background_color = isError ? '#cb2e2e' : '#ffff00';\n\t\tvar color = isError ? '#fff' : '#000';\n\t\tvar border_color = isError ? '#CB2E2E' : '#e7be00';\n\n\t\terror_string = Global.convertValidationErrorToString( details );\n\n\t\tthis.removeEditViewErrorTip();\n\t\tthis.edit_view.find('.ui-helper-reset').qtip( {\n\t\t\tshow: {\n\t\t\t\twhen: false,\n\t\t\t\tready: true\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\thide: function( event, api ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t},\n\t\t\tcontent: error_string,\n\t\t\tstyle: {\n\t\t\t\tclasses: isError ? 'qtip2-error-tip' : 'qtip2-warning-tip', //used for styling and removal.\n\t\t\t\ttip: {\n\t\t\t\t\tcorner: 'bottom center'\n\t\t\t\t}\n\t\t\t},\n\t\t\tposition: {\n\t\t\t\tmy: 'bottom left',\n\t\t\t\tat: 'top center'\n\t\t\t}\n\t\t} );\n\t}\n\n\topenEditView() {\n\t\tif ( !this.edit_view ) {\n\t\t\tthis.initEditViewUI( this.viewId, this.edit_view_tpl );\n\t\t}\n\t}\n\n\tsetTabOVisibility( flag ) {\n\t\tvar tab0 = $( this.edit_view_tab.find( '.edit-view-tab' )[0] );\n\t\tif ( flag ) {\n\t\t\ttab0.css( 'opacity', 1 );\n\t\t\tthis.setEditViewTabSize();\n\t\t\tif ( this.edit_view_close_icon ) {\n\t\t\t\tthis.edit_view_close_icon.show();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.edit_view_tab.find( 'ul li' ).hide();\n\t\t\ttab0.css( 'opacity', 0 );\n\t\t}\n\t}\n\n\t//set widget disablebility if view mode or edit mode\n\tsetEditViewWidgetsMode() {\n\t\tvar did_clean_dic = {};\n\t\tfor ( var key in this.edit_view_ui_dic ) {\n\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\twidget.css( 'opacity', 1 );\n\t\t\tvar column = widget.parent().parent().parent();\n\t\t\tvar tab_id = column.parent().attr( 'id' );\n\t\t\tif ( !column.hasClass( 'v-box' ) ) {\n\t\t\t\tif ( !did_clean_dic[tab_id] ) {\n\t\t\t\t\tdid_clean_dic[tab_id] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( this.is_viewing ) {\n\t\t\t\tif ( Global.isSet( widget.setEnabled ) ) {\n\t\t\t\t\twidget.setEnabled( false );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif ( Global.isSet( widget.setEnabled ) ) {\n\t\t\t\t\twidget.setEnabled( true );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t//Call this when edit view open\n\tinitEditViewUI( view_id, edit_view_file_name ) {\n\t\tGlobal.setUINotready();\n\t\tTTPromise.add( 'init', 'init' );\n\t\tTTPromise.wait();\n\n\t\tvar $this = this;\n\t\tif ( this.edit_view ) {\n\t\t\tthis.edit_view.remove();\n\t\t}\n\n\t\tthis.edit_view = $( Global.loadViewSource( view_id, edit_view_file_name, null, true ) );\n\n\t\tthis.edit_view_tab = $( this.edit_view.find( '.edit-view-tab-bar' ) );\n\t\tthis.edit_view_tab.css( 'opacity', 0 );\n\n\t\t//Give edt view tab a id, so we can load it when put right click menu on it\n\t\tthis.edit_view_tab.attr( 'id', this.ui_id + '_edit_view_tab' );\n\n\t\t// Moved into generic BaseView.initEditViewTabs\n\t\t// this.setTabOVisibility( false );\n\n\t\t// this.edit_view_tab = this.edit_view_tab.tabs( {\n\t\t// \tactivate: function( e, ui ) {\n\t\t// \t\tif ( !$this.edit_view_tab || !$this.edit_view_tab.is( ':visible' ) ) {\n\t\t// \t\t\treturn;\n\t\t// \t\t}\n\t\t//\n\t\t// \t\t$this.onTabShow( e, ui );\n\t\t// \t\tGlobal.triggerAnalyticsTabs( e, ui );\n\t\t// \t}\n\t\t// } );\n\n\t\t// this.edit_view_tab.off( 'click' ).on( 'click', function( e ) {\n\t\t// \t$this.onTabIndexChange( e );\n\t\t// } );\n\n\t\tGlobal.contentContainer().append( this.edit_view );\n\n\t\t// Moved to buildEditViewUI, as the init might only be called once, and the context menu needs to be rebuilt on every view build.\n\t\t// // After we add the edit_view to the page, add the context menu (Vue needs a valid id in dom)\n\t\t// if( ContextMenuManager.getMenu( this.determineContextMenuMountAttributes().id ) === undefined ) {\n\t\t// \tthis.buildContextMenu();\n\t\t// }\n\t\t// #VueContextMenu#Dynamic-EditView Once edit view html has loaded and mounted to DOM, then insert container for context_menu and initialise menu.\n\n\t\t// Testing to see if just having the code in buildContextMenu is enough.\n\t\t// if( !this.edit_view_context_menu ) {\n\t\t// \tvar context_menu_id = 'contextmenu-' + this.edit_view_tab.attr( 'id' );\n\t\t// \tthis.edit_view_context_menu = new ContextMenuManager( context_menu_id ); // #VueContextMenu# Initialize Vue ContextMenuManager here so that each view has their own unique one. Currently we are sharing one contextmenu, but most views use their own context menu manager instance. (Not required, just simplifies the refactor for now, and it might be used in future).\n\t\t//\n\t\t// \t// Create dynamic container for the vue context menu\n\t\t// \t// this.edit_view_context_menu.setContextMenuId( 'contextmenu-' + this.edit_view_tab.attr( 'id' ) ); // TODO: Potentially move this into param for constructor.\n\t\t// \tthis.edit_view_tab.prepend('<div id=\"'+ this.edit_view_context_menu.menu_id +'\"></div>');\n\t\t//\n\t\t// \t// Create and mount unique context menu for this view.\n\t\t// \tthis.edit_view_context_menu.mountContextMenu( '#' + this.edit_view_context_menu.menu_id );\n\t\t//\n\t\t// } else {\n\t\t// \t// If each view has a unique context menu, then this should never happen, as context menu should only be initiated once.\n\t\t// \t// However, there are many cases where tabs repeatedly call this.buildContextMenu, whilst keeping the same view controller, so this is now a warning rather than an error.\n\t\t// \tDebug.Text( 'Context Menu Manager already exists for: '+ this.viewId, 'BaseViewController.js', 'BaseViewController', 'buildContextMenu', 10 );\n\t\t// }\n\n\t\tthis.buildEditViewUI();\n\n\t\t$this.setEditViewTabHeight();\n\t\tTTPromise.wait( 'init', 'init', function() {\n\t\t\t$( '.edit-view-tab-bar' ).css( 'opacity', 1 );\n\t\t} );\n\t}\n\n\tsetEditViewTabHeight() {\n\t\tvar $this = this;\n\t}\n\n\t//Call this after initEditViewUI, usually after current_edit_record is set\n\tinitEditView() {\n\t\tthis.show_warning_when_validation = false;\n\t\t//Uncaught TypeError: Cannot read property 'find' of null in Timehseet Authorization view when quickly click Cancel from replay\n\t\tif ( !this.edit_view_tab ) {\n\t\t\treturn;\n\t\t}\n\t\tthis.setURL();\n\n\t\tthis.setEditMenu(); //This is done in onTabeShow() later on, so it can probably be removed from here?\n\t\t//Remove cover once edit menu is set\n\t\tProgressBar.closeOverlay();\n\n\t\t//Error: Unable to get property 'find' of undefined or null reference in /interface/html5/views/BaseViewController.js?v=7.4.6-20141027-074127 line 2055\n\t\tif ( this.edit_view_tab ) {\n\t\t\tthis.edit_view_tab.find( 'ul li' ).show(); // All tabs are hidden when initEditView UI, show all of them before set status\n\t\t}\n\t\tthis.setTabStatus();\n\t\tthis.clearEditViewData();\n\t\tthis.setEditViewWidgetsMode();\n\t\tthis.setEditViewData();\n\t\tthis.setCustomFields();\n\t\tthis.setFocusToFirstInput();\n\n\t\t// Overrides form with data from push notification and http get variables.\n\t\tif ( !this.is_report ) { //Report runs autofill at a later time.\n\t\t\tthis.fillCurrentRecord();\n\t\t}\n\t}\n\n\tsetCustomFields() {\n\t\tvar parent_table = this.getCustomFieldParentTable();\n\n\t\tif ( Global.getFeatureFlag( 'custom_field' ) == false || LocalCacheData.getCustomFieldData().parent_tables.includes( parent_table ) == false ) {\n\t\t\treturn;\n\t\t}\n\n\t\tTTPromise.wait( 'BaseViewController', 'getCustomFields', function() {\n\t\t\tif ( Array.isArray( this.custom_fields ) ) {\n\t\t\t\tthis.custom_fields.forEach( ( custom_field ) => {\n\t\t\t\t\tthis.buildCustomFieldUI( this.getPrefixedCustomFieldID( custom_field.id ), custom_field.name, custom_field.type_id, custom_field.meta_data );\n\t\t\t\t} );\n\n\t\t\t\tthis.editFieldResize( 0 );\n\t\t\t}\n\n\t\t\tthis.resetLastWidgetStyle();\n\t\t}.bind( this ) );\n\t}\n\n\tgetPrefixedCustomFieldID( id ) {\n\t\treturn 'custom_field-' + id;\n\t}\n\n\tgetCustomFieldsForView() {\n\t\tvar $this = this;\n\t\tvar parent_table = this.getCustomFieldParentTable();\n\n\t\tif ( Global.getFeatureFlag( 'custom_field' ) == false || LocalCacheData.getCustomFieldData().parent_tables.includes( parent_table ) == false ) {\n\t\t\tTTPromise.resolve( 'BaseViewController', 'getCustomFields' );\n\t\t\treturn;\n\t\t}\n\n\t\tvar filter = { filter_data: { parent_table: parent_table, status_id: 10 }, filter_sort: { display_order: 'asc', created_date: 'asc', id: 'asc' } };\n\n\t\tthis.custom_field_api.getCustomField( filter, true, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar res_data = result.getResult();\n\t\t\t\tif ( Array.isArray( res_data ) ) {\n\t\t\t\t\t$this.custom_fields = res_data;\n\t\t\t\t}\n\n\t\t\t\tTTPromise.resolve( 'BaseViewController', 'getCustomFields' );\n\t\t\t}\n\t\t} );\n\t}\n\n\tgetCustomFieldReferenceField() {\n\t\treturn false;\n\t}\n\n\tbuildCustomFieldUI( field, label, type_id, meta_data ) {\n\n\t\tif ( !type_id ) {\n\t\t\treturn; //User does not have permissions to use custom fields\n\t\t}\n\n\t\tfield = this.convertCustomFieldFieldId( type_id, field );\n\n\t\tif ( this.getCustomFieldParentTable() === 'punch_control' ) {\n\t\t\t//Permissions can be dynamic for punch control custom fields and we need to check for them.\n\t\t\t//Permissions are for the non-'_id' custom fields.\n\t\t\tlet custom_field_id = field.replace( '_id', '' );\n\t\t\tif ( PermissionManager.validate( this.permission_id, 'edit_' + custom_field_id ) == false ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tif ( !this.edit_view_tab ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar form_item_input;\n\t\tvar $this = this;\n\t\tvar tab0 = $( this.edit_view_tab.find( '.edit-view-tab-outside' )[0] );\n\t\tvar tab0_column1 = tab0.find( '.first-column' );\n\n\t\tif ( $this.edit_view_ui_dic[field] ) {\n\t\t\tform_item_input = $this.edit_view_ui_dic[field];\n\t\t\tform_item_input.setValue( $this.current_edit_record[field] );\n\t\t} else {\n\t\t\tlet form_array = $this.getCustomFieldFormInputByType( type_id, field, meta_data );\n\t\t\tform_item_input = form_array[0];\n\t\t\tlet widget_container = form_array[1];\n\n\t\t\tvar input_div = $this.addEditFieldToColumn( label, form_item_input, tab0_column1, '', widget_container );\n\t\t\tif ( this.getCustomFieldReferenceField() !== false && $this.edit_view_ui_dic[this.getCustomFieldReferenceField()] != undefined ) {\n\t\t\t\tinput_div.insertBefore( $this.edit_view_ui_dic[this.getCustomFieldReferenceField()].parent().parent() );\n\t\t\t}\n\n\t\t\tif ( this.current_edit_record ) {\n\t\t\t\tform_item_input.setValue( this.current_edit_record[field] );\n\t\t\t}\n\t\t}\n\t\tform_item_input.css( 'opacity', 1 );\n\n\t\tif ( $this.is_viewing ) {\n\t\t\tform_item_input.setEnabled( false );\n\t\t} else {\n\t\t\tform_item_input.setEnabled( true );\n\t\t}\n\n\t\tif ( this.is_mass_editing ) {\n\t\t\tform_item_input.setMassEditMode( true );\n\t\t}\n\t}\n\n\tconvertCustomFieldFieldId( type_id, field ) {\n\t\tif ( LocalCacheData.getCustomFieldData().conversion_field_types[type_id] ) {\n\t\t\treturn field + '_id';\n\t\t}\n\t\treturn field;\n\t}\n\n\tgetCustomFieldFormInputByType( type_id, field, meta_data ) {\n\t\tlet form_item_input;\n\t\tlet widget_container = null;\n\n\t\ttype_id = parseInt( type_id ); //Switch is strict on type, so we need to parseInt()\n\n\t\tswitch ( type_id ) {\n\t\t\tcase 100: //Text\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tform_item_input.TTextInput( { field: field } );\n\t\t\t\tform_item_input.css( 'minWidth', 300 );\n\t\t\t\tbreak;\n\t\t\tcase 110: //Textarea\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\t\t\t\tform_item_input.TTextArea( { field: field, width: '100%' } );\n\t\t\t\tbreak;\n\t\t\tcase 400: //Integer\n\t\t\tcase 410: //Decimal\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tform_item_input.TTextInput( { field: field } );\n\t\t\t\tform_item_input.css( 'minWidth', 300 );\n\t\t\t\tbreak;\n\t\t\tcase 420: //Currency\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tform_item_input.TTextInput( { field: field } );\n\t\t\t\tform_item_input.css( 'minWidth', 300 );\n\n\t\t\t\tvar widgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\t\t\tlet currency = $( '<span class=\\'widget-left-label\\'></span>' );\n\t\t\t\tlet code = $( '<span class=\\'widget-right-label\\'></span>' );\n\n\t\t\t\twidgetContainer.append( currency );\n\t\t\t\twidgetContainer.append( form_item_input );\n\t\t\t\twidgetContainer.append( code );\n\t\t\t\tbreak;\n\t\t\tcase 500: //Checkbox\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\t\tform_item_input.TCheckbox( { field: field } );\n\t\t\t\tbreak;\n\t\t\tcase 1000: //Date\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\t\t\tform_item_input.TDatePicker( { field: field } );\n\t\t\t\tbreak;\n\t\t\tcase 1010: //Date Range\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\t\t\tform_item_input.TRangePicker( { field: field, validation_field: 'date_stamp' } );\n\t\t\t\tbreak;\n\t\t\tcase 1100: //Time\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TIME_PICKER );\n\t\t\t\tform_item_input.TTimePicker( { field: field } );\n\t\t\t\tbreak;\n\t\t\tcase 1110: //Time Range\n\t\t\t\t//TODO: Jeremy Time Range\n\t\t\t\tbreak;\n\t\t\tcase 1200: //Datetime\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\t\t\tform_item_input.TDatePicker( { field: field, mode: 'date_time' } );\n\t\t\t\tbreak;\n\t\t\tcase 1300: //Time Unit\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tform_item_input.TTextInput( { field: field, width: 120, mode: 'time_unit', need_parser_sec: true } );\n\t\t\t\tbreak;\n\t\t\tcase 2100: //Single-select Dropdown\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\t\tform_item_input.AComboBox( {\n\t\t\t\t\tallow_multiple_selection: false,\n\t\t\t\t\tlayout_name: 'global_option_column', //Need dynamic layout name? global_option_column\n\t\t\t\t\tshow_search_inputs: true,\n\t\t\t\t\tset_empty: true,\n\t\t\t\t\tfield: field\n\t\t\t\t} );\n\t\t\t\t//Issue #3338 - Need to clone multi_select_items to prevent it from being modified by AComboBox when it adds the \"-- None --\" option.\n\t\t\t\tform_item_input.setSourceData( _.clone( meta_data.validation.multi_select_items ) );\n\t\t\t\tbreak;\n\t\t\tcase 2110: //Multi-select Dropdown\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\t\tform_item_input.AComboBox( {\n\t\t\t\t\tallow_multiple_selection: true,\n\t\t\t\t\tlayout_name: 'global_option_column', //Need dynamic layout name? global_option_column\n\t\t\t\t\tshow_search_inputs: true,\n\t\t\t\t\tset_empty: true,\n\t\t\t\t\tfield: field\n\t\t\t\t} );\n\t\t\t\t//Issue #3338 - Need to clone multi_select_items to prevent it from being modified by AComboBox when it adds the \"-- None --\" option.\n\t\t\t\tform_item_input.setSourceData( _.clone( meta_data.validation.multi_select_items ) );\n\t\t}\n\n\t\treturn [form_item_input, widget_container];\n\t}\n\n\tresetLastWidgetStyle() {\n\n\t\tif ( !this.edit_view_tab || !this.edit_view ) {\n\t\t\treturn;\n\t\t}\n\t}\n\n\tgetCustomFieldParentTable() {\n\t\t//Punch views get their custom fields from the punch_control table.\n\t\tif ( this.table_name_key === 'punch' ) {\n\t\t\treturn 'punch_control';\n\t\t} else if ( this.viewId === 'TimeSheet' ) { //Timesheet view does not declare a table_name_key\n\t\t\treturn 'punch_control';\n\t\t}\n\n\t\treturn this.table_name_key;\n\t}\n\n\tsetURL() {\n\t\tvar a = '';\n\t\tswitch ( LocalCacheData.current_doing_context_action ) {\n\t\t\tcase 'new':\n\t\t\tcase 'edit':\n\t\t\tcase 'view':\n\t\t\t\ta = LocalCacheData.current_doing_context_action;\n\t\t\t\tbreak;\n\t\t\tcase 'copy_as_new':\n\t\t\t\ta = 'new';\n\t\t\t\tbreak;\n\t\t}\n\t\tif ( this.canSetURL() ) {\n\n\t\t\tvar tab_name = this.edit_view_tab ? this.edit_view_tab.find( '.edit-view-tab-bar-label' ).children().eq( this.getEditViewTabIndex() ).text() : '';\n\t\t\ttab_name = tab_name.replace( /\\/|\\s+/g, '' );\n\n\t\t\t//Error: Unable to get property 'id' of undefined or null reference in /interface/html5/views/BaseViewController.js?v=8.0.0-20141117-132941 line 2234\n\t\t\tif ( this.current_edit_record && this.current_edit_record.id ) {\n\t\t\t\tif ( a ) {\n\t\t\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + '#!m=' + this.viewId + '&a=' + a + '&id=' + this.current_edit_record.id + '&tab=' + tab_name );\n\t\t\t\t} else {\n\t\t\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + '#!m=' + this.viewId + '&id=' + this.current_edit_record.id );\n\t\t\t\t}\n\n\t\t\t\tGlobal.trackView( this.viewId, LocalCacheData.current_doing_context_action );\n\t\t\t} else {\n\t\t\t\tif ( a ) {\n\n\t\t\t\t\t//Edit a record which don't have id, schedule view Recurring Scedule\n\t\t\t\t\tif ( a === 'edit' ) {\n\t\t\t\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + '#!m=' + this.viewId + '&a=' + 'new' +\n\t\t\t\t\t\t\t'&tab=' + tab_name );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + '#!m=' + this.viewId + '&a=' + a +\n\t\t\t\t\t\t\t'&tab=' + tab_name );\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + '#!m=' + this.viewId );\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\n\tcanSetURL() {\n\t\tif ( this.sub_view_mode || this.edit_only_mode ) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tsetFocusToFirstInput() {\n\t\t//Do not set focus to first input in unit test mode as it causes a blink that is inconsistent in screenshots. Also disable on mobile mode so its not a jarring experience with the zoom changes on each page\n\t\tif ( Global.UNIT_TEST_MODE || $( 'body' ).hasClass( 'mobile-device-mode' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !this.is_viewing ) {\n\t\t\tif ( this.script_name === 'ScheduleView' ) {\n\t\t\t\tif ( this.edit_view_ui_dic.start_time ) {\n\t\t\t\t\tthis.edit_view_ui_dic.start_time.children().eq( 0 ).focus();\n\t\t\t\t\tthis.edit_view_ui_dic.start_time.children().eq( 0 )[0].select();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor ( var key in this.edit_view_ui_dic ) {\n\n\t\t\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tvar widget = this.edit_view_ui_dic[key];\n\n\t\t\t\t\tif ( widget.is( ':visible' ) === true ) {\n\t\t\t\t\t\tif ( widget.hasClass( 't-text-input' ) && !widget.attr( 'readonly' ) ) {\n\t\t\t\t\t\t\twidget.focus();\n\t\t\t\t\t\t\twidget[0].select();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t} else if ( widget.hasClass( 't-time-picker-div' ) && !widget.children().eq( 0 ).attr( 'readonly' ) ) {\n\t\t\t\t\t\t\twidget.children().eq( 0 ).focus();\n\t\t\t\t\t\t\twidget.children().eq( 0 )[0].select();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t} else if ( widget.hasClass( 't-date-picker-div' ) && !widget.children().eq( 0 ).attr( 'readonly' ) ) {\n\t\t\t\t\t\t\twidget.children().eq( 0 ).focus();\n\t\t\t\t\t\t\twidget.children().eq( 0 )[0].select();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\n\tinitNavigationWidget( navigation_widget_div ) {\n\t\tif ( !this.navigation ) {\n\t\t\tthis.navigation = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tnavigation_widget_div.append( this.navigation );\n\t\t} else {\n\t\t\tnavigation_widget_div.append( this.navigation );\n\t\t}\n\t\tthis.setNavigationArrowsStatus();\n\t}\n\n\tbuildEditViewUI() {\n\t\tvar $this = this;\n\n\t\t//No navigation when edit only mode\n\n\t\t// #VueContextMenu# After we add the edit_view to the page in initEditViewUI(), add the context menu (Vue needs a valid id in dom)\n\t\tif( ContextMenuManager.getMenu( this.determineContextMenuMountAttributes().id ) === undefined ) {\n\t\t\tthis.buildContextMenu();\n\t\t} else {\n\t\t\tDebug.Warn( 'Context Menu ('+ this.determineContextMenuMountAttributes().id +') already exists for: '+ this.viewId, 'BaseViewController.js', 'BaseViewController', 'buildEditViewUI', 10 );\n\t\t}\n\n\t\tif ( this.edit_view ) {\n\t\t\tif ( !this.edit_only_mode ) {\n\t\t\t\tvar navigation_div = this.edit_view.find( '.navigation-div' );\n\t\t\t\tvar label = navigation_div.find( '.navigation-label' );\n\t\t\t\tvar left_click = navigation_div.find( '.left-click' );\n\t\t\t\tvar right_click = navigation_div.find( '.right-click' );\n\t\t\t\tvar navigation_widget_div = navigation_div.find( '.navigation-widget-div' );\n\t\t\t\tthis.initNavigationWidget( navigation_widget_div );\n\t\t\t\tleft_click.attr( 'src', Global.getRealImagePath( 'images/left_arrow.svg' ) );\n\t\t\t\tright_click.attr( 'src', Global.getRealImagePath( 'images/right_arrow.svg' ) );\n\t\t\t\tlabel.text( this.navigation_label );\n\n\t\t\t}\n\n\t\t\tthis.edit_view_close_icon = this.edit_view.find( '.close-icon' );\n\t\t\tthis.edit_view_close_icon.hide();\n\n\t\t\tthis.edit_view_close_icon.click( function() {\n\t\t\t\t$this.onCloseIconClick();\n\t\t\t} );\n\t\t}\n\n\t\tif( this.edit_only_mode ) {\n\n\t\t}\n\n\t\tthis.edit_view_ui_dic = {};\n\t\tthis.edit_view_ui_validation_field_dic = {};\n\t\tthis.edit_view_form_item_dic = {};\n\t\tthis.edit_view_error_ui_dic = {};\n\t}\n\n\tonCloseIconClick() {\n\t\tthis.onCancelClick();\n\t\tGlobal.triggerAnalyticsNavigationOther( 'close-X', 'click', this.viewId );\n\t}\n\n\tsetWidgetVisible( widgets ) {\n\t\tvar widget = widgets;\n\t\tif ( Global.isArray( widgets ) ) {\n\t\t\tfor ( var i = 0; i < widgets.length; i++ ) {\n\t\t\t\twidget = widgets[i];\n\t\t\t\twidget.css( 'opacity', 1 );\n\t\t\t}\n\t\t} else {\n\t\t\twidget.css( 'opacity', 1 );\n\t\t}\n\t}\n\n\t//widgetContainer: add widget to custom container\n\t//saveFormItemDiv: if cache current formItemDiv and use it later\n\taddEditFieldToColumn( label, widgets, column, firstOrLastRecord, widgetContainer, saveFormItemDiv, setResizeEvent, saveFormItemDivKey, hasKeyEvent, customLabelWidget ) {\n\n\t\tvar $this = this;\n\t\tvar form_item = $( Global.loadWidgetByName( WidgetNamesDic.EDIT_VIEW_FORM_ITEM ) );\n\t\tvar form_item_label_div = form_item.find( '.edit-view-form-item-label-div' );\n\t\tvar form_item_label = form_item.find( '.edit-view-form-item-label' );\n\t\tvar form_item_input_div = form_item.find( '.edit-view-form-item-input-div' );\n\t\tvar widget = widgets;\n\n\t\tif ( Global.isArray( widgets ) ) {\n\t\t\tfor ( var i = 0; i < widgets.length; i++ ) {\n\t\t\t\twidget = widgets[i];\n\t\t\t\twidget.css( 'opacity', 0 );\n\t\t\t}\n\t\t} else {\n\t\t\twidget.css( 'opacity', 0 );\n\t\t}\n\n\t\tif ( customLabelWidget ) {\n\t\t\tform_item_label.parent().append( customLabelWidget );\n\t\t\tform_item_label.remove();\n\t\t} else {\n\t\t\tform_item_label.text( label ); // Remove ':' to match Figma design.\n\t\t\tif ( label && label.indexOf( '\\n' ) !== -1 ) {\n\t\t\t\tform_item_label.html( form_item_label.html().replace( /\\n/g, '<br>' ) ); //Allow newlines (\\n) to be accepted in labels. Used by T4 Report. Use this instead of .html() directly as its introduces XSS\n\t\t\t}\n\t\t}\n\n\t\tif ( Global.isSet( widgetContainer ) ) {\n\n\t\t\tform_item_input_div.append( widgetContainer );\n\n\t\t} else {\n\t\t\tform_item_input_div.append( widget );\n\t\t}\n\n\t\tcolumn.append( form_item );\n\n\t\t//set height to text area\n\t\tif ( form_item.height() > 35 ) {\n\t\t\tform_item_label_div.css( 'height', form_item.height() );\n\t\t} else if ( widget.hasClass( 'a-dropdown' ) ) {\n\t\t\tform_item_label_div.css( 'height', 240 );\n\t\t}\n\n\t\t//these aren't hit uniformly for every field so the vertical resize events will be disabled in unit test mode.\n\t\tif ( setResizeEvent && !Global.UNIT_TEST_MODE ) {\n\t\t\tform_item.unbind( 'resize' ).bind( 'resize', function() {\n\t\t\t\t//When switching tabs, the heights are all -1, which causes \"flashing\" when the user returns back to the original tab and all the heights need to be set again.\n\t\t\t\t//  To prevent this, only change heights if they are > 0.\n\t\t\t\tif ( form_item_label_div.height() !== form_item.height() && form_item.height() > 0 ) {\n\t\t\t\t\tform_item_label_div.css( 'height', form_item.height() );\n\t\t\t\t}\n\t\t\t} );\n\t\t\t// This causes extreme (10x) performance degradation on Bootstrap 5.1.0 and later, especially on edit pay stubs. (Related TText setResizeEvent call)\n\t\t\t// widget.unbind( 'setSize' ).bind( 'setSize', function() {\n\t\t\t// \tform_item_label_div.css( 'height', widget.height() + 10 );\n\t\t\t// } );\n\t\t}\n\n\t\tif ( !label ) {\n\t\t\tform_item_input_div.remove();\n\t\t\tform_item_label_div.remove();\n\n\t\t\tform_item.append( widget );\n\t\t\twidget.css( 'opacity', 1 );\n\n\t\t\tif ( saveFormItemDiv && saveFormItemDivKey ) {\n\t\t\t\tthis.edit_view_form_item_dic[saveFormItemDivKey] = form_item;\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif ( saveFormItemDiv ) {\n\n\t\t\tif ( Global.isArray( widgets ) ) {\n\t\t\t\tthis.edit_view_form_item_dic[widgets[0].getField()] = form_item;\n\t\t\t} else {\n\t\t\t\tthis.edit_view_form_item_dic[widget.getField()] = form_item;\n\t\t\t}\n\n\t\t}\n\t\tif ( Global.isArray( widgets ) ) {\n\n\t\t\tfor ( var i = 0; i < widgets.length; i++ ) {\n\t\t\t\twidget = widgets[i];\n\t\t\t\tthis.edit_view_ui_dic[widget.getField()] = widget;\n\t\t\t\tsetValidationDic();\n\n\t\t\t\twidget.unbind( 'formItemChange' ).bind( 'formItemChange', function( e, target, doNotValidate ) {\n\t\t\t\t\t$this.onFormItemChange( target, doNotValidate );\n\t\t\t\t} );\n\n\t\t\t\tif ( hasKeyEvent ) {\n\t\t\t\t\twidget.unbind( 'formItemKeyUp' ).bind( 'formItemKeyUp', function( e, target ) {\n\t\t\t\t\t\t$this.onFormItemKeyUp( target );\n\t\t\t\t\t} );\n\n\t\t\t\t\twidget.unbind( 'formItemKeyDown' ).bind( 'formItemKeyDown', function( e, target ) {\n\t\t\t\t\t\t$this.onFormItemKeyDown( target );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.edit_view_ui_dic[widget.getField()] = widget;\n\t\t\tsetValidationDic();\n\n\t\t\twidget.bind( 'formItemChange', function( e, target, doNotValidate ) {\n\t\t\t\t$this.onFormItemChange( target, doNotValidate );\n\t\t\t} );\n\n\t\t\tif ( hasKeyEvent ) {\n\t\t\t\twidget.bind( 'formItemKeyUp', function( e, target ) {\n\t\t\t\t\t$this.onFormItemKeyUp( target );\n\t\t\t\t} );\n\n\t\t\t\twidget.bind( 'formItemKeyDown', function( e, target ) {\n\t\t\t\t\t$this.onFormItemKeyDown( target );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t\tfunction setValidationDic() {\n\t\t\tif ( widget.hasOwnProperty( 'getValidationField' ) && widget.getValidationField() ) {\n\t\t\t\tif ( $this.edit_view_ui_validation_field_dic[widget.getValidationField()] ) {\n\t\t\t\t\tif ( !Global.isArray( $this.edit_view_ui_validation_field_dic[widget.getValidationField()] ) ) {\n\t\t\t\t\t\t$this.edit_view_ui_validation_field_dic[widget.getValidationField()] = [$this.edit_view_ui_validation_field_dic[widget.getValidationField()], widget];\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.edit_view_ui_validation_field_dic[widget.getValidationField()].push( widget );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$this.edit_view_ui_validation_field_dic[widget.getValidationField()] = widget;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\treturn form_item;\n\t}\n\n\t//Set fields label to same size\n\teditFieldResize( index ) {\n\n\t\tif ( Global.isSet( index ) ) {\n\n\t\t} else {\n\t\t\tindex = this.getEditViewTabIndex();\n\t\t}\n\n\t\tif ( Global.isSet( this.edit_view_tabs[index] ) && !Global.isFalseOrNull( this.edit_view_tabs[index] ) && this.edit_view_tabs[index].length > 0 ) {\n\t\t\tvar tab_div = this.edit_view_tabs[index];\n\t\t\tfor ( var i = 0; i < tab_div.length; i++ ) {\n\t\t\t\tvar tab_column_div = tab_div[i].find( '.edit-view-form-item-label-div' );\n\t\t\t\tvar tab_column_sub_div = tab_div[i].find( '.edit-view-form-item-sub-label-div > span' );\n\t\t\t\tif ( Global.isSet( tab_column_sub_div ) && tab_column_sub_div.length > 0 ) {\n\t\t\t\t\tthis.setEditFieldSize( tab_column_sub_div );\n\t\t\t\t}\n\t\t\t\tthis.setEditFieldSize( tab_column_div );\n\t\t\t}\n\t\t}\n\t}\n\n\tsetEditFieldSize( tab_column_div, width ) {\n\n\t\tif ( Global.isSet( width ) ) {\n\n\t\t\ttab_column_div.each( function() {\n\t\t\t\t$( this ).width( width );\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\tvar item_label_div_width = [];\n\t\t\ttab_column_div.each( function() {\n\n\t\t\t\tif ( $( this ).width() === 0 ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\t$( this ).css( 'width', 'auto' );\n\n\t\t\t\titem_label_div_width.push( $( this ).width() );\n\t\t\t} );\n\n\t\t\titem_label_div_width.sort( function( a, b ) {\n\t\t\t\treturn ( b - a );\n\t\t\t} );\n\n\t\t\ttab_column_div.each( function() {\n\t\t\t\tif ( item_label_div_width[0] >= 0 ) { // #2701 - Do not set width if value is negative. Happens when trying to calculate width of something on another tab not currently visible.\n\t\t\t\t\t$( this ).width( item_label_div_width[0] + 1 );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tsetNavigation() {\n\n\t\tvar $this = this;\n\n\t\t//Error: Unable to get value of the property 'getGridParam': object is null or undefined in /interface/html5/views/BaseViewController.js?v=8.0.0-20141230-103725 line 2575\n\t\tif ( !this.grid ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.navigation.setPossibleDisplayColumns( this.buildDisplayColumnsByColumnModel( this.grid.getColumnModel() ), this.buildDisplayColumns( this.default_display_columns ) );\n\t\tthis.navigation.unbind( 'onClose' ).bind( 'onClose', () => {\n\t\t\tthis.setNavigationArrowsEnabled();\n\t\t} );\n\t\tthis.navigation.unbind( 'formItemChange' ).bind( 'formItemChange', function( e, target ) {\n\n\t\t\tvar key = target.getField();\n\t\t\tvar next_select_item_id = target.getValue();\n\n\t\t\tif ( !next_select_item_id ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( next_select_item_id !== $this.current_edit_record.id ) {\n\t\t\t\tProgressBar.showOverlay();\n\n\t\t\t\tif ( $this.is_viewing ) {\n\t\t\t\t\t$this.onViewClick( next_select_item_id ); //Dont refresh UI\n\t\t\t\t} else {\n\t\t\t\t\t$this.onEditClick( next_select_item_id ); //Dont refresh UI\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tGlobal.triggerAnalyticsEditViewNavigation( 'navigation', $this.viewId );\n\n\t\t} );\n\t}\n\n\tclearEditViewData() {\n\t\tfor ( var key in this.edit_view_ui_dic ) {\n\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif ( _.isFunction( this.edit_view_ui_dic[key].setEmptyValueAndShowLoading ) ) {\n\t\t\t\tthis.edit_view_ui_dic[key].setEmptyValueAndShowLoading();\n\t\t\t} else {\n\t\t\t\tthis.edit_view_ui_dic[key].setValue( null );\n\t\t\t}\n\t\t\tthis.edit_view_ui_dic[key].clearErrorStyle();\n\t\t}\n\t}\n\n\t//Called after set current_edit_record\n\tsetEditViewData() {\n\t\tthis.is_changed = false;\n\t\tthis.initEditViewData();\n\t\tthis.initTabData();\n\t\tthis.switchToProperTab();\n\t}\n\n\tswitchToProperTab() {\n\t\tif ( LocalCacheData.getAllURLArgs() &&\n\t\t\tLocalCacheData.getAllURLArgs().hasOwnProperty( 'tab' ) &&\n\t\t\tLocalCacheData.getAllURLArgs().tab.length > 0 &&\n\t\t\tLocalCacheData.current_open_primary_controller.viewId === this.viewId ) {\n\n\t\t\tvar target_node = this.edit_view_tab.find( '.edit-view-tab-bar-label' ).children().filter( function() {\n\t\t\t\tvar value = $( this ).text().replace( /\\/|\\s+/g, '' );\n\t\t\t\treturn value === LocalCacheData.getAllURLArgs().tab;\n\t\t\t} );\n\n\t\t\tvar target_index = 0;\n\t\t\tif ( target_node.length > 0 ) {\n\t\t\t\ttarget_node = $( target_node[0] );\n\t\t\t\ttarget_index = target_node.index();\n\t\t\t}\n\t\t\tthis.edit_view_tab.tabs( 'option', 'active', target_index );\n\t\t}\n\t}\n\n\t//Call this from setEditViewData\n\t// This is called to initialize data for the first/primary tab, and is called from many views. So it needs to stay even after fully refactored to use tab_model.\n\tinitTabData() {\n\t\tvar tab_model = this.getTabModel();\n\t\tif ( tab_model != null ) {\n\t\t\tthis.onTabShow();\n\t\t} else {\n\t\t\tvar current_tab_index = this.getEditViewTabIndex();\n\t\t\t//Handle most case that one tab and one audit tab\n\t\t\tif ( current_tab_index === 1 ) {\n\t\t\t\tif ( this.current_edit_record.id && this.current_edit_record.id != TTUUID.zero_id ) {\n\t\t\t\t\tthis.edit_view_tab.find( '#tab_audit' ).find( '.first-column-sub-view' ).css( 'display', 'block' );\n\t\t\t\t\tthis.initSubLogView( 'tab_audit' );\n\t\t\t\t} else {\n\t\t\t\t\tthis.edit_view_tab.find( '#tab_audit' ).find( '.first-column-sub-view' ).css( 'display', 'none' );\n\t\t\t\t\tthis.showSaveAndContinueButton();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetEditViewTabIndex() {\n\t\treturn this.edit_view.find( '.edit-view-tab-bar li.ui-tabs-active' ).index();\n\t}\n\n\tgetEditViewActiveTabName() {\n\t\tif( !this.edit_view ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this.edit_view.find( '.edit-view-tab-bar li.ui-tabs-active' ).attr( 'aria-controls' );\n\t}\n\n\tneedShowNavigation() {\n\t\tif ( this.current_edit_record && Global.isSet( this.current_edit_record.id ) && this.current_edit_record.id ) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t//Call this from setEditViewData\n\tinitEditViewData() {\n\t\tvar $this = this;\n\n\t\t//add this.grid to fix exception\n\t\t//Error: Unable to get property 'getGridParam' of undefined or null reference in /interface/html5/views/BaseViewController.js?v=7.4.3-20140924-090129 line 2523\n\t\tif ( !this.edit_only_mode && this.navigation && this.grid ) {\n\n\t\t\tvar grid_current_page_items = this.grid.getData();\n\n\t\t\tvar navigation_div = this.edit_view.find( '.navigation-div' );\n\n\t\t\t//Error: TypeError: this.current_edit_record is undefined in /interface/html5/views/BaseViewController.js?v=8.0.0-20141230-103725 line 2673\n\t\t\tif ( this.needShowNavigation() ) {\n\t\t\t\tnavigation_div.css( 'display', 'block' );\n\t\t\t\t//Set Navigation Awesomebox\n\n\t\t\t\t//#3175 - Get current navigation data if it exists so that we do not overwrite it when switching records.\n\t\t\t\t//For example when clicking the right arrow on the last record of page 1 brings you to page 2. Page 2 data was being reset.\n\t\t\t\t//In that scenario we want to keep navigation data from page 2 and not overwrite it with the grid data from the list view.\n\t\t\t\tlet current_navigation_data = this.navigation.getSourceData();\n\t\t\t\tlet current_pager_data = this.navigation.getPagerData();\n\n\t\t\t\t//#2349 - update source data every time so that it doesn't go unrefreshed in the case of saving a new record or deleting exiting\n\t\t\t\tthis.navigation.setSourceData( current_navigation_data ? current_navigation_data : grid_current_page_items );\n\t\t\t\tthis.navigation.setPagerData( current_pager_data ? current_pager_data: this.pager_data );\n\t\t\t\t//init navigation only when open edit view\n\t\t\t\tif ( !this.navigation.getSourceData() ) {\n\t\t\t\t\tif ( LocalCacheData.getLoginUserPreference() ) {\n\t\t\t\t\t\tthis.navigation.setRowPerPage( LocalCacheData.getLoginUserPreference().items_per_page );\n\t\t\t\t\t}\n\t\t\t\t\tthis.navigation.setPagerData( this.pager_data );\n\n\t\t\t\t\tvar default_args = {};\n\t\t\t\t\tdefault_args.filter_data = Global.convertLayoutFilterToAPIFilter( this.select_layout );\n\t\t\t\t\tdefault_args.filter_sort = this.select_layout.data.filter_sort;\n\t\t\t\t\tthis.navigation.setDefaultArgs( default_args );\n\t\t\t\t}\n\n\t\t\t\tthis.navigation.setValue( this.current_edit_record );\n\n\t\t\t} else {\n\t\t\t\tnavigation_div.css( 'display', 'none' );\n\t\t\t}\n\t\t}\n\n\t\tthis.setUIWidgetFieldsToCurrentEditRecord();\n\n\t\tif ( this.is_mass_editing ) {\n\t\t\tfor ( var key in this.edit_view_ui_dic ) {\n\n\t\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t//JS Exception: \"this.unique_columns.indexOf is not a function\"\n\t\t\t\tif ( this.unique_columns && this.unique_columns.length > 0 && this.unique_columns.indexOf( key ) != -1 ) {\n\t\t\t\t\t$this.edit_view_ui_dic[key].css( 'opacity', '0' );\n\t\t\t\t\tif ( $this.edit_view_ui_dic[key].setEnabled ) {\n\t\t\t\t\t\t$this.edit_view_ui_dic[key].setEnabled( false );\n\t\t\t\t\t}\n\t\t\t\t\tif ( $this.edit_view_ui_dic[key].setMassEditMode ) {\n\t\t\t\t\t\t$this.edit_view_ui_dic[key].setMassEditMode( false );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\t\t\tif ( Global.isSet( widget.setMassEditMode ) ) {\n\t\t\t\t\t\twidget.setMassEditMode( true );\n\t\t\t\t\t}\n\t\t\t\t\t$this.edit_view_ui_dic[key].css( 'opacity', '1' );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfor ( var key in this.edit_view_ui_dic ) {\n\t\t\t\t$this.edit_view_ui_dic[key].css( 'opacity', '1' );\n\t\t\t}\n\t\t}\n\n\t\tthis.setNavigationArrowsEnabled( true );\n\n\t\t// Create this function alone because of the column value of view is different from each other, some columns need to be handle specially. and easily to rewrite this function in sub-class.\n\n\t\tthis.setCurrentEditRecordData();\n\n\t\t//Init *Please save this record before modifying any related data* box\n\t\tthis.edit_view.find( '.save-and-continue-div' ).SaveAndContinueBox( { related_view_controller: this } );\n\t\tthis.edit_view.find( '.save-and-continue-div' ).css( 'display', 'none' );\n\t}\n\n\tsetUIWidgetFieldsToCurrentEditRecord() {\n\t\tvar $this = this;\n\n\t\t$this.old_current_edit_record = Global.clone( $this.current_edit_record ); //Save the current edit record before any changes are made so we can later check what fields may have changed.\n\n\t\tif ( $this.current_edit_record === true ) {\n\t\t\t$this.current_edit_record = {};\n\t\t};\n\n\t\tfor ( var key in this.edit_view_ui_dic ) {\n\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n//\t\t\t//Set all UI field to current edit record, we need validate all UI field when save and validate\n\t\t\t//use != to ingore string or number, value from html is string.\n\t\t\t//Error: TypeError: $this.current_edit_record is undefined in /interface/html5/views/BaseViewController.js?v=8.0.0-20141117-122453 line 2702\n\t\t\tif ( $this.current_edit_record && !Global.isSet( $this.current_edit_record[key] ) ) {\n\t\t\t\t$this.current_edit_record[key] = false;\n\t\t\t}\n\n\t\t}\n\t}\n\n\t/**\n\t * Set default data into current_edit_record\n\t *\n\t * @param columnsArr\n\t * @param force\n\t *\n\t * if force is true set the current_edit_record and populate edit_view_ui_dic\n\t * this is used in view controllers (RequestViewController::setRequestFormDefaultData) where the api call for default values is late\n\t *\n\t */\n\tsetDefaultData( columnsArr, force ) {\n\t\tvar $this = this;\n\t\t$.each( columnsArr, function( field, value ) {\n\t\t\tif ( force != true && Global.isSet( $this.current_edit_record[field] ) ) {\n\t\t\t\t//do nothing\n\t\t\t} else {\n\t\t\t\tif ( force == true ) {\n\t\t\t\t\tif ( $this.edit_view_ui_dic[field] ) {\n\t\t\t\t\t\t$this.edit_view_ui_dic[field].setValue( value );\n\t\t\t\t\t\t$this.current_edit_record[field] = value;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$this.current_edit_record[field] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tcollectUIDataToCurrentEditRecord() {\n\t\tif ( this.is_mass_editing ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar $this = this;\n\t\tfor ( var key in this.edit_view_ui_dic ) {\n\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\n\t\t\t//only check dropdownlist\n\t\t\tif ( !widget.hasClass( 't-select' ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar value = widget.getValue();\n\n//\t\t\t//Set all UI field to current edit record, we need validate all UI field when save and validate\n\t\t\t//use != to ingore string or number, value from html is string.\n\t\t\t//is visible make sure the widget is shown on screen of current select type\n\n\t\t\t//Error: TypeError: undefined is not an object (evaluating '$this.current_edit_record[key]') in /interface/html5/views/BaseViewController.js?v=8.0.0-20141230-124906 line 2792\n\t\t\tif ( value && $this.current_edit_record && $this.current_edit_record[key] != value ) {\n\n\t\t\t\tif ( !value || value === '0' || ( Global.isArray( value ) && value.length === 0 ) ) {\n\t\t\t\t\t$this.current_edit_record[key] = false;\n\t\t\t\t} else {\n\t\t\t\t\t$this.current_edit_record[key] = value;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\t}\n\n\tsetCurrentEditRecordData() {\n\t\t//Set current edit record data to all widgets\n\t\tfor ( var key in this.current_edit_record ) {\n\n\t\t\tif ( !this.current_edit_record.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\tif ( Global.isSet( widget ) ) {\n\t\t\t\tswitch ( key ) {\n\t\t\t\t\tcase 'country': //popular case\n\t\t\t\t\t\tthis.setCountryValue( widget, key );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tthis.collectUIDataToCurrentEditRecord();\n\t\tthis.setEditViewDataDone();\n\t}\n\n\tsetCountryValue( widget, key ) {\n\t\tif ( !this.current_edit_record['province'] ) {\n\t\t\tthis.eSetProvince( this.current_edit_record[key], true );\n\t\t} else {\n\t\t\tthis.eSetProvince( this.current_edit_record[key] );\n\t\t}\n\t\twidget.setValue( this.current_edit_record[key] );\n\t}\n\n\tputInputToInsideFormItem( form_item_input, label ) {\n\t\tvar form_item = $( Global.loadWidgetByName( WidgetNamesDic.EDIT_VIEW_SUB_FORM_ITEM ) );\n//\t\tvar form_item_label_div = form_item.find( '.edit-view-form-item-label-div' );\n//\n//\t\tform_item_label_div.attr( 'class', 'edit-view-form-item-sub-label-div' );\n\n\t\tvar form_item_label = form_item.find( '.edit-view-form-item-label' );\n\t\tvar form_item_input_div = form_item.find( '.edit-view-form-item-input-div' );\n\t\tform_item.addClass( 'remove-margin' );\n\n\t\tform_item_label.text( $.i18n._( label ) );\n\n\t\tform_item_input_div.append( form_item_input );\n\n\t\treturn form_item;\n\t}\n\n\t//set tab 0 visible after all data set done. This be hide when init edit view data\n\tsetEditViewDataDone() {\n\t\t// Remove this on 14.9.14 because adding tab url support, ned set url when tab index change and\n\t\t// need know waht's current doing action. See if this cause any problem\n\t\t//LocalCacheData.current_doing_context_action = '';\n\t\tthis.setTabOVisibility( true );\n\t\tTTPromise.resolve( 'init', 'init' );\n\n\t\t$( '.edit-view-tab-bar' ).css( 'opacity', 1 );\n\t}\n\n\tsetNavigationArrowsStatus() {\n\t\tif ( !this.edit_view ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar left_arrow = this.edit_view.find( '.left-click' );\n\t\tvar right_arrow = this.edit_view.find( '.right-click' );\n\t\tvar $this = this;\n\n\t\tleft_arrow.off( 'click' ).on( 'click', Global.debounce( function NavigationLeftArrowClick( e ) {\n\t\t\tif ( !left_arrow.hasClass( 'disabled' ) ) {\n\t\t\t\t$this.onLeftArrowClick();\n\t\t\t}\n\n\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork(), true ) );\n\n\t\tright_arrow.off( 'click' ).on( 'click', Global.debounce( function NavigationRightArrowClick( e ) {\n\t\t\tif ( !right_arrow.hasClass( 'disabled' ) ) {\n\t\t\t\t$this.onRightArrowClick();\n\t\t\t}\n\n\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork(), true ) );\n\t}\n\n\tsetNavigationArrowsEnabled( check_search ) {\n\t\tif ( !this.edit_view ) {\n\t\t\treturn;\n\t\t}\n\n\t\t//If search data exists, search when making a record change to ensure arrow status will reflect the search result\n\t\tif ( check_search && this.navigation && typeof this.navigation.buildUnSelectGridFilter == 'function' ) {\n\t\t\t//Run this condition first to avoid flashing arrows enabling/disabling.\n\t\t\tvar data = this.navigation.buildUnSelectGridFilter();\n\t\t\tif ( data && data.filter_data && Object.keys( data.filter_data ).length !== 0 ) {\n\t\t\t\tthis.navigation.onADropDownSearch( 'unselect_grid', undefined, undefined, () => {\n\t\t\t\t\tthis.setNavigationArrowsEnabled( false );\n\t\t\t\t} );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tvar left_arrow = this.edit_view.find( '.left-click' );\n\t\tvar right_arrow = this.edit_view.find( '.right-click' );\n\n\t\tleft_arrow.removeClass( 'disabled' );\n\t\tright_arrow.removeClass( 'disabled' );\n\n\t\t//TypeError: this.navigation.getSelectIndex is not a function\n\t\t//navigation could not be initial in cases, for example in Request new view\n\t\tif ( !this.navigation || !( this.navigation.hasOwnProperty( 'getSelectIndex' ) ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar selected_index = this.navigation.getSelectIndex();\n\t\tvar source_data = this.navigation.getSourceData();\n\n\t\tif ( !source_data || ( Array.isArray( source_data ) && source_data.length === 0 ) ) {\n\t\t\t//No records in navigation box, so make sure arrows are disbled.\n\t\t\tleft_arrow.addClass( 'disabled' );\n\t\t\tright_arrow.addClass( 'disabled' );\n\t\t\treturn;\n\t\t}\n\n\t\tvar current_pager_data = this.navigation.getPagerData();\n\n\t\t// It's possible the navigation don't have a pager data, like Timesheet edit view, so it's become a no page navigation.\n\t\tif ( !current_pager_data ) {\n\t\t\tif ( selected_index === 0 ) {\n\t\t\t\tleft_arrow.addClass( 'disabled' );\n\t\t\t}\n\n\t\t\tif ( selected_index === source_data.length - 1 ) {\n\t\t\t\tright_arrow.addClass( 'disabled' );\n\t\t\t}\n\t\t} else {\n\t\t\tif ( selected_index === 0 && current_pager_data.current_page === 1 ) {\n\t\t\t\tleft_arrow.addClass( 'disabled' );\n\t\t\t}\n\n\t\t\tif ( selected_index === source_data.length - 1 && current_pager_data.current_page === current_pager_data.last_page_number ) {\n\t\t\t\tright_arrow.addClass( 'disabled' );\n\t\t\t}\n\t\t}\n\t}\n\n\tonLeftArrowClick( cancel_callback ) {\n\t\tvar $this = this;\n\n\t\tif ( this.is_changed ) {\n\t\t\tTAlertManager.showConfirmAlert( Global.modify_alert_message, null, function( flag ) {\n\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t$this.is_changed = false;\n\t\t\t\t\tdoLeftArrowClick();\n\t\t\t\t}\n\t\t\t\tProgressBar.closeOverlay();\n\t\t\t} );\n\t\t} else {\n\t\t\tdoLeftArrowClick();\n\t\t}\n\n\t\tGlobal.triggerAnalyticsEditViewNavigation( 'left-arrow', this.viewId );\n\n\t\tfunction doLeftArrowClick() {\n\t\t\tvar selected_index = $this.navigation.getSelectIndex();\n\t\t\tvar source_data = $this.navigation.getSourceData();\n\t\t\tvar current_pager_data = $this.navigation.getPagerData();\n\t\t\tvar next_select_item;\n\t\t\tif ( selected_index > 0 ) {\n\t\t\t\tnext_select_item = $this.navigation.getItemByIndex( selected_index - 1 );\n\t\t\t\t$this.onRightOrLeftArrowClickCallBack( next_select_item );\n\t\t\t} else if ( selected_index === 0 && current_pager_data && current_pager_data.current_page > 1 ) {\n\t\t\t\t$this.navigation.onADropDownSearch( 'unselect_grid', current_pager_data.current_page - 1, 'last', function( result ) {\n\t\t\t\t\tnext_select_item = result;\n\t\t\t\t\t$this.onRightOrLeftArrowClickCallBack( next_select_item );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\t$this.onCancelClick( null, null, cancel_callback );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\trefreshCurrentRecord() {\n\t\tvar next_select_item = this.navigation.getItemByIndex( this.navigation.getSelectIndex() );\n\t\tProgressBar.showOverlay();\n\t\tif ( this.is_viewing ) {\n\t\t\tthis.onViewClick( next_select_item.id ); //Dont refresh UI\n\t\t} else {\n\t\t\tthis.onEditClick( next_select_item.id ); //Dont refresh UI\n\t\t}\n\n\t\tthis.setNavigationArrowsEnabled();\n\t}\n\n\t//exists for RecurringScheduleControlView due to the unique way we handle the ids there. (Change: That view no longer uses composite IDs)\n\tgetRightArrowClickSelectedIndex( selected_index ) {\n\t\treturn selected_index;\n\t}\n\n\tonRightArrowClick( cancel_callback ) {\n\t\tvar $this = this;\n\t\tif ( this.is_changed ) {\n\t\t\tTAlertManager.showConfirmAlert( Global.modify_alert_message, null, function( flag ) {\n\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t$this.is_changed = false;\n\t\t\t\t\tdoRightArrowClick();\n\t\t\t\t}\n\t\t\t\tProgressBar.closeOverlay();\n\t\t\t} );\n\t\t} else {\n\t\t\tdoRightArrowClick();\n\t\t}\n\n\t\tGlobal.triggerAnalyticsEditViewNavigation( 'right-arrow', this.viewId );\n\n\t\tfunction doRightArrowClick() {\n\t\t\tvar selected_index = $this.getRightArrowClickSelectedIndex( $this.navigation.getSelectIndex() );\n\t\t\tvar source_data = $this.navigation.getSourceData();\n\t\t\tvar current_pager_data = $this.navigation.getPagerData();\n\t\t\tvar next_select_item;\n\t\t\t//Error: Uncaught TypeError: Cannot read property 'length' of null in /interface/html5/views/BaseViewController.js?v=8.0.0-20141230-125919 line 2956\n\t\t\tif ( !source_data ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( selected_index < ( source_data.length - 1 ) ) {\n\t\t\t\t// next_select_item = $this.navigation.getItemByIndex( (selected_index + 1) );\n\t\t\t\tnext_select_item = $this.navigation.getItemByIndex( $this.navigation.getSelectIndex() + 1 );\n\t\t\t\t$this.onRightOrLeftArrowClickCallBack( next_select_item );\n\n\t\t\t\t//Error: Unable to get property 'current_page' of undefined or null reference in interface/html5/views/BaseViewController.js?v=9.0.0-20151016-102254 line 3204\n\t\t\t} else if ( selected_index === ( source_data.length - 1 ) && current_pager_data && current_pager_data.current_page < current_pager_data.last_page_number ) {\n\t\t\t\t$this.navigation.onADropDownSearch( 'unselect_grid', current_pager_data.current_page + 1, 'first', function( result ) {\n\t\t\t\t\tnext_select_item = result;\n\t\t\t\t\t$this.onRightOrLeftArrowClickCallBack( next_select_item );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\t$this.onCancelClick( null, null, cancel_callback );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tonRightOrLeftArrowClickCallBack( next_select_item ) {\n\t\tProgressBar.showOverlay();\n\t\tif ( this.is_viewing ) {\n\t\t\tthis.onViewClick( next_select_item ); //Dont refresh UI\n\t\t} else {\n\t\t\tthis.onEditClick( next_select_item.id ); //Dont refresh UI\n\t\t}\n\t\tthis.setNavigationArrowsEnabled();\n\t\tif ( this.sub_log_view_controller ) {\n\t\t\tthis.sub_log_view_controller.search();\n\t\t}\n\t}\n\n\tsetParentContextMenuAfterSubViewClose() {\n\t\t//Error: Uncaught TypeError: Cannot read property 'buildContextMenu' of null in /interface/html5/views/BaseViewController.js?v=7.4.6-20141027-085016 line 2887\n\t\tif ( !this.parent_view_controller ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.parent_view_controller.buildContextMenu();\n\n\t\tif ( this.parent_view_controller.edit_view ) {\n\t\t\tthis.parent_view_controller.setEditMenu();\n\t\t} else {\n\t\t\tthis.parent_view_controller.setDefaultMenu();\n\t\t}\n\t}\n\n\t//This should only be used on its own if removeEditView is causing flashing.\n\t//This function should only really be called from onViewClick (see RequestViewCommonController.js)\n\tclearEditView() {\n\t\tif ( this.edit_view ) {\n\t\t\tthis.clearErrorTips();\n\t\t\tthis.edit_view.remove();\n\t\t}\n\t\tthis.edit_view = null;\n\t\tthis.edit_view_tab = null;\n\t}\n\n\tremoveEditView() {\n\t\tthis.unmountContextMenu();\n\t\tthis.clearEditView();\n\t\tthis.setCurrentEditViewState( '' );\n\t\tthis.is_changed = false;\n\t\tthis.confirm_on_exit = false;\n\t\tthis.mass_edit_record_ids = [];\n\n\t\tif ( this.edit_only_mode ) {\n\t\t\tvar current_url = window.location.href;\n\t\t\tif ( current_url.indexOf( '&sm' ) > 0 ) {\n\t\t\t\tcurrent_url = current_url.substring( 0, current_url.indexOf( '&sm' ) );\n\t\t\t\tGlobal.setURLToBrowser( current_url );\n\t\t\t}\n\n\t\t\tLocalCacheData.current_open_edit_only_controller = null;\n\t\t}\n\n\t\t// reset parent context menu if edit only mode\n\n\t\tif ( !this.edit_only_mode ) {\n\t\t\t//#2777 - If the user goes to Employee -> Employees, click on Wage tab, then goes to Employee -> Employees again, the Context Menu will be incorrect and still be for the \"Wage\" record and not the proper \"Employee\" record.\n\t\t\t//This tries to detect when the context menu doesn't match the view and forces it to be rebuilt completely.\n\n\t\t\tthis.buildContextMenu( true );\n\t\t\tthis.setDefaultMenu();\n\t\t} else {\n\t\t\tthis.setParentContextMenuAfterSubViewClose();\n\t\t}\n\t\tthis.reSetURL();\n\t\t//If there is a action in url, add it back. So we have correct url when set tabs urls\n\t\t//This caused a bug where whenever saving a punch on Attendance ->TimeSheet, it would re-open the edit view, same with navigating between weeks, or even deleting punches in some cases.\n\t\t//This need to put under reSetUrl and need clean url_agrs until it set from onViewChange in router again\n\t\tif ( LocalCacheData.getAllURLArgs() && LocalCacheData.getAllURLArgs().a ) {\n\t\t\tLocalCacheData.current_doing_context_action = LocalCacheData.getAllURLArgs().a;\n\t\t}\n\n\t\tthis.sub_log_view_controller = null;\n\t\tthis.edit_view_ui_dic = {};\n\t\tthis.edit_view_ui_validation_field_dic = {};\n\t\tthis.edit_view_form_item_dic = {};\n\t\tthis.edit_view_error_ui_dic = {};\n\t\tthis.current_edit_record = null;\n\n\t\tif ( this.sub_document_view_controller ) {\n\t\t\tthis.sub_document_view_controller = null;\n\t\t}\n\t}\n\n\treSetURL() {\n\t\tif ( this.canSetURL() ) {\n\t\t\tvar args = '#!m=' + this.viewId;\n\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + args );\n\t\t\tLocalCacheData.setAllURLArgs( Global.buildArgDic( args.split( '&' ) ) );\n\t\t}\n\t}\n\n\tgetGridSelectIdArray() {\n\t\tif ( !this.grid ) {\n\t\t\treturn []; //Return empty array so .length on the result doesn't fail with Cannot read property 'length' of undefined\n\t\t}\n\n\t\treturn this.grid.getSelectedRows();\n\t}\n\n\tsetDefaultMenuAddIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.addPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\t}\n\n\tsetDefaultMenuEditIcon( context_btn, grid_selected_length, p_id ) {\n\t\tif ( !this.editPermissionValidate( p_id ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\n\t\t// Updated to toggle with mass edit icon in new menu - Note: This logic is duplicated in TimeSheetViewController.\n\t\tif ( grid_selected_length === 1 && this.editOwnerOrChildPermissionValidate( p_id ) ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, true );\n\t\t} else {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t\tif ( grid_selected_length !== 0 ) {\n\t\t\t\t// This ensures the edit icon is still visible when nothing is selected, but should still be disabled. (to keep consistency with old design)\n\t\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t\t}\n\t\t}\n\t}\n\n\tsetDefaultMenuViewIcon( context_btn, grid_selected_length, p_id ) {\n\t\tif ( !this.viewPermissionValidate( p_id ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tif ( grid_selected_length === 1 && this.viewOwnerOrChildPermissionValidate() ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, true );\n\t\t} else {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetDefaultMenuMassEditIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\n\t\t// updated to toggle with mass edit icon in new menu\n\t\tif ( grid_selected_length > 1 ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, true );\n\t\t} else {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetDefaultMenuCopyIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.copyPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tif ( grid_selected_length >= 1 ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, true );\n\t\t} else {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetDefaultMenuDeleteIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.deletePermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tif ( grid_selected_length >= 1 && this.deleteOwnerOrChildPermissionValidate( pId ) ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, true );\n\t\t} else {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetDefaultMenuDeleteAndNextIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.deletePermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t}\n\n\tsetDefaultMenuSaveIcon( context_btn, grid_selected_length, pId ) {\n\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t}\n\n\tsetDefaultMenuSaveAndNextIcon( context_btn, grid_selected_length, pId ) {\n\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t}\n\n\tsetDefaultMenuSaveAndCopyIcon( context_btn, grid_selected_length, pId ) {\n\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t}\n\n\tsetDefaultMenuSaveAndContinueIcon( context_btn, grid_selected_length, pId ) {\n\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t}\n\n\tsetDefaultMenuSaveAndAddIcon( context_btn, grid_selected_length, pId ) {\n\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t}\n\n\tsetDefaultMenuCopyAsNewIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( ( !this.copyAsNewPermissionValidate( pId ) ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tif ( grid_selected_length === 1 ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, true );\n\t\t} else {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetDefaultMenuLoginIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !PermissionManager.validate( 'company', 'login_other_user' ) ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tif ( this.getGridSelectIdArray().length !== 1 ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetDefaultMenuCancelIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.sub_view_mode ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetDefaultMenuExportIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( this.edit_only_mode || this.is_viewing || this.is_edit || this.is_add ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t} else if ( grid_selected_length == 0 || this.grid == undefined ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetDefaultMenuImportIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.addPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\t}\n\n\tsetDefaultMenuPermissionWizardIcon( context_btn, pId ) {\n\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t}\n\n\tsetEditMenuPermissionWizardIcon( context_btn, pId ) {\n\t}\n\n\tsetEditMenuImportIcon( context_btn ) {\n\t\tif ( this.edit_only_mode || this.is_viewing || this.is_edit || this.is_add ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuAddIcon( context_btn, pId ) {\n\t\tif ( !this.addPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tif ( this.is_add == true ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuEditIcon( context_btn, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) || this.edit_only_mode || this.is_mass_editing ) {\n\t\t\t//Not shown in edit only mode or mass edit. Mass edit should only show mass edit (need to set that part in mass edit icon).\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\n\t\tif ( !this.is_viewing || !this.editOwnerOrChildPermissionValidate( pId ) ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuNavEditIcon( context_btn, p_id ) {\n\t\tif ( !this.editPermissionValidate( p_id ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\t}\n\n\tsetEditMenuNavViewIcon( context_btn, p_id ) {\n\t\tif ( !this.viewPermissionValidate( p_id ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\t}\n\n\tsetEditMenuViewIcon( context_btn, pId ) {\n\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t}\n\n\tsetEditMenuMassEditIcon( context_btn, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) || this.edit_only_mode || !this.is_mass_editing ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t}\n\n\tsetEditMenuDeleteIcon( context_btn, pId ) {\n\t\tif ( !this.deletePermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) || !this.deleteOwnerOrChildPermissionValidate( pId ) ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuDeleteAndNextIcon( context_btn, pId ) {\n\t\tif ( !this.deletePermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) || !this.deleteOwnerOrChildPermissionValidate( pId ) ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuCopyIcon( context_btn, pId ) {\n\t\tif ( !this.copyPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tif ( !this.current_edit_record || !this.current_edit_record.id ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuCopyAndAddIcon( context_btn, pId ) {\n\t\tif ( !this.copyAsNewPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) || this.is_viewing ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuSaveIcon( context_btn, pId ) {\n\n\t\tthis.saveValidate( context_btn, pId );\n\n\t\tif ( this.is_viewing ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuSaveAndContinueIcon( context_btn, pId ) {\n\t\tthis.saveAndContinueValidate( context_btn, pId );\n\n\t\tif ( this.is_mass_adding || this.is_mass_editing || this.is_viewing ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuSaveAndCopyIcon( context_btn, pId ) {\n\t\tthis.saveAndCopyValidate( context_btn, pId );\n\n\t\tif ( this.is_mass_editing || this.is_viewing ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuSaveAndNextIcon( context_btn, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) || this.is_viewing ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuSaveAndAddIcon( context_btn, pId ) {\n\t\tthis.saveAndNewValidate( context_btn, pId );\n\n\t\tif ( this.is_viewing || this.is_mass_editing ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuCancelIcon( context_btn, pId ) {\n\t}\n\n\tifContextButtonExist( value ) {\n\t\tvar context_menu_array = ContextMenuManager.getMenuModelByMenuId( this.determineContextMenuMountAttributes().id );\n\t\tvar len = context_menu_array.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tlet context_btn = context_menu_array[i];\n\t\t\tlet id = context_menu_array[i].id;\n\t\t\tif ( id === value && context_btn.visible ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tonSubViewModeDisableParentContextMenuButtons() {\n\t\t//When on a sub view mode tab we want to disable certain context menu buttons of the parent view.\n\t\t//This is to help prevent users from using context menu buttons for the wrong view and deleting/copying records they did not intend to use.\n\t\tif ( this.sub_view_mode && this.parent_view_controller ) {\n\t\t\tvar parent_context_menu_array = ContextMenuManager.getMenuModelByMenuId( this.parent_view_controller.determineContextMenuMountAttributes().id );\n\t\t\tvar len = parent_context_menu_array.length;\n\n\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\tlet context_btn = parent_context_menu_array[i];\n\t\t\t\tlet id = parent_context_menu_array[i].id;\n\n\t\t\t\t//Switch instead of if/else incase we want differences between buttons in future, easier to read than long conditional.\n\t\t\t\tswitch ( id ) {\n\t\t\t\t\tcase 'add':\n\t\t\t\t\tcase 'delete_icon':\n\t\t\t\t\tcase 'delete_and_next':\n\t\t\t\t\tcase 'copy':\n\t\t\t\t\tcase 'copy_as_new':\n\t\t\t\t\tcase 'save_and_copy':\n\t\t\t\t\tcase 'save_and_new':\n\t\t\t\t\t\tContextMenuManager.disableMenuItem( this.parent_view_controller.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\thideJumpToMenu() {\n\t\t//Jump to should be hidden on all \"new\" record views and only available when editing a record.\n\t\t//This is to prevent users from using the jump to button to navigating to broken or blank pages.\n\t\tif ( this.is_add || this.is_mass_adding ) {\n\t\t\tvar context_menu_array = ContextMenuManager.getMenuModelByMenuId( this.determineContextMenuMountAttributes().id );\n\n\t\t\tfor ( var i = 0; i < context_menu_array.length; i++ ) {\n\t\t\t\tif ( context_menu_array[i].action_group === 'jump_to' ) {\n\t\t\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_menu_array[i].id, false );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t//Call this when select grid row\n\t//Call this when setLayout\n\tsetDefaultMenu( doNotSetFocus, grid_selected_length ) {\n\t\t//Check if there is a current_company object at all.\n\t\tif ( LocalCacheData.isLocalCacheExists( 'current_company' ) == false ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.setTotalDisplaySpan();\n\n\t\tvar context_menu_array = ContextMenuManager.getMenuModelByMenuId( this.determineContextMenuMountAttributes().id );\n\t\tvar len = context_menu_array.length;\n\t\tif ( grid_selected_length === undefined ) {\n\t\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\t\tgrid_selected_length = grid_selected_id_array.length;\n\t\t}\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tlet context_btn = context_menu_array[i];\n\t\t\tlet id = context_menu_array[i].id;\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, true );\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, true );\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase 'add':\n\t\t\t\t\tthis.setDefaultMenuAddIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'edit':\n\t\t\t\t\tthis.setDefaultMenuEditIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'view':\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'mass_edit':\n\t\t\t\t\tthis.setDefaultMenuMassEditIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'copy':\n\t\t\t\t\tthis.setDefaultMenuCopyIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'delete_icon':\n\t\t\t\t\tthis.setDefaultMenuDeleteIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'delete_and_next':\n\t\t\t\t\tthis.setDefaultMenuDeleteAndNextIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'save':\n\t\t\t\t\tthis.setDefaultMenuSaveIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'save_and_next':\n\t\t\t\t\tthis.setDefaultMenuSaveAndNextIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'save_and_continue':\n\t\t\t\t\tthis.setDefaultMenuSaveAndContinueIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'save_and_new':\n\t\t\t\t\tthis.setDefaultMenuSaveAndAddIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'save_and_copy':\n\t\t\t\t\tthis.setDefaultMenuSaveAndCopyIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'copy_as_new':\n\t\t\t\t\tthis.setDefaultMenuCopyAsNewIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'login':\n\t\t\t\t\tthis.setDefaultMenuLoginIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'cancel':\n\t\t\t\t\tthis.setDefaultMenuCancelIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'import_icon':\n\t\t\t\t\tthis.setDefaultMenuImportIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'permission_wizard':\n\t\t\t\t\tthis.setDefaultMenuPermissionWizardIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'map':\n\t\t\t\t\tthis.setDefaultMenuMapIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'export_excel':\n\t\t\t\t\tthis.setDefaultMenuExportIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis.setCustomDefaultMenuIcon( id, context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t\tthis.initRightClickMenu();\n\t}\n\n\tsetCustomDefaultMenuIcon( id, context_btn, grid_selected_length ) {\n\t\treturn false; //FALSE tells setCustomDefaultMenuIcon() to keep processing.\n\t}\n\n\tsetEditMenu() {\n\t\tvar context_menu_array = ContextMenuManager.getMenuModelByMenuId( this.determineContextMenuMountAttributes().id );\n\n\t\tvar len = context_menu_array.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tlet context_btn = context_menu_array[i];\n\t\t\tlet id = context_menu_array[i].id;\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, true );\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, true );\n\n\t\t\tif ( this.is_mass_editing ) {\n\t\t\t\tswitch ( id ) {\n\t\t\t\t\tcase 'save':\n\t\t\t\t\t\tthis.setEditMenuSaveIcon( context_btn );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'edit':\n\t\t\t\t\t\tthis.setEditMenuEditIcon( context_btn );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'cancel':\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase 'add':\n\t\t\t\t\tthis.setEditMenuAddIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'edit':\n\t\t\t\t\tthis.setEditMenuEditIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'view':\n\t\t\t\t\tthis.setEditMenuViewIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'mass_edit':\n\t\t\t\t\tthis.setEditMenuMassEditIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'copy':\n\t\t\t\t\tthis.setEditMenuCopyIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'delete_icon':\n\t\t\t\t\tthis.setEditMenuDeleteIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'delete_and_next':\n\t\t\t\t\tthis.setEditMenuDeleteAndNextIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'save':\n\t\t\t\t\tthis.setEditMenuSaveIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'save_and_continue':\n\t\t\t\t\tthis.setEditMenuSaveAndContinueIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'save_and_new':\n\t\t\t\t\tthis.setEditMenuSaveAndAddIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'save_and_next':\n\t\t\t\t\tthis.setEditMenuSaveAndNextIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'save_and_copy':\n\t\t\t\t\tthis.setEditMenuSaveAndCopyIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'copy_as_new':\n\t\t\t\t\tthis.setEditMenuCopyAndAddIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'cancel':\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'import_icon':\n\t\t\t\t\tthis.setEditMenuImportIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'permission_wizard':\n\t\t\t\t\tthis.setEditMenuPermissionWizardIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'login':\n\t\t\t\t\tthis.setEditMenuLoginIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'map':\n\t\t\t\t\tthis.setEditMenuMapIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'export_excel':\n\t\t\t\t\tthis.setDefaultMenuExportIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis.setCustomEditMenuIcon( id, context_btn );\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis.hideJumpToMenu();\n\t\tthis.initRightClickMenu( RightClickMenuType.EDITVIEW );\n\t}\n\n\tsetCustomEditMenuIcon( id, context_btn ) {\n\t\treturn false; //FALSE tells setCustomEditMenuIcon() to keep processing.\n\t}\n\n\tsetDefaultMenuMapIcon( context_btn ) {\n\t\tif ( Global.getProductEdition() <= 10 ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tvar show = false;\n\t\tif ( this.grid ) {\n\t\t\tvar selected_items = this.getSelectedItems();\n\t\t\tDebug.Arr( selected_items, 'selected items', 'BaseViewController.js', 'BaseViewController', 'setDefaultMenuMapIcon', 10 );\n\t\t\tif ( selected_items.length > 0 ) {\n\t\t\t\tfor ( var x = 0; x < selected_items.length; x++ ) {\n\t\t\t\t\tif ( selected_items[x] && selected_items[x].latitude && selected_items[x].longitude ) {\n\t\t\t\t\t\tshow = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( show ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, true );\n\t\t} else {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuMapIcon( context_btn ) {\n\t\tthis.setDefaultMenuMapIcon( context_btn );\n\t}\n\n\tsetEditMenuLoginIcon( context_btn ) {\n\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t}\n\n\tsetErrorMenu() {\n\t\tvar context_menu_array = ContextMenuManager.getMenuModelByMenuId( this.determineContextMenuMountAttributes().id );\n\t\tvar len = context_menu_array.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tlet context_btn = context_menu_array[i];\n\t\t\tlet id = context_menu_array[i].id;\n\n\t\t\tif ( context_menu_array[i].split_button_active_item ) {\n\t\t\t\t//Temporarily sets split button to ignore resetting of the active item. This stops active split button item from resetting.\n\t\t\t\t//Example if doing \"Save & Continue\" we do not want the button to switch back to \"Save\" just because validation failed.\n\t\t\t\tContextMenuManager.freezeSplitButtonActiveItem( this.determineContextMenuMountAttributes().id, context_btn.id );\n\t\t\t}\n\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, true );\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase 'cancel':\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\t}\n\n\trender() {\n\t\tvar $this = this;\n\n\t\t$( window ).off( 'resize.edit_tabs' ).on( 'resize.edit_tabs', Global.debounce( function() {\n\t\t\tif ( $this.edit_view ) {\n\t\t\t\t$this.setEditViewTabSize();\n\t\t\t}\n\t\t}, 200 ) );\n\n\t\tTTPromise.add( 'BaseViewController', 'getCustomFields' );\n\n\t\tthis.getCustomFieldsForView();\n\n\t\t//Create search panel only when show as a main view\n\n\t\tif ( !this.sub_view_mode && !this.edit_only_mode && !this.tree_mode ) {\n\t\t\tvar search_panel_w = $( $.fn.SearchPanel.html.search_panel );\n\n\t\t\t$( this.el ).prepend( search_panel_w );\n\n\t\t\tif ( !this.show_search_tab ) {\n\t\t\t\tsearch_panel_w.hide();\n\t\t\t}\n\n\t\t\tthis.search_panel = search_panel_w.SearchPanel( { viewController: this } );\n\n\t\t\tthis.search_panel.on( 'searchTabSelect', function() {\n\t\t\t\t$this.onSearchTabSelect;\n\t\t\t} );\n\n\t\t\tTTPromise.wait( 'BaseViewController', 'getCustomFields', function() {\n\t\t\t\tthis.buildSearchFields();\n\t\t\t\tthis.buildCustomFieldSearchFields()\n\t\t\t\tthis.buildBasicSearchUI();\n\t\t\t\tthis.buildAdvancedSearchUI();\n\t\t\t\tthis.buildSearchAndLayoutUI();\n\n\t\t\t\t//Work around that the li offset is empty in chrome\n\t\t\t\tsetTimeout( function() {\n\t\t\t\t\t$this.setCurrentViewPosition();\n\t\t\t\t}, 500 );\n\t\t\t}.bind( this ) );\n\n\t\t}\n\t}\n\n\tsetCurrentViewPosition() {\n\t\tvar current_view_div = this.search_panel.find( '.layout-selector-div' );\n\t\tvar saved_layout_li = this.search_panel.find( 'a[ref=\\'saved_layout\\']' ).parent();\n\t\t// Error: Unable to get property 'left' of undefined or null reference in /interface/html5/views/BaseViewController.js?v=8.0.6-20150417-083849 line 3691\n\t\tif ( !current_view_div || !saved_layout_li || !saved_layout_li.offset() ) {\n\t\t\treturn;\n\t\t}\n\t\t// Now controlled from CSS in SearchPanel.css Dont understand why there is a complex left: x JS calc, right position seems better and more consistent.\n\t\t// current_view_div.css( 'left', saved_layout_li.offset().left + saved_layout_li.width() - 60 ); // Change to 60 is trial and error trying to prevent current view dropdown from overlapping in new layout design\n\t}\n\n\t//Build fields when search tab change\n\tonSearchTabSelect( e, e1, ui ) {\n\t\tvar tab_id = $( ui ).prop( 'id' );\n\n\t\tswitch ( tab_id ) {\n\t\t\tcase 'basic_search':\n\n\t\t\t\tif ( this.search_panel.getLastSelectTabId() !== 'saved_layout' ) {\n\t\t\t\t\tthis.getSearchPanelFilter( 1, true );\n\t\t\t\t\tthis.buildBasicSearchUI();\n\t\t\t\t\tthis.setSearchPanelFilter( false, 0 );\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'adv_search':\n\t\t\t\tif ( this.search_panel.getLastSelectTabId() !== 'saved_layout' ) {\n\t\t\t\t\tthis.getSearchPanelFilter( 0, true );\n\t\t\t\t\tthis.buildAdvancedSearchUI();\n\t\t\t\t\tthis.setSearchPanelFilter( false, 1 );\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'saved_layout':\n\t\t\t\tthis.getSearchPanelFilter( this.search_panel.getLastSelectTabIndex() );\n\t\t}\n\t}\n\n\tinitDropDownOptions( options, callBack ) {\n\t\tlet $this = this;\n\t\tlet api_groups = {};\n\n\t\t//Fill any values that are not set and group option calls by their API endpoint.\n\t\tfor ( let i = 0; i < options.length; i++ ) {\n\t\t\tlet option = options[i];\n\t\t\tif ( !Global.isSet( option.api ) ) {\n\t\t\t\toption.api = this.api;\n\t\t\t}\n\t\t\tif ( !Global.isSet( option.field_name ) || !option.field_name ) {\n\t\t\t\toption.field_name = option.option_name + '_id';\n\t\t\t}\n\t\t\tif ( !Global.isSet( option.parent ) || !option.parent ) {\n\t\t\t\toption.parent = null;\n\t\t\t}\n\n\t\t\t//Group getOption calls by their API endpoint.\n\t\t\tif ( !api_groups[option.api.className] ) {\n\t\t\t\tapi_groups[option.api.className] = [];\n\t\t\t}\n\t\t\tapi_groups[option.api.className].push( option );\n\t\t}\n\n\t\t//Call getOptionsBatch on each requested API\n\t\tlet completed_api_calls = 0;\n\t\tfor ( let api_class in api_groups ) {\n\t\t\tif ( Array.isArray( api_groups[api_class] ) === false ) {\n\t\t\t\t//Issue #3223 - Error: Uncaught TypeError: api_groups[api_class].reduce is not a function\n\t\t\t\t//The cause for this exception is unknown as the above code is syncronous and should always produce\n\t\t\t\t//the same results given the same input. However, for some reason api_groups[api_class] is not an always an array.\n\t\t\t\t//This change is simply meant to prevent the error from being thrown.\n\t\t\t\tif ( Global.isSet( callBack ) ) {\n\t\t\t\t\tcallBack();\n\t\t\t\t}\n\t\t\t\tDebug.Text( 'Unexpected error api_groups[api_class] is not an array.', 'BaseViewController.js', 'BaseViewController', 'initDropDownOptions', 9 );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t//Reduce data sent to API with only data required for the API.\n\t\t\tlet data = api_groups[api_class].reduce( ( new_obj, option ) => ( new_obj[option.option_name] = option.parent, new_obj ), {} );\n\t\t\tTTAPI[api_class].getOptionsBatch( data, {\n\t\t\t\tonResult: function( response ) {\n\t\t\t\t\tlet results = response.getResult();\n\t\t\t\t\tif ( results && Object.keys( results ).length > 0 ) {\n\t\t\t\t\t\tfor ( let option in results ) {\n\t\t\t\t\t\t\tlet option_data = results[option];\n\t\t\t\t\t\t\tlet option_field_info = api_groups[api_class].find( icon => icon.option_name === option );\n\t\t\t\t\t\t\t//Set view controller variables and field data\n\t\t\t\t\t\t\t$this[option + '_array'] = Global.buildRecordArray( option_data );\n\t\t\t\t\t\t\tif ( !$this.sub_view_mode ) {\n\t\t\t\t\t\t\t\tif ( Global.isSet( $this.basic_search_field_ui_dic[option_field_info.field_name] ) ) {\n\t\t\t\t\t\t\t\t\t$this.basic_search_field_ui_dic[option_field_info.field_name].setSourceData( Global.buildRecordArray( option_data ) );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ( Global.isSet( $this.adv_search_field_ui_dic[option_field_info.field_name] ) ) {\n\t\t\t\t\t\t\t\t\t$this.adv_search_field_ui_dic[option_field_info.field_name].setSourceData( Global.buildRecordArray( option_data ) );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tcompleted_api_calls++;\n\n\t\t\t\t\tif ( Object.keys( api_groups ).length === completed_api_calls && Global.isSet( callBack ) ) {\n\t\t\t\t\t\t//Only call the callback when all API calls have completed.\n\t\t\t\t\t\tcallBack( response );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tbuildWidgetContainerWithTextTip( widget, tip ) {\n\t\tvar h_box = $( '<div class=\\'h-box\\'></div>' );\n\n\t\tvar text_box = Global.loadWidgetByName( FormItemType.TEXT );\n\t\ttext_box.css( 'margin-left', '10px' );\n\t\ttext_box.TText();\n\t\ttext_box.setValue( tip );\n\n\t\th_box.append( widget );\n\t\th_box.append( text_box );\n\n\t\treturn h_box;\n\t}\n\n\t//Set option list for search panel and edit view\n\tinitDropDownOption( option_name, field_name, api, callBack, array_name ) {\n\t\tvar $this = this;\n\t\tif ( !Global.isSet( api ) ) {\n\t\t\tapi = this.api;\n\t\t}\n\n\t\tif ( !Global.isSet( field_name ) || !field_name ) {\n\t\t\tfield_name = option_name + '_id';\n\t\t}\n\t\tapi.getOptions( option_name, {\n\t\t\tonResult: function( res ) {\n\t\t\t\tvar result = res.getResult();\n\n\t\t\t\tif ( array_name ) {\n\t\t\t\t\t$this[array_name] = Global.buildRecordArray( result );\n\t\t\t\t} else {\n\n\t\t\t\t\t$this[option_name + '_array'] = Global.buildRecordArray( result );\n\t\t\t\t}\n\n\t\t\t\tif ( !$this.sub_view_mode ) {\n\n\t\t\t\t\tif ( Global.isSet( $this.basic_search_field_ui_dic[field_name] ) ) {\n\t\t\t\t\t\t$this.basic_search_field_ui_dic[field_name].setSourceData( Global.buildRecordArray( result ) );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( Global.isSet( $this.adv_search_field_ui_dic[field_name] ) ) {\n\t\t\t\t\t\t$this.adv_search_field_ui_dic[field_name].setSourceData( Global.buildRecordArray( result ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( Global.isSet( callBack ) ) {\n\t\t\t\t\tcallBack( res );\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tclearSearchPanel() {\n\n\t\tfor ( var key in this.basic_search_field_ui_dic ) {\n\t\t\tvar search_input = this.basic_search_field_ui_dic[key];\n\t\t\tsearch_input.setValue( null );\n\t\t}\n\n\t\tfor ( var key in this.adv_search_field_ui_dic ) {\n\t\t\tsearch_input = this.adv_search_field_ui_dic[key];\n\t\t\tsearch_input.setValue( null );\n\t\t}\n\t}\n\n\tonSearch() {\n\t\tTTPromise.add( 'init', 'init' );\n\t\tTTPromise.wait();\n\n\t\tvar do_update = false;\n\n\t\t//don't keep temp filter any more, set them when change tab\n\t\tthis.temp_adv_filter_data = null;\n\t\tthis.temp_basic_filter_data = null;\n\t\tthis.getSearchPanelFilter();\n\t\tif ( this.search_panel.getLayoutsArray() && this.search_panel.getLayoutsArray().length > 0 ) {\n\t\t\tvar default_layout_id = $( this.previous_saved_layout_selector ).children( 'option:contains(\\'' + BaseViewController.default_layout_name + '\\')' ).attr( 'value' );\n\n\t\t\tif ( !default_layout_id ) {\n\t\t\t\tthis.onSaveNewLayout( BaseViewController.default_layout_name );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar layout_name = BaseViewController.default_layout_name;\n\n\t\t} else if ( this.show_search_tab ) {\n\t\t\tthis.onSaveNewLayout( BaseViewController.default_layout_name );\n\t\t\treturn;\n\t\t} else if ( !this.show_search_tab ) {\n\t\t\tthis.search();\n\t\t\tthis.setGridHeaderStyle();\n\t\t\treturn;\n\t\t}\n\n\t\tvar sort_filter = this.getSearchPanelSortFilter();\n\t\tvar selected_display_columns = this.getSearchPanelDisplayColumns();\n\n\t\tvar filter_data = Global.convertLayoutFilterToAPIFilter( { data: { filter_data: this.getValidSearchFilter() } } );\n\n\t\tvar args = {};\n\t\targs.id = default_layout_id;\n\t\targs.data = {};\n\t\targs.data.display_columns = selected_display_columns;\n\t\targs.data.filter_data = filter_data;\n\t\targs.data.filter_sort = sort_filter;\n\n\t\tProgressBar.showOverlay();\n\t\tvar $this = this;\n\t\tthis.user_generic_data_api.setUserGenericData( args, {\n\t\t\tonResult: function( res ) {\n\n\t\t\t\tif ( res && res.isValid() ) {\n\t\t\t\t\t$this.clearViewLayoutCache();\n\t\t\t\t\t$this.clearAwesomeboxLayoutCache();\n\t\t\t\t\t$this.need_select_layout_name = layout_name;\n\t\t\t\t\t$this.initLayout();\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tonClearSearch() {\n\t\tvar do_update = false;\n\t\tif ( this.search_panel.getLayoutsArray() && this.search_panel.getLayoutsArray().length > 0 ) {\n\t\t\tvar default_layout_id = $( this.previous_saved_layout_selector ).children( 'option:contains(\\'' + BaseViewController.default_layout_name + '\\')' ).attr( 'value' );\n\n\t\t\tif ( !default_layout_id ) {\n\t\t\t\tthis.clearSearchPanel();\n\t\t\t\tthis.filter_data = null;\n\t\t\t\tthis.temp_adv_filter_data = null;\n\t\t\t\tthis.temp_basic_filter_data = null;\n\t\t\t\tthis.column_selector.setSelectGridData( this.default_display_columns );\n\t\t\t\tthis.sort_by_selector.setValue( null );\n\n\t\t\t\tthis.onSaveNewLayout( BaseViewController.default_layout_name );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar layout_name = BaseViewController.default_layout_name;\n\t\t\tthis.clearSearchPanel();\n\t\t\tthis.filter_data = null;\n\t\t\tthis.temp_adv_filter_data = null;\n\t\t\tthis.temp_basic_filter_data = null;\n\t\t\tdo_update = true;\n\n\t\t} else {\n\n\t\t\tthis.clearSearchPanel();\n\t\t\tthis.filter_data = null;\n\t\t\tthis.temp_adv_filter_data = null;\n\t\t\tthis.temp_basic_filter_data = null;\n\t\t\tthis.column_selector.setSelectGridData( this.default_display_columns );\n\t\t\tthis.sort_by_selector.setValue( null );\n\n\t\t\tthis.onSaveNewLayout( BaseViewController.default_layout_name );\n\t\t\treturn;\n\n\t\t}\n\n//\t\tthis.column_selector.setSelectGridData( this.default_display_columns );\n\n\t\tthis.sort_by_selector.setValue( null );\n\n\t\tvar sort_filter = this.getSearchPanelSortFilter();\n\t\tvar selected_display_columns = this.getSearchPanelDisplayColumns();\n\t\tvar filter_data = Global.convertLayoutFilterToAPIFilter( {data: { filter_data: this.getValidSearchFilter() } } );\n\n\t\tif ( do_update ) {\n\t\t\tvar args = {};\n\t\t\targs.id = default_layout_id;\n\t\t\targs.data = {};\n\t\t\targs.data.display_columns = selected_display_columns;\n\t\t\targs.data.filter_data = filter_data;\n\t\t\targs.data.filter_sort = sort_filter;\n\n\t\t}\n\n\t\tvar $this = this;\n\t\tthis.user_generic_data_api.setUserGenericData( args, {\n\t\t\tonResult: function( res ) {\n\n\t\t\t\tif ( res && res.isValid() ) {\n\t\t\t\t\t$this.clearViewLayoutCache();\n\t\t\t\t\t$this.need_select_layout_name = layout_name;\n\t\t\t\t\t$this.initLayout();\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tonSaveNewLayout( default_layout_name ) {\n\n\t\tif ( Global.isSet( default_layout_name ) ) {\n\t\t\tvar layout_name = default_layout_name;\n\t\t} else {\n\t\t\tlayout_name = this.save_search_as_input.getValue();\n\t\t}\n\n\t\tif ( !layout_name || layout_name.length < 1 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar sort_filter = this.getSearchPanelSortFilter();\n\t\tvar selected_display_columns = this.getSearchPanelDisplayColumns();\n\t\tvar filter_data = Global.convertLayoutFilterToAPIFilter( {data: { filter_data: this.getValidSearchFilter() } } );\n\n\t\tvar args = {};\n\t\targs.script = this.script_name;\n\t\targs.name = layout_name;\n\t\targs.is_default = false;\n\t\targs.data = {};\n\t\targs.data.display_columns = selected_display_columns;\n\t\targs.data.filter_data = filter_data;\n\t\targs.data.filter_sort = sort_filter;\n\n\t\tvar $this = this;\n\n\t\tvar a_layout_name = ALayoutCache.layout_dic[this.script_name];\n\t\tif ( a_layout_name && ALayoutCache.layout_dic[a_layout_name] ) {\n\t\t\tALayoutCache.layout_dic[a_layout_name] = null;\n\t\t}\n\n\t\tthis.user_generic_data_api.setUserGenericData( args, {\n\t\t\tonResult: function( res ) {\n\n\t\t\t\tif ( res && res.isValid() ) {\n\t\t\t\t\t$this.clearAwesomeboxLayoutCache();\n\t\t\t\t\t$this.clearViewLayoutCache();\n\t\t\t\t\t$this.need_select_layout_name = layout_name;\n\t\t\t\t\t$this.initLayout();\n\n\t\t\t\t} else {\n\t\t\t\t\tTAlertManager.showErrorAlert( res );\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tonUpdateLayout() {\n\n\t\tvar selectId = $( this.previous_saved_layout_selector ).children( 'option:selected' ).attr( 'value' );\n\t\tvar layout_name = $( this.previous_saved_layout_selector ).children( 'option:selected' ).text();\n\n\t\tvar sort_filter = this.getSearchPanelSortFilter();\n\t\tvar selected_display_columns = this.getSearchPanelDisplayColumns();\n\t\tvar filter_data = Global.convertLayoutFilterToAPIFilter( { data: { filter_data: this.getValidSearchFilter() } } );\n\n\t\tvar args = {};\n\t\targs.id = selectId;\n\t\targs.data = {};\n\t\targs.data.display_columns = selected_display_columns;\n\t\targs.data.filter_data = filter_data;\n\t\targs.data.filter_sort = sort_filter;\n\n\t\tvar $this = this;\n\n\t\tvar a_layout_name = ALayoutCache.layout_dic[this.script_name];\n\t\tif ( a_layout_name && ALayoutCache.layout_dic[a_layout_name] ) {\n\t\t\tALayoutCache.layout_dic[a_layout_name] = null;\n\t\t}\n\n\t\tthis.user_generic_data_api.setUserGenericData( args, {\n\t\t\tonResult: function( res ) {\n\n\t\t\t\tif ( res && res.isValid() ) {\n\t\t\t\t\t$this.clearAwesomeboxLayoutCache();\n\t\t\t\t\t$this.clearViewLayoutCache();\n\t\t\t\t\t$this.need_select_layout_name = layout_name;\n\t\t\t\t\t$this.initLayout();\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tclearViewLayoutCache() {\n\t\tif ( LocalCacheData.view_layout_cache && LocalCacheData.view_layout_cache[this.script_name] ) {\n\t\t\tLocalCacheData.view_layout_cache[this.script_name] = null;\n\t\t}\n\t}\n\n\tclearAwesomeboxLayoutCache() {\n\t\t// Removed saved view layout for awesomebox if it existed.\n\t\tif ( ALayoutCache.layout_dic && ALayoutCache.layout_dic[this.script_name] ) {\n\t\t\tALayoutCache.layout_dic[ALayoutCache.layout_dic[this.script_name]] = null;\n\t\t}\n\t}\n\n\tonDeleteLayout() {\n\t\tvar selectId = $( this.previous_saved_layout_selector ).children( 'option:selected' ).attr( 'value' );\n\n\t\tvar $this = this;\n\t\tthis.user_generic_data_api.deleteUserGenericData( selectId, {\n\t\t\tonResult: function( res ) {\n\t\t\t\tif ( res && res.isValid() ) {\n\t\t\t\t\t$this.clearAwesomeboxLayoutCache();\n\t\t\t\t\t$this.clearViewLayoutCache();\n\t\t\t\t\t$this.need_select_layout_name = $this.select_layout.name;\n\t\t\t\t\t$this.initLayout();\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tbuildSearchFields() {\n\t\t//Override in all subview\n\t}\n\n\tbuildCustomFieldSearchFields() {\n\t\tif ( !this.search_fields ) {\n\t\t\tthis.search_fields = [];\n\t\t}\n\n\t\tthis.custom_fields.forEach( ( field ) => {\n\t\t\tif ( field.enable_search ) {\n\n\t\t\t\tlet field_settings = {\n\t\t\t\t\tlabel: field.name,\n\t\t\t\t\tin_column: 1,\n\t\t\t\t\tfield: this.getPrefixedCustomFieldID( field.id ),\n\t\t\t\t\tbasic_search: false,\n\t\t\t\t\tadv_search: true,\n\t\t\t\t};\n\n\t\t\t\tlet type_id = parseInt( field.type_id );\n\n\t\t\t\tswitch ( type_id ) {\n\t\t\t\t\tcase 500: //Checkbox\n\t\t\t\t\t\tfield_settings.form_item_type = FormItemType.AWESOME_BOX;\n\t\t\t\t\t\tfield_settings.multiple = false;\n\t\t\t\t\t\tfield_settings.layout_name = 'global_option_column';\n\t\t\t\t\t\tfield_settings.addition_source_function = ( target, source_data ) => {\n\t\t\t\t\t\t\tsource_data = [\n\t\t\t\t\t\t\t\t{ value: TTUUID.zero_id, label: '-- ' + $.i18n._( 'ANY' ) + ' --' },\n\t\t\t\t\t\t\t\t{ value: true, label: $.i18n._( 'Yes' ) },\n\t\t\t\t\t\t\t\t{ value: false, label: $.i18n._( 'No' ) }\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\treturn source_data;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1000: //Date\n\t\t\t\t\t\tfield_settings.form_item_type = FormItemType.DATE_PICKER;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t// case 1010: //Date Range Search Disabled\n\t\t\t\t\t// \tfield_settings.form_item_type = FormItemType.DATE_PICKER;\n\t\t\t\t\t// \tbreak;\n\t\t\t\t\tcase 1100: //Time\n\t\t\t\t\t\tfield_settings.form_item_type = FormItemType.TIME_PICKER;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1200: //Datetime\n\t\t\t\t\t\tfield_settings.form_item_type = FormItemType.DATE_PICKER;\n\t\t\t\t\t\tfield_settings.mode = 'date_time';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1300: //Time Unit\n\t\t\t\t\t\tfield_settings.form_item_type = FormItemType.TEXT_INPUT;\n\t\t\t\t\t\tfield_settings.mode = 'time_unit';\n\t\t\t\t\t\tfield_settings.need_parser_sec = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2100: //Single-select dropdown\n\t\t\t\t\tcase 2110: //Multi-select dropdown\n\t\t\t\t\t\tfield_settings.form_item_type = FormItemType.AWESOME_BOX;\n\t\t\t\t\t\tfield_settings.layout_name = 'global_option_column';\n\t\t\t\t\t\tfield_settings.addition_source_function = ( target, source_data ) => {\n\t\t\t\t\t\t\tsource_data = []; //Overwriting source data to empty array.\n\t\t\t\t\t\t\tif ( field.meta_data.validation.multi_select_items ) {\n\t\t\t\t\t\t\t\tfield.meta_data.validation.multi_select_items.forEach( ( item ) => {\n\t\t\t\t\t\t\t\t\tsource_data.push( {\n\t\t\t\t\t\t\t\t\t\tid: item.id,\n\t\t\t\t\t\t\t\t\t\tvalue: item.id,\n\t\t\t\t\t\t\t\t\t\tlabel: item.label\n\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn source_data;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tfield_settings.form_item_type = FormItemType.TEXT_INPUT;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tthis.search_fields.push( new SearchField( field_settings ) );\n\t\t\t}\n\t\t} );\n\t}\n\n\tbuildBasicSearchUI() {\n\t\tif ( !this.search_fields ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar basic_search_div = this.search_panel.find( 'div #basic_search_content_div' );\n\n\t\tvar len = this.search_fields.length;\n\t\tvar $this = this;\n\n\t\tvar column1 = basic_search_div.find( '.first-column' );\n\t\tvar column2 = basic_search_div.find( '.second-column' );\n\t\tvar column3 = basic_search_div.find( '.third-column' );\n\n\t\tvar already_created_ui = false;\n\t\t$.each( this.search_fields, function( index, search_field ) {\n\t\t\tif ( Global.isSet( $this.basic_search_field_ui_dic[search_field.get( 'field' )] ) ) {\n\t\t\t\talready_created_ui = true;\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif ( !search_field.get( 'basic_search' ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// var form_item = $( Global.loadWidget( 'global/widgets/search_panel/FormItem.html' ) ); // TODO: #3023: Delete this line once widget html converted and no longer need this quick reference for the old format.\n\t\t\tvar form_item = $( $.fn.SearchPanel.html.form_item );\n\t\t\tvar form_item_label = form_item.find( '.form-item-label' );\n\t\t\tvar form_item_input_div = form_item.find( '.form-item-input-div' );\n\t\t\tvar form_item_input = $this.getFormItemInput( search_field );\n\t\t\tform_item_label.text( search_field.get( 'label' ) );\n\t\t\tform_item_input_div.append( form_item_input );\n\n\t\t\tswitch ( search_field.get( 'in_column' ) ) {\n\t\t\t\tcase 1:\n\t\t\t\t\tcolumn1.append( form_item );\n\t\t\t\t\tcolumn1.append( '<div class=\\'clear-both-div\\'></div>' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tcolumn2.append( form_item );\n\t\t\t\t\tcolumn2.append( '<div class=\\'clear-both-div\\'></div>' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tcolumn3.append( form_item );\n\t\t\t\t\tcolumn3.append( '<div class=\\'clear-both-div\\'></div>' );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t$this.basic_search_field_ui_dic[search_field.get( 'field' )] = form_item_input;\n\t\t} );\n\n\t\tif ( !already_created_ui ) {\n\t\t\tthis.onBuildBasicUIFinished();\n\t\t}\n\t}\n\n\tbuildAdvancedSearchUI() {\n\t\tif ( !this.search_fields ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar advSearchDiv = this.search_panel.find( 'div #adv_search_content_div' );\n\n\t\tvar $this = this;\n\n\t\tvar column1 = advSearchDiv.find( '.first-column' );\n\t\tvar column2 = advSearchDiv.find( '.second-column' );\n\t\tvar column3 = advSearchDiv.find( '.third-column' );\n\n\t\tvar already_created_ui = false;\n\t\tvar no_adv_ui = true;\n\n\t\t$.each( this.search_fields, function( index, search_field ) {\n\n\t\t\tif ( Global.isSet( $this.adv_search_field_ui_dic[search_field.get( 'field' )] ) ) {\n\t\t\t\talready_created_ui = true;\n\t\t\t\tno_adv_ui = false;\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif ( !search_field.get( 'adv_search' ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tvar form_item = $( $.fn.SearchPanel.html.form_item );\n\t\t\tvar form_item_label = form_item.find( '.form-item-label' );\n\t\t\tvar form_item_input_div = form_item.find( '.form-item-input-div' );\n\t\t\tvar form_item_input = $this.getFormItemInput( search_field );\n\t\t\tform_item_label.text( search_field.get( 'label' ) );\n\t\t\tform_item_input_div.append( form_item_input );\n\n\t\t\tswitch ( search_field.get( 'in_column' ) ) {\n\t\t\t\tcase 1:\n\t\t\t\t\tcolumn1.append( form_item );\n\t\t\t\t\tcolumn1.append( '<div class=\\'clear-both-div\\'></div>' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tcolumn2.append( form_item );\n\t\t\t\t\tcolumn2.append( '<div class=\\'clear-both-div\\'></div>' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tcolumn3.append( form_item );\n\t\t\t\t\tcolumn3.append( '<div class=\\'clear-both-div\\'></div>' );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t$this.adv_search_field_ui_dic[search_field.get( 'field' )] = form_item_input;\n\t\t\tno_adv_ui = false;\n\t\t} );\n\n\t\tif ( no_adv_ui ) {\n\n\t\t\tthis.search_panel.hideAdvSearchPanel();\n\t\t}\n\n\t\tif ( !already_created_ui ) {\n\t\t\tthis.onBuildAdvUIFinished();\n\t\t}\n\t}\n\n\tonSetSearchFilterFinished() {\n\t}\n\n\tonBuildAdvUIFinished() {\n\t\t//Always override in sub class\n\t}\n\n\tonBuildBasicUIFinished() {\n\t\t//Always override in sub class\n\t}\n\n\tgetFormItemInput( search_field ) {\n\t\tvar input;\n\t\tvar form_type = search_field.get( 'form_item_type' );\n\n\t\tswitch ( form_type ) {\n\t\t\tcase FormItemType.AWESOME_BOX:\n\t\t\t\tinput = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\t\tvar show_search = false;\n\t\t\t\tvar key;\n\n\t\t\t\tif ( search_field.get( 'layout_name' ) !== 'global_option_column' && search_field.get( 'layout_name' ) !== 'global_tree_column' ) {\n\t\t\t\t\tshow_search = true;\n\t\t\t\t\tkey = 'id';\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( search_field.get( 'layout_name' ) === 'global_tree_column' ) {\n\t\t\t\t\t\tkey = 'id';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tkey = 'value';\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tinput.AComboBox( {\n\t\t\t\t\tapi_class: search_field.get( 'api_class' ),\n\t\t\t\t\tallow_multiple_selection: search_field.get( 'multiple' ),\n\t\t\t\t\tlayout_name: search_field.get( 'layout_name' ),\n\t\t\t\t\ttree_mode: search_field.get( 'tree_mode' ),\n\t\t\t\t\tdefault_args: search_field.get( 'default_args' ),\n\t\t\t\t\tshow_search_inputs: show_search,\n\t\t\t\t\tset_any: search_field.get( 'set_any' ),\n\t\t\t\t\taddition_source_function: search_field.get( 'addition_source_function' ),\n\t\t\t\t\tscript_name: search_field.get( 'script_name' ),\n\t\t\t\t\tcustom_first_label: search_field.get( 'custom_first_label' ),\n\t\t\t\t\tkey: key,\n\t\t\t\t\tsearch_panel_model: true,\n\t\t\t\t\tfield: search_field.get( 'field' )\n\t\t\t\t} );\n\n\t\t\t\tif ( search_field.get( 'customSearchFilter' ) ) {\n\t\t\t\t\tinput.customSearchFilter = search_field.get( 'customSearchFilter' );\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase FormItemType.TEXT_INPUT:\n\t\t\t\tinput = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tinput.TTextInput( {\n\t\t\t\t\tfield: search_field.get( 'field' ),\n\t\t\t\t\tneed_parser_sec: search_field.get( 'need_parser_sec' ),\n\t\t\t\t\tmode: search_field.get( 'mode' ),\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\tcase FormItemType.TIME_PICKER:\n\t\t\t\tinput = Global.loadWidgetByName( FormItemType.TIME_PICKER );\n\t\t\t\tinput.TTimePicker( {\n\t\t\t\t\tfield: search_field.get( 'field' )\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\tcase FormItemType.PASSWORD_INPUT:\n\t\t\t\tinput = Global.loadWidgetByName( FormItemType.PASSWORD_INPUT );\n\t\t\t\tinput.TTextInput( {\n\t\t\t\t\tfield: search_field.get( 'field' )\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\tcase FormItemType.COMBO_BOX:\n\t\t\t\tinput = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\t\t\tinput.TComboBox( {\n\t\t\t\t\tfield: search_field.get( 'field' ),\n\t\t\t\t\tset_any: true\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\tcase FormItemType.TAG_INPUT:\n\t\t\t\tinput = Global.loadWidgetByName( FormItemType.TAG_INPUT );\n\t\t\t\tinput.TTagInput( {\n\t\t\t\t\tfield: search_field.get( 'field' ),\n\t\t\t\t\tobject_type_id: search_field.get( 'object_type_id' )\n\t\t\t\t} );\n\n\t\t\t\tbreak;\n\t\t\tcase FormItemType.DATE_PICKER:\n\t\t\t\tinput = Global.loadWidgetByName( form_type );\n\t\t\t\tinput = $( input );\n\t\t\t\tinput.TDatePicker( {\n\t\t\t\t\tfield: search_field.get( 'field' ),\n\t\t\t\t\tmode: search_field.get( 'mode' ),\n\t\t\t\t} );\n\n\t\t\t\tbreak;\n\t\t\tcase FormItemType.CHECKBOX:\n\t\t\t\tinput = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\t\tinput.TCheckbox( {\n\t\t\t\t\tfield: search_field.get( 'field' )\n\t\t\t\t} );\n\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tDebug.Error( 'ERROR: Form type does not exist: '+ form_type, 'BaseViewController.js', 'BaseViewController', 'getFormItemInput', 2 );\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn input;\n\t}\n\n\tbuildSearchAndLayoutUI() {\n\t\tvar layout_div = this.search_panel.find( 'div #saved_layout_content_div' );\n\n\t\t//Display Columns\n\n\t\tvar form_item = $( $.fn.SearchPanel.html.form_item );\n\t\tvar form_item_label = form_item.find( '.form-item-label' );\n\t\tvar form_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\tthis.column_selector = Global.loadWidgetByName( FormItemType.AWESOME_DROPDOWN );\n\n\t\tthis.column_selector = this.column_selector.ADropDown( {\n\t\t\tdisplay_show_all: false,\n\t\t\tid: this.ui_id + '_column_selector',\n\t\t\tkey: 'value',\n\t\t\tallow_drag_to_order: true,\n\t\t\tdisplay_close_btn: false,\n\t\t\tdisplay_column_settings: false,\n\t\t\tmax_height: 150\n\t\t} );\n\t\tthis.column_selector.on( 'formItemChange', function() {\n\t\t\t$this.layout_changed = true;\n\t\t} );\n\n\t\tform_item_label.text( $.i18n._( 'Display Columns' ) );\n\t\tform_item_label.addClass( 'SearchPanel-displayColumns-label' );\n\t\tform_item_input_div.append( this.column_selector );\n\n\t\tlayout_div.append( form_item );\n\n\t\tlayout_div.append( '<div class=\\'clear-both-div\\'></div>' );\n\n\t\tthis.column_selector.setColumns( [\n\t\t\t{ name: 'label', index: 'label', label: $.i18n._( 'Column Name' ), width: 100, sortable: false }\n\t\t] );\n\n\t\t//Sort By\n\t\tform_item = $( $.fn.SearchPanel.html.form_item );\n\t\tform_item_label = form_item.find( '.form-item-label' );\n\t\tform_item_input_div = form_item.find( '.form-item-input-div' );\n\t\tthis.sort_by_selector = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tthis.sort_by_selector = this.sort_by_selector.AComboBox( {\n\t\t\tallow_drag_to_order: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tset_empty: true,\n\t\t\tlayout_name: 'global_sort_columns'\n\t\t} );\n\n\t\tform_item_label.text( $.i18n._( 'Sort By' ) );\n\t\tform_item_input_div.append( this.sort_by_selector );\n\n\t\tlayout_div.append( form_item );\n\n\t\tlayout_div.append( '<div class=\\'clear-both-div\\'></div>' );\n\n\t\t//Save and update layout\n\n\t\tform_item = $( $.fn.SearchPanel.html.form_item );\n\t\tform_item_label = form_item.find( '.form-item-label' );\n\t\tform_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\tform_item_label.text( $.i18n._( 'Save Search As' ) );\n\n\t\tthis.save_search_as_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tthis.save_search_as_input.TTextInput();\n\n\t\tvar save_btn = $( '<button class=\"tt-button p-button p-component small-search-panel-button\" type=\"button\">\\n' +\n\t\t\t'<span class=\"tticon tticon-save_black_24dp\"></span>\\n' +\n\t\t\t'<span class=\"p-button-label\">' + $.i18n._( 'Save' ) + '</span>\\n' +\n\t\t\t'</button>' );\n\n\t\tform_item_input_div.append( this.save_search_as_input );\n\t\tform_item_input_div.append( save_btn );\n\n\t\tvar $this = this;\n\t\tsave_btn.click( function() {\n\t\t\t$this.saving_layout_in_layout_tab = true;\n\t\t\t$this.onSaveNewLayout();\n\t\t\t$this.search();\n\t\t} );\n\n\t\t//Previous Saved Layout\n\n\t\tthis.previous_saved_layout_div = $( '<div class=\\'previous-saved-layout-div\\'></div>' );\n\n\t\tform_item_input_div.append( this.previous_saved_layout_div );\n\n\t\tform_item_label = $( '<span style=\\'margin-left: 5px\\' >' + $.i18n._( 'Previous Saved Searches' ) + ':</span>' );\n\t\tthis.previous_saved_layout_div.append( form_item_label );\n\n\t\tthis.previous_saved_layout_selector = $( '<select style=\\'margin-left: 5px\\' class=\\'t-select\\'>' );\n\t\tvar update_btn = $( '<button class=\"tt-button p-button p-component small-search-panel-button\" type=\"button\">\\n' +\n\t\t\t'<span class=\"tticon tticon-save_black_24dp\"></span>\\n' +\n\t\t\t'<span class=\"p-button-label\">' + $.i18n._( 'Update' ) + '</span>\\n' +\n\t\t\t'</button>' );\n\n\t\tvar del_btn = $( '<button class=\"tt-button p-button p-component small-search-panel-button\" type=\"button\">\\n' +\n\t\t\t'<span class=\"tticon tticon-delete_black_24dp\"></span>\\n' +\n\t\t\t'<span class=\"p-button-label\">' + $.i18n._( 'Delete' ) + '</span>\\n' +\n\t\t\t'</button>' );\n\n\t\tupdate_btn.click( function() {\n\t\t\t$this.onUpdateLayout();\n\t\t} );\n\n\t\tdel_btn.click( function() {\n\t\t\t$this.onDeleteLayout();\n\t\t} );\n\n\t\tthis.previous_saved_layout_div.append( this.previous_saved_layout_selector );\n\t\tthis.previous_saved_layout_div.append( update_btn );\n\t\tthis.previous_saved_layout_div.append( del_btn );\n\n\t\tlayout_div.append( form_item );\n\n\t\tthis.previous_saved_layout_div.css( 'display', 'none' );\n\t}\n\n\tonGridSelectRow() {\n\t\t$( '#ribbon_view_container .context-menu:visible a' ).click();\n\t\tthis.setDefaultMenu();\n\t}\n\n\tsetPreviousSavedSearchSourcesAndValue( layouts_array ) {\n\t\tvar $this = this;\n\n\t\tif ( this.previous_saved_layout_selector ) {\n\t\t\tthis.previous_saved_layout_selector.empty();\n\n\t\t\tif ( layouts_array && layouts_array.length > 0 ) {\n\t\t\t\tthis.previous_saved_layout_div.css( 'display', 'inline' );\n\n\t\t\t\tvar len = layouts_array.length;\n\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\t\tvar item = layouts_array[i];\n\t\t\t\t\tthis.previous_saved_layout_selector.append( $( '<option value=\"' + item.id + '\"></option>' ).text( item.name ) );\n\t\t\t\t}\n\n\t\t\t\t$( this.previous_saved_layout_selector.find( 'option' ) ).filter( function() {\n\t\t\t\t\treturn $( this ).attr( 'value' ) == $this.select_layout.id;\n\t\t\t\t} ).prop( 'selected', true ).attr( 'selected', true );\n\n\t\t\t} else {\n\t\t\t\tthis.previous_saved_layout_div.css( 'display', 'none' );\n\t\t\t}\n\t\t}\n\t}\n\n\tsetSelectLayout( exclude_column ) {\n\t\tvar $this = this;\n\t\tvar grid;\n\n\t\tvar grid_id = 'grid';\n\t\tif ( !Global.isSet( this.grid ) ) {\n\t\t\tgrid = $( this.el ).find( '#grid' );\n\n\t\t\tgrid.attr( 'id', this.ui_id + '_grid' );  //Grid's id is ScriptName + _grid\n\n\t\t\tgrid_id = this.ui_id + '_grid';\n\t\t}\n\n\t\tvar column_info_array = [];\n\n\t\tif ( !this.select_layout ) { //Set to default layout if no layout at all\n\t\t\tthis.select_layout = { id: '' };\n\t\t\tthis.select_layout.data = { filter_data: {}, filter_sort: {} };\n\t\t\tthis.select_layout.data.display_columns = this.default_display_columns;\n\t\t}\n\n\t\tvar layout_data = this.select_layout.data;\n\n\t\tif ( !layout_data.display_columns || layout_data.display_columns.length == 0 ) {\n\t\t\tlayout_data.display_columns = this.default_display_columns;\n\t\t}\n\n\t\tvar display_columns = this.buildDisplayColumns( layout_data.display_columns );\n\n\t\tif ( !this.sub_view_mode && this.search_panel ) {\n\n\t\t\t//Set Display Column in layout panel\n\t\t\t//Error: TypeError: null is not an object (evaluating 'this.column_selector.setSelectGridData')\n\t\t\tif ( this.column_selector ) {\n\t\t\t\t//If column layout has changed at all make sure the grid is updated.\n\t\t\t\tif ( !this.layout_changed && this.column_selector.getSelectGrid() && this.column_selector.getSelectGrid().getSetup() && !_.isEqual( display_columns, this.column_selector.getSelectGrid().getSetup() ) ) {\n\t\t\t\t\tthis.layout_changed = true;\n\t\t\t\t}\n\t\t\t\tthis.column_selector.setSelectGridData( display_columns );\n\t\t\t\t//this.column_selector.setGridColumnsWidths(); //This is called in SearchPanel.setGridSize() on expand instead, as browsers seem to optimize out scrollbar calculations until the DOM element is visible.\n\t\t\t}\n\n\t\t\t//Set Sort by awesomebox in layout panel\n\t\t\t//Error: TypeError: null is not an object (evaluating 'this.sort_by_selector.setSourceData')\n\t\t\tif ( this.sort_by_selector ) {\n\t\t\t\tthis.sort_by_selector.setSourceData( this.buildSortSelectorUnSelectColumns( display_columns ) );\n\t\t\t\tthis.sort_by_selector.setValue( this.buildSortBySelectColumns() );\n\t\t\t}\n\n\t\t\t//Set Previoous Saved layout combobox in layout panel\n\t\t\tvar layouts_array = this.search_panel.getLayoutsArray();\n\n\t\t\tthis.setPreviousSavedSearchSourcesAndValue( layouts_array );\n\n\t\t}\n\n\t\t//Set Data Grid on List view\n\t\tvar len = display_columns.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar view_column_data = display_columns[i];\n\n\t\t\tif ( $.inArray( view_column_data.value, exclude_column ) !== -1 ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar column_info = {\n\t\t\t\tname: view_column_data.value,\n\t\t\t\tindex: view_column_data.value,\n\t\t\t\tlabel: view_column_data.label,\n\t\t\t\twidth: 100,\n\t\t\t\tsortable: false,\n\t\t\t\ttitle: false\n\t\t\t};\n\t\t\tcolumn_info_array.push( column_info );\n\t\t}\n\n\t\tvar grid_needs_reload = false;\n\t\tif ( this.grid ) {\n\t\t\tgrid_id = this.ui_id + '_grid';\n\n\t\t\tif ( this.layout_changed == true ) {\n\t\t\t\t$this.layout_changed = false;\n\t\t\t\tthis.grid.grid.jqGrid( 'GridUnload' );\n\t\t\t\tthis.grid = null;\n\t\t\t} else {\n\t\t\t\t//This is done in BaseViewControler->search() right before the data is set, which prevents \"flashing\".\n\t\t\t\t//  However some views override this function and need to be fixed manually.\n\t\t\t\t//this.grid.clearGridData();\n\t\t\t}\n\t\t}\n\n\t\tthis.showGridBorders();\n\n\t\tif ( !this.grid ) {\n\t\t\tvar grid_setup = this.getGridSetup();\n\t\t\tif ( this.sub_view_mode ) {\n\t\t\t\tgrid_setup.height = 1;\n\t\t\t}\n\t\t\tthis.grid = new TTGrid( grid_id, grid_setup, column_info_array );\n\n\t\t\tif ( this.sub_view_mode ) {\n\t\t\t\tthis.grid.grid.hide();\n\t\t\t}\n\n\t\t\tthis.setGridColumnsWidth(); //Helps makes changing layouts \"flash\" less, especially when going from only a few columns to many.\n\t\t\tthis.setGridSize( this.ui_id, this.sub_view_mode, this.sub_view_grid_autosize, this.pager_data );\n\t\t}\n\n\t\tif ( this.grid && grid_needs_reload ) {\n\t\t\tthis.grid.reloadGrid();\n\t\t}\n\n\t\t//Add widget on UI and bind events. Next set data in it in search result\n\t\tif ( LocalCacheData.paging_type === 0 ) {\n\t\t\tif ( this.paging_widget.parent().length > 0 ) {\n\t\t\t\tthis.paging_widget.remove();\n\t\t\t}\n\n\t\t\tthis.paging_widget.css( 'width', this.grid.grid.width() );\n\t\t\tthis.grid.grid.append( this.paging_widget );\n\n\t\t\tthis.paging_widget.click( $this.onPaging() );\n\n\t\t} else {\n\t\t\t$( this.el ).find( '.total-number-div' ).append( this.paging_widget );\n\t\t\t$( this.el ).find( '.bottom-div' ).append( this.paging_widget_2 );\n\n\t\t\tthis.paging_widget.on( 'paging', function( e, action, page_number ) {\n\t\t\t\t$this.onPaging2( e, action, page_number );\n\t\t\t} );\n\t\t\tthis.paging_widget_2.bind( 'paging', function( e, action, page_number ) {\n\t\t\t\t$this.onPaging2( e, action, page_number );\n\t\t\t} );\n\t\t}\n\n\t\tthis.bindGridColumnEvents();\n\n\t\tthis.setGridHeaderStyle(); //Set Sort Style\n\t\t//replace select layout filter_data to filter set in onNavigation function when goto view from navigation context group\n\t\tif ( LocalCacheData.default_filter_for_next_open_view ) {\n\t\t\tthis.select_layout.data.filter_data = LocalCacheData.default_filter_for_next_open_view.filter_data;\n\t\t\tLocalCacheData.default_filter_for_next_open_view = null;\n\t\t}\n\n\t\tthis.filter_data = this.select_layout.data.filter_data;\n\n\t\tif ( !this.sub_view_mode ) {\n\t\t\tthis.setSearchPanelFilter( true ); //Auto change to property tab when set value to search fields.\n\t\t}\n\t}\n\n\tgetGridSetup() {\n\t\tvar $this = this;\n\n\t\tvar container = this.grid_parent ? this.grid_parent : '.grid-div';\n\t\tif ( !this.grid_parent && this.sub_view_mode ) {\n\t\t\tif ( $( '#' + this.ui_id + '_grid' ).parents( '.sub-view' ).length > 0 ) {\n\t\t\t\tcontainer = '.sub-grid-view-div';\n\t\t\t} else {\n\t\t\t\tcontainer = '.edit-view-tab-bar';\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tcontainer_selector: container,\n\t\t\tsub_grid_mode: this.sub_view_mode,\n\t\t\tonResizeGrid: true,\n\t\t\tonSelectRow: function() {\n\t\t\t\t$this.onGridSelectRow();\n\t\t\t},\n\t\t\tonCellSelect: function() {\n\t\t\t\t$this.onGridSelectRow();\n\t\t\t},\n\t\t\tonSelectAll: function() {\n\t\t\t\t$this.onGridSelectAll();\n\t\t\t},\n\t\t\tondblClickRow: function( e ) {\n\t\t\t\t$this.onGridDblClickRow( e );\n\t\t\t},\n\t\t\tonRightClickRow: function( rowId ) {\n\t\t\t\tvar id_array = $this.getGridSelectIdArray();\n\t\t\t\tif ( id_array.indexOf( rowId ) < 0 ) {\n\t\t\t\t\t$this.grid.grid.resetSelection();\n\t\t\t\t\t$this.grid.grid.setSelection( rowId );\n\t\t\t\t\t$this.onGridSelectRow();\n\t\t\t\t}\n\t\t\t},\n\t\t\theight: 1, //Start really small to reduce flashing, as height is changed with setGridSize() shortly after anyways.\n\t\t};\n\t}\n\n\tonGridSelectAll() {\n\t\tthis.setDefaultMenu();\n\t}\n\n\tunSelectAll() {\n\t\tthis.grid.grid.resetSelection();\n\t}\n\n\tonGridDblClickRow( e ) {\n\t\tthis.grid.grid.resetSelection();\n\t\tthis.grid.setSelection( e, false );\n\t\tthis.setDefaultMenu( true );\n\t\tvar context_menu_array = ContextMenuManager.getMenuModelByMenuId( this.determineContextMenuMountAttributes().id );\n\t\tvar len = context_menu_array.length;\n\t\tvar need_break = false;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tif ( need_break ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar id = context_menu_array[i].id;\n\t\t\tswitch ( id ) {\n\t\t\t\tcase 'edit':\n\t\t\t\t\tif ( !context_menu_array[i].disabled && context_menu_array[i].visible ) {\n\t\t\t\t\t\tProgressBar.showOverlay();\n\t\t\t\t\t\tthis.onEditClick();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tif ( need_break ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar id = context_menu_array[i].id;\n\t\t\tswitch ( id ) {\n\t\t\t\tcase 'view':\n\t\t\t\t\tneed_break = true;\n\t\t\t\t\tif ( !context_menu_array[i].disabled && context_menu_array[i].visible ) {\n\t\t\t\t\t\tProgressBar.showOverlay();\n\t\t\t\t\t\tthis.onViewClick();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar id = context_menu_array[i].id;\n\t\t\tswitch ( id ) {\n\t\t\t\tcase 'add':\n\t\t\t\t\tif ( !context_menu_array[i].disabled && context_menu_array[i].visible ) {\n\t\t\t\t\t\tthis.onAddClick();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tonPaging() {\n\t\tthis.search( true, 'next' );\n\t}\n\n\tonPaging2( e, action, page_number ) {\n\t\tthis.search( true, action, page_number );\n\t}\n\n\t//Bind column click event to change sort type and save columns to t_grid_header_array to use to set column style (asc or desc)\n\tbindGridColumnEvents() {\n\t\tvar display_columns = this.grid.getColumnModel();\n\n\t\tif ( !display_columns ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar len = display_columns.length;\n\n\t\tthis.t_grid_header_array = [];\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar column_info = display_columns[i];\n\t\t\tvar column_header = $( $( this.el ).find( '#gbox_' + this.ui_id + '_grid' ).find( 'div #jqgh_' + this.ui_id + '_grid_' + column_info.name ) );\n\n\t\t\tthis.t_grid_header_array.push( column_header.TGridHeader() );\n\t\t\tif ( this.search_panel ) {\n\t\t\t\tcolumn_header.on( 'click', onColumnHeaderClick );\n\t\t\t}\n\t\t}\n\n\t\tvar $this = this;\n\n\t\tfunction onColumnHeaderClick( e ) {\n\t\t\tvar field = $( this ).attr( 'id' );\n\t\t\tfield = field.substring( 10 + $this.ui_id.length + 1, field.length );\n\n\t\t\tif ( field === 'cb' ) { //first column, check box column.\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\te.preventDefault(); //can't be cancelled before cb is detected as we need the default event in that case.\n\n\t\t\tif ( !$this.sorting_rows ) {\n\t\t\t\t$this.sorting_rows = true;\n\t\t\t\tTTPromise.add( 'init', 'init' );\n\t\t\t\tTTPromise.wait( null, null, function() {\n\t\t\t\t\t$this.sorting_rows = false; //prevent doubling up events ( which loops forever )\n\t\t\t\t} );\n\n\t\t\t\tif ( e.metaKey || e.ctrlKey ) {\n\t\t\t\t\t$this.buildSortCondition( false, field );\n\t\t\t\t} else {\n\t\t\t\t\t$this.buildSortCondition( true, field );\n\n\t\t\t\t}\n\n\t\t\t\tif ( $this.sub_view_mode ) {\n\t\t\t\t\t$this.search();\n\t\t\t\t\t$this.setGridHeaderStyle();\n\t\t\t\t} else {\n\t\t\t\t\tif ( $this.sort_by_selector ) {\n\t\t\t\t\t\t$this.sort_by_selector.setValue( $this.buildSortBySelectColumns() );\n\t\t\t\t\t}\n\t\t\t\t\t$this.onSearch();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tDebug.Text( 'Skipping column sort call ', '', 'BaseViewController', 'onColumnHeaderClick', 10 );\n\t\t\t}\n\n\t\t}\n\t}\n\n\tgetValidSearchFilter() {\n\t\tvar validFilterData = {};\n\t\tfor ( var key in this.filter_data ) {\n\t\t\t// Error: Unable to get property 'value' of undefined or null reference in /interface/html5/views/BaseViewController.js?v=8.0.6-20150417-143734 line 4727\n\t\t\tif ( Global.isSet( this.filter_data[key] ) && Global.isSet( this.filter_data[key].value ) && this.filter_data[key].value !== '' ) {\n\t\t\t\tvalidFilterData[key] = this.filter_data[key];\n\t\t\t}\n\t\t}\n\n\t\treturn validFilterData;\n\t}\n\n\tgetSearchPanelDisplayColumns() {\n\t\tvar display_columns = [];\n\n\t\tvar select_items = this.column_selector?.getSelectItems();\n\n\t\tif ( select_items && select_items.length > 0 ) {\n\t\t\t$.each( select_items, function( index, content ) {\n\t\t\t\tdisplay_columns.push( content.value );\n\t\t\t} );\n\t\t}\n\n\t\tif ( !display_columns || display_columns.length == 0 ) {\n\t\t\tdisplay_columns = this.default_display_columns;\n\t\t}\n\n\t\treturn display_columns;\n\t}\n\n\tgetSearchPanelSortFilter() {\n\t\tvar sort_filter = [];\n\t\tif ( this.sort_by_selector ) {\n\t\t\tvar select_items = this.sort_by_selector.getValue( true );\n\n\t\t\tif ( select_items && select_items.length > 0 ) {\n\t\t\t\t$.each( select_items, function( index, content ) {\n\t\t\t\t\tvar sort = {};\n\t\t\t\t\tsort[content.value] = content.sort;\n\t\t\t\t\tsort_filter.push( sort );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t\treturn sort_filter;\n\t}\n\n\tgetSearchPanelFilter( getFromTabIndex, save_temp_filter ) {\n\t\tif ( !this.search_panel ) {\n\t\t\treturn;\n\t\t}\n\t\tif ( Global.isSet( getFromTabIndex ) ) {\n\t\t\tvar search_tab_select_index = getFromTabIndex;\n\t\t} else {\n\t\t\tsearch_tab_select_index = this.search_panel.getSelectTabIndex();\n\t\t}\n\n//\t\tvar basic_fields_len = this.search_fields.length;\n\t\tvar target_ui_dic = null;\n\n\t\tif ( search_tab_select_index === 0 ) {\n\t\t\tthis.filter_data = [];\n\t\t\ttarget_ui_dic = this.basic_search_field_ui_dic;\n\t\t} else if ( search_tab_select_index === 1 && this.search_panel.isAdvTabVisible() ) {\n\t\t\tthis.filter_data = [];\n\t\t\ttarget_ui_dic = this.adv_search_field_ui_dic;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\tvar $this = this;\n\t\t$.each( target_ui_dic, function( key, content ) {\n\t\t\t$this.filter_data[key] = { field: key, id: '', value: target_ui_dic[key].getValue( true ) };\n\n\t\t\tif ( $this.temp_basic_filter_data ) {\n\t\t\t\t$this.temp_basic_filter_data[key] = $this.filter_data[key];\n\t\t\t}\n\n\t\t\tif ( $this.temp_adv_filter_data ) {\n\t\t\t\t$this.temp_adv_filter_data[key] = $this.filter_data[key];\n\t\t\t}\n\t\t} );\n\n\t\tif ( save_temp_filter ) {\n\t\t\tif ( search_tab_select_index === 0 ) {\n\t\t\t\t$this.temp_basic_filter_data = Global.clone( $this.filter_data );\n\t\t\t} else if ( search_tab_select_index === 1 ) {\n\t\t\t\t$this.temp_adv_filter_data = Global.clone( $this.filter_data );\n\t\t\t}\n\n\t\t}\n\t}\n\n\t//Set value to field UI in search tab\n\tsetSearchPanelFilter( autoChangeTab, tab_index ) {\n\n\t\tthis.clearSearchPanel();\n\n\t\tif ( !Global.isSet( autoChangeTab ) ) {\n\t\t\tautoChangeTab = false;\n\t\t}\n\n\t\tvar filter = this.filter_data;\n\n\t\tif ( Global.isSet( tab_index ) ) {\n\t\t\tif ( tab_index === 0 && this.temp_basic_filter_data ) {\n\t\t\t\tfilter = this.temp_basic_filter_data;\n\t\t\t} else if ( tab_index === 1 && this.temp_adv_filter_data ) {\n\t\t\t\tfilter = this.temp_adv_filter_data;\n\t\t\t}\n\t\t}\n\n\t\tif ( !Global.isSet( filter ) || !this.search_fields ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar basic_fields_len = this.search_fields.length;\n\n\t\tfor ( var i = 0; i < basic_fields_len; i++ ) {\n\t\t\tvar field = this.search_fields[i];\n\t\t\tvar field_name = field.get( 'field' );\n\n\t\t\tvar search_input = this.basic_search_field_ui_dic[field_name];\n\t\t\tvar search_input_1 = this.adv_search_field_ui_dic[field_name];\n\n\t\t\tif ( Global.isSet( filter[field_name] ) ) {\n\n\t\t\t\tif ( Global.isSet( search_input ) ) {\n\n\t\t\t\t\tif ( $.type( filter[field_name] ) === 'string' || $.type( filter[field_name] ) === 'number' ) {\n\t\t\t\t\t\tsearch_input.setValue( filter[field_name] );\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( filter[field_name].hasOwnProperty( 'value' ) ) { // when set default filter don't have 'value' in it, For example Invoice edit view\n\t\t\t\t\t\t\tsearch_input.setValue( filter[field_name].value );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsearch_input.setValue( filter[field_name] );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( autoChangeTab && !this.saving_layout_in_layout_tab ) {\n\t\t\t\t\tif ( this.search_panel.getSelectTabIndex() !== 1 ) {\n\t\t\t\t\t\tthis.search_panel.setSelectTabIndex( 1, false );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( Global.isSet( search_input_1 ) ) {\n\n\t\t\t\t\tif ( $.type( filter[field_name] ) === 'string' || $.type( filter[field_name] ) === 'number' ) {\n\t\t\t\t\t\tsearch_input_1.setValue( filter[field_name] );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( filter[field_name].hasOwnProperty( 'value' ) ) { // when set default filter don't have 'value' in it, For example Invoice edit view\n\t\t\t\t\t\t\tsearch_input_1.setValue( filter[field_name].value );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsearch_input_1.setValue( filter[field_name] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n//\t\t\t\t\tsearch_input_1.setValue( filter[field_name].value );\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.getSearchPanelFilter(); //Make sure filter only has fields on current display ab\n\n\t\tthis.search_panel.setSearchFlag( this.getValidSearchFilter() ); // Add ! to tab which has search condition in it\n\n\t\tthis.onSetSearchFilterFinished();\n\t}\n\n\t//Set Grid header style for asc or desc\n\tsetGridHeaderStyle() {\n\t\tfor ( var i = 0; i < this.t_grid_header_array.length; i++ ) {\n\t\t\tvar t_grid_header = this.t_grid_header_array[i];\n\n\t\t\tvar field = t_grid_header.attr( 'id' );\n\t\t\tif ( typeof field === 'string' || field instanceof String ) {\n\t\t\t\tfield = field.substring( 10 + this.ui_id.length + 1, field.length );\n\n\t\t\t\tt_grid_header.cleanSortStyle();\n\n\t\t\t\tif ( this.select_layout.data.filter_sort ) {\n\t\t\t\t\tvar sort_array_len = this.select_layout.data.filter_sort.length;\n\n\t\t\t\t\tfor ( var j = 0; j < sort_array_len; j++ ) {\n\t\t\t\t\t\tvar sort_item = this.select_layout.data.filter_sort[j];\n\t\t\t\t\t\tvar sortField = Global.getFirstKeyFromObject( sort_item );\n\t\t\t\t\t\tif ( sortField === field ) {\n\t\t\t\t\t\t\tif ( sort_array_len > 1 ) {\n\t\t\t\t\t\t\t\tt_grid_header.setSortStyle( sort_item[sortField], j + 1 );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tt_grid_header.setSortStyle( sort_item[sortField], 0 );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tbuildSortCondition( reset, field ) {\n\t\tvar next_sort = 'desc';\n\n\t\tif ( reset ) {\n\n\t\t\tif ( this.select_layout.data.filter_sort && this.select_layout.data.filter_sort.length > 0 ) {\n\t\t\t\tvar len = this.select_layout.data.filter_sort.length;\n\t\t\t\tvar found = false;\n\n\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\t\tvar sort_item = this.select_layout.data.filter_sort[i];\n\t\t\t\t\tfor ( var key in sort_item ) {\n\n\t\t\t\t\t\tif ( !sort_item.hasOwnProperty( key ) ) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( key === field ) {\n\t\t\t\t\t\t\tif ( sort_item[key] === 'asc' ) {\n\t\t\t\t\t\t\t\tnext_sort = 'desc';\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnext_sort = 'asc';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( found ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.select_layout.data.filter_sort = [\n\t\t\t\t{}\n\t\t\t];\n\t\t\tthis.select_layout.data.filter_sort[0][field] = next_sort;\n\n\t\t} else {\n\t\t\tif ( !this.select_layout.data.filter_sort ) {\n\t\t\t\tthis.select_layout.data.filter_sort = [\n\t\t\t\t\t{}\n\t\t\t\t];\n\t\t\t\tthis.select_layout.data.filter_sort[0][field] = 'asc';\n\t\t\t} else {\n\t\t\t\tlen = this.select_layout.data.filter_sort.length;\n\t\t\t\tfound = false;\n\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\t\tsort_item = this.select_layout.data.filter_sort[i];\n\t\t\t\t\tfor ( var key in sort_item ) {\n\n\t\t\t\t\t\tif ( !sort_item.hasOwnProperty( key ) ) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( key === field ) {\n\t\t\t\t\t\t\tif ( sort_item[key] === 'asc' ) {\n\t\t\t\t\t\t\t\tsort_item[key] = 'desc';\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsort_item[key] = 'asc';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( found ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( !found ) {\n\t\t\t\t\tthis.select_layout.data.filter_sort.push( {} );\n\t\t\t\t\tthis.select_layout.data.filter_sort[len][field] = 'asc';\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\n\tsearch( set_default_menu, page_action, page_number, callBack ) {\n\t\tif ( !Global.isSet( set_default_menu ) ) {\n\t\t\tset_default_menu = true;\n\t\t}\n\n\t\tvar filter = {};\n\t\tfilter.filter_data = {};\n\t\tfilter.filter_sort = {};\n\t\tfilter.filter_columns = this.getFilterColumnsFromDisplayColumns();\n\t\tfilter.filter_items_per_page = 0; // Default to 0 to load user preference defined\n\t\tif ( this.pager_data ) {\n\n\t\t\tif ( LocalCacheData.paging_type === 0 ) {\n\t\t\t\tif ( page_action === 'next' ) {\n\t\t\t\t\tfilter.filter_page = this.pager_data.next_page;\n\t\t\t\t} else {\n\t\t\t\t\tfilter.filter_page = 1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tswitch ( page_action ) {\n\t\t\t\t\tcase 'next':\n\t\t\t\t\t\tfilter.filter_page = this.pager_data.next_page;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'last':\n\t\t\t\t\t\tfilter.filter_page = this.pager_data.previous_page;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'start':\n\t\t\t\t\t\tfilter.filter_page = 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'end':\n\t\t\t\t\t\tfilter.filter_page = this.pager_data.last_page_number;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'go_to':\n\t\t\t\t\t\tfilter.filter_page = page_number;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tfilter.filter_page = this.pager_data.current_page;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfilter.filter_page = 1;\n\t\t}\n\n\t\tif ( this.select_layout?.data ) {\n\t\t\t//Error: Uncaught TypeError: Cannot read property 'data' of null\n\t\t\tif ( this.sub_view_mode && this.parent_key ) {\n\t\t\t\tthis.select_layout.data.filter_data[this.parent_key] = this.parent_value;\n\t\t\t}\n\t\t\t//Error: Uncaught TypeError: Cannot read property 'data' of null\n\t\t\t//If sub view controller set custom filters, get it\n\t\t\tif ( Global.isSet( this.getSubViewFilter ) ) {\n\t\t\t\tthis.select_layout.data.filter_data = this.getSubViewFilter( this.select_layout.data.filter_data );\n\t\t\t}\n\n\t\t\t//select_layout will not be null, it's set in setSelectLayout function\n\t\t\tfilter.filter_data = Global.convertLayoutFilterToAPIFilter( this.select_layout );\n\t\t\tfilter.filter_sort = this.select_layout.data.filter_sort;\n\t\t}\n\n\t\tif ( TTUUID.isUUID( this.refresh_id ) ) {\n\t\t\tfilter.filter_data = {};\n\t\t\tfilter.filter_data.id = [this.refresh_id];\n\n\t\t\tthis.last_select_ids = filter.filter_data.id;\n\n\t\t} else {\n\t\t\tthis.last_select_ids = [];\n\t\t\tvar ids = this.getGridSelectIdArray();\n\t\t\t//ensure detached reference to value source or lose this.last_select_ids when grid is cleared.\n\t\t\tfor ( var i = 0; i < ids.length; i++ ) {\n\t\t\t\tthis.last_select_ids.push( ids[i] );\n\t\t\t}\n\t\t}\n\n\t\tvar $this = this;\n\t\tthis.api['get' + this.api.key_name]( filter, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar result_data = result.getResult();\n\t\t\t\tvar len;\n\t\t\t\tif ( set_default_menu ) {\n\t\t\t\t\t$this.setDefaultMenu( true );\n\t\t\t\t}\n\t\t\t\tif ( !Global.isArray( result_data ) && ( !TTUUID.isUUID( $this.refresh_id ) || $this.refresh_id == TTUUID.zero_id || $this.refresh_id == TTUUID.not_exist_id ) ) {\n\t\t\t\t\t$this.refresh_id = null;\n\t\t\t\t\t$this.showNoResultCover();\n\t\t\t\t} else {\n\t\t\t\t\t$this.removeNoResultCover();\n\t\t\t\t\tif ( Global.isSet( $this.__createRowId ) ) {\n\t\t\t\t\t\tresult_data = $this.__createRowId( result_data );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( Global.isSet( $this.showGridOptionFields ) ) {\n\t\t\t\t\t\tresult_data = $this.showGridOptionFields( result_data );\n\t\t\t\t\t}\n\n\t\t\t\t\tresult_data = Global.formatGridData( result_data, $this.api.key_name );\n\t\t\t\t\tlen = result_data.length;\n\t\t\t\t}\n\n\t\t\t\tif ( TTUUID.isUUID( $this.refresh_id ) ) {\n\t\t\t\t\t$this.refresh_id = null;\n\t\t\t\t\tvar grid_source_data = $this.grid?.getData();\n\t\t\t\t\tlen = grid_source_data.length;\n\t\t\t\t\tif ( $.type( grid_source_data ) !== 'array' ) {\n\t\t\t\t\t\tgrid_source_data = [];\n\t\t\t\t\t}\n\t\t\t\t\tvar found = false;\n\t\t\t\t\tvar new_record = result_data[0];\n\t\t\t\t\t//Error: Uncaught TypeError: Cannot read property 'id' of undefined in /interface/html5/views/BaseViewController.js?v=7.4.3-20140924-084605 line 4851\n\t\t\t\t\tif ( new_record ) {\n\t\t\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\t\t\t\tvar record = grid_source_data[i];\n\t\t\t\t\t\t\t//Fixed === issue. The id set by jQGrid is string type.\n\t\t\t\t\t\t\t//Commented out as we now expect the variable type of the ids to be UUID (string in javascript)\n\t\t\t\t\t\t\t//if ( !isNaN( parseInt( record.id ) ) ) {\n\t\t\t\t\t\t\t//\trecord.id = parseInt( record.id );\n\t\t\t\t\t\t\t//}\n\t\t\t\t\t\t\tif ( record.id == new_record.id ) {\n\t\t\t\t\t\t\t\t$this.grid.setRowData( new_record.id, new_record );\n\t\t\t\t\t\t\t\tgrid_source_data[i] = new_record;\n\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( !found ) {\n\t\t\t\t\t\t\t$this.grid.setData( grid_source_data.concat( new_record ) );\n\t\t\t\t\t\t\t// $this.setGridColumnsWidth();\n\t\t\t\t\t\t\t// if ( $this.sub_view_mode && Global.isSet( $this.resizeSubGrid ) ) {\n\t\t\t\t\t\t\t// \tlen = Global.isSet( len ) ? len : 0;\n\t\t\t\t\t\t\t// \t$this.resizeSubGrid( len + 1 );\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t$this.highLightGridRowById( new_record.id );\n\t\t\t\t\t\t\t$this.reSelectLastSelectItems();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t//Set Page data to widget, next show display info when setDefault Menu\n\t\t\t\t\t$this.pager_data = result.getPagerData();\n\t\t\t\t\t//CLick to show more mode no need this step\n\t\t\t\t\tif ( LocalCacheData.paging_type !== 0 && $this.paging_widget && $this.paging_widget_2 ) {\n\t\t\t\t\t\t$this.paging_widget.setPagerData( $this.pager_data );\n\t\t\t\t\t\t$this.paging_widget_2.setPagerData( $this.pager_data );\n\t\t\t\t\t}\n\t\t\t\t\tif ( LocalCacheData.paging_type === 0 && page_action === 'next' ) {\n\t\t\t\t\t\tvar current_data = $this.grid.getData();\n\t\t\t\t\t\tresult_data = current_data.concat( result_data );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Process result_data if necessary, this always needs override.\n\t\t\t\t\tresult_data = $this.processResultData( result_data );\n\n\t\t\t\t\tif ( $this.grid ) {\n\t\t\t\t\t\t$this.grid.setData( result_data ); //This calls clearGridData and reloadGrid.\n\n\t\t\t\t\t\t//$this.setGridColumnsWidth(); //Handle in searchDone() instead.\n\t\t\t\t\t\t// if ( $this.sub_view_mode && Global.isSet( $this.resizeSubGrid ) ) {\n\t\t\t\t\t\t// \t$this.resizeSubGrid( len );\n\t\t\t\t\t\t// }\n\t\t\t\t\t\t$this.reSelectLastSelectItems();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\t$this.setGridCellBackGround(); //Set cell background for some views\n\t\t\t\tProgressBar.closeOverlay(); //Add this in initData\n\t\t\t\tif ( LocalCacheData.paging_type === 0 ) {\n\t\t\t\t\tif ( !$this.pager_data || $this.pager_data.is_last_page ) {\n\t\t\t\t\t\t$this.paging_widget.css( 'display', 'none' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.paging_widget.css( 'display', 'block' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( callBack ) {\n\t\t\t\t\tcallBack( result );\n\t\t\t\t}\n\t\t\t\t// when call this from save and new result, we don't call auto open, because this will call onAddClick twice\n\t\t\t\tif ( set_default_menu ) {\n\t\t\t\t\t$this.autoOpenEditViewIfNecessary();\n\t\t\t\t}\n\t\t\t\t$this.searchDone();\n\t\t\t}\n\t\t} );\n\t}\n\n\t//This shouldn't be called anymore, in favor of: baseViewSubTabGridResize()\n\tresizeSubGrid( length ) {\n\t\tvar height = ( length * 26 >= 200 ) ? 200 : length * 26;\n\t\tif ( $( '.edit-view-tab:visible .grid-div' ).length > 1 ) {\n\t\t\tif ( height < 100 ) {\n\t\t\t\theight = 100;\n\t\t\t}\n\t\t} else {\n\t\t\theight = ( $( '.edit-view-tab:visible' ).parent().height() - 85 );\n\t\t}\n\t\tthis.setGridColumnsWidth();\n\t\tthis.setGridHeight( height );\n\t}\n\n\tsetGridColumnsWidth() {\n\t\tif ( this.grid ) {\n\t\t\tthis.grid.setGridColumnsWidth();\n\t\t}\n\t}\n\n\tsetGridHeight( height ) {\n\t\tif ( this.grid ) {\n\t\t\tthis.grid.setGridHeight( height );\n\t\t}\n\t}\n\n\tsetGridWidth( width ) {\n\t\tif ( this.grid ) {\n\t\t\tthis.grid.setGridWidth( width );\n\t\t}\n\t}\n\n\tprocessResultData( result_data ) {\n\t\t//Always needs override\n\t\treturn result_data;\n\t}\n\n\tsearchDone() {\n\t\t//the rotate icon from search panel\n\t\tvar $this = this;\n\t\t$( '.button-rotate' ).removeClass( 'button-rotate' );\n\n\t\tthis.setTotalDisplaySpan();\n\n\t\tthis.setGridColumnsWidth();\n\t\tthis.setGridSize( this.ui_id, this.sub_view_mode, this.sub_view_grid_autosize, this.pager_data );\n\n\t\tif ( this.sub_view_mode && this.grid ) {\n\t\t\tthis.grid.grid.show();\n\t\t}\n\n\t\tTTPromise.resolve( 'BaseViewController', 'onTabShow' );\n\t\tTTPromise.resolve( 'init', 'init' );\n\t}\n\n\treSelectLastSelectItems() {\n\t\tvar $this = this;\n\t\tif ( this.last_select_ids && this.last_select_ids.length > 0 ) {\n\t\t\t$.each( this.last_select_ids, function( index, content ) {\n\t\t\t\t$this.grid.grid.setSelection( content, false );\n\n\t\t\t\tif ( $this.grid_select_id_array ) {\n\t\t\t\t\t$this.grid_select_id_array.push( content );\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\tthis.last_select_ids = [];\n\t\t\tif ( !this.edit_view ) {\n\t\t\t\tthis.setDefaultMenu();\n\t\t\t}\n\t\t}\n\t}\n\n\tautoOpenEditViewIfNecessary() {\n\t\t//Auto open edit view. Should set in IndexController\n\n\t\t//There are various bugs that happen when auto opening edit views during sub_view_mode from a \"Jump To\" action. (Master branch also and not onlu Vue)\n\t\t//This is due to the fact that the view inherits the \"LocalCacheData.current_doing_context_action\" of the last view. Examples:\n\t\t// - TimeSheet -> Add Punch -> Jump To -> Edit Employee and switching tabs would auto open a new entry instead of list view.\n\t\t// - TimeSheet -> Add Punch -> Jump To -> Add Request would cause the user stuck to be stuck in the view.\n\t\tif ( this.sub_view_mode && !LocalCacheData.edit_id_for_next_open_view ) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch ( LocalCacheData.current_doing_context_action ) {\n\t\t\tcase 'edit':\n\t\t\t\tif ( LocalCacheData.edit_id_for_next_open_view ) {\n\t\t\t\t\tthis.onEditClick( LocalCacheData.edit_id_for_next_open_view );\n\t\t\t\t\tLocalCacheData.edit_id_for_next_open_view = null;\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'view':\n\t\t\t\tif ( LocalCacheData.edit_id_for_next_open_view ) {\n\t\t\t\t\tthis.onViewClick( LocalCacheData.edit_id_for_next_open_view );\n\t\t\t\t\tLocalCacheData.edit_id_for_next_open_view = null;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'new':\n\t\t\t\tif ( !this.edit_view ) {\n\t\t\t\t\tthis.onAddClick();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.autoOpenEditOnlyViewIfNecessary();\n\t}\n\n\tautoOpenEditOnlyViewIfNecessary() {\n\n\t\t//Don't try to open anything if current loading a sub view\n\t\tif ( this.sub_view_mode ) {\n\t\t\treturn;\n\t\t}\n\t\tif ( LocalCacheData.getAllURLArgs() && LocalCacheData.getAllURLArgs().sm && !LocalCacheData.current_open_edit_only_controller ) {\n\n\t\t\tif ( LocalCacheData.getAllURLArgs().sm.indexOf( 'Report' ) < 0 ) {\n\t\t\t\tIndexViewController.openEditView( this, LocalCacheData.getAllURLArgs().sm, LocalCacheData.getAllURLArgs().sid );\n\t\t\t} else {\n\t\t\t\tIndexViewController.openReport( this, LocalCacheData.getAllURLArgs().sm );\n\n\t\t\t\tif ( LocalCacheData.getAllURLArgs().sid ) {\n\t\t\t\t\tLocalCacheData.default_edit_id_for_next_open_edit_view = LocalCacheData.getAllURLArgs().sid;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\n\tsetGridCellBackGround() {\n\t\t//Set background color for in_use=false rows for all policy view and RecurringScheduleTemplateControlView\n\t\tif ( this.grid\n\t\t\t&&\n\t\t\t(\n\t\t\t\tthis.script_name.indexOf( 'Policy' ) >= 0 ||\n\t\t\t\tthis.script_name === 'RecurringScheduleTemplateControlView' ||\n\t\t\t\tthis.script_name === 'PayCodeView' ||\n\t\t\t\tthis.script_name === 'RecurringHolidayView' ||\n\t\t\t\tthis.script_name === 'LegalEntityView' ||\n\t\t\t\tthis.script_name === 'RemittanceSourceAccountView' ||\n\t\t\t\tthis.script_name === 'PayrollRemittanceAgencyView' ||\n\t\t\t\tthis.script_name === 'RemittanceDestinationAccountView'\n\t\t\t)\n\t\t) {\n\t\t\tvar data = this.grid.getData();\n\n\t\t\t//Error: TypeError: data is undefined in /interface/html5/framework/jquery.min.js?v=7.4.6-20141027-074127 line 2 > eval line 70\n\t\t\tif ( !data ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar len = data.length;\n\n\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\tvar item = data[i];\n\n\t\t\t\tif ( item.is_in_use === false ) {\n\t\t\t\t\t$( 'tr[id=\\'' + item.id + '\\']' ).addClass( 'policy-not-in-use' );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tshowGridBorders() {\n\t\tvar top_border = $( this.el ).find( '.grid-top-border' );\n\t\tvar bottom_border = $( this.el ).find( '.grid-bottom-border' );\n\n\t\ttop_border.css( 'display', 'block' );\n\t\tbottom_border.css( 'display', 'block' );\n\t}\n\n\t_setGridSizeGroupheight( header_size ) {\n\t\tthis.grid.grid.setGridHeight( ( $( this.el ).height() - ( this.search_panel && this.search_panel.is( ':visible' ) ? this.search_panel.height() : 0 ) - 43 - header_size ) );\n\t}\n\n\tsetEditViewTabSize() {\n\t\tvar $this = this;\n\t\tvar tab_bar_label = this.edit_view_tab.find( '.edit-view-tab-bar-label' );\n\t\tvar tab_width = this.edit_view_tab.width() - 80; // -80 is to hopefully account for the 20px padding and margin for the context-border\n\t\tvar nav_width = this.edit_view_tab.find( '.navigation-div' ).width();\n\t\tvar wrap_div = this.edit_view.find( '.tab-label-wrap' );\n\n\t\tvar total_tab_width = 0;\n\t\ttab_bar_label.children().each( function() {\n\t\t\ttotal_tab_width += $( this ).width();\n\t\t} );\n\n\t\tif ( total_tab_width > ( tab_width - nav_width - 25 ) ) {\n\n\t\t\ttab_bar_label.width( total_tab_width + 20 );\n\n\t\t\tif ( wrap_div.length === 0 ) {\n\t\t\t\tvar right_arrow = $( '<img class=\"tab-arrow tab-right-arrow\" style=\"display: none\" src=\"theme/default/images/right_big_arrow.png\" >' );\n\t\t\t\tvar left_arrow = $( '<img class=\"tab-arrow tab-left-arrow\" style=\"display: none\" src=\"theme/default/images/left_big_arrow.png\" >' );\n\t\t\t\twrap_div = $( '<div class=\"tab-label-wrap\"><div class=\"label-wrap\"></div><div class=\"btn-wrap\"></div></div>' );\n\t\t\t\twrap_div.insertBefore( tab_bar_label );\n\t\t\t\twrap_div.width( tab_width - nav_width - 25 );\n\t\t\t\twrap_div.children().eq( 0 ).width( tab_width - nav_width - 100 );\n\t\t\t\twrap_div.children().eq( 0 ).append( tab_bar_label );\n\t\t\t\twrap_div.children().eq( 1 ).append( left_arrow );\n\t\t\t\twrap_div.children().eq( 1 ).append( right_arrow );\n\n\t\t\t\tright_arrow.bind( 'click', function() {\n\t\t\t\t\twrap_div.children().eq( 0 ).scrollLeft( wrap_div.children().eq( 0 ).scrollLeft() + 500 );\n\t\t\t\t\tsetArrowStatus();\n\t\t\t\t} );\n\t\t\t\tleft_arrow.bind( 'click', function() {\n\t\t\t\t\twrap_div.children().eq( 0 ).scrollLeft( wrap_div.children().eq( 0 ).scrollLeft() - 500 );\n\t\t\t\t\tsetArrowStatus();\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\twrap_div.width( tab_width - nav_width - 25 );\n\t\t\t\twrap_div.children().eq( 0 ).width( tab_width - nav_width - 100 );\n\t\t\t}\n\n\t\t\tif ( tab_bar_label.children().eq( 0 ).is( ':visible' ) && !this.is_mass_editing ) {\n\t\t\t\tthis.edit_view_tab.find( '.tab-arrow' ).show();\n\t\t\t} else {\n\t\t\t\tthis.edit_view_tab.find( '.tab-arrow' ).hide();\n\t\t\t}\n\n\t\t\tsetArrowStatus();\n\n\t\t} else {\n\t\t\ttab_bar_label.width( 'auto' );\n\t\t\tif ( wrap_div.length > 0 ) {\n\t\t\t\ttab_bar_label.insertBefore( wrap_div );\n\t\t\t\twrap_div.remove();\n\n\t\t\t}\n\t\t}\n\n\t\tfunction setArrowStatus() {\n\t\t\tvar left_arrow = $this.edit_view_tab.find( '.tab-left-arrow' );\n\t\t\tvar right_arrow = $this.edit_view_tab.find( '.tab-right-arrow' );\n\t\t\tvar label_wrap = wrap_div.children().eq( 0 );\n\n\t\t\tleft_arrow.removeClass( 'disable-image' );\n\t\t\tright_arrow.removeClass( 'disable-image' );\n\n\t\t\tif ( label_wrap.scrollLeft() === 0 ) {\n\t\t\t\tleft_arrow.addClass( 'disable-image' );\n\t\t\t}\n\n\t\t\t//Ceil and abs required as value can be off by a tiny pixel amount such as 1.2.\n\t\t\tif ( Math.abs( label_wrap.scrollLeft() - Math.ceil( label_wrap[0].scrollWidth - label_wrap.width() ) ) < 2 ) {\n\t\t\t\tright_arrow.addClass( 'disable-image' );\n\t\t\t}\n\n\t\t}\n\t}\n\n\tgetFilterColumnsFromDisplayColumns( column_filter, enable_system_columns ) {\n\t\treturn this._getFilterColumnsFromDisplayColumns( column_filter, enable_system_columns );\n\t}\n\n\t/**\n\t * super for getFilterColumnsFromDisplayColumns\n\t * used when function is overridden by child class.\n\t *\n\t * @param column_filter\n\t * @param enable_system_columns TRUE\n\t * @returns {*}\n\t * @private\n\t */\n\t_getFilterColumnsFromDisplayColumns( column_filter, enable_system_columns ) {\n\t\tif ( !column_filter ) {\n\t\t\tcolumn_filter = {};\n\t\t}\n\n\t\tif ( enable_system_columns == undefined || enable_system_columns == true ) {\n\t\t\tcolumn_filter.is_owner = true;\n\t\t\tcolumn_filter.id = true;\n\t\t\tcolumn_filter.is_child = true;\n\t\t\tcolumn_filter.in_use = true;\n\t\t\tcolumn_filter.first_name = true;\n\t\t\tcolumn_filter.last_name = true;\n\t\t}\n\n\t\tvar display_columns = {};\n\n\t\tif ( Global.isSet( LocalCacheData.view_layout_cache[this.script_name] ) ) {\n\t\t\tvar result = LocalCacheData.view_layout_cache[this.script_name].getResult();\n\t\t\tif ( result != undefined && result.length > 0 ) {\n\t\t\t\tdisplay_columns = result[0].data.display_columns;\n\t\t\t}\n\t\t}\n\n\t\tif ( this.select_layout && this.select_layout.data && this.select_layout.data.display_columns ) {\n\t\t\tfor ( var n in this.select_layout.data.display_columns ) {\n\t\t\t\tdisplay_columns[n] = this.select_layout.data.display_columns[n];\n\t\t\t}\n\t\t}\n\n\t\t//get the default display columns if no columns have been defined.\n\t\tif ( display_columns.length == undefined || ( display_columns.length == 0 && Global.isSet( this.default_display_columns ) ) ) {\n\t\t\tdisplay_columns = this.default_display_columns;\n\t\t}\n\n\t\t//Fixed possible exception -- Error: Unable to get property 'length' of undefined or null reference in /interface/html5/views/BaseViewController.js?v=7.4.3-20140924-090129 line 5031\n\t\tif ( display_columns.length != undefined && display_columns.length > 0 ) {\n\t\t\tvar len = display_columns.length;\n\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\tcolumn_filter[display_columns[i]] = true;\n\t\t\t}\n\t\t}\n\n\t\treturn column_filter;\n\t}\n\n\tgetAllLayouts( callBack ) {\n\n\t\tvar $this = this;\n\n\t\tvar current_select_layout_name;\n\n\t\tif ( this.need_select_layout_name ) {\n\t\t\tcurrent_select_layout_name = this.need_select_layout_name;\n\t\t\tthis.need_select_layout_name = '';\n\t\t} else {\n\t\t\tcurrent_select_layout_name = BaseViewController.default_layout_name;\n\t\t}\n\n\t\t//Issue #3286 - Users without permission to display \"Current View\" dropdown on TimeSheet still need to load select layout from user generic data\n\t\t//This is to ensure the API attempts to update the current layout and not create a new one causing a validation error.\n\t\t//force_get_select_layout still gets the layout data, but does not display it.\n\t\tif ( !this.force_get_select_layout && ( this.sub_view_mode || !this.show_search_tab ) ) {\n\t\t\t$this.select_layout = null;\n\t\t\tif ( callBack ) {\n\t\t\t\tcallBack();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Check view layout cache.\n\t\tif ( LocalCacheData.view_layout_cache[this.script_name] ) {\n\t\t\t//Make this async way\n\t\t\tsetTimeout( function() {\n\t\t\t\tonGetUserGenericDataResult( LocalCacheData.view_layout_cache[$this.script_name] );\n\t\t\t}, 0 );\n\t\t} else {\n\t\t\tif ( !this.user_generic_data_api ) {\n\t\t\t\tthis.user_generic_data_api = TTAPI.APIUserGenericData;\n\t\t\t}\n\t\t\tthis.user_generic_data_api.getUserGenericData( {\n\t\t\t\tfilter_data: {\n\t\t\t\t\tscript: this.script_name,\n\t\t\t\t\tdeleted: false\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\tonResult: function( results ) {\n\t\t\t\t\tonGetUserGenericDataResult( results );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\tfunction onGetUserGenericDataResult( results ) {\n\t\t\tif ( results ) {\n\t\t\t\tvar result_data = results.getResult();\n\t\t\t\t$this.select_layout = null; //Reset select layout;\n\t\t\t\tLocalCacheData.view_layout_cache[$this.script_name] = results;\n\t\t\t\tif ( result_data && result_data.length > 0 ) {\n\t\t\t\t\tresult_data.sort( function( a, b ) {\n\t\t\t\t\t\t\treturn Global.compare( a, b, 'name' );\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tvar len = result_data.length;\n\t\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\t\t\tvar layout = result_data[i];\n\t\t\t\t\t\tif ( layout.name === current_select_layout_name ) {\n\t\t\t\t\t\t\t$this.select_layout = layout;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif ( !$this.select_layout ) {\n\t\t\t\t\t\t$this.select_layout = result_data[0];\n\t\t\t\t\t}\n\t\t\t\t\t$this.search_panel.setLayoutsArray( result_data );\n\t\t\t\t} else {\n\t\t\t\t\t$this.select_layout = null;\n\t\t\t\t\tif ( $this.search_panel ) {\n\t\t\t\t\t\t$this.search_panel.setLayoutsArray( null );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( callBack ) {\n\t\t\t\t\tcallBack();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAllColumns( callBack ) {\n\t\tvar $this = this;\n\t\tthis.api.getOptions( 'columns', {\n\t\t\tonResult: function( columns_result ) {\n\t\t\t\tvar columns_result_data = columns_result.getResult();\n\n\t\t\t\t$this.all_columns = Global.buildColumnArray( columns_result_data );\n\t\t\t\tif ( !$this.sub_view_mode && $this.column_selector ) {\n\t\t\t\t\t$this.column_selector.setUnselectedGridData( $this.all_columns );\n\t\t\t\t\t$this.column_selector.setHeight( $this.all_columns.length * 32 );\n\t\t\t\t}\n\n\t\t\t\tif ( callBack ) {\n\t\t\t\t\tcallBack();\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tgetDefaultDisplayColumns( callBack ) {\n\n\t\tvar $this = this;\n\t\tthis.api.getOptions( 'default_display_columns', {\n\t\t\tonResult: function( columns_result ) {\n\n\t\t\t\tvar columns_result_data = columns_result.getResult();\n\n\t\t\t\t$this.default_display_columns = columns_result_data;\n\n\t\t\t\tif ( callBack ) {\n\t\t\t\t\tcallBack();\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tbuildSortBySelectColumns() {\n\t\tvar sort_by_array = this.select_layout.data.filter_sort;\n\t\tvar sort_by_select_columns = [];\n\t\tvar sort_by_unselect_columns = this.sort_by_selector.getSourceData();\n\n\t\tif ( sort_by_array ) {\n\t\t\t$.each( sort_by_array, function( index, content ) {\n\n\t\t\t\tfor ( var key in content ) {\n\n\t\t\t\t\t$.each( sort_by_unselect_columns, function( index1, content1 ) {\n\t\t\t\t\t\tif ( content1.value === key ) {\n\t\t\t\t\t\t\tcontent1.sort = content[key];\n\t\t\t\t\t\t\tsort_by_select_columns.push( content1 );\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t} );\n\t\t}\n\n\t\treturn sort_by_select_columns;\n\t}\n\n\tbuildSortSelectorUnSelectColumns( display_columns ) {\n\t\tvar fina_array = [];\n\t\tvar i = 100;\n\t\t$.each( display_columns, function( index, content ) {\n\t\t\tvar new_content = $.extend( {}, content );\n\t\t\tnew_content.id = i; //Need\n\t\t\tnew_content.sort = 'asc';\n\t\t\tfina_array.push( new_content );\n\t\t\ti = i + 1;\n\t\t} );\n\n\t\treturn fina_array;\n\t}\n\n\tbuildDisplayColumns( apiDisplayColumnsArray ) {\n\n\t\tvar len = this.all_columns.length;\n\t\tvar len1 = apiDisplayColumnsArray.length;\n\t\tvar display_columns = [];\n\n\t\tfor ( var j = 0; j < len1; j++ ) {\n\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\tif ( apiDisplayColumnsArray[j] === this.all_columns[i].value ) {\n\t\t\t\t\tdisplay_columns.push( this.all_columns[i] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn display_columns;\n\t}\n\n\tbuildDisplayColumnsByColumnModel( colModel ) {\n\n\t\tif ( !colModel ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar len = colModel.length;\n\t\tvar display_columns = [];\n\t\tvar id = 2000; // Makse sure the id not duplicate with all_columns, this wiil be used in acombox, set possible columns in navigation mode\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar column = colModel[i];\n\t\t\tif ( column.name === 'cb' ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tdisplay_columns.push( { label: column.label, value: column.name, id: id } );\n\t\t\tid = id + 1;\n\t\t}\n\n\t\treturn display_columns;\n\t}\n\n\tremoveContentMenuByName( name ) {\n\t\t// VUE NOTE: This function is for the legacy context menu, this is not for the Vue context menu, as legacy only has to delete a contextmenu from a view, Vue has menus in multiple places instead. See BaseViewController.unmountContextMenu and related functions.\n\n\t\tif ( !LocalCacheData.current_open_primary_controller ) {\n\t\t\treturn;\n\t\t}\n\t\tvar primary_view_id = LocalCacheData.current_open_primary_controller.viewId;\n\n\t\tif ( !Global.isSet( name ) ) {\n\t\t\tname = this.context_menu_name;\n\t\t}\n\n\t\tvar tab = $( '#ribbon ul a' ).filter( function() {\n\t\t\treturn $( this ).attr( 'ref' ) === name;\n\t\t} ).parent();\n\n\t\tvar index = $( 'li', $( '#ribbon' ) ).index( tab );\n\t\tif ( index >= 0 ) {\n\t\t\t// $( '#ribbon_view_container' ).tabs( {'remove': index} );\n\t\t\t$( '#ribbon_view_container' ).tabs( 'refresh' );\n\t\t}\n\t}\n\n\tmovePermissionValidate( p_id ) {\n\t\tif ( !Global.isSet( p_id ) ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( this.addPermissionValidate( p_id ) && this.deletePermissionValidate( p_id ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsubAuditValidate() {\n\t\tif ( this.editPermissionValidate() ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsubDocumentValidate() {\n\t\tif ( ( Global.getProductEdition() >= 20 ) && PermissionManager.checkTopLevelPermission( 'Document' ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\taddPermissionValidate( p_id ) {\n\t\tif ( !Global.isSet( p_id ) ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( PermissionManager.validate( p_id, 'add' ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetRecordFromGridById( id ) {\n\n\t\tvar data = this.grid.getData();\n\t\tvar result = null;\n\t\t/* jshint ignore:start */\n\t\t//id could be string or number.\n\t\t$.each( data, function( index, value ) {\n\n\t\t\tif ( value.id == id ) {\n\t\t\t\tresult = Global.clone( value );\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t} );\n\t\t/* jshint ignore:end */\n\t\treturn result;\n\t}\n\n\tgetSelectedItems() {\n\t\tvar $this = this;\n\t\tvar selected_items = [];\n\t\tif ( this.edit_view ) {\n\t\t\tselected_items = [this.current_edit_record];\n\t\t} else {\n\t\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\t\tvar grid_selected_length = grid_selected_id_array.length;\n\t\t\tselected_items = _.map( grid_selected_id_array, function( id ) {\n\t\t\t\treturn $this.getRecordFromGridById( id );\n\t\t\t} );\n\t\t}\n\t\treturn selected_items;\n\t}\n\n\tgetSelectedItem() {\n\n\t\tvar selected_item = null;\n\t\tif ( this.edit_view ) {\n\t\t\tselected_item = this.current_edit_record;\n\t\t} else {\n\t\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\t\tvar grid_selected_length = grid_selected_id_array.length;\n\n\t\t\tif ( grid_selected_length > 0 ) {\n\t\t\t\tselected_item = this.getRecordFromGridById( grid_selected_id_array[0] );\n\t\t\t}\n\n\t\t}\n\n\t\tif ( selected_item ) {\n\t\t\treturn Global.clone( selected_item );\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tdeleteOwnerOrChildPermissionValidate( p_id, selected_item ) {\n\n\t\tif ( !p_id ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( !selected_item ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (\n\t\t\tPermissionManager.validate( p_id, 'delete' ) ||\n\t\t\t( selected_item && selected_item.is_owner && PermissionManager.validate( p_id, 'delete_own' ) ) ||\n\t\t\t( selected_item && selected_item.is_child && PermissionManager.validate( p_id, 'delete_child' ) ) ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tviewOwnerOrChildPermissionValidate( p_id, selected_item ) {\n\n\t\tif ( !p_id ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( !selected_item ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif (\n\t\t\tPermissionManager.validate( p_id, 'view' ) ||\n\t\t\t( selected_item && selected_item.is_owner && PermissionManager.validate( p_id, 'view_own' ) ) ||\n\t\t\t( selected_item && selected_item.is_child && PermissionManager.validate( p_id, 'view_child' ) ) ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\t}\n\n\teditOwnerOrChildPermissionValidate( p_id, selected_item ) {\n\n\t\tif ( !p_id ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( !selected_item ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (\n\t\t\tPermissionManager.validate( p_id, 'edit' ) ||\n\t\t\t( selected_item && selected_item.is_owner && PermissionManager.validate( p_id, 'edit_own' ) ) ||\n\t\t\t( selected_item && selected_item.is_child && PermissionManager.validate( p_id, 'edit_child' ) ) ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\t}\n\n\townerOrChildPermissionValidate( p_id, permission_name, selected_item ) {\n\n\t\tvar field;\n\t\tif ( permission_name.indexOf( 'child' ) > -1 ) {\n\t\t\tfield = 'is_child';\n\t\t} else {\n\t\t\tfield = 'is_owner';\n\t\t}\n//\n//\t\tif ( PermissionManager.validate( p_id, permission_name ) &&\n//\t\t\t(!selected_item ||\n//\t\t\t\t( selected_item && (selected_item[field] || (!selected_item.id && !selected_item.hasOwnProperty( field )) ) ) ) ) {\n//\t\t\treturn true;\n//\t\t}\n\n\t\tif ( PermissionManager.validate( p_id, permission_name ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\teditChildPermissionValidate( p_id, selected_item ) {\n\t\tif ( !Global.isSet( p_id ) ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( !Global.isSet( selected_item ) ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( !PermissionManager.validate( p_id, 'enabled' ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( PermissionManager.validate( p_id, 'edit' ) ||\n\t\t\tthis.ownerOrChildPermissionValidate( p_id, 'edit_child', selected_item ) ) {\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\teditPermissionValidate( p_id, selected_item ) {\n\t\tif ( !Global.isSet( p_id ) ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( !Global.isSet( selected_item ) ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( PermissionManager.validate( p_id, 'edit' ) || this.ownerOrChildPermissionValidate( p_id, 'edit_child', selected_item ) || this.ownerOrChildPermissionValidate( p_id, 'edit_own', selected_item ) ) {\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tcopyPermissionValidate( p_id, selected_item ) {\n\t\tif ( !Global.isSet( p_id ) ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( !Global.isSet( selected_item ) ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( this.viewPermissionValidate( p_id, selected_item ) && this.addPermissionValidate( p_id, selected_item ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tcopyAsNewPermissionValidate( p_id, selected_item ) {\n\t\tif ( !Global.isSet( p_id ) ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( !Global.isSet( selected_item ) ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( this.viewPermissionValidate( p_id, selected_item ) && this.addPermissionValidate( p_id, selected_item ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tviewPermissionValidate( p_id, selected_item ) {\n\n\t\tif ( !Global.isSet( p_id ) ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( !Global.isSet( selected_item ) ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( PermissionManager.validate( p_id, 'view' ) || this.ownerOrChildPermissionValidate( p_id, 'view_child', selected_item ) || this.ownerOrChildPermissionValidate( p_id, 'view_own', selected_item ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tdeletePermissionValidate( p_id, selected_item ) {\n\t\tif ( !Global.isSet( p_id ) ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( !Global.isSet( selected_item ) ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( PermissionManager.validate( p_id, 'delete' ) || this.ownerOrChildPermissionValidate( p_id, 'delete_child', selected_item ) || this.ownerOrChildPermissionValidate( p_id, 'delete_own', selected_item ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsaveValidate( context_btn, p_id ) {\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) && !this.is_mass_editing ) {\n\t\t\tif ( !this.addPermissionValidate( p_id ) ) {\n\t\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t\t}\n\t\t} else if ( ( ( !this.current_edit_record || !this.current_edit_record.id ) && this.is_mass_editing ) || this.current_edit_record.id ) {\n\n\t\t\tif ( !this.editPermissionValidate( p_id ) ) {\n\t\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t\t}\n\t\t}\n\t}\n\n\tsaveAndCopyValidate( context_btn, p_id ) {\n\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) && !this.is_mass_editing ) {\n\t\t\tif ( !this.addPermissionValidate( p_id ) ) {\n\t\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t\t}\n\t\t} else if ( ( ( !this.current_edit_record || !this.current_edit_record.id ) && this.is_mass_editing ) || this.current_edit_record.id ) {\n\n\t\t\tif ( !this.editPermissionValidate( p_id ) || !this.addPermissionValidate( p_id ) ) {\n\t\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t\t}\n\t\t}\n\n\t\tif ( this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\t}\n\n\tsaveAndContinueValidate( context_btn, p_id ) {\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) && !this.is_mass_editing ) {\n\t\t\tif ( !this.addPermissionValidate( p_id ) || !this.editPermissionValidate( p_id ) ) {\n\t\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t\t}\n\t\t} else if ( ( ( !this.current_edit_record || !this.current_edit_record.id ) && this.is_mass_editing ) || this.current_edit_record.id ) {\n\n\t\t\tif ( !this.editPermissionValidate( p_id ) ) {\n\t\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t\t}\n\t\t}\n\n\t\tif ( this.showSaveAndContinueOnEditOnly() == false ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\t}\n\n\tshowSaveAndContinueOnEditOnly() {\n\t\t//By default, views marked as edit_only_mode do not show save and continue.\n\t\t//However, in certain cases we do want to show it, such as when clicking \"Hire Applicant\" on JobApplication view\n\t\tif ( this.edit_only_mode == true && ( this.parent_view_controller && this.viewId === 'Employee' && this.parent_view_controller.viewId === 'JobApplication' ) == false ) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tsaveAndNewValidate( context_btn, p_id ) {\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) && !this.is_mass_editing ) {\n\t\t\tif ( !this.addPermissionValidate( p_id ) ) {\n\t\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t\t}\n\t\t} else if ( ( !Global.isSet( this.current_edit_record.id ) && this.is_mass_editing ) || Global.isSet( this.current_edit_record.id ) ) {\n\n\t\t\tif ( !this.editPermissionValidate( p_id ) || !this.addPermissionValidate( p_id ) ) {\n\t\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t\t}\n\t\t}\n\n\t\tif ( this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\t}\n\n\tsetSubLogViewFilter() {\n\t\t// #2761 Refactor of setSubLogViewController and setSubViewFilterFunction into setSubLogViewFilter\n\t\t// This refactor is because the key value attributes are linked with the filter.\n\t\t// In general, it was found that either the key value are set, or the filters, but not both. So makes sense to be in the same function. Not confirmed that this is the case in all views, so its not been made into an 'either or' function.\n\n\t\tif ( !this.sub_log_view_controller ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Option #1: filter on single criteria (default)\n\t\tthis.sub_log_view_controller.parent_key = 'object_id';\n\t\tthis.sub_log_view_controller.parent_value = this.uniformVariable( this.current_edit_record ).id;\n\t\tthis.sub_log_view_controller.table_name_key = this.table_name_key;\n\n\t\t// Option #2: filter on multiple criteria.\n\n\t\t// #2761: Filter function appears to only work if parent_key, value and table are null or not set.\n\t\t// Filter structure works similar to pseudo code: WHERE ( table_name = 'punch' AND object_id = '$punch_id') OR ( table_name = 'punch_control' AND object_id = '$punch_control_id' )\n\t\t// key, value, table lines can just be ommitted, as default state is null. Included here for emphasis in example.\n\t\t// this.sub_log_view_controller.parent_key = null;\n\t\t// this.sub_log_view_controller.parent_value = null;\n\t\t// this.sub_log_view_controller.table_name_key = null;\n\t\t// this.sub_log_view_controller.getSubViewFilter = function ( filter ) {\n\t\t// \tfilter['table_name_object_id'] = {\n\t\t// \t\t'punch': [this.parent_edit_record.id],\n\t\t// \t\t'punch_control': [this.parent_edit_record.punch_control_id]\n\t\t// \t};\n\t\t//\n\t\t// \treturn filter;\n\t\t// };\n\n\t\treturn true;\n\t}\n\n\tinitSubLogView( tab_id ) {\n\t\tvar $this = this;\n\n\t\tif ( !this.current_edit_record.id || this.current_edit_record.id == TTUUID.zero_id ) {\n\t\t\tTTPromise.resolve( 'BaseViewController', 'onTabShow' ); //Since search() isn't called in this case, and we just display the \"Please Save This Record ...\" message, resolve the promise.\n\t\t\treturn;\n\t\t}\n\n\t\tif ( this.sub_log_view_controller ) {\n\t\t\t// If the Audit tab has already been opened before in this edit view.\n\t\t\tthis.sub_log_view_controller.buildContextMenu( true );\n\t\t\tthis.sub_log_view_controller.setDefaultMenu();\n\t\t\tthis.sub_log_view_controller.parent_edit_record = this.current_edit_record;\n\t\t\tthis.setSubLogViewFilter(); // triggers the setting of the filter function for views that need it.\n\t\t\t// $this.sub_log_view_controller.parent_key = 'object_id';\n\t\t\t// $this.sub_log_view_controller.parent_value = $this.current_edit_record.id;\n\t\t\t// $this.sub_log_view_controller.table_name_key = $this.table_name_key;\n\n\t\t\tthis.sub_log_view_controller.search();\n\t\t} else {\n\t\t\t// If the Audit tab has NOT yet been opened before in this edit view.\n\t\t\tGlobal.loadScript( 'views/core/log/LogViewController.js', function() {\n\t\t\t\tif ( !$this.edit_view_tab ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar tab = $this.edit_view_tab.find( '#' + tab_id );\n\t\t\t\tvar firstColumn = tab.find( '.first-column-sub-view' );\n\n\t\t\t\tTTPromise.add( 'initSubAudit', 'init' );\n\t\t\t\tTTPromise.wait( 'initSubAudit', 'init', function() {\n\t\t\t\t\tfirstColumn.css( 'opacity', '1' );\n\t\t\t\t} );\n\n\t\t\t\tfirstColumn.css( 'opacity', '0' ); //Hide the grid while its loading/sizing.\n\n\t\t\t\tGlobal.trackView( 'Sub' + 'Log' + 'View', LocalCacheData.current_doing_context_action );\n\t\t\t\tLogViewController.loadSubView( firstColumn, beforeLoadView, afterLoadView );\n\t\t\t} );\n\t\t}\n\n\t\tfunction beforeLoadView() {\n\n\t\t}\n\n\t\tfunction afterLoadView( subViewController ) {\n\t\t\t$this.sub_log_view_controller = subViewController;\n\t\t\t$this.sub_log_view_controller.parent_view_controller = $this;\n\t\t\t$this.sub_log_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.setSubLogViewFilter(); // triggers the setting of the filter function for views that need it.\n\t\t\t// $this.sub_log_view_controller.parent_key = 'object_id';\n\t\t\t// $this.sub_log_view_controller.parent_value = $this.current_edit_record.id;\n\t\t\t// $this.sub_log_view_controller.table_name_key = $this.table_name_key;\n\n\t\t\t$this.sub_log_view_controller.postInit = function() {\n\t\t\t\tthis.initData();\n\t\t\t};\n\n\t\t}\n\t}\n\n\tshowNoResultCover( show_new_btn ) {\n\t\tif ( !show_new_btn ) {\n\t\t\tshow_new_btn = this.ifContextButtonExist( 'add' );\n\t\t}\n\n\t\tthis.removeNoResultCover();\n\t\tthis.no_result_box = Global.loadWidgetByName( WidgetNamesDic.NO_RESULT_BOX );\n\t\tthis.no_result_box.NoResultBox( { related_view_controller: this, is_new: show_new_btn } );\n\t\tthis.no_result_box.attr( 'id', this.ui_id + '_no_result_box' );\n\n\t\tvar grid_div = $( this.el ).find( '.grid-div' );\n\n\t\tgrid_div.append( this.no_result_box );\n\n\t\tthis.initRightClickMenu( RightClickMenuType.NORESULTBOX );\n\t}\n\n\tremoveNoResultCover() {\n\n\t\tif ( this.no_result_box && this.no_result_box.length > 0 ) {\n\t\t\tthis.no_result_box.remove();\n\t\t}\n\t\tthis.no_result_box = null;\n\t}\n\n\tcleanWhenUnloadView( callBack ) {\n\t\tthis.unmountContextMenu(); // This is just in case, contextmenu should already be unmounted in IndexController.removeCurrentView\n\t\tthis.removeContentMenuByName();\n\t\tif ( Global.isSet( callBack ) ) {\n\t\t\tcallBack();\n\t\t}\n\t}\n\n\tgridScrollTop() {\n\n\t\tif ( this.viewId === 'TimeSheet' || this.viewId === 'Schedule' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !this.grid ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.grid.grid.parent().parent().scrollTop( 0 );\n\t}\n\n\tgridScrollDown() {\n\n\t\tif ( this.viewId === 'TimeSheet' || this.viewId === 'Schedule' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !this.grid ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.grid.grid.parent().parent().scrollTop( 10000 );\n\t}\n\n\tselectAll() {\n\t\tif ( this.viewId === 'TimeSheet' || this.viewId === 'Schedule' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !this.grid ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.grid.grid.resetSelection();\n\t\tvar source_data = this.grid.getData();\n\t\tvar len = source_data.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar item = source_data[i];\n\t\t\tif ( Global.isSet( item.id ) ) {\n\t\t\t\tthis.grid.grid.setSelection( item.id, false );\n\t\t\t} else {\n\t\t\t\tthis.grid.grid.setSelection( i + 1, false );\n\t\t\t}\n\n\t\t}\n\n\t\tthis.grid.grid.parent().parent().parent().find( '.cbox-header' ).prop( 'checked', true );\n\t\tthis.setDefaultMenu();\n\t}\n\n\tdetachElement( key ) {\n\t\t//Error: Uncaught TypeError: Cannot read property 'detach' of undefined in interface/html5/views/BaseViewController.js?v=9.0.0-20150824-110300 line 6441\n\t\tif ( !this.edit_view_form_item_dic || !this.edit_view_form_item_dic[key] ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar place_holder = $( '<p style=\"display: none\">' );\n\t\tplace_holder.addClass( '.edit-view:visible place_holder_' + key );\n\t\tplace_holder.insertBefore( this.edit_view_form_item_dic[key] );\n\t\tthis.edit_view_form_item_dic[key].detach();\n\t}\n\n\tattachElement( key ) {\n\t\t//Error: Uncaught TypeError: Cannot read property 'insertBefore' of undefined in interface/html5/views/BaseViewController.js?v=9.0.0-20150822-210544 line 6439\n\t\tif ( !this.edit_view_form_item_dic || !this.edit_view_form_item_dic[key] ) {\n\t\t\treturn;\n\t\t}\n\n\t\t//var place_holder = $( '.edit-view:visible .edit-view-tab:visible .place_holder_' + key);\n\t\tvar place_holder = $( '.edit-view:visible .place_holder_' + key );\n\t\tthis.edit_view_form_item_dic[key].insertBefore( place_holder );\n\t\tplace_holder.remove();\n\t}\n\n\tgetBalanceHandler( result, last_date_stamp ) {\n\t\tvar $this = this;\n\t\tvar available_balance_value, current_time_value, remaining_balance_value, summary_available_value;\n\n\t\t//Error: TypeError: this.edit_view_ui_dic.available_balance is undefined in /interface/html5/framework/jquery.min.js?v=8.0.0-20141117-091433 line 2 > eval line 6570\n\t\tif ( !$this.edit_view_ui_dic || !$this.edit_view_ui_dic['available_balance'] ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( Global.isObject( result ) ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( !result_data ) {\n\t\t\t\t$this.detachElement( 'available_balance' );\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else {\n\t\t\t$this.detachElement( 'available_balance' );\n\t\t\treturn;\n\t\t}\n\t\t$this.attachElement( 'available_balance' );\n\n\t\tavailable_balance_value = Global.getTimeUnit( result_data.available_balance );\n\t\tcurrent_time_value = Global.getTimeUnit( result_data.current_time );\n\t\tremaining_balance_value = Global.getTimeUnit( result_data.remaining_balance );\n\t\tsummary_available_value = Global.getTimeUnit( result_data.projected_remaining_balance );\n\t\tif ( result_data.hasOwnProperty( 'remaining_dollar_balance' ) ) {\n\t\t\tavailable_balance_value = available_balance_value + ' / ' + LocalCacheData.getCurrentCurrencySymbol() + result_data.available_dollar_balance;\n\t\t\tcurrent_time_value = current_time_value + ' / ' + LocalCacheData.getCurrentCurrencySymbol() + result_data.current_dollar_amount;\n\t\t\tremaining_balance_value = remaining_balance_value + ' / ' + LocalCacheData.getCurrentCurrencySymbol() + result_data.remaining_dollar_balance;\n\t\t\tsummary_available_value = summary_available_value + ' / ' + LocalCacheData.getCurrentCurrencySymbol() + result_data.remaining_dollar_balance;\n\t\t}\n\t\t$this.edit_view_ui_dic['available_balance'].setValue( summary_available_value );\n\n\t\t//If available balance is negative, change font color to red so its more noticable.\n\t\tif ( ( result_data.projected_remaining_balance && result_data.projected_remaining_balance < 0 ) || ( result_data.remaining_dollar_balance && result_data.remaining_dollar_balance < 0 ) ) {\n\t\t\t$this.edit_view_ui_dic['available_balance'].css( 'color', 'red' ); //Font color to red.\n\t\t} else {\n\t\t\t$this.edit_view_ui_dic['available_balance'].css( 'color', 'black' );\n\t\t}\n\n\t\tif ( $this.available_balance_info ) {\n\t\t\t$this.available_balance_info.qtip(\n\t\t\t\t{\n\t\t\t\t\tshow: {\n\t\t\t\t\t\tevent: 'click',\n\t\t\t\t\t\tdelay: 10,\n\t\t\t\t\t\teffect: true\n\t\t\t\t\t},\n\n\t\t\t\t\thide: {\n\t\t\t\t\t\tevent: ['unfocus click'],\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\t//classes: 'cream',\n\t\t\t\t\t\twidth: 340 //Dynamically changing the width causes display bugs when switching between Absence Policies and thereby widths.\n\t\t\t\t\t},\n\t\t\t\t\tcontent: '<div style=\"width:100%;\">' +\n\t\t\t\t\t\t'<div style=\"width:100%; clear: both;\"><span style=\"float:left;\">' + $.i18n._( 'Available Balance' ) + ': </span><span style=\"float:right;\">' + available_balance_value + '</span></div>' +\n\t\t\t\t\t\t'<div style=\"width:100%; clear: both;\"><span style=\"float:left;\">' + $.i18n._( 'Current Time' ) + ': </span><span style=\"float:right;\">' + current_time_value + '</span></div>' +\n\t\t\t\t\t\t'<div style=\"width:100%; clear: both;\"><span style=\"float:left;\">' + $.i18n._( 'Remaining Balance' ) + ': </span><span style=\"float:right;\">' + remaining_balance_value + '</span></div>' +\n\t\t\t\t\t\t'<div style=\"width:100%; height: 20px; clear: both;\"></div>' +\n\t\t\t\t\t\t'<div style=\"width:100%; clear: both;\"><span style=\"float:left;\">' + $.i18n._( 'Projected Balance by' ) + ' ' + last_date_stamp + ': </span><span style=\"float:right;\">' + Global.getTimeUnit( result_data.projected_balance ) + '</span></div>' +\n\t\t\t\t\t\t'<div style=\"width:100%; clear: both;\"><span style=\"float:left;\">' + $.i18n._( 'Projected Remaining Balance' ) + ':</span><span style=\"float:right;\">' + Global.getTimeUnit( result_data.projected_remaining_balance ) + '</span></div>' +\n\t\t\t\t\t\t'</div>'\n\t\t\t\t} );\n\t\t}\n\t}\n\n\tonExportClick( method ) {\n\t\tProgressBar.showOverlay();\n\t\tif ( method == undefined ) {\n\t\t\tmethod = this.api['export' + this.api.key_name];\n\t\t}\n\n\t\t//Debug.Text('Exporting Grid To CSV: '+method, 'BaseViewController.js', 'BaseViewController', 'onExportClick', 10);\n\n\t\tvar args = {};\n\t\targs.filter_columns = this._getFilterColumnsFromDisplayColumns( null, false );\n\t\targs.filter_data = Global.convertLayoutFilterToAPIFilter( this.select_layout );\n\t\tif ( Global.isSet( this.sort_by_selector ) ) {\n\t\t\targs.filter_sort = this.getSearchPanelSortFilter();\n\t\t}\n\t\tvar post_data = { 0: 'csv', 1: args, 2: true };\n\n\t\tGlobal.APIFileDownload( this.api.className, method, post_data );\n\t}\n\n\t/*\n\t* Accepts single id or array of ids.\n\t*/\n\thighLightGridRowById( id ) {\n\t\tif ( this.grid && this.grid.grid ) {\n\t\t\tif ( Array.isArray( id ) == false ) {\n\t\t\t\tid = [id];\n\t\t\t}\n\n\t\t\tfor ( var i = 0; i < id.length; i++ ) {\n\t\t\t\tlet row = this.grid.grid.find( 'tr#' + id[i] );\n\n\t\t\t\tif ( row.length > 0 ) {\n\t\t\t\t\trow[0].classList.add( 'flashBackground' );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.gridScrollDown();\n\t\t}\n\t}\n\n\tsetConversionRateExampleText( conversion_rate, iso_code, currency_id ) {\n\t\tvar data = {};\n\t\tdata.filter_data = Global.convertLayoutFilterToAPIFilter( this.select_layout );\n\t\tvar api = TTAPI.APICurrency;\n\t\tvar my_currencies = api.getCurrency( data, { async: false } ).getResult();\n\t\tvar base_currency_iso_code = '';\n\t\tif ( this.edit_view_ui_dic.round_decimal_places ) {\n\t\t\tvar decimal_places = this.edit_view_ui_dic.round_decimal_places.getValue();\n\t\t}\n\t\tfor ( var i = 0; i < my_currencies.length; i++ ) {\n\t\t\tif ( my_currencies[i].is_base ) {\n\t\t\t\tbase_currency_iso_code = my_currencies[i].iso_code;\n\n\t\t\t}\n\t\t\tif ( currency_id && !iso_code && my_currencies[i].id == currency_id ) {\n\t\t\t\tiso_code = my_currencies[i].iso_code;\n\t\t\t\tif ( !decimal_places ) {\n\t\t\t\t\tdecimal_places = my_currencies[i].round_decimal_places;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//need different id on the subview for rate.\n\t\tif ( iso_code != base_currency_iso_code ) {\n\t\t\tif ( this.sub_view_mode ) {\n\t\t\t\t$( '#rate_conversion_rate_clarification_box' ).html( '&nbsp;&nbsp;1.00 ' + base_currency_iso_code + ' = ' + Global.removeTrailingZeros( conversion_rate, decimal_places ) + ' ' + iso_code );\n\t\t\t} else {\n\t\t\t\t$( '#conversion_rate_clarification_box' ).html( '&nbsp;&nbsp;1.00 ' + base_currency_iso_code + ' = ' + Global.removeTrailingZeros( conversion_rate, decimal_places ) + ' ' + iso_code );\n\t\t\t}\n\t\t} else {\n\t\t\t$( '#conversion_rate_clarification_box' ).hide();\n\t\t}\n\t}\n\n\t/**\n\t * gets default coordinates object for maps.\n\t */\n\tstartMapCoordinates() {\n\t\tvar lat = 39.50;\n\t\tvar lng = -98.35;\n\n\t\tif ( LocalCacheData.getCurrentCompany().latitude != 0 && LocalCacheData.getCurrentCompany().longitude != 0 ) {\n\t\t\tlat = LocalCacheData.getCurrentCompany().latitude;\n\t\t\tlng = LocalCacheData.getCurrentCompany().longitude;\n\t\t\tDebug.Text( 'Using company coordinates.', 'BaseViewController.js', 'BaseViewController', 'startMapCoordinates', 10 );\n\t\t} else if ( LocalCacheData.getLoginUser().latitude != 0 && LocalCacheData.getLoginUser().longitude != 0 ) {\n\t\t\tlat = LocalCacheData.getLoginUser().latitude;\n\t\t\tlng = LocalCacheData.getLoginUser().longitude;\n\t\t\tDebug.Text( 'Using user coordinates.', 'BaseViewController.js', 'BaseViewController', 'startMapCoordinates', 10 );\n\t\t} else {\n\t\t\tvar company_api = TTAPI.APICompany;\n\t\t\tvar country_arr = company_api.getOptions( 'country', { async: false } ).getResult();\n\t\t\tvar province_arr = company_api.getOptions( 'province', LocalCacheData.getCurrentCompany().country, { async: false } ).getResult();\n\n\t\t\tif ( APIGlobal.pre_login_data.map_geocode_url && province_arr && country_arr && province_arr[LocalCacheData.getCurrentCompany().province] && country_arr[LocalCacheData.getCurrentCompany().country] ) {\n\t\t\t\tvar query = LocalCacheData.getCurrentCompany().city + ' ' + province_arr[LocalCacheData.getCurrentCompany().province] + ', ' + country_arr[LocalCacheData.getCurrentCompany().country];\n\t\t\t\tvar url = APIGlobal.pre_login_data.map_geocode_url + '?q=' + query + '&format=json&tt_key=' + APIGlobal.pre_login_data.registration_key;\n\t\t\t\tvar result = jQuery.ajax( { url: url, async: false } );\n\t\t\t\tDebug.Arr( 'Geocoding address: ' + query, result, 'BaseViewController.js', 'BaseViewController', 'startMapCoordinates', 10 );\n\t\t\t}\n\n\t\t\tif ( result && result.responseJSON && result.responseJSON[0] && result.responseJSON[0].lat && result.responseJSON[0].lon ) {\n\t\t\t\tlat = result.responseJSON[0].lat;\n\t\t\t\tlng = result.responseJSON[0].lon;\n\t\t\t\tDebug.Text( 'Using company address coordinates.', 'BaseViewController.js', 'BaseViewController', 'startMapCoordinates', 10 );\n\t\t\t} else {\n\t\t\t\tDebug.Text( 'Using default coordinates.', 'BaseViewController.js', 'BaseViewController', 'startMapCoordinates', 10 );\n\t\t\t}\n\t\t}\n\n\t\tDebug.Text( 'Coordinates (lat,long): ' + lat + ',' + lng, 'BaseViewController.js', 'BaseViewController', 'startMapCoordinates', 10 );\n\t\treturn new L.LatLng( lat, lng );\n\t}\n\n\tinitSubDocumentView() {\n\t\tvar $this = this;\n\n\t\tif ( !this.current_edit_record.id ) {\n\t\t\tTTPromise.resolve( 'BaseViewController', 'onTabShow' ); //Since search() isn't called in this case, and we just display the \"Please Save This Record ...\" message, resolve the promise.\n\t\t\treturn;\n\t\t}\n\n\t\tif ( this.sub_document_view_controller ) {\n\t\t\tthis.sub_document_view_controller.buildContextMenu( true );\n\t\t\tthis.sub_document_view_controller.setDefaultMenu();\n\t\t\t$this.sub_document_view_controller.parent_value = $this.current_edit_record.id;\n\t\t\t$this.sub_document_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.sub_document_view_controller.initData();\n\t\t\treturn;\n\t\t}\n\n\t\tGlobal.loadScript( 'views/document/DocumentViewController.js', function() {\n\t\t\tif ( !$this.edit_view_tab ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar tab_contact_info = $this.edit_view_tab.find( '#tab_attachment' );\n\t\t\tvar firstColumn = tab_contact_info.find( '.first-column-sub-view' );\n\n\t\t\tTTPromise.add( 'initSubDocumentView', 'init' );\n\t\t\tTTPromise.wait( 'initSubDocumentView', 'init', function() {\n\t\t\t\tfirstColumn.css( 'opacity', '1' );\n\t\t\t} );\n\n\t\t\tfirstColumn.css( 'opacity', '0' ); //Hide the grid while its loading/sizing.\n\n\t\t\tGlobal.trackView( 'SubDocumentView' );\n\t\t\tDocumentViewController.loadSubView( firstColumn, beforeLoadView, afterLoadView );\n\n\t\t} );\n\n\t\tfunction beforeLoadView() {\n\n\t\t}\n\n\t\tfunction afterLoadView( subViewController ) {\n\t\t\t$this.sub_document_view_controller = subViewController;\n\t\t\t$this.sub_document_view_controller.parent_key = 'object_id';\n\t\t\t$this.sub_document_view_controller.parent_value = $this.current_edit_record.id;\n\t\t\t$this.sub_document_view_controller.document_object_type_id = $this.document_object_type_id;\n\t\t\t$this.sub_document_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.sub_document_view_controller.parent_view_controller = $this;\n\t\t\t$this.sub_document_view_controller.initData();\n\t\t}\n\t}\n\n\tonDeleteImage( callback ) {\n\t\tvar $this = this;\n\t\tthis.api.deleteImage( this.current_edit_record.id, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.onEditClick( $this.current_edit_record.id, true );\n\n\t\t\t\tif ( callback ) {\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tonTreeGridNavigationRowSelect( id ) {\n\t\tif ( !id ) {\n\t\t\treturn;\n\t\t}\n\n\t\t//don't close on collapse of tree mode element\n\t\tif ( LocalCacheData.currently_collapsing_navigation_tree_element != true ) {\n\t\t\tthis.onEditClick( id );\n\t\t\t$( '.a-dropdown-div' ).remove();\n\t\t\tLocalCacheData.openAwesomeBox = null;\n\t\t} else {\n\t\t\tLocalCacheData.currently_collapsing_navigation_tree_element = false;\n\t\t\tthis.onEditClick( id, true );\n\t\t\tthis.setNavigation();\n\t\t}\n\t}\n\n\tparserDatesRange( date ) {\n\t\tvar dates = date.split( \" - \" );\n\t\tvar resultArray = [];\n\t\tvar beginDate = Global.strToDate( dates[0] );\n\t\tvar endDate = Global.strToDate( dates[1] );\n\n\t\tvar nextDate = beginDate;\n\n\t\twhile ( nextDate.getTime() < endDate.getTime() ) {\n\t\t\tresultArray.push( nextDate.format() );\n\t\t\tnextDate = new Date( new Date( nextDate.getTime() ).setDate( nextDate.getDate() + 1 ) );\n\t\t}\n\n\t\tresultArray.push( dates[1] );\n\n\t\treturn resultArray;\n\t}\n\n\tbaseViewSubTabGridResize( id ) {\n\t\tvar $this = this;;\n\n\t\tif ( !id ) {\n\t\t\tid = '.edit-view-tab-outside-sub-view';\n\t\t} else if ( id.indexOf( '#' ) === -1 && id.indexOf( '.' ) != 0 ) {\n\t\t\tid = '#' + id;\n\t\t}\n\n\t\tif ( this.grid.grid.parents( id ).length > 0 ) {\n\n\t\t\tvar height = Math.floor( this.getAvailableHeightForGrid( id ) );\n\n\t\t\tthis.grid.setup.container_selector = id;\n\n\t\t\tDebug.Text( 'Special SubView ID: ' + id + ' Height: ' + height + ' Offset: ' + offset, 'TTGrid.js', 'TTGrid', 'baseViewSubTabGridResize', 10 );\n\t\t} else {\n\t\t\tvar offset = this.getDefaultHeightOffset();\n\t\t\tvar height = ( this.grid.grid.parents( '.edit-view-tab' ).innerHeight() - offset );\n\n\t\t\tDebug.Text( 'Normal SubView ID: ' + id + ' Height: ' + height + ' Offset: ' + offset, 'TTGrid.js', 'TTGrid', 'baseViewSubTabGridResize', 10 );\n\t\t}\n\n\t\tif ( height < 250 ) {\n\t\t\theight = 250;\n\t\t}\n\n\t\tthis.setGridHeight( height );\n\t\tthis.setGridWidth();\n\t}\n\n\t/**\n\t * Sets the grid's height.\n\t * @param ui_id\n\t * @param sub_view_mode\n\t * @param sub_view_grid_autosize\n\t * @param pager_data\n\t */\n\tsetGridSize( ui_id, sub_view_mode, sub_view_grid_autosize, pager_data ) {\n\t\tvar $this = this;\n\t\tif ( this.grid && this.grid.setup && this.grid.setup.setGridSize && typeof this.grid.setup.setGridSize == 'function' ) {\n\t\t\tthis.grid.setup.setGridSize();\n\t\t\treturn;\n\t\t}\n\n\t\tif ( ( !ui_id && !this.ui_id ) || !this.grid ) {\n\t\t\tDebug.Text( 'ERROR: You must provide at least a ui_id for setGridSize()', 'TTGrid.js', 'TTGrid', 'setGridSize', 10 );\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !ui_id && this.ui_id ) {\n\t\t\tui_id = this.ui_id;\n\t\t}\n\n\t\tif ( !sub_view_mode && this.sub_view_mode ) {\n\t\t\tsub_view_mode = this.sub_view_mode;\n\t\t}\n\n\t\tif ( !sub_view_grid_autosize && this.sub_view_grid_autosize ) {\n\t\t\tsub_view_grid_autosize = this.sub_view_grid_autosize;\n\t\t}\n\n\t\t//this.setGridWidth ( this.setGridColumnsWidth() );\n\n\t\tvar height = 100;\n\n\t\tif ( sub_view_mode &&\n\t\t\tthis.grid.grid.parents( '.grid-div' ).find( '.no-result-div:visible' ).length > 0 &&\n\t\t\tthis.grid.grid.parents( '#tab_history, #tab_qualifications' ).length > 0\n\t\t) {\n\t\t\theight = 100;\n\t\t} else if ( this.grid.setup.static_height ) {\n\t\t\theight = this.grid.setup.static_height;\n\t\t} else if ( this.grid.setup.verticalResize && this.grid.setup.verticalResize === true ) {\n\t\t\tif ( sub_view_mode ) {\n\t\t\t\tif ( this.grid.grid.parents( '.edit-view-tab-outside-sub-view' ).find( '.context-border' ).length > 1 || this.grid.grid.parents( '.edit-view-tab-outside-sub-view' ).find( '.ui-jqgrid-htable' ).length > 1 ) {\n\t\t\t\t\t//This tab has multiple grids or sub views.\n\t\t\t\t\t//Tabs like this are \"Employee -> Edit Employee -> Qualifications\" or Recruitment -> Job Applicant History and Qualification tab with multiple grids.\n\n\t\t\t\t\tlet length = this.grid.getRecordCount();\n\t\t\t\t\tlet cell_height = this.grid.grid.find( 'tr:last td:first' ).height();\n\n\t\t\t\t\tif ( cell_height < 18 ) { //If cannot determine cell height, use default of 22.\n\t\t\t\t\t\tcell_height = 22;\n\t\t\t\t\t}\n\n\t\t\t\t\t//Grid height is between 3 and 6 rows. Nothing too small or tall so that all grids can be viewed easily\n\t\t\t\t\tlet rows_to_show = 3;\n\t\t\t\t\tif ( length > 6 ) {\n\t\t\t\t\t\trows_to_show = 6;\n                    } else if ( length > 3 ) {\n\t\t\t\t\t\trows_to_show = length;\n                    }\n\n\t\t\t\t\theight = ( rows_to_show * cell_height );\n\t\t\t\t} else {\n\t\t\t\t\t//Normal single grid sub view.\n\t\t\t\t\tif ( this.grid.grid.parents( '.edit-view-tab-outside-sub-view' ) && this.grid.grid.parents( '.edit-view-tab-outside-sub-view' ).length > 0 && this.grid.grid.parents( '.edit-view-tab-outside-sub-view' )[0] ) {\n\t\t\t\t\t\theight = this.getAvailableHeightForGrid( this.grid.grid.parents( '.edit-view-tab-outside-sub-view' )[0].id );\n\n\t\t\t\t\t\tlet child_context_border = this.grid.grid.parents( '.edit-view-tab-outside-sub-view' ).find( '.context-border' );\n\t\t\t\t\t\tif ( child_context_border.length !== 0 ) {\n\t\t\t\t\t\t\t//Adjust height by margins of the context border.\n\t\t\t\t\t\t\theight -= ( child_context_border.outerHeight( true ) - child_context_border.innerHeight() );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\theight = this.getAvailableHeightForGrid( ui_id );\n\t\t\t}\n\t\t}\n\n\t\t//Ensure grid has a minimum height.\n\t\tif ( height < 100 ) {\n\t\t\theight = 100;\n\t\t}\n\n\t\tthis.grid.grid.setGridHeight( height );\n\n\t\t//this looks odd, but css does not have a has selector.\n\t\t$( '.sub-view .bottom-div:has(.paging-2-div:visible)' ).css( 'height', '20px' );\n\t\t$( '.sub-view .bottom-div:has(.paging-2-div:hidden)' ).css( 'height', 'auto' );\n\t\t//this.reloadGrid(); //slows down awesomeboxes\n\t}\n\n\tgetAvailableHeightForGrid( element_id, offset ) {\n\t\t//The available height for the table is the view height minus the difference between top of view and bottom of table header.\n\t\tif ( element_id.indexOf( '#' ) === -1 && element_id.indexOf( '.' ) != 0 ) {\n\t\t\telement_id = '#' + element_id;\n\t\t}\n\t\tlet table_header = $( element_id ).find( '#gbox_' + this.grid.getGridId() + ' .ui-jqgrid-labels' );\n\t\tif ( table_header.length === 0 ) {\n\t\t\t//Issue #3120 - Certain sub views have grid in a different part of the DOM.\n\t\t\t//Need to make sure to check for that else the grid will be given an incorrect or 0 height;\n\t\t\ttable_header = $( '#gbox_' + this.grid.getGridId() + ' .ui-jqgrid-labels' );\n\t\t\tif ( table_header.length === 0 ) {\n\t\t\t\treturn 100; //Default height.\n\t\t\t}\n\t\t}\n\n\t\tlet container_height =  $( element_id ).children('.context-border').length !== 0 ? $( element_id ).children('.context-border').innerHeight() : $( element_id ).height();\n\t\tlet height = container_height - ( ( table_header.offset().top + table_header.height() ) - $( element_id ).offset().top );\n\n\t\t//Check if view has a paging / bottom div and adjust grid height accordingly.\n\t\tlet bottom_div = $( element_id ).find( '.bottom-div' );\n\t\tif ( bottom_div.length > 0 && bottom_div.is(\":visible\") ) {\n            height -= 50;\n        }\n\n\t\tif ( Global.isHorizontalScrollBarRequired( $( '#gbox_' + this.grid.getGridId() )[0] ) ) { //pass dom element not jquery object\n\t\t\theight -= Global.getScrollbarHeight();\n\t\t}\n\n\t\treturn height;\n\t}\n\n\tgetDefaultHeightOffset() {\n\t\t//protect against NaNs\n\n\t\tvar offset = this.grid.grid.parents( '.ui-jqgrid-jquery-ui' ).find( '.ui-jqgrid-hbox' ).height() - 22; // 22 is default cell height. we just want the overage here.\n\t\tDebug.Text( 'Initial offset: ' + offset, 'BaseViewController.js', 'BaseViewController', 'getDefaultHeightOffset', 10 );\n\n\t\t//getting these selectors right for every grid was a lot of trial and error.\n\t\tif ( this.grid.grid.parents( '.ui-jqgrid-bdiv' ).width() > this.grid.grid.parents( '.ui-jqgrid-jquery-ui' ).width() ) {\n\t\t\toffset += 15; //scrollbar offset\n\t\t\tDebug.Text( 'Scrollbar offset detected: 15', 'BaseViewController.js', 'BaseViewController', 'getDefaultHeightOffset', 10 );\n\t\t}\n\n\t\tif ( this.search_panel && this.search_panel.is( ':visible' ) == true ) {\n\t\t\toffset += this.search_panel.height();\n\t\t\tDebug.Text( 'Search panel detected: ' + this.search_panel.height(), 'BaseViewController.js', 'BaseViewController', 'getDefaultHeightOffset', 10 );\n\t\t}\n\n\t\tvar total_number_div_height = ( $( '.total-number-div:visible' ).length > 0 ) ? $( '.total-number-div:visible' ).height() : 0;\n\t\tif ( total_number_div_height || total_number_div_height === 0 ) {\n\t\t\toffset += total_number_div_height;\n\t\t\tDebug.Text( 'Total number DIV height offset detected: ' + $( '.total-number-div:visible' ).height(), 'BaseViewController.js', 'BaseViewController', 'getDefaultHeightOffset', 10 );\n\t\t}\n\n\t\tvar footer_height = $( '.bottom-div' ).height() + 5;\n\t\tif ( footer_height || footer_height === 0 ) {\n\t\t\toffset += footer_height;\n\t\t\tDebug.Text( 'Footer height offset detected: ' + footer_height, 'BaseViewController.js', 'BaseViewController', 'getDefaultHeightOffset', 10 );\n\t\t}\n\n\t\tvar red_border_height = $( '.grid-top-border' ).height() * 2;\n\t\tif ( red_border_height || red_border_height === 0 ) {\n\t\t\toffset += red_border_height;\n\t\t\tDebug.Text( 'Red border height offset detected: ' + red_border_height, 'BaseViewController.js', 'BaseViewController', 'getDefaultHeightOffset', 10 );\n\t\t}\n\n\t\treturn offset;\n\t}\n\n\tfillCurrentRecord() {\n\t\t// Overrides form with data from push notification and http get variables.\n\t\tvar filtered_auto_fill_data = {};\n\t\tif ( LocalCacheData.getAutoFillData() ) {\n\t\t\t//Filter from local cache data.\n\t\t\tfiltered_auto_fill_data = this.filterAutoFillData( LocalCacheData.getAutoFillData() );\n\t\t\tLocalCacheData.setAutoFillData( null );\n\t\t} else {\n\t\t\t// Filter http get variables.\n\t\t\tfiltered_auto_fill_data = this.filterAutoFillData( LocalCacheData.getAllURLArgs() );\n\t\t}\n\n\t\tthis.auto_fill_data = filtered_auto_fill_data; //This is a copy of LocalCacheData.getAutoFillData() scoped to the current object so it does not effect views that open at same time.\n\n\t\t// Remove common variables from url to prevent unintended overrides.\n\t\tfor ( var key in filtered_auto_fill_data ) {\n\t\t\tif ( key === 'sid' || key === 'm' || key === 'sm' || key === 'tab' ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif ( this.allow_fill_record_keys != null && this.allow_fill_record_keys.includes( key ) == true ) {\n\t\t\t\t//This is a field not on UI.\n\t\t\t\tthis.current_edit_record[key] = filtered_auto_fill_data[key];\n\t\t\t} else if ( this.edit_view_ui_dic.hasOwnProperty( key ) && this.edit_view_ui_dic[key].setValue ) {\n\t\t\t\tthis.current_edit_record[key] = filtered_auto_fill_data[key];\n\t\t\t\tthis.edit_view_ui_dic[key].setValue( filtered_auto_fill_data[key] );\n\t\t\t\tthis.edit_view_ui_dic[key].trigger( 'change' );\n\t\t\t}\n\t\t}\n\t}\n\n\tfilterAutoFillData( auto_fill_data ) {\n\t\t// Auto fill variables only override data if the field exists on UI.\n\t\t// Helps prevent invisible changes in current_edit_record from users sharing links with purpose to trick/exploit.\n\n\t\tvar filtered_auto_fill_data = {};\n\t\tfor ( var key in auto_fill_data ) {\n\n\t\t\t// Ignore password fields\n\t\t\tif ( key.includes( 'password' ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfiltered_auto_fill_data[key] = auto_fill_data[key];\n\t\t}\n\t\treturn filtered_auto_fill_data;\n\t}\n\n\t//Compare two arrays of records and return an array of records that changed.\n\tgetChangedRecords( new_data, old_data, ignored_keys ) {\n\t\tlet changed_data = new_data.filter( ( record ) => {\n\n\t\t\tlet old_record = old_data.find( ( old_item ) => old_item.id == record.id );\n\t\t\t//If record id does not exist in old_data, it is a new record and should be marked as changed.\n\t\t\tif ( !old_record ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t//Compare each key for changed data. Loop over the keys in the current record and not old incase a new key was added that is not in the old record.\n\t\t\tfor ( let keys in record ) {\n\t\t\t\t//Some views add extra data to the record which is only used locally and should not be used for comparison.\n\t\t\t\tif ( ignored_keys.length > 0 && ignored_keys.includes( keys ) ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t//If the value is an array check each value exists in the old record array.\n\t\t\t\tif ( Array.isArray( record[keys] ) && Array.isArray( old_record[keys] ) ) {\n\t\t\t\t\t//If the arrays are different lengths, we know they are different, and do not need to check the values.\n\t\t\t\t\tif ( record[keys].length !== old_record[keys].length || !record[keys].every( value => old_record[keys].includes( value ) ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//Compare values of each key in the record.\n\t\t\t\telse if ( record[keys] != old_record[keys] ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t} );\n\n\t\treturn changed_data;\n\t}\n\n}\n\n//Don't check the file for now. Too many issues\n/* jshint ignore:end */\n\nBaseViewController.loadView = function( view_id ) {\n\n\tGlobal.loadViewSource( view_id, view_id + 'View.html', function( result ) {\n\n\t\t// #VueContextMenu# Vue route change, this triggers the context menu.\n\t\t// TODO: BaseViewController.loadView is overriden in many places. Also need to handle those.\n\t\t// Which is better, here or in IndexController.onViewChange? here will catch all changes from hash to login to final viewcontroller. will onViewChange catch that too?\n\t\t// console.log('aaaa BaseV.loadView', view_id); // comparing triggers against IndexController.\n\n\t\t// TODO: Can we simplify this and remove the needs for props:true in router?\n\t\t// Note: This behaviour/router call is also in IndexController.openReport()\n\t\t// VueRouter.push('/view/'+$this.viewId);\n\t\t// window.context_menus[ view_id ]  = new ContextMenuManager(); // Initialize Vue ContextMenuManager here so that each view has their own unique one.\n\t\t// VueRouter.push({\n\t\t// \tname: 'view',\n\t\t// \tparams: {\n\t\t// \t\tviewId: view_id\n\t\t// \t}\n\t\t// }).then(function() {\n\t\t// \tdoNext( result );\n\t\t// });\n\t\tdoNext( result ); // Now using one global context menu, so no need for router calls. Just using the one single LegacyView for now.\n\t} );\n\n\n\tfunction doNext( result ) {\n\t\tvar args = {};\n\t\tswitch ( view_id ) {\n\t\t\tcase 'TimeSheet':\n\t\t\t\tGlobal.loadViewSource( view_id, view_id + 'View.css' );\n\t\t\t\targs = {\n\t\t\t\t\taccumulated_time: $.i18n._( 'Accumulated Time' ),\n\t\t\t\t\tverify: $.i18n._( 'Verify' ),\n\t\t\t\t\ttimesheet_verification: $.i18n._( 'TimeSheet Verification' )\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 'Login':\n\t\t\t\t$( 'body' ).addClass( 'login-bg' );\n\t\t\t\t$( 'body' ).removeClass( 'application-bg' );\n\t\t\t\t// Global.loadViewSource( view_id, view_id + 'View.css' ); // #2833 Login CSS was being loaded twice. Now only loaded in the index.php file for speed.\n\t\t\t\tbreak;\n\t\t\tcase 'PortalJobVacancyDetail':\n\t\t\t\targs = {\n\t\t\t\t\tsearch_label: $.i18n._( 'Search' )\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 'PortalJobVacancy':\n\t\t\t\targs = {\n\t\t\t\t\tsearch_label: $.i18n._( 'Search' ),\n\t\t\t\t\tload_more: $.i18n._( 'Loading' ) + '...'\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 'MyJobApplication':\n\t\t\tcase 'MyProfile':\n\t\t\t\tbreak;\n\t\t\tcase 'Schedule':\n\t\t\t\tGlobal.loadViewSource( view_id, view_id + 'View.css' );\n\t\t\t\tbreak;\n\t\t}\n\t\tIndexViewController.instance.router.removeCurrentView();\n\t\tvar template = _.template( result );\n\t\tGlobal.contentContainer().html( template( args ) );\n\t\tLocalCacheData.current_open_view_id = view_id;\n\t\tGlobal.trackView( view_id, LocalCacheData.current_doing_context_action );\n\t}\n\n};\n\nBaseViewController.default_layout_name = $.i18n._( '-- Default --' );\n","import firebase from 'firebase/compat/app';\nimport 'firebase/compat/messaging';\nimport { TTAPI } from '@/services/TimeTrexClientAPI';\nimport 'bootstrap';\nimport TTEventBus from '@/services/TTEventBus';\n\nclass NotificationConsumer {\n\n\tconstructor() {\n\n\t\tconst firebaseConfig = {\n\t\t\tapiKey: \"AIzaSyB9tM0QYb1D3JF07RqpeG-14ADGhezGRws\",\n\t\t\tauthDomain: \"timetrex-app.firebaseapp.com\",\n\t\t\tdatabaseURL: \"https://timetrex-app.firebaseio.com\",\n\t\t\tprojectId: \"timetrex-app\",\n\t\t\tstorageBucket: \"timetrex-app.appspot.com\",\n\t\t\tmessagingSenderId: \"462133047262\",\n\t\t\tappId: \"1:462133047262:web:1705b6bfca364bcd99b74f\"\n\t\t};\n\n\t\t// Initialize Firebase\n\t\tfirebase.initializeApp( firebaseConfig );\n\t\tthis.browser_supported = firebase.messaging.isSupported();\n\t\tthis.messaging = firebase.messaging.isSupported() ? firebase.messaging() : null;\n\t\tthis.user_notification_device_token_api = TTAPI.APINotificationDeviceToken;\n\t\tthis.notification_api = TTAPI.APINotification;\n\t\tthis.user_preference_api = TTAPI.APIUserPreference;\n\t\tthis.notification_holder = document.querySelector( '#notification-holder' );\n\t\tthis.notification_duration = 120000;\n\t\tthis.token = '';\n\t\tthis.notification_total = 0;\n\t\tthis.active_notification_stack = []; //Stack of notifications on screen.\n\t\tthis.create_event_listeners = true;\n\t\tthis.notification_sound = null;\n\t\tthis.sound_timer = null;\n\t\tthis.title_timer = null;\n\t\tthis.previous_page_title = document.title;\n\t\tthis.pending_events = [];\n\t\tthis.event_bus = new TTEventBus( { view_id: 'notification_consumer' } );\n\t}\n\n\tsetupUser( request_permission, refresh_token ) {\n\t\tif ( refresh_token === true ) {\n\t\t\tthis.deleteNotificationDeniedCookie();\n\t\t}\n\n\t\tif ( this.isBrowserSupported( refresh_token ) === false ) {\n\t\t\tif ( refresh_token === true ) {\n\t\t\t\tTAlertManager.showAlert( $.i18n._( 'Sorry, this is browser does not support push notifications.' ), $.i18n._( 'Push Notifications' ) );\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\t//If impersonating other users do not show notification permission request pop ups or notifications.\n\t\tvar alternate_session_data = getCookie( 'AlternateSessionData' );\n\t\tif ( alternate_session_data && !refresh_token ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t//User has either repeatedly denied permissions or has disabled notifications for this browser in user preferences.\n\t\tif ( this.getNotificationDeniedCookie().asked_count >= 2 && refresh_token === false ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( LocalCacheData.getLoginUser() && APIGlobal.pre_login_data.production === true && APIGlobal.pre_login_data.demo_mode !== true && APIGlobal.pre_login_data.sandbox !== true ) {\n\t\t\tthis.notification_duration = parseInt( LocalCacheData.getLoginUserPreference().notification_duration ) * 1000;\n\n\t\t\tif ( Notification.permission === 'granted' && LocalCacheData.getLoginUserPreference().notification_status_id !== 2 ) {\n\t\t\t\tthis.registerWorkerAndGetToken( true );\n\t\t\t\tthis.createNotificationListeners();\n\t\t\t\tif ( refresh_token === true ) {\n\t\t\t\t\t// Provide feedback to user when they click refresh push notifications button.\n\t\t\t\t\tTAlertManager.showAlert( $.i18n._( 'Push Notifications Enabled' ), $.i18n._( 'Push Notifications' ) );\n\t\t\t\t}\n\t\t\t} else if ( request_permission && Notification.permission === 'default' ) {\n\t\t\t\t//Do not show mobile browsers notification permission alert unless they manually refresh notifications in My Account -> Preferences.\n\t\t\t\tif ( APIGlobal.pre_login_data.user_agent_data.is_mobile === true && refresh_token === false ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.showNotificationPermissionAlert();\n\t\t\t} else if ( refresh_token === true ) {\n\t\t\t\tthis.showNotificationPermissionAlert();\n\t\t\t}\n\t\t} else {\n\t\t\t// Else user has declined permissions.\n\t\t\tif ( refresh_token === true ) {\n\t\t\t\tTAlertManager.showAlert( $.i18n._( 'Sorry, push notifications are disabled on this server.' ), $.i18n._( 'Push Notifications' ) );\n\t\t\t}\n\t\t}\n\t}\n\n\t// Register our service worker and vapidKey.\n\t// Safari and Firefox require this to trigger on a user action and not just randomly ask.\n\tregisterWorkerAndGetToken( send_token ) {\n\t\ttry {\n\t\t\tnavigator.serviceWorker.register( './dist/v' + APIGlobal.pre_login_data.application_version + '/firebase-messaging-sw.js' )\n\t\t\t\t.then( ( registration ) => {\n\t\t\t\t\tthis.messaging.getToken( {\n\t\t\t\t\t\tserviceWorkerRegistration: registration,\n\t\t\t\t\t\tvapidKey: 'BAIFamGLNE689DChvdL8bWrvgiPFUMGzPwBrxuDiKQNTzpbQu-VZ3urH3SdIOSQ4DUYAOmeTrhmGTNQaNdtW-2I'\n\t\t\t\t\t} ).then( ( currentToken ) => {\n\t\t\t\t\t\tif ( currentToken ) {\n\t\t\t\t\t\t\tthis.token = currentToken;\n\t\t\t\t\t\t\tif ( send_token ) {\n\t\t\t\t\t\t\t\tthis.sendDeviceToken( this.token );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t//If permission alert exists, remove it.\n\t\t\t\t\t\t\tif ( $( '.modal-alert' ).length ) {\n\t\t\t\t\t\t\t\t$( '.modal-alert' ).remove();\n\t\t\t\t\t\t\t\tGlobal.setUIReady();\n\t\t\t\t\t\t\t\tthis.sendAnalytics( 'allow-confirm' ); //Only trigger this when the employee is actually asked to allow permissions. Not everytime the service worker is registered.\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//request permission window happens\n\t\t\t\t\t\t}\n\t\t\t\t\t} ).catch( ( err ) => {\n\t\t\t\t\t\t// unexpected error\n\t\t\t\t\t} );\n\t\t\t\t} );\n\t\t} catch ( err ) {\n\t\t\tDebug.Text( 'Error attempting to register firebase service workers and push notification service: ' + err.message, 'NotificationConsumer.js', 'NotificationConsumer', 'registerWorkerAndGetToken', 9 );\n\t\t}\n\t}\n\n\tisBrowserSupported( show_message ) {\n\t\tif ( window.location.protocol !== 'https:' ) {\n\t\t\tDebug.Text( 'Not on a HTTPS connection. Push Notifications disabled.', 'NotificationConsumer.js', 'NotificationConsumer', 'checkBrowserSupported', 9 );\n\t\t\tif ( show_message === true ) {\n\t\t\t\t// Provide feedback to user why push notifications are not working if they clicked to refresh push notifications in My Account -> Preferences.\n\t\t\t\tTAlertManager.showAlert( $.i18n._( 'Push Notification are only available on HTTPS connections.' ), $.i18n._( 'Push Notifications' ) );\n\t\t\t}\n\t\t\treturn false;\n\t\t} else if ( this.browser_supported === false ) {\n\t\t\tDebug.Text( 'User on an unsupported browser.', 'NotificationConsumer.js', 'NotificationConsumer', 'checkBrowserSupported', 9 );\n\t\t\tif ( show_message === true ) {\n\t\t\t\t// Provide feedback to user why push notifications are not working if they clicked to refresh push notifications in My Account -> Preferences.\n\t\t\t\tTAlertManager.showAlert( $.i18n._( 'Push Notification are not supported on this browser.' ), $.i18n._( 'Push Notifications' ) );\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tsendDeviceToken( device_token ) {\n\t\tthis.user_notification_device_token_api.checkAndSetNotificationDeviceToken( device_token, 100, {\n\t\t\tonResult: function( res ) {\n\t\t\t\tlet result = res.getResult();\n\t\t\t}\n\t\t} );\n\t}\n\n\tdeleteToken() {\n\t\tvar $this = this;\n\t\tif ( this.token ) {\n\t\t\tthis.messaging.deleteToken().then( ( result ) => {\n\t\t\t\tlet data = {};\n\t\t\t\tdata.device_token = this.token;\n\t\t\t\tthis.user_notification_device_token_api.deleteNotificationDeviceToken( [data], {\n\t\t\t\t\tonResult: function( res ) {\n\t\t\t\t\t\t$this.token = '';\n\t\t\t\t\t\tvar result = res.getResult();\n\t\t\t\t\t\tif ( result ) {\n\t\t\t\t\t\t\tDebug.Text( 'Successfully deleted device token.', 'NotificationConsumer.js', 'NotificationConsumer', 'deleteToken', 9 );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tDebug.Text( 'Failed to delete device token.', 'NotificationConsumer.js', 'NotificationConsumer', 'deleteToken', 9 );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} ).catch( ( err ) => {\n\t\t\t\tDebug.Text( 'ERROR: While attempting to delete notification device token.', 'NotificationConsumer.js', 'NotificationConsumer', 'deleteToken', 9 );\n\t\t\t} );\n\t\t}\n\t}\n\n\tdeleteAllTokens() {\n\t\t//This deletion path does necessarily mean the current session has a device token, but will attempt to delete all device tokens for the current user.\n\t\tvar $this = this;\n\t\tthis.user_notification_device_token_api.deleteAllNotificationDeviceTokens( {\n\t\t\tonResult: function( res ) {\n\t\t\t\t$this.token = '';\n\t\t\t\tvar result = res.getResult();\n\t\t\t\tif ( result ) {\n\t\t\t\t\tDebug.Text( 'Successfully deleted all device tokens.', 'NotificationConsumer.js', 'NotificationConsumer', 'DeleteAllDeviceTokens', 9 );\n\t\t\t\t} else {\n\t\t\t\t\tDebug.Text( 'Failed to delete all device tokens, none may exist.', 'NotificationConsumer.js', 'NotificationConsumer', 'DeleteAllDeviceTokens', 9 );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tcreateNotificationListeners() {\n\t\tif ( this.create_event_listeners === false ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar $this = this;\n\t\tthis.create_event_listeners = false;\n\n\t\t// Handles foreground, background and background notification-clicked events.\n\t\tnavigator.serviceWorker.addEventListener( 'message', payload => {\n\t\t\tthis.handlePushNotificationEvent( payload.data.messageType === 'push-received', payload.data );\n\t\t} );\n\n\t\tthis.notification_holder.addEventListener( 'click', event => {\n\t\t\tlet element = event.target;\n\n\t\t\tif (element?.id === 'notification-holder') {\n\t\t\t\t//Issue #3466 - User did not click on a specific notification, clicked on holder for all notifications and we cannot clicked notification from that.\n\t\t\t\t//Returning early to prevent exceptions.\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet notification_id = element.closest( '.toast' )?.querySelector( '.notification-link' )?.id ?? null;\n\n\t\t\tif ( !notification_id ) {\n\t\t\t\tDebug.Text( 'Notification ID not found.', 'NotificationConsumer.js', 'NotificationConsumer', 'createNotificationListeners', 9 );\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( element.classList.contains( 'notification-close' ) ) {\n\t\t\t\t// Ignored notifications are not marked as read.\n\t\t\t\tthis.removeNotification( notification_id );\n\t\t\t} else if ( element.classList.contains( 'notification-link' ) ) {\n\t\t\t\t// Mark notification as read when user clicks \"view details\" and is sent to the notificwtion link.\n\t\t\t\tthis.setNotificationAsRead( element.id );\n\t\t\t\tthis.removeNotification( element.id );\n\n\t\t\t\t//If notification has an open_view event attached, trigger that event and then delete it.\n\t\t\t\tfor ( var i = this.pending_events.length - 1; i >= 0; i-- ) {\n\t\t\t\t\tif ( this.pending_events[i].id === element.id && this.pending_events[i].event === 'open_view' ) {\n\t\t\t\t\t\tthis.openViewLinkedToNotification( this.pending_events[i].event_data );\n\t\t\t\t\t\tevent.preventDefault(); //Stop default href from being followed.\n\t\t\t\t\t\tthis.pending_events.splice( i, 1 ); //Delete event from pending events.\n\t\t\t\t\t\tthis.startTimers();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t\twindow.addEventListener( 'focus', function( event ) {\n\t\t\t$this.cancelTimers();\n\t\t}, false );\n\t}\n\n\thandlePushNotificationEvent( foreground, payload ) {\n\t\tlet timetrex_data = JSON.parse( payload.data.timetrex );\n\n\t\tDebug.Arr( payload, 'Push notification received.', 'NotificationConsumer.js', 'NotificationConsumer', 'handlePushNotificationEvent', 9 );\n\n\t\t// If on foreground displays the notification.\n\t\tif ( payload.messageType !== 'notification-clicked' && timetrex_data.user_id !== undefined && LocalCacheData.getLoginUser() && LocalCacheData.getLoginUser().id === timetrex_data.user_id && payload.notification && payload.notification.title ) {\n\t\t\tthis.event_bus.emit( 'tt_topbar', 'profile_pending_counts', { //When push notification received update all \"My Profile\" badges.\n\t\t\t\tobject_types: []\n\t\t\t} );\n\n\t\t\t// Increment total on bell everytime a new notification comes in.\n\t\t\tthis.updateBell( true, this.notification_total + 1 );\n\t\t\tthis.showNotification( payload.notification.title, payload.notification.body, payload.notification.click_action, timetrex_data.id, timetrex_data.priority, payload.data.link_target ? payload.data.link_target : '' );\n\t\t\tDebug.Text( 'Showing Notification on UI as user_id matches and notification was not a system click.', 'NotificationConsumer.js', 'NotificationConsumer', 'handlePushNotificationEvent', 9 );\n\t\t}\n\n\t\tif ( payload.messageType === 'notification-clicked' ) {\n\t\t\tDebug.Text( 'Notification was clicked on from desktop.', 'NotificationConsumer.js', 'NotificationConsumer', 'handlePushNotificationEvent', 9 );\n\n\t\t\t// Set notification as read as we about to redirect the user to the notification.\n\t\t\tthis.setNotificationAsRead( timetrex_data.id );\n\t\t\t// If the notification toast is still on screen remove it.\n\t\t\tthis.removeNotification( timetrex_data.id );\n\n\t\t\t// User clicked desktop notification, redirect them directly to the notification if a click_action was given.\n\t\t\tif ( payload.notification.click_action !== undefined && payload.notification.click_action !== '' ) {\n\t\t\t\twindow.location = payload.notification.click_action;\n\t\t\t} else {\n\t\t\t\twindow.location = Global.getBaseURL() + '#!m=Notification';\n\t\t\t}\n\t\t} else {\n\t\t\t//Handle background events if any are in the payload.\n\t\t\tif ( timetrex_data.event !== undefined && timetrex_data.event.length > 0 ) {\n\t\t\t\tthis.handleBackgroundEvent( timetrex_data );\n\t\t\t}\n\t\t}\n\t}\n\n\thandleBackgroundEvent( timetrex_data ) {\n\t\t// Handles timetrex specific data of notification payload.\n\t\tDebug.Text( 'Background action was supplied in the push notification.', 'NotificationConsumer.js', 'NotificationConsumer', 'handlePushNotificationEvent', 9 );\n\t\tfor ( let i = 0; i < timetrex_data.event.length; i++ ) {\n\t\t\tswitch ( timetrex_data.event[i].type ) {\n\t\t\t\tcase 'clean_cache':\n\t\t\t\t\tLocalCacheData.cleanNecessaryCache();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'open_view':\n\t\t\t\t\t//Only triggered if user clicks the notification.\n\t\t\t\t\tthis.pending_events.push( {\n\t\t\t\t\t\tid: timetrex_data.id,\n\t\t\t\t\t\tevent: timetrex_data.event[i].type,\n\t\t\t\t\t\tevent_data: timetrex_data.event[i]\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'open_view_immediate':\n\t\t\t\t\tthis.openViewLinkedToNotification( timetrex_data.event[i] );\n\t\t\t\t\tthis.startTimers();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'redirect':\n\t\t\t\t\tif ( timetrex_data.event[i].ask === 1 ) {\n\t\t\t\t\t\tTAlertManager.showConfirmAlert( $.i18n._( timetrex_data.event[i].text ), $.i18n._( 'Redirect Confirmation' ), ( flag ) => {\n\t\t\t\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t\t\t\tif ( timetrex_data.event[i].target && timetrex_data.event[i].target === '_blank' ) {\n\t\t\t\t\t\t\t\t\twindow.open(\n\t\t\t\t\t\t\t\t\t\ttimetrex_data.event[i].link,\n\t\t\t\t\t\t\t\t\t\t'_blank'\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\twindow.location = timetrex_data.event[i].link;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( timetrex_data.event[i].target && timetrex_data.event[i].target === '_blank' ) {\n\t\t\t\t\t\t\twindow.open(\n\t\t\t\t\t\t\t\ttimetrex_data.event[i].link,\n\t\t\t\t\t\t\t\t'_blank'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twindow.location = timetrex_data.event[i].link;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'refresh_job_queue':\n\t\t\t\t\tthis.event_bus.emit( 'tt_topbar', 'toggle_job_queue_spinner', {\n\t\t\t\t\t\t//Boolean events for job queue spinner.\n\t\t\t\t\t\tshow: timetrex_data.event[i].show, //Show the job queue spinner\n\t\t\t\t\t\tget_job_data: timetrex_data.event[i].get_job_data, //Update job queue panel data\n\t\t\t\t\t\tcheck_completed: timetrex_data.event[i].check_completed //Check if job queue is completed and hide the job queue spinner if no pending tasks.\n\t\t\t\t\t} );\n\n\t\t\t\t\t//Update TimeSheet is user is on it.\n\t\t\t\t\tif ( LocalCacheData.current_open_primary_controller && LocalCacheData.current_open_primary_controller.viewId === 'TimeSheet' ) {\n\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.search();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\topenViewLinkedToNotification( event_data ) {\n\t\t//Open a view with the option of pre-filling fields.\n\t\tLocalCacheData.setAutoFillData( event_data.data );\n\t\t// This is taking them to listview in some cases so a on a onAdd/onEdit click can be clicked afterwards.\n\t\tIndexViewController.goToViewByViewLabel( event_data.view_name );\n\n\t\t// Ignore edit only views that don't have list views.\n\t\tif ( event_data.view_name !== 'InOut' && event_data.view_name !== 'Contact Information' ) {\n\t\t\t// Need to add the promise before onTabShow is called where it's originally intended to be added otherwise the below wait is not triggered.\n\t\t\tTTPromise.add( 'BaseViewController', 'onTabShow' );\n\t\t\tTTPromise.wait( 'BaseViewController', 'onTabShow', function() {\n\t\t\t\tif ( event_data.action === 'add' ) {\n\t\t\t\t\tLocalCacheData.current_open_primary_controller.onAddClick();\n\t\t\t\t} else if ( event_data.action === 'edit' ) {\n\t\t\t\t\tLocalCacheData.current_open_primary_controller.onEditClick( event_data.view_id );\n\t\t\t\t} else if ( event_data.action === 'view' ) {\n\t\t\t\t\tLocalCacheData.current_open_primary_controller.onViewClick( event_data.view_id );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tsetNotificationDeniedCookie( cookie_value ) {\n\t\tcookie_value.asked_count++;\n\t\tcookie_value.last_asked = new Date().getTime();\n\n\t\tsetCookie( 'disable_push_notification_ask', JSON.stringify( cookie_value ), 10000, APIGlobal.pre_login_data.cookie_base_url );\n\t}\n\n\tdeleteNotificationDeniedCookie() {\n\t\tdeleteCookie( 'disable_push_notification_ask' );\n\t}\n\n\tgetNotificationDeniedCookie() {\n\t\tif ( getCookie( 'disable_push_notification_ask' ) ) {\n\t\t\treturn JSON.parse( getCookie( 'disable_push_notification_ask' ) );\n\t\t}\n\n\t\tvar cookie_value = {};\n\t\tcookie_value.asked_count = 0;\n\t\tcookie_value.last_asked = 0;\n\n\t\treturn cookie_value;\n\t}\n\n\tshowNotificationPermissionAlert() {\n\t\t//Only ever ask twice to enable notification permissions for this browser.\n\t\t//If we have only asked once before and it has been 180 days since then, ask again.\n\t\tvar notification_denied_cookie = this.getNotificationDeniedCookie();\n\t\tif ( notification_denied_cookie.asked_count > 1 || notification_denied_cookie.last_asked + ( 180 * 24 * 60 * 60 * 1000 ) > new Date().getTime() ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tTAlertManager.showModalAlert( 'push_notification', 'ask', ( flag ) => {\n\t\t\tif ( flag === true ) {\n\t\t\t\tthis.showPermissionHelp();\n\t\t\t\tthis.setUserPreferencePushNotification( 1 );\n\t\t\t\tthis.sendAnalytics( 'allow' );\n\t\t\t} else {\n\t\t\t\tthis.setUserPreferencePushNotification( 0 );\n\t\t\t\tthis.sendAnalytics( 'deny' );\n\t\t\t\tthis.setNotificationDeniedCookie( notification_denied_cookie );\n\t\t\t}\n\t\t} );\n\t}\n\n\tshowPermissionHelp() {\n\t\tthis.registerWorkerAndGetToken( true );\n\t\tthis.createNotificationListeners();\n\n\t\tTAlertManager.showModalAlert( 'push_notification', 'wait_for_permission', ( flag ) => {\n\t\t\tif ( flag === true ) {\n\t\t\t\tTAlertManager.showModalAlert( 'push_notification', 'help_text', '' );\n\t\t\t\tthis.showArrowToEnablePushNotifications();\n\t\t\t\tthis.sendAnalytics( 'unsure' );\n\t\t\t}\n\t\t} );\n\t}\n\n\tshowArrowToEnablePushNotifications() {\n\t\tconst arrow = $( '<div class=\"permission-arrow\">' +\n\t\t\t'<img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"' + Global.getRealImagePath( 'images/notification-arrow.svg' ) + '\" width=\"150\" height=\"150!\">' +\n\t\t\t'</div>' );\n\n\t\t$( '.modal-alert' ).append( arrow );\n\t}\n\n\tsetUserPreferencePushNotification( status ) {\n\t\tif ( LocalCacheData.getLoginUser() && LocalCacheData.getLoginUserPreference() ) {\n\t\t\tvar data = {};\n\n\t\t\tdata.user_id = LocalCacheData.getLoginUser().id;\n\t\t\tdata.id = LocalCacheData.getLoginUserPreference().id;\n\t\t\tdata.browser_permission_ask_date = Math.round( new Date().getTime() / 1000 );\n\t\t\t//If user agrees set notifications to enabled. Else only set last browser_permission_ask_date.\n\t\t\tif ( status === 1 ) {\n\t\t\t\tdata.notification_status_id = status;\n\t\t\t}\n\n\t\t\tthis.user_preference_api.setUserPreference( data, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tlet result = res.getResult();\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tsendAnalytics( choice ) {\n\t\tGlobal.sendAnalyticsEvent( 'push_notifications', 'click', 'click:push_notifications:' + choice );\n\t}\n\n\tgetUnreadNotifications() {\n\t\tthis.notification_api.getUnreadNotifications( {\n\t\t\tonResult: ( result ) => {\n\t\t\t\tthis.notification_total = parseInt( result.getResult() );\n\t\t\t\tthis.updateBell( false, this.notification_total );\n\t\t\t}\n\t\t} );\n\t}\n\n\tgetSystemNotifications( target ) {\n\t\tthis.notification_api.getSystemNotification( target, {\n\t\t\tonResult: ( result ) => {\n\t\t\t\tvar new_system_notifications = parseInt( result.getResult() );\n\n\t\t\t\tif ( new_system_notifications > 0 ) {\n\t\t\t\t\tthis.updateBell( true, this.notification_total + new_system_notifications );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tsetNotificationAsRead( id ) {\n\t\tthis.notification_api.setNotificationStatus( [id], 20, {\n\t\t\tonResult: ( result ) => {\n\t\t\t\tthis.updateBell( true, this.notification_total - 1 );\n\t\t\t}\n\t\t} );\n\t}\n\n\tupdateBell( manual, amount ) {\n\t\tif ( manual ) {\n\t\t\tthis.notification_total = amount;\n\t\t}\n\n\t\tthis.event_bus.emit( 'tt_topbar', 'notification_bell', {\n\t\t\tnotification_count: this.notification_total\n\t\t} );\n\t}\n\n\tplaySound() {\n\t\t// Only load notification sound when we first need it. Then reuse from then on.\n\t\tif ( this.notification_sound === null ) {\n\t\t\tthis.notification_sound = new Audio();\n\t\t\tthis.notification_sound.src = Global.getBaseURL( '../' ) + 'sounds/notification.mp3';\n\t\t\tthis.notification_sound.load();\n\t\t}\n\n\t\tconst playPromise = this.notification_sound.play();\n\t\tif ( playPromise !== undefined ) { //Older browsers play() does not return anything.\n\t\t\tplayPromise.then( () => {\n\t\t\t\t//Notification audio is playing.\n\t\t\t} )\n\t\t\t\t.catch( error => {\n\t\t\t\t\tconsole.log( error );\n\t\t\t\t} );\n\t\t}\n\t}\n\n\tstartTimers() {\n\t\tthis.playSound();\n\n\t\tvar $this = this;\n\t\tif ( document.hasFocus() === false && this.sound_timer === null ) {\n\t\t\t//Change page title and repeat notififation sound if page does not have focus and no timer is already set.\n\t\t\tthis.sound_timer = setInterval( function() {\n\t\t\t\tif ( document.hasFocus() ) {\n\t\t\t\t\t//If tab is in focus cancel the timer.\n\t\t\t\t\t$this.cancelTimers();\n\t\t\t\t} else {\n\t\t\t\t\t$this.playSound();\n\t\t\t\t}\n\t\t\t}, 5000 );\n\n\t\t\tthis.title_timer = setInterval( function() {\n\t\t\t\tif ( document.hasFocus() ) {\n\t\t\t\t\t//If tab is in focus cancel the timer.\n\t\t\t\t\t$this.cancelTimers();\n\t\t\t\t} else {\n\t\t\t\t\tif ( document.title === '!!!!!!!!!!!!!' ) {\n\t\t\t\t\t\tdocument.title = $.i18n._( 'NOTICE!' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdocument.title = '!!!!!!!!!!!!!';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 2000 );\n\t\t}\n\t}\n\n\tcancelTimers() {\n\t\tif ( this.sound_timer !== null ) {\n\t\t\tclearInterval( this.sound_timer );\n\t\t\tthis.sound_timer = null;\n\t\t}\n\n\t\tif ( this.title_timer !== null ) {\n\t\t\tdocument.title = this.previous_page_title;\n\t\t\tclearInterval( this.title_timer );\n\t\t\tthis.title_timer = null;\n\t\t}\n\t}\n\n\tshowNotification( title, body, url, notification_id, priority, target ) {\n\t\tif ( priority == 10 ) {\n\t\t\t//User is not notified nor receives toast for low priority notifications.\n\t\t\treturn false;\n\t\t}\n\n\t\t//All notifications other than low play notification sound.\n\t\tthis.playSound();\n\n\t\t// To stop infinite stacking notifications on screen we only show up to 5 at a time. When a new one comes in we remove the oldest.\n\t\t// Allow high and critical priority notifications with priority 1 or 2 through.\n\t\tif ( this.active_notification_stack.length >= 5 && priority > 2 ) {\n\t\t\tthis.removeNotification( this.active_notification_stack[0].id );\n\t\t}\n\n\t\tconst notification = document.createElement( 'div' );\n\t\tnotification.className = 'toast show toast-spacing';\n\t\tnotification.style = 'width: 22rem; background-color: hsla(0, 0%, 100%, 1) !important; margin-bottom: 0.4rem !important;';\n\n\t\tconst notification_header = document.createElement( 'div' );\n\t\tnotification_header.className = 'toast-header';\n\n\t\tconst notification_title = document.createElement( 'strong' );\n\t\tnotification_title.className = 'me-auto';\n\t\tnotification_title.textContent = title;\n\n\t\tconst notification_close_button = document.createElement( 'button' );\n\t\tnotification_close_button.className = 'btn-close notification-close';\n\t\tnotification_close_button.setAttribute( 'aria-label', 'close' );\n\t\tnotification_close_button.style.fontSize = '12px';\n\n\t\tconst notification_body = document.createElement( 'div' );\n\t\tnotification_body.className = 'toast-body';\n\n\t\tconst notification_body_text = document.createElement( 'p' );\n\t\tnotification_body_text.textContent = body;\n\n\t\tconst notification_body_link = document.createElement( 'a' );\n\t\tnotification_body_link.textContent = 'View Details';\n\t\tnotification_body_link.id = notification_id;\n\t\tnotification_body_link.className = 'notification-link';\n\t\tif ( url !== undefined && url !== '' ) {\n\t\t\tnotification_body_link.href = url;\n\t\t} else {\n\t\t\tnotification_body_link.href = Global.getBaseURL() + '#!m=Notification';\n\t\t}\n\n\t\tif ( target === '_blank' ) {\n\t\t\tnotification_body_link.target = '_blank';\n\t\t}\n\n\t\tnotification_header.appendChild( notification_title );\n\t\tnotification_header.appendChild( notification_close_button );\n\t\tnotification.appendChild( notification_header );\n\n\t\tnotification_body.appendChild( notification_body_text );\n\t\tnotification_body.appendChild( notification_body_link );\n\t\tnotification.appendChild( notification_body );\n\n\t\tthis.notification_holder.appendChild( notification );\n\n\t\tthis.active_notification_stack.push( { id: notification_id, notification: notification } );\n\n\t\tif ( priority == 2 ) {\n\t\t\t//High priority notifications flash border twice around notification.\n\t\t\tnotification.className += ' notification-outline-repeat';\n\t\t} else if ( priority == 1 ) {\n\t\t\t//Critical priority notification repeat the notification sound, change document title and continuously flash border around toast.\n\t\t\tthis.startTimers( notification );\n\t\t\tnotification.className += ' notification-outline-infinite';\n\t\t}\n\n\t\tif ( this.notification_duration !== 0 && priority != 1 ) {\n\t\t\t// User notification preferences with 0 delay or critical notifications with priority 1 are never automatically removed.\n\t\t\tsetTimeout( () => {\n\t\t\t\tthis.removeNotification( notification_id );\n\t\t\t}, this.notification_duration );\n\t\t}\n\t}\n\n\tremoveNotification( id ) {\n\t\tfor ( let i = 0; i < this.active_notification_stack.length; i++ ) {\n\t\t\tif ( this.active_notification_stack[i].id === id ) {\n\t\t\t\tthis.active_notification_stack[i].notification.remove();\n\t\t\t\tthis.active_notification_stack.splice( i, 1 );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveAllNotifications() {\n\t\tthis.active_notification_stack.forEach( ( active_notification ) => {\n\t\t\tactive_notification.notification.remove();\n\t\t} );\n\n\t\tthis.active_notification_stack = [];\n\t\tthis.cancelTimers();\n\t}\n\n\tdetectBrowserNeedsExtraPermission() {\n\t\t// Some browsers by default block push notification permission so we need to detect them to show user a different prompt\n\t\tif ( Global.getBrowserVendor() === 'Edge' ) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n}\n\nexport const NotificationConsumerObj = new NotificationConsumer();","import { useRegistration } from '@web-auth/webauthn-helper';\nimport { useLogin } from '@web-auth/webauthn-helper';\nimport { Global } from '@/global/Global';\n\nclass TTWebauthn {\n\n\tenrollCurrentUser( authenticate_callback ) {\n\t\tthis.register( {\n\t\t\tid: LocalCacheData.getLoginUser().id,\n\t\t\tusername: LocalCacheData.getLoginUser().user_name,\n\t\t\tdisplayName: LocalCacheData.getLoginUser().full_name\n\t\t} )\n\t\t\t.then( ( result ) => {\n\t\t\t\tif ( result ) {\n\t\t\t\t\tDebug.Text( 'Webauthn enrollment success.', 'TTWebauthn.js', 'TTWebauthn', 'enrollCurrentUser', 10 );\n\t\t\t\t\tauthenticate_callback();\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.catch( ( error ) => Debug.Text( 'Webauthn enrollment failure.', 'TTWebauthn.js', 'TTWebauthn', 'enrollCurrentUser', 10 ) );\n\t}\n\n\tloginUser( id, user_name, authenticate_callback ) {\n\t\tthis.login( {\n\t\t\tid: id,\n\t\t\tusername: user_name,\n\t\t} )\n\t\t\t.then( ( result ) => {\n\t\t\t\tDebug.Text( 'Webauthn login success.', 'TTWebauthn.js', 'TTWebauthn', 'loginUser', 10 );\n\t\t\t\tif ( result.error ) {\n\t\t\t\t\tTAlertManager.showAlert( $.i18n._( result.error ) );\n\t\t\t\t}\n\t\t\t\telse if ( result ) {\n\t\t\t\t\tauthenticate_callback( null, result.session_id );\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.catch( ( error ) => Debug.Text( 'Webauthn login failure.', 'TTWebauthn.js', 'TTWebauthn', 'loginUser', 10 ) );\n\t}\n\n\tloginUserNameLess( authenticate_callback ) {\n\t\tthis.login( {} )\n\t\t\t.then( ( result ) => {\n\t\t\t\tDebug.Text( 'Webauthn login success.', 'TTWebauthn.js', 'TTWebauthn', 'loginUserNameLess', 10 );\n\t\t\t\tif ( result ) {\n\t\t\t\t\tauthenticate_callback( null, result.session_id );\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.catch( ( error ) => Debug.Text( 'Webauthn login failure.', 'TTWebauthn.js', 'TTWebauthn', 'loginUserNameLess', 10 ) );\n\t}\n\n\tregister = useRegistration( {\n\t\tactionUrl: Global.getBaseURL( '../../', false ) + '/api/webauthn/api.php?action=register',\n\t\toptionsUrl: Global.getBaseURL( '../../', false ) + '/api/webauthn/api.php?action=register_options',\n\t} );\n\n\tlogin = useLogin( {\n\t\tactionUrl: Global.getBaseURL( '../../', false ) + '/api/webauthn/api.php?action=login',\n\t\toptionsUrl: Global.getBaseURL( '../../', false ) + '/api/webauthn/api.php?action=login_options',\n\t} );\n}\n\nexport const TTWebauthnObj = new TTWebauthn();","class TTSAML {\n\tloginUser( user_name, url, new_window = false ) {\n\t\tDebug.Text( 'SAML Login Request', 'TTSAML.js', 'TTSAML', 'loginUser', 11 );\n\t\tif ( new_window ) {\n\t\t\twindow.open( url, '_blank' );\n\t\t} else {\n\t\t\twindow.location.href = url;\n\t\t}\n\t}\n\n\tlogoutUser( user_name, url, new_window = false ) {\n\t\tDebug.Text( 'SAML Logout Request', 'TTSAML.js', 'TTSAML', 'logoutUser', 11 );\n\t\tif ( new_window ) {\n\t\t\twindow.open( url, '_blank' );\n\t\t} else {\n\t\t\twindow.location.href = url;\n\t\t}\n\t}\n}\n\nexport const TTSAMLObj = new TTSAML();","import { TTBackboneView } from '@/views/TTBackboneView';\nimport TTEventBus from '@/services/TTEventBus';\n\nclass ApplicationRouter extends Backbone.Router {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tcontroller: null,\n\n\t\t\troutes: {\n\t\t\t\t'': 'onViewChange',\n\t\t\t\t'!:viewName': 'onViewChange',\n\t\t\t\t'*notFound': 'notFound'\n\t\t\t}\n\t\t} );\n\n\t\tsuper( options );\n\t\tthis.event_bus = new TTEventBus({ view_id: 'index_controller' });\n\t}\n\n\treloadView( view_id ) {\n\t\t//error: Uncaught ReferenceError: XXXXViewController is not defined ininterface/html5/#!m=TimeSheet line 3\n\t\t// Happens when quickly click on context menu and network is slow.\n\t\tif ( typeof window[view_id + 'ViewController'] === 'function' &&\n\t\t\tLocalCacheData.current_open_primary_controller &&\n\t\t\tLocalCacheData.current_open_primary_controller.viewId === view_id ) {\n\t\t\tLocalCacheData.current_open_primary_controller.setSelectLayout();\n\t\t\tLocalCacheData.current_open_primary_controller.search();\n\t\t}\n\t}\n\n\tnotFound( url ) {\n\n\t\tvar new_url = Global.getBaseURL();\n\n\t\tGlobal.setURLToBrowser( new_url + '#!m=Login' );\n\t}\n\n\t/* jshint ignore:start */\n\tonViewChange( viewName ) {\n\t\tvar $this = this;\n\t\tvar args = {};\n\t\tvar view_id;\n\t\tvar edit_id;\n\t\tvar action;\n\t\tvar auto_login_timer;\n\n\t\tif ( Global.needReloadBrowser ) {\n\t\t\tGlobal.needReloadBrowser = false;\n\t\t\twindow.location.reload();\n\t\t\treturn;\n\t\t}\n\n\t\tif ( viewName ) {\n\t\t\targs = Global.buildArgDic( viewName.split( '&' ) );\n\t\t}\n\t\tif ( viewName && viewName.indexOf( 'm=' ) >= 0 ) {\n\t\t\tview_id = Global.sanitizeViewId( args.m );\n\t\t} else {\n\t\t\tview_id = 'Login';\n\t\t}\n\n\t\t// #VueContextMenu# Trigger Vue Router changes\n\t\t// Add interface functions for this once POC works.\n\t\t// console.log('aaaa onViewChange', view_id); // comparing triggers against BaseVC.\n\t\t// VueRouter.push('/view/'+view_id);\n\t\t// End Vue router\n\n\t\tLocalCacheData.fullUrlParameterStr = viewName;\n\t\tLocalCacheData.setAllURLArgs( args );\n\n\t\tif ( view_id == 'Install' ) {\n\t\t\tif ( LocalCacheData.loadViewRequiredJSReady ) {\n\t\t\t\tIndexViewController.openWizard( 'InstallWizard', null, function() {\n\t\t\t\t\t// need to link to the login interface.\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tauto_login_timer = setInterval( function() {\n\t\t\t\t\tif ( timeout_count == 100 ) {\n\t\t\t\t\t\tclearInterval( auto_login_timer );\n\t\t\t\t\t}\n\t\t\t\t\ttimeout_count = timeout_count + 1;\n\t\t\t\t\tif ( LocalCacheData.loadViewRequiredJSReady ) {\n\t\t\t\t\t\tIndexViewController.openWizard( 'InstallWizard', null, function() {\n\t\t\t\t\t\t\t// need to link to the login interface.\n\t\t\t\t\t\t} );\n\t\t\t\t\t\tclearInterval( auto_login_timer );\n\t\t\t\t\t}\n\t\t\t\t}, 600 );\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif ( LocalCacheData.getAllURLArgs().sm === 'ResetPassword' && LocalCacheData.getAllURLArgs().key ) {\n\t\t\tIndexViewController.openWizard( 'ResetForgotPasswordWizard', null, function() {\n\t\t\t\tLocalCacheData.setAllURLArgs( _.omit( LocalCacheData.getAllURLArgs(), 'sm' ) );\n\t\t\t\tLocalCacheData.setAllURLArgs( _.omit( LocalCacheData.getAllURLArgs(), 'key' ) );\n\t\t\t\tTAlertManager.showAlert( $.i18n._( 'Password has been changed successfully, you may now login.' ) );\n\t\t\t\tvar new_url = Global.getBaseURL();\n\t\t\t\tGlobal.setURLToBrowser( new_url + '#!m=Login' );\n\t\t\t\treturn;\n\t\t\t} );\n\t\t\treturn;\n\t\t}\n\n\t\tedit_id = args.id; //Accrual id is combined. x_x -- Also need to support UUID.\n\t\taction = args.a;\n\n\t\tif ( LocalCacheData.current_open_view_id === view_id ) {\n\n\t\t\tif ( LocalCacheData.current_open_primary_controller ) {\n\n\t\t\t\tif ( action ) {\n\t\t\t\t\tswitch ( action ) {\n\t\t\t\t\t\tcase 'edit':\n\t\t\t\t\t\t\t//Error: Unable to get property 'id' of undefined or null reference in /interface/html5/IndexController.js?v=8.0.0-20141230-125406 line 87\n\t\t\t\t\t\t\tif ( typeof LocalCacheData.current_open_primary_controller != 'undefined' && ( !LocalCacheData.current_open_primary_controller.edit_view || ( LocalCacheData.current_open_primary_controller.current_edit_record && LocalCacheData.current_open_primary_controller.current_edit_record.id && LocalCacheData.current_open_primary_controller.current_edit_record.id != edit_id ) ) ) {\n\t\t\t\t\t\t\t\t//Makes ure when doing copy_as_new, don't open this\n\t\t\t\t\t\t\t\tif ( LocalCacheData.current_doing_context_action === 'edit' ) {\n\t\t\t\t\t\t\t\t\topenEditView( edit_id );\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'new':\n\t\t\t\t\t\t\tif ( !LocalCacheData.current_open_primary_controller.edit_view ) {\n\t\t\t\t\t\t\t\topenEditView();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'view':\n\t\t\t\t\t\t\tswitch ( view_id ) {\n\t\t\t\t\t\t\t\tcase 'MessageControl':\n\t\t\t\t\t\t\t\t\tif ( args.t === 'message' ) {\n\t\t\t\t\t\t\t\t\t\tif ( !LocalCacheData.current_open_primary_controller.edit_view ||\n\t\t\t\t\t\t\t\t\t\t\t( !checkIds() ) ) {\n\t\t\t\t\t\t\t\t\t\t\topenEditView( edit_id, true );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else if ( args.t === 'request' ) {\n\t\t\t\t\t\t\t\t\t\tif ( !LocalCacheData.current_open_primary_controller.edit_view ||\n\t\t\t\t\t\t\t\t\t\t\t( LocalCacheData.current_open_primary_controller.current_select_message_control_data.id != edit_id ) ) {\n\t\t\t\t\t\t\t\t\t\t\topenEditView( edit_id, true );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t// Error: Unable to get property 'id' of undefined or null reference\n\t\t\t\t\t\t\t\t\tif ( typeof LocalCacheData.current_open_primary_controller != 'undefined' && ( !LocalCacheData.current_open_primary_controller.edit_view || ( LocalCacheData.current_open_primary_controller.current_edit_record && LocalCacheData.current_open_primary_controller.current_edit_record.id && LocalCacheData.current_open_primary_controller.current_edit_record.id != edit_id ) ) ) {\n\t\t\t\t\t\t\t\t\t\topenEditView( edit_id, true );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\t\t\t\t} else {\n\t\t\t\t\tif ( view_id === 'Login' ) {\n\t\t\t\t\t\t$this.event_bus.emit( 'tt_login', 'step_changed' ); //Notify login view to change step when browser back button is clicked.\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( LocalCacheData.current_open_primary_controller.edit_view &&\n\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.current_edit_record ) {\n\n\t\t\t\t\t\tif ( LocalCacheData.current_open_primary_controller.is_mass_editing ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.buildContextMenu( true );\n\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.removeEditView();\n\t\t\t\t\t\tthis.cleanAnySubViewUI();\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t\treturn;\n\n\t\t} else {\n\t\t\tLocalCacheData.edit_id_for_next_open_view = edit_id;\n\n\t\t\tif ( action ) {\n\t\t\t\tLocalCacheData.current_doing_context_action = action;\n\t\t\t}\n\t\t}\n\n\t\tGlobal.setDeepLink();\n\t\tvar timeout_count;\n\t\tif ( view_id !== 'Login' && !LocalCacheData.getLoginUser() ) {\n\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + '#!m=Login' );\n\t\t\treturn;\n\t\t} else {\n\t\t\ttimeout_count = 0;\n\t\t\tif ( view_id !== 'Login' && Global.isSet( view_id ) ) {\n\t\t\t\tif ( LocalCacheData.loadViewRequiredJSReady ) {\n\t\t\t\t\tinitRibbonMenuAndCopyRight();\n\t\t\t\t} else {\n\t\t\t\t\tauto_login_timer = setInterval( function() {\n\t\t\t\t\t\tif ( timeout_count == 100 ) {\n\t\t\t\t\t\t\tclearInterval( auto_login_timer );\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttimeout_count = timeout_count + 1;\n\t\t\t\t\t\tif ( LocalCacheData.loadViewRequiredJSReady ) {\n\t\t\t\t\t\t\tinitRibbonMenuAndCopyRight();\n\t\t\t\t\t\t\tclearInterval( auto_login_timer );\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 600 );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tshowRibbonMenuAndLoadView();\n\t\t\t}\n\n\t\t}\n\n\t\tfunction showRibbonMenuAndLoadView() {\n\n\t\t\tif ( view_id && view_id !== 'Login' ) {\n\t\t\t\t$this.event_bus.emit( 'tt_topbar', 'refresh_login_data' ); // Update the topbar company and logged in user.\n\t\t\t\t$this.setContentDivHeight();\n\t\t\t}\n\n\t\t\t if ( view_id && view_id !== 'Login' ) {\n\t\t\t\t$( 'body' ).removeClass( 'login-bg' );\n\t\t\t\t$( 'body' ).addClass( 'application-bg' );\n\t\t\t}\n\n\t\t\tswitch ( view_id ) {\n\t\t\t\tcase 'JobApplication':\n\t\t\t\t\t// require( ['autolinker/Autolinker.min', 'pdfjs-dist/build/pdf', 'pdfjs/compatibility', 'pdfjs/ui_utils', 'pdfjs/text_layer_builder'], function( autolinker ) {\n\t\t\t\t\t// \twindow.Autolinker = autolinker;\n\t\t\t\t\t\tGlobal.loadViewSource( view_id, view_id + 'ViewController.js', function() {\n\t\t\t\t\t\t\tvar permission_id = view_id;\n\t\t\t\t\t\t\tif ( PermissionManager.checkTopLevelPermission( permission_id ) ) {\n\t\t\t\t\t\t\t\tBaseViewController.loadView( view_id );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tTAlertManager.showAlert( 'Permission denied', 'ERROR', function() {\n\t\t\t\t\t\t\t\t\tif ( LocalCacheData.getLoginUserPreference() && LocalCacheData.getLoginUserPreference().default_login_screen ) {\n\t\t\t\t\t\t\t\t\t\tMenuManager.goToView( LocalCacheData.getLoginUserPreference().default_login_screen );\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tMenuManager.goToView( 'Home' );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\tDebug.Text( 'Navigation permission denied. Permission: ' + permission_id, 'IndexController.js', 'IndexController', 'showRibbonMenuAndLoadView', 10 );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t// } );\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tGlobal.loadViewSource( view_id, view_id + 'ViewController.js', function() {\n\t\t\t\t\t\tvar permission_id = view_id;\n\n\t\t\t\t\t\tswitch ( view_id ) {\n\t\t\t\t\t\t\tcase 'ClientGroup':\n\t\t\t\t\t\t\t\tpermission_id = 'Client';\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'ProductGroup':\n\t\t\t\t\t\t\t\tpermission_id = 'Product';\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'PayStubTransactionSummaryReport':\n\t\t\t\t\t\t\tcase 'PayStubTransaction':\n\t\t\t\t\t\t\t\tpermission_id = 'PayStub';\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( view_id === 'Login' || view_id === 'Home' || PermissionManager.checkTopLevelPermission( permission_id ) ) {\n\t\t\t\t\t\t\tBaseViewController.loadView( view_id );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif ( LocalCacheData.current_open_primary_controller && LocalCacheData.current_open_primary_controller.viewId && LocalCacheData.current_open_primary_controller.viewId == 'LoginView' ) {\n\t\t\t\t\t\t\t\tif ( LocalCacheData.getLoginUserPreference() && LocalCacheData.getLoginUserPreference().default_login_screen ) {\n\t\t\t\t\t\t\t\t\tMenuManager.goToView( LocalCacheData.getLoginUserPreference().default_login_screen );\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tMenuManager.goToView( 'Home' );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tTAlertManager.showAlert( 'Permission denied', 'ERROR', function() {\n\t\t\t\t\t\t\t\t\tif ( LocalCacheData.getLoginUserPreference() && LocalCacheData.getLoginUserPreference().default_login_screen ) {\n\t\t\t\t\t\t\t\t\t\tMenuManager.goToView( LocalCacheData.getLoginUserPreference().default_login_screen );\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tMenuManager.goToView( 'Home' );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tDebug.Text( 'Navigation permission denied. Permission: ' + permission_id, 'IndexController.js', 'IndexController', 'showRibbonMenuAndLoadView', 10 );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t\tfunction initRibbonMenuAndCopyRight() {\n\n\t\t\t// Trigger Vue TopMenu to load, now that all pre-requisitives like login info have been run.\n\t\t\t$this.event_bus.emit( 'tt_top_container', 'ready_to_load_top_bar' );\n\n\t\t\t//Add copy right\n\t\t\tGlobal.bottomContainer().css( 'display', 'block' );\n\n\t\t\t//Start check signal\n\t\t\tGlobal.setSignalStrength();\n\n\t\t\t//Add feedback event\n\t\t\tGlobal.bottomFeedbackLinkContainer().css( 'display', 'block' );\n\t\t\t$( '#feedback-link' ).off( 'click.feedback' ).on( 'click.feedback', function() {\n\t\t\t\t$().TFeedback( {\n\t\t\t\t\tsource: 'ManualTrigger',\n\t\t\t\t\tmanual_trigger: true,\n\t\t\t\t\tprompt_for_feedback: true // regardless of server feedback state input, click should always allow feedback\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\t$( '#copy_right_info_1' ).css( 'display', 'inline' );\n\t\t\t$( '#copy_right_logo_link' ).attr( 'href', 'https://' + LocalCacheData.getLoginData().organization_url );\n\t\t\tif ( !$( '#copy_right_logo' ).attr( 'src' ) ) {\n\t\t\t\t$( '#copy_right_logo' ).attr( 'src', ServiceCaller.getURLByObjectType( 'copyright' ) ); // Use the same logo as the one on the login screen. (Changed from smcopyright)\n\t\t\t}\n\t\t\tshowRibbonMenuAndLoadView();\n\t\t}\n\n\t\tfunction checkIds() {\n\n\t\t\tif ( Global.isArray( LocalCacheData.current_open_primary_controller.current_edit_record ) ) {\n\t\t\t\tfor ( var i = 0; i < LocalCacheData.current_open_primary_controller.current_edit_record.length; i++ ) {\n\t\t\t\t\tvar item = LocalCacheData.current_open_primary_controller.current_edit_record[i];\n\n\t\t\t\t\tif ( item.id && item.id === edit_id ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\titem = LocalCacheData.current_open_primary_controller.current_edit_record;\n\t\t\t\tif ( item.id && item.id === edit_id ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction openEditView( edit_id, view_mode ) {\n\t\t\tvar type;\n\t\t\tswitch ( view_id ) {\n\t\t\t\tcase 'MessageControl':\n\t\t\t\t\ttype = args.t;\n\t\t\t\t\tvar item = {};\n\t\t\t\t\tif ( type === 'message' ) {\n\t\t\t\t\t\titem.id = edit_id;\n\t\t\t\t\t} else {\n\t\t\t\t\t\titem.object_id = edit_id;\n\t\t\t\t\t\titem.object_type_id = 50;\n\t\t\t\t\t}\n\t\t\t\t\tLocalCacheData.current_open_primary_controller.onViewClick( item );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'TimeSheet':\n\t\t\t\t\ttype = args.t;\n\n\t\t\t\t\tif ( !view_mode ) {\n\t\t\t\t\t\tif ( edit_id ) {\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.onEditClick( edit_id, type );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.onAddClick();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( edit_id ) {\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.onViewClick( edit_id, type );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\n\t\t\t\t\tif ( !view_mode ) {\n\t\t\t\t\t\tif ( edit_id ) {\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.onEditClick( edit_id );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.onAddClick();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( edit_id ) {\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.onViewClick( edit_id );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/* jshint ignore:end */\n\n\tcleanAnySubViewUI() {\n\t\tvar children = Global.contentContainer().children();\n\n\t\tif ( children.length > 1 ) {\n\t\t\tfor ( var i = 1; i < children.length; i++ ) {\n\t\t\t\t// Object doesn't support property or method 'remove', Not sure why, add try catch to ingore this error since this should no harm\n\t\t\t\ttry {\n\n\t\t\t\t\tif ( $( children[i] ).attr( 'id' ) === LocalCacheData.current_open_primary_controller.ui_id ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tchildren[i].remove();\n\t\t\t\t\t}\n\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\t//Do nothing\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t}\n\n\tsetContentDivHeight() {\n\t\t// Now done by CSS calculation\n\t\t// Global.contentContainer().css( 'height', ( Global.bodyHeight() - Global.topContainer().height() - $('.topbar').height() ) ); // TODO: do away with these hardcoded calculated heights in future refactor.\n\t\t// $( window ).resize( function() {\n\t\t// \tGlobal.contentContainer().css( 'height', ( Global.bodyHeight() - Global.topContainer().height() - $('.topbar').height()) ); // TODO: do away with these hardcoded calculated heights in future refactor.\n\t\t// } );\n\n\t\tGlobal.contentContainer().removeClass( 'content-container' );\n\t\tGlobal.contentContainer().addClass( 'content-container-after-login' );\n\t}\n\n\tremoveCurrentView( callBack ) {\n\n\t\tif ( LocalCacheData.current_open_edit_only_controller ) {\n\t\t\tclean( LocalCacheData.current_open_edit_only_controller );\n\t\t\tLocalCacheData.current_open_edit_only_controller = null;\n\t\t}\n\n\t\tif ( LocalCacheData.current_open_primary_controller ) {\n\t\t\tif ( LocalCacheData.current_open_primary_controller.edit_view ) {\n\t\t\t\tclean( LocalCacheData.current_open_primary_controller );\n\t\t\t}\n\t\t\tLocalCacheData.current_open_primary_controller.unmountContextMenu();\n\t\t\tGlobal.contentContainer().children().detach().remove(); // This is about 3x faster than Global.contentContainer().empty()\n\t\t\tLocalCacheData.current_open_primary_controller.cleanWhenUnloadView( callBack );\n\t\t} else {\n\n\t\t\tif ( Global.isSet( callBack ) ) {\n\t\t\t\tcallBack();\n\t\t\t}\n\t\t}\n\n\t\tfunction clean( viewController ) {\n\t\t\tviewController.clearErrorTips();\n\t\t\t// Cannot read property 'remove' of null in interface/html5/IndexController.js?v=9.0.0-20151016-153057 line 439\n\t\t\tif ( viewController.edit_view ) {\n\t\t\t\t// #question: Not sure when this would be trigged, but this should surely run through viewController.removeEditView()?\n\t\t\t\tviewController.unmountContextMenu(); // Not sure when this clean would be trigged, but lets have this here just in case.\n\t\t\t\tviewController.edit_view.remove();\n\t\t\t}\n\t\t\tviewController.sub_log_view_controller = null;\n\t\t\tviewController.edit_view_ui_dic = {};\n\t\t\tviewController.edit_view_ui_validation_field_dic = {};\n\t\t\tviewController.edit_view_form_item_dic = {};\n\t\t\tviewController.edit_view_error_ui_dic = {};\n\t\t\tLocalCacheData.current_doing_context_action = '';\n\t\t}\n\t}\n\n}\n\nexport class IndexViewController extends TTBackboneView {\n\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: 'body', //So we can add event listener for all elements\n\t\t\trouter: null,\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( options ) {\n\n\t\tsuper.initialize( options );\n\t\tthis.router = new ApplicationRouter();\n\n\t\t//Set title in index.php instead.\n\t\t//$( 'title' ).html( '' );\n\n\t\tthis.router.controller = this;\n\t\t//Error: Backbone.history has already been started in interface/html5/framework/backbone/backbone-min.js?v=9.0.1-20151022-162110 line 28\n\t\tif ( !Backbone.History.started ) {\n\t\t\tBackbone.history.start();\n\t\t}\n\n\t\tIndexViewController.instance = this;\n\n\t}\n\n\tstatic goToView( view_name, filter ) {\n\t\tGlobal.closeEditViews( function() {\n\t\t\tLocalCacheData.default_filter_for_next_open_view = filter;\n\t\t\tMenuManager.goToView( view_name, true );\n\t\t} );\n\n\t}\n\n\tstatic goToViewByViewLabel( view_label ) {\n\t\tvar view_name;\n\t\tswitch ( view_label ) {\n\t\t\tcase 'Exceptions':\n\t\t\t\tview_name = 'Exception';\n\t\t\t\tbreak;\n\t\t\tcase 'Messages':\n\t\t\t\tview_name = 'MessageControl';\n\t\t\t\tbreak;\n\t\t\tcase 'Requests':\n\t\t\t\tview_name = 'Request';\n\t\t\t\tbreak;\n\t\t\tcase 'Contact Information':\n\t\t\t\tIndexViewController.openEditView( LocalCacheData.current_open_primary_controller, 'LoginUserContact' );\n\t\t\t\treturn;\n\t\t\tcase 'InOut':\n\t\t\t\tIndexViewController.openEditView( LocalCacheData.current_open_primary_controller, 'InOut' );\n\t\t\t\treturn;\n\t\t\tdefault:\n\t\t\t\tvar reg = /\\s/g;\n\t\t\t\tview_name = view_label.replace( reg, '' );\n\t\t\t\tbreak;\n\t\t}\n\n\t\tMenuManager.goToView( view_name, true );\n\n\t}\n\n\t//DEPRECATED: all new wizards should go through openWizardController()\n\tstatic openWizard( wizardName, defaultData, callBack ) {\n\t\tGlobal.setUINotready();\n\n\t\tBaseWizardController.default_data = defaultData;\n\t\tBaseWizardController.call_back = callBack;\n\n\t\tswitch ( wizardName ) {\n\t\t\tdefault:\n\t\t\t\t// track edit view only view\n\t\t\t\tGlobal.trackView( wizardName );\n\t\t\t\tGlobal.loadViewSource( wizardName, wizardName + 'Controller.js', function() {\n\t\t\t\t\tBaseWizardController.openWizard( wizardName, wizardName + '.html' );\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t}\n\n\t}\n\n\t//ATTN: New wizards should go through this\n\tstatic openWizardController( wizard_id, filter_data, source_view ) {\n\t\tGlobal.setUINotready();\n\t\t// BaseWizardController.default_data = defaultData;\n\t\t// BaseWizardController.call_back = callBack;\n\t\tswitch ( wizard_id ) {\n\t\t\tdefault:\n\t\t\t\t// track edit view only view\n\t\t\t\tGlobal.trackView( wizard_id );\n\t\t\t\tGlobal.loadViewSource( wizard_id, wizard_id + '.js', function() {\n\n\t\t\t\t\tif ( LocalCacheData.current_open_wizard_controllers.some( wizard => wizard.wizard_id === wizard_id ) ) {\n\t\t\t\t\t\tswitch ( wizard_id ) {\n\t\t\t\t\t\t\tcase 'ReportViewWizard':\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'PayrollRemittanceAgencyEventWizardController':\n\t\t\t\t\t\t\t\t//if the current wizard is a PayrollRemittanceAgencyEventWizard, we need to remember the cards that were clicked because it's just minimized.\n\t\t\t\t\t\t\t\tvar wizard = LocalCacheData.current_open_wizard_controllers.find( wizard => wizard.wizard_id === wizard_id );\n\t\t\t\t\t\t\t\twizard.remove(); // #2768 Removes the existing wizard DOM element if it exists, to avoid duplicate wizards. Causes issue when user double clicks on Wizard icon (without overlay) or Tax Wizard opened when already open. TODO: Add overlay to prevent background clicks.\n\t\t\t\t\t\t\t\twizard.getStepObject().initialize( wizard );\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tvar wizard = LocalCacheData.current_open_wizard_controllers.find( wizard => wizard.wizard_id === wizard_id );\n\t\t\t\t\t\t\t\twizard.onCloseClick();\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tGlobal.loadViewSource( wizard_id, wizard_id + '.html', function( result ) {\n\t\t\t\t\t\tvar args = {};\n\t\t\t\t\t\tvar template = _.template( result );\n\t\t\t\t\t\t$( 'body' ).append( template( args ) );\n\n\t\t\t\t\t\t//#2422 - pass the data on to the process transactions wizard\n\t\t\t\t\t\t// This must be here because we don't instantiate the WizardController ( the host view ) in the html file like we do with other views so that we can pass it constructor arguments\n\t\t\t\t\t\tswitch ( wizard_id ) {\n\t\t\t\t\t\t\tcase 'ProcessTransactionsWizardController':\n\t\t\t\t\t\t\t\tnew ProcessTransactionsWizardController( filter_data );\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tGlobal.setUIInitComplete();\n\t\t\t\t\t} );\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t}\n\n\t}\n\n\tstatic openReport( parent_view_controller, view_name, id, tab_name ) {\n\t\t// Note: This behaviour/router call is also in BaseViewController.loadView()\n\t\t// VueRouter.push({\n\t\t// \tname: 'report',\n\t\t// \tparams: {\n\t\t// \t\tviewId: view_name\n\t\t// \t}\n\t\t// }).then(function() {\n\t\t// \tdoNextAfterReportRouteChange();\n\t\t// });\n\t\tdoNextAfterReportRouteChange(); // Now using one global context menu, so no need for router calls. Just using the one single LegacyView for now.\n\n\t\tfunction doNextAfterReportRouteChange() {\n\t\t\tGlobal.closeEditViews( function() {\n\t\t\t\tif ( LocalCacheData.current_open_report_controller ) {\n\t\t\t\t\tLocalCacheData.current_open_report_controller.removeEditView();\n\t\t\t\t}\n\n\t\t\t\tProgressBar.showOverlay();\n\n\t\t\t\tswitch ( view_name ) {\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tvar path = Global.getViewPathByViewId( view_name );\n\t\t\t\t\t\tif ( path ) {\n\t\t\t\t\t\t\tGlobal.loadScript( path + view_name + 'ViewController', function() {\n\t\t\t\t\t\t\t\tDebug.Text( 'R-LOADING: ' + view_name, 'IndexViewController.js', 'IndexViewController', 'openReport', 10 );\n\t\t\t\t\t\t\t\t/* jshint ignore:start */\n\t\t\t\t\t\t\t\tTTPromise.add( 'Reports', 'openReport' );\n\t\t\t\t\t\t\t\t//var $view_controller = eval( 'new ' + view_name + 'ViewController( {edit_only_mode: true} ); ' );\n\t\t\t\t\t\t\t\tvar $view_controller = new window[view_name + 'ViewController']({ edit_only_mode: true });\n\t\t\t\t\t\t\t\t/* jshint ignore:end */\n\n\t\t\t\t\t\t\t\tTTPromise.wait( 'Reports', 'openReport', function() {\n\t\t\t\t\t\t\t\t\tdoNext( view_name, tab_name );\n\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t\tfunction doNext( view_name, tab_name ) {\n\t\t\t\t\t\t\t\t\t$view_controller.parent_view_controller = parent_view_controller;\n\t\t\t\t\t\t\t\t\t$view_controller.openEditView();\n\n\t\t\t\t\t\t\t\t\tvar current_url = window.location.href;\n\t\t\t\t\t\t\t\t\tif ( current_url.indexOf( '&sm' ) > 0 ) {\n\t\t\t\t\t\t\t\t\t\tcurrent_url = current_url.substring( 0, current_url.indexOf( '&sm' ) );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcurrent_url = current_url + '&sm=' + view_name;\n\n\t\t\t\t\t\t\t\t\tif ( LocalCacheData.default_edit_id_for_next_open_edit_view ) {\n\t\t\t\t\t\t\t\t\t\tcurrent_url = current_url + '&sid=' + LocalCacheData.default_edit_id_for_next_open_edit_view;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif ( typeof tab_name != 'undefined' ) {\n\t\t\t\t\t\t\t\t\t\tLocalCacheData.current_open_report_controller.selected_tab = tab_name;\n\t\t\t\t\t\t\t\t\t\tcurrent_url += '&tab=' + tab_name;\n\t\t\t\t\t\t\t\t\t} else if ( window.location.href.indexOf( '&tab=' ) > -1 ) {\n\t\t\t\t\t\t\t\t\t\tvar tab_name = window.location.href;\n\t\t\t\t\t\t\t\t\t\ttab_name = tab_name.substr( ( window.location.href.indexOf( '&tab=' ) + 5 ) ); //get the selected tab name\n\t\t\t\t\t\t\t\t\t\ttab_name = tab_name.substr( 0, window.location.href.indexOf( '&' ) ); // incase there are subsequent arguments after the tab argument\n\t\t\t\t\t\t\t\t\t\tcurrent_url += '&tab=' + tab_name;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tGlobal.setURLToBrowser( current_url );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.debug( 'Report View does not exist! View Name: ' + view_name );\n\t\t\t\t\t\t\tif ( ServiceCaller.root_url && APIGlobal.pre_login_data.base_url ) {\n\t\t\t\t\t\t\t\tGlobal.setURLToBrowser( ServiceCaller.root_url + APIGlobal.pre_login_data.base_url );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\t//Open edit view\n\tstatic openEditView( parent_view_controller, view_name, id, action_function ) {\n\t\tif ( LocalCacheData.current_open_report_controller ) { //don't allow editviews over report views.\n\t\t\tLocalCacheData.current_open_report_controller.onCancelClick( null, null, function() {\n\t\t\t\tGlobal.closeEditViews( function() {\n\t\t\t\t\tIndexViewController.openEditView( parent_view_controller, view_name, id, action_function );\n\t\t\t\t} );\n\t\t\t} );\n\t\t\treturn;\n\t\t} else if ( LocalCacheData.current_open_edit_only_controller && LocalCacheData.current_open_edit_only_controller.viewId && LocalCacheData.current_open_edit_only_controller.viewId == view_name ) { //Stop edit only views from overlaying themselves with the same view and disconnecting others from the menu\n\t\t\tLocalCacheData.current_open_edit_only_controller.setEditMenu(); //display the right edit menu\n\t\t\t$( '#ribbon_view_container .context-menu:visible a' ).click();\n\t\t} else {\n\t\t\tdoNext();\n\t\t}\n\n\t\tfunction doNext() {\n\t\t\tvar view_controller = null;\n\n\t\t\tif ( !PermissionManager.checkTopLevelPermission( view_name ) && view_name !== 'Map' ) {\n\t\t\t\tif ( LocalCacheData.current_open_primary_controller && LocalCacheData.current_open_primary_controller.viewId && LocalCacheData.current_open_primary_controller.viewId == 'LoginView' ) {\n\t\t\t\t\tif ( LocalCacheData.getLoginUserPreference() && LocalCacheData.getLoginUserPreference().default_login_screen ) {\n\t\t\t\t\t\tMenuManager.goToView( LocalCacheData.getLoginUserPreference().default_login_screen );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tMenuManager.goToView( 'Home' );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tTAlertManager.showAlert( 'Permission denied', 'ERROR', function() {\n\t\t\t\t\t\tif ( LocalCacheData.getLoginUserPreference() && LocalCacheData.getLoginUserPreference().default_login_screen ) {\n\t\t\t\t\t\t\tMenuManager.goToView( LocalCacheData.getLoginUserPreference().default_login_screen );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tMenuManager.goToView( 'Home' );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tDebug.Text( 'Navigation permission denied. View: ' + view_name, 'IndexController.js', 'IndexController', 'openEditView', 10 );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( view_name == 'Request' ) {\n\t\t\t\taction_function = 'openAddView';\n\t\t\t}\n\n\t\t\tif ( !action_function ) {\n\t\t\t\taction_function = 'openEditView';\n\t\t\t}\n\n\t\t\t// Added originally in 83a1df72 for issue #1805 but caused a bug mentioned in issue #2091 the steps to reproduce the bug are as follows:\n\t\t\t// 1. Go to invoice > client contacts and highlite a Client Contact 2. Click the \"Edit Client\" button on the ribbon menu\n\t\t\t// 3. Click the Invoices tab 4. Edit an invoice 5. Click Payment on the ribbon menu 6. Click Cancel to bring you back to the invoice edit scren, then Cancel again to go back to the Invoices tab on the client screen.\n\t\t\t// 7. You won't be back there. The Client screen will be missing.\n\t\t\t//if ( LocalCacheData.current_open_edit_only_controller ) {\n\t\t\t//LocalCacheData.current_open_edit_only_controller.onCancelClick();\n\t\t\t//}\n\n\t\t\t// track edit view only view\n\t\t\tGlobal.trackView( view_name );\n\n\t\t\tGlobal.loadViewSource( view_name, view_name + 'ViewController.js', function() {\n\t\t\t\t/* jshint ignore:start */\n\t\t\t\t//view_controller = eval( 'new ' + view_name + 'ViewController( {edit_only_mode: true} ); ' );\n\t\t\t\tvar view_controller = new window[view_name + 'ViewController']({ edit_only_mode: true });\n\t\t\t\t/* jshint ignore:end */\n\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'initialize', function() {\n\t\t\t\t\tview_controller.parent_view_controller = parent_view_controller;\n\n\t\t\t\t\tview_controller[action_function]( id );\n\t\t\t\t\tif ( TTUUID.isUUID( id ) ) {\n\t\t\t\t\t\tvar current_url = window.location.href;\n\t\t\t\t\t\tif ( current_url.indexOf( '&sm' ) > 0 ) {\n\t\t\t\t\t\t\tcurrent_url = current_url.substring( 0, current_url.indexOf( '&sm' ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( id && _.isString( id ) ) {\n\t\t\t\t\t\t\tcurrent_url = current_url + '&sm=' + view_name + '&sid=' + id;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrent_url = current_url + '&sm=' + view_name;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tGlobal.setURLToBrowser( current_url );\n\t\t\t\t\t}\n\n\t\t\t\t\tLocalCacheData.current_open_edit_only_controller = view_controller;\n\t\t\t\t} );\n\t\t\t} );\n\t\t}\n\t}\n\n\tstatic initializeNotifications( target ) {\n\t\tNotificationConsumer.setupUser( true, false );\n\t\tNotificationConsumer.getSystemNotifications( target );\n\t}\n\n\tstatic testInternetConnection() {\n\t\tif ( !navigator.onLine ) {\n\t\t\twindow.internet_connection_available = false;\n\t\t\twindow.is_testing_internet_connection = false;\n\t\t}\n\n\t\tvar img = new Image();\n\t\twindow.is_testing_internet_connection = true;\n\t\timg.onload = function() {\n\t\t\twindow.internet_connection_available = true;\n\t\t\twindow.is_testing_internet_connection = false;\n\t\t};\n\t\timg.onerror = function( e ) {\n\t\t\twindow.internet_connection_available = false;\n\t\t\twindow.is_testing_internet_connection = false;\n\t\t};\n\t\timg.src = 'https://coreapi.timetrex.com/images/ping.gif';\n\t}\n}\nIndexViewController.instance = null;\n\n","export var TTPromise = {\n\tpromises: {},\n\n\tadd: function( category, key ) {\n\t\tif ( !this.promises[category] || !this.promises[category][key] || ( this.promises[category][key].state() != 'pending' ) ) {\n\t\t\tDebug.Text( 'Promise: add: ' + category + '|' + key, 'TTPromise.js', 'TTPromise.js', 'add', 11 );\n\t\t\tif ( typeof this.promises[category] == 'undefined' ) {\n\t\t\t\tthis.promises[category] = {};\n\t\t\t}\n\n\t\t\tthis.promises[category][key] = $.Deferred();\n\t\t\tthis.promises[category][key].extra_data = { category: category, key: key };\n\t\t} else {\n\t\t\tDebug.Text( 'Promise: already exists: ' + category + '|' + key, 'TTPromise.js', 'TTPromise.js', 'add', 11 );\n\t\t}\n\t},\n\n\tresolve: function( category, key ) {\n\t\tif ( this.promises && this.promises[category] && this.promises[category][key] ) {\n\t\t\tDebug.Text( 'Promise: resolved: ' + category + '|' + key, 'TTPromise.js', 'TTPromise.js', 'resolve', 11 );\n\t\t\tthis.promises[category][key].resolve( this.promises[category][key].extra_data );\n\t\t}\n\t},\n\n\treject: function( category, key ) {\n\t\tif ( this.promises && this.promises[category] && this.promises[category][key] ) {\n\t\t\tDebug.Text( 'Promise: rejected: ' + category + '|' + key, 'TTPromise.js', 'TTPromise.js', 'reject', 11 );\n\t\t\tthis.promises[category][key].reject( this.promises[category][key].extra_data );\n\t\t}\n\t},\n\n\t/**\n\t * Wait for all or specific category/key\n\t *\n\t * In the case of waiting on all promises, error_callback is triggered for each individual error (rejection), and success callback is called when all promises are resolved (either success or failure)\n\t * so when waiting for all promises, most times you don't want a failure callback because both \"success\" and \"failure\" can happen on the same wait.\n\t *\n\t * The function call should look like:\n\t *    TTPromise.wait(null,null,function(){\n\t *    \t//do stuff on success\n\t *    });\n\t *\n\t * @param category\n\t * @param key\n\t * @param success_callback\n\t * @param error_callback\n\t */\n\twait: function( category, key, success_callback, error_callback ) {\n\t\tDebug.Arr( arguments, 'Promise: wait(' + category + '|' + key + ').', 'TTPromise.js', 'TTPromise.js', 'wait', 11 );\n\t\tif ( typeof success_callback != 'function' ) {\n\t\t\tsuccess_callback = function() {\n\t\t\t\tGlobal.setUIInitComplete();\n\t\t\t\tDebug.Text( 'Promise: resolved with default callback.', 'TTPromise.js', 'TTPromise.js', 'wait', 11 );\n\t\t\t};\n\t\t}\n\n\t\tif ( typeof error_callback != 'function' ) {\n\t\t\terror_callback = function() {\n\t\t\t\tGlobal.setUIInitComplete();\n\t\t\t\tDebug.Text( 'Promise failed with default callback.', 'TTPromise.js', 'TTPromise.js', 'wait', 1 );\n\t\t\t};\n\t\t}\n\n\t\tif ( Object.keys( TTPromise.promises ).length > 0 ) {\n\t\t\tvar onComplete = function() {\n\t\t\t\tfor ( var i = 0; i < arguments.length; i++ ) {\n\t\t\t\t\t//numerically indexed arguments come back from Promise resolution arguments.\n\t\t\t\t\tvar obj = arguments[i];\n\n\t\t\t\t\tvar category = obj.category;\n\t\t\t\t\tvar key = obj.key;\n\t\t\t\t\tvar wait_category = obj.wait_arguments.category;\n\t\t\t\t\tvar wait_key = obj.wait_arguments.key;\n\n\t\t\t\t\tTTPromise.clearCompletedPromise( category, key );\n\t\t\t\t}\n\n\t\t\t\tif ( !wait_category || TTPromise.filterPromiseArray( wait_category, wait_key ).length == 0 ) {\n\t\t\t\t\tDebug.Text( 'Promise: success callback', 'TTPromise.js', 'TTPromise.js', 'wait', 11 );\n\t\t\t\t\tsuccess_callback( true );\n\t\t\t\t} else {\n\t\t\t\t\tDebug.Text( 'Promise: waiting again ' + category + '|' + key, 'TTPromise.js', 'TTPromise.js', 'wait', 11 );\n\t\t\t\t\tTTPromise.wait( category, key, success_callback, error_callback );\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t};\n\n\t\t\tvar onError = function() {\n\t\t\t\t//When one promise fails in a category, we need to call the error_callback if waiting on that category, and *never* call the success callback.\n\t\t\t\tDebug.Text( 'Promise: ERROR callback', 'TTPromise.js', 'TTPromise.js', 'wait', 11 );\n\t\t\t\tfor ( var i = 0; i < arguments.length; i++ ) {\n\t\t\t\t\t//numerically indexed arguments come back from Promise resolution arguments.\n\t\t\t\t\tvar obj = arguments[i];\n\n\t\t\t\t\tvar category = obj.category;\n\t\t\t\t\tvar key = obj.key;\n\t\t\t\t\tvar wait_category = obj.wait_arguments.category;\n\t\t\t\t\tvar wait_key = obj.wait_arguments.key;\n\n\t\t\t\t\tTTPromise.clearCompletedPromise( category, key );\n\t\t\t\t}\n\n\t\t\t\t//Different than success because we always want to call the error_callback immediately, as the category can never be success after a single error.\n\t\t\t\tif ( typeof error_callback != 'undefined' ) {\n\t\t\t\t\terror_callback( false );\n\t\t\t\t}\n\n\t\t\t\t//Don't wait again, as that will cause success/error callbacks to be triggered multiple times and could cause an infinite loop too.\n\t\t\t\t//TTPromise.wait( wait_category, wait_key, success_callback, error_callback );\n\t\t\t\treturn true;\n\t\t\t};\n\n\t\t\tvar pending_promises = this.filterPromiseArray( category, key );\n\t\t\t$.when.apply( $, pending_promises ).pipe( onComplete, onError );\n\n\t\t} else {\n\t\t\tsuccess_callback( true );\n\t\t}\n\t},\n\n\tfilterPromiseArray: function( category, key ) {\n\t\tvar retval = [];\n\t\tfor ( var c in this.promises ) {\n\t\t\tif ( !category || c == category ) {\n\n\t\t\t\t//Debug.Text('Promise: processing category: '+ c, 'TTPromise.js', 'TTPromise.js', 'pending_to_waiting', 11);\n\t\t\t\tfor ( var k in this.promises[c] ) {\n\t\t\t\t\tif ( !key || k == key ) {\n\t\t\t\t\t\t//Debug.Text('Promise: processing key: '+ c+'|'+k, 'TTPromise.js', 'TTPromise.js', 'pending_to_waiting', 11);\n\t\t\t\t\t\tthis.promises[c][k].extra_data.wait_arguments = { category: category, key: key };\n\t\t\t\t\t\tretval.push( this.promises[c][k] );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//Debug.Text('Promise: ignoring key: '+ k, 'TTPromise.js', 'TTPromise.js', 'pending_to_waiting', 11);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t//Debug.Text('Promise: ignoring category: '+ c, 'TTPromise.js', 'TTPromise.js', 'pending_to_waiting', 11);\n\t\t\t}\n\t\t}\n\t\treturn retval;\n\t},\n\n\tclearCompletedPromise: function( category, key ) {\n\t\tif ( this.promises && category && key ) {\n\t\t\tif ( this.promises[category] && this.promises[category][key] ) {\n\t\t\t\tthis.promises[category][key] = false;\n\t\t\t\tdelete this.promises[category][key];\n\t\t\t\tDebug.Text( 'Promise: clear category: ' + category + '|' + key, 'TTPromise.js', 'TTPromise.js', 'init', 11 );\n\t\t\t}\n\n\t\t\tif ( this.promises[category] && Object.keys( this.promises[category] ).length == 0 ) {\n\t\t\t\tthis.promises[category] = false;\n\t\t\t\tDebug.Text( 'Promise: clear category: ' + category, 'TTPromise.js', 'TTPromise.js', 'init', 11 );\n\t\t\t\tdelete this.promises[category];\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t},\n\n\t//clear existing promises (mostly for testing and first add)\n\tclearAllPromises: function() {\n\t\tDebug.Text( 'Promise: clear all promises.', 'TTPromise.js', 'TTPromise.js', 'init', 11 );\n\t\tthis.promises = {};\n\t},\n\n\tisPendingPromises: function( category, key ) {\n\t\tvar p = TTPromise.filterPromiseArray( category, key );\n\n\t\tvar pending_count = 0;\n\t\tfor ( var n in p ) {\n\t\t\tif ( p[n] && typeof p[n].state === 'function' && p[n].state() == 'pending' ) {\n\t\t\t\tconsole.debug( 'Category: ' + p[n].extra_data.category + ' Key: ' + p[n].extra_data.key + ' State: ' + p[n].state() );\n\t\t\t\tpending_count++;\n\t\t\t}\n\t\t}\n\n\t\tif ( pending_count > 0 ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t},\n\n\tdebugPromises: function( category, key ) {\n\t\tvar p = TTPromise.filterPromiseArray( category, key );\n\n\t\tfor ( var n in p ) {\n\t\t\tconsole.debug( 'Category: ' + p[n].extra_data.category + ' Key: ' + p[n].extra_data.key + ' State: ' + p[n].state() );\n\t\t}\n\n\t\treturn true;\n\t}\n};","import { TTAPI } from '@/services/TimeTrexClientAPI';\nimport Nanobar from 'nanobar'; // need to rely on the default export via CommonJS syntax, hence no named import.\n\nexport var ProgressBar = ( function() {\n\n\tvar loading_box = null;\n\n\tvar layout_content = null;\n\n\tvar left_offset = 0;\n\n\tvar process_number = false;\n\n\tvar can_close = false;\n\n\tvar timer = null;\n\n\tvar close_time = null;\n\n\tvar circle = null;\n\n\tvar doing_close = false;\n\n\tvar message_id_dic = {};\n\n\tvar updating_message_id = false;\n\n\tvar current_process_id = false;\n\n\tvar _progress_bar_api = false;\n\n\tvar get_progress_timer = null;\n\n\tvar first_start_get_progress_timer = false;\n\n\tvar start_progress_timer = false;\n\n\tvar auto_clear_message_id_dic = {}; //for which api calls don't have return; for example all report view calls\n\n\tvar last_iteration = null;\n\n\tvar temp_message_until_close = '';\n\n\tvar second_timer;\n\n\tvar time_offset;\n\n\tvar nanoBar;\n\n\tvar loading_bar_time;\n\n\tvar no_progress_for_next_call = false;\n\n\tvar showOverlay = function() {\n\t\tGlobal.overlay().addClass( 'overlay' );\n\t\tGlobal.setUINotready();\n\t\tTTPromise.add( 'ProgressBar', 'overlay_visible' );\n\t};\n\n\tvar closeOverlay = function() {\n\t\t//this variable is set in BaseViewController::onContextMenuClick\n\t\tif ( window.clickProcessing == true ) {\n\t\t\twindow.clickProcessing = false;\n\t\t\twindow.clearTimeout( window.clickProcessingHandle );\n\t\t}\n\t\tGlobal.overlay().removeClass( 'overlay' );\n\t\tGlobal.setUIReady();\n\t\tTTPromise.resolve( 'ProgressBar', 'overlay_visible' );\n\t};\n\n\tvar cancelProgressBar = function() {\n\t\tif ( get_progress_timer ) {\n\t\t\tclearInterval( get_progress_timer );\n\t\t\tget_progress_timer = false;\n\t\t}\n\t\tremoveProgressBar( current_process_id );\n\t\tget_progress_timer = false;\n\t\tcurrent_process_id = false;\n\t\tlast_iteration = null;\n\t\tfirst_start_get_progress_timer = false;\n\t};\n\n\tvar showProgressBar = function( message_id, auto_clear, instant ) {\n\n\t\tTTPromise.add( 'ProgressBar', 'MASTER' );\n\t\tif ( no_progress_for_next_call ) {\n\t\t\tno_progress_for_next_call = false;\n\t\t\treturn;\n\t\t}\n\t\tif ( instant ) {\n\t\t\tif ( process_number > 0 && loading_box ) {\n\t\t\t\tloading_box.css( 'display', 'block' );\n\t\t\t}\n\t\t} else {\n\t\t\tif ( !timer ) {\n//\t\t\tclearTimeout( timer );\n\t\t\t\t//Display progress bar after 1 sec\n\t\t\t\ttimer = setTimeout( function() {\n\t\t\t\t\tif ( process_number > 0 && loading_box ) {\n\t\t\t\t\t\tloading_box.css( 'display', 'block' );\n\t\t\t\t\t}\n\n\t\t\t\t}, 1000 );\n\t\t\t}\n\t\t}\n\n\t\tif ( message_id ) {\n\t\t\tmessage_id_dic[message_id] = true;\n\n\t\t\tif ( auto_clear ) {\n\t\t\t\tauto_clear_message_id_dic[message_id] = true;\n\t\t\t}\n\n\t\t}\n\n\t\tif ( message_id && start_progress_timer === false ) {\n\t\t\tstart_progress_timer = setInterval( function() {\n\t\t\t\tgetProgressBarProcess();\n\t\t\t}, 3000 );\n\t\t\tfirst_start_get_progress_timer = true;\n\t\t}\n\n\t\tif ( process_number > 0 ) { //has multi call or the last call is not removed yet\n\t\t\tprocess_number = process_number + 1;\n\t\t\treturn;\n\t\t}\n\n\t\tprocess_number = 1;\n\n\t\tGlobal.addCss( 'global/widgets/loading_bar/LoadingBox.css' );\n\n\t\tclearTimeout( close_time );\n\t\tvar message_label;\n\n\t\tif ( !loading_box ) {\n\t\t\tvar loadingBoxWidget = `\n\t\t\t\t<div class=\"popup-loading\">\n\t\t\t\t\t<div class=\"processing\"></div>\n\t\t\t\t\t<span class=\"close-icon\">x</span>\n\t\t\t\t\t<progress class=\"progress-bar\" max=\"100\" value=\"10\">\n\t\t\t\t\t</progress>\n\t\t\t\t\t<div class=\"complete-info\">100 / 5000 - 15% Complete</div>\n\t\t\t\t\t<div class=\"time-remaining\">11:11</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tvar loadngBox = $( loadingBoxWidget ).attr( 'id', 'progressBar' );\n\n\t\t\tvar close_icon = loadngBox.find( '.close-icon' );\n\n\t\t\tclose_icon.unbind( 'click' ).click( function() {\n\t\t\t\tcancelProgressBar();\n\n\t\t\t} );\n\t\t\t// css only spinner - and yes, it does unfortunately need all those divs. They are for each of the spokes of the circle.\n\t\t\tcircle = $( '<div class=\"lds-spinner\"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>' );\n\n\t\t\t$( 'body' ).append( loadngBox );\n\t\t\tloading_box = $( '#progressBar' );\n\t\t\tmessage_label = loading_box.find( '.processing' );\n\n\t\t\tif ( circle ) {\n\t\t\t\tmessage_label.after( circle );\n\t\t\t}\n\n\t\t\tloading_box.css( 'display', 'none' );\n\t\t\tlayout_content = document.querySelector( '.layout-content' );\n\n\t\t} else {\n\t\t\tmessage_label = loading_box.find( '.processing' );\n\n\t\t\t//If the user is logged in offset the progress bar to be centered inside the content portion of page taking into account the main left menu.\n\t\t\t//However if a wizard is displayed, the progress bar should be centered within the wizard overlay (entire page).\n\t\t\tif ( LocalCacheData.getLoginUser() && left_offset !== layout_content.offsetLeft && !document.querySelector( '.wizard-overlay' ) ) {\n\t\t\t\tleft_offset = ( layout_content.offsetLeft / 2 );\n\t\t\t\tloading_box.css( 'left', 'calc( 50% + ' + left_offset + 'px )' );\n\t\t\t} else {\n\t\t\t\tloading_box.css( 'left', '50%' );\n\t\t\t}\n\n\t\t\tif ( circle ) {\n\t\t\t\tmessage_label.after( circle );\n\t\t\t}\n\n\t\t}\n\n\t\tresetToDefault();\n\t};\n\n\tvar resetToDefault = function() {\n\n\t\tif ( temp_message_until_close ) {\n\t\t\t//Default process message, change this when update progress bar.\n\t\t\tloading_box.find( '.processing' ).text( temp_message_until_close );\n\t\t} else {\n\t\t\t//Default process message, change this when update progress bar.\n\t\t\t// Error: Unable to get property '_' of undefined or null reference in interface/html5/global/ProgressBarManager.js?v=9.0.6-20151231-155042 line 169\n\t\t\tloading_box.find( '.processing' ).text( $.i18n ? $.i18n._( 'Processing...' ) : 'Processing...' );\n\t\t}\n\n\t\tvar complete_info = loading_box.find( '.complete-info' );\n\t\tvar progress_bar = loading_box.find( '.progress-bar' );\n\t\tvar time_remaining = loading_box.find( '.time-remaining' );\n\n\t\tcomplete_info.css( 'display', 'none' );\n\t\tprogress_bar.css( 'display', 'none' );\n\t\ttime_remaining.css( 'display', 'none' );\n\n\t\tcomplete_info.text( 0 + ' / ' + 0 + ' ' + 0 + '%' );\n\t\tprogress_bar.val( 0 );\n\n\t\tlast_iteration = null;\n\n\t};\n\n\tvar changeProgressBarMessage = function( val ) {\n\t\ttemp_message_until_close = val;\n\t\tif ( loading_box ) {\n\t\t\tloading_box.find( '.processing' ).text( val );\n\t\t}\n\n\t};\n\n\tvar updateProgressbar = function( data ) {\n\n\t\tif ( !loading_box ) {\n\t\t\treturn;\n\t\t}\n\n\t\tloading_box.find( '.processing' ).text( data.message );\n\n\t\tvar percentage = data.current_iteration / data.total_iterations;\n\n\t\tvar complete_info = loading_box.find( '.complete-info' );\n\t\tvar progress_bar = loading_box.find( '.progress-bar' );\n\t\tvar time_remaining = loading_box.find( '.time-remaining' );\n\n\t\tcomplete_info.css( 'display', 'block' );\n\t\tprogress_bar.css( 'display', 'block' );\n\t\ttime_remaining.css( 'display', 'block' );\n\n\t\tcomplete_info.text( data.current_iteration + ' / ' + data.total_iterations + ' ( ' + ( percentage * 100 ).toFixed( 0 ) + '% )' );\n\t\tprogress_bar.prop( 'value', ( percentage * 100 ) );\n\n\t\tif ( !last_iteration || data.current_iteration == 0 ) {\n\t\t\ttime_remaining.text( $.i18n._( 'Patience is a Virtue...' ) );\n\t\t} else {\n\t\t\tif ( last_iteration !== data.current_iteration || !second_timer ) {\n\t\t\t\ttime_offset = ( data.last_update_time - data.start_time ) * ( data.total_iterations / data.current_iteration );\n\t\t\t\ttime_offset = Math.ceil( time_offset - ( data.last_update_time - data.start_time ) );\n\n\t\t\t\tif ( isNaN( time_offset ) || isFinite( time_offset ) == false || time_offset <= 0 ) {\n\t\t\t\t\ttime_offset = 0;\n\t\t\t\t}\n\n\t\t\t\tif ( time_offset == 0 ) {\n\t\t\t\t\ttime_remaining.text( $.i18n._( 'Almost Done...' ) );\n\t\t\t\t} else {\n\t\t\t\t\t//Error: 'console' is undefined in /interface/html5/global/ProgressBarManager.js?v=8.0.0-20141117-153515 line 224\n\t\t\t\t\ttime_remaining.text( Global.getTimeUnit( time_offset, 99 ) );\n\t\t\t\t}\n\t\t\t}\n\t\t\tsecondDown();\n\t\t}\n\n\t\tlast_iteration = data.current_iteration;\n\n\t};\n\n\tvar noProgressForNextCall = function() {\n\t\tno_progress_for_next_call = true;\n\t};\n\n\tvar secondDown = function() {\n\t\t//calculate down time every one second\n\t\tif ( !second_timer ) {\n\t\t\tvar time_remaining = loading_box.find( '.time-remaining' );\n\t\t\tsecond_timer = setInterval( function() {\n\t\t\t\tif ( isNaN( time_offset ) || isFinite( time_offset ) == false || time_offset <= 0 ) {\n\t\t\t\t\ttime_offset = 0;\n\t\t\t\t}\n\n\t\t\t\tif ( time_offset > 0 ) {\n\t\t\t\t\ttime_offset = ( time_offset - 1 );\n\t\t\t\t}\n\n\t\t\t\tif ( time_offset <= 0 ) {\n\t\t\t\t\ttime_offset = 0;\n\t\t\t\t}\n\n\t\t\t\tif ( time_offset == 0 ) {\n\t\t\t\t\ttime_remaining.text( $.i18n._( 'Almost Done...' ) );\n\t\t\t\t} else {\n\t\t\t\t\ttime_remaining.text( Global.getTimeUnit( time_offset, 99 ) );\n\t\t\t\t}\n\t\t\t}, 1000 );\n\t\t}\n\n\t};\n\n\tvar getProgressBarProcess = function() {\n\t\tif ( !LocalCacheData.getLoginData() ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !current_process_id ) {\n\t\t\tfor ( var key in message_id_dic ) {\n\t\t\t\tcurrent_process_id = key;\n\n\t\t\t\tdelete message_id_dic[key];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif ( current_process_id && $.type( 'current_process_id' ) === 'string' ) {\n\t\t\tTTAPI.APIProgressBar.getProgressBar( current_process_id, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\tvar res_data = result.getResult();\n\n\t\t\t\t\t//Means error in progress bar\n\t\t\t\t\tif ( res_data.hasOwnProperty( 'status_id' ) && res_data.status_id === 9999 ) {\n\t\t\t\t\t\tstopProgress();\n\t\t\t\t\t\tTAlertManager.showAlert( res_data.message );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( res_data === true ||\n\t\t\t\t\t\t\t( $.type( res_data ) === 'array' && res_data.length === 0 ) || !res_data.total_iterations ||\n\t\t\t\t\t\t\t$.type( res_data.total_iterations ) !== 'number' ) {\n\t\t\t\t\t\t\tstopProgress();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tupdateProgressbar( res_data );\n\t\t\t\t\t\t\tif ( first_start_get_progress_timer ) {\n\t\t\t\t\t\t\t\tfirst_start_get_progress_timer = false;\n\n\t\t\t\t\t\t\t\t//prevent over-writing active handle. see bug #2196\n\t\t\t\t\t\t\t\tif ( start_progress_timer != false && get_progress_timer == false ) {\n\t\t\t\t\t\t\t\t\t//start interval needs to be reset to FALSE to trigger start code in showProgressBar\n\t\t\t\t\t\t\t\t\tclearInterval( start_progress_timer );\n\t\t\t\t\t\t\t\t\tstart_progress_timer = false;\n\n\t\t\t\t\t\t\t\t\tget_progress_timer = setInterval( function() {\n\t\t\t\t\t\t\t\t\t\tgetProgressBarProcess();\n\t\t\t\t\t\t\t\t\t}, 2000 );\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\tfunction stopProgress() {\n\t\t\tif ( start_progress_timer ) {\n\t\t\t\tclearInterval( start_progress_timer );\n\t\t\t\tstart_progress_timer = false;\n\t\t\t}\n\t\t\tif ( get_progress_timer ) {\n\t\t\t\tclearInterval( get_progress_timer );\n\t\t\t\tget_progress_timer = false;\n\t\t\t}\n\n\t\t\tif ( auto_clear_message_id_dic[current_process_id] ) {\n\t\t\t\tremoveProgressBar( current_process_id );\n\t\t\t}\n\n\t\t\tget_progress_timer = false;\n\t\t\tcurrent_process_id = false;\n\t\t\tlast_iteration = null;\n\t\t\tfirst_start_get_progress_timer = false;\n\t\t}\n\n\t};\n\n\tvar removeProgressBar = function( message_id ) {\n\t\tif ( message_id ) {\n\t\t\tdelete message_id_dic[message_id];\n\t\t\tdelete auto_clear_message_id_dic[message_id];\n\n\t\t\tif ( current_process_id === message_id ) {\n\t\t\t\tcurrent_process_id = false;\n\t\t\t}\n\n\t\t}\n\n\t\tif ( process_number > 0 ) {\n\t\t\tprocess_number = process_number - 1;\n\n\t\t\tif ( process_number === 0 ) {\n\t\t\t\tremoveProgressBar();\n\t\t\t}\n\n\t\t} else {\n\t\t\tif ( loading_box ) {\n\t\t\t\tdoing_close = true;\n\t\t\t\tclearTimeout( close_time );\n\n\t\t\t\t//shorten timeout in unit test mode.\n\t\t\t\tvar close_time_timeout = Global.UNIT_TEST_MODE ? 10 : 500;\n\t\t\t\tclose_time = setTimeout( function() {\n\t\t\t\t\tcloseOverlay();\n\n\t\t\t\t\tif ( second_timer ) {\n\t\t\t\t\t\tclearInterval( second_timer );\n\t\t\t\t\t\tsecond_timer = null;\n\t\t\t\t\t}\n\n\t\t\t\t\ttimer = null;\n\t\t\t\t\ttemp_message_until_close = '';\n\t\t\t\t\tif ( loading_box ) {\n\t\t\t\t\t\tloading_box.css( 'display', 'none' );\n\n\t\t\t\t\t\tif ( get_progress_timer ) {\n\t\t\t\t\t\t\tclearInterval( get_progress_timer );\n\t\t\t\t\t\t\tget_progress_timer = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( start_progress_timer ) {\n\t\t\t\t\t\t\tclearInterval( start_progress_timer );\n\t\t\t\t\t\t\tstart_progress_timer = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tTTPromise.resolve( 'ProgressBar', 'MASTER' );\n\t\t\t\t}, close_time_timeout );\n\t\t\t}\n\t\t}\n\n\t};\n\n\tvar showNanobar = function() {\n\t\tif ( !nanoBar ) {\n\t\t\tvar options = {\n\t\t\t\tbg: 'red',\n\t\t\t\tid: 'nano-bar'\n\t\t\t};\n\t\t\tnanoBar = new Nanobar( options );\n\t\t}\n\t\tvar percentage = 0;\n\t\tloading_bar_time && clearInterval( loading_bar_time );\n\t\tloading_bar_time = setInterval( function() {\n\t\t\tif ( percentage < 80 ) {\n\t\t\t\tpercentage = percentage + 20;\n\t\t\t\tnanoBar.go( percentage );\n\t\t\t} else if ( percentage === 80 ) {\n\t\t\t\tpercentage = percentage + 10;\n\t\t\t\tnanoBar.go( percentage );\n\t\t\t}\n\n\t\t}, 1000 );\n\t};\n\n\tvar removeNanobar = function() {\n\t\tloading_bar_time && clearInterval( loading_bar_time );\n\t\tnanoBar && nanoBar.go( 100 );\n\t\tcloseOverlay();\n\t};\n\n\treturn {\n\t\tshowProgressBar: showProgressBar,\n\t\tremoveProgressBar: removeProgressBar,\n\t\tshowOverlay: showOverlay,\n\t\tcloseOverlay: closeOverlay,\n\t\tmessage_id_dic: message_id_dic,\n\t\tchangeProgressBarMessage: changeProgressBarMessage,\n\t\tcancelProgressBar: cancelProgressBar,\n\t\tshowNanobar: showNanobar,\n\t\tremoveNanobar: removeNanobar,\n\t\tnoProgressForNextCall: noProgressForNextCall\n\t};\n\n} )();","import { TTBackboneView } from '@/views/TTBackboneView';\n\nexport class BaseWizardController extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\t// _required_files: null,\n\t\t\tsteps: 0,\n\t\t\ttitle: 'Wizard',\n\t\t\tcurrent_step: 1,\n\n\t\t\tcontent_div: null,\n\n\t\t\tnext_btn: null,\n\t\t\tback_btn: null,\n\t\t\tdone_btn: null,\n\t\t\tcancel_btn: null,\n\t\t\tprogress: null,\n\t\t\tprogress_label: null,\n\n\t\t\tstepsWidgetDic: null,\n\t\t\tstepsDataDic: null,\n\n\t\t\tdefault_data: null,\n\n\t\t\tcall_back: null,\n\n\t\t\tsaved_user_generic_data: null,\n\n\t\t\tscript_name: null,\n\n\t\t\tuser_generic_data_api: null,\n\n\t\t\twizard_id: null,\n\n\t\t\tedit_view_ui_dic: {},\n\n\t\t\tedit_view_form_item_dic: {},\n\n\t\t\tevents: {\n\t\t\t\t'click .close-btn': 'onCloseClick',\n\t\t\t\t'click .close-icon': 'onCloseClick',\n\t\t\t\t'click .wizard-overlay.onclick-close': 'onCloseClick',\n\t\t\t\t'click .forward-btn': 'onNextClick',\n\t\t\t\t'click .back-btn': 'onBackClick',\n\t\t\t\t'click .done-btn': 'onDoneClick'\n\t\t\t}\n\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\t/**\n\t * When changing this function, you need to look for all occurences of this function because it was needed in several bases\n\t * BaseViewController, HomeViewController, BaseWizardController, QuickPunchBaseViewControler\n\t *\n\t * @returns {Array}\n\t */\n\t// filterRequiredFiles() {\n\t// \tvar retval = [];\n\t//\n\t// \tif ( this._required_files && this._required_files[0] ) {\n\t// \t\tretval = this._required_files;\n\t// \t} else {\n\t// \t\tfor ( var edition_id in this._required_files ) {\n\t// \t\t\tif ( Global.getProductEdition() >= edition_id ) {\n\t// \t\t\t\tretval = retval.concat( this._required_files[edition_id] );\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\t//\n\t// \tDebug.Arr( retval, 'RETVAL', 'BaseWizardController.js', 'BaseWizardController', 'filterRequiredFiles', 10 );\n\t// \treturn retval;\n\t// }\n\n\tinitialize( options ) {\n\t\tsuper.initialize( options );\n\n\t\tthis.content_div = $( this.el ).find( '.content' );\n\t\tthis.stepsWidgetDic = {};\n\t\tthis.stepsDataDic = {};\n\n\t\tthis.default_data = BaseWizardController.default_data;\n\t\tthis.call_back = BaseWizardController.call_back;\n\n\t\tBaseWizardController.default_data = null;\n\t\tBaseWizardController.call_back = null;\n\n\t\tthis.user_generic_data_api = TTAPI.APIUserGenericData;\n\n\t\tif ( this.wizard_id === null ) {\n            this.wizard_id = this.constructor.name;\n        }\n\n\t\tLocalCacheData.current_open_wizard_controllers.push( this );\n\n\t\tif ( typeof this.init == 'function' ) {\n\t\t\t//FIXME: pull this out when all wizards are refactored to the new way #1187\n\t\t\tif ( typeof this.setDefaultDataToSteps == 'function' ) {\n\t\t\t\tthis.setDefaultDataToSteps();\n\t\t\t}\n\t\t\tthis.init( options );\n\t\t\tTTPromise.resolve( 'BaseViewController', 'initialize' );\n\t\t}\n\t}\n\n\tsetDefaultDataToSteps() {\n\t}\n\n\tgetDefaultData( key ) {\n\n\t\tif ( !this.default_data ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.default_data[key];\n\t}\n\n\trender() {\n\t\tvar title = $( this.el ).find( '.title' );\n\t\tvar title_1 = $( this.el ).find( '.title-1' );\n\t\tthis.progress = $( this.el ).find( '.progress' );\n\t\tthis.progress_label = $( this.el ).find( '.steps' );\n\n\t\tthis.progress.attr( 'max', 10 );\n\t\tthis.progress.val( 0 );\n\n\t\tthis.next_btn = $( this.el ).find( '.forward-btn' );\n\t\tthis.back_btn = $( this.el ).find( '.back-btn' );\n\t\tthis.done_btn = $( this.el ).find( '.done-btn' );\n\t\tthis.close_btn = $( this.el ).find( '.close-btn' );\n\n\t\tGlobal.setWidgetEnabled( this.back_btn, false );\n\t\tGlobal.setWidgetEnabled( this.next_btn, false );\n\t\tGlobal.setWidgetEnabled( this.close_btn, false );\n\t\tGlobal.setWidgetEnabled( this.done_btn, false );\n\n\t\ttitle.text( this.title );\n\t\ttitle_1.text( this.title );\n\t\tTTPromise.resolve( 'init', 'init' );\n\t}\n\n\tsetButtonsStatus() {\n\n\t\tGlobal.setWidgetEnabled( this.done_btn, false );\n\t\tGlobal.setWidgetEnabled( this.close_btn, true );\n\n\t\tif ( this.current_step === 1 ) {\n\t\t\tGlobal.setWidgetEnabled( this.back_btn, false );\n\t\t} else {\n\t\t\tGlobal.setWidgetEnabled( this.back_btn, true );\n\t\t}\n\n\t\tif ( this.current_step !== this.steps ) {\n\t\t\tGlobal.setWidgetEnabled( this.done_btn, false );\n\t\t\tGlobal.setWidgetEnabled( this.next_btn, true );\n\t\t} else {\n\t\t\tGlobal.setWidgetEnabled( this.done_btn, true );\n\t\t\tGlobal.setWidgetEnabled( this.next_btn, false );\n\t\t}\n\t}\n\n\tonNextClick() {\n\t\tthis.saveCurrentStep();\n\t\tthis.current_step = this.current_step + 1;\n\t\tthis.initCurrentStep();\n\t}\n\n\tonBackClick() {\n\t\tthis.saveCurrentStep();\n\t\tthis.current_step = this.current_step - 1;\n\t\tthis.initCurrentStep();\n\t}\n\n\tonDoneClick() {\n\t}\n\n\tcleanStepsData() {\n\t\tthis.stepsDataDic = {};\n\t\tthis.current_step = 1;\n\t}\n\n\tonCloseClick() {\n\t\tif ( this.script_name ) {\n\t\t\tthis.saveCurrentStep();\n\n\t\t\tthis.saveAllStepsToUserGenericData( function() {\n\n\t\t\t} );\n\t\t}\n\t\tLocalCacheData.current_open_wizard_controllers = LocalCacheData.current_open_wizard_controllers.filter( wizard => wizard.wizard_id !== this.wizard_id );\n\t\t$( this.el ).remove();\n\t}\n\n\tsaveCurrentStep( direction, callBack ) {\n\t}\n\n\tsaveAllStepsToUserGenericData( callBack ) {\n\n\t\t// Function called stacks: TypeError: Unable to set property 'data' of undefined or null reference\n\t\tif ( this.script_name && this.saved_user_generic_data ) {\n\t\t\tthis.saved_user_generic_data.data = this.stepsDataDic;\n\t\t\tthis.saved_user_generic_data.data.current_step = this.current_step;\n\n\t\t\tthis.user_generic_data_api.setUserGenericData( this.saved_user_generic_data, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\tcallBack( result.getResult() );\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\tcallBack( true );\n\t\t}\n\t}\n\n\taddEditFieldToColumn( label, widgets, column, firstOrLastRecord, widgetContainer, saveFormItemDiv, setResizeEvent, saveFormItemDivKey, hasKeyEvent, customLabelWidget ) {\n\t\tvar $this = this;\n\t\tvar form_item = $( Global.loadWidgetByName( WidgetNamesDic.EDIT_VIEW_FORM_ITEM ) );\n\t\tvar form_item_label_div = form_item.find( '.edit-view-form-item-label-div' );\n\t\tvar form_item_label = form_item.find( '.edit-view-form-item-label' );\n\t\tvar form_item_input_div = form_item.find( '.edit-view-form-item-input-div' );\n\t\tvar widget = widgets;\n\n\t\tif ( Global.isArray( widgets ) ) {\n\t\t\tfor ( var i = 0; i < widgets.length; i++ ) {\n\t\t\t\twidget = widgets[i];\n//\t\t\t\twidget.css( 'opacity', 0 );\n\t\t\t}\n\t\t} else {\n//\t\t\twidget.css( 'opacity', 0 );\n\t\t}\n\n\t\tif ( customLabelWidget ) {\n\t\t\tform_item_label.parent().append( customLabelWidget );\n\t\t\tform_item_label.remove();\n\t\t} else {\n\t\t\tform_item_label.html( label );\n\t\t}\n\n\t\tif ( Global.isSet( widgetContainer ) ) {\n\n\t\t\tform_item_input_div.append( widgetContainer );\n\n\t\t} else {\n\t\t\tform_item_input_div.append( widget );\n\t\t}\n\n\t\tcolumn.append( form_item );\n\t\t//column.append( \"<div class='clear-both-div'></div>\" );\n\n\t\t//set height to text area\n//\t\tif ( form_item.height() > 35 ) {\n//\t\t\tform_item_label_div.css( 'height', form_item.height() );\n//\t\t} else if ( widget.hasClass( 'a-dropdown' ) ) {\n//\t\t\tform_item_label_div.css( 'height', 240 );\n//\t\t}\n\n\t\tif ( setResizeEvent ) {\n\n//\t\t\tform_item.unbind( 'resize' ).bind( 'resize', function() {\n//\t\t\t\tif ( form_item_label_div.height() !== form_item.height() && form_item.height() !== 0 ) {\n//\t\t\t\t\tform_item_label_div.css( 'height', form_item.height() );\n//\t\t\t\t}\n//\n//\t\t\t} );\n//\t\t\twidget.unbind( 'setSize' ).bind( 'setSize', function() {\n//\t\t\t\tform_item_label_div.css( 'height', widget.height() + 10 );\n//\t\t\t} );\n\n//\t\t\tform_item_input_div.unbind( 'resize' ).bind( 'resize', function() {\n//\t\t\t\tform_item_label_div.css( 'height', form_item_input_div.height() + 10 );\n//\t\t\t} );\n\n\t\t}\n\n\t\tif ( !label ) {\n\t\t\tform_item_input_div.remove();\n\t\t\tform_item_label_div.remove();\n\n\t\t\tform_item.append( widget );\n//\t\t\twidget.css( 'opacity', 1 );\n\n\t\t\tif ( saveFormItemDiv && saveFormItemDivKey ) {\n\t\t\t\tthis.edit_view_form_item_dic[saveFormItemDivKey] = form_item;\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif ( saveFormItemDiv ) {\n\n\t\t\tif ( Global.isArray( widgets ) ) {\n\t\t\t\tthis.edit_view_form_item_dic[widgets[0].getField()] = form_item;\n\t\t\t} else {\n\t\t\t\tthis.edit_view_form_item_dic[widget.getField()] = form_item;\n\t\t\t}\n\n\t\t}\n\t\tif ( Global.isArray( widgets ) ) {\n\n\t\t\tfor ( var i = 0; i < widgets.length; i++ ) {\n\t\t\t\twidget = widgets[i];\n\t\t\t\tthis.stepsWidgetDic[this.current_step][widget.getField()] = widget;\n\n\t\t\t\twidget.unbind( 'formItemChange' ).bind( 'formItemChange', function( e, target, doNotValidate ) {\n\t\t\t\t\t$this.onFormItemChange( target, doNotValidate );\n\t\t\t\t} );\n\n\t\t\t\tif ( hasKeyEvent ) {\n\t\t\t\t\twidget.unbind( 'formItemKeyUp' ).bind( 'formItemKeyUp', function( e, target ) {\n\t\t\t\t\t\t$this.onFormItemKeyUp( target );\n\t\t\t\t\t} );\n\n\t\t\t\t\twidget.unbind( 'formItemKeyDown' ).bind( 'formItemKeyDown', function( e, target ) {\n\t\t\t\t\t\t$this.onFormItemKeyDown( target );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.stepsWidgetDic[this.current_step][widget.getField()] = widget;\n\n\t\t\twidget.bind( 'formItemChange', function( e, target, doNotValidate ) {\n\t\t\t\t$this.onFormItemChange( target, doNotValidate );\n\t\t\t} );\n\n\t\t\tif ( hasKeyEvent ) {\n\t\t\t\twidget.bind( 'formItemKeyUp', function( e, target ) {\n\t\t\t\t\t$this.onFormItemKeyUp( target );\n\t\t\t\t} );\n\n\t\t\t\twidget.bind( 'formItemKeyDown', function( e, target ) {\n\t\t\t\t\t$this.onFormItemKeyDown( target );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t\treturn form_item;\n\t}\n\n\tinitUserGenericData() {\n\t\tvar $this = this;\n\t\tvar args = {};\n\n\t\tif ( this.script_name ) {\n\t\t\targs.filter_data = { script: this.script_name, deleted: false };\n\t\t\tthis.user_generic_data_api.getUserGenericData( args, {\n\t\t\t\tonResult: function( result ) {\n\n\t\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\t\tif ( $.type( result_data ) === 'array' ) {\n\t\t\t\t\t\t$this.saved_user_generic_data = result_data[0];\n\t\t\t\t\t\t$this.stepsDataDic = $this.saved_user_generic_data.data;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.saved_user_generic_data = {};\n\t\t\t\t\t\t$this.saved_user_generic_data.script = $this.script_name;\n\t\t\t\t\t\t$this.saved_user_generic_data.name = $this.script_name;\n\t\t\t\t\t\t$this.saved_user_generic_data.is_default = false;\n\t\t\t\t\t\t$this.saved_user_generic_data.data = { current_step: 1 };\n\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.current_step = $this.saved_user_generic_data.data.current_step;\n\n\t\t\t\t\tif ( $this.current_step > $this.steps || $this.current_step < 1 ) { //Make sure current_step isn't outside the range of the wizard.\n\t\t\t\t\t\t$this.current_step = 1;\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.initCurrentStep();\n\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\t$this.initCurrentStep();\n\t\t}\n\t}\n\n\tinitCurrentStep() {\n\n\t\tvar $this = this;\n\t\t$this.progress_label.text( 'Step ' + $this.current_step + ' of ' + $this.steps );\n\t\t$this.progress.attr( 'max', $this.steps );\n\t\t$this.progress.val( $this.current_step );\n\n\t\t$this.buildCurrentStepUI();\n\t\t$this.buildCurrentStepData();\n\t\t$this.setCurrentStepValues();\n\t\t$this.setButtonsStatus(); // set button enabled or disabled\n\t}\n\n\tbuildCurrentStepUI() {\n\t}\n\n\tbuildCurrentStepData() {\n\t}\n\n\t//Don't use this any more. Use BuildCurrentStepData to set values too\n\tsetCurrentStepValues() {\n\t}\n\n\tgetLabel() {\n\t\tvar label = $( '<span class=\\'wizard-label clear-both-div\\'></span>' );\n\t\treturn label;\n\t}\n\n\tgetCheckBox( field ) {\n\t\tvar check_box = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tcheck_box.TCheckbox( { field: field } );\n\n\t\treturn check_box;\n\t}\n\n\tgetDatePicker( field ) {\n\t\tvar widget = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\twidget.TDatePicker( { field: field } );\n\n\t\treturn widget;\n\t}\n\n\tgetPasswordInput( field ) {\n\t\tvar widget = Global.loadWidgetByName( FormItemType.PASSWORD_INPUT );\n\n\t\twidget = widget.TPasswordInput( {\n\t\t\tfield: field\n\t\t} );\n\n\t\treturn widget;\n\t}\n\n\tgetTextInput( field, width ) {\n\t\tvar widget = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tif ( width ) {\n\t\t\twidget = widget.TPasswordInput( {\n\t\t\t\tfield: field,\n\t\t\t\twidth: width\n\t\t\t} );\n\t\t} else {\n\t\t\twidget = widget.TPasswordInput( {\n\t\t\t\tfield: field\n\t\t\t} );\n\t\t}\n\t\treturn widget;\n\t}\n\n\tgetText() {\n\t\tvar widget = Global.loadWidgetByName( FormItemType.TEXT );\n\n\t\twidget = widget.TText( {} );\n\n\t\treturn widget;\n\t}\n\n\tgetTextArea( field, width, height ) {\n\n\t\tif ( !width ) {\n\t\t\twidth = 300;\n\t\t}\n\n\t\tif ( !height ) {\n\t\t\theight = 200;\n\t\t}\n\t\tvar widget = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\n\t\twidget = widget.TTextArea( {\n\t\t\tfield: field,\n\t\t\twidth: width,\n\t\t\theight: height\n\t\t} );\n\n\t\treturn widget;\n\t}\n\n\tgetComboBox( field, set_empty ) {\n\t\tvar widget = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\twidget = widget.TComboBox( {\n\t\t\tfield: field,\n\t\t\tset_empty: set_empty\n\t\t} );\n\n\t\treturn widget;\n\t}\n\n\tgetImageCutArea( field ) {\n\t\tvar widget = Global.loadWidgetByName( FormItemType.IMAGE_CUT );\n\n\t\twidget = widget.TImageCutArea( {\n\t\t\tfield: field\n\t\t} );\n\n\t\treturn widget;\n\t}\n\n\tgetCameraBrowser( field ) {\n\t\tvar widget = Global.loadWidgetByName( FormItemType.CAMERA_BROWSER );\n\n\t\twidget = widget.CameraBrowser( {\n\t\t\tfield: field\n\t\t} );\n\n\t\treturn widget;\n\t}\n\n\tgetFileBrowser( field, accept_filter, width, height ) {\n\t\tvar widget = Global.loadWidgetByName( FormItemType.FILE_BROWSER );\n\n\t\twidget = widget.TImageBrowser( {\n\t\t\tfield: field,\n\t\t\taccept_filter: accept_filter,\n\t\t\tdefault_width: width,\n\t\t\tdefault_height: height\n\t\t} );\n\n\t\treturn widget;\n\t}\n\n\tgetAComboBox( apiClass, allow_multiple, layoutName, field, set_all, key ) {\n\t\tvar a_combobox = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tif ( !key ) {\n\t\t\tkey = 'id';\n\t\t}\n\n\t\ta_combobox.AComboBox( {\n\t\t\tkey: key,\n\t\t\tapi_class: apiClass,\n\t\t\tallow_multiple_selection: allow_multiple,\n\t\t\tlayout_name: layoutName,\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tset_all: set_all,\n\t\t\tfield: field\n\t\t} );\n\n\t\treturn a_combobox;\n\t}\n\n\tgetSimpleTComboBox( field, allowMultiple ) {\n\n\t\tif ( !Global.isSet( allowMultiple ) ) {\n\t\t\tallowMultiple = true;\n\t\t}\n\n\t\tvar widget = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\twidget = widget.AComboBox( {\n\t\t\tfield: field,\n\t\t\tset_empty: true,\n\t\t\tallow_multiple_selection: allowMultiple,\n\t\t\tlayout_name: 'global_option_column',\n\t\t\tkey: 'value'\n\t\t} );\n\n\t\treturn widget;\n\t}\n\n\tonGridSelectRow( e ) {\n\t}\n\n\tonGridDblClickRow( e ) {\n\t}\n\n\tsetGrid( gridId, grid_div, allMultipleSelection ) {\n\n\t\tif ( !allMultipleSelection ) {\n\t\t\tallMultipleSelection = false;\n\t\t}\n\n\t\tvar $this = this;\n\n\t\tthis.content_div.append( grid_div );\n\n\t\tvar grid = grid_div.find( '#' + gridId );\n\n\t\tthis.getGridColumns( gridId, function( column_model ) {\n\n\t\t\t$this.stepsWidgetDic[$this.current_step][gridId] = new TTGrid( gridId, {\n\t\t\t\tcontainer_selector: '.wizard',\n\t\t\t\taltRows: true,\n\t\t\t\tonSelectRow: function( e ) {\n\t\t\t\t\t$this.onGridSelectRow( e );\n\t\t\t\t},\n\t\t\t\tonSelectAll: function( e ) {\n\t\t\t\t\tfor ( var n in e ) {\n\t\t\t\t\t\t$this.onGridSelectRow( e[n] );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tondblClickRow: function() {\n\t\t\t\t\t$this.onGridDblClickRow();\n\t\t\t\t},\n\t\t\t\tsortable: false,\n\t\t\t\theight: 75,\n\t\t\t\tmultiselect: allMultipleSelection,\n\t\t\t\tmultiboxonly: allMultipleSelection\n\n\t\t\t}, column_model );\n\n\t\t\t$this.setGridSize( $this.stepsWidgetDic[$this.current_step][gridId] );\n\n\t\t\t$this.setGridGroupColumns( gridId );\n\n\t\t} );\n\t\treturn grid; //allowing chaining off this method.\n\t}\n\n\tsetGridGroupColumns( gridId ) {\n\t}\n\n\tsetGridSize( grid ) {\n\t\tgrid.grid.setGridWidth( $( this.content_div.find( '.grid-div' ) ).width() - 11 );\n\t\tgrid.grid.setGridHeight( this.content_div.height() - 150 ); //During merge, this wasn't in MASTER branch.\n\t}\n\n\tgetGridColumns( gridId, callBack ) {\n\t}\n\n\tgetRibbonButtonBox() {\n\t\tvar div = $( '<div class=\"menu ribbon-button-bar\"></div>' );\n\t\tvar ul = $( '<ul></ul>' );\n\n\t\tdiv.append( ul );\n\n\t\treturn div;\n\t}\n\n\tgetRibbonButton( id, icon, label ) {\n\t\tvar button = $( '<li><div class=\"ribbon-sub-menu-icon\" id=\"' + id + '\"><img src=\"' + icon + '\" >' + label + '</div></li>' );\n\n\t\treturn button;\n\t}\n\n\tshowNoResultCover( grid_div ) {\n\t\tif ( grid_div && grid_div instanceof jQuery ) {\n\t\t\tthis.removeNoResultCover( grid_div );\n\t\t\tvar no_result_box = Global.loadWidgetByName( WidgetNamesDic.NO_RESULT_BOX );\n\t\t\tno_result_box.NoResultBox( { related_view_controller: this, is_new: false } );\n\t\t\tno_result_box.attr( 'class', 'no-result-div' );\n\n\t\t\tgrid_div.append( no_result_box );\n\t\t}\n\t}\n\n\tremoveNoResultCover( grid_div ) {\n\t\tif ( grid_div && grid_div instanceof jQuery ) {\n\t\t\tgrid_div.find( '.no-result-div' ).remove();\n\t\t}\n\t}\n\n}\n\nBaseWizardController.default_data = null;\nBaseWizardController.callBack = null;\n\nBaseWizardController.openWizard = function( viewId, templateName ) {\n\tif ( viewId != 'ReportViewWizard' && LocalCacheData.current_open_wizard_controllers.length > 0 ) {\n\t\tfor ( let i = 0; i < LocalCacheData.current_open_wizard_controllers.length; i++ ) {\n\t\t\tLocalCacheData.current_open_wizard_controllers[i].onCloseClick();\n\t\t}\n\t}\n\tGlobal.loadViewSource( viewId, templateName, function( result ) {\n\t\tvar args = {};\n\t\tvar template = _.template( result );\n\t\t$( 'body' ).append( template( args ) );\n\t\tGlobal.setUIInitComplete();\n\t} );\n\n};\n\n//Multiple wizards open at the same time is not a currently supported feature. The current code flow for opening a wizard\n//has BaseWizardController.default_data (the data to open a wizard) as a shared global state that is set to null after a wizard is initialized.\n//If BaseWizardController.default_data is not null than a wizard is in the process of being initialized.\n//Additionally, we can check if a specific wizard is already open (past the initialization stage), and if so, ignore the request.\nBaseWizardController.isWizardInitializingOrActive = function( wizard_id ) {\n\tif ( BaseWizardController.default_data || LocalCacheData.current_open_wizard_controllers.some( ( report ) => report.wizard_id === wizard_id ) ) {\n\t\treturn true;\n\t}\n\n\treturn false;\n};","export var PermissionManager = ( function() {\n\n\tvar validate = function( name, value ) {\n\t\tvar permission = PermissionManager.getPermissionData();\n\n\t\t//Error: Uncaught TypeError: Cannot read property 'punch' of null in /interface/html5/global/PermissionManager.js?v=8.0.0-20141230-115759 line 6\n\t\tif ( !permission || !Global.isSet( permission[name] ) || !Global.isSet( permission[name][value] ) ) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn permission[name][value];\n\t\t}\n\t};\n\n\tvar getPermissionLevel = function() {\n\t\tvar permission = PermissionManager.getPermissionData();\n\n\t\tif ( permission && permission['_system'] && permission['_system']['level'] ) {\n\t\t\treturn permission['_system']['level'];\n\t\t}\n\n\t\treturn 0;\n\t};\n\n\tvar subJobApplicationValidate = function( viewId ) {\n\t\tvar permission_section = getPermissionSectionByViewId( viewId );\n\n\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\treturn false;\n\t\t} else if ( PermissionManager.validate( permission_section, 'view' ) ||\n\t\t\tPermissionManager.validate( permission_section, 'edit' ) || PermissionManager.validate( permission_section, 'edit_child' ) ) {\n//\t\t\treturn true; // hide the tab until the API complete.\n\t\t\treturn false;\n\t\t}\n\n\t\treturn false;\n\n\t};\n\n\tvar HelpMenuValidateAdmin = function() {\n\t\tif ( PermissionManager.getPermissionLevel() >= 70 && PermissionManager.validate( 'user', 'edit' ) ) { //70=HR Manager or higher\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tvar HelpMenuValidateSupervisor = function() {\n\t\tif ( PermissionManager.getPermissionLevel() >= 40 && ( PermissionManager.validate( 'user', 'edit_child' ) || PermissionManager.validate( 'punch', 'edit_child' ) ) ) { //40=Supervisor (Subordinates Only)\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tvar checkTopLevelPermission = function( viewId ) {\n\t\tvar permission_section = getPermissionSectionByViewId( viewId );\n\n\t\tvar result = false;\n\n\t\tif ( viewId === 'About' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\t//TypeError: Cannot read property 'product_edition_id' of null\n\t\t//BUG#2066 - fail gracefully\n\t\t// Since LocalCacheData.getCurrentCompany() is require data, if the user was logged out or in the process of logging out, it could trigger sendErrorReport()\n\t\t//   so first check that 'current_company' exists in the LocalCacheData to avoid calling getCurrentCompany() if it doesn't exist.\n\t\tif ( Global.isSet( LocalCacheData ) == false || LocalCacheData.isLocalCacheExists( 'current_company' ) == false || Global.isSet( LocalCacheData.getCurrentCompany() ) == false ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tswitch ( viewId ) {\n\t\t\tcase 'GridTest':\n\t\t\tcase 'WidgetTest':\n\t\t\tcase 'AwesomeboxTest':\n\t\t\tcase 'UIKitSample':\n\t\t\tcase 'UIKitChildSample':\n\t\t\t\tresult = true;\n\t\t\t\tbreak;\n\t\t\tcase 'JobInvoice':\n\t\t\t\tif ( !( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'add' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'edit' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'edit_own' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'PaymentGateway':\n\t\t\t\tif ( !( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'edit' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'edit_own' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'InvoiceConfig':\n\t\t\t\tif ( !( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'edit' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'edit_own' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'CustomField':\n\t\t\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'view' ) &&\n\t\t\t\t\tPermissionManager.validate( permission_section, 'edit' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'InOut':\n\t\t\t\tif ( PermissionManager.validate( permission_section, 'enabled' ) && PermissionManager.validate( permission_section, 'punch_in_out' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Employee':\n\t\t\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'view' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_child' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'LegalEntity':\n\t\t\tcase 'PayrollRemittanceAgency':\n\t\t\tcase 'RemittanceSourceAccount':\n\t\t\tcase 'UserTitle':\n\t\t\tcase 'UserGroup':\n\t\t\tcase 'UserDefault':\n\t\t\tcase 'EthnicGroup':\n\t\t\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'edit' ) && PermissionManager.validate( permission_section, 'add' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'RemittanceDestinationAccount': //Uncomment this to enable Employee -> Payment Methods for regular employees. -- Currently Supervisors/Payroll Admins/Admins can see this.\n\t\t\tcase 'Punches':\n\t\t\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'edit' ) || PermissionManager.validate( permission_section, 'edit_child' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'GovernmentDocument':\n\t\t\tcase 'Exception':\n\t\t\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'view' ) || PermissionManager.validate( permission_section, 'view_own' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Company':\n\t\t\tcase 'LoginUserContact':\n\t\t\tcase 'LoginUserPreference':\n\t\t\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'edit_own' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Companies':\n\t\t\t\tif ( ( Global.getProductEdition() >= 15 ) &&\n\t\t\t\t\tPermissionManager.validate( permission_section, 'enabled' ) && PermissionManager.validate( permission_section, 'view' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'SavedReport':\n\t\t\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'PermissionControl':\n\t\t\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'edit' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'DocumentGroup':\n\t\t\t\tif ( !( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'edit' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'PayPeriodSchedule':\n\t\t\tcase 'Branch':\n\t\t\tcase 'Department':\n\t\t\tcase 'HierarchyControl':\n\t\t\tcase 'WageGroup':\n\t\t\tcase 'Station':\n\t\t\tcase 'Currency':\n\t\t\tcase 'PayStubEntryAccount':\n\t\t\tcase 'CompanyTaxDeduction':\n\t\t\tcase 'PolicyGroup':\n\t\t\tcase 'SchedulePolicy':\n\t\t\tcase 'RoundIntervalPolicy':\n\t\t\tcase 'MealPolicy':\n\t\t\tcase 'BreakPolicy':\n\t\t\tcase 'OvertimePolicy':\n\t\t\tcase 'PremiumPolicy':\n\t\t\tcase 'ExceptionPolicyControl':\n\t\t\tcase 'AccrualPolicy':\n\t\t\tcase 'AbsencePolicy':\n\t\t\tcase 'HolidayPolicy':\n\t\t\tcase 'RecurringHoliday':\n\t\t\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'view' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'RequestAuthorization':\n\t\t\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( 'request', 'authorize' ) && ( PermissionManager.validate( permission_section, 'view' ) || PermissionManager.validate( permission_section, 'view_child' ) ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'TimeSheetAuthorization':\n\t\t\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( 'punch', 'authorize' ) && ( PermissionManager.validate( permission_section, 'view' ) || PermissionManager.validate( permission_section, 'view_child' ) ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'ExpenseAuthorization':\n\t\t\t\tif ( !( Global.getProductEdition() >= 25 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( 'user_expense', 'authorize' ) && ( PermissionManager.validate( permission_section, 'view' ) || PermissionManager.validate( permission_section, 'view_child' ) ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'UserExpense':\n\t\t\t\tif ( !( Global.getProductEdition() >= 25 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'view' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSV':\n\t\t\t\t//This is the Company -> Import icon, which should only be displayed if 'company','enabled' is also allowed.\n\t\t\t\tif ( PermissionManager.validate( 'company', 'enabled' ) ) {\n\t\t\t\t\tresult = importValidate();\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSVSchedule':\n\t\t\t\tresult = importValidateFor( 'schedule' );\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSVBranch':\n\t\t\t\tresult = importValidateFor( 'branch' );\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSVDepartment':\n\t\t\t\tresult = importValidateFor( 'department' );\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSVWage':\n\t\t\t\tresult = importValidateFor( 'wage' );\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSVEmployeeBankAccount':\n\t\t\t\tresult = importValidateFor( 'user' );\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSVEmployee':\n\t\t\t\tresult = importValidateFor( 'user' );\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSVEmployeeContact':\n\t\t\t\tresult = importValidateFor( 'user_contact' );\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSVEmployeeSkill':\n\t\t\t\tresult = importValidateFor( 'user_skill' );\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSVEmployeeMembership':\n\t\t\t\tresult = importValidateFor( 'user_membership' );\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSVEmployeeEducation':\n\t\t\t\tresult = importValidateFor( 'user_education' );\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSVEmployeeLicense':\n\t\t\t\tresult = importValidateFor( 'user_license' );\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSVEmployeeLanguage':\n\t\t\t\tresult = importValidateFor( 'user_language' );\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSVPayStubAmendment':\n\t\t\t\tresult = importValidateFor( 'pay_stub_amendment' );\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSVJob':\n\t\t\t\tresult = importValidateFor( 'job' );\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSVJobItem':\n\t\t\t\tresult = importValidateFor( 'job_item' );\n\t\t\t\tbreak;\n\t\t\tcase 'PayrollProcessWizard':\n\t\t\t\tif ( PermissionManager.validate( 'pay_stub', 'add' ) &&\n\t\t\t\t\tPermissionManager.validate( 'pay_stub', 'edit' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'QuickStartWizard':\n\t\t\t\tif ( PermissionManager.validate( 'pay_period_schedule', 'add' ) &&\n\t\t\t\t\tPermissionManager.validate( 'user_preference', 'edit' ) &&\n\t\t\t\t\tPermissionManager.validate( 'policy_group', 'edit' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'AccrualBalance':\n\t\t\tcase 'Accrual':\n\t\t\tcase 'Request':\n\t\t\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'view' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_own' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'ScheduleShift':\n\t\t\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'edit' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'edit_child' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'RecurringScheduleControl':\n\t\t\tcase 'RecurringScheduleTemplateControl':\n\t\t\tcase 'MessageControl':\n\t\t\t\tif ( PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Notification':\n\t\t\t\tresult = true; // Notification always returns true as notifications should always be enabled.\n\t\t\t\tbreak;\n\t\t\tcase 'UserPreference':\n\t\t\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'edit' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'edit_child' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Document':\n\t\t\t\tif ( !( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'view' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_own' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_private' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'ChangePassword':\n\t\t\t\tif ( PermissionManager.validate( permission_section, 'edit_own_password' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'edit_own_phone_password' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'ActiveShiftReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_active_shift' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'UserSummaryReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_user_information' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'AuditTrailReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_system_log' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'ScheduleSummaryReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_schedule_summary' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'TimesheetSummaryReport':\n\t\t\tcase 'TimesheetDetailReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_timesheet_summary' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'PunchSummaryReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_punch_summary' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'AccrualBalanceSummaryReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_accrual_balance_summary' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'ExceptionSummaryReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_exception_summary' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'PayStubTransactionSummaryReport':\n\t\t\tcase 'PayStubSummaryReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_pay_stub_summary' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'PayrollExportReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_payroll_export' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'GeneralLedgerSummaryReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_general_ledger_summary' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'ExpenseSummaryReport':\n\t\t\t\tif ( !( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( 'report', 'view_expense' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'JobSummaryReport':\n\t\t\tcase 'JobInformationReport':\n\t\t\tcase 'JobItemInformationReport':\n\t\t\t\tif ( !( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( 'job_report', 'view_job_summary' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'JobAnalysisReport':\n\t\t\t\tif ( !( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( 'job_report', 'view_job_analysis' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'InvoiceTransactionSummaryReport':\n\t\t\t\tif ( !( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( 'invoice_report', 'view_transaction_summary' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'RemittanceSummaryReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_remittance_summary' ) &&\n\t\t\t\t\tcountryPermissionValidate( 'CA' )\n\t\t\t\t) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'T4SummaryReport':\n\t\t\tcase 'T4ASummaryReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_t4_summary' ) &&\n\t\t\t\t\tcountryPermissionValidate( 'CA' )\n\t\t\t\t) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'TaxSummaryReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_generic_tax_summary' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Form940Report':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_form940' ) &&\n\t\t\t\t\tcountryPermissionValidate( 'US' )\n\t\t\t\t) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Form941Report':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_form941' ) &&\n\t\t\t\t\tcountryPermissionValidate( 'US' )\n\t\t\t\t) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Form1099NecReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_form1099nec' ) &&\n\t\t\t\t\tcountryPermissionValidate( 'US' )\n\t\t\t\t) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'FormW2Report':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_formW2' ) &&\n\t\t\t\t\tcountryPermissionValidate( 'US' )\n\t\t\t\t) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'USStateUnemploymentReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_us_state_unemployment' ) &&\n\t\t\t\t\tcountryPermissionValidate( 'US' )\n\t\t\t\t) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'USPERSReport':\n\t\t\t\tif ( PermissionManager.validate( 'report', 'view_us_pers' ) &&\n\t\t\t\t\tcountryPermissionValidate( 'US' )\n\t\t\t\t) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'USEEOReport':\n\t\t\t\tif ( Global.getProductEdition() >= 15 && PermissionManager.validate( 'report', 'view_us_eeo' ) &&\n\t\t\t\t\tcountryPermissionValidate( 'US' )\n\t\t\t\t) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'AffordableCareReport':\n\t\t\t\tif ( Global.getProductEdition() >= 15 &&\n\t\t\t\t\tPermissionManager.validate( 'report', 'view_affordable_care' ) &&\n\t\t\t\t\tcountryPermissionValidate( 'US' )\n\t\t\t\t) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'UserQualificationReport':\n\t\t\t\tif ( PermissionManager.validate( 'hr_report', 'user_qualification' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'KPIReport':\n\t\t\t\tif ( PermissionManager.validate( 'hr_report', 'user_review' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'UserRecruitmentSummaryReport':\n\t\t\tcase 'UserRecruitmentDetailReport':\n\t\t\t\tif ( !( Global.getProductEdition() >= 25 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( 'recruitment_report', 'user_recruitment' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Client':\n\t\t\tcase 'ClientContact':\n\t\t\tcase 'InvoiceDistrict':\n\t\t\tcase 'ClientPayment':\n\t\t\tcase 'Invoice':\n\t\t\tcase 'InvoiceTransaction':\n\t\t\tcase 'Product':\n\t\t\tcase 'ClientGroup':\n\t\t\tcase 'ProductGroup':\n\t\t\tcase 'TaxPolicy':\n\t\t\tcase 'ShippingPolicy':\n\t\t\tcase 'AreaPolicy':\n\t\t\t\tif ( !( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'view' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_own' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_child' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Job':\n\t\t\tcase 'JobItem':\n\t\t\tcase 'JobGroup':\n\t\t\tcase 'JobItemGroup':\n\t\t\t\tif ( !( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'view' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_own' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_child' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'PunchTag':\n\t\t\tcase 'PunchTagGroup':\n\t\t\t\tif ( !( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'view' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_own' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_child' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'GEOFence':\n\t\t\t\tif ( !( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'view' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_own' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'ExpensePolicy':\n\t\t\tcase 'LoginUserExpense':\n\t\t\tcase 'JobVacancy':\n\t\t\tcase 'JobApplicant':\n\t\t\tcase 'JobApplication':\n\n\t\t\t\tif ( !( Global.getProductEdition() >= 25 ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'view' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_own' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_child' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'ROE':\n\t\t\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( ( PermissionManager.validate( permission_section, 'view' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_own' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_child' ) ) &&\n\t\t\t\t\tcountryPermissionValidate( 'CA' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'GeneratePayStubs':\n\t\t\t\tif ( PermissionManager.validate( 'pay_period_schedule', 'enabled' )\n\t\t\t\t\t&& ( PermissionManager.validate( 'pay_period_schedule', 'edit' ) || PermissionManager.validate( 'pay_period_schedule', 'edit_own' ) )\n\t\t\t\t\t&& ( PermissionManager.validate( 'pay_stub', 'view' ) || PermissionManager.validate( 'pay_stub', 'view_child' ) ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'PayStubTransaction':\n\t\t\t\tif ( PermissionManager.validate( 'pay_stub', 'enabled' )\n\t\t\t\t\t&& ( PermissionManager.validate( 'pay_stub', 'view' ) || PermissionManager.validate( 'pay_stub', 'view_child' ) ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t} else {\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif ( !PermissionManager.validate( permission_section, 'enabled' ) ) {\n\t\t\t\t\tresult = false;\n\t\t\t\t} else if ( PermissionManager.validate( permission_section, 'view' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_own' ) ||\n\t\t\t\t\tPermissionManager.validate( permission_section, 'view_child' ) ) {\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\treturn result;\n\t};\n\n\tvar countryPermissionValidate = function( key ) {\n\n\t\tvar country_array = LocalCacheData.getUniqueCountryArray();\n\n\t\tfor ( var i = 0; i < country_array.length; i++ ) {\n\t\t\tif ( key === country_array[i] ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\n\t};\n\n\tvar importValidate = function() {\n\n\t\tvar result = false;\n\n\t\tif ( importValidateFor( 'branch' ) ||\n\t\t\timportValidateFor( 'payperiod' ) ||\n\t\t\timportValidateFor( 'schedule' ) ||\n\t\t\timportValidateFor( 'user' ) ||\n\t\t\timportValidateFor( 'department' ) ||\n\t\t\timportValidateFor( 'client' ) ||\n\t\t\timportValidateFor( 'job' ) ||\n\t\t\timportValidateFor( 'jobitem' ) ||\n\t\t\timportValidateFor( 'wage' ) ||\n\t\t\timportValidateFor( 'punch' ) ||\n\t\t\timportValidateFor( 'paystubamendment' ) ||\n\t\t\timportValidateFor( 'accrual' ) ) {\n\n\t\t\tresult = true;\n\t\t}\n\n\t\treturn result;\n\t};\n\n\tvar importValidateFor = function( key ) {\n\t\tif ( PermissionManager.validate( key, 'add' ) &&\n\t\t\t( PermissionManager.validate( key, 'edit' ) || PermissionManager.validate( key, 'edit_child' ) ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tvar getPermissionSectionByViewId = function( viewId ) {\n\n\t\tvar permission_section = '';\n\n\t\tswitch ( viewId ) {\n\t\t\tcase 'AccumulatedTime':\n\t\t\t\tpermission_section = 'user_date_total';\n\t\t\t\tbreak;\n\t\t\tcase 'PaymentGateway':\n\t\t\t\tpermission_section = 'payment_gateway';\n\t\t\t\tbreak;\n\t\t\tcase 'InvoiceConfig':\n\t\t\t\tpermission_section = 'invoice_config';\n\t\t\t\tbreak;\n\t\t\tcase 'AreaPolicy':\n\t\t\t\tpermission_section = 'area_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'ShippingPolicy':\n\t\t\t\tpermission_section = 'shipping_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'GovernmentDocument':\n\t\t\t\tpermission_section = 'government_document';\n\t\t\t\tbreak;\n\t\t\tcase 'TaxPolicy':\n\t\t\t\tpermission_section = 'tax_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'Product':\n\t\t\t\tpermission_section = 'product';\n\t\t\t\tbreak;\n\t\t\tcase 'RemittanceSourceAccount':\n\t\t\t\tpermission_section = 'remittance_source_account';\n\t\t\t\tbreak;\n\t\t\tcase 'RemittanceDestinationAccount':\n\t\t\t\tpermission_section = 'remittance_destination_account';\n\t\t\t\tbreak;\n\t\t\tcase 'ScheduleShift':\n\t\t\tcase 'Schedule':\n\t\t\t\tpermission_section = 'schedule';\n\t\t\t\tbreak;\n\t\t\tcase 'TimeSheet':\n\t\t\tcase 'ManualTimeSheet':\n\t\t\tcase 'UserDateTotalParent':\n\t\t\tcase 'UserDateTotal':\n\t\t\tcase 'InOut':\n\t\t\tcase 'Punches':\n\t\t\tcase 'TimeSheetAuthorization':\n\t\t\tcase 'Exception':\n\t\t\t\tpermission_section = 'punch';\n\t\t\t\tbreak;\n\t\t\tcase 'AccrualBalance':\n\t\t\tcase 'Accrual':\n\t\t\t\tpermission_section = 'accrual';\n\t\t\t\tbreak;\n\t\t\tcase 'Job':\n\t\t\tcase 'JobGroup':\n\t\t\t\tpermission_section = 'job';\n\t\t\t\tbreak;\n\t\t\tcase 'PunchTag':\n\t\t\tcase 'PunchTagGroup':\n\t\t\t\tpermission_section = 'punch_tag';\n\t\t\t\tbreak;\n\t\t\tcase 'PolicyGroup':\n\t\t\t\tpermission_section = 'policy_group';\n\t\t\t\tbreak;\n\t\t\tcase 'PayCode':\n\t\t\t\tpermission_section = 'pay_code';\n\t\t\t\tbreak;\n\t\t\tcase 'PayFormulaPolicy':\n\t\t\t\tpermission_section = 'pay_formula_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'ContributingPayCodePolicy':\n\t\t\t\tpermission_section = 'contributing_pay_code_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'ContributingShiftPolicy':\n\t\t\t\tpermission_section = 'contributing_shift_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'AbsencePolicy':\n\t\t\t\tpermission_section = 'absence_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'MealPolicy':\n\t\t\t\tpermission_section = 'meal_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'ExpensePolicy':\n\t\t\t\tpermission_section = 'expense_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'BreakPolicy':\n\t\t\t\tpermission_section = 'break_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'HolidayPolicy':\n\t\t\tcase 'RecurringHoliday':\n\t\t\t\tpermission_section = 'holiday_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'PremiumPolicy':\n\t\t\t\tpermission_section = 'premium_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'RegularTimePolicy':\n\t\t\t\tpermission_section = 'regular_time_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'OvertimePolicy':\n\t\t\t\tpermission_section = 'over_time_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'RoundIntervalPolicy':\n\t\t\t\tpermission_section = 'round_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'Employee':\n\t\t\tcase 'LoginUserContact':\n\t\t\tcase 'ChangePassword':\n\t\t\t\tpermission_section = 'user';\n\t\t\t\tbreak;\n\t\t\tcase 'UserDefault':\n\t\t\t\tpermission_section = 'user_default';\n\t\t\t\tbreak;\n\t\t\tcase 'UserTitle':\n\t\t\t\tpermission_section = 'user_title';\n\t\t\t\tbreak;\n\t\t\tcase 'UserGroup':\n\t\t\t\tpermission_section = 'user_group';\n\t\t\t\tbreak;\n\t\t\tcase 'EthnicGroup':\n\t\t\t\tpermission_section = 'ethnic_group';\n\t\t\t\tbreak;\n\t\t\tcase 'LegalEntity':\n\t\t\t\tpermission_section = 'legal_entity';\n\t\t\t\tbreak;\n\t\t\tcase 'PayrollRemittanceAgency':\n\t\t\t\tpermission_section = 'payroll_remittance_agency';\n\t\t\t\tbreak;\n\t\t\tcase 'MessageControl':\n\t\t\t\tpermission_section = 'message';\n\t\t\t\tbreak;\n\t\t\tcase 'Notification':\n\t\t\t\tpermission_section = 'notification';\n\t\t\t\tbreak;\n\t\t\tcase 'Wage':\n\t\t\tcase 'WageGroup':\n\t\t\t\tpermission_section = 'wage';\n\t\t\t\tbreak;\n\t\t\tcase 'UserContact':\n\t\t\t\tpermission_section = 'user_contact';\n\t\t\t\tbreak;\n\t\t\tcase 'LoginUserExpense':\n\t\t\tcase 'UserExpense':\n\t\t\t\tpermission_section = 'user_expense';\n\t\t\t\tbreak;\n\t\t\tcase 'UserSkill':\n\t\t\t\tpermission_section = 'user_skill';\n\t\t\t\tbreak;\n\t\t\tcase 'JobApplication':\n\t\t\t\tpermission_section = 'job_application';\n\t\t\t\tbreak;\n\t\t\tcase 'JobApplicant':\n\t\t\tcase 'RecruitmentPortalConfig':\n\t\t\t\tpermission_section = 'job_applicant';\n\t\t\t\tbreak;\n\t\t\tcase 'UserLicense':\n\t\t\t\tpermission_section = 'user_license';\n\t\t\t\tbreak;\n\t\t\tcase 'UserMembership':\n\t\t\t\tpermission_section = 'user_membership';\n\t\t\t\tbreak;\n\t\t\tcase 'UserEducation':\n\t\t\t\tpermission_section = 'user_education';\n\t\t\t\tbreak;\n\t\t\tcase 'UserPreference':\n\t\t\tcase 'LoginUserPreference':\n\t\t\t\tpermission_section = 'user_preference';\n\t\t\t\tbreak;\n\t\t\tcase 'UserLanguage':\n\t\t\t\tpermission_section = 'user_language';\n\t\t\t\tbreak;\n\t\t\tcase 'Company':\n\t\t\tcase 'Companies':\n\t\t\t\tpermission_section = 'company';\n\t\t\t\tbreak;\n\t\t\tcase 'GEOFence':\n\t\t\t\tpermission_section = 'geo_fence';\n\t\t\t\tbreak;\n\t\t\tcase 'Qualification':\n\t\t\tcase 'QualificationGroup':\n\t\t\t\tpermission_section = 'qualification';\n\t\t\t\tbreak;\n\t\t\tcase 'PayPeriodSchedule':\n\t\t\tcase 'PayPeriods':\n\t\t\t\tpermission_section = 'pay_period_schedule';\n\t\t\t\tbreak;\n\t\t\tcase 'PayStubAmendment':\n\t\t\tcase 'RecurringPayStubAmendment':\n\t\t\t\tpermission_section = 'pay_stub_amendment';\n\t\t\t\tbreak;\n\t\t\tcase 'PayStubTransactionSummaryReport':\n\t\t\tcase 'PayStub':\n\t\t\t\tpermission_section = 'pay_stub';\n\t\t\t\tbreak;\n\t\t\tcase 'Branch':\n\t\t\t\tpermission_section = 'branch';\n\t\t\t\tbreak;\n\t\t\tcase 'Department':\n\t\t\t\tpermission_section = 'department';\n\t\t\t\tbreak;\n\t\t\tcase 'HierarchyControl':\n\t\t\t\tpermission_section = 'hierarchy';\n\t\t\t\tbreak;\n\t\t\tcase 'Station':\n\t\t\t\tpermission_section = 'station';\n\t\t\t\tbreak;\n\t\t\tcase 'JobVacancy':\n\t\t\tcase 'PortalJobVacancy':\n\t\t\t\tpermission_section = 'job_vacancy';\n\t\t\t\tbreak;\n\t\t\tcase 'PayStubEntryAccount':\n\t\t\t\tpermission_section = 'pay_stub_account';\n\t\t\t\tbreak;\n\t\t\tcase 'ROE':\n\t\t\t\tpermission_section = 'roe';\n\t\t\t\tbreak;\n\t\t\tcase 'CustomField':\n\t\t\t\tpermission_section = 'custom_field';\n\t\t\t\tbreak;\n\t\t\tcase 'Currency':\n\t\t\t\tpermission_section = 'currency';\n\t\t\t\tbreak;\n\t\t\tcase 'PermissionControl':\n\t\t\t\tpermission_section = 'permission';\n\t\t\t\tbreak;\n\t\t\tcase 'CompanyTaxDeduction':\n\t\t\t\tpermission_section = 'company_tax_deduction';\n\t\t\t\tbreak;\n\t\t\tcase 'UserTaxDeduction':\n\t\t\t\tpermission_section = 'user_tax_deduction';\n\t\t\t\tbreak;\n\t\t\tcase 'Request':\n\t\t\t\tpermission_section = 'request';\n\t\t\t\tbreak;\n\t\t\tcase 'RequestAuthorization':\n\t\t\tcase 'ExpenseAuthorization':\n\t\t\t\tpermission_section = 'authorization';\n\t\t\t\tbreak;\n\t\t\tcase 'Document':\n\t\t\tcase 'DocumentGroup':\n\t\t\t\tpermission_section = 'document';\n\t\t\t\tbreak;\n\t\t\tcase 'SchedulePolicy':\n\t\t\t\tpermission_section = 'schedule_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'AccrualPolicyAccount':\n\t\t\tcase 'AccrualPolicy':\n\t\t\t\tpermission_section = 'accrual_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'Client':\n\t\t\tcase 'ClientContact':\n\t\t\tcase 'InvoiceDistrict':\n\t\t\tcase 'ClientPayment':\n\t\t\t\tpermission_section = 'client';\n\t\t\t\tbreak;\n\t\t\tcase 'InvoiceTransaction':\n\t\t\t\tpermission_section = 'transaction';\n\t\t\t\tbreak;\n\t\t\tcase 'JobItemGroup':\n\t\t\tcase 'JobItem':\n\t\t\t\tpermission_section = 'job_item';\n\t\t\t\tbreak;\n\t\t\tcase 'SavedReport':\n\t\t\t\tpermission_section = 'report';\n\t\t\t\tbreak;\n\t\t\tcase 'RecurringScheduleControl':\n\t\t\t\tpermission_section = 'recurring_schedule';\n\t\t\t\tbreak;\n\t\t\tcase 'RecurringScheduleTemplateControl':\n\t\t\t\tpermission_section = 'recurring_schedule_template';\n\t\t\t\tbreak;\n\t\t\tcase 'KPI':\n\t\t\tcase 'KPIGroup':\n\t\t\t\tpermission_section = 'kpi';\n\t\t\t\tbreak;\n\t\t\tcase 'UserReviewControl':\n\t\t\t\tpermission_section = 'user_review';\n\t\t\t\tbreak;\n\t\t\tcase 'ExceptionPolicyControl':\n\t\t\t\tpermission_section = 'exception_policy';\n\t\t\t\tbreak;\n\t\t\tcase 'ImportCSV':\n\t\t\t\tpermission_section = 'import_csv';\n\t\t\t\tbreak;\n\t\t\tcase 'Invoice':\n\t\t\tcase 'JobInvoice':\n\t\t\t\tpermission_section = 'invoice';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn permission_section;\n\t};\n\n\tvar getPermissionData = function() {\n\t\treturn LocalCacheData.getPermissionData();\n\t};\n\n\treturn {\n\t\tcheckTopLevelPermission: checkTopLevelPermission,\n\t\tvalidate: validate,\n\t\tgetPermissionLevel: getPermissionLevel,\n\t\tgetPermissionData: getPermissionData,\n\t\tHelpMenuValidateAdmin: HelpMenuValidateAdmin,\n\t\tHelpMenuValidateSupervisor: HelpMenuValidateSupervisor,\n\t\timportValidate: importValidate,\n\t\tsubJobApplicationValidate: subJobApplicationValidate\n\t};\n\n} )();\n","export var TAlertManager = ( function() {\n\n\tvar view = null;\n\n\tvar isShownNetworkAlert = false;\n\n\tvar closeBrowserBanner = function() {\n\t\t$( '.browser-banner' ).remove();\n\t};\n\n\tvar showBrowserTopBanner = function() {\n\t\t// if ( ie && ie <= 11 ) {\n\t\t// \tvar div = $( '<div class=\"browser-banner\"><a href=\"https://www.timetrex.com/supported-web-browsers\" target=\"_blank\"><span id=\"browser-top-banner\" class=\"label\"><strong>WARNING</strong>: ' + LocalCacheData.getLoginData().application_name + ' will no longer support <strong>Internet Explorer 11</strong> effective <strong>January 14th, 2020</strong>.<br><strong>Please upgrade to Microsoft Edge, Chrome or FireFox immediately to continue using TimeTrex.</strong></span></a></div>' );\n\t\t// \t$( 'body' ).append( div );\n\t\t// }\n\t};\n\n\tvar showNetworkErrorAlert = function( jqXHR, textStatus, errorThrown ) {\n\t\t//#2514 - status 0 is caused by browser cancelling the request. There is no status because there was no request.\n\t\tif ( jqXHR.status == 0 ) {\n\t\t\tif ( APIGlobal.pre_login_data.production !== true ) {\n\t\t\t\tconsole.error( 'Browser cancelled request... jqXHR: Status=0' );\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif ( textStatus == 'parsererror' ) {\n\t\t\tGlobal.sendErrorReport( textStatus + ' (' + jqXHR.status + '): \"' + errorThrown + '\" FROM TAlertManager::showNetworkErrorAlert():\\n\\n' + ( jqXHR.responseText ? jqXHR.responseText : 'N/A' ), false, false, jqXHR );\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !isShownNetworkAlert ) {\n\t\t\tTAlertManager.showAlert( Global.network_lost_msg + '<br><br>' + 'Error: ' + textStatus + ' (' + jqXHR.status + '): <br>\"' + errorThrown + '\"' + '<br><hr>' + ( jqXHR.responseText ? jqXHR.responseText : 'N/A' ) + ' (' + jqXHR.status + ')', 'Error', function() {\n\t\t\t\tisShownNetworkAlert = false;\n\t\t\t} );\n\t\t\tisShownNetworkAlert = true;\n\t\t\tGlobal.sendAnalyticsEvent( 'alert-manager', 'error:network', 'network-error: jqXHR-status: ' + jqXHR.status + ' Error: ' + textStatus );\n\t\t}\n\t};\n\n\tvar showPreSessionAlert = function() {\n\t\tvar result = $( '<div class=\"session-alert\"> ' +\n\t\t\t'<span class=\"close-icon\">X</span>' +\n\t\t\t'<span class=\"content\"></span>' +\n\t\t\t'</div>' );\n\t\tsetTimeout( function() {\n\t\t\t$( 'body' ).append( result );\n\t\t\tresult.find( '.content' ).html( $.i18n._( 'Previous Session' ) );\n\t\t\tvar button = result.find( '.close-icon' );\n\n\t\t\tbutton.bind( 'click', Global.debounce( function ConfirmRemovePreSession( e ) {\n\t\t\t\tremovePreSession();\n\t\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork(), true ) );\n\n\t\t\tresult.bind( 'click', Global.debounce( function ConfirmBackToPreSession( e ) {\n\t\t\t\tbackToPreSession();\n\t\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork(), true ) );\n\t\t}, 100 );\n\n\t\tfunction removePreSession() {\n\t\t\tresult.remove();\n\t\t\tresult = null;\n\n\t\t\tdeleteCookie( 'AlternateSessionData', LocalCacheData.cookie_path, Global.getHost() );\n\t\t}\n\n\t\tfunction backToPreSession() {\n\t\t\tvar host = Global.getHost();\n\t\t\ttry { //Prevent JS exception if we can't parse alternate_session_data for some reason.\n\t\t\t\tvar alternate_session_data = JSON.parse( getCookie( 'AlternateSessionData' ) );\n\t\t\t\tif ( !alternate_session_data ) {\n\t\t\t\t\tDebug.Text( 'No alternate_session_data exists.', 'TAlertManager.js', 'TAlertManager', 'backToPreSession', 10 );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} catch ( e ) {\n\t\t\t\tDebug.Text( e.message, 'TAlertManager.js', 'showPreSessionAlert', 'backToPreSession', 10 );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar url = alternate_session_data.previous_session_url;\n\t\t\tvar previous_cookie_path = alternate_session_data.previous_cookie_path;\n\n\t\t\talternate_session_data = {\n\t\t\t\tnew_session_id: alternate_session_data.previous_session_id,\n\t\t\t\tprevious_session_view: alternate_session_data.previous_session_view\n\t\t\t};\n\n\t\t\tsetCookie( 'AlternateSessionData', JSON.stringify( alternate_session_data ), 1, previous_cookie_path, host );\n\n\t\t\tGlobal.setURLToBrowser( url + '#!m=Login' );\n\t\t\tGlobal.needReloadBrowser = true;\n\n\t\t\tresult.remove();\n\t\t\tresult = null;\n\t\t}\n\t};\n\n\tvar showErrorAlert = function( result ) {\n\t\tvar details = result.getDetails();\n\n\t\tif ( details.hasOwnProperty( 'error' ) ) {\n\n\t\t}\n\t\tif ( !details ) {\n\t\t\tdetails = result.getDescription(); // If the details is empty, try to get description to show.\n\t\t}\n\t\tvar error_string = '';\n\n\t\tif ( Global.isArray( details ) || typeof details === 'object' ) {\n\t\t\terror_string = Global.convertValidationErrorToString( details );\n\t\t} else {\n\n\t\t\terror_string = details;\n\t\t}\n\n\t\tshowAlert( error_string, 'Error' );\n\n\t};\n\n\tvar showWarningAlert = function( result, callBack ) {\n\t\tvar details = result.getDetails();\n\t\tvar ul_container = $( '<ol>' );\n\t\tif ( Global.isArray( details ) || typeof details === 'object' ) {\n\t\t\t$.each( details, function( index, val ) {\n\t\t\t\tif ( val.hasOwnProperty( 'warning' ) ) {\n\t\t\t\t\tval = val.warning;\n\t\t\t\t}\n\t\t\t\tfor ( var key in val ) {\n\t\t\t\t\tvar li = $( '<li>' );\n\t\t\t\t\tvar child_val = val[key];\n\t\t\t\t\tvar has_child = false;\n\t\t\t\t\tfor ( var child_key in child_val ) {\n\t\t\t\t\t\tif ( child_val.hasOwnProperty( child_key ) ) {\n\t\t\t\t\t\t\thas_child = true;\n\t\t\t\t\t\t\tli = $( '<li>' );\n\t\t\t\t\t\t\tli.append( child_val[child_key] );\n\t\t\t\t\t\t\tul_container.append( li );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif ( !has_child ) {\n\t\t\t\t\t\tli.append( val[key] );\n\t\t\t\t\t\tul_container.append( li );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t\tvar div = $( '<div>' );\n\t\tvar p = $( '<p>' );\n\t\tp.append( $.i18n._( 'Are you sure you wish to save this record without correcting the above warnings?' ) );\n\t\tdiv.append( ul_container );\n\t\tdiv.append( p );\n\t\tshowConfirmAlert( div[0], $.i18n._( 'Warning' ), callBack, $.i18n._( 'Save' ), $.i18n._( 'Cancel' ) );\n\t};\n\n\tvar showAlert = function( content, title, callBack ) {\n\t\tif ( !title ) {\n\t\t\ttitle = $.i18n._( 'Message' );\n\t\t}\n\n\t\tvar result = $( '<div class=\"t-alert\">' +\n\t\t\t'<div class=\"content-div\"><span class=\"content\"></span></div>' +\n\t\t\t'<span class=\"title\"></span>' +\n\t\t\t'<div class=\"bottom-bar\">' +\n\t\t\t'<button class=\"t-button\" id=\"t-alert-close\">Close</button>' +\n\t\t\t'</div>' +\n\t\t\t'</div>' );\n\t\tsetTimeout( function() {\n\t\t\tif ( view !== null ) {\n\n\t\t\t\tvar cContent = view.find( '.content' ).text();\n\n\t\t\t\tif ( cContent === content ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tremove();\n\n\t\t\t}\n\t\t\tview = result;\n\t\t\t$( 'body' ).append( result );\n\t\t\tresult.find( '.title' ).text( title );\n\t\t\tresult.find( '.content' ).html( content );\n\t\t\tvar button = result.find( '.t-button' );\n\t\t\tbutton.bind( 'click', Global.debounce( function ConfirmClose( e ) {\n\t\t\t\tremove();\n\t\t\t\tif ( callBack ) {\n\t\t\t\t\tcallBack();\n\t\t\t\t}\n\t\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork(), true ) );\n\t\t\tbutton.focus();\n\t\t\tbutton.bind( 'keydown', function( e ) {\n\t\t\t\te.stopPropagation();\n\t\t\t\tif ( e.keyCode === 13 ) {\n\t\t\t\t\tremove();\n\t\t\t\t\tif ( callBack ) {\n\t\t\t\t\t\tcallBack();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tGlobal.setUIInitComplete();\n\t\t}, 100 );\n\n\t};\n\n\tvar showConfirmAlert = function( content, title, callBackFunction, yesLabel, noLabel ) {\n\n\t\tif ( !Global.isSet( title ) ) {\n\t\t\ttitle = $.i18n._( 'Message' );\n\t\t}\n\n\t\tif ( !Global.isSet( yesLabel ) ) {\n\t\t\tyesLabel = $.i18n._( 'Yes' );\n\t\t}\n\n\t\tif ( !Global.isSet( noLabel ) ) {\n\t\t\tnoLabel = $.i18n._( 'No' );\n\t\t}\n\n\t\tif ( view !== null ) {\n\n\t\t\tvar cContent = view.find( '.content' ).text();\n\n\t\t\tif ( cContent === content ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tremove();\n\t\t}\n\t\tvar result = $( '<div class=\"confirm-alert\"> ' +\n\t\t\t'<div class=\"content-div\"><span class=\"content\"></span></div>' +\n\t\t\t'<span class=\"title\"></span>' +\n\t\t\t'<div class=\"bottom-bar\">' +\n\t\t\t'<button id=\"yesBtn\" class=\"t-button bottom-bar-yes-btn\"></button>' +\n\t\t\t'<button id=\"noBtn\" class=\"t-button\"></button>' +\n\t\t\t'</div>' +\n\t\t\t'</div>' );\n\t\tview = result;\n\t\t$( 'body' ).append( result );\n\n\t\tresult.find( '#yesBtn' ).text( yesLabel );\n\t\tresult.find( '#noBtn' ).text( noLabel );\n\t\tresult.find( '.title' ).text( title );\n\n\t\tresult.find( '.content' ).html( content );\n\n\t\tresult.find( '#yesBtn' ).bind( 'click', Global.debounce( function AcceptConfirm( e ) {\n\t\t\tremove();\n\t\t\tcallBackFunction( true );\n\n\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork(), true ) );\n\n\t\tresult.find( '#noBtn' ).bind( 'click', Global.debounce( function DeclineConfirm( e ) {\n\t\t\tremove();\n\t\t\tcallBackFunction( false );\n\n\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork(), true ) );\n\n\t\tGlobal.setUIInitComplete();\n\t};\n\n\tvar showFlexAlert = function( title, content, form_type, form_data, callBackFunction, width, continue_label, cancel_label ) {\n\t\tGlobal.setUINotready();\n\n\t\tvar show_continue_button = true;\n\t\tvar show_cancel_button = true;\n\n\t\tif ( !continue_label ) {\n\t\t\tcontinue_label = $.i18n._( 'Continue' );\n\t\t}\n\n\t\tif ( !cancel_label ) {\n\t\t\tcancel_label = $.i18n._( 'Cancel' );\n\t\t}\n\n\t\tvar result = $( '<div class=\"confirm-alert\"> ' +\n\t\t\t'<div><span class=\"content\"></span></div>' +\n\t\t\t'<span class=\"title\"></span>' +\n\t\t\t'<div style=\"margin-top: 2rem; margin-bottom: 2rem\" id=\"form-holder\"></div>' +\n\t\t\t'<div style=\"margin-bottom: 1rem\" class=\"bottom-bar\">' +\n\t\t\t'<button id=\"yesBtn\" class=\"t-button bottom-bar-yes-btn\"></button>' +\n\t\t\t'<button id=\"noBtn\" class=\"t-button\"></button>' +\n\t\t\t'</div>' +\n\t\t\t'</div>' )\n\n\t\tif ( width ) {\n\t\t\tresult.css( 'width', width );\n\t\t}\n\n\t\tview = result;\n\t\t$( 'body' ).append( result );\n\n\t\tif ( form_type === 'dropdown' ) {\n\t\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\t\tform_item_input.TComboBox();\n\t\t\tform_item_input.setSourceData( form_data );\n\n\t\t\tresult.find( '#yesBtn' ).bind( 'click', Global.debounce( function AcceptConfirmDropdown( e ) {\n\t\t\t\tremove();\n\t\t\t\tcallBackFunction( result.find( 'select' ).val() );\n\t\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork(), true ) );\n\t\t} else if ( form_type === 'password' ) {\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.PASSWORD_INPUT );\n\t\t\tform_item_input.TPasswordInput();\n\n\t\t\tresult.find( '#yesBtn' ).bind( 'click', Global.debounce( function AcceptConfirmPassword( e ) {\n\t\t\t\tremove();\n\t\t\t\tcallBackFunction( result.find( '[type=password]' ).val() );\n\t\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork(), true ) );\n\t\t} else if ( form_type === 'text' ) {\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\tform_item_input.TTextInput();\n\t\t\tform_item_input.setValue( form_data );\n\n\t\t\tif ( width ) {\n\t\t\t\tform_item_input.width( ( width - 20 ) );\n\t\t\t}\n\n\t\t\tshow_cancel_button = false;\n\n\t\t\tresult.find( '#yesBtn' ).bind( 'click', Global.debounce( function AcceptConfirmText( e ) {\n\t\t\t\tremove();\n\t\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork(), true ) );\n\t\t} else if ( form_type === 'word_match' ) {\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\tform_item_input.TTextInput();\n\n\t\t\tresult.find( '#yesBtn' ).bind( 'click', Global.debounce( function AcceptConfirmWordMatch( e ) {\n\t\t\t\tif ( result.find( '[type=text]' ).val() === form_data ) {\n\t\t\t\t\tremove();\n\t\t\t\t\tcallBackFunction( true );\n\t\t\t\t} else {\n\t\t\t\t\tcallBackFunction( false );\n\t\t\t\t}\n\t\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork(), true ) );\n\t\t}\n\n\t\tresult.find( '#form-holder' ).append( form_item_input );\n\n\t\tresult.find( '#noBtn' ).bind( 'click', Global.debounce( function DeclineConfirm( e ) {\n\t\t\tremove();\n\t\t\tcallBackFunction( false );\n\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork(), true ) );\n\n\t\tresult.find( '#yesBtn' ).text( continue_label );\n\t\tresult.find( '#noBtn' ).text( cancel_label );\n\n\t\tresult.find( '.title' ).text( title );\n\t\tresult.find( '.content' ).html( content );\n\n\t\tif ( show_continue_button == false ) {\n\t\t\tresult.find( '#yesBtn' ).hide();\n\t\t}\n\n\t\tif ( show_cancel_button == false ) {\n\t\t\tresult.find( '#noBtn' ).hide();\n\t\t}\n\n\t\tGlobal.setUIInitComplete();\n\t};\n\n\n\tvar showModalAlert = function( category, step, callBackFunction, img_src ) {\n\t\tlet top_image = '';\n\t\tlet title = '';\n\t\tlet content = '';\n\t\tlet additional_body_style = '';\n\t\tlet additional_modal_style = '';\n\t\tlet button_label = $.i18n._( 'Yes' );\n\t\tlet button_color = '#228b22';\n\t\tlet button_disabled = false;\n\t\tlet creation_callback = null;\n\n\t\tif ( category === 'push_notification' ) {\n\t\t\ttop_image = '<img class =\"modal-alert-image\" src =\"' + Global.getRealImagePath( 'images/bell_permissions.svg' ) + '\">';\n\t\t\ttitle = $.i18n._( 'Turn on Notifications' );\n\n\t\t\tswitch ( step ) {\n\t\t\t\tcase 'ask':\n\t\t\t\t\tbutton_label = $.i18n._( 'Yes, turn on notifications!' );\n\t\t\t\t\tcontent = LocalCacheData.getCurrentCompany().name + ' ' + $.i18n._( 'wants permission to notify you of important messages or alerts related to your employment. You can change your notification settings at anytime.' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'wait_for_permission':\n\t\t\t\t\tbutton_label = $.i18n._( 'I don\\'t see it?' );\n\t\t\t\t\tbutton_color = '#AE0000';\n\t\t\t\t\t// Some browsers by default block push notification permission we need to detect them to show user a different prompt.\n\t\t\t\t\tif ( NotificationConsumer.detectBrowserNeedsExtraPermission() === true || Notification.permission === 'denied' ) {\n\t\t\t\t\t\t// User needs to enable push notifications on the browser.\n\t\t\t\t\t\tcontent = $.i18n._( 'A popup should appear on your screen, click \"ALLOW\" to enable notifications. If you don\\'t see it, you may need to enable notifications in your browser settings.' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontent = $.i18n._( 'A popup should appear on your screen, click \"ALLOW\" to enable notifications.' );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'help_text':\n\t\t\t\t\tbutton_label = $.i18n._( 'Ok, done!' );\n\t\t\t\t\tif ( Global.getBrowserVendor() === 'Edge' ) {\n\t\t\t\t\t\tcontent = $.i18n._( '1. Click the icon to the left of the address (URL) bar to view settings.<br>' +\n\t\t\t\t\t\t\t'2. Click \"Permissions for this Site\"<br>' +\n\t\t\t\t\t\t\t'3. To the right of \"Notifications\" set the option to \"ALLOW\".' );\n\t\t\t\t\t} else if ( Global.getBrowserVendor() === 'Firefox' ) {\n\t\t\t\t\t\tcontent = $.i18n._( '1. Click the icon to the left of the address (URL) bar to view settings.<br>' +\n\t\t\t\t\t\t\t'2. Click the \"X\" next Notifications to remove blocked permissions and then refresh the browser.<br>' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontent = $.i18n._( '1. Click the icon to the left of the address (URL) bar to view settings.<br>' +\n\t\t\t\t\t\t\t'2. Click \"Site settings\"<br>' +\n\t\t\t\t\t\t\t'3. To the right of \"Notifications\" set the option to \"ALLOW\".' );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t} else if ( category === 'multifactor_authentication' ) {\n\t\t\ttitle = $.i18n._( 'Multifactor Authentication Instructions' );\n\n\t\t\tswitch ( step ) {\n\t\t\t\tcase 'download_instructions':\n\t\t\t\t\tbutton_label = $.i18n._( 'Ok' );\n\t\t\t\t\tbutton_color = '#426d9d';\n\t\t\t\t\tadditional_body_style = 'style=\"display: block; padding-left: 2rem; padding-right: 2rem; font-size: 1.1rem;\"';\n\n\t\t\t\t\tcontent = '<br>';\n\t\t\t\t\tcontent += '1.' + $.i18n._( 'Please download the TimeTrex app from the App Store on your device.' ) + '<br><br>';\n\t\t\t\t\tcontent += '2.' + $.i18n._( ' Once installed, on the first step of the \"Setup Wizard\", tap the \"QR Code\" icon at the top right to scan the below QR Code.' ) + '<br>';\n\t\t\t\t\tcontent += '<img class =\"modal-alert-image\" style=\"margin-top: 10px;\" src =\"' + img_src + '\">';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t} else if ( category === 'custom_agreement' ) {\n\t\t\ttitle = $.i18n._( 'Custom Agreement' );\n\n\t\t\tswitch ( step ) {\n\t\t\t\tcase 'accept_terms':\n\t\t\t\t\tbutton_label = $.i18n._( 'Continue' );\n\t\t\t\t\t//greyed out\n\t\t\t\t\tbutton_color = '#808080';\n\t\t\t\t\tadditional_body_style = 'style=\"display: block; padding-left: 2rem; padding-right: 2rem; font-size: 1.1rem;\"';\n\t\t\t\t\tadditional_modal_style = 'style=\"height: 38rem;\"';\n\t\t\t\t\tbutton_disabled = true;\n\n\t\t\t\t\tcontent = '<br>';\n\t\t\t\t\tcontent += `1. ${$.i18n._( 'Please read the agreement below.' )}<br><br>\n\t\t\t\t\t\t\t\t2. ${$.i18n._( 'If you accept the terms, type \"Yes, I agree\" in the box below and click \"Continue\".' )}<br><br>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<div style=\"margin-top: 10px; margin-bottom: 10px; padding-left: 2rem; padding-right: 2rem;\">\n\t\t\t\t\t\t\t\t\t<textarea id=\"custom_agreement_text\" style=\"width: 100%; height: 200px; resize: none;\" readonly>\n\t\t\t\t\t\t\t\t\t\tLorem ipsum dolor sit amet, consectetur adipiscing elit\n\t\t\t\t\t\t\t\t\t\tVestibulum nec odio ipsum. Suspendisse cursus malesuada facilisis.\n\t\t\t\t\t\t\t\t\t\tProin ut ligula vel nunc egestas porttitor. Morbi lectus risus,\n\t\t\t\t\t\t\t\t\t</textarea>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<div style=\"margin-top: 10px; padding-left: 2rem; padding-right: 2rem;\">\n\t\t\t\t\t\t\t\t\t<input type=\"text\" id=\"custom_agreement_input\" style=\"width: 100%; height: 30px; resize: none;\" placeholder=\"Type 'Yes, I agree' here\"\">\n\t\t\t\t\t\t\t\t</div>`;\n\n\t\t\t\t\tcreation_callback = () => {\n\t\t\t\t\t\t$('#custom_agreement_input').on('input', function() {\n\t\t\t\t\t\t\tcheckCustomAgreementInput(this);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tGlobal.setUINotready();\n\n\t\tvar result = $( '<div class=\"modal-alert\"> ' +\n\t\t\t'<div class=\"modal-alert-content\" ' + additional_modal_style + '>' +\n\t\t\t'<span class=\"modal-alert-close\"></span>' +\n\t\t\ttop_image +\n\t\t\t'<h2 class=\"modal-alert-title\"></h2>' +\n\t\t\t'<div class=\"modal-alert-body\" ' + additional_body_style + '></div>' +\n\t\t\t'<button type=\"submit\" class=\"permission-button-yes\" style=\"background: ' + button_color + '\" ' + ( button_disabled ? 'disabled' : '' ) + '></button>' +\n\t\t\t'</div>' +\n\t\t\t'</div>' );\n\t\tview = result;\n\t\t$( 'body' ).append( result );\n\n\t\tresult.find( '.permission-button-yes' ).text( button_label );\n\t\tresult.find( '.modal-alert-title' ).text( title );\n\n\t\tresult.find( '.modal-alert-body' ).html( content );\n\n\t\tresult.find( '.permission-button-yes' ).bind( 'click', Global.debounce( function AcceptConfirm( e ) {\n\t\t\tremove();\n\t\t\tif ( callBackFunction ) {\n\t\t\t\tcallBackFunction( true );\n\t\t\t}\n\t\t\tGlobal.setUIReady();\n\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork(), true ) );\n\n\t\tresult.find( '.modal-alert-close' ).bind( 'click', Global.debounce( function DeclineConfirm( e ) {\n\t\t\tremove();\n\t\t\tif ( callBackFunction ) {\n\t\t\t\tcallBackFunction( false );\n\t\t\t}\n\t\t\tGlobal.setUIReady();\n\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork(), true ) );\n\n\t\tGlobal.setUIInitComplete();\n\n\t\tif (creation_callback) {\n\t\t\tcreation_callback();\n\t\t}\n\t};\n\n\tvar checkCustomAgreementInput = function( input ) {\n\t\tif ( input.value === 'Yes, I agree' ) {\n\t\t\t$( '.permission-button-yes' ).prop( 'disabled', false );\n\t\t\t$( '.permission-button-yes' ).css( 'background', '#426d9d' );\n\t\t} else {\n\t\t\t$( '.permission-button-yes' ).prop( 'disabled', true );\n\t\t\t$( '.permission-button-yes' ).css( 'background', '#808080' );\n\t\t}\n\t}\n\n\tvar remove = function() {\n\n\t\tif ( view ) {\n\t\t\tview.remove();\n\t\t\tview = null;\n\t\t}\n\n\t};\n\n\treturn {\n\t\tshowBrowserTopBanner: showBrowserTopBanner,\n\t\tcloseBrowserBanner: closeBrowserBanner,\n\t\tshowConfirmAlert: showConfirmAlert,\n\t\tshowModalAlert: showModalAlert,\n\t\tshowAlert: showAlert,\n\t\tshowErrorAlert: showErrorAlert,\n\t\tshowPreSessionAlert: showPreSessionAlert,\n\t\tshowFlexAlert: showFlexAlert,\n\t\tshowWarningAlert: showWarningAlert,\n\t\tshowNetworkErrorAlert: showNetworkErrorAlert\n\t};\n\n} )();\n","<template>\n    <div :class=\"containerClass\" :style=\"style\" :id=\"$attrs.id\">\n        <PVSButton type=\"button\" class=\"p-splitbutton-defaultbutton\" v-bind=\"$attrs\" :id=\"defaultButtonId\" :icon=\"icon\" :label=\"label\" :disabled=\"$attrs.disable_item\" @click=\"onDefaultButtonClick\" />\n        <PVSButton type=\"button\" class=\"p-splitbutton-menubutton\" :id=\"$attrs.id+'-split-menu'\" icon=\"pi pi-chevron-down\" @click=\"onDropdownButtonClick\" :disabled=\"$attrs.disable_menu\"\n                   aria-haspopup=\"true\" :aria-controls=\"ariaId + '_overlay'\"/>\n        <PVSMenu :id=\"ariaId + '_overlay'\" ref=\"menu\" :model=\"model\" :popup=\"true\" :autoZIndex=\"autoZIndex\"\n                 :baseZIndex=\"baseZIndex\" :appendTo=\"appendTo\" />\n    </div>\n</template>\n\n<script>\n/* Copied from primevue version 3.1.1 */\n/* This has been modified from the original PrimeVue SplitButton in order to add customizations to the disable state logic and allow the active button disabling to be independant from the dropdown arrow. */\nimport Button from 'primevue/button';\nimport Menu from 'primevue/menu';\nimport {UniqueComponentId} from 'primevue/utils';\n\nexport default {\n    inheritAttrs: false,\n    props: {\n        label: {\n            type: String,\n            default: null\n        },\n        icon: {\n            type: String,\n            default: null\n        },\n        model: {\n            type: Array,\n            default: null\n        },\n        autoZIndex: {\n            type: Boolean,\n            default: true\n        },\n        baseZIndex: {\n            type: Number,\n            default: 0\n        },\n        appendTo: {\n            type: String,\n            default: 'body'\n        },\n        class: null,\n        style: null\n    },\n    methods: {\n        onDropdownButtonClick() {\n            this.$refs.menu.toggle({currentTarget: this.$el});\n        },\n        onDefaultButtonClick() {\n            this.$refs.menu.hide();\n        }\n    },\n    computed: {\n        ariaId() {\n            return UniqueComponentId();\n        },\n        containerClass() {\n            return ['p-splitbutton p-component', this.class];\n        },\n        defaultButtonId() {\n            return this.$attrs.id.replace('context-group', 'context-button');\n        },\n    },\n    components: {\n        'PVSButton': Button,\n        'PVSMenu': Menu\n    }\n}\n</script>\n\n<style scoped>\n.p-splitbutton {\n    display: inline-flex;\n    position: relative;\n}\n\n.p-splitbutton .p-splitbutton-defaultbutton {\n    flex: 1 1 auto;\n    border-top-right-radius: 0;\n    border-bottom-right-radius: 0;\n    border-right: 0 none;\n}\n\n.p-splitbutton-menubutton {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0;\n}\n\n.p-splitbutton .p-menu {\n    min-width: 100%;\n}\n\n.p-fluid .p-splitbutton  {\n    display: flex;\n}\n</style>\n","<template>\n    <SplitButton :label=\"active_item.label\" :icon=\"active_item.icon\" :model=\"parsed_items\" @click=\"active_item.command\" :disable_item=\"active_item.disabled\" :disable_menu=\"disable_menu\"></SplitButton>\n</template>\n\n<script>\nimport SplitButton from './PrimeVueSplitButton'; // Moved SplitButton into TT codebase as we needed to adjust the disabled button states.\n\nexport default {\n    name: \"TTSplitButton\",\n    props: {\n        items: Array\n    },\n    data() {\n        return {\n            disable_active_toggle: false, // If true, then active_item_index will not change upon menu selection. Likely used in conjunction with force_active_index.\n            active_item_index: 0,\n        }\n    },\n    computed: {\n        disable_menu() {\n            // FIX: Menu must be disabled independantly via computed disable_menu, as previously it was done in firstEnabledItemIndex function which was not always called on data updates if first item was enabled.\n            if( this.firstEnabledItemIndex === -1 ) {\n                // -1 means no enabled items found, so lets disable the whole menu.\n                return true;\n            } else {\n                // At least one enabled item found, enable the menu dropdown arrow.\n                return false;\n            }\n        },\n        parsed_items() {\n            // Converted this to a computed function from data, to ensure its recalculated. If this does not solve context icons updating, then look into Vue.set\n            // This should re-run each time the data changes\n            return this.parseItemArrayCommands(this.items);\n        },\n        active_item() {\n            // Active item logic has been modified to be overridden in certain situations like Export/Import.\n            // You can choose to force the active item default by setting menu_force_active to true on the item definition.\n            // You can also choose to disable the active item toggling when an option is selected from the menu. By default, if the above flag is used, toggling will also be disabled. Adjust this below.\n\n            var force_active_item_index = this.findForceActiveItemIndex();\n            if( force_active_item_index !== -1 ) {\n                // !== -1 means it found a menu_force_active flag\n                this.disable_active_toggle = true; // For now we will also disable toggle behaviour as this is the only need for this combo. Remove this line if you only want to set default but allow toggle changes.\n                this.active_item_index = force_active_item_index;\n            } else {\n                // -1 means no menu_force_active flag was found on any of the items, so lets find the first enabled item to make active.\n                if ( this.items[this.active_item_index].disabled === true && !this.items[this.active_item_index].freeze_active_item ) {\n                    if ( this.firstEnabledItemIndex === -1 ) {\n                        // No enabled items found, return 0 to label the menu by the first item in the array. Menu will be disabled via computed disable_menu function.\n                        this.active_item_index = 0;\n                    } else {\n                        // Successfully found the first enabled item.\n                        this.active_item_index = this.firstEnabledItemIndex;\n                    }\n                }\n            }\n\n            //Button can be temporarily set to freeze the active item. This stops the active split button item from resetting.\n            //Example if doing \"Save & Continue\" we do not want the button to switch back to \"Save\" just because validation failed.\n            //Being reset here as we only want the freeze temporarily. If in the future this causes issues, the setting of false could be moved\n            //elsewhere to prevent any race conditions with order of events - although there are none I am aware of currently.\n            this.items[this.active_item_index].freeze_active_item = false;\n\n            return {\n                label: this.getParsedLabel( this.active_item_index ),\n                icon: this.getParsedIcon( this.active_item_index ),\n                command: this.getParsedCommand( this.active_item_index ),\n                disabled: this.getParsedDisabledState( this.active_item_index ),\n            };\n        },\n        firstEnabledItemIndex() {\n            // Find first enabled item in array. In most cases, should be 0, but not if item zero happens to be disabled, as it would end up being shown as enabled.\n            // If index=null, then this is on first load, so calculate which item should be the active one.\n\n            var enabled = ( element ) => element.disabled !== true;\n            var find_result = this.items.findIndex( enabled );\n\n            return find_result;\n        },\n    },\n    methods: {\n        parseItemArrayCommands( items_array ) {\n            // Have to do this, currently see no neater way to detect when a button menu item has been clicked.\n            let new_array = items_array.map((item, item_index) => {\n                // The below is technically a Vue anti-pattern, as we are in effect also modifying the parent data.\n                // Normally data goes parent => child components, and events go child => parent. And then its up to the parent to handle that event to update data where needed.\n                // But in this case, we just want to manipulate data before it goes further down the line, but due to JS pass by reference, the parent gets updated here too.\n                // Perhaps fix this later on, after a Proof of concept for the SplitButtons has been achieved.\n\n                // Creating a shallow copy of the item to avoid mutating the parent data.\n                // This is important to prevent side effects in Vue's reactivity system and infinite recursion with computed properties.\n                let new_item = { ...item };\n\n                let original_command = item.command;\n                new_item.command = Global.debounce( () => {\n                    // Intercept the item click before running the original command as normal.\n                    this.updateActiveButton( item_index );\n                    original_command( item ); // trigger the original command, and pass in the item.id of the button icon. TODO: item.id is non-generic logic. Not ideal for a 'dumb' component.\n                }, Global.calcDebounceWaitTimeBasedOnNetwork(), true );\n                return new_item;\n            });\n            return new_array;\n        },\n        getParsedCommand( index ) {\n            return this.parsed_items[ index ].command;\n        },\n        getParsedLabel( index ) {\n            return this.parsed_items[ index ].label;\n        },\n        getParsedIcon( index ) {\n            return this.parsed_items[ index ].icon;\n        },\n        getParsedDisabledState( index ) {\n            return this.parsed_items[ index ].disabled;\n        },\n        updateActiveButton( new_active_item_index ) {\n            if ( this.disable_active_toggle === false ) {\n                // Only update the active button to last action if active toggle is not disabled.\n                this.active_item_index = new_active_item_index;\n                for ( let i = 0; i < this.items.length; i++ ) {\n                    //Setting split_button_active_item so that from other areas of code we can know if the user selected an item.\n                    //This is currently used doing error validation so we can check if a user selected an item and freeze it.\n                    //For example if doing \"Save & Continue\" and validation error happens, we do not want to switch\n                    //the button back to to \"Save\". But that would happen as the item is disabled while validation fails.\n                    if ( i === this.active_item_index ) {\n                        this.items[i].split_button_active_item = true;\n                    } else {\n                        this.items[i].split_button_active_item = false;\n                    }\n                }\n            }\n        },\n        findForceActiveItemIndex() {\n            var menu_force_active = ( element ) => element.menu_force_active === true;\n            var filtered_items = this.items.filter( menu_force_active );\n            var first_index = this.items.findIndex( menu_force_active );\n\n            if( filtered_items.length === 1 ) {\n                return first_index;\n            } else if( filtered_items.length > 1 ) {\n                Debug.Error( 'Error: More than one Force Active flag found, defaulting to normal splitbutton behaviour.', 'TTSplitButton.vue', 'TTSplitButton', 'findForceActiveItem', 1 );\n                return -1;\n            } else {\n                // No force active flags found, treat as normal item.\n                return -1;\n            }\n        }\n    },\n    components: {\n        SplitButton\n    }\n};\n</script>\n\n<style scoped>\n</style>\n","<template>\n    <div class=\"tt-overlaymenu\" v-if=\"items[0].visible !== false && items.length > 1\">\n        <Menu ref=\"menu\" :model=\"wrapped_items_without_header\" :popup=\"true\" appendTo=\"body\"/>\n        <Button class=\"menu-button\" type=\"button\" :label=\"items[0].label\" :icon=\"!items[0].label ? items[0].icon : 'pi pi-chevron-down'\" iconPos=\"right\" @click=\"toggleMenu\"/>\n    </div>\n</template>\n\n<script>\n/**\n * This is a special version of the split-button menu, using the overlay menu, which has a header instead of the currently 'active' action button.\n * So where the click of a 'Save & Next' button in a menu will swap the active button to Save & Next, clicking a menu item in a Navigation menu, will leave the label as Navigation.\n * As there is no 'active action' the label and menu open button are one button, instead of split.\n * There are two ways of making an action group menu with a header.\n * 1) Define a header in the getCustomContextMenuModel function or similar, setting action_group and action_group_header. Like TimeSheet Navigation menu.\n * 2) Define a single object in getCustomContextMenuModel, setting the action_group and action_group_header, and then including an 'items' array containing your sub menu items. Like TimeSheet Print menu.\n * Having 2 options is more complicated, but its there to stay compatible with the legacy context menu. Option 1 is needed to stay compatible with the Save, Delete, and Navigation groups. And Option 2 is needed for the way the old menu defined items like the Print menu.\n * Once the old menu and format is gone, we can refactor to simplify this behaviour.\n * Note: permission_result: false is needed on the header items to make sure the old menu ignores this item.\n * Note: the \"v-if && items.length > 1\" portion above is to ensure that the menu button is hidden if the items list contains only the header and nothing else. Hence the more than 1 criteria.\n */\n\nimport Menu from 'primevue/menu';\nimport Button from 'primevue/button';\n\nexport default {\n    name: \"TTOverlayMenuButton\",\n    props: {\n        items: [Array, Object],\n    },\n    computed: {\n        wrapped_items_without_header() {\n            return this.wrapItemCommands(this.items).slice(1); // We slice 1st item away so that the header item is not included. TODO: This means visible: false is no longer needed on the header, remove this from all code.\n        }\n    },\n    methods: {\n        toggleMenu(event) {\n            this.$refs.menu.toggle(event);\n        },\n        wrapItemCommands( items_array ) {\n            // TODO: Consolidate this with the function in TTSplitButton (maybe in TTContextButton), and the command function in ContextMenuManager.convertBackBoneMenuModelToPrimeVue so that we are not parsing the command functions in more than one place.\n            // Have to do this, currently see no quick way to detect when a button menu item has been clicked.\n            var new_array = items_array.map((item, item_index) => {\n                // The below is technically a Vue anti-pattern, as we are in effect also modifying the parent data.\n                // Normally data goes parent => child components, and events go child => parent. And then its up to the parent to handle that event to update data where needed.\n                // But in this case, we just want to manipulate data before it goes further down the line, but due to JS pass by reference, the parent gets updated here too.\n                // Perhaps fix this later on, after a Proof of concept for the SplitButtons has been achieved.\n\n                // Creating a shallow copy of the item to avoid mutating the parent data.\n                // This is important to prevent side effects in Vue's reactivity system and infinite recursion with computed properties.\n                let new_item = { ...item };\n\n                var original_command = item.command;\n                new_item.command = Global.debounce( () => {\n                    // Intercept the item click before running the original command as normal.\n                    original_command( item.id ); // trigger the original command, and pass in the item.id of the button icon. TODO: item.id is non-generic logic. Not ideal for a 'dumb' component.\n                }, Global.calcDebounceWaitTimeBasedOnNetwork(), true );\n                return new_item;\n            } );\n            return new_array;\n        },\n    },\n    components: {\n        Menu,\n        Button\n    }\n};\n</script>\n\n<style scoped>\n.tt-overlaymenu { /* Copy the p-splitbutton CSS to allow in-line display */\n    display: inline-flex;\n}\n.menu-button {\n    width: 100%;\n}\n</style>\n","<template>\n    <div class=\"tt-overlay-multi-select-menu\" v-if=\"items.some( item => item.visible === true || item.visible === undefined )\" :disabled=\"items.every( item => item.disabled === true )\">\n        <Menu ref=\"menu\" :model=\"wrapped_items\" :popup=\"true\" appendTo=\"body\"/>\n        <Button class=\"menu-button\" type=\"button\" :label=\"get_menu_label\" :icon=\"!showGroupLabel() ? items[0].vue_icon : 'pi pi-chevron-down'\" iconPos=\"right\" @click=\"toggleMenu\"/>\n    </div>\n</template>\n\n<script>\n\nimport Menu from 'primevue/menu';\nimport Button from 'primevue/button';\n\nexport default {\n    name: \"TTOverlayMultiSelectButton\",\n    props: {\n        items: Array,\n    },\n    computed: {\n        wrapped_items() {\n            return this.wrapItemCommands(this.items);\n        },\n        get_menu_label() {\n\n            if ( !this.showGroupLabel() ) {\n                return '';\n            }\n\n            // Filter out all active items, and if none, then set the default as shown in the last line (action_group id).\n            return this.items\n                .filter(( element ) => element.active )\n                .map(( element ) => element.label)\n                .join(', ')\n                || this.items[0].action_group; // Sets default label as action_group for fallback. Can't simply be first item in array, as the view controller data wont match this.\n        }\n    },\n    methods: {\n        toggleMenu(event) {\n            this.$refs.menu.toggle(event);\n        },\n        wrapItemCommands( items_array ) {\n            // TODO: Consolidate this with the function in TTSplitButton (maybe in TTContextButton), and the command function in ContextMenuManager.convertBackBoneMenuModelToPrimeVue so that we are not parsing the command functions in more than one place.\n            // Have to do this, currently see no quick way to detect when a button menu item has been clicked.\n            var new_array = items_array.map((item, item_index) => {\n\n                if( item.active === true ) {\n                    this.setItemActive( item );\n                } else {\n                    this.setItemInactive( item ); // Set all default item states to inactive, so that they get the correct active false flag, but also the correct inactive icon class to display in the menu.\n                }\n\n                // Copied from TTOverlayButton.vue\n                // The below is technically a Vue anti-pattern, as we are in effect also modifying the parent data.\n                // Normally data goes parent => child components, and events go child => parent. And then its up to the parent to handle that event to update data where needed.\n                // But in this case, we just want to manipulate data before it goes further down the line, but due to JS pass by reference, the parent gets updated here too.\n                // Perhaps fix this later on, after a Proof of concept for the SplitButtons has been achieved.\n\n                //this.onSelectionClick was being set and triggered multiple times.\n                //This caused some buttons such as Schedule -> Drag & Drop: Overwrite to not trigger properly until user clicked multiple times.\n                //For now just making sure not to set the same command multiple times.\n                if ( !item.command_set ) {\n                    var original_command = item.command;\n                    item.command = Global.debounce( () => {\n                        this.onSelectionClick( item );\n                        original_command( item.id ); // trigger the original command, and pass in the item.id of the button icon. TODO: item.id is non-generic logic. Not ideal for a 'dumb' component.\n                    }, Global.calcDebounceWaitTimeBasedOnNetwork(), true );\n                    item.command_set = true;\n                }\n\n                // add a setActive and setDeactivated command which can be called from parent components, that sets itself active, and other options inactive. Alternatively could also be done as a child to parent emit, but then harder to tie into EventBus events.\n                item.setOnlySelfActive = () => {\n                    this.setOnlyOneActive( item );\n                }\n                item.setOnlySelfDeactivated = () => {\n                    this.setOnlyOneDeactivated( item );\n                }\n\n                // check if there is an existing flag for default active item.\n                if( item.default_active_item ) {\n                    item.setOnlySelfActive();\n                }\n\n                return item;\n            });\n            return new_array;\n        },\n        onSelectionClick( item ) {\n            // Check if the number of items in the group equals one. If so, then just toggle states.\n            if ( this.isSingleGroupItem( item ) ) {\n                this.toggleActive( item );\n            } else {\n                // We want to ensure only one active item at a time.\n                this.setOnlyOneActive( item );\n            }\n        },\n        toggleActive( item ) {\n            if ( item.active ) {\n                this.setItemInactive( item )\n            } else {\n                this.setItemActive( item );\n            }\n        },\n        setOnlyOneActive( item ) {\n            this.items.map(( element ) => {\n                // Ensure we only clear the ones from the same group.\n                if( element.multi_select_group === item.multi_select_group ) {\n                    this.setItemInactive( element );\n                }\n            });\n            this.setItemActive( item );\n        },\n        setOnlyOneDeactivated( item ) {\n            this.setItemInactive( item );\n        },\n        setItemActive( item ) {\n            if ( this.isSingleGroupItem( item ) ) {\n                item.icon = 'tticon tticon-show-in-dropdown tticon-check_box_black_24dp ';\n            } else {\n                item.icon = 'tticon tticon-show-in-dropdown tticon-radio_button_checked_black_24dp';\n            }\n            item.active = true;\n        },\n        setItemInactive( item ) {\n            if ( this.isSingleGroupItem( item ) ) {\n                item.icon = 'tticon tticon-show-in-dropdown tticon-check_box_outline_blank_black_24dp ';\n            } else {\n                item.icon = 'tticon tticon-show-in-dropdown tticon-radio_button_unchecked_black_24dp';\n            }\n            item.active = false;\n        },\n        getItemById( find_item_id ) {\n            return this.items.find( element => element.id === find_item_id );\n        },\n        isSingleGroupItem( item ) {\n            //Check if select belongs to a group or is a Single-selection. Single-selection is displayed as a checkbox.\n            var group_count = this.items.filter( ( element ) => element.multi_select_group === item.multi_select_group ).length;\n            return group_count === 1;\n        },\n        showGroupLabel() {\n            if ( this.items.some( item => item.no_group_label ) ) {\n                return false;\n            }\n            return true;\n        }\n    },\n    components: {\n        Menu,\n        Button\n    }\n};\n</script>\n\n<style scoped>\n.tt-overlaymenu { /* Copy the p-splitbutton CSS to allow in-line display */\n    display: inline-flex;\n}\n.menu-button {\n    width: 100%;\n}\n</style>\n","<template>\n    <component\n        v-if=\"valid_types_for_dynamic_component.includes( parseItem.type ) && filterVisibleItems.count !== 0\"\n        :is=\"parseItem.type\"\n        :id=\"'context-button-'+parseItem.id\"\n        class=\"menu-item\"\n        :items=\"parseItem.items\">\n    </component>\n    <li\n        v-else-if=\"parseItem.separator === true\"\n        class=\"menu-separator\">\n    </li>\n    <div\n        v-else-if=\"parseItem.type === 'PrimeVueButton'\"\n        class=\"menu-item\">\n        <PrimeVueButton\n            :label=\"parseItem.label\"\n            @click=\"parseItem.click_handler\"\n            :style=\"parseItem.style\"\n            :icon=\"parseItem.icon\"\n            :id=\"'context-button-'+parseItem.id\"\n            :disabled=\"parseItem.disabled\">\n        </PrimeVueButton>\n    </div>\n</template>\n\n<script>\nimport PrimeVueButton from 'primevue/button';\nimport TTSplitButton from '@/components/context_menu/TTSplitButton';\nimport TTOverlayMenuButton from '@/components/context_menu/TTOverlayMenuButton';\nimport TTOverlayMultiSelectButton from '@/components/context_menu/TTOverlayMultiSelectButton';\n\nexport default {\n    name: \"TTContextButton\",\n    props: {\n        items: Array,\n    },\n    data() {\n        return {\n            valid_types_for_dynamic_component: ['TTOverlayMenuButton', 'TTSplitButton', 'TTOverlayMultiSelectButton'],\n        }\n    },\n    components: {\n        TTOverlayMenuButton,\n        PrimeVueButton,\n        TTSplitButton,\n        TTOverlayMultiSelectButton\n    },\n    computed: {\n        parseItem() {\n            // Make sure the returned menu type is listed in the 'vue components' object above.\n\n            let ret_val;\n\n            if( !this.items.length ) {\n                Debug.Error( 'Invalid icon format. No length value.', 'TTContextButton.vue', 'TTContextButton', 'parseItem', 1 );\n                return {\n                    type: 'invalid'\n                };\n            }\n\n            // Multi-select Overlay button\n            if ( this.items.length > 1 && this.items[0].multi_select_group ) {\n                ret_val = {\n                    type: 'TTOverlayMultiSelectButton',\n                    items: this.items,\n                    id: this.items[0].id,\n                };\n            }\n\n            // Overlay button\n            else if ( this.items.length > 1 && this.items[0].action_group_header ) {\n                ret_val = {\n                    type: 'TTOverlayMenuButton',\n                    items: this.items,\n                    id: this.items[0].id,\n                };\n            }\n\n            // button - split button single visible. Could also be a single item too.\n            else if ( this.filterVisibleItems.count === 1 ) {\n                ret_val = {\n                    type: 'PrimeVueButton',\n                    label: this.filterVisibleItems.items[0].label,\n                    click_handler: Global.debounce( () => {\n                        this.filterVisibleItems.items[0].command( this.filterVisibleItems.items[0] );\n                    }, Global.calcDebounceWaitTimeBasedOnNetwork(), true ),\n                    style: { 'min-width': this.filterVisibleItems.items[0].min_width + 'px' },\n                    icon: this.filterVisibleItems.items[0].icon,\n                    disabled: ( this.filterVisibleItems.items[0].disabled === true ),\n                    id: this.filterVisibleItems.items[0].id,\n                };\n            }\n\n            // split button for action groups - both useable and all items disabled.\n            // Show grouped items always as SplitButton, even if only one item is enabled. This is to avoid icon sizes jumping around when the dropdown is added/removed. We cant simply add/remove padding to account for lost space, as they are different items and text would also not be in the same place/centered.\n            else if ( this.filterVisibleItems.count > 1 ) {\n                ret_val = {\n                    type: 'TTSplitButton',\n                    items: this.items,\n                    id: this.items[0].id,\n                };\n            }\n\n            // Deprecated. Remove after testing (29/04/2021) This should now no longer be needed, button handler above should work for all required cases.\n            // actual single button - likely disabled\n            // else if ( this.items.length === 1 && this.items[0].visible !== false ) {\n            //     ret_val = {\n            //         type: 'PrimeVueButton',\n            //         label: this.items[0].label,\n            //         click_handler: () => this.items[0].command( this.items[0].id ),\n            //         style: { 'min-width': this.items[0].min_width + 'px' },\n            //         disabled: (this.items[0].disabled === true ),\n            //     };\n            // }\n\n            // fallback - no matches - could just not be visible.\n            else {\n                Debug.Text( 'No menu type criteria matched. Could be invisible menu item.', 'TTContextButton.vue', 'TTContextButton', 'parseItem', 11 );\n                // console.log( '', this.items );\n                ret_val = {\n                    type: 'no-match'\n                };\n            }\n\n            return ret_val;\n        },\n        filterVisibleItems() {\n            var items = this.items;\n            var visible = ( element ) => element.visible !== false;\n            var not_group_header = ( element ) => element.action_group_header !== true;\n            var not_single_separator = ( element ) => element.separator !== true;\n            var filtered_items = items.filter( visible ).filter( not_group_header ).filter( not_single_separator );\n            return {\n                items: filtered_items,\n                count: filtered_items.length\n            };\n        }\n    },\n    methods: {\n    }\n};\n</script>\n<!-- To fix the Attendance->TimeSheet wrapping on New Punch, you can apply white-space: nowrap; to the p-button-label -->\n<style scoped>\n.menu-item {\n    /*flex: 1 1 0; !* Uncomment to spread out the buttons at equal sized. This together with the styles in TTContextMenu.vue will make all the buttons the same size, regardless of internal padding *!*/\n    /*margin-top: 5px;*/ /* Removed the top padding to make it more balanced until we decide how these buttons will look, as bottom padding cannot be applied simply, due to it looking odd when an edit view is open. */\n    margin-left: 5px;\n}\n.menu-item:first-child {\n    margin-left: 0; /* outer padding controlled by overall .context-menu-bar */\n}\n::v-deep(.p-button) {\n    height: 100%; /* To ensure the max available height is used, and then all menu buttons will be same height (without this, splitbutton is taller than single button) */\n    background: #fff; /* Previously #f8f9fa but the contrast against the background was not great. */\n    color: #32689b; /* This will also set the icon colour to this. */\n    border-color: #e1e1e1; /* add outline to the vue context menu buttons. improves splitbutton visual. */\n    padding: 0.4rem 0.6rem; /* To match figma design */\n}\n::v-deep(.p-button .p-button-label) {\n    color: #3b3b3b;\n    text-align: left; /* Edit button label looks odd if centered with the extra width for mass edit. left align looks better. */\n}\n::v-deep(.p-button:enabled:hover .p-button-label) {\n    color: #fff;\n}\n::v-deep(.p-button):disabled {\n    opacity: .4; /* Previously 0.6 same as .p-component:disabled, but the contrast against enabled and contextmenu background was not good enough. */\n    color: #cacaca;\n    border-color: #cacaca;\n}\n/* Works together with the dynamic class for item.action_group_id set in TTContextMenu.vue Perhaps refactor to be JS based with a v-if */\n/*.sub-view .menu-item.left-cancelIcon,*/\n/*.sub-view .menu-item.center-cancelIcon,*/\n/*.sub-view .menu-item.right-cancelIcon {*/\n/*    display: none; !* Cancel button is not applicable on subview menus *!*/\n/*}*/\n</style>\n","<template>\n    <div class=\"context-menu-bar\">\n        <div class=\"left-container\">\n            <TTContextButton :id=\"'context-group-'+item.items[0].id\" :class=\"[dynamicClasses.nowrap, item.action_group_id]\" v-for=\"item in alignItems.left\" :items=\"item.items\" />\n        </div>\n        <div class=\"center-container\">\n            <TTContextButton :id=\"'context-group-'+item.items[0].id\" :class=\"[dynamicClasses.nowrap, item.action_group_id]\" v-for=\"item in alignItems.center\" :items=\"item.items\" />\n        </div>\n        <div class=\"right-container\">\n            <TTContextButton :id=\"'context-group-'+item.items[0].id\" :class=\"[dynamicClasses.nowrap, item.action_group_id]\" v-for=\"item in alignItems.right\" :items=\"item.items\" />\n        </div>\n    </div>\n</template>\n\n<script>\nimport TTContextButton from '@/components/context_menu/TTContextButton';\n// Note: No longer need to import the context menu manager, as we only respond to events generated from it.\n\nexport default {\n    name: \"TTContextMenu\",\n    created() {\n        this.event_bus = new TTEventBus( {\n            component_id: this.component_id + this.menu_id, //Context menu is unique to each view and is removed when the view is closed.\n        } );\n        // Debug.Text( 'Context menu created.', 'TTContextMenu.vue', 'TTContextMenu', 'created', 10 );\n\n        /*\n         * Init event listeners with EventBus to handle data coming from outside the component/Vue.\n         */\n\n        /* -------- Event Listener for MENU updates -------- */\n        let onUpdateMenu = function ( event_data ) {\n            // If the view id changes when the menu is re-built, update current view id. Only menu update should change active view id.\n            // if( this.active_view_id !== event_data.view_id ) {\n            //     // Debug.Highlight('Active view for context menu updated to: '+event_data.view_id+', previous was: '+ this.active_view_id);\n            //     this.active_view_id = event_data.view_id;\n            // }\n\n            if( this.menu_id === event_data.menu_id ) {\n                // Debug.Highlight('Context menu update received for: '+ event_data.menu_id, event_data );\n                Debug.Text( 'Contextmenu\\n MENU update RECEIVED for: '+ event_data.menu_id, 'TTContextMenu.vue', 'TTContextMenu', 'created:EventBus:update_context_menu', 11 );\n                this.rebuildMenu( event_data.menu_model );\n            } else {\n                Debug.Warn( 'Error: Context Menu update does not match menu id.\\nThis menu:  '+ this.menu_id +'\\nEvent menu: '+event_data.menu_id, 'TTContextMenu.vue', 'TTContextMenu', 'created:EventBus:update_context_menu', 11 );\n            }\n        }.bind(this); // Must bind to this at variable definition, not in the EventBus on/off as each .bind creates a new function reference, so it wont be able to match up on delete.\n\n        // EventBus.on( this.viewId + '.updateContextMenu', ( event_data ) => {\n        this.event_bus.on( this.component_id, 'update_context_menu', onUpdateMenu, TTEventBusStatics.AUTO_CLEAR_ON_EXIT  );\n\n        /* -------- Event Listener for ITEM updates -------- */\n        let onUpdateItem = function( event_data ) {\n            if( this.menu_id === event_data.menu_id ) {\n                Debug.Text( 'Contextmenu\\n ITEM update RECEIVED for: '+ event_data.menu_id + ':' + event_data.item_id, 'TTContextMenu.vue', 'TTContextMenu', 'created:EventBus:update_item', 11 );\n                this.updateMenuItem( event_data.item_id, event_data.item_attributes );\n            } else {\n                // If the view id does not match active view, then ignore the update, as its probably the previous view.\n                // Must ignore update if no match, otherwise item updates from old and new view will conflict and context menu items may then not display as expected. (BugFix: TimeSheet->JumpTo->AddRequest->Cancel. Visible icons not as expected. Cancel icon not disabled).\n                Debug.Warn( 'Error: Context Menu Item update does not match menu id.\\nThis menu:  '+ this.menu_id +'\\nEvent menu: '+event_data.menu_id, 'TTContextMenu.vue', 'TTContextMenu', 'created:EventBus:updateItem', 11 );\n            }\n        }.bind(this); // Must bind to this at variable definition, not in the EventBus on/off as each .bind creates a new function reference, so it wont be able to match up on delete.\n\n\n        // EventBus.on( this.viewId + '.updateItem', ( event_data ) => {\n        this.event_bus.on( this.component_id, 'update_item', onUpdateItem, TTEventBusStatics.AUTO_CLEAR_ON_EXIT  );\n\n        /* -------- Event Listener for MULTISELECTITEM updates -------- */\n        let onActivateMultiSelectItem = function( event_data ) {\n            if( this.menu_id === event_data.menu_id ) {\n                Debug.Text( 'Contextmenu\\n MULTI_ITEM update RECEIVED for: '+ event_data.menu_id + ':' + event_data.item_id, 'TTContextMenu.vue', 'TTContextMenu', 'created:EventBus:activate_multi_select_item', 11 );\n                this.activateMultiSelectItem( event_data.item_id );\n            } else {\n                // If the view id does not match active view, then ignore the update, as its probably the previous view.\n                // Must ignore update if no match, otherwise item updates from old and new view will conflict and context menu items may then not display as expected. (BugFix: TimeSheet->JumpTo->AddRequest->Cancel. Visible icons not as expected. Cancel icon not disabled).\n                Debug.Warn( 'Error: Context Menu Multi-select Item activation does not match menu id.\\nThis menu:  '+ this.menu_id +'\\n Event menu: '+event_data.menu_id+' )', 'TTContextMenu.vue', 'TTContextMenu', 'created:EventBus:activate_multi_select_item', 11 );\n            }\n        }.bind(this); // Must bind to this at variable definition, not in the EventBus on/off as each .bind creates a new function reference, so it wont be able to match up on delete.\n\n        this.event_bus.on( this.component_id, 'activate_multi_select_item', onActivateMultiSelectItem, TTEventBusStatics.AUTO_CLEAR_ON_EXIT  );\n\n        /* -------- Event Listener for SPLITBUTTON updates -------- */\n        let onActivateSplitButtonItem = function( event_data ) {\n            if ( this.menu_id === event_data.menu_id ) {\n                Debug.Text( 'Contextmenu\\n SPLIT BUTTON update RECEIVED for: ' + event_data.menu_id + ':' + event_data.item_id, 'TTContextMenu.vue', 'TTContextMenu', 'created:EventBus:activate_split_button_item', 11 );\n                this.activateSplitButtonItem( event_data.item_id );\n            } else {\n                // If the view id does not match active view, then ignore the update, as its probably the previous view.\n                Debug.Warn( 'Error: Context Menu Split Button Item activation does not match menu id.\\nThis menu:  ' + this.menu_id + '\\n Event menu: ' + event_data.menu_id + ' )', 'TTContextMenu.vue', 'TTContextMenu', 'created:EventBus:activate_split_button_item', 11 );\n            }\n        }.bind( this ); // Must bind to this at variable definition, not in the EventBus on/off as each .bind creates a new function reference, so it wont be able to match up on delete.\n\n        this.event_bus.on( this.component_id, 'activate_split_button_item', onActivateSplitButtonItem,TTEventBusStatics.AUTO_CLEAR_ON_EXIT  );\n\n        let onFreezeSplitButtonActiveItem = function( event_data ) {\n            if ( this.menu_id === event_data.menu_id ) {\n                Debug.Text( 'Contextmenu\\n SPLIT BUTTON update RECEIVED for: ' + event_data.menu_id + ':' + event_data.item_id, 'TTContextMenu.vue', 'TTContextMenu', 'created:EventBus:activate_split_button_item', 11 );\n                this.freezeSplitButtonActiveItem( event_data.item_id );\n            } else {\n                // If the view id does not match active view, then ignore the update, as its probably the previous view.\n                Debug.Warn( 'Error: Context Menu Split Button Item activation does not match menu id.\\nThis menu:  ' + this.menu_id + '\\n Event menu: ' + event_data.menu_id + ' )', 'TTContextMenu.vue', 'TTContextMenu', 'created:EventBus:activate_split_button_item', 11 );\n            }\n        }.bind( this ); // Must bind to this at variable definition, not in the EventBus on/off as each .bind creates a new function reference, so it wont be able to match up on delete.\n\n        this.event_bus.on( this.component_id, 'freeze_split_button_active_item', onFreezeSplitButtonActiveItem, TTEventBusStatics.AUTO_CLEAR_ON_EXIT  );\n    },\n    unmounted() {\n        Debug.Text( 'Vue context menu component unmounted ('+ this.menu_id +').', 'TTContextMenu.vue', 'TTContextMenu', 'unmounted', 10 );\n        this.event_bus.autoClear();\n    },\n    props: {\n        menu_id: String\n    },\n    data() {\n        return {\n            component_id: 'context_menu',\n            built_menu: [],\n            removeEventsOnUnmount: [],\n            nowrap_views: [ 'TimeSheet' ], // TimeSheet is to handle the New Punch label wrapping. This is here to test if this will work globally, nowrap might cause issues.\n        }\n    },\n    computed: {\n        alignItems() {\n            let filter_left = ( element ) => element.menu_align === 'left';\n            let filter_center = ( element ) => element.menu_align === 'center';\n            let filter_right = ( element ) => element.menu_align === 'right';\n\n            return {\n                left: this.built_menu.filter( filter_left ),\n                center: this.built_menu.filter( filter_center ),\n                right: this.built_menu.filter( filter_right )\n            };\n        },\n        dynamicClasses() {\n            return {\n                // 'nowrap': this.nowrap_views.includes( this.viewId ) ? 'no-wrap' : '', // If this returns true, this prevents the text label of a nav button wrapping to a new-line, affecting the button heights for the whole menu. Care needs to be taken if not all buttons will fit with no-wrap.\n                nowrap: 'no-wrap', // Simplifing this while we no longer pass in viewId. If this feature is needed, then we need to get viewId another way.\n            }\n        }\n    },\n    methods: {\n        rebuildMenu( menu_model ) {\n            this.built_menu.length = 0; // TODO: Should not need to do this once TTContextMenu has an independant instance for each view. At the moment, all views are one Vue View (LegacyView).\n            this.built_menu.push(...menu_model ); // TODO: Need to handle the eventuality where icons array needs to be cleared first without losing the JS reference to the array.\n        },\n        /**\n         * Update several item params in one go.\n         * This will also be useful for event driven updates, reduces the need to have an event function for each action.\n         * @param {string} item_id - ID of the item to update\n         * @param {Object} new_item_attributes - The new data as attributes in an object.\n         * @returns {Object}\n         */\n        updateMenuItem( item_id, new_item_attributes ) {\n            var item = this.getMenuItemById( item_id );\n            if( item === undefined ) {\n                // If this happens, it might be that the Vue menu has cleared already, and the menu is trying to set states on old icons no longer present. Might be a legacy->Vue issue on a view change. But the vue menu items should always match the legacy menu on the view controller. Trace the icons and try and fix the disconnect.\n                Debug.Warn( 'Menu item not found ('+ item_id +') unable to update with: ' + JSON.stringify( new_item_attributes ), 'TTContextMenu.vue', 'TTContextMenu', 'updateMenuItem', 1 );\n                return false;\n            }\n            return Object.assign( item, new_item_attributes);\n        },\n        activateMultiSelectItem( item_id ) {\n            var item = this.getMenuItemById( item_id );\n            if( item === undefined ) {\n                // If this happens, it might be that the Vue menu has cleared already, and the menu is trying to set states on old icons no longer present. Might be a legacy->Vue issue on a view change. But the vue menu items should always match the legacy menu on the view controller. Trace the icons and try and fix the disconnect.\n                Debug.Warn( 'Menu item not found ('+ item_id +') unable to update with: ' + JSON.stringify( new_item_attributes ), 'TTContextMenu.vue', 'TTContextMenu', 'updateMenuItem', 1 );\n                return false;\n            }\n            if( item.setOnlySelfActive === undefined ) {\n                item.default_active_item = true;\n                return 1;\n            } else {\n                item.setOnlySelfActive();\n                return 2;\n            }\n        },\n        activateSplitButtonItem( item_id ) {\n            for ( let i = 0; i < this.built_menu.length; i++ ) {\n                //Only modify the action group that contains the item_id we want. This is to avoid affecting any other action groups active item.\n                if ( this.built_menu[i].items.some(item => item.id === item_id ) ) {\n                    for ( let j = 0; j < this.built_menu[i].items.length; j++ ) {\n                        if ( this.built_menu[i].items[j].id === item_id ) {\n                            this.built_menu[i].items[j].menu_force_active = true;\n                        } else {\n                            this.built_menu[i].items[j].menu_force_active = false;\n                        }\n                    }\n                }\n            }\n        },\n        freezeSplitButtonActiveItem( item_id ) {\n            var item = this.getMenuItemById( item_id );\n            if ( item === undefined ) {\n                // If this happens, it might be that the Vue menu has cleared already, and the menu is trying to set states on old icons no longer present. Might be a legacy->Vue issue on a view change. But the vue menu items should always match the legacy menu on the view controller. Trace the icons and try and fix the disconnect.\n                Debug.Warn( 'Menu item not found (' + item_id + ') unable to update', 'TTContextMenu.vue', 'TTContextMenu', 'setSplitButtonTemporarilyIgnoreDisabled', 1 );\n                return false;\n            }\n            item.freeze_active_item = true;\n        },\n        enableMenuItem( item_id ) {\n            var item = this.getMenuItemById( item_id );\n            item.disabled = false;\n        },\n        disableMenuItem( item_id ) {\n            var item = this.getMenuItemById( item_id );\n            item.disabled = true;\n        },\n        hideMenuItem( item_id ) {\n            var item = this.getMenuItemById( item_id );\n            item.visible = false;\n\n        },\n        showMenuItem( item_id ) {\n            var item = this.getMenuItemById( item_id );\n            item.visible = true;\n\n        },\n        getMenuItemById( item_id ) {\n            // TODO: Have I already done a similar function elsewhere? It seems familiar, but with ES6 array functions instead of for loops?\n            // Check the context menu class as well as the left menu class. Put in Global if found.\n\n            var result;\n            function recursiveFind( haystack_array, needle_id ) {\n                return haystack_array.find( element => {\n                    if ( Array.isArray( element ) ) {\n                        return recursiveFind( element, needle_id );\n                    } else {\n                        if( element.id === undefined && Array.isArray( element.items ) ) {\n                            return recursiveFind( element.items, needle_id );\n                        } else if( element.id === needle_id ) {\n                            result = element;\n                            return true;\n                        }\n                    }\n                } );\n            }\n            recursiveFind( this.built_menu, item_id );\n\n            return result;\n        }\n    },\n    components: { TTContextButton }\n};\n</script>\n\n<style>\n/* Hide icons from dropdown menus of context buttons and not the buttons themselves. */\n.p-menuitem-link .p-menuitem-icon {\n    display: none;\n}\n/* Icons can be displayed in dropdowns by using the class \"tticon-show-in-dropdown\"\n   for example: Multi-select (radio and check boxes) still need to be displayed.\n*/\n.p-menuitem-link .tticon-show-in-dropdown {\n    display: inline;\n}\n</style>\n\n\n<style scoped>\n.context-menu-bar {\n    display: flex;\n    justify-content: space-between;\n    /*background: #e9ecef; !* Chose #e9ecef, previously #ced4da but looked too dark once the rest of the page background is white/off-white. *!*/\n    margin-bottom: 10px;\n    padding-bottom: 5px; /* To balance out the top padding applied from .context-border padding. Trying 5px instead of 10px to balance out closeness of the context-border heading to the menu, but now top and bottom not equal but might be ok. */\n    border-bottom: 1px solid #dbdee1;\n}\n.left-container,\n.center-container,\n.right-container {\n    display: flex;\n    justify-content: flex-start;\n    padding: 4px; /* To match figma design */\n}\n.no-wrap {\n    white-space: nowrap;\n}\n.p-menuitem-icon {\n    display: none;\n}\n</style>\n","import { Global } from '@/global/Global';\nimport { createApp } from 'vue';\nimport main_ui_router from '@/components/main_ui_router';\nimport TTContextMenu from '@/components/context_menu/TTContextMenu';\nimport PrimeVue from 'primevue/config';\nimport TTEventBus from '@/services/TTEventBus';\n\n/*\n * -- Structure of the ContextMenuManager --\n * You can search the code for `#VueContextMenu#` which will help identify the key areas during development and refactor.\n * Dynamic: For the Dynamic creation of the menu, you can search for #VueContextMenu#Dynamic-View and #VueContextMenu#Dynamic-EditView and look at mountContextMenu\n *\n * There are 3 elements to the ContextMenuManager\n * 1) The TT applications view code, 2) the ContextMenuManager, and 3) the Vue context menu.\n * The Vue component is controlled by events, the events work as follows:\n * 1) The Vue component is setup to listen to events from the EventBus (mitt)\n * 2) The control events are fired from the ContextMenuManager.\n * 3) The view controller calls functions in the ContextMenuManager to trigger these events.\n * - ContextMenuManagers are created in BaseViewController.buildContextMenu\n * - ContextMenu Models are built in BaseViewController.buildContextMenuModels() and all other ViewControllers that override those functions.\n * - The Vue component is created currently by the LegacyView component, and only when a viewId is passed to the LegacyView, currently done by the Vue Router.\n * The Vue router in turn is triggered NOT by the hash changes, as this currently leads to some race conditions/out of sync with the TT app.\n * Instead, the Vue router is running in createMemoryHistory mode, and routing manually triggered by VueRouter.push, which is currently done from BaseViewController.loadView\n *\n * -- Creating a new Context Menu --\n * So step 1 in adding a new context menu, is make sure the Vue Router is triggered, to create a new menu.\n * The new contextMenu responds to a viewId, so this needs to be unique. (Approach might have to be re-evaluated for places with subviews.\n * Maybe in the router we pass a contextmenu id which can be the same as the viewId in most cases? Discuss with Mike.\n * Either way, having the router control that Vue contextmenu generation will control duplicates/clashes.\n * -- Points of note\n * - Make sure any new listeners in the Vue component are also destroyed once no longer used (e.g. when component is unMounted).\n *\n * Initialized from BaseViewController rather than the Vue component, so that each manager created is controlled from this point.\n * Every contextmenu Vue component will then listen to a given viewId which is triggered by BaseVC.loadview.\n * If it was the other way around, there could be more chance for a viewId manager to be overriden in the array.\n * Still, the organisation between when a Vue contextmenu is created, and a manager from the TT app side, could be improved.\n * Also, worst case scenario, a manager is created in BaseView, and no vue component to listen to it.\n * If the vue component was to control when a manager was created, then we would get problems when functions like this.context_menu.parseContextRibbonAction are called from setDefault menu functions within views. So BaseView MUST be in charge of creating the manager.\n * - An area to improve would be to have our own EventBus, not re-use the one from PrimeVue.\n */\n\nclass ContextMenu {\n\tconstructor( options ) {\n\t\t// Set validation to reject if minimum data not supplied.\n\t\tthis.id = options.id || null;\n\t\tthis.type = options.type || null;\n\t\tthis.vue_menu_instance = options.vue_menu_instance || null;\n\t\tthis.view_controller_instance = options.view_controller_instance || null;\n\t\tthis.menu_model = null;\n\t}\n}\n\n\nclass ContextMenuManager {\n\tconstructor() {\n\t\tthis._menus = {}; // Will contain ContextMenu's\n\t\tthis.event_bus = new TTEventBus({ view_id: 'context_menu' });\n\t}\n\n\tcreateAndMountMenu( menu_id, parent_mount_container, parent_context ) {\n\t\tif( !menu_id || !parent_mount_container || !parent_context ) {\n\t\t\tDebug.Error( 'Error: Invalid parameters passed to function.', 'ContextMenuManager.js', 'ContextMenuManager', 'createAndMountMenu', 1 );\n\t\t\treturn false;\n\t\t}\n\t\tif( this.getMenu( menu_id ) !== undefined ) {\n\t\t\tDebug.Error( 'Error: Context Menu Manager ('+ menu_id +') already exists and mounted.', 'ContextMenuManager.js', 'ContextMenuManager', 'createAndMountMenu', 1 );\n\t\t\treturn false;\n\t\t}\n\t\t// TODO:\n\t\t// - Tie in a onDestroy function where the vue context and reference in the array are deleted if the menu is removed from the dom.\n\n\t\t// #VueContextMenu#Dynamic-View - Create dynamic container for the vue context menu\n\t\tparent_mount_container.prepend('<div id=\"'+ menu_id +'\" class=\"context-menu-mount-container\"></div>');\n\n\t\t// Create and mount unique context menu for this view.\n\t\tlet vue_context = this.mountContextMenu( menu_id );\n\n\t\tlet menu = new ContextMenu({\n\t\t\tid: menu_id,\n\t\t\tvue_menu_instance: vue_context,\n\t\t\tview_controller_instance: parent_context ,\n\t\t});\n\n\t\t// Add context menu to the array of active context menu's so we can track them.\n\t\tthis._menus[ menu_id ] = menu;\n\t\treturn menu.id;\n\t}\n\tgenerateMenuId( parent_type, parent_id ) {\n\t\tif( !parent_type || !parent_id ) {\n\t\t\tDebug.Error( 'Error: Invalid parameters passed to function.', 'ContextMenuManager.js', 'ContextMenuManager', 'generateMenuId', 1 );\n\t\t\treturn false;\n\t\t}\n\t\t/* -- Examples --\n\t\t* View: BranchView\n\t\t* EditView: BranchView -> Edit\n\t\t* EditView with tabs: Employee -> Edit\n\t\t* SubView: Example?\n\t\t* SubViewLists: Employee -> Edit -> Qualifications.\n\t\t* */\n\n\t\treturn `CM-${parent_id}-${parent_type}`; // Maybe need a unique menu on the end? or not?\n\t}\n\tgetMenu( id ) {\n\t\treturn this._menus[ id ];\n\t}\n\tmountContextMenu( menu_id ) {\n\t\tif( menu_id === undefined ) {\n\t\t\tDebug.Error( 'Error: Invalid parameters passed to function.', 'ContextMenuManager.js', 'ContextMenuManager', 'mountContextMenu', 1 );\n\t\t\treturn false;\n\t\t}\n\t\tif( this.getMenu( menu_id ) !== undefined ) {\n\t\t\tDebug.Error( 'Error: Context Menu Manager ('+ menu_id +') already exists and mounted.', 'ContextMenuManager.js', 'ContextMenuManager', 'mountContextMenu', 1 );\n\t\t\treturn false;\n\t\t}\n\n\t\t// Used by #VueContextMenu#Dynamic-View and #VueContextMenu#Dynamic-EditView\n\t\tlet mount_component = TTContextMenu;\n\t\tlet mount_reference = '#' + menu_id;\n\t\t// TODO: Check if component has not already been mounted or existing in the menu list.\n\n\t\tlet vue_menu_instance = createApp( mount_component, { menu_id: menu_id } ); // Can pass an object in here too for proper JS only code, and allow data in without eventBus.\n\t\tvue_menu_instance.use( PrimeVue, { ripple: true, inputStyle: 'filled' }); // From: AppConfig.vue this.$primevue.config.inputStyle value is filled/outlined as we dont use AppConfig in TT.\n\t\tvue_menu_instance.use( main_ui_router ); // #VueContextMenu# FIXES: Failed to resolve component: router-link when TTOverlayMenuButton is opened. Because each context menu is a separate Vue instance, and they did not globally 'use' the Router, only in main ui.\n\t\tvue_menu_instance.mount( mount_reference ); // e.g. '#tt-edit-view-test'\n\n\t\treturn vue_menu_instance;\n\t}\n\tunmountContextMenu ( id ) {\n\t\tif( this._menus[ id ] ) {\n\t\t\tthis._menus[ id ].vue_menu_instance.unmount();\n\t\t\tdelete this._menus[ id ];\n\t\t\tDebug.Text( 'Context menu successfully unmounted ('+ id +').', 'ContextMenuManager.js', 'ContextMenuManager', 'unmountContextMenu', 11 );\n\t\t\treturn true;\n\t\t} else {\n\t\t\tDebug.Warn( 'Unable to unmount context menu. Menu not found ('+ id +'). Maybe already removed?', 'ContextMenuManager.js', 'ContextMenuManager', 'unmountContextMenu', 11 );\n\t\t\treturn false;\n\t\t}\n\t}\n\tbuildContextMenuModelFromBackbone( menu_id, final_context_menu_model, view_controller_context ) {\n\t\tif( menu_id === null ) return false;\n\n\t\tvar parsed_bb_menu = this.convertBackBoneMenuModelToPrimeVue( final_context_menu_model, view_controller_context );\n\t\tthis.updateMenuModel( menu_id, parsed_bb_menu );\n\n\t\tif ( this.getMenu( menu_id ) ) {\n\t\t\t//Fixes context menu flashing. For example when a user has lower permission levels context icons will appear and then dissapear half a second later.\n\t\t\t//NOTE: These branching paths may be removed in the future when setDefaultMenu() and setEditMenu() are consolidated and some changes may be needed to reduce duplicate calls to the set*Menu() functions.\n\t\t\tif ( !this.getMenu( menu_id ).view_controller_instance.is_edit && !this.getMenu( menu_id ).view_controller_instance.is_add && !this.getMenu( menu_id ).view_controller_instance.is_viewing ) {\n\t\t\t\tthis.getMenu( menu_id ).view_controller_instance.setDefaultMenu();\n\t\t\t} else {\n\t\t\t\t//Fixes issue where refreshing an edit view would flash context menus.\n\t\t\t\tthis.getMenu( menu_id ).view_controller_instance.setEditMenu();\n\t\t\t}\n\t\t} else {\n\t\t\tDebug.Error( 'Error: Cannot find Vue context menu.', 'ContextMenuManager.js', 'ContextMenuManager', 'getMenuModelByMenuId', 1 );\n\t\t}\n\t}\n\tconvertBackBoneMenuModelToPrimeVue( backbone_menu_format, view_controller_context ) {\n\t\t/*\n\t\t* This would have arrays for groups & icons\n\t\t* icons is very similar to the PrimeVue MenuModel.\n\t\t*\n\t\t* Note: This function only builds the menu when its asked to do so, like on view controller init.\n\t\t* However, if the menu icons are manipulated via permission controls or user selecting items in a data table, this function does not run.\n\t\t* Thats mostly fine, as the menu structure itself does not really change based on user interaction,\n\t\t* But some things might. E.g. (Paystubs ->Edit Employee) when the Save menu initially has all the options during this build run, but later ends up with only one Save option. That needs to be handled dynamically in Vue.\n\t\t* */\n\n\t\tvar icons = backbone_menu_format.icons;\n\t\tvar action_groups = {};\n\t\tvar parsed_icons = [];\n\n\t\t// TODO: Is the below still needed? And can we do this in a neater/clearer way.\n\t\tif ( icons && Object.keys( icons ).length && Object.keys( icons ).length < 1) {\n\t\t\t// Invalid data.\n\t\t\tconsole.error('ContextMenuManager: Invalid data format. No icons or not an array.');\n\t\t\treturn false;\n\t\t}\n\n\t\t// Sort icons by their sort_order attribute.\n\t\ticons = Object.values(backbone_menu_format.icons).sort(this.sortCompareIcons);\n\n\t\t// parse the icons item.icons further\n\t\tfor ( var key in icons ) {\n\t\t\t// Dev warning: iteration order is not guaranteed during for...in loops. And only modify the currently iterated key. https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...in#deleted_added_or_modified_properties\n\t\t\tif(icons.hasOwnProperty( key )) {\n\t\t\t\tvar item = icons[key];\n\n\t\t\t\t// Validation checks and default values.\n\t\t\t\t// When modifying these, make sure to update sub_menu_item checks later on too.\n\t\t\t\tif( !item.id ) {\n\t\t\t\t\tDebug.Error( 'ERROR: Invalid data. Missing ID.', 'ContextMenuManager.js', 'ContextMenuManager', 'convertBackBoneMenuModelToPrimeVue', 1 );\n\t\t\t\t}\n\t\t\t\tif( item.icon ) delete item.icon; // Remove the .icon attribute, because it interferes with PrimeVue <button> element's icon attribute. Currently still needed for legacy context menu icon display.\n\t\t\t\tif( item.vue_icon ) item.icon = item.vue_icon;\n\t\t\t\tif( item.items ) delete item.items; // Remove the .items array, as this is from the old menu, and PrimeVue will incorrectly interpret it as a submenu.\n\t\t\t\tif( !item.action_group ) item.action_group = item.id; // If no action_group, then just use the id, as we will use action_group later on as a unique id.\n\t\t\t\tif( !item.menu_align ) item.menu_align = 'left'; // Set default alignment to left\n\t\t\t\tif( !item.command ) item.command = default_command; // Modify the command related to the nav item\n\n\t\t\t\tfunction default_command( item ) {\n\t\t\t\t\t// Perhaps put this into a default parser just like MenuManager.\n\t\t\t\t\t// console.log('Default command triggered for ', icon_id);\n\t\t\t\t\tif ( item.id ) {\n\t\t\t\t\t\tview_controller_context.onContextMenuClick( item, item.id );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tview_controller_context.onContextMenuClick( null, item );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Convert TT legacy selected state to Vue active state. (Used in places like MessageControlVC).\n\t\t\t\tif( item.selected == true ) { // == rather than === as this is based on legacy code which sometimes comes as strings from API.\n\t\t\t\t\tdelete item.selected;\n\t\t\t\t\titem.active = true;\n\t\t\t\t\titem.icon = 'tticon tticon-show-in-dropdown tticon-radio_button_checked_black_24dp';\n\t\t\t\t} else if ( item.selected == false ) { // == rather than === as this is based on legacy code which sometimes comes as strings from API.\n\t\t\t\t\tdelete item.selected;\n\t\t\t\t\titem.active = false;\n\t\t\t\t\titem.icon = 'tticon tticon-show-in-dropdown tticon-radio_button_unchecked_black_24dp';\n\t\t\t\t}\n\n\t\t\t\t// Modify the label for a nav item, parse the <br> tags - might be possible to remove this in a couple of months, once confirmed the old menu/data is not needed.\n\t\t\t\tif ( item.label ) {\n\t\t\t\t\titem.label = item.label.replace( '<br>', ' ' ); // Removing the <br> here rather than in the source data, just incase we want to keep the old menu/data working for now.\n\t\t\t\t}\n\t\t\t\t// Parse old style contextmenu dropdowns to new primevue menu\n\t\t\t\tif( item.original_items && item.original_items.length > 0 ) {\n\t\t\t\t\t// This results in making a special version of the split-button menu, using the overlay menu, which has a header instead of the currently 'active' action button. See TTOverlayMenuButton.vue for more detailed explanation.\n\n\t\t\t\t\t// Create on-the-fly action_group entry for the legacy drop down menus like Print in TimeSheetViewController\n\t\t\t\t\tif( !item.action_group ) {\n\t\t\t\t\t\titem.action_group = item.id;\n\t\t\t\t\t}\n\n\t\t\t\t\titem.items = []; // RibbonSubMenuNavItem adds the backbone menu models to the parent .items array, so we need to clear it before it confuses the PrimeVue menu which uses .items too.\n\n\t\t\t\t\titem.action_group_header = true;\n\t\t\t\t\titem.permission_result = false; // to hide it in legacy context menu and avoid errors in legacy parsers.\n\t\t\t\t\tthis.parseIconActionGroup( item, action_groups, parsed_icons ); // Parse the header to generate the group array.\n\n\t\t\t\t\tfor ( var sub_key in item.original_items ) {\n\t\t\t\t\t\tif( item.original_items.hasOwnProperty( sub_key )) {\n\t\t\t\t\t\t\tvar sub_menu_item = item.original_items[sub_key];\n\n\t\t\t\t\t\t\t// Modify the command related to the sub menu/nav item.\n\t\t\t\t\t\t\tif( !sub_menu_item.command ) sub_menu_item.command = default_submenu_command;\n\n\t\t\t\t\t\t\t// Set the alignment to match the parent item.\n\t\t\t\t\t\t\tsub_menu_item.menu_align = item.menu_align;\n\n\t\t\t\t\t\t\t// Set the action_group to match the parent item.\n\t\t\t\t\t\t\tsub_menu_item.action_group = item.action_group;\n\t\t\t\t\t\t\tthis.parseIconActionGroup( sub_menu_item, action_groups, parsed_icons ); // Parse the sub items to add them to the group.\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction default_submenu_command( icon_id ) {\n\t\t\t\t\t\t// Perhaps put this into a default parser just like MenuManager.\n\t\t\t\t\t\tview_controller_context.onReportMenuClick( icon_id);\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tthis.parseIconActionGroup( item, action_groups, parsed_icons );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn parsed_icons;\n\t}\n\n\t// Parse action_group's\n\t// If an action group exists, add icons into groups, even if there is just one, as TTContextButton will handle single item arrays as a single object anyway.\n\tparseIconActionGroup( parse_item, action_groups, parsed_icons ) {\n\t\tvar action_group_id = parse_item.menu_align + '-' + parse_item.action_group;\n\n\t\tif( action_groups[ action_group_id ] === undefined ) {\n\t\t\t// First item encountered for this action_group. Create new and add current item.\n\t\t\taction_groups[ action_group_id ] = {\n\t\t\t\taction_group_id: action_group_id,\n\t\t\t\tmenu_align: parse_item.menu_align, // set the align based on first item, as in theory they would all have the same value.\n\t\t\t\titems: [ parse_item ]\n\t\t\t};\n\t\t\tparsed_icons.push( action_groups[ action_group_id ] ); // Add action group reference to the main icon array.\n\t\t} else {\n\t\t\t// This action group already exists, add the item to the existing action group.\n\t\t\tif( parse_item.action_group_header ) {\n\t\t\t\taction_groups[ action_group_id ].items.unshift( parse_item ); // move to the front, to treat as group label\n\t\t\t} else {\n\t\t\t\taction_groups[ action_group_id ].items.push( parse_item );\n\t\t\t}\n\t\t}\n\t}\n\n\t// Sort the icons based on their sort_order attribute\n\t// Based on Global.compareMenuItems from the original ribbon menu.\n\tsortCompareIcons( a, b ) {\n\t\t// If no sort_order, or sort_order is equal, then base on add_order\n\t\tif ( a.sort_order === undefined || b.sort_order === undefined || a.sort_order == b.sort_order ) {\n\t\t\t// Debug.Text( 'sort_order equal or undefined. Check sort_order/add_order for '+ a.id + ' ('+ a.sort_order +') '+' & '+ b.id +' ('+ b.sort_order +').', 'ContextMenuManager.js', 'ContextMenuManager', 'sortCompareIcons', 10 );\n\n\t\t\tif ( a.add_order < b.add_order ) {\n\t\t\t\treturn -1; // Leave a and b order unchanged.\n\t\t\t}\n\t\t\tif ( a.add_order > b.add_order ) {\n\t\t\t\treturn 1; // Sort b before a.\n\t\t\t}\n\t\t}\n\n\t\t// Base sorting on sort_order, regardless of add_order\n\t\tif ( a.sort_order < b.sort_order ) {\n\t\t\treturn -1; // Leave a and b order unchanged.\n\t\t}\n\n\t\tif ( a.sort_order > b.sort_order ) {\n\t\t\treturn 1; // Sort b before a.\n\t\t}\n\n\t\t// No criteria matched at all - skip basically. Could also apply to action_group_header's (they will be pushed to the front of their group later in action group parsing)\n\t\tDebug.Text( 'sort_order returned 0. Check sort_order/add_order for '+ a.id + ' ('+ a.sort_order +') '+' & '+ b.id +' ('+ b.sort_order +').', 'ContextMenuManager.js', 'ContextMenuManager', 'sortCompareIcons', 10 );\n\t\treturn 0; // leave a and b unchanged with respect to each other, but sorted with respect to all different elements.\n\t}\n\n\tfilterVisibleItems( items ) {\n\t\tlet check_visible = ( element ) => element.visible !== false;\n\t\tlet filtered_items = items.filter( check_visible );\n\n\t\treturn {\n\t\t\titems: filtered_items,\n\t\t\tcount: filtered_items.length\n\t\t};\n\t}\n\n\tgetMenuModelByMenuId( menu_id ) {\n\t\tvar menu_model = [];\n\n\t\tif ( this.getMenu( menu_id ) !== undefined && this.getMenu( menu_id ).menu_model ) {\n\t\t\tfor ( var menu_item of this.getMenu( menu_id ).menu_model ) {\n\t\t\t\tmenu_model.push( ...menu_item.items );\n\t\t\t}\n\t\t} else {\n\t\t\t//This should never happen, the one case it did happen (now fixed) was when right click menu was being created before edit view when opening a record.\n\t\t\tDebug.Error( 'Fatal Error: Vue context menu has not been build yet and is undefined.', 'ContextMenuManager.js', 'ContextMenuManager', 'getMenuModelByMenuId', 1 );\n\t\t\t// debugger; // Useful to debug here if this error happens.\n\t\t}\n\n\t\treturn menu_model;\n\t}\n\n\t// Context Menu Event Emitters\n\n\tupdateMenuModel( menu_id, menu_model ) {\n\t\tif( !menu_id || !menu_model ) {\n\t\t\tDebug.Error( 'Error: Invalid parameters passed to function.', 'ContextMenuManager.js', 'ContextMenuManager', 'updateMenuModel', 1 );\n\t\t\treturn false;\n\t\t}\n\n\t\t//This can be done differently, just creating an easy to access reference to the menu model.\n\t\tif ( this.getMenu( menu_id ) ) {\n\t\t\tthis.getMenu( menu_id ).menu_model = menu_model;\n\t\t} else {\n\t\t\tDebug.Error( 'Error: Cannot find Vue context menu..', 'ContextMenuManager.js', 'ContextMenuManager', 'getMenuModelByMenuId', 1 );\n\t\t}\n\n\t\t// EventBus.emit( view_id + '.updateContextMenu', {\n\t\tthis.event_bus.emit( 'context_menu', 'update_context_menu', {\n\t\t\tmenu_id: menu_id,\n\t\t\tmenu_model: menu_model\n\t\t});\n\t\tDebug.Text( 'Contextmenu\\n MENU update SENT for: '+ menu_id, 'ContextMenuManager.js', 'ContextMenuManager', 'updateMenuModel', 11 );\n\t}\n\n\tupdateItem( menu_id, item_id, item_attributes ) {\n\t\tif( !menu_id || !item_id || !item_attributes ) {\n\t\t\tDebug.Error( 'Error: Invalid parameters passed to function.', 'ContextMenuManager.js', 'ContextMenuManager', 'updateItem', 1 );\n\t\t\treturn false;\n\t\t}\n\n\t\t// EventBus.emit( this.view_controller_instance.viewId + '.updateItem', {\n\t\tthis.event_bus.emit( 'context_menu', 'update_item', {\n\t\t\tmenu_id: menu_id,\n\t\t\titem_id: item_id,\n\t\t\titem_attributes: item_attributes\n\t\t});\n\t\tDebug.Text( 'Contextmenu\\n ITEM update SENT for: '+ menu_id + ':' + item_id, 'ContextMenuManager.js', 'ContextMenuManager', 'updateItem', 11 );\n\t}\n\n\t// Context Menu actions\n\n\tmultiSelectActivateItem( item_id ) {\n\t\tif( !item_id ) {\n\t\t\tDebug.Error( 'Error: Invalid parameters passed to function.', 'ContextMenuManager.js', 'ContextMenuManager', 'multiSelectActivateItem', 1 );\n\t\t\treturn false;\n\t\t}\n\t\tthis.event_bus.emit( 'context_menu', 'activate_multi_select_item', {\n\t\t\titem_id: item_id\n\t\t});\n\t\tDebug.Text( 'Contextmenu\\n MULTI_ITEM update SENT for: '+ menu_id + ':' + item_id, 'ContextMenuManager.js', 'ContextMenuManager', 'multiSelectActivateItem', 11 );\n\t}\n\n\tactivateSplitButtonItem( menu_id, item_id ) {\n\t\tif ( !menu_id || !item_id ) {\n\t\t\tDebug.Error( 'Error: Invalid parameters passed to function.', 'ContextMenuManager.js', 'ContextMenuManager', 'activateSplitButtonItem', 1 );\n\t\t\treturn false;\n\t\t}\n\t\tthis.event_bus.emit( 'context_menu', 'activate_split_button_item', {\n\t\t\tmenu_id: menu_id,\n\t\t\titem_id: item_id\n\t\t} );\n\t\tDebug.Text( 'Contextmenu\\n SPLIT BUTTON update SENT for: ' + menu_id + ':' + item_id, 'ContextMenuManager.js', 'ContextMenuManager', 'activateSplitButtonItem', 11 );\n\t}\n\n\tfreezeSplitButtonActiveItem( menu_id, item_id ) {\n\t\tif ( !menu_id || !item_id ) {\n\t\t\tDebug.Error( 'Error: Invalid parameters passed to function.', 'ContextMenuManager.js', 'ContextMenuManager', 'setSplitButtonTempIgnoreDisabled', 1 );\n\t\t\treturn false;\n\t\t}\n\t\tthis.event_bus.emit( 'context_menu', 'freeze_split_button_active_item', {\n\t\t\tmenu_id: menu_id,\n\t\t\titem_id: item_id\n\t\t} );\n\t\tDebug.Text( 'Contextmenu\\n SPLIT BUTTON update SENT for: ' + menu_id + ':' + item_id, 'ContextMenuManager.js', 'ContextMenuManager', 'setSplitButtonTempIgnoreDisabled', 11 );\n\t}\n\n\tdisableMenuItem( menu_id, item_id, reverse_action ) {\n\t\tif( reverse_action ) {\n\t\t\tthis.updateItem( menu_id, item_id, { disabled: false });\n\t\t} else {\n\t\t\tthis.updateItem( menu_id, item_id, { disabled: true });\n\t\t}\n\t}\n\n\thideMenuItem( menu_id, item_id, reverse_action ) {\n\t\tif( reverse_action ) {\n\t\t\tthis.updateItem( menu_id, item_id, { visible: true });\n\t\t} else {\n\t\t\tthis.updateItem( menu_id, item_id, { visible: false });\n\t\t}\n\t}\n\n\tactivateMenuItem( menu_id, item_id, reverse_action ) {\n\t\t// Note: This is also done during menu build for selected items, in convertBackBoneMenuModelToPrimeVue\n\t\tif( reverse_action ) {\n\t\t\tthis.updateItem( menu_id, item_id, {\n\t\t\t\tactive: false,\n\t\t\t\ticon: 'tticon tticon-show-in-dropdown tticon-radio_button_unchecked_black_24dp',\n\t\t\t});\n\t\t} else {\n\t\t\tthis.updateItem( menu_id, item_id, {\n\t\t\t\tactive: true,\n\t\t\t\ticon: 'tticon tticon-show-in-dropdown tticon-radio_button_checked_black_24dp',\n\t\t\t});\n\t\t}\n\t}\n\n}\n\n// Export as below to share one instance of the manager to manage all Context Menu's.\nexport default new ContextMenuManager()\n","import { Global } from '@/global/Global';\n\n( function( $ ) {\n\n\t$.fn.TTextInput = function( options ) {\n\t\tvar opts = $.extend( {}, $.fn.TTextInput.defaults, options );\n\t\tvar $this = this;\n\t\tvar field;\n\t\tvar validation_field;\n\t\tvar error_string = '';\n\t\tvar error_tip_box;\n\n\t\tvar mass_edit_mode = false;\n\t\tvar check_box = null;\n\n\t\tvar enabled = true;\n\n\t\tvar hasKeyEvent = null;\n\n\t\t//DONT USE THIS ANY MORE\n\t\tvar need_parser_date = false;\n\n\t\tvar need_parser_sec = false;\n\n\t\tvar parsed_value = false; //work with need_parser_date\n\n\t\tvar api_date = null;\n\n\t\tvar validate_timer = null;\n\n\t\tvar no_validate_timer = null;\n\n\t\tvar no_validate_timer_sec = 0;\n\n\t\tvar password_style = false;\n\n\t\tvar disable_keyup_event = false; //set to not send change event when mouseup\n\n\t\tvar mode;\n\n\t\tvar is_static_width;\n\n\t\tvar static_width;\n\t\tvar original_static_width; //Original static width.\n\n\t\t// var cancel_date_parse = false;\n\n\t\tvar do_validate = true;\n\n\t\tvar is_first_resize = true; //Lets us know if we are on our first resize call or not.\n\n\t\t// var parseDateAsync = function( callBack ) {\n\t\t// \tparsed_value = -1;\n\t\t// \tif ( !api_date ) {\n\t\t// \t\tapi_date = TTAPI.APITTDate;\n\t\t// \t}\n\t\t// \tapi_date.parseTimeUnit( $this.val(), {\n\t\t// \t\tonResult: function( result ) {\n\t\t// \t\t\tif ( cancel_date_parse ) {\n\t\t// \t\t\t\treturn;\n\t\t// \t\t\t}\n\t\t// \t\t\tparsed_value = result.getResult();\n\t\t// \t\t\tif ( callBack ) {\n\t\t// \t\t\t\tcallBack();\n\t\t// \t\t\t}\n\t\t// \t\t\tProgressBar.closeOverlay();\n\t\t// \t\t}\n\t\t// \t} );\n\t\t//\n\t\t// \t//parsed_value = Global.parseTimeUnit( $this.val() );\n\t\t// };\n\n\t\tthis.setPlaceHolder = function( val ) {\n\t\t\t$this.attr( 'placeholder', val );\n\t\t};\n\n\t\tthis.setNeedParsDate = function( val ) {\n\t\t\tneed_parser_date = val;\n\t\t};\n\n\t\tthis.setNeedParseSec = function( val ) {\n\t\t\tif ( val ) {\n\t\t\t\t//parsed_value = parseDateAsync();\n\t\t\t\tparsed_value = Global.parseTimeUnit( $this.val() );\n\t\t\t}\n\t\t\tneed_parser_sec = val;\n\n\t\t};\n\n\t\tthis.getEnabled = function() {\n\t\t\treturn enabled;\n\t\t};\n\n\t\tthis.setEnabled = function( val ) {\n\t\t\tenabled = val;\n\t\t\tif ( val === false || val === '' ) {\n\t\t\t\t$this.attr( 'readonly', 'true' );\n\t\t\t\t$this.addClass( 't-text-input-readonly' );\n\t\t\t\tif ( check_box ) {\n\t\t\t\t\tcheck_box.hide();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t$this.removeAttr( 'readonly' );\n\t\t\t\t$this.removeClass( 't-text-input-readonly' );\n\t\t\t\tif ( check_box ) {\n\t\t\t\t\tcheck_box.show();\n\t\t\t\t}\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setReadOnly = function( val ) {\n\t\t\tif ( val ) {\n\t\t\t\t$this.attr( 'disabled', 'true' );\n\t\t\t\t$this.addClass( 't-text-input-readonly-bg' );\n\t\t\t} else {\n\t\t\t\t$this.removeAttr( 'disabled' );\n\t\t\t\t$this.removeClass( 't-text-input-readonly-bg' );\n\t\t\t}\n\t\t};\n\n\t\tthis.setCheckBox = function( val ) {\n\t\t\tif ( check_box ) {\n\t\t\t\tcheck_box.children().eq( 0 )[0].checked = val;\n\t\t\t}\n\t\t};\n\n\t\tthis.isChecked = function() {\n\t\t\tif ( check_box ) {\n\t\t\t\tif ( check_box.children().eq( 0 )[0].checked === true ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t};\n\n\t\tthis.setMassEditMode = function( val ) {\n\n\t\t\tmass_edit_mode = val;\n\n\t\t\tif ( mass_edit_mode ) {\n\t\t\t\tcheck_box = $( ' <div class=\"mass-edit-checkbox-wrapper\"><input type=\"checkbox\" class=\"mass-edit-checkbox\"></input>' +\n\t\t\t\t\t'<label for=\"checkbox-input-1\" class=\"input-helper input-helper--checkbox\"></label></div>' );\n\t\t\t\tcheck_box.insertBefore( $( this ) );\n\t\t\t\tcheck_box.change( function() {\n\t\t\t\t\tif ( need_parser_date || need_parser_sec ) {\n\t\t\t\t\t\tparsed_value = Global.parseTimeUnit( $this.val() );\n\t\t\t\t\t\t// parseDateAsync( function() {\n\t\t\t\t\t\t// \t$this.trigger( 'formItemChange', [$this] );\n\t\t\t\t\t\t// } );\n\t\t\t\t\t}\n\t\t\t\t\t$this.trigger( 'formItemChange', [$this] );\n\t\t\t\t} );\n\n\t\t\t\tif ( is_static_width && static_width.toString().indexOf( '%' ) > 0 ) {\n\t\t\t\t\t$this.css( 'width', 'calc(' + static_width + ' - 25px)' );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif ( check_box ) {\n\t\t\t\t\tcheck_box.remove();\n\t\t\t\t\tcheck_box = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setField = function( val ) {\n\t\t\tfield = val;\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tthis.getValidationField = function() {\n\t\t\treturn validation_field;\n\t\t};\n\n\t\tthis.getInputValue = function() {\n\n\t\t\tvar val = $this.val();\n\t\t\treturn val;\n\n\t\t};\n\t\tthis.getValue = function() {\n\t\t\tvar val = $this.val();\n\t\t\tif ( need_parser_sec || need_parser_date || parsed_value ) {\n\t\t\t\tif ( parsed_value === -1 ) {\n\t\t\t\t\tparsed_value = Global.parseTimeUnit( val );\n\t\t\t\t\t// cancel_date_parse = true; // cancel orginal date parse process\n\t\t\t\t\t// parsed_value = api_date.parseTimeUnit( val, { async: false } ).getResult();\n\t\t\t\t}\n\t\t\t\treturn parsed_value;\n\t\t\t} else {\n\t\t\t\treturn val;\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setValue = function( val ) {\n\t\t\tif ( !val && val !== 0 ) {\n\t\t\t\tval = '';\n\t\t\t}\n\t\t\t$this.val( val );\n\t\t\tif ( need_parser_date ) {\n\t\t\t\t//parseDateAsync();\n\t\t\t\tparsed_value = Global.parseTimeUnit( $this.val() );\n\t\t\t} else if ( need_parser_sec ) {\n\t\t\t\tparsed_value = val;\n\t\t\t\t$this.val( Global.getTimeUnit( val ) );\n\t\t\t}\n\n\t\t\tthis.autoResize();\n\t\t};\n\n\t\tthis.setErrorStyle = function( errStr, show, isWarning ) {\n\t\t\tif ( isWarning ) {\n\t\t\t\t$( this ).addClass( 'warning-tip' );\n\t\t\t} else {\n\t\t\t\t$( this ).addClass( 'error-tip' );\n\t\t\t}\n\t\t\terror_string = errStr;\n\n\t\t\tif ( show ) {\n\t\t\t\tthis.showErrorTip();\n\t\t\t}\n\t\t};\n\n\t\tthis.setWidth = function( val ) {\n\t\t\tif ( val && ( val > 0 || val.indexOf( '%' ) > 0 ) ) {\n\t\t\t\t$this.width( val );\n\t\t\t\tstatic_width = val;\n\t\t\t\tis_static_width = true;\n\t\t\t}\n\t\t};\n\n\t\tthis.showErrorTip = function( sec ) {\n\n\t\t\tif ( !Global.isSet( sec ) ) {\n\t\t\t\tsec = 2;\n\t\t\t}\n\n\t\t\tif ( !error_tip_box ) {\n\t\t\t\terror_tip_box = Global.loadWidgetByName( WidgetNamesDic.ERROR_TOOLTIP );\n\t\t\t\terror_tip_box = error_tip_box.ErrorTipBox();\n\t\t\t}\n\t\t\terror_tip_box.cancelRemove();\n\n\t\t\tif ( $( this ).hasClass( 'warning-tip' ) ) {\n\t\t\t\terror_tip_box.show( this, error_string, sec, true );\n\t\t\t} else {\n\t\t\t\terror_tip_box.show( this, error_string, sec );\n\t\t\t}\n\n\t\t};\n\n\t\tthis.hideErrorTip = function() {\n\n\t\t\tif ( Global.isSet( error_tip_box ) ) {\n\t\t\t\terror_tip_box.remove();\n\t\t\t}\n\n\t\t};\n\n\t\tthis.clearErrorStyle = function() {\n\t\t\t$( this ).removeClass( 'error-tip' );\n\t\t\t$( this ).removeClass( 'warning-tip' );\n\t\t\tthis.hideErrorTip();\n\t\t\terror_string = '';\n\t\t};\n\n\t\tthis.autoResize = function() {\n\t\t\tvar content_width, example_width;\n\n\t\t\t//Skip resizing the field if there is no value and its on the first resize event.\n\t\t\tif ( is_first_resize == true && $this.getValue() == '' && original_static_width != 0 ) {\n\t\t\t\t$this.width( ( original_static_width ) + 'px' );\n\t\t\t\tis_first_resize = false;\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif ( !is_static_width ) {\n\t\t\t\tif ( mode === 'time' ) {\n\t\t\t\t\texample_width = Global.calculateTextWidth( LocalCacheData.getLoginUserPreference().time_format_display );\n\t\t\t\t} else if ( mode == 'time_unit' ) {\n\t\t\t\t\texample_width = Global.calculateTextWidth( LocalCacheData.getLoginUserPreference().time_unit_format_display );\n\t\t\t\t} else {\n\t\t\t\t\texample_width = 150; //Issue #3418 - Set default from 156 to 150. This stops all fields without set width from always growing by 6px when autoResize is triggered.\n\t\t\t\t}\n\t\t\t\tcontent_width = Global.calculateTextWidth( $this.getValue(), {\n\t\t\t\t\tmin_width: example_width,\n\t\t\t\t\tmax_width: 200\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tif ( static_width.toString().indexOf( '%' ) > 0 ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcontent_width = Global.calculateTextWidth( $this.getValue(), {\n\t\t\t\t\tmin_width: original_static_width,\n\t\t\t\t\tmax_width: static_width > 200 ? static_width : 200\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tvar padding = ( $this.outerWidth() - $this.width() ); //Reduce content width by padding. Otherwise when setting width = 50, will get padded and result in width = 56.\n\n\t\t\t//Make sure the field size increases and decreases as necessary, but only in increments of at least 5px at a time.\n\t\t\t//  Always always try to \"pin\" to the original width, so padding and such doesn't make it a few pixels different.\n\t\t\t//Debug.Text( 'Resizing Input: '+ $this.getField() +' From Width: '+ $this.width() +' To Width: '+ content_width +' Original Width: '+ original_static_width +' Value: '+ $this.getValue(), 'TTextInput.js', '', 'autoResize', 10 );\n\t\t\tif ( content_width == original_static_width ) {\n\t\t\t\t$this.width( ( content_width - padding ) + 'px' );\n\t\t\t} else if ( Math.abs( content_width - $this.width() ) >= 5 ) {\n\t\t\t\t$this.width( ( content_width ) + 'px' );\n\t\t\t}\n\t\t};\n\n\t\tthis.each( function() {\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\t\t\tfield = o.field;\n\n\t\t\t//Set autocomplete widget option is defined, set it here.\n\t\t\tif ( o.autocomplete ) {\n\t\t\t\t$this.attr( 'autocomplete', o.autocomplete );\n\t\t\t}\n\n\t\t\tif ( o.hasOwnProperty( 'do_validate' ) ) {\n\t\t\t\tdo_validate = o.do_validate;\n\t\t\t}\n\n\t\t\tif ( o.validation_field ) {\n\t\t\t\tvalidation_field = o.validation_field;\n\t\t\t}\n\t\t\tif ( o.hasOwnProperty( 'no_validate_timer_sec' ) && o.no_validate_timer_sec > 0 ) {\n\t\t\t\tno_validate_timer_sec = o.no_validate_timer_sec;\n\t\t\t}\n\t\t\thasKeyEvent = o.hasKeyEvent;\n\t\t\tneed_parser_date = o.need_parser_date;\n\t\t\tneed_parser_sec = o.need_parser_sec;\n\n\t\t\tif ( need_parser_date || need_parser_sec ) {\n\t\t\t\tapi_date = TTAPI.APITTDate;\n\t\t\t}\n\n\t\t\tif ( o.mode ) {\n\t\t\t\tmode = o.mode;\n\t\t\t}\n\n\t\t\tif ( o.width && ( o.width > 0 || o.width.indexOf( '%' ) > 0 ) ) {\n\t\t\t\t$this.width( o.width );\n\t\t\t\tstatic_width = original_static_width = o.width;\n\t\t\t\tis_static_width = true;\n\t\t\t}\n\n\t\t\tif ( o.disable_keyup_event ) {\n\t\t\t\tdisable_keyup_event = o.disable_keyup_event;\n\t\t\t}\n\n\t\t\tif ( mode === 'time' ) {\n\t\t\t\t$this.setPlaceHolder( LocalCacheData.getLoginUserPreference().time_format_display );\n\t\t\t} else if ( mode === 'time_unit' ) {\n\t\t\t\t$this.setPlaceHolder( LocalCacheData.getLoginUserPreference().time_unit_format_display );\n\t\t\t}\n\t\t\t$this.autoResize();\n\n\t\t\t$( this ).keydown( function( e ) {\n\t\t\t\t// key is not TAB and ENTER\n\t\t\t\tif ( hasKeyEvent && e.keyCode !== 9 && e.keyCode !== 13 ) {\n\t\t\t\t\t$this.trigger( 'formItemKeyDown', [$this] );\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\t$( this ).keyup( function( e ) {\n\t\t\t\tvar validate_sec = 1000;\n\t\t\t\tif ( e.keyCode === 9 || e.keyCode === 13 ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar is_valid_input = Global.isValidInputCodes( e.keyCode );\n\t\t\t\tif ( !is_valid_input ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t//don't clean event when click tab\n\t\t\t\tif ( validate_timer ) {\n\t\t\t\t\tclearTimeout( validate_timer );\n\t\t\t\t\tvalidate_timer = null;\n\t\t\t\t}\n\n\t\t\t\tif ( no_validate_timer ) {\n\t\t\t\t\tclearTimeout( no_validate_timer );\n\t\t\t\t\tno_validate_timer = null;\n\t\t\t\t}\n\t\t\t\tif ( hasKeyEvent ) {\n\t\t\t\t\t$this.trigger( 'formItemKeyUp', [$this] );\n\t\t\t\t}\n\t\t\t\tif ( error_string && error_string.length > 0 ) {\n\t\t\t\t\tvalidate_sec = 500;\n\t\t\t\t}\n\t\t\t\tif ( do_validate ) {\n\t\t\t\t\tvalidate_timer = setTimeout( function() {\n\t\t\t\t\t\tif ( check_box ) {\n\t\t\t\t\t\t\t$this.setCheckBox( true );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( need_parser_date || need_parser_sec ) {\n\t\t\t\t\t\t\tparsed_value = -1; // parse date when get value\n\t\t\t\t\t\t\tif ( !disable_keyup_event ) {\n\t\t\t\t\t\t\t\t$this.trigger( 'formItemChange', [$this, true] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif ( !disable_keyup_event ) {\n\t\t\t\t\t\t\t\t$this.trigger( 'formItemChange', [$this] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}, validate_sec );\n\t\t\t\t}\n\n\t\t\t\t// TO make sure the value is set to currentEditRecord when user typing it, but not trigger validate\n\t\t\t\t// Do this immediately instead wait for 300 ms.\n\t\t\t\tno_validate_timer = setTimeout( function() {\n\n\t\t\t\t\tif ( check_box ) {\n\t\t\t\t\t\t$this.setCheckBox( true );\n\t\t\t\t\t}\n\t\t\t\t\tif ( need_parser_date || need_parser_sec ) {\n\t\t\t\t\t\tparsed_value = -1; // parse date when get value\n\t\t\t\t\t\tif ( !disable_keyup_event ) {\n\t\t\t\t\t\t\t$this.trigger( 'formItemChange', [$this, true] );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( !disable_keyup_event ) {\n\t\t\t\t\t\t\t$this.trigger( 'formItemChange', [$this, true] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, no_validate_timer_sec );\n\t\t\t} );\n\n\t\t\t$( this ).mouseover( function() {\n\n\t\t\t\tif ( enabled ) {\n\t\t\t\t\tif ( error_string && error_string.length > 0 ) {\n\t\t\t\t\t\t$this.showErrorTip( 20 );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\t$( this ).mouseout( function() {\n\t\t\t\tif ( !$( $this ).is( ':focus' ) ) {\n\t\t\t\t\t$this.hideErrorTip();\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t$( this ).change( function() {\n\t\t\t\t$this.trigger( 'keyup', [$this] );\n\t\t\t\t//#2226 - When datetime or time unit fields specify need_parser_date or need_parser_sec it does not set disable_keyup_event == true. To validate those fields on change we need to check for those values.\n\t\t\t\tif ( disable_keyup_event || need_parser_date || need_parser_sec ) {\n\t\t\t\t\t$this.trigger( 'formItemChange', [$this] );\n\t\t\t\t}\n\t\t\t\tif ( !need_parser_date && !need_parser_sec ) {\n\t\t\t\t\t$this.autoResize();\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t$( this ).focusin( function() {\n\n\t\t\t\tif ( !enabled ) {\n\n\t\t\t\t\tif ( !check_box ) {\n\t\t\t\t\t\tif ( LocalCacheData.current_open_sub_controller &&\n\t\t\t\t\t\t\tLocalCacheData.current_open_sub_controller.edit_view &&\n\t\t\t\t\t\t\tLocalCacheData.current_open_sub_controller.is_viewing ) {\n\t\t\t\t\t\t\terror_string = LocalCacheData.current_open_sub_controller.getViewModeErrorMessage();\n\t\t\t\t\t\t\t$this.showErrorTip( 10 );\n\t\t\t\t\t\t} else if ( LocalCacheData.current_open_primary_controller &&\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.edit_view &&\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.is_viewing ) {\n\t\t\t\t\t\t\terror_string = LocalCacheData.current_open_primary_controller.getViewModeErrorMessage();\n\t\t\t\t\t\t\t$this.showErrorTip( 10 );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tif ( error_string && error_string.length > 0 ) {\n\t\t\t\t\t\t$this.showErrorTip( 20 );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\t$( this ).focusout( function() {\n\t\t\t\t$this.hideErrorTip();\n\t\t\t} );\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.TTextInput.defaults = {};\n\t$.fn.TTextInput.html_template = `<input type=\"text\" class=\"t-text-input\" autocomplete=\"timetrex-no-auto-fill\"/>`;\n\n} )( jQuery );","( function( $ ) {\n\n\t$.fn.TPasswordInput = function( options ) {\n\t\tvar opts = $.extend( {}, $.fn.TPasswordInput.defaults, options );\n\t\tvar $this = this;\n\t\tvar field;\n\t\tvar error_string = '';\n\t\tvar error_tip_box;\n\n\t\tvar mass_edit_mode = false;\n\t\tvar check_box = null;\n\n\t\tvar enabled = true;\n\n\t\tvar hasKeyEvent = null;\n\n\t\tvar validate_timer = null;\n\n\t\tthis.getEnabled = function() {\n\t\t\treturn enabled;\n\t\t};\n\n\t\tthis.setEnabled = function( val ) {\n\t\t\tenabled = val;\n\t\t\tif ( val === false || val === '' ) {\n\t\t\t\t$this.attr( 'readonly', 'true' );\n\t\t\t\t$this.addClass( 't-text-input-readonly' );\n\t\t\t} else {\n\t\t\t\t$this.removeAttr( 'readonly' );\n\t\t\t\t$this.removeClass( 't-text-input-readonly' );\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setReadOnly = function( val ) {\n\t\t\tif ( val ) {\n\t\t\t\t$this.attr( 'disabled', 'true' );\n\t\t\t\t$this.addClass( 't-text-input-readonly-bg' );\n\t\t\t} else {\n\t\t\t\t$this.removeAttr( 'disabled' );\n\t\t\t\t$this.removeClass( 't-text-input-readonly-bg' );\n\t\t\t}\n\t\t};\n\n\t\tthis.setCheckBox = function( val ) {\n\t\t\tif ( check_box ) {\n\t\t\t\tcheck_box.children().eq( 0 )[0].checked = val;\n\t\t\t}\n\t\t};\n\n\t\tthis.isChecked = function() {\n\t\t\tif ( check_box ) {\n\t\t\t\tif ( check_box.children().eq( 0 )[0].checked === true ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t};\n\t\tthis.setMassEditMode = function( val ) {\n\n\t\t\tmass_edit_mode = val;\n\n\t\t\tif ( mass_edit_mode ) {\n\t\t\t\tcheck_box = $( ' <div class=\"mass-edit-checkbox-wrapper\"><input type=\"checkbox\" class=\"mass-edit-checkbox\"></input>' +\n\t\t\t\t\t'<label for=\"checkbox-input-1\" class=\"input-helper input-helper--checkbox\"></label></div>' );\n\t\t\t\tcheck_box.insertBefore( $( this ) );\n\n\t\t\t\tcheck_box.change( function() {\n\t\t\t\t\t$this.trigger( 'formItemChange', [$this] );\n\t\t\t\t} );\n\n\t\t\t} else {\n\t\t\t\tif ( check_box ) {\n\t\t\t\t\tcheck_box.remove();\n\t\t\t\t\tcheck_box = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tthis.getValue = function() {\n\n\t\t\tvar val = $this.val();\n\t\t\treturn val;\n\n\t\t};\n\n\t\tthis.setValue = function( val ) {\n\n\t\t\tif ( !val && val !== 0 ) {\n\t\t\t\tval = '';\n\t\t\t}\n\n\t\t\t$this.val( val );\n\n\t\t};\n\n\t\tthis.setErrorStyle = function( errStr, show, isWarning ) {\n\t\t\tif ( isWarning ) {\n\t\t\t\t$( this ).addClass( 'warning-tip' );\n\t\t\t} else {\n\t\t\t\t$( this ).addClass( 'error-tip' );\n\t\t\t}\n\t\t\terror_string = errStr;\n\n\t\t\tif ( show ) {\n\t\t\t\tthis.showErrorTip();\n\t\t\t}\n\t\t};\n\n\t\tthis.showErrorTip = function( sec ) {\n\n\t\t\tif ( !Global.isSet( sec ) ) {\n\t\t\t\tsec = 2;\n\t\t\t}\n\n\t\t\tif ( !error_tip_box ) {\n\t\t\t\terror_tip_box = Global.loadWidgetByName( WidgetNamesDic.ERROR_TOOLTIP );\n\t\t\t\terror_tip_box = error_tip_box.ErrorTipBox();\n\t\t\t}\n\t\t\terror_tip_box.cancelRemove();\n\t\t\tif ( $( this ).hasClass( 'warning-tip' ) ) {\n\t\t\t\terror_tip_box.show( this, error_string, sec, true );\n\t\t\t} else {\n\t\t\t\terror_tip_box.show( this, error_string, sec );\n\t\t\t}\n\t\t};\n\n\t\tthis.hideErrorTip = function() {\n\n\t\t\tif ( Global.isSet( error_tip_box ) ) {\n\t\t\t\terror_tip_box.remove();\n\t\t\t}\n\n\t\t};\n\n\t\tthis.clearErrorStyle = function() {\n\t\t\t$( this ).removeClass( 'error-tip' );\n\t\t\t$( this ).removeClass( 'warning-tip' );\n\t\t\tthis.hideErrorTip();\n\t\t\terror_string = '';\n\t\t};\n\n\t\tthis.each( function() {\n\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\n\t\t\tfield = o.field;\n\t\t\thasKeyEvent = o.hasKeyEvent;\n\n\t\t\tif ( o.width > 0 ) {\n\t\t\t\t$this.width( o.width );\n\t\t\t}\n\n\t\t\t//NOTE: Do not add keyup/down events, as type-as-you-go validation should not be active on password fields.\n\t\t\t//  Specifically because they must match exactly and the timer causes one character to be missed it could give an incorrect validation failure.\n\t\t\t//  Also if they type slow enough it cause many password failures and they could be locked out before they finish typing their password.\n\t\t\t$( this ).change( function() {\n\t\t\t\t$this.trigger( 'formItemChange', [$this] );\n\t\t\t} );\n\n\t\t\t$( this ).mouseover( function() {\n\n\t\t\t\tif ( enabled ) {\n\t\t\t\t\tif ( error_string && error_string.length > 0 ) {\n\t\t\t\t\t\t$this.showErrorTip( 20 );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\t$( this ).mouseout( function() {\n\t\t\t\tif ( !$( $this ).is( ':focus' ) ) {\n\t\t\t\t\t$this.hideErrorTip();\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t$( this ).focusin( function() {\n\n\t\t\t\tif ( !enabled ) {\n\t\t\t\t\tif ( !check_box ) {\n\t\t\t\t\t\tif ( LocalCacheData.current_open_sub_controller &&\n\t\t\t\t\t\t\tLocalCacheData.current_open_sub_controller.edit_view &&\n\t\t\t\t\t\t\tLocalCacheData.current_open_sub_controller.is_viewing ) {\n\t\t\t\t\t\t\terror_string = LocalCacheData.current_open_sub_controller.getViewModeErrorMessage();\n\t\t\t\t\t\t\t$this.showErrorTip( 10 );\n\t\t\t\t\t\t} else if ( LocalCacheData.current_open_primary_controller &&\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.edit_view &&\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.is_viewing ) {\n\t\t\t\t\t\t\terror_string = LocalCacheData.current_open_primary_controller.getViewModeErrorMessage();\n\t\t\t\t\t\t\t$this.showErrorTip( 10 );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ( error_string && error_string.length > 0 ) {\n\t\t\t\t\t\t$this.showErrorTip( 20 );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\t$( this ).focusout( function() {\n\t\t\t\t$this.hideErrorTip();\n\t\t\t} );\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.TPasswordInput.defaults = {};\n\t$.fn.TPasswordInput.html_template = `<input type=\"password\" class=\"t-text-input\" autocomplete=\"new-password\"/>`;\n\n} )( jQuery );","( function( $ ) {\n\n\t$.fn.TComboBox = function( options ) {\n\t\tvar opts = $.extend( {}, $.fn.TComboBox.defaults, options );\n\t\tvar $this = this;\n\t\tvar field;\n\t\tvar source_data = null;\n\n\t\tvar select_value = null;\n\n\t\tvar set_empty = false;\n\n\t\tvar set_any = false;\n\n\t\tvar set_select_item_when_set_source_data = false;\n\n\t\tvar error_string = '';\n\n\t\tvar error_tip_box;\n\n\t\tvar mass_edit_mode = false;\n\n\t\tvar check_box = null;\n\n\t\tvar enabled = true;\n\n\t\tvar valueKey = 'value';\n\n\t\tvar labelKey = 'label';\n\n\t\tvar customFirstItemLabel = '';\n\n\t\tthis.setValueKey = function( val ) {\n\t\t\tvalueKey = val;\n\t\t};\n\n\t\tthis.setLabelKey = function( val ) {\n\t\t\tlabelKey = val;\n\t\t};\n\n\t\tthis.getEnabled = function() {\n\t\t\treturn enabled;\n\t\t};\n\n\t\tthis.setEnabled = function( val ) {\n\t\t\tenabled = val;\n\n\t\t\tif ( val === false || val === '' ) {\n\t\t\t\t$this.attr( 'disabled', 'true' );\n\t\t\t\t$this.addClass( 't-select-readonly' );\n\t\t\t} else {\n\t\t\t\t$this.removeAttr( 'disabled' );\n\t\t\t\t$this.removeClass( 't-select-readonly' );\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setCheckBox = function( val ) {\n\t\t\tif ( check_box ) {\n\t\t\t\tcheck_box.children().eq( 0 )[0].checked = val;\n\t\t\t}\n\t\t};\n\n\t\tthis.isChecked = function() {\n\t\t\tif ( check_box ) {\n\t\t\t\tif ( check_box.children().eq( 0 )[0].checked === true ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t};\n\n\t\tthis.setMassEditMode = function( val ) {\n\t\t\tmass_edit_mode = val;\n\n\t\t\tif ( mass_edit_mode ) {\n\t\t\t\tcheck_box = $( ' <div class=\"mass-edit-checkbox-wrapper\"><input type=\"checkbox\" class=\"mass-edit-checkbox\"></input>' +\n\t\t\t\t\t'<label for=\"checkbox-input-1\" class=\"input-helper input-helper--checkbox\"></label></div>' );\n\t\t\t\tcheck_box.insertBefore( $( this ) );\n\n\t\t\t\tcheck_box.change( function() {\n\t\t\t\t\t$this.trigger( 'formItemChange', [$this] );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tif ( check_box ) {\n\t\t\t\t\tcheck_box.remove();\n\t\t\t\t\tcheck_box = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setErrorStyle = function( errStr, show, isWarning ) {\n\t\t\tif ( isWarning ) {\n\t\t\t\t$( this ).addClass( 'warning-tip' );\n\t\t\t} else {\n\t\t\t\t$( this ).addClass( 'error-tip' );\n\t\t\t}\n\t\t\terror_string = errStr;\n\n\t\t\tif ( show ) {\n\t\t\t\tthis.showErrorTip();\n\t\t\t}\n\t\t};\n\n\t\tthis.showErrorTip = function( sec ) {\n\n\t\t\tif ( !Global.isSet( sec ) ) {\n\t\t\t\tsec = 2;\n\t\t\t}\n\n\t\t\tif ( !error_tip_box ) {\n\t\t\t\terror_tip_box = Global.loadWidgetByName( WidgetNamesDic.ERROR_TOOLTIP );\n\t\t\t\terror_tip_box = error_tip_box.ErrorTipBox();\n\t\t\t}\n\t\t\tif ( $( this ).hasClass( 'warning-tip' ) ) {\n\t\t\t\terror_tip_box.show( this, error_string, sec, true );\n\t\t\t} else {\n\t\t\t\terror_tip_box.show( this, error_string, sec );\n\t\t\t}\n\t\t};\n\n\t\tthis.hideErrorTip = function() {\n\n\t\t\tif ( Global.isSet( error_tip_box ) ) {\n\t\t\t\terror_tip_box.remove();\n\t\t\t}\n\n\t\t};\n\n\t\tthis.clearErrorStyle = function() {\n\t\t\t$( this ).removeClass( 'error-tip' );\n\t\t\t$( this ).removeClass( 'warning-tip' );\n\t\t\tthis.hideErrorTip();\n\t\t\terror_string = '';\n\t\t};\n\n\t\tthis.setField = function( val ) {\n\t\t\tfield = val;\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tthis.getLabel = function() {\n\n\t\t\tif ( !source_data || ( set_empty && source_data.length === 1 ) || ( set_any && source_data.length === 1 ) ) {\n\t\t\t\treturn select_value;\n\t\t\t}\n\t\t\t//if value is number convert to number type\n\t\t\tvar value = $( this ).children( 'option:selected' ).text();\n\n\t\t\treturn value;\n\t\t};\n\n\t\tthis.getValue = function() {\n\n\t\t\tif ( !source_data || ( set_empty && source_data.length === 1 ) || ( set_any && source_data.length === 1 ) ) {\n\t\t\t\treturn select_value;\n\t\t\t}\n\n\t\t\t//if value is number convert to number type\n\t\t\tvar value = $( this ).children( 'option:selected' ).attr( 'value' );\n\n\t\t\t//#2624 - Avoid parsing float value if we have a value larger than zero with a leading zero so that numeric string (eg province) ISO codes are not converted from '01' to 1\n\t\t\tif ( $.isNumeric( value ) && ( value === '0' || value.toString()[0] !== '0' ) ) {\n\t\t\t\tvalue = parseFloat( value );\n\t\t\t}\n\n\t\t\tif ( value === -1 || value === '-1' ) {\n\t\t\t\tvalue = -1;\n\t\t\t}\n\t\t\treturn value;\n\t\t};\n\n\t\tthis.getSelectedIndex = function() {\n\t\t\treturn this[0].selectedIndex;\n\t\t};\n\n\t\tthis.setSelectedIndex = function( set_index ) {\n\t\t\tif ( set_index < 0 ) {\n\t\t\t\tset_index = 0;\n\t\t\t}\n\t\t\tif ( set_index >= this[0].length ) {\n\t\t\t\tset_index = this[0].length - 1;\n\t\t\t}\n\t\t\tthis[0].selectedIndex = set_index;\n\t\t\tthis.setValue( this[0].value );\n\t\t}\n\t\t;\n\t\tthis.getLabel = function() {\n\t\t\t//if value is number convert to number type\n\t\t\tvar value = $( this ).children( 'option:selected' ).text();\n\t\t\treturn value;\n\t\t};\n\n\t\tthis.setValue = function( val ) {\n\t\t\tselect_value = val;\n\n\t\t\tif ( !source_data || source_data.length < 1 || ( set_empty && source_data.length === 1 ) || ( set_any && source_data.length === 1 ) ) {\n\t\t\t\tset_select_item_when_set_source_data = true;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t//When no value == undefined or null or default false\n\t\t\tif ( !Global.isSet( val ) || val === false ) {\n\t\t\t\tif ( set_empty ) {\n\t\t\t\t\tval = TTUUID.zero_id;\n\t\t\t\t} else if ( set_any ) {\n\t\t\t\t\tval = TTUUID.not_exist_id;\n\t\t\t\t} else {\n\t\t\t\t\t//If no empty value, default to select first item\n\t\t\t\t\tif ( source_data && source_data.length > 0 ) {\n\t\t\t\t\t\tthis.setValue( source_data[0][valueKey] );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$( $( this ).find( 'option' ) ).removeAttr( 'selected' );\n\n\t\t\t$( $( this ).find( 'option' ) ).filter( function() {\n\t\t\t\tif ( val === null || val === undefined ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn $( this ).attr( 'value' ) === val.toString();\n\t\t\t} ).prop( 'selected', true ).attr( 'selected', true );\n\t\t};\n\n\t\t/* jshint ignore:start */\n\t\tthis.setSourceData = function( val ) {\n\n\t\t\t$( this ).empty();\n\n\t\t\tif ( !Global.isSet( val ) || val.length < 1 ) {\n\t\t\t\tif ( set_empty ) {\n\t\t\t\t\tval = Global.addFirstItemToArray( val, 'empty', customFirstItemLabel );\n\t\t\t\t} else if ( set_any ) {\n\t\t\t\t\tval = Global.addFirstItemToArray( val, 'any', customFirstItemLabel );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif ( set_empty ) {\n\t\t\t\t\tif ( val && val.length > 0 && ( val[0].value != TTUUID.zero_id && val[0].value != 0 ) ) {\n\t\t\t\t\t\tval = Global.addFirstItemToArray( val, 'empty', customFirstItemLabel );\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( set_any ) {\n\t\t\t\t\tif ( val && val.length > 0 && ( val[0].value != TTUUID.not_exist_id && val[0].value != -1 ) ) {\n\t\t\t\t\t\tval = Global.addFirstItemToArray( val, 'any', customFirstItemLabel );\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsource_data = val;\n\t\t\t//var option_array = [];\n\n\t\t\tif ( $( this )[0] ) {\n\t\t\t\tif ( $.isArray( val ) ) {\n\t\t\t\t\tvar len = val.length;\n\t\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\t\t\t$( this ).append( $( '<option value=\"' + val[i][valueKey] + '\"></option>' ).text( val[i][labelKey] ) );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor ( var j in val ) {\n\t\t\t\t\t\t$( this ).append( $( '<option value=\"' + j + '\"></option>' ).text( val[j] ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( set_select_item_when_set_source_data ) {\n\t\t\t\tthis.setValue( select_value );\n\t\t\t}\n\n\t\t};\n\t\t/* jshint ignore:end */\n\n\t\tthis.each( function() {\n\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\n\t\t\tif ( o.set_empty ) {\n\t\t\t\tset_empty = o.set_empty;\n\t\t\t}\n\n\t\t\tif ( o.customFirstItemLabel ) {\n\t\t\t\tcustomFirstItemLabel = o.customFirstItemLabel;\n\t\t\t}\n\n\t\t\tif ( o.set_any ) {\n\t\t\t\tset_any = o.set_any;\n\t\t\t}\n\n\t\t\tif ( o.mass_edit_mode ) {\n\t\t\t\tmass_edit_mode = o.mass_edit_mode;\n\t\t\t}\n\n\t\t\tfield = o.field;\n\n\t\t\t$( this ).change( function() {\n\n\t\t\t\tif ( !enabled ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( check_box ) {\n\t\t\t\t\t$this.setCheckBox( true );\n\t\t\t\t}\n\n\t\t\t\t$this.trigger( 'formItemChange', [$this] );\n\t\t\t} );\n\n\t\t\t$( this ).click( function() {\n\t\t\t\tif ( !enabled ) {\n\t\t\t\t\tif ( !check_box ) {\n\t\t\t\t\t\tif ( LocalCacheData.current_open_sub_controller &&\n\t\t\t\t\t\t\tLocalCacheData.current_open_sub_controller.edit_view &&\n\t\t\t\t\t\t\tLocalCacheData.current_open_sub_controller.is_viewing ) {\n\t\t\t\t\t\t\terror_string = LocalCacheData.current_open_sub_controller.getViewModeErrorMessage();\n\t\t\t\t\t\t\t$this.showErrorTip( 10 );\n\t\t\t\t\t\t} else if ( LocalCacheData.current_open_primary_controller &&\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.edit_view &&\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.is_viewing ) {\n\t\t\t\t\t\t\terror_string = LocalCacheData.current_open_primary_controller.getViewModeErrorMessage();\n\t\t\t\t\t\t\t$this.showErrorTip( 10 );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t$( this ).mouseover( function() {\n\n\t\t\t\tif ( enabled ) {\n\t\t\t\t\tif ( error_string && error_string.length > 0 ) {\n\t\t\t\t\t\t$this.showErrorTip( 20 );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\t$( this ).mouseout( function() {\n\t\t\t\t$this.hideErrorTip();\n\t\t\t} );\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.TComboBox.defaults = {};\n\t$.fn.TComboBox.html_template = `<select class=\"t-select\"></select>`;\n\n} )( jQuery );","// css\nimport '@/main_ui-styles.js';\n// JS\nimport * as StackTrace from 'stacktrace-js'\n// import 'expose-loader?exposes=$,jQuery!jquery'; // Needs be done with expose otherwise other imports error \"jQuery/$ is not defined.\" e.g. plugins like i18n.\n// import _ from 'underscore'; // no longer needed here after importing differently in webpack config.\nimport 'backbone'; // does not seem to need expose loader.\nimport * as moment from 'moment';\nimport './framework/jquery.i18n.js';\nimport html2canvas from 'html2canvas';\n\n// Vue imports\nimport { createApp, reactive } from 'vue'; // If there are any errors relating to 'vue' remember the alias in webpack.config points to the vue runtime\nimport main_ui_router from '@/components/main_ui_router';\nimport TTMainUI from '@/components/TTMainUI.vue';\nimport PrimeVue from 'primevue/config';\nimport Tooltip from 'primevue/tooltip';\nimport Ripple from 'primevue/ripple';\nimport Toast from 'primevue/toast';\nimport ToastService from 'primevue/toastservice';\nimport BadgeDirective from 'primevue/badgedirective';\nimport TTEventBus from '@/services/TTEventBus';\n\n// import 'expose-loader?exposes=Global|Global!@/global/Global';\nimport { Global } from '@/global/Global';\nimport { LocalCacheData } from '@/global/LocalCacheData';\nimport { Base } from '@/model/Base';\nimport { BaseWindowController } from '@/views/BaseWindowController';\nimport { ServiceCaller } from '@/services/ServiceCaller';\nimport { BaseViewController } from '@/views/BaseViewController';\nimport { TTAPI } from '@/services/TimeTrexClientAPI';\nimport { NotificationConsumerObj } from '@/services/NotificationConsumer';\nimport { TTWebauthnObj } from '@/services/TTWebauthn';\nimport { TTSAMLObj } from '@/services/TTSAML';\nimport { IndexViewController } from '@/IndexController';\n// import { ReportBaseViewController } from '@/views/reports/ReportBaseViewController'; // Moved to post-login-app-dependancies\nimport { TTUUID } from '@/global/TTUUID';\nimport { TTPromise } from '@/global/TTPromise';// Potentially the same issue as ProgressBar (multiple instances, no single state), so lets just make it global to be safe.\nimport { ProgressBar } from '@/global/ProgressBarManager'; // Must only be imported in one place, otherwise multiple instances could be loaded and clash by leaving open Progressbars. e.g. Seen in TimeSheet\nimport { BaseWizardController } from '@/views/wizard/BaseWizardController';\nimport { PermissionManager } from '@/global/PermissionManager';\nimport { TAlertManager } from '@/global/TAlertManager';\n//import { TopMenuManager } from 'exports-loader?exports=TopMenuManager!@/global/TopMenuManager';\nimport ContextMenuManager from '@/components/context_menu/ContextMenuManager';\nimport MenuManager from '@/components/main_menu/MenuManager';\n\nimport '@/global/widgets/text_input/TTextInput.js';\nimport '@/global/widgets/text_input/TPasswordInput.js';\nimport '@/global/widgets/combobox/TComboBox.js';\n\n// Main execution for imported code\nwindow.html2canvas = html2canvas;\nwindow.StackTrace = StackTrace;\nwindow.moment = moment;\n// Function(jQueryBaResize)(); // Need this to execute in correct scope where this=window, otherwise the 'this' value in the jquery plugin results to {} instead of real window, as the 'this' param passed into the plugins IIFE is not window, but {}, which means `window` in plugin = {}. Results in error: \"TypeError: window[str_setTimeout] is not a function\"\n\n// not needed if cookie script included in html <script>\n// window.getCookie = getCookie;\n// window.setCookie = setCookie;\n// window.deleteCookie = deleteCookie;\n\n// Main execution for imported code\n// Define the globals for various plugins and views.\n// window.TTBackboneView = TTBackboneView;\nwindow.$ = window.jQuery = $; // #3028 This is needed because although webpack will handle any references to $/jQuery in our code, its done internally and not on the window. So 3rd party libraries will not find jQuery on the window.\nwindow.Global = Global;\nwindow.LocalCacheData = LocalCacheData;\nwindow.Base = Base;\nwindow.BaseWindowController = BaseWindowController;\nwindow.ServiceCaller = ServiceCaller;\nwindow.BaseViewController = BaseViewController;\nwindow.TTAPI = TTAPI;\nwindow.IndexViewController = IndexViewController;\n// window.ReportBaseViewController = ReportBaseViewController;\nwindow.TTUUID = TTUUID;\nwindow.TTPromise = TTPromise;\nwindow.ProgressBar = ProgressBar;\nwindow.BaseWizardController = BaseWizardController;\nwindow.PermissionManager = PermissionManager;\nwindow.TAlertManager = TAlertManager;\n//window.TopMenuManager = TopMenuManager;\nwindow.NotificationConsumer = NotificationConsumerObj;\nwindow.TTWebauthn = TTWebauthnObj;\nwindow.TTSAML = TTSAMLObj;\nwindow.ContextMenuManager = ContextMenuManager;\nwindow.MenuManager = MenuManager;\nwindow.TTEventBus = TTEventBus; // Only used for globals. Make sure to instantiate in every view you want to use.\n\n// TODO: At some point, the code in this file should be refactored into classes.\n\nwindow.addEventListener('load', loadViewRequiredJS);\n\n\n// Vue initialization\nconst tt_main_ui = createApp( TTMainUI );\n// PrimeVue Apollo globals\ntt_main_ui.directive('tooltip', Tooltip);\ntt_main_ui.directive('ripple', Ripple);\n// Vue.prototype.$appState = Vue.observable({inputStyle: 'outlined'});\n// Vue.prototype.$primevue = Vue.observable({ripple: true});\n// tt_main_ui.config.globalProperties.$appState = reactive({inputStyle: 'outlined'});\n// tt_main_ui.config.globalProperties.$primevue = reactive({ripple: true});\n\ntt_main_ui.config.globalProperties.$appState = reactive({ colorScheme: 'light' });\n// tt_main_ui.config.globalProperties.$primevue = reactive({ripple: true, inputStyle: 'filled'}); // From: AppConfig.vue this.$primevue.config.inputStyle value is filled/outlined\n\ntt_main_ui.use( PrimeVue, { ripple: true, inputStyle: 'filled' }); // From: AppConfig.vue this.$primevue.config.inputStyle value is filled/outlined as we dont use AppConfig in TT.\ntt_main_ui.use( ToastService );\ntt_main_ui.component( 'Toast', Toast );\ntt_main_ui.directive('badge', BadgeDirective); // Used mainly by notifications bell.\n\n//main_ui_router.isReady().then(() => app.mount('#app'))\ntt_main_ui.use( main_ui_router )\n   .mount( '#tt_main_ui' );\nwindow.VueRouter = main_ui_router; // #VueContextMenu# Allows the TT UI to trigger route changes from within BaseViewController.loadView or elsewhere.\n// End of Vue initialization\n\n//Don't not show loading bar if refresh\nif ( Global.isSet( LocalCacheData.getLoginUser() ) ) {\n\t$( '.loading-view' ).hide();\n} else {\n\tsetProgress();\n}\n\nfunction setProgress() {\n\twindow.loading_bar_time = setInterval( function() {\n\t\tvar progress_bar = $( '.progress-bar' );\n\t\tvar c_value = progress_bar.prop( 'value' );\n\n\t\tif ( c_value < 90 ) {\n\t\t\tprogress_bar.prop( 'value', c_value + 10 );\n\t\t}\n\t}, 1000 );\n}\n\nfunction cleanProgress() {\n\tif ( $( '.loading-view' ).is( ':visible' ) ) {\n\n\t\tvar progress_bar = $( '.progress-bar' );\n\t\tprogress_bar.prop( 'value', 100 );\n\t\tclearInterval( loading_bar_time );\n\n\t\tloading_bar_time = setInterval( function() {\n\t\t\t$( '.progress-bar-div' ).hide();\n\t\t\tclearInterval( loading_bar_time );\n\t\t}, 50 );\n\t}\n}\n\nwindow.is_browser_iOS = ( navigator.userAgent.match( /(iPad|iPhone|iPod)/g ) ? true : false );\n\n$( function() {\n\tGlobal.styleSandbox();\n\n\tcleanProgress();\n\n\tvar api_authentication = TTAPI.APIAuthentication;\n\n\tif ( Error ) {\n\t\tError.stackTraceLimit = 50; //Increase JS exception stack trace limit.\n\t}\n\n\t//BUG-2065 see also: require.onError()\n\twindow.onerror = function( error_msg, file, line, col, error_obj ) {\n\t\tif ( !arguments || arguments.length < 1 ) {\n\t\t\tGlobal.sendErrorReport( 'No error parameters when window.onerror', ServiceCaller.root_url, '', '', '' );\n\t\t} else {\n\t\t\tGlobal.sendErrorReport( error_msg, file, line, col, error_obj );\n\t\t}\n\t};\n\n\twindow.addEventListener( 'beforeunload', function( e ) {\n\t\t// Note that Google recommends against the following, as it affects page caching, but we dont want caching anyway: https://developers.google.com/web/updates/2018/07/page-lifecycle-api#the-beforeunload-event\n\t\tGlobal.sendAnalyticsEvent( 'browser', 'browser:beforeunload', 'browser:beforeunload' );\n\t\tif ( ( LocalCacheData.current_open_primary_controller && LocalCacheData.current_open_primary_controller.edit_view && LocalCacheData.current_open_primary_controller.is_changed == true )\n\t\t\t|| ( LocalCacheData.current_open_report_controller && LocalCacheData.current_open_report_controller.is_changed == true )\n\t\t\t|| ( LocalCacheData.current_open_edit_only_controller && LocalCacheData.current_open_edit_only_controller.is_changed == true )\n\t\t\t|| ( LocalCacheData.current_open_sub_controller && LocalCacheData.current_open_sub_controller.edit_view && LocalCacheData.current_open_sub_controller.is_changed == true )\n\t\t) {\n\t\t\te.preventDefault(); // Cancel the unload event\n\t\t\te.returnValue = ''; // Chrome requires returnValue to be set\n\t\t}\n\t} );\n\n\t$( 'body' ).addClass( 'login-bg' );\n\n\t//Load need API class\n\n\t$( document ).on( 'keydown', function( e ) {\n\t\tif ( e.which === 8 && !$( e.target ).is( 'input, textarea' ) ) {\n\t\t\te.preventDefault();\n\t\t}\n\t} );\n\n\t$( 'body' ).unbind( 'keydown' ).bind( 'keydown', function( e ) {\n\n\t\t//Tab key must go to next search text field if a search text field is selected, otherwise, tab closes awesomebox.\n\t\t//This allows consistent ui experience between awesomebox and default form input controls.\n\t\tif ( e.keyCode === 27 || e.keyCode === 13 || ( e.keyCode === 9 && e.target.type != 'text' ) ) {\n\t\t\tif ( LocalCacheData.openAwesomeBox ) {\n\t\t\t\tLocalCacheData.openAwesomeBox.onClose();\n\t\t\t}\n\n\t\t\tif ( LocalCacheData.openAwesomeBoxColumnEditor ) {\n\t\t\t\tLocalCacheData.openAwesomeBoxColumnEditor.onClose();\n\t\t\t}\n\t\t}\n\n\t\tif ( LocalCacheData.openAwesomeBox ) {\n\t\t\tif ( Global.isValidInputCodes( e.keyCode ) ) {\n\t\t\t\tLocalCacheData.openAwesomeBox.selectNextItem( e );\n\t\t\t}\n\t\t} else if ( LocalCacheData.current_open_primary_controller &&\n\t\t\tLocalCacheData.current_open_primary_controller.column_selector &&\n\t\t\tLocalCacheData.current_open_primary_controller.column_selector.is( ':visible' ) &&\n\t\t\tLocalCacheData.current_open_primary_controller.column_selector.has( $( ':focus' ) ).length > 0 ) {\n\t\t\tif ( Global.isValidInputCodes( e.keyCode ) ) {\n\t\t\t\tLocalCacheData.current_open_primary_controller.column_selector.selectNextItem( e );\n\t\t\t}\n\t\t}\n\n\t\tif ( LocalCacheData.current_open_wizard_controllers.length > 0 && e.keyCode === 13 ) {\n\t\t\tlet password_wizard = LocalCacheData.current_open_wizard_controllers.find( wizard => wizard.wizard_id === 'ResetPasswordWizardController' );\n\t\t\tif ( password_wizard && password_wizard.$el.hasClass( 'change-password-wizard' ) ) {\n\t\t\t\t!password_wizard.done_btn.attr( 'disabled' ) &&\n\t\t\t\te.target &&\n\t\t\t\te.target.type !== 'textarea' && password_wizard.onDoneClick();\n\t\t\t}\n\t\t}\n\n\t\tif ( ( e.keyCode === 65 && e.metaKey === true ) || ( e.keyCode === 65 && e.ctrlKey === true ) ) {\n\t\t\tif ( e.target.nodeName != \"INPUT\" && e.target.nodeName != \"TEXTAREA\" ) {\n\t\t\t\te.preventDefault();\n\t\t\t\tselectAll();\n\t\t\t}\n\t\t}\n\n\t\tif ( e.keyCode === 36 ) {\n\t\t\tgridScrollTop();\n\t\t}\n\n\t\tif ( e.keyCode === 35 ) {\n\t\t\tgridScrollDown();\n\t\t}\n\n\t\t// keyboard event to quick search permission adropdown\n\t\tif ( LocalCacheData.current_open_primary_controller &&\n\t\t\tLocalCacheData.current_open_primary_controller.viewId === 'PermissionControl' &&\n\t\t\tLocalCacheData.current_open_primary_controller.edit_view ) {\n\t\t\tLocalCacheData.current_open_primary_controller.onKeyDown( e );\n\t\t}\n\n\t} );\n\n\tif ( window._addToDebugClickStack === undefined ) {\n\t\twindow._addToDebugClickStack = function( e ) {\n\t\t\t// Must collect click data on 'event capture phase' vs bubbling phase, so the click is recorded as soon as possible, before any potential errors prevent the recording of last click.\n\t\t\t// Function added to window, to prevent duplicate click listeners (JS wont add duplicate listeners referencing the same function). More context at https://stackoverflow.com/questions/38939937/when-are-duplicate-event-listeners-discarded-and-when-are-they-not\n\t\t\tvar ui_clicked_date = new Date();\n\t\t\tvar ui_stack = {\n\t\t\t\ttarget_class: $( e.target ).attr( 'class' ) ? $( e.target ).attr( 'class' ) : '',\n\t\t\t\ttarget_id: $( e.target ).attr( 'id' ) ? $( e.target ).attr( 'id' ) : '',\n\t\t\t\thtml: e.target.outerHTML,\n\t\t\t\tui_clicked_date: ui_clicked_date.toISOString()\n\t\t\t};\n\t\t\tif ( LocalCacheData.ui_click_stack.length === 16 ) {\n\t\t\t\tLocalCacheData.ui_click_stack.pop();\n\t\t\t}\n\n\t\t\tLocalCacheData.ui_click_stack.unshift( ui_stack );\n\n\t\t};\n\t\twindow.addEventListener( 'click', window._addToDebugClickStack, true ); // true is to set listener on 'event capture phase', so the click is recorded as soon as possible, before any potential errors prevent the recording of last click.\n\t}\n\n\t$( 'body' ).unbind( 'mousedown' ).bind( 'mousedown', function( e ) {\n\t\t// MUST COLLECT DATA WHEN MOUSE down, otherwise when do save in edit view when awesomebox open, the data can't be saved.\n\t\t// Mouse down to collect data so for some actions like search can read select data in its click event\n\t\tif ( LocalCacheData.openAwesomeBox && LocalCacheData.openAwesomeBox.getADropDown() && LocalCacheData.openAwesomeBox.getADropDown().has( e.target ).length < 1 ) {\n\t\t\tif ( $( e.target ).hasClass( 'a-combobox' ) ) {\n\t\t\t\tvar target = LocalCacheData.openAwesomeBox;\n\t\t\t\t$( e.target ).unbind( 'mouseup' ).bind( 'mouseup', function( e ) {\n\t\t\t\t\ttarget.find( '.focus-input' ).focus();\n\t\t\t\t\t$( e.target ).unbind( 'mouseup' );\n\t\t\t\t} );\n\t\t\t}\n\t\t\tLocalCacheData.openAwesomeBox.onClose();\n\t\t}\n\n\t\t//This closes pickers and dropdown boxes when clicking off them.\n\t\tif ( LocalCacheData.openRangerPicker && !LocalCacheData.openRangerPicker.getIsMouseOver() ) {\n\t\t\tLocalCacheData.openRangerPicker.close();\n\t\t}\n\n\t\tif ( LocalCacheData.openAwesomeBoxColumnEditor && !LocalCacheData.openAwesomeBoxColumnEditor.getIsMouseOver() ) {\n\t\t\tLocalCacheData.openAwesomeBoxColumnEditor.onClose();\n\t\t}\n\n\t\tif ( LocalCacheData.openRibbonNaviMenu && !LocalCacheData.openRibbonNaviMenu.getIsMouseOver() ) {\n\t\t\tLocalCacheData.openRibbonNaviMenu.close();\n\t\t}\n\n\t} );\n\n\tServiceCaller.base_url = Global.getBaseURL( '../../', false );\n\tServiceCaller.base_api_url = 'api/json/api.php';\n\tServiceCaller.root_url = Global.getRootURL();\n\n\tvar loginData = {};\n\t//Set in APIGlobal.php\n\tif ( !need_load_pre_login_data ) {\n\t\tloginData = APIGlobal.pre_login_data;\n\t} else {\n\t\tneed_load_pre_login_data = false;\n\t}\n\tif ( !loginData.hasOwnProperty( 'api_base_url' ) ) {\n\t\tapi_authentication.getPreLoginData( null, {\n\t\t\tonResult: function( e ) {\n\n\t\t\t\tvar result = e.getResult();\n\n\t\t\t\tLocalCacheData.setLoginData( result );\n\t\t\t\tAPIGlobal.pre_login_data = result;\n\n\t\t\t\tloginData = LocalCacheData.getLoginData();\n\t\t\t\tinitApps();\n\n\t\t\t}\n\t\t} );\n\t} else {\n\t\tLocalCacheData.setLoginData( loginData ); //set here because the loginData is set from php\n\t\tinitApps();\n\t}\n\tinitAnalytics();\n\n\tfunction initAnalytics() {\n\t\t/* jshint ignore:start */\n\t\tif ( APIGlobal.pre_login_data.analytics_enabled === true && ServiceCaller && ServiceCaller.root_url && loginData && loginData.base_url ) {\n\t\t\tif ( APIGlobal.pre_login_data.analytics_tracking_code != '' ) {\n\t\t\t\ttry {\n\t\t\t\t\tvar gtag_script = document.createElement( 'script' );\n\t\t\t\t\tgtag_script.setAttribute( 'src', 'https://www.googletagmanager.com/gtag/js?id=' + APIGlobal.pre_login_data.analytics_tracking_code ); //The JS isn't static, so load it remotely instead.\n\t\t\t\t\tdocument.head.appendChild( gtag_script );\n\n\t\t\t\t\twindow.dataLayer = window.dataLayer || [];\n\t\t\t\t\twindow.gtag = function gtag() {\n\t\t\t\t\t\twindow.dataLayer.push( arguments );\n\t\t\t\t\t}\n\t\t\t\t\tgtag( 'js', new Date() );\n\t\t\t\t\tgtag( 'config', APIGlobal.pre_login_data.analytics_tracking_code, {\n\t\t\t\t\t\t'debug_mode': !APIGlobal.pre_login_data.production,\n\t\t\t\t\t\t'send_page_view': false\n\t\t\t\t\t} );\n\n\t\t\t\t\t//Do not check exitstance of LocalCacheData with if(LocalCacheData) or JS will execute the unnamed function it uses as a constructor\n\t\t\t\t\tif ( LocalCacheData.loginUser ) {\n\t\t\t\t\t\tvar current_company = LocalCacheData.getCurrentCompany();\n\t\t\t\t\t\tGlobal.setAnalyticDimensions( LocalCacheData.getLoginUser().first_name + ' (' + LocalCacheData.getLoginUser().id + ')', current_company.name );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tGlobal.setAnalyticDimensions();\n\t\t\t\t\t}\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\tthrow e; //Attempt to catch any errors thrown by Google Analytics.\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( APIGlobal.pre_login_data.ui_tracking_code != '' ) {\n\t\t\t\ttry {\n\t\t\t\t\tvar script = document.createElement( 'script' );\n\t\t\t\t\tscript.type = 'text/javascript';\n\t\t\t\t\tscript.async = true;\n\t\t\t\t\tscript.innerHTML = `(function(c,l,a,r,i,t,y){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};t=l.createElement(r);t.async=1;t.src=\"https://www.clarity.ms/tag/\"+i;y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);})(window, document, \"clarity\", \"script\", \"` + APIGlobal.pre_login_data.ui_tracking_code + `\");`;\n\t\t\t\t\tdocument.head.appendChild( script );\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\tthrow e; //Attempt to catch any errors thrown.\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t/* jshint ignore:end */\n\t}\n\n\tfunction initApps() {\n\t\tTAlertManager.showBrowserTopBanner(); //Checks for supported browser versions and display banner if not.\n\n\t\t// \tloadViewRequiredJS(); // Moved to top of document, waiting on 'load' completion, to load after the 'red line'\n\n\t\t//Optimization: Only change locale if its *not* en_US or enable_default_language_translation = TRUE\n\t\tif ( loginData.locale !== 'en_US' || loginData.enable_default_language_translation == true ) {\n\t\t\tGlobal.loadLanguage( loginData.locale );\n\t\t\tDebug.Text( 'Using Locale: ' + loginData.locale, 'main.js', '', 'initApps', 1 );\n\t\t} else {\n\t\t\tLocalCacheData.setI18nDic( {} );\n\t\t}\n\n\t\t$.i18n.load( LocalCacheData.getI18nDic() );\n\t\tGlobal.initStaticStrings();\n\n\t\tLocalCacheData.deployment_on_demand = loginData.deployment_on_demand;\n\t\tLocalCacheData.productEditionId = loginData.product_edition;\n\t\tvar controller = new IndexViewController(); //Even though controller variable is not used, this must be called.\n\n\t\tvar alternate_session_data = getCookie( 'AlternateSessionData' );\n\t\tif ( alternate_session_data ) {\n\t\t\ttry { //Prevent JS exception if we can't parse alternate_session_data for some reason.\n\t\t\t\talternate_session_data = JSON.parse( alternate_session_data );\n\t\t\t\tif ( alternate_session_data && alternate_session_data.previous_session_id ) {\n\t\t\t\t\tTAlertManager.showPreSessionAlert();\n\t\t\t\t}\n\t\t\t} catch ( e ) {\n\t\t\t\tDebug.Text( e.message, 'main.js', 'require', 'initApps', 10 );\n\t\t\t}\n\t\t}\n\n\t\t//When the user switched away from, then back again to our tab, make sure the session is still the same so they don't get two different login sessions confused.\n\t\tfunction handleVisibilityChange() {\n\t\t\t//No need to handle anything if installer is enabled.\n\t\t\tif ( APIGlobal.pre_login_data && APIGlobal.pre_login_data.installer_enabled && APIGlobal.pre_login_data.installer_enabled == true ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tvar is_hidden = document.hidden;\n\t\t\tvar cookie_session_id = getCookie( Global.getSessionIDKey() );\n\n\t\t\tDebug.Text( 'Tab Visibility Change: ' + is_hidden + ' Session ID: ' + LocalCacheData.getSessionID(), 'main.js', '', 'handleVisibilityChange', 10 );\n\n\t\t\tif ( is_hidden == false ) {\n\t\t\t\t//Check to make sure our session_id matches what the server returns.\n\t\t\t\t//  When duplicating a tab or middle clicking a menu item, then switching to the new tab immediately, LocalCacheData.getSessionID() could be blank.\n\t\t\t\t//    So since its doing a browser refresh anyways, prevent that from triggering this message and another reload.\n\t\t\t\tif ( LocalCacheData.getSessionID() != '' && cookie_session_id != LocalCacheData.getSessionID() ) {\n\t\t\t\t\tDebug.Text( 'Session ID has changed out from out underneath us! Session ID: Memory: ' + LocalCacheData.getSessionID() + ' Cookie: ' + cookie_session_id, 'main.js', '', 'handleVisibilityChange', 1 );\n\n\t\t\t\t\tvar api = TTAPI.APIAuthentication;\n\t\t\t\t\tapi.isLoggedIn( false, {\n\t\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\t\t\t\tif ( result_data === true && cookie_session_id != LocalCacheData.getSessionID() ) { //Recheck the cookie/session ID as they could have changed by this point due to the API call taking some time to finish.\n\t\t\t\t\t\t\t\tTAlertManager.showAlert( $.i18n._( 'It appears that you have logged in from another web browser window or tab.<br><br>Please be patient while the session is resumed here...' ), 'Session Changed', function() {\n\t\t\t\t\t\t\t\t\tGlobal.sendAnalyticsEvent( 'session', 'session:changed', 'session:changed' );\n\t\t\t\t\t\t\t\t\twindow.location.reload( true );\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t//Don't do Logout here, as we need to display a \"Session Expired\" message to the user, which is triggered from the ServiceCaller.\n\t\t\t\t\t\t\t\t//  In order to trigger that though, we need to make an *Authenticated* API call to APIMisc.Ping(), rather than UnAuthenticated call to APIAuthentication.Ping()\n\t\t\t\t\t\t\t\tvar api = TTAPI.APIMisc;\n\t\t\t\t\t\t\t\tapi.ping( {\n\t\t\t\t\t\t\t\t\tonResult: function() {\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\twindow.addEventListener( 'visibilitychange', handleVisibilityChange );\n\t}\n\n\tfunction gridScrollDown() {\n\t\tif ( LocalCacheData.openAwesomeBox &&\n\t\t\t_.isFunction( LocalCacheData.openAwesomeBox.gridScrollDown ) ) {\n\t\t\tLocalCacheData.openAwesomeBox.gridScrollDown();\n\t\t\treturn;\n\t\t}\n\n\t\tif ( LocalCacheData.current_open_sub_controller ) {\n\t\t\tif ( !LocalCacheData.current_open_sub_controller.edit_view &&\n\t\t\t\t_.isFunction( LocalCacheData.current_open_sub_controller.gridScrollDown ) ) {\n\t\t\t\tLocalCacheData.current_open_sub_controller.gridScrollDown();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif ( LocalCacheData.current_open_primary_controller ) {\n\t\t\tif ( !LocalCacheData.current_open_primary_controller.edit_view &&\n\t\t\t\t_.isFunction( LocalCacheData.current_open_primary_controller.gridScrollDown ) ) {\n\t\t\t\tLocalCacheData.current_open_primary_controller.gridScrollDown();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\n\tfunction gridScrollTop() {\n\t\tif ( LocalCacheData.openAwesomeBox &&\n\t\t\t_.isFunction( LocalCacheData.openAwesomeBox.gridScrollTop ) ) {\n\t\t\tLocalCacheData.openAwesomeBox.gridScrollTop();\n\t\t\treturn;\n\t\t}\n\t\tif ( LocalCacheData.current_open_sub_controller ) {\n\t\t\tif ( !LocalCacheData.current_open_sub_controller.edit_view &&\n\t\t\t\t_.isFunction( LocalCacheData.current_open_sub_controller.gridScrollTop ) ) {\n\t\t\t\tLocalCacheData.current_open_sub_controller.gridScrollTop();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\t//Error: Uncaught TypeError: LocalCacheData.current_open_primary_controller.gridScrollTop is not a function in interface/html5/main.js?v=9.0.2-20151106-092147 line 434\n\t\tif ( LocalCacheData.current_open_primary_controller ) {\n\t\t\tif ( !LocalCacheData.current_open_primary_controller.edit_view &&\n\t\t\t\t_.isFunction( LocalCacheData.current_open_primary_controller.gridScrollTop ) ) {\n\t\t\t\tLocalCacheData.current_open_primary_controller.gridScrollTop();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\n\tfunction selectAll() {\n\t\t//Check for open alert dialog and select all text in it.\n\t\tlet alert = document.querySelector( '.t-alert' );\n\t\tif ( alert ) {\n\t\t\tlet content_div = alert.querySelector( '.content-div' );\n\t\t\tif ( content_div ) {\n\t\t\t\tlet range = document.createRange();\n\t\t\t\trange.selectNodeContents( content_div );\n\t\t\t\tlet selection = window.getSelection();\n\t\t\t\tselection.removeAllRanges();\n\t\t\t\tselection.addRange( range );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t//Error: Uncaught TypeError: LocalCacheData.current_open_primary_controller.selectAll is not a function in interface/html5/main.js?v=9.0.4-20151123-121757 line 457\n\t\tif ( LocalCacheData.openAwesomeBox &&\n\t\t\t_.isFunction( LocalCacheData.openAwesomeBox.selectAll ) ) {\n\t\t\tLocalCacheData.openAwesomeBox.selectAll();\n\t\t\treturn;\n\t\t}\n\n\t\tif ( LocalCacheData.current_open_sub_controller ) {\n\n\t\t\tif ( !LocalCacheData.current_open_sub_controller.edit_view &&\n\t\t\t\t_.isFunction( LocalCacheData.current_open_sub_controller.selectAll ) ) {\n\t\t\t\tLocalCacheData.current_open_sub_controller.selectAll();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif ( LocalCacheData.current_open_primary_controller ) {\n\t\t\tif ( !LocalCacheData.current_open_primary_controller.edit_view &&\n\t\t\t\t_.isFunction( LocalCacheData.current_open_primary_controller.selectAll ) ) {\n\t\t\t\tLocalCacheData.current_open_primary_controller.selectAll();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t};\n\n} );\n\nfunction loadViewRequiredJS() {\n\tLocalCacheData.loadViewRequiredJSReady = false; // #2848 Set to true was moved to post-login-main_ui-dependancies.js to ensure all dependancies fully loaded.\n\n\t//Revert jQuery preFilter behavior in v3.5.0 back to pre-v3.5.0 so it doesn't break jqGrid getGridParam( 'colModel' ).\n\t// Attendance -> TimeSheet, expand employee dropdown, click icon to customize columns, triggers JS exception: Uncaught TypeError: Cannot read property 'width' of undefined\n\tvar rxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\\/\\0>\\x20\\t\\r\\n\\f]*)[^>]*)\\/>/gi;\n\tjQuery.htmlPrefilter = function( html ) {\n\t\treturn html.replace( rxhtmlTag, \"<$1></$2>\" );\n\t};\n\n\timport(\n\t\t'@/post-login-main_ui-vendor-dependancies.js'\n\t).catch( Global.importErrorHandler );\n}\n","import { TTBackboneView } from '@/views/TTBackboneView';\nimport { TTAPI } from '@/services/TimeTrexClientAPI';\nimport 'bootstrap';\n\nexport class PortalForgotPasswordController extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tevents: {\n\t\t\t\t'click .send-reset-email': 'sendResetEmail',\n\t\t\t\t'click .close-reset-email': 'closeResetEmail'\n\t\t\t}\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( options ) {\n\t\tsuper.initialize( options );\n\t\tthis.api = TTAPI.APIRecruitmentAuthentication;\n\t\tvar el = Global.loadWidget( 'views/portal/sign_in/PortalForgotPassword.html' );\n\t\tthis.setElement( _.template( el )() );\n\t\tthis.emailInput = this.$( '#email' );\n\t\tthis.render();\n\t}\n\n\trender() {\n\t\tvar $this = this;\n\t\tthis.emailInput.focus();\n\t\tthis.emailInput.unbind( 'keydown' ).bind( 'keydown', function( e ) {\n\t\t\tif ( e.keyCode === 13 ) {\n\t\t\t\t$this.sendResetEmail();\n\t\t\t}\n\t\t} );\n\t\t$( 'body' ).append( this.$el );\n\t\tconst modal = new bootstrap.Modal( this.$el[0], {\n\t\t\tbackdrop: 'static'\n\t\t} );\n\n\t\tmodal.show();\n\t}\n\n\tsendResetEmail() {\n\t\tvar $this = this;\n\t\tvar email = this.emailInput.val();\n\t\tthis.api.resetPassword( email, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tif ( !result.isValid() ) {\n\t\t\t\t\t$this.showErrorAlert( result );\n\t\t\t\t} else {\n\t\t\t\t\tvar response = result.getResult();\n\t\t\t\t\tif ( response.hasOwnProperty( 'email_sent' ) ) { // make sure email if is sent successfully\n\t\t\t\t\t\tbootstrap.Modal.getInstance( $this.$el[0] ).hide();\n\t\t\t\t\t\tIndexViewController.instance.router.showTipModal( $.i18n._( 'An email has been sent to you with instructions on how to reset your password.' ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tcloseResetEmail() {\n\t\tbootstrap.Modal.getInstance( this.$el[0] ).hide();\n\t}\n\n\tshowErrorAlert( result ) {\n\t\tvar details = result.getDetails();\n\t\t// if ( details.hasOwnProperty( 'error' ) ) {\n\t\t//\n\t\t// }\n\t\tif ( !details ) {\n\t\t\tdetails = result.getDescription(); // If the details is empty, try to get description to show.\n\t\t}\n\t\tvar error_string = '';\n\n\t\tif ( Global.isArray( details ) || typeof details === 'object' ) {\n\n\t\t\t$.each( details, function( index, val ) {\n\n\t\t\t\tif ( val.hasOwnProperty( 'error' ) ) {\n\t\t\t\t\tval = val.error;\n\t\t\t\t}\n\t\t\t\tvar i = 0;\n\t\t\t\tfor ( var key in val ) {\n\t\t\t\t\terror_string = error_string + val[key];\n\t\t\t\t\tif ( i > 0 ) {\n\t\t\t\t\t\terror_string += '<br>';\n\t\t\t\t\t}\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\terror_string = details;\n\t\t}\n\t\tthis.emailInput.css( 'border', '1px solid red' );\n\t\tconst tooltip = new bootstrap.Tooltip( this.emailInput[0], {\n\t\t\ttitle: error_string\n\t\t} );\n\n\t\ttooltip.show();\n\t}\n\n}","import { TTBackboneView } from '@/views/TTBackboneView';\nimport { TTAPI } from '@/services/TimeTrexClientAPI';\nimport { TTUUID } from '@/global/TTUUID';\nimport { ServiceCaller } from '@/services/ServiceCaller';\n\nexport class HeaderUploadResumeWidget extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( options ) {\n\t\tsuper.initialize( options );\n\t\tvar tpl = Global.loadWidget( 'views/portal/header/HeaderUploadResumeWidget.html' );\n\t\tthis.setElement( _.template( tpl )() );\n\t\tthis.document_id = null;\n\t\tthis.profileView = null;\n\t\tif ( options.profileView ) {\n\t\t\tthis.profileView = options.profileView;\n\t\t}\n\t\t// this.render();\n\t}\n\n\trender() {\n\t\tvar $this = this;\n\t\tif ( !this.uploader ) {\n\t\t\tthis.uploader = this.$( '.register-resume' ).TImageBrowser( {\n\t\t\t\tfield: 'file',\n\t\t\t\tname: 'file_data',\n\t\t\t\taccept_filter: '*',\n\t\t\t\tchangeHandler: function( a ) {\n\t\t\t\t\tvar file_name = $( this ).find( '.browser' )[0].files[0].name;\n\t\t\t\t\t$this.$( '#fileName' ).val( file_name );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\tIndexViewController.instance.router.showFormModal( this.$el, {\n\t\t\ttitle: $.i18n._( 'Upload Resume' ),\n\t\t\tactions: [\n\t\t\t\t{ label: 'Close', isClose: true },\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Upload Resume' ), callBack: function( e ) {\n\t\t\t\t\t\t$this.uploadResume();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t} );\n\t}\n\n\tuploadResume() {\n\t\tvar $this = this;\n\t\tif ( !this.uploader ) {\n\t\t\treturn false;\n\t\t}\n\t\tvar uploader = this.uploader;\n\t\tvar name = uploader.attr( 'file_name' );\n\t\tvar file = uploader.getValue();\n\t\tif ( file ) {\n\t\t\tthis.document_api = TTAPI.APIDocumentPortal;\n\t\t\tvar document_name = 'Resume' + ' - ' + LocalCacheData.getPortalLoginUser().first_name + ' ' + LocalCacheData.getPortalLoginUser().last_name;\n\t\t\tvar result = this.document_api.addAttachment( document_name, '', { async: false } ).getResult();\n\t\t\tthis.document_id = result['document_id'];\n\t\t\tthis.uploadFile( file, result['document_revision_id'] );\n\t\t}\n\t}\n\n\tuploadFile( file_data, document_revision_id ) {\n\t\tvar $this = this;\n\t\tvar url = ServiceCaller.getAPIURL( 'Class=' + this.document_api.className + '&Method=uploadAttachment' + '&v=2' );\n\t\tif ( LocalCacheData.getAllURLArgs() ) {\n\t\t\tif ( LocalCacheData.getAllURLArgs().hasOwnProperty( 'company_id' ) ) {\n\t\t\t\turl = url + '&company_id=' + LocalCacheData.getAllURLArgs().company_id;\n\t\t\t}\n\t\t}\n\t\turl = url + '&object_id=' + document_revision_id;\n\t\tvar message_id = TTUUID.generateUUID();\n\t\tProgressBar.showProgressBar( message_id );\n\t\tProgressBar.changeProgressBarMessage( $.i18n._( 'File Uploading' ) + '...' );\n\t\t$.ajax( {\n\t\t\turl: url, //Server script to process data\n\t\t\theaders: {\n\t\t\t\t//Handle CSRF tokens and related headers here.\n\t\t\t\t'X-Client-ID': 'Browser-TimeTrex',\n\t\t\t\t'X-CSRF-Token': getCookie( 'CSRF-Token' ),\n\t\t\t},\n\t\t\ttype: 'POST',\n\t\t\tdata: file_data,\n\t\t\tsuccess: function( res ) {\n\t\t\t\tProgressBar.removeProgressBar();\n\t\t\t\t$this.uploaded();\n\t\t\t\tif ( res.error ) {\n\t\t\t\t\t$this.showUploadedMessage( res.error );\n\t\t\t\t} else {\n\t\t\t\t\t$this.showUploadedMessage( $.i18n._( 'Upload Successful!' ) );\n\t\t\t\t\t$this.refreshSubDocument();\n\t\t\t\t}\n\t\t\t},\n\t\t\tcache: false,\n\t\t\tcontentType: false,\n\t\t\tprocessData: false\n\t\t} );\n\t}\n\n\trefreshSubDocument() {\n\t\tif ( this.profileView ) {\n\t\t\tthis.profileView.addDocumentRow( this.document_id );\n\t\t}\n\t}\n\n\tuploaded() {\n\t\tthis.uploader = null;\n\t\tIndexViewController.instance.router.hideFormModal();\n\t}\n\n\tshowUploadedMessage( message ) {\n\t\tIndexViewController.instance.router.showTipModal( message );\n\t}\n}","import { TTBackboneView } from '@/views/TTBackboneView';\n\nexport class PortalJobVacancyRowController extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( options ) {\n\t\tsuper.initialize( options );\n\t\tvar $this = this;\n\t\tvar row = Global.loadWidget( 'views/portal/hr/recruitment/PortalJobVacancyRow.html' );\n\t\tfor ( var key in this.model.attributes ) {\n\t\t\tif ( this.model.get( key ) == false ) {\n\t\t\t\tthis.model.set( key, '' );\n\t\t\t}\n\t\t}\n\t\tthis.setElement( _.template( row )( this.model.toJSON() ) );\n\t\tthis.$el.on( 'click', function( e ) {\n\t\t\twindow.location = Global.getBaseURL( null, true, true ).replace(/#!m=.*?(&|$)/g, '#!m=PortalJobVacancyDetail&id=' + $this.model.id + '$1'); //Be sure to include any other URL args.\n\t\t} );\n\t}\n}\n","import { TTBackboneView } from '@/views/TTBackboneView';\n\nexport class QuickPunchBaseViewController extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {} );\n\n\t\tsuper( options );\n\t}\n\n\t// getRequiredFiles() {\n\t// \t//override in child class\n\t// \treturn [];\n\t// }\n\n\t/**\n\t * When changing this function, you need to look for all occurences of this function because it was needed in several bases\n\t * BaseViewController, HomeViewController, BaseWizardController, QuickPunchBaseViewControler\n\t *\n\t * @returns {Array}\n\t */\n\t// filterRequiredFiles() {\n\t// \tvar retval = [];\n\t// \tvar required_files;\n\t//\n\t// \tif ( typeof this._required_files == 'object' ) {\n\t// \t\trequired_files = this._required_files;\n\t// \t} else {\n\t// \t\trequired_files = this.getRequiredFiles();\n\t// \t}\n\t//\n\t// \tif ( required_files && required_files[0] ) {\n\t// \t\tretval = required_files;\n\t// \t} else {\n\t// \t\tfor ( var edition_id in required_files ) {\n\t// \t\t\tif ( Global.getProductEdition() >= edition_id ) {\n\t// \t\t\t\tretval = retval.concat( required_files[edition_id] );\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\t//\n\t// \tDebug.Arr( retval, 'RETVAL', 'BaseViewController.js', 'BaseViewController', 'filterRequiredFiles', 10 );\n\t// \treturn retval;\n\t// }\n}\n","/**\n * For an example of implementation see: interface/html5/views/payroll/remittance_wizard/PayrollRemittanceAgencyEventWizard.js\n *\n * CRITICAL: ALL WIZARDS MUST HAVE A HOME STEP SO THAT THEY HAVE SOMEWHERE TO START.\n **/\n\nimport { TTBackboneView } from '@/views/TTBackboneView';\n\nexport class Wizard extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tcurrent_step: false,\n\t\t\twizard_id: 'generic_wizard',\n\t\t\twizard_name: $.i18n._( 'Wizard' ),\n\t\t\tstep_history: {},\n\t\t\tstep_objects: {},\n\t\t\tel: $( '.wizard' ),\n\t\t\tprevious_wizard: null,\n\t\t\t_step_map: null,\n\t\t\tdo_not_initialize_onload: false, //when this flag is set, initialize will not be run automagically.\n\t\t\texternal_data: null,\n\t\t\tevents: {\n\t\t\t\t'click .close-btn': 'onCloseClick',\n\t\t\t\t'click .close-icon': 'onCloseClick',\n\t\t\t\t'click .wizard-overlay.onclick-close': 'onCloseClick',\n\t\t\t\t'click .forward-btn': 'onNextClick',\n\t\t\t\t'click .back-btn': 'onPrevClick',\n\t\t\t\t'click .done-btn': 'onDone'\n\t\t\t}\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( options ) {\n\t\tsuper.initialize( options );\n\n\t\tif ( options && options.external_data ) {\n\t\t\tthis.setExternalData( options.external_data );\n\t\t}\n\n\t\tif ( !this.do_not_initialize_onload ) {\n\t\t\tthis.step_history = {};\n\t\t\tthis.step_objects = {};\n\t\t\tvar $this = this;\n\n\t\t\tthis.initStepObject( ( this.getCurrentStepName() ? this.getCurrentStepName() : 'home' ), function( obj ) {\n\t\t\t\t$this.init();\n\t\t\t\t$this.render();\n\t\t\t\t$this.enableButtons();\n\n\n\t\t\t\tif ( $this.wizard_id === null ) {\n\t\t\t\t\t$this.wizard_id = $this.constructor.name;\n\t\t\t\t}\n\n\t\t\t\tif ( LocalCacheData.current_open_wizard_controllers.some( wizard => wizard.wizard_id === $this.wizard_id ) ) {\n\t\t\t\t\t$this.previous_wizard = LocalCacheData.current_open_wizard_controllers.find( wizard => wizard.wizard_id === $this.wizard_id );\n\t\t\t\t} else {\n\t\t\t\t\t$this.previous_wizard = false;\n\t\t\t\t}\n\n\t\t\t\tLocalCacheData.current_open_wizard_controllers.push( $this );\n\t\t\t} );\n\t\t}\n\t}\n\n\t//always override\n\tinit() {\n\t\treturn;\n\t}\n\n\tsetExternalData( data ) {\n\t\tthis.external_data = data;\n\t}\n\n\tgetExternalData() {\n\t\treturn this.external_data;\n\t}\n\n\tonNextClick( e ) {\n\t\tif ( this.button_click_procesing == true ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( this.getStepObject().isRequiredButtonsClicked() == false ) { //On last step.\n\t\t\tvar $this = this;\n\t\t\tTAlertManager.showConfirmAlert( $.i18n._( '<strong>WARNING</strong>: You are about to proceed to the next step without performing all required actions! <br><br><strong>This may result in payments or reports not being submitted to this agency.</strong> <br><br>Are you sure you wish to continue?<br><br>' ), null, function( flag ) {\n\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t//Log the fact that the user skipped a step.\n\t\t\t\t\tvar api_payroll_remittance_agency_event = TTAPI.APIPayrollRemittanceAgencyEvent;\n\t\t\t\t\tapi_payroll_remittance_agency_event.doLogWizardEvent( $this.getStepObject().getWizardObject().selected_remittance_agency_event_id, 'step', $this.getStepObject().current_step, 'skip', false, true, {\n\t\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t\t$this.onNextClickComplete( e );\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\tif ( this.getStepObject().current_step == 'home' ) {\n\t\t\t\tvar api_payroll_remittance_agency_event = TTAPI.APIPayrollRemittanceAgencyEvent;\n\t\t\t\tapi_payroll_remittance_agency_event.doLogWizardEvent( this.getStepObject().getWizardObject().selected_remittance_agency_event_id, 'wizard', this.getStepObject().current_step, 'start', false, true, {\n\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tvar api_payroll_remittance_agency_event = TTAPI.APIPayrollRemittanceAgencyEvent;\n\t\t\t\tapi_payroll_remittance_agency_event.doLogWizardEvent( this.getStepObject().getWizardObject().selected_remittance_agency_event_id, 'step', this.getStepObject().current_step, 'complete', false, true, {\n\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tthis.onNextClickComplete( e );\n\t\t}\n\t}\n\n\tonNextClickComplete( e ) {\n\t\tif ( $( e.target ).hasClass( 'disable-image' ) == false ) {\n\t\t\tthis.disableButtons();\n\n\t\t\tvar name = this.getStepObject().getNextStepName();\n\t\t\tvar $this = this;\n\t\t\tthis.initStepObject( name, function( step_obj ) {\n\t\t\t\tstep_obj.setPreviousStepName( $this.getCurrentStepName() );\n\t\t\t\t$this.setCurrentStepName( name );\n\t\t\t\t//$this.enableButtons(); //This should be done at the end of each _render() function to avoid race conditions and hammer clicking right arrow causing JS exceptions.\n\t\t\t} );\n\t\t}\n\t}\n\n\tonPrevClick( e ) {\n\t\tif ( this.button_click_procesing == true ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( e === true || $( e.target ).hasClass( 'disable-image' ) == false ) {\n\t\t\tthis.disableButtons();\n\n\t\t\tvar name = this.getStepObject().getPreviousStepName();\n\t\t\tvar $this = this;\n\n\t\t\t//Needs to be initialized in the event that we came back from the min_tab.\n\t\t\tthis.initStepObject( name, function( step_obj ) {\n\t\t\t\t//step_obj.setPreviousStepName($this.getCurrentStepName());\n\t\t\t\t$this.setCurrentStepName( name );\n\t\t\t\t//$this.enableButtons(); //This should be done at the end of each _render() function to avoid race conditions and hammer clicking right arrow causing JS exceptions.\n\t\t\t} );\n\t\t}\n\t}\n\n\tonCloseClick( e ) {\n\t\tif ( !e || $( e.target ).hasClass( 'disable-image' ) == false ) {\n\t\t\tvar $this = this;\n\n\t\t\tif ( this.getStepObject().getPreviousStepName() !== false && this.getStepObject().getNextStepName() !== false ) { //Not on first step, and not last step\n\t\t\t\tTAlertManager.showConfirmAlert( $.i18n._( 'Are you sure you wish to cancel without completing all steps for this event?' ), null, function( flag ) {\n\t\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t\tvar api_payroll_remittance_agency_event = TTAPI.APIPayrollRemittanceAgencyEvent;\n\t\t\t\t\t\tapi_payroll_remittance_agency_event.doLogWizardEvent( $this.getStepObject().getWizardObject().selected_remittance_agency_event_id, 'wizard', $this.getStepObject().current_step, 'cancel', false, true, {\n\t\t\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t$this.cleanUp();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} else if ( this.getStepObject().getNextStepName() == false ) { //On last step.\n\t\t\t\tif ( this.getStepObject().isRequiredButtonsClicked() == false ) { //Required actions are not performed.\n\t\t\t\t\tTAlertManager.showConfirmAlert( $.i18n._( '<strong>WARNING</strong>: You are about to cancel without performing all required actions on this step! <br><br><strong>This may result in payments or reports not being submitted to this agency.</strong> <br><br>Are you sure you wish to continue?<br><br>' ), null, function( flag ) {\n\t\t\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t\t\tvar api_payroll_remittance_agency_event = TTAPI.APIPayrollRemittanceAgencyEvent;\n\t\t\t\t\t\t\tapi_payroll_remittance_agency_event.doLogWizardEvent( $this.getStepObject().getWizardObject().selected_remittance_agency_event_id, 'wizard', $this.getStepObject().current_step, 'cancel', false, true, {\n\t\t\t\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t$this.cleanUp();\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t} else { //Required actions ARE performed.\n\t\t\t\t\tTAlertManager.showConfirmAlert( $.i18n._( 'Are you sure you wish to cancel without marking this event as completed?' ), null, function( flag ) {\n\t\t\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t\t\tvar api_payroll_remittance_agency_event = TTAPI.APIPayrollRemittanceAgencyEvent;\n\t\t\t\t\t\t\tapi_payroll_remittance_agency_event.doLogWizardEvent( $this.getStepObject().getWizardObject().selected_remittance_agency_event_id, 'wizard', $this.getStepObject().current_step, 'cancel', false, true, {\n\t\t\t\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t$this.cleanUp();\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar api_payroll_remittance_agency_event = TTAPI.APIPayrollRemittanceAgencyEvent;\n\t\t\t\tapi_payroll_remittance_agency_event.doLogWizardEvent( this.getStepObject().getWizardObject().selected_remittance_agency_event_id, 'wizard', this.getStepObject().current_step, 'complete', false, true, {\n\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\t$this.cleanUp();\n\t\t\t}\n\t\t}\n\t}\n\n\tonDone( e ) {\n\t\tif ( !e || $( e.target ).hasClass( 'disable-image' ) == false ) {\n\t\t\tvar $this = this;\n\n\t\t\tif ( this.getStepObject().getNextStepName() == false && this.getStepObject().isRequiredButtonsClicked() == false ) { //On last step.\n\t\t\t\tTAlertManager.showConfirmAlert( $.i18n._( '<strong>WARNING</strong>: You are about to mark this event as completed without performing all required actions on this step! <br><br><strong>This may result in payments or reports not being submitted to this agency.</strong> <br><br>Are you sure you wish to continue?<br><br>' ), null, function( flag ) {\n\t\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t\tvar api_payroll_remittance_agency_event = TTAPI.APIPayrollRemittanceAgencyEvent;\n\t\t\t\t\t\tapi_payroll_remittance_agency_event.doLogWizardEvent( $this.getStepObject().getWizardObject().selected_remittance_agency_event_id, 'step', $this.getStepObject().current_step, 'skip', false, true, {\n\t\t\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t\t\tvar api_payroll_remittance_agency_event = TTAPI.APIPayrollRemittanceAgencyEvent;\n\t\t\t\t\t\t\t\tapi_payroll_remittance_agency_event.doLogWizardEvent( $this.getStepObject().getWizardObject().selected_remittance_agency_event_id, 'wizard', $this.getStepObject().current_step, 'complete', false, true, {\n\t\t\t\t\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t$this.onDoneComplete();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tvar api_payroll_remittance_agency_event = TTAPI.APIPayrollRemittanceAgencyEvent;\n\t\t\t\tapi_payroll_remittance_agency_event.doLogWizardEvent( this.getStepObject().getWizardObject().selected_remittance_agency_event_id, 'wizard', this.getStepObject().current_step, 'complete', false, true, {\n\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\t$this.onDoneComplete();\n\t\t\t}\n\t\t}\n\t}\n\n\t//Override this function to perform other actions when the user clicks the green checkmark to complete the wizard.\n\tonDoneComplete( e ) {\n\t\t$this.cleanUp();\n\t}\n\n\taddStepObject( name, obj ) {\n\t\t//always override.\n\t\tthis.step_objects[name] = obj;\n\t\treturn this.step_objects[name]; //returned for chaining.\n\t}\n\n\tgetStepObject( name ) {\n\t\tif ( typeof name == 'undefined' ) {\n\t\t\tname = this.getCurrentStepName();\n\t\t}\n\n\t\tif ( typeof this.step_objects[name] == 'object' ) {\n\t\t\treturn this.step_objects[name];\n\t\t}\n\t\treturn this.step_objects['home'];\n\t}\n\n\tgetCurrentStepName() {\n\t\treturn this.current_step;\n\t}\n\n\tsetCurrentStepName( val ) {\n\t\tthis.current_step = val;\n\t}\n\n\t//Stub to stop backbone from complaining that it's missing, Wizard really doesn't render itself as such, it just displays its template.\n\trender() {\n\t}\n\n\t/*\n\t * Clean up the markup.\n\t */\n\tcleanUp() {\n\t\t$( this.el ).remove();\n\t\tfor ( var n in this.step_objects ) {\n\t\t\tif ( this.step_objects[n] ) {\n\t\t\t\tthis.step_objects[n].reload = true;\n\t\t\t}\n\t\t}\n\n\t\tLocalCacheData.current_open_wizard_controllers = LocalCacheData.current_open_wizard_controllers.filter( wizard => wizard.wizard_id !== this.wizard_id );\n\n\t\t$().TFeedback( {\n\t\t\tsource: this.wizard_id\n\t\t} );\n\t}\n\n\t/**\n\t * setup a step object\n\t *\n\t * @param name\n\t * @param callback\n\t */\n\tinitStepObject( name, callback ) {\n\t\tif ( this._step_map.hasOwnProperty( name ) ) {\n\t\t\tif ( this.step_objects[name] == null || typeof this.step_objects[name] != 'object' ) {\n\t\t\t\tvar $this = this;\n\t\t\t\tGlobal.loadScript( this._step_map[name].script_path, function() {\n\t\t\t\t\t$this.setCurrentStepName( name );\n\t\t\t\t\t$( $this.el ).find( '.content' ).html( '' );\n\n\t\t\t\t\t//var obj = new window[$this._step_map[name].object_name]( $this );\n\t\t\t\t\tvar obj = eval( 'new ' + $this._step_map[name].object_name + '( $this );' );\n\t\t\t\t\tobj.reload = false;\n\t\t\t\t\t$this.addStepObject( name, obj );\n\n\t\t\t\t\tif ( typeof callback == 'function' ) {\n\t\t\t\t\t\tcallback( obj );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\t//reopening a step\n\t\t\t\tthis.setCurrentStepName( name );\n\t\t\t\tif ( typeof callback == 'function' ) {\n\t\t\t\t\tvar obj = this.step_objects[name];\n\n\t\t\t\t\t$( this.el ).find( '.content' ).html( '' );\n\t\t\t\t\t//obj = new window[this._step_map[name].object_name]( this );\n\t\t\t\t\tvar obj = eval( 'new ' + this._step_map[name].object_name + '( this );' );\n\n\t\t\t\t\t//reopening a step that has been opened in a previously closed wizard.\n\t\t\t\t\tif ( this.step_objects[name].reload == true ) {\n\t\t\t\t\t\tobj.clicked_buttons = {};\n\t\t\t\t\t\tobj.reload = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.addStepObject( name, obj );\n\n\t\t\t\t\tcallback( obj );\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tdisableButtons() {\n\t\tthis.button_click_procesing = true;\n\n\t\t//Changing the button images causes flashing and isn't required for just disabling the buttons while the view loads.\n\t\t// $( this.el ).find( '.forward-btn' ).addClass( 'disable-image' );\n\t\t// $( this.el ).find( '.back-btn' ).addClass( 'disable-image' );\n\t}\n\n\t/**\n\t * Enables the next/prev buttons\n\t * the step object for the first step should return false instead fo a previous step name to disable the previous button\n\t * the step object for the last step should return false instead of a next step name to disable the next button and enable the done button.\n\t */\n\tenableButtons() {\n\t\tvar step = this.getStepObject();\n\n\t\tif ( typeof step.getNextStepName() != 'string' ) {\n\t\t\t$( this.el ).find( '.forward-btn' ).addClass( 'disable-image' );\n\t\t\t$( this.el ).find( '.done-btn' ).removeClass( 'disable-image' ); //When right arrow is disabled, assume last step and enable done button.\n\t\t} else {\n\t\t\t$( this.el ).find( '.forward-btn' ).removeClass( 'disable-image' );\n\t\t\t$( this.el ).find( '.done-btn' ).addClass( 'disable-image' ); //When right arrow is enabled, assume *not* last step, disable done button.\n\t\t}\n\n\t\tif ( typeof step.getPreviousStepName() != 'string' ) {\n\t\t\t$( this.el ).find( '.back-btn' ).addClass( 'disable-image' );\n\t\t} else {\n\t\t\t$( this.el ).find( '.back-btn' ).removeClass( 'disable-image' );\n\t\t}\n\n\t\tthis._enableButtons();\n\n\t\tthis.button_click_procesing = false;\n\t}\n\n\t//override me.\n\t_enableButtons() {\n\t}\n\n\t/**\n\t * minimize the wiazrd to a min_tab\n\t */\n\tminimize() {\n\t\tLocalCacheData.PayrollRemittanceAgencyEventWizardController = this;\n\t\t//Remove from current_open_wizard_controllers so that when opening a new wizard the user does not get\n\t\t//a message asking them to close the previous (minimized) wizard that is not viewable.\n\t\tLocalCacheData.current_open_wizard_controllers = LocalCacheData.current_open_wizard_controllers.filter( wizard => wizard.wizard_id !== this.wizard_id );\n\t\tGlobal.addViewTab( this.wizard_id, this.wizard_name, window.location.href );\n\t\tthis.delegateEvents();\n\t\t$( this.el ).remove();\n\t}\n\n\treload() {\n\t\tfor ( var i in this.step_objects ) {\n\t\t\tthis.step_objects[i].reload = true;\n\t\t}\n\t}\n\n\tdisableForCommunity( callback ) {\n\t\tif ( Global.getProductEdition() <= 10 ) {\n\t\t\tTAlertManager.showAlert( Global.getUpgradeMessage(), $.i18n._( 'Denied' ) );\n\t\t} else {\n\t\t\tif ( typeof callback == 'function' ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\n\t}\n\n}","import { Wizard } from '@/global/widgets/wizard/Wizard';\n\nexport class ProcessTransactionsWizard extends Wizard {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: $( '.process_transactions_wizard' ),\n\t\t\tcurrent_step: false,\n\t\t\twizard_name: $.i18n._( 'Process Transactions' ),\n\n\t\t\tselected_transaction_ids: [],\n\n\t\t\twizard_id: 'ProcessTransactionsWizard',\n\t\t\t_step_map: {\n\t\t\t\t'home': { // TODO: Webpack: Investigate how this works/does not work with Webpack\n\t\t\t\t\tscript_path: 'views/payroll/process_transactions_wizard/ProcessTransactionsWizardStepHome.js',\n\t\t\t\t\tobject_name: 'ProcessTransactionsWizardStepHome'\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tapi: null,\n\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tsetTransactionIds( data ) {\n\t\tthis.selected_transaction_ids = data;\n\t\tif ( this.selected_transaction_ids.length > 0 ) {\n\t\t\t$( '.process_transactions_wizard .done-btn' ).removeClass( 'disable-image' );\n\t\t} else {\n\t\t\t$( '.process_transactions_wizard .done-btn' ).addClass( 'disable-image' );\n\t\t}\n\t}\n\n\t/**\n\t * @param e\n\t */\n\tonDone( e ) {\n\t\tif ( e && $( e.target ).hasClass( 'disable-image' ) == false ) {\n\t\t\tvar $this = LocalCacheData.current_open_wizard_controllers.find( wizard => wizard.wizard_id === this.wizard_id );\n\n\t\t\tvar data = { filter_data: {} };\n\t\t\tvar external_data = $this.getExternalData();\n\t\t\tif ( external_data ) {\n\t\t\t\tif ( !external_data.filter_data ) {\n\t\t\t\t\tdata.filter_data = external_data;\n\t\t\t\t} else {\n\t\t\t\t\tdata.filter_data = external_data.filter_data;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( !data || !data.filter_data ) {\n\t\t\t\tdata.filter_data = {};\n\t\t\t}\n\n\t\t\tif ( !data.filter_data.remittance_source_account_id ) {\n\t\t\t\tdata.filter_data.remittance_source_account_id = [];\n\t\t\t}\n\n\t\t\tif ( !data.filter_data.setup_last_check_number ) {\n\t\t\t\tdata.setup_last_check_number = {};\n\t\t\t}\n\n\t\t\tvar table_rows = $( '#process_transactions_wizard_source_account_table tr' );\n\t\t\tif ( table_rows.length > 0 ) {\n\t\t\t\tfor ( var x = 0; x < table_rows.length; x++ ) {\n\t\t\t\t\tvar row = $( table_rows[x] );\n\t\t\t\t\tif ( row.find( '[type=\"checkbox\"]' ).is( ':checked' ) ) {\n\t\t\t\t\t\tdata.filter_data.remittance_source_account_id.push( row.find( '[type=\"checkbox\"]' ).val() );\n\t\t\t\t\t\tdata.setup_last_check_number[row.find( '[type=\"checkbox\"]' ).val()] = row.find( 'input.last_transaction_number' ).val();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( data.filter_data.remittance_source_account_id.length > 0 ) {\n\t\t\t\t$( e.target ).addClass( 'disable-image' );\n\t\t\t\tvar post_data = { 0: data, 1: true, 2: 'export_transactions' };\n\t\t\t\tvar api = TTAPI.APIPayStub;\n\t\t\t\tGlobal.APIFileDownload( api.className, 'getPayStub', post_data );\n\t\t\t} else {\n\t\t\t\tDebug.Text( 'No source accounts selected', 'ProcessTransactionsWizard.js', 'ProcessTransactionsWizard', 'onDone', 10 );\n\t\t\t}\n\t\t\t$this.onCloseClick( true );\n\t\t}\n\t}\n\n\tonCloseClick( e ) {\n\t\tif ( e === true || ( e && $( e.target ).hasClass( 'disable-image' ) == false ) ) {\n\t\t\t//if process payroll wizard is minimized, click it.\n\t\t\tif ( $( '#min_tab_ProcessPayrollWizard' )[0] ) {\n\t\t\t\t$( $( '#min_tab_ProcessPayrollWizard' )[0] ).click();\n\t\t\t}\n\t\t\tthis.cleanUp();\n\t\t}\n\t}\n}","import { Wizard } from '@/global/widgets/wizard/Wizard';\n\nexport class PayrollRemittanceAgencyEventWizard extends Wizard {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tcurrent_step: false,\n\t\t\twizard_name: $.i18n._( 'Tax Wizard' ),\n\n\t\t\tselected_remittance_agency_event: null,\n\t\t\tselected_remittance_agency_event_id: null,\n\t\t\tpayroll_remittance_agency_event_block: null,\n\n\t\t\twizard_id: 'PayrollRemittanceAgencyEventWizardController',\n\t\t\t_step_map: {\n\t\t\t\t'home': { // TODO: Webpack: Investigate how this works/does not work with Webpack\n\t\t\t\t\tscript_path: 'views/payroll/remittance_wizard/PayrollRemittanceAgencyEventWizardStepHome.js',\n\t\t\t\t\tobject_name: 'PayrollRemittanceAgencyEventWizardStepHome'\n\t\t\t\t},\n\t\t\t\t'review': {\n\t\t\t\t\tscript_path: 'views/payroll/remittance_wizard/PayrollRemittanceAgencyEventWizardStepReview.js',\n\t\t\t\t\tobject_name: 'PayrollRemittanceAgencyEventWizardStepReview'\n\t\t\t\t},\n\t\t\t\t'submit': {\n\t\t\t\t\tscript_path: 'views/payroll/remittance_wizard/PayrollRemittanceAgencyEventWizardStepSubmit.js',\n\t\t\t\t\tobject_name: 'PayrollRemittanceAgencyEventWizardStepSubmit'\n\t\t\t\t},\n\t\t\t\t'publish': {\n\t\t\t\t\tscript_path: 'views/payroll/remittance_wizard/PayrollRemittanceAgencyEventWizardStepPublish.js',\n\t\t\t\t\tobject_name: 'PayrollRemittanceAgencyEventWizardStepPublish'\n\t\t\t\t}\n\t\t\t}\n\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit() {\n\t\tvar $this = this;\n\t}\n\n\trender() {\n\t\t//do render stuff\n\t}\n\n\tonNextClick( e ) {\n\t\t//Get selected row data so we can determine the time period.\n\t\tif ( this.getStepObject().grid ) {\n\t\t\tvar row_data = this.getStepObject().grid.getRowData( this.getStepObject().grid.getSelectedRow() );\n\n\t\t\tif ( row_data['in_time_period'] && row_data['in_time_period'] == true ) {\n\t\t\t\tTAlertManager.showConfirmAlert( $.i18n._( 'Time period for this event has not ended yet, are you sure you want to process this event early?' ), null, ( flag ) => {\n\t\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t\tsuper.onNextClick( e );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tsuper.onNextClick( e );\n\t\t\t}\n\t\t} else {\n\t\t\tsuper.onNextClick( e );\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * builds the event data block used on several steps in this wizard.\n\t * @param container_id\n\t * @param data\n\t */\n\tbuildEventDataBlock( container_id, data ) {\n\t\t$( '#' + container_id ).remove(); //never allow this to duplicate on the wizard.\n\t\tvar div = $( '<div id=\\'' + container_id + '\\' class=\\'payroll_remittance_agency_event_wizard_event_details\\'><table></table></div>' );\n\t\tvar step_obj = this.getStepObject( this.getCurrentStepName() );\n\t\tstep_obj.append( div );\n\n\t\tvar even = false;\n\t\tvar td_label, td_value;\n\n\t\tif ( this.payroll_remittance_agency_event_block == null ) {\n\n\t\t\tvar column_one_keys = [\n\t\t\t\t{ key: 'legal_entity_legal_name', title: $.i18n._( 'Legal Entity' ) },\n\t\t\t\t{ key: 'payroll_remittance_agency_name', title: $.i18n._( 'Agency' ) },\n\t\t\t\t{ key: 'type', title: $.i18n._( 'Event' ) }\n\t\t\t];\n\n\t\t\tvar column_two_keys = [\n\t\t\t\t{ key: 'frequency', title: $.i18n._( 'Frequency' ) },\n\t\t\t\t{ key: 'time_period', title: $.i18n._( 'Time Period' ) },\n\t\t\t\t{ key: 'due_date_display', title: $.i18n._( 'Due Date' ) }\n\t\t\t];\n\n\t\t\tvar upper_bound = ( column_one_keys.length > column_two_keys.length ) ? column_one_keys.length : column_two_keys.length;\n\n\t\t\tfor ( var i = 0; i < upper_bound; i++ ) {\n\t\t\t\tvar tr = $( '<tr></tr>' );\n\n\t\t\t\tif ( column_one_keys.length > i ) {\n\t\t\t\t\tvar label = $( '<td class=\"label col1\"></td>' );\n\t\t\t\t\tlabel.text( column_one_keys[i].title );\n\n\t\t\t\t\tvar value = $( '<td class=\"value\"></td>' );\n\t\t\t\t\tvalue.text( data[column_one_keys[i].key] );\n\n\t\t\t\t\ttr.append( label );\n\t\t\t\t\ttr.append( value );\n\t\t\t\t} else {\n\t\t\t\t\ttr.append( $( '<td></td>' ) );\n\t\t\t\t\ttr.append( $( '<td></td>' ) );\n\t\t\t\t}\n\n\t\t\t\tif ( column_two_keys.length > i ) {\n\t\t\t\t\tvar label = $( '<td class=\"label col2\"></td>' );\n\t\t\t\t\tlabel.text( column_two_keys[i].title );\n\n\t\t\t\t\tvar value = $( '<td class=\"value\"></td>' );\n\t\t\t\t\tif ( column_two_keys[i].key == 'time_period' ) {\n\t\t\t\t\t\tvalue.text( data.start_date_display + ' - ' + data.end_date_display );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalue.text( data[column_two_keys[i].key] );\n\t\t\t\t\t}\n\n\t\t\t\t\ttr.append( label );\n\t\t\t\t\ttr.append( value );\n\t\t\t\t} else {\n\n\t\t\t\t\ttr.append( $( '<td></td>' ) );\n\t\t\t\t\ttr.append( $( '<td></td>' ) );\n\t\t\t\t}\n\n\t\t\t\t$( '#' + container_id + ' table' ).append( tr );\n\t\t\t}\n\n\t\t\t//Show warning if still inside time period.\n\t\t\tif ( data['in_time_period'] && data['in_time_period'] == true ) {\n\t\t\t\tvar tr = $( '<tr></tr>' );\n\n\t\t\t\tvar row_contents = $( '<td align=\"center\" style=\"font-weight: bold; color: red;\" colspan=\"4\"></td>' );\n\t\t\t\trow_contents.html( $.i18n._( 'WARNING: Time period has not ended yet, you may be processing early.' ) );\n\n\t\t\t\ttr.append( row_contents );\n\n\t\t\t\t$( '#' + container_id + ' table' ).append( tr );\n\t\t\t}\n\n\t\t\t//Show warning if still inside time period.\n\t\t\tif ( data['is_split_time_period'] && data['is_split_time_period'] == true ) {\n\t\t\t\tvar tr = $( '<tr></tr>' );\n\n\t\t\t\tvar row_contents = $( '<td align=\"center\" style=\"font-weight: bold; color: red;\" colspan=\"4\"></td>' );\n\t\t\t\trow_contents.html( $.i18n._( 'NOTICE: Time Period has been split into two, due to crossing into a new quarter.<br>This event will now need to be processed twice, once for each part of the time period.' ) );\n\n\t\t\t\ttr.append( row_contents );\n\n\t\t\t\t$( '#' + container_id + ' table' ).append( tr );\n\t\t\t}\n\n\t\t\tthis.payroll_remittance_agency_event_block = $( '#' + container_id + ' table' ).html();\n\t\t} else {\n\t\t\t$( '#' + container_id + ' table' ).html( this.payroll_remittance_agency_event_block );\n\t\t}\n\t}\n\n\t/**\n\t * both args required.\n\t * @param id\n\t * @param callback\n\t */\n\tgetPayrollRemittanceAgencyEventById( id, columns, callback ) {\n\t\t//Stright to the callback if nothing has changed. if ( this.selected_remittance_agency_event.id != id) {\n\t\tif ( typeof callback == 'function' && this.selected_remittance_agency_event && this.selected_remittance_agency_event.id == id ) {\n\t\t\tcallback( this.selected_remittance_agency_event );\n\t\t} else {\n\t\t\tvar filter = {\n\t\t\t\tfilter_data: {\n\t\t\t\t\tid: this.selected_remittance_agency_event_id\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif ( columns == null || typeof columns == 'undefined' ) {\n\t\t\t\tfilter.filter_columns = {\n\t\t\t\t\t'payroll_remittance_agency_id': true,\n\t\t\t\t\t'legal_entity_legal_name': true,\n\t\t\t\t\t'payroll_remittance_agency_name': true,\n\t\t\t\t\t'user_report_data_id': true,\n\t\t\t\t\t'status': true,\n\t\t\t\t\t'status_id': true,\n\t\t\t\t\t'type': true,\n\t\t\t\t\t'type_id': true,\n\t\t\t\t\t'frequency': true,\n\t\t\t\t\t'start_date_display': true,\n\t\t\t\t\t'end_date_display': true,\n\t\t\t\t\t'due_date_display': true,\n\t\t\t\t\t'in_time_period': true,\n\t\t\t\t\t'is_split_time_period': true,\n\t\t\t\t\t'event_data': true,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tfilter.columns = columns;\n\t\t\t}\n\t\t\tvar $this = this;\n\t\t\tvar api_payroll_remittance_agency_event = TTAPI.APIPayrollRemittanceAgencyEvent;\n\t\t\tapi_payroll_remittance_agency_event.getPayrollRemittanceAgencyEvent( filter, {\n\t\t\t\tonResult: function( event_result ) {\n\t\t\t\t\tvar event_result = event_result.getResult();\n\n\t\t\t\t\t//Issue #3227 - No records returned. This is happens when there are no events (tax wizard is empty) and user\n\t\t\t\t\t//closes the tax wizard, which produces JavaScript exceptions as it tries to read the first array key of boolean true.\n\t\t\t\t\t//True is returned from getPayrollRemittanceAgencyEvent when no records are returned.\n\t\t\t\t\tif ( event_result === true ) {\n\t\t\t\t\t\t$this.cleanUp();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( Array.isArray( event_result ) ) {\n\t\t\t\t\t\tevent_result = event_result[0];\n\t\t\t\t\t}\n\n\t\t\t\t\tvar api_payroll_remittance_agency = TTAPI.APIPayrollRemittanceAgency;\n\t\t\t\t\tapi_payroll_remittance_agency.getPayrollRemittanceAgency( { filter_data: { id: event_result.payroll_remittance_agency_id } }, {\n\t\t\t\t\t\t\tonResult: function( agency_result ) {\n\t\t\t\t\t\t\t\tevent_result.payroll_remittance_agency_obj = agency_result.getResult()[0]; //Merge Event and Agency data together.\n\n\t\t\t\t\t\t\t\tif ( typeof callback == 'function' ) {\n\t\t\t\t\t\t\t\t\tcallback( event_result );\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\t/**\n\t * Allows us to open reports to give us access to their context menu code from within wizards.\n\t *\n\t * @param report_type\n\t * @param report_obj\n\t * @param callback\n\t */\n\tgetReport( render_type, post_data ) {\n\t\tif ( !post_data ) {\n\t\t\tpost_data = {\n\t\t\t\t0: this.selected_remittance_agency_event_id,\n\t\t\t\t1: render_type\n\t\t\t};\n\t\t}\n\t\tGlobal.APIFileDownload( 'APIPayrollRemittanceAgencyEvent', 'getReportData', post_data );\n\t}\n\n\t/**\n\t * Displays html report. Does not close wizard, but leaves it up in the background.\n\t * @param report_name\n\t * @param post_data\n\t */\n\tshowHTMLReport( report_name, new_window ) {\n\t\tProgressBar.showOverlay();\n\t\tvar api = TTAPI.APIPayrollRemittanceAgencyEvent;\n\t\tapi['getReportData']( this.selected_remittance_agency_event_id, 'html', {\n\t\t\tonResult: function( res ) {\n\t\t\t\tProgressBar.closeOverlay();\n\n\t\t\t\tif ( res && res.isValid() ) {\n\t\t\t\t\tvar result = res.getResult();\n\t\t\t\t\tif ( new_window ) {\n\t\t\t\t\t\tvar w = window.open();\n\t\t\t\t\t\tw.document.writeln( result.api_retval );\n\t\t\t\t\t\tw.document.close();\n\t\t\t\t\t} else if ( result ) {\n\t\t\t\t\t\tIndexViewController.openWizard( 'ReportViewWizard', result.api_retval );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tTAlertManager.showErrorAlert( res );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\t/**\n\t * @param e\n\t */\n\tonDoneComplete( e ) {\n\t\tvar $this = this;\n\t\tthis.getPayrollRemittanceAgencyEventById( this.selected_remittance_agency_event_id, {}, function( result ) {\n\t\t\tif ( result ) {\n\t\t\t\tresult.enable_recalculate_dates = 1;\n\t\t\t\tresult.last_due_date = result.due_date;\n\n\t\t\t\tvar api_payroll_remittance_agency_event = TTAPI.APIPayrollRemittanceAgencyEvent;\n\t\t\t\tapi_payroll_remittance_agency_event.setPayrollRemittanceAgencyEvent( result, false, true, {\n\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t$this.cleanUp();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\t}\n}","import { TTBackboneView } from '@/views/TTBackboneView';\nimport { ServiceCaller } from '@/services/ServiceCaller';\n\nexport class HeaderViewController extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( options ) {\n\t\tsuper.initialize( options );\n\t\tvar tpl = Global.loadWidget( 'views/quick_punch/header/HeaderView.html' );\n\t\tif ( tpl ) { //JS Exception: Uncaught TypeError: Cannot read property 'replace' of undefined\n\t\t\tthis.tpl = _.template( tpl );\n\t\t}\n\t\tthis.render();\n\t}\n\n\trender() {\n\t\tvar url = ServiceCaller.getURLByObjectType( 'primary_company_logo' );\n\t\tif ( this.tpl ) {\n\t\t\tthis.setElement( this.tpl( { company_logo: url } ) );\n\t\t}\n\t}\n\n}\n"],"file":"v16.12.9/main_ui-z76rxVqJ.entry.bundle.js"}