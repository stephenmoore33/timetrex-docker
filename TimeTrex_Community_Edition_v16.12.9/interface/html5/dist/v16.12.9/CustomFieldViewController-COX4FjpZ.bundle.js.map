{"version":3,"file":"CustomFieldViewController-COX4FjpZ.bundle.js","sources":["../../views/company/custom_field/CustomFieldViewController.js"],"sourcesContent":["export class CustomFieldViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#custom_field_view_container',\n\t\t\ttype_array: null,\n\t\t\tparent_table_array: null,\n\t\t\tstatus_array: null,\n\n\t\t\toriginal_custom_field_select_items: [],\n\t\t\tauthentication_api: null,\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'CustomFieldEditView.html';\n\t\tthis.permission_id = 'custom_field';\n\t\tthis.viewId = 'CustomField';\n\t\tthis.script_name = 'CustomFieldView';\n\t\tthis.table_name_key = 'custom_field_control';\n\t\tthis.context_menu_name = $.i18n._( 'Custom Field' );\n\t\tthis.navigation_label = $.i18n._( 'Custom Field' );\n\t\tthis.api = TTAPI.APICustomField;\n\t\tthis.authentication_api = TTAPI.APIAuthentication;\n\n\t\tthis.render();\n\t\tthis.buildContextMenu();\n\n\t\tthis.initData();\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\texclude: ['copy', 'mass_edit'],\n\t\t\tinclude: []\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tinitOptions( callBack ) {\n\t\tvar options = [\n\t\t\t// { option_name: 'type_id', field_name: 'type_id', api: this.api },\n\t\t\t{ option_name: 'type', api: this.api },\n\t\t\t{ option_name: 'status', api: this.api },\n\t\t\t{ option_name: 'parent_table', field_name: 'parent_table', api: this.api }\n\t\t];\n\n\t\tthis.initDropDownOptions( options );\n\t}\n\n\tsearchDone( result ) {\n\n\t\tsuper.searchDone();\n\t\tGlobal.refreshCustomFieldCache();\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_custom_field': {\n\t\t\t\t'label': $.i18n._( 'Custom Field' ),\n\t\t\t\t'is_multi_column': true,\n\t\t\t\t'html_template': this.getCustomFieldTabHtml()\n\t\t\t},\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APICustomField,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_custom_field',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_custom_field = this.edit_view_tab.find( '#tab_custom_field' );\n\n\t\tvar tab_custom_field_column1 = tab_custom_field.find( '.first-column' );\n\t\tvar tab_custom_field_column2 = tab_custom_field.find( '.second-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_custom_field_column1 );\n\n\t\t//Status\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'status_id' } );\n\t\tform_item_input.setSourceData( $this.status_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_custom_field_column1, '' );\n\n\t\t//Name\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'name' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Name' ), form_item_input, tab_custom_field_column1, '' );\n\n\t\t// Parent Table\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'parent_table' } );\n\t\tform_item_input.setSourceData( $this.parent_table_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Object Type' ), form_item_input, tab_custom_field_column1, '' );\n\n\t\t// Type\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'type_id' } );\n\t\tform_item_input.setSourceData( $this.type_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Field Type' ), form_item_input, tab_custom_field_column1, '', null, true );\n\n\t\t//Display Order\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'display_order' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Display Order' ), form_item_input, tab_custom_field_column1, '' );\n\n\t\t//Enable Search\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'enable_search' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Enable Search' ), form_item_input, tab_custom_field_column1, '', null, true );\n\n\t\t//Second Column\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.SEPARATED_BOX );\n\t\tform_item_input.SeparatedBox( { label: $.i18n._( 'Validation Rules' ) } );\n\t\tthis.addEditFieldToColumn( null, form_item_input, tab_custom_field_column2, '', null, true, false );\n\n\t\t//Default Value\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'default_value' } );\n\t\tform_item_input.attr( 'id', 'custom-field-default-value' );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Default Value' ), form_item_input, tab_custom_field_column2, '' );\n\n\t\t//Is required\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'is_required' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Required' ), form_item_input, tab_custom_field_column2, '' );\n\n\t\t//Min Length\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'validate_min_length' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Minimum Length' ), form_item_input, tab_custom_field_column2, '', null, true );\n\n\t\t//Max Length\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'validate_max_length' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Maximum Length' ), form_item_input, tab_custom_field_column2, '', null, true );\n\n\t\t//Precision (Decimal Places)\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'validate_decimal_places' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Decimal Places' ), form_item_input, tab_custom_field_column2, '', null, true );\n\n\t\t//Min Amount\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'validate_min_amount' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Minimum Amount' ), form_item_input, tab_custom_field_column2, '', null, true );\n\n\t\t//Max Amount\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'validate_max_amount' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Maximum Amount' ), form_item_input, tab_custom_field_column2, '', null, true );\n\n\t\t//Min Time Unit\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'validate_min_time_unit', mode: 'time_unit', need_parser_sec: true } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Minimum Amount' ), form_item_input, tab_custom_field_column2, '', null, true );\n\n\t\t//Max Time Unit\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'validate_max_time_unit', mode: 'time_unit', need_parser_sec: true } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Maximum Amount' ), form_item_input, tab_custom_field_column2, '', null, true );\n\n\t\t//Min Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\tform_item_input.TDatePicker( { field: 'validate_min_date' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Minimum Date' ), form_item_input, tab_custom_field_column2, '', null, true );\n\n\t\t//Max Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\tform_item_input.TDatePicker( { field: 'validate_max_date' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Maximum Date' ), form_item_input, tab_custom_field_column2, '', null, true );\n\n\t\t//Min time\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TIME_PICKER );\n\t\tform_item_input.TTimePicker( { field: 'validate_min_time', validation_field: 'time_stamp' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Minimum time' ), form_item_input, tab_custom_field_column2, '', null, true );\n\n\t\t//Max time\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TIME_PICKER );\n\t\tform_item_input.TTimePicker( { field: 'validate_max_time', validation_field: 'time_stamp' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Maximum time' ), form_item_input, tab_custom_field_column2, '', null, true );\n\n\t\t// Multi-select Minimum Amount\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'validate_multi_select_min_amount' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Multi-select Minimum Selected' ), form_item_input, tab_custom_field_column2, '', null, true );\n\n\t\t//Multi-select Maximum Amount\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'validate_multi_select_max_amount' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Multi-select Maximum Selected' ), form_item_input, tab_custom_field_column2, '', null, true );\n\n\t\t//Min Datetime\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\tform_item_input.TDatePicker( { field: 'validate_min_datetime', mode: 'date_time' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Minimum Date' ), form_item_input, tab_custom_field_column2, '', null, true );\n\n\t\t//Max Datetime\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\tform_item_input.TDatePicker( { field: 'validate_max_datetime', mode: 'date_time' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Maximum Date' ), form_item_input, tab_custom_field_column2, '', null, true );\n\n\t\t//\n\t\t//Inside editor for dropdowns\n\t\t//\n\t\tvar inside_editor_div = tab_custom_field.find( '.inside-editor-div' );\n\t\tvar args = {\n\t\t\tid: $.i18n._( 'Item Value' ),\n\t\t\tlabel: $.i18n._( 'Item Display Label' )\n\t\t};\n\n\t\tthis.editor = Global.loadWidgetByName( FormItemType.INSIDE_EDITOR );\n\n\t\tthis.editor.InsideEditor( {\n\t\t\taddRow: this.insideEditorAddRow,\n\t\t\tremoveRow: this.insideEditorRemoveRow,\n\t\t\tgetValue: this.insideEditorGetValue,\n\t\t\tsetValue: this.insideEditorSetValue,\n\t\t\trender: getRender(),\n\t\t\trender_args: args,\n\t\t\trender_inline_html: true,\n\t\t\trow_render: getRowRender(),\n\t\t\tparent_controller: this\n\t\t} );\n\n\t\tfunction getRender() {\n\t\t\treturn `\n\t\t\t<table class=\"inside-editor-render\">\n\t\t\t\t<tr class=\"title\">\n\t\t\t\t\t<td style=\"width: 200px\"><%= id %></td>\n\t\t\t\t\t<td style=\"width: 200px\"><%= label %></td>\n\t\t\t\t\t<td style=\"width: 25px\"></td>\n\t\t\t\t\t<td style=\"width: 25px\"></td>\n\t\t\t\t</tr>\n\t\t\t</table>`;\n\t\t}\n\n\t\tfunction getRowRender() {\n\t\t\treturn `\n\t\t\t<tr class=\"inside-editor-row data-row\">\n\t\t\t\t<td class=\"id cell\"></td>\n\t\t\t\t<td class=\"label cell\"></td>\n\t\t\t\t<td class=\"cell control-icon\">\n\t\t\t\t\t<button class=\"plus-icon\" onclick=\"\"></button>\n\t\t\t\t</td>\n\t\t\t\t<td class=\"cell control-icon\">\n\t\t\t\t\t<button class=\"minus-icon \" onclick=\"\"></button>\n\t\t\t\t</td>\n\t\t\t</tr>`;\n\t\t}\n\n\t\tinside_editor_div.append( this.editor );\n\t}\n\n\n\tinsideEditorSetValue( val ) {\n\t\tvar len = val.length;\n\n\t\tthis.removeAllRows();\n\t\tfor ( var i = 0; i < val.length; i++ ) {\n\t\t\tif ( Global.isSet( val[i] ) ) {\n\t\t\t\tvar row = val[i];\n\t\t\t\tif ( Global.isSet( this.parent_id ) ) {\n\t\t\t\t\trow['id'] = '';\n\t\t\t\t}\n\t\t\t\tthis.addRow( row );\n\t\t\t}\n\n\t\t}\n\t}\n\n\tinsideEditorAddRow( data, index ) {\n\t\tlet is_existing_row = false;\n\n\t\tif ( !data ) {\n\t\t\tdata = {};\n\t\t} else {\n\t\t\tis_existing_row = true;\n\t\t}\n\n\t\tvar row_id = data.id ? data.id : TTUUID.generateUUID();\n\n\t\tvar row = this.getRowRender(); //Get Row render\n\t\tvar render = this.getRender(); //get render, should be a table\n\t\tvar widgets = {}; //Save each row's widgets\n\n\t\t//Build row widgets\n\n\t\tvar form_item_input;\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'id', width: 175 } );\n\t\tform_item_input.setValue( data.id ? data.id : '' );\n\t\tform_item_input.attr( 'item_id', row_id );\n\t\tform_item_input.bind( 'formItemChange', function( e, target, doNotValidate ) {\n\t\t\tthis.parent_controller.createMetaData( this.parent_controller.current_edit_record.type_id );\n\t\t\tthis.parent_controller.updateCustomFieldDropdowns();\n\t\t}.bind( this ) );\n\n\t\tif ( is_existing_row && this.parent_controller.is_add == false) {\n\t\t\tform_item_input.setEnabled( false );\n\t\t}\n\n\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\trow.children().eq( 0 ).append( form_item_input );\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'label', width: 175 } );\n\t\tform_item_input.setValue( data.label ? data.label : '' );\n\t\tform_item_input.bind( 'formItemChange', function( e, target, doNotValidate ) {\n\t\t\tthis.parent_controller.onFormItemChange( target, doNotValidate );\n\t\t\tthis.parent_controller.updateCustomFieldDropdowns();\n\t\t}.bind( this ) );\n\n\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\trow.children().eq( 1 ).append( form_item_input );\n\n\t\tif ( typeof index != 'undefined' ) {\n\t\t\trow.insertAfter( $( render ).find( 'tr' ).eq( index ) );\n\t\t\tthis.rows_widgets_array.splice( ( index ), 0, widgets );\n\n\t\t} else {\n\t\t\t$( render ).append( row );\n\t\t\tthis.rows_widgets_array.push( widgets );\n\t\t}\n\n\t\tif ( this.parent_controller.is_viewing ) {\n\t\t\trow.find( '.control-icon' ).hide();\n\t\t}\n\n\t\tthis.addIconsEvent( row ); //Bind event to add and minus icon\n\t\tthis.removeLastRowLine();\n\t}\n\n\tinsideEditorRemoveRow( row ) {\n\t\tvar index = row[0].rowIndex - 1;\n\t\trow.remove();\n\t\tthis.rows_widgets_array.splice( index, 1 );\n\t\tthis.removeLastRowLine();\n\n\t\tthis.parent_controller.updateCustomFieldDropdowns();\n\t\tthis.parent_controller.createMetaData( this.parent_controller.current_edit_record.type_id );\n\t}\n\n\tinsideEditorGetValue( current_edit_item_id ) {\n\t\tvar len = this.rows_widgets_array.length;\n\n\t\tvar result = [];\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar row = this.rows_widgets_array[i];\n\n\t\t\tvar data = {\n\t\t\t\tlabel: row.label.getValue(),\n\t\t\t\tid: row.id.getValue()\n\t\t\t};\n\n\t\t\tresult.push( data );\n\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsetEditViewDataDone() {\n\t\tsuper.setEditViewDataDone();\n\t\tthis.onTypeChange( true );\n\t\tthis.initInsideEditorData( true );\n\t}\n\n\tinitInsideEditorData( reset_rows ) {\n\t\tvar $this = this;\n\t\tvar args = {};\n\t\targs.filter_data = {};\n\n\t\tif ( reset_rows ) {\n\t\t\t//On initial open make sure to reset rows, else if user is using navigation arrows the select items from the old record will be shown\n\t\t\tthis.editor.removeAllRows();\n\t\t}\n\n\t\tif ( this.mass_edit || ( !this.current_edit_record.meta_data.validation.multi_select_items || !this.current_edit_record.meta_data.validation.multi_select_items.length > 0 ) || !this.current_edit_record ) {\n\t\t\t$this.editor.removeAllRows();\n\t\t\t$this.editor.addRow();\n\t\t\t$this.original_custom_field_select_items = [];\n\t\t} else {\n\t\t\t$this.original_custom_field_select_items = [];\n\t\t\tfor ( var i = 0; i < $this.current_edit_record.meta_data.validation.multi_select_items.length; i++ ) {\n\t\t\t\tvar item = $this.current_edit_record.meta_data.validation.multi_select_items[i];\n\t\t\t\tif ( item.id !== TTUUID.zero_id && item.id !== TTUUID.not_exist_id ) {\n\t\t\t\t\t$this.editor.addRow( item );\n\t\t\t\t\t$this.original_custom_field_select_items.push( item );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsaveInsideEditorData( callBack ) {\n\t\tthis.createMetaData();\n\n\t\tif ( callBack ) {\n\t\t\tcallBack();\n\t\t}\n\t}\n\n\tonFormItemChange( target, doNotValidate ) {\n\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\t\tvar key = target.getField();\n\t\tvar c_value = target.getValue();\n\t\tthis.current_edit_record[key] = c_value;\n\n\t\tswitch ( key ) {\n\t\t\tcase 'type_id':\n\t\t\t\tthis.onTypeChange( false );\n\t\t\t\tbreak;\n\t\t\tcase 'parent_table':\n\t\t\t\tthis.onParentTableChange();\n\t\t\t\tbreak;\n\t\t\tcase 'value':\n\t\t\t\tthis.onSelectValueChange( target[0], c_value );\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.createMetaData( this.current_edit_record.type_id );\n\n\t\tif ( !doNotValidate ) {\n\t\t\tthis.validate();\n\t\t}\n\t}\n\n\tonTypeChange( set_default ) {\n\t\tthis.hideValidationFields();\n\n\t\tif ( this.current_edit_record.type_id == 1010 ) {\n\t\t\tthis.detachElement( 'enable_search' );\n\t\t} else {\n\t\t\tthis.attachElement( 'enable_search' );\n\t\t}\n\n\t\tif ( this.current_edit_record.type_id == 100 || this.current_edit_record.type_id == 110 ) {\n\t\t\tthis.attachElement( 'validate_min_length' );\n\t\t\tthis.attachElement( 'validate_max_length' );\n\t\t} else if ( this.current_edit_record.type_id == 400 || this.current_edit_record.type_id == 410 || this.current_edit_record.type_id == 420 ) {\n\t\t\tthis.attachElement( 'validate_min_amount' );\n\t\t\tthis.attachElement( 'validate_max_amount' );\n\t\t\tif ( this.current_edit_record.type_id == 410 ) {\n\t\t\t\tthis.attachElement( 'validate_decimal_places' );\n\t\t\t}\n\t\t} else if ( this.current_edit_record.type_id == 1000 || this.current_edit_record.type_id == 1010 ) {\n\t\t\tthis.attachElement( 'validate_min_date' );\n\t\t\tthis.attachElement( 'validate_max_date' );\n\t\t} else if ( this.current_edit_record.type_id == 1100 ) {\n\t\t\tthis.attachElement( 'validate_min_time' );\n\t\t\tthis.attachElement( 'validate_max_time' );\n\t\t} else if ( this.current_edit_record.type_id == 1200 ) {\n\t\t\tthis.attachElement( 'validate_min_datetime' );\n\t\t\tthis.attachElement( 'validate_max_datetime' );\n\t\t} else if ( this.current_edit_record.type_id == 1300 ) {\n\t\t\tthis.attachElement( 'validate_min_time_unit' );\n\t\t\tthis.attachElement( 'validate_max_time_unit' );\n\t\t} else if ( this.current_edit_record.type_id == 2100 ) {\n\t\t\t$( '#tab_custom_field_content_div #dropdown-editor').show();\n\t\t} else if ( this.current_edit_record.type_id == 2110 ) {\n\t\t\t$( '#tab_custom_field_content_div #dropdown-editor').show()\n\t\t\tthis.attachElement( 'validate_multi_select_min_amount' );\n\t\t\tthis.attachElement( 'validate_multi_select_max_amount' );\n\t\t}\n\n\t\tthis.changeDefaultValueFormItemType( this.current_edit_record.type_id, set_default );\n\t\tthis.editFieldResize();\n\t}\n\n\tonParentTableChange() {\n\t\tthis.setPunchFieldTypes();\n\t}\n\n\tonSelectValueChange(element, value) {\n\t\telement.id = value;\n\t}\n\n\tchangeDefaultValueFormItemType( new_type_id, set_default ) {\n\t\tlet target_column = this.edit_view_tab.find( '#tab_custom_field .second-column' );\n\n\t\tlet form_array = this.getCustomFieldFormInputByType( new_type_id, 'default_value', this.current_edit_record.meta_data );\n\t\tlet form_item_input = form_array[0];\n\t\tlet widget_container = form_array[1];\n\n\t\tform_item_input.attr( 'id', 'custom-field-default-value-new' );\n\t\tthis.edit_view_ui_dic['default_value'] = form_item_input;\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Default Value' ), form_item_input, target_column, '', widget_container );\n\t\tform_item_input.css( 'opacity', 1 );\n\n\t\tlet old_input = document.querySelector( '#custom-field-default-value' );\n\t\tlet new_input = document.querySelector( '#custom-field-default-value-new' );\n\n\t\t//Swap the old default value input with the new one, then delete the old one.\n\t\tlet temp_node = document.createElement( \"div\" );\n\t\told_input.parentNode.insertBefore( temp_node, old_input );\n\t\tnew_input.parentNode.insertBefore( old_input, new_input );\n\t\ttemp_node.parentNode.insertBefore( new_input, temp_node );\n\t\ttemp_node.parentNode.removeChild( temp_node );\n\t\told_input.parentNode.parentNode.remove();\n\n\t\t//Set ID of the new default value input to the old one.\n\t\tnew_input.id = 'custom-field-default-value';\n\n\t\tif ( set_default ) {\n\t\t\tform_item_input.setValue( this.current_edit_record.default_value );\n\t\t} else {\n\t\t\tthis.current_edit_record.default_value = '';\n\t\t}\n\t}\n\n\thideValidationFields() {\n\t\tthis.detachElement( 'validate_min_length' );\n\t\tthis.detachElement( 'validate_max_length' );\n\t\tthis.detachElement( 'validate_min_amount' );\n\t\tthis.detachElement( 'validate_max_amount' );\n\t\tthis.detachElement( 'validate_decimal_places' );\n\t\tthis.detachElement( 'validate_min_date' );\n\t\tthis.detachElement( 'validate_max_date' );\n\t\tthis.detachElement( 'validate_min_time_unit' );\n\t\tthis.detachElement( 'validate_max_time_unit' );\n\t\tthis.detachElement( 'validate_min_time' );\n\t\tthis.detachElement( 'validate_max_time' );\n\t\tthis.detachElement( 'validate_min_datetime' );\n\t\tthis.detachElement( 'validate_max_datetime' );\n\t\tthis.detachElement( 'validate_multi_select_min_amount' );\n\t\tthis.detachElement( 'validate_multi_select_max_amount' );\n\n\t\t$( '#tab_custom_field_content_div #dropdown-editor').hide()\n\t}\n\n\tcreateMetaData( type_id ) {\n\n\t\ttype_id = parseInt( type_id ); //Switch is strict on type, so we need to parseInt()\n\n\t\tswitch ( type_id ) {\n\t\t\tcase 100: //Text\n\t\t\tcase 110: //Textarea\n\t\t\t\tthis.current_edit_record.meta_data.validation = {\n\t\t\t\t\t'validate_min_length': this.current_edit_record.validate_min_length,\n\t\t\t\t\t'validate_max_length': this.current_edit_record.validate_max_length,\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 400: //Integer\n\t\t\tcase 420: //Currency\n\t\t\t\tthis.current_edit_record.meta_data.validation = {\n\t\t\t\t\t'validate_min_amount': this.current_edit_record.validate_min_amount,\n\t\t\t\t\t'validate_max_amount': this.current_edit_record.validate_max_amount,\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 410: //Decimal\n\t\t\t\tthis.current_edit_record.meta_data.validation = {\n\t\t\t\t\t'validate_min_amount': this.current_edit_record.validate_min_amount,\n\t\t\t\t\t'validate_max_amount': this.current_edit_record.validate_max_amount,\n\t\t\t\t\t'validate_decimal_places': this.current_edit_record.validate_decimal_places,\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 1000: //Date\n\t\t\tcase 1010: //Date range\n\t\t\t\tthis.current_edit_record.meta_data.validation = {\n\t\t\t\t\t'validate_min_date': this.current_edit_record.validate_min_date,\n\t\t\t\t\t'validate_max_date': this.current_edit_record.validate_max_date,\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 1100: //Time\n\t\t\t\tthis.current_edit_record.meta_data.validation = {\n\t\t\t\t\t'validate_min_time': this.current_edit_record.validate_min_time,\n\t\t\t\t\t'validate_max_time': this.current_edit_record.validate_max_time,\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 1200: //Datetike\n\t\t\t\tthis.current_edit_record.meta_data.validation = {\n\t\t\t\t\t'validate_min_datetime': this.current_edit_record.validate_min_datetime,\n\t\t\t\t\t'validate_max_datetime': this.current_edit_record.validate_max_datetime,\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 1300: //Time Unit\n\t\t\t\tthis.current_edit_record.meta_data.validation = {\n\t\t\t\t\t'validate_min_time_unit': this.current_edit_record.validate_min_time_unit,\n\t\t\t\t\t'validate_max_time_unit': this.current_edit_record.validate_max_time_unit,\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 2100: //Single-select\n\t\t\t\tthis.current_edit_record.meta_data.validation = {\n\t\t\t\t\t'multi_select_items': this.editor.getValue().filter( ( item ) => item.id !== '' || item.id !== '' ),\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 2110: //Multi-select\n\t\t\t\tthis.current_edit_record.meta_data.validation = {\n\t\t\t\t\t'validate_multi_select_min_amount': this.current_edit_record.validate_multi_select_min_amount,\n\t\t\t\t\t'validate_multi_select_max_amount': this.current_edit_record.validate_multi_select_max_amount,\n\t\t\t\t\t'multi_select_items': this.editor.getValue().filter( ( item ) => item.id !== '' || item.id !== '' ),\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis.current_edit_record.meta_data.validation = {}; //Clear all validation fields\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tupdateCustomFieldDropdowns() {\n\t\tif ( this.current_edit_record.type_id == 2100 || this.current_edit_record.type_id == 2110 ) {\n\t\t\tlet source_data = this.editor.getValue();\n\t\t\tlet default_data = this.current_edit_record.default_value;\n\t\t\tthis.edit_view_ui_dic['default_value'].setSourceData( source_data );\n\t\t\tif ( Array.isArray( source_data ) && source_data.some( item => item.id == default_data ) ) {\n\t\t\t\tthis.edit_view_ui_dic['default_value'].setValue( this.current_edit_record.default_value );\n\t\t\t} else {\n\t\t\t\t//If more than one item is selected, unselect the removed item only. Otherwise set dropdown to null for no item selected.\n\t\t\t\tif ( Array.isArray( default_data ) && default_data.length > 1 ) {\n\t\t\t\t\tthis.edit_view_ui_dic['default_value'].setValue( default_data.filter( default_item => source_data.some( source_item => source_item.id == default_item ) ) );\n\t\t\t\t} else {\n\t\t\t\t\tthis.edit_view_ui_dic['default_value'].setValue( null );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetCurrentEditRecordData() {\n\t\tthis.parseMetaDataToCurrentEditRecord();\n\t\tsuper.setCurrentEditRecordData();\n\n\t\tif ( this.is_add == false ) {\n\t\t\tthis.edit_view_ui_dic['type_id'].setEnabled( false );\n\t\t\tthis.edit_view_ui_dic['parent_table'].setEnabled( false );\n\t\t}\n\n\t\tthis.setPunchFieldTypes();\n\t}\n\n\tsetPunchFieldTypes() {\n\n\t\tvar punch_allowed_types_api_params = { 'parent_table': this.current_edit_record.parent_table };\n\t\tvar punch_allowed_types = this.api.getOptions( 'type_id', punch_allowed_types_api_params, { async: false } ).getResult();\n\n\t\tthis.edit_view_ui_dic.type_id.setSourceData( punch_allowed_types );\n\n\t\tif ( punch_allowed_types[this.current_edit_record.type_id] ) {\n\t\t\t//Changing source data visually changes the selected item, so we need to set it back to the current value.\n\t\t\tthis.edit_view_ui_dic.type_id.setValue( this.current_edit_record.type_id );\n\t\t} else {\n\t\t\t//Selected type is not allowed for this parent table. Set to first allowed type.\n\t\t\tthis.edit_view_ui_dic.type_id.setValue( Object.keys( punch_allowed_types )[0] );\n\t\t\tthis.current_edit_record.type_id = Object.keys( punch_allowed_types )[0];\n\t\t}\n\t}\n\n\tparseMetaDataToCurrentEditRecord() {\n\t\tfor ( var rule in this.current_edit_record.meta_data.validation ) {\n\t\t\tthis.current_edit_record[rule] = this.current_edit_record.meta_data.validation[rule];\n\t\t}\n\t}\n\n\tbuildSearchFields() {\n\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Name' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'name',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Status' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'status_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Field Type' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'type_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Object Type' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'parent_table',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t];\n\t}\n\n\tsetDefaultMenuAddIcon( context_btn, grid_selected_length, pId ) {\n\t\t//Community edition cannot add custom fields.\n\t\tif ( Global.getProductEdition() == 10 ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t} else {\n\t\t\tsuper.setDefaultMenuAddIcon( context_btn, grid_selected_length, pId );\n\t\t}\n\t}\n\n\tgetCustomFieldTabHtml() {\n\t\treturn `<div id=\"tab_custom_field\" class=\"edit-view-tab-outside\">\n\t\t\t\t\t<div class=\"edit-view-tab\" id=\"tab_custom_field_content_div\">\n\t\t\t\t\t\t<div class=\"first-column\"></div>\n\t\t\t\t\t\t<div class=\"second-column\"></div>\n\t\t\t\t\t\t<div class=\"inside-editor-div full-width-column\" id=\"dropdown-editor\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`;\n\t}\n\n\tcopyAsNewResetIds( data ) {\n\t\tif ( this.edit_view_ui_dic['type_id'] && this.edit_view_ui_dic['parent_table'] ) {\n\t\t\t//If copying as new while on a record instead of list view, these may already be disabled.\n\t\t\t//Copy as new does not build a new edit view and instead resets the current_edit_record.id.\n\t\t\tthis.edit_view_ui_dic['type_id'].setEnabled( true );\n\t\t\tthis.edit_view_ui_dic['parent_table'].setEnabled( true );\n\t\t}\n\t\treturn super.copyAsNewResetIds( data );\n\t}\n\n\tonSaveDone( result ) {\n\t\t//Clearing cache to prevent issues with report display columns showing outdated cached results.\n\t\tGlobal.clearCache( 'getOptions_columns' );\n\t\tGlobal.clearCache( 'getOptions_debit_credit_variables' ); //PayStubEntryAccount variable selector\n\t\tGlobal.clearCache( 'getOptions_formula_columns' ); //Custom columns variable selector\n\t\tsuper.onSaveDone( result );\n\t}\n\n}\n"],"names":["CustomFieldViewController","options","_","$","context_menu_model","callBack","result","$this","tab_model","tab_custom_field","tab_custom_field_column1","tab_custom_field_column2","form_item_input","inside_editor_div","args","getRender","getRowRender","val","row","data","index","is_existing_row","row_id","render","widgets","e","target","doNotValidate","current_edit_item_id","len","i","reset_rows","item","key","c_value","set_default","element","value","new_type_id","target_column","form_array","widget_container","old_input","new_input","temp_node","type_id","source_data","default_data","default_item","source_item","punch_allowed_types_api_params","punch_allowed_types","rule","context_btn","grid_selected_length","pId"],"mappings":"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"}