import{_ as o,j as i}from"./vendor-tTApdY0Y.bundle.js";class n extends BaseViewController{constructor(t={}){o.defaults(t,{el:"#kpi_view_container",type_array:null,status_array:null,kpi_group_array:null,kpi_group_api:null,sub_document_view_controller:null,document_object_type_id:null}),super(t)}init(t){this.edit_view_tpl="KPIEditView.html",this.permission_id="kpi",this.viewId="KPI",this.script_name="KPIView",this.table_name_key="kpi",this.context_menu_name=i.i18n._("KPI"),this.navigation_label=i.i18n._("KPI"),this.api=TTAPI.APIKPI,this.kpi_group_api=TTAPI.APIKPIGroup,this.document_object_type_id=210,this.render(),this.buildContextMenu(),this.initData()}initOptions(){var t=this;this.initDropDownOption("type"),this.initDropDownOption("status"),this.kpi_group_api.getKPIGroup("",!1,!1,{onResult:function(a){a=Global.clone(a.getResult());var _={};_.name="-- "+i.i18n._("All")+" --",_.level=1,_.id=TTUUID.not_exist_id,a.hasOwnProperty("0")&&a[0].hasOwnProperty("children")?a[0].children.unshift(_):a=[{children:[_],id:0,level:0,name:"Root"}],a=Global.buildTreeRecord(a),t.kpi_group_array=a,!t.sub_view_mode&&t.basic_search_field_ui_dic.group_id&&t.basic_search_field_ui_dic.group_id.setSourceData(a)}})}buildEditViewUI(){super.buildEditViewUI();var t=this,a={tab_key_performance_indicator:{label:i.i18n._("Key Performance Indicator")},tab_attachment:!0,tab_audit:!0};this.setTabModel(a),this.navigation.AComboBox({api_class:TTAPI.APIKPI,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_kpi",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var _=this.edit_view_tab.find("#tab_key_performance_indicator"),l=_.find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(l);var e=Global.loadWidgetByName(FormItemType.COMBO_BOX);e.TComboBox({field:"type_id"}),e.setSourceData(t.type_array),this.addEditFieldToColumn(i.i18n._("Type"),e,l,""),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"status_id"}),e.setSourceData(t.status_array),this.addEditFieldToColumn(i.i18n._("Status"),e,l),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn(i.i18n._("Name"),e,l),e.parent().width("45%"),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"display_order",width:50}),this.addEditFieldToColumn(i.i18n._("Display Order"),e,l),e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({tree_mode:!0,allow_multiple_selection:!0,layout_name:"global_tree_column",set_empty:!0,field:"group_id"}),e.setSourceData(t.kpi_group_array),this.addEditFieldToColumn(i.i18n._("Group"),e,l),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"minimum_rate",width:50}),this.addEditFieldToColumn(i.i18n._("Minimum Rating"),e,l,"",null,!0),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"maximum_rate",width:50}),this.addEditFieldToColumn(i.i18n._("Maximum Rating"),e,l,"",null,!0),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"description",width:"100%"}),this.addEditFieldToColumn(i.i18n._("Description"),e,l),e.parent().width("45%"),e=Global.loadWidgetByName(FormItemType.TAG_INPUT),e.TTagInput({field:"tag",object_type_id:310}),this.addEditFieldToColumn(i.i18n._("Tags"),e,l,"",null,null,!0)}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:i.i18n._("Name"),in_column:1,field:"name",multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:i.i18n._("Type"),in_column:1,field:"type_id",multiple:!0,basic_search:!0,adv_search:!1,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:i.i18n._("Status"),in_column:1,field:"status_id",multiple:!0,basic_search:!0,adv_search:!1,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:i.i18n._("Tags"),field:"tag",basic_search:!0,adv_search:!1,in_column:1,object_type_id:310,form_item_type:FormItemType.TAG_INPUT}),new SearchField({label:i.i18n._("Group"),in_column:2,multiple:!0,field:"group_id",layout_name:"global_tree_column",tree_mode:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:i.i18n._("Description"),in_column:2,field:"description",multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:i.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:i.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX})]}setCurrentEditRecordData(){this.setDefaultData({type_id:10});for(var t in this.current_edit_record){var a=this.edit_view_ui_dic[t];if(Global.isSet(a))switch(t){default:a.setValue(this.current_edit_record[t]);break}}this.collectUIDataToCurrentEditRecord(),this.setEditViewDataDone()}setEditViewDataDone(){super.setEditViewDataDone(),this.onTypeChange()}onFormItemChange(t,a){this.setIsChanged(t),this.setMassEditingFieldsWhenFormChange(t);var _=t.getField(),l=t.getValue();this.current_edit_record[_]=l,_==="type_id"&&this.onTypeChange(),a||this.validate()}onTypeChange(){this.current_edit_record.type_id==10?(this.attachElement("minimum_rate"),this.attachElement("maximum_rate")):(this.detachElement("minimum_rate"),this.detachElement("maximum_rate")),this.editFieldResize()}}export{n as KPIViewController};
//# sourceMappingURL=KPIViewController-C4pxg4n9.bundle.js.map
