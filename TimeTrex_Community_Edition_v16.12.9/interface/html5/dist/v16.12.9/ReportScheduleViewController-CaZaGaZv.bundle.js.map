{"version":3,"file":"ReportScheduleViewController-CaZaGaZv.bundle.js","sources":["../../views/reports/report_schedule/ReportScheduleViewController.js"],"sourcesContent":["export class ReportScheduleViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#report_schedule_view_container',\n\n\t\t\tstatus_array: null,\n\t\t\tpriority_array: null,\n\t\t\tminute_array: null,\n\t\t\thour_array: null,\n\t\t\tday_of_month_array: null,\n\t\t\tmonth_array: null,\n\t\t\tday_of_week_array: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\n\t\tthis.edit_view_tpl = 'ReportScheduleEditView.html';\n\t\tthis.permission_id = 'report';\n\t\tthis.viewId = 'ReportSchedule';\n\t\tthis.script_name = 'ReportScheduleView';\n\t\tthis.table_name_key = 'report_schedule';\n\t\tthis.context_menu_name = $.i18n._( 'Report Schedule' );\n\t\tthis.navigation_label = $.i18n._( 'Report Schedule' );\n\t\tthis.api = TTAPI.APIReportSchedule;\n\n\t\tthis.render();\n\n\t\tif ( this.sub_view_mode ) {\n\t\t\tthis.buildContextMenu( true );\n\t\t\t//call init data in parent view, don't call initData\n\t\t} else {\n\t\t\tthis.buildContextMenu();\n\t\t\tif ( !this.sub_view_mode ) {\n\t\t\t\tthis.initData();\n\t\t\t}\n\t\t}\n\t}\n\n\tonAddResult( result ) {\n\t\tvar $this = this;\n\t\tvar result_data = result.getResult();\n\n\t\tif ( !result_data ) {\n\t\t\tresult_data = [];\n\t\t}\n\n\t\tresult_data.company = LocalCacheData.current_company.name;\n\n\t\tif ( $this.sub_view_mode && $this.parent_key ) {\n\t\t\tresult_data[$this.parent_key] = $this.parent_value;\n\t\t}\n\n\t\t$this.current_edit_record = result_data;\n\t\t$this.current_edit_record[this.parent_key] = this.parent_value;\n\t\t$this.initEditView();\n\t}\n\n\tinitOptions() {\n\t\tvar options = [\n\t\t\t{ option_name: 'status', api: this.api },\n\t\t\t{ option_name: 'priority', api: this.api },\n\t\t\t{ option_name: 'minute', api: this.api },\n\t\t\t{ option_name: 'hour', api: this.api },\n\t\t\t{ option_name: 'day_of_month', api: this.api },\n\t\t\t{ option_name: 'month', api: this.api },\n\t\t\t{ option_name: 'day_of_week', api: this.api },\n\t\t];\n\n\t\tthis.initDropDownOptions( options );\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_report_schedule': { 'label': $.i18n._( 'Report Schedule' ) },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIUserReportData,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_branch',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_report_schedule = this.edit_view_tab.find( '#tab_report_schedule' );\n\n\t\tvar tab_report_schedule_column1 = tab_report_schedule.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_report_schedule_column1 );\n\n\t\t//Status\n\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'status_id', set_empty: false } );\n\t\tform_item_input.setSourceData( $this.status_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_report_schedule_column1, '' );\n\n\t\t// Name\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'name', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Name' ), form_item_input, tab_report_schedule_column1 );\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Description\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\n\t\tform_item_input.TTextInput( { field: 'description', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Description' ), form_item_input, tab_report_schedule_column1, '', null, null, true );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t//Format\n\n\t\tvar format_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tformat_input.TComboBox( { field: 'output_format', set_empty: false } );\n\n\t\tthis.api.getReportOutputFormatOptions( this.parent_edit_record.id, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tformat_input.setSourceData( Global.buildRecordArray( result.getResult() ) );\n\t\t\t}\n\t\t} );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Format' ), format_input, tab_report_schedule_column1 );\n\n\t\t//Priority\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'priority_id', set_empty: false } );\n\t\tform_item_input.setSourceData( $this.priority_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Priority' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t//Start Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\tform_item_input.TDatePicker( { field: 'start_date' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Start Date' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t//End Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\tform_item_input.TDatePicker( { field: 'end_date' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'End Date' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t//Minute\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input = form_item_input.AComboBox( {\n\t\t\tfield: 'minute',\n\t\t\tset_empty: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_option_column',\n\t\t\tkey: 'value'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.minute_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Minute' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t//Hour\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input = form_item_input.AComboBox( {\n\t\t\tfield: 'hour',\n\t\t\tset_empty: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_option_column',\n\t\t\tkey: 'value'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.hour_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Hour' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t//Day of month\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input = form_item_input.AComboBox( {\n\t\t\tfield: 'day_of_month',\n\t\t\tset_empty: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_option_column',\n\t\t\tkey: 'value'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.day_of_month_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Day of Month' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t//month\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input = form_item_input.AComboBox( {\n\t\t\tfield: 'month',\n\t\t\tset_empty: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_option_column',\n\t\t\tkey: 'value'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.month_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Month' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t//Day of Week\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input = form_item_input.AComboBox( {\n\t\t\tfield: 'day_of_week',\n\t\t\tset_empty: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_option_column',\n\t\t\tkey: 'value'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.day_of_week_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Day of Week' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t// Email Even If Blank\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\n\t\tform_item_input.TCheckbox( { field: 'email_blank_report' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Email Even If Blank' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t// Send Report to Home Email\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\n\t\tform_item_input.TCheckbox( { field: 'home_email_cc' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Send Report to Home Email' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t//Other email\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'other_email', width: 300 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Send Report to Other Email' ), form_item_input, tab_report_schedule_column1 );\n\t}\n\n\tsearchDone() {\n\t\t$( 'window' ).trigger( 'resize' );\n\t\tif ( this.sub_view_mode ) {\n\t\t\tTTPromise.resolve( 'initSubReportScheduleView', 'init' );\n\t\t}\n\t\tsuper.searchDone();\n\t}\n}\n\nReportScheduleViewController.loadSubView = function( container, beforeViewLoadedFun, afterViewLoadedFun ) {\n\n\tGlobal.loadViewSource( 'ReportSchedule', 'SubReportScheduleView.html', function( result ) {\n\n\t\tvar args = {};\n\t\tvar template = _.template( result );\n\n\t\tif ( Global.isSet( beforeViewLoadedFun ) ) {\n\t\t\tbeforeViewLoadedFun();\n\t\t}\n\n\t\tif ( Global.isSet( container ) ) {\n\t\t\tcontainer.html( template( args ) );\n\t\t\tif ( Global.isSet( afterViewLoadedFun ) ) {\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'initialize', function() {\n\t\t\t\t\tafterViewLoadedFun( sub_report_schedule_view_controller );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t}\n\n\t} );\n\n};"],"names":["ReportScheduleViewController","options","$","result","$this","result_data","tab_model","tab_report_schedule","tab_report_schedule_column1","form_item_input","format_input","container","beforeViewLoadedFun","afterViewLoadedFun","args","template"],"mappings":"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"}