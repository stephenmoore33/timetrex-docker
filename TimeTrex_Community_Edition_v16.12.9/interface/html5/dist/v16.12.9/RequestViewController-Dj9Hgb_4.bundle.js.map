{"version":3,"file":"RequestViewController-Dj9Hgb_4.bundle.js","sources":["../../views/my_account/request/RequestViewController.js"],"sourcesContent":["export class RequestViewController extends RequestViewCommonController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#request_view_container',\n\n\t\t\ttype_array: null,\n\t\t\trequest_type_array: null,\n\t\t\tstatus_array: null,\n\n\t\t\tapi_request_schedule: null,\n\t\t\tauthorization_api: null,\n\t\t\tschedule_api: null,\n\t\t\thierarchy_type_id: false,\n\n\t\t\tpunch_tag_api: null,\n\t\t\tdefault_punch_tag: [],\n\t\t\tprevious_punch_tag_selection: [],\n\n\t\t\toverlapping_shift_data: {},\n\n\t\t\tmessages: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options);\n\t\tthis.edit_view_tpl = 'RequestEditView.html';\n\t\tthis.permission_id = 'request';\n\t\tthis.viewId = 'Request';\n\t\tthis.script_name = 'RequestView';\n\t\tthis.table_name_key = 'request';\n\t\tthis.context_menu_name = $.i18n._( 'Requests' );\n\t\tthis.navigation_label = $.i18n._( 'Request' );\n\t\tthis.api = TTAPI.APIRequest;\n\t\tthis.api_absence_policy = TTAPI.APIAbsencePolicy;\n\t\tthis.api_schedule = TTAPI.APISchedule;\n\t\tthis.message_control_api = TTAPI.APIMessageControl;\n\n\t\tif ( ( Global.getProductEdition() >= 15 ) ) {\n\t\t\tthis.api_request_schedule = TTAPI.APIRequestSchedule;\n\t\t\tthis.schedule_api = TTAPI.APISchedule;\n\t\t}\n\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\tthis.job_api = TTAPI.APIJob;\n\t\t\tthis.job_item_api = TTAPI.APIJobItem;\n\t\t\tthis.punch_tag_api = TTAPI.APIPunchTag;\n\t\t}\n\n\t\tthis.authorization_api = TTAPI.APIAuthorization;\n\n\t\tthis.initPermission();\n\t\tthis.render();\n\t\tthis.buildContextMenu();\n\n\t\tthis.initData();\n\t}\n\n\t// override allows a callback after initOptions when run as sub view (from EmployeeViewController)\n\tinitOptions( callBack ) {\n\n\t\tvar options = [\n\t\t\t{ option_name: 'status' },\n\t\t\t{ option_name: 'type' }\n\t\t];\n\n\t\tif ( ( Global.getProductEdition() >= 15 ) ) {\n\t\t\toptions.push( { option_name: 'overlap_type', api: TTAPI.APIRequestSchedule } );\n\t\t}\n\n\t\tthis.initDropDownOptions( options, function( result ) {\n\n\t\t\tif ( callBack ) {\n\t\t\t\tcallBack( result ); // First to initialize drop down options, and then to initialize edit view UI.\n\t\t\t}\n\n\t\t} );\n\t}\n\n\tbuildEditViewUI() {\n\t\tsuper.buildEditViewUI();\n\n\t\tvar tab_model = {\n\t\t\t'tab_request': { 'label': $.i18n._( 'Message' ) },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\t//This hides the audit tab as this view is always used for creating/replying to an existing request.\n\t\t//For some reason removing 'tab_audit' from the model above results in a blank tab appearing.\n\t\tvar tab_audit_label = this.edit_view.find( 'a[ref=tab_audit]' );\n\t\ttab_audit_label.css( 'display', 'none' );\n\n\t\t//Tab 0 start\n\n\t\tvar tab_request = this.edit_view_tab.find( '#tab_request' );\n\t\tvar tab_request_column1 = tab_request.find( '.first-column' );\n\t\tvar tab_request_column2 = tab_request.find( '.second-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\t\tthis.edit_view_tabs[0].push( tab_request_column1 );\n\n\t\t// Subject\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'subject', width: 359 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Subject' ), form_item_input, tab_request_column1, '' );\n\n\t\t// Body\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\n\t\tform_item_input.TTextArea( { field: 'body', width: 600, height: 400 } );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Body' ), form_item_input, tab_request_column1, '', null, null, true );\n\n\t\ttab_request_column2.css( 'display', 'none' );\n\t}\n\n\tbuildAddViewUI() {\n\t\tsuper.buildEditViewUI();\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_request': { 'label': $.i18n._( 'Request' ), 'is_multi_column': true },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\t//This hides the audit tab as this view is always used for creating/replying to an existing request.\n\t\t//For some reason removing 'tab_audit' from the model above results in a blank tab appearing.\n\t\tvar tab_audit_label = this.edit_view.find( 'a[ref=tab_audit]' );\n\t\ttab_audit_label.css( 'display', 'none' );\n\n\t\t//Tab 0 start\n\t\tvar tab_request = this.edit_view_tab.find( '#tab_request' );\n\t\tvar tab_request_column1 = tab_request.find( '.first-column' );\n\t\tvar tab_request_column2 = tab_request.find( '.second-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\t\tthis.edit_view_tabs[0].push( tab_request_column1 );\n\t\tthis.edit_view_tabs[0].push( tab_request_column2 );\n\n\t\tvar form_item_input;\n\t\tvar widgetContainer;\n\t\tvar label;\n\n\t\t// Employee\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( { field: 'full_name' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Employee' ), form_item_input, tab_request_column1, '' );\n\n\t\t// Type\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'type_id', set_empty: false } );\n\t\tform_item_input.setSourceData( $this.type_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Type' ), form_item_input, tab_request_column1 );\n\n\t\t// Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\tform_item_input.TDatePicker( { field: 'date_stamp' } );\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\tlabel = $( '<span class=\\'widget-right-label\\'> ' + $.i18n._( '(Use the first or only date affected by this request)' ) + '</span>' );\n\t\twidgetContainer.append( form_item_input );\n\t\twidgetContainer.append( label );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Date' ), form_item_input, tab_request_column1, '', widgetContainer );\n\n\t\tif ( Global.getProductEdition() >= 15 && PermissionManager.validate( 'request', 'add_advanced' ) ) {\n\t\t\t//Working Status\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\t\tform_item_input.TComboBox( { field: 'request_schedule_status_id', set_empty: false } );\n\t\t\tform_item_input.setSourceData( { 10: 'Working', 20: 'Absent' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_request_column1 );\n\n\t\t\t//Absence Policy\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIAbsencePolicy,\n\t\t\t\tcustomSearchFilter: function() {\n\t\t\t\t\treturn { filter_data: { user_id: LocalCacheData.getLoginUser().id } };\n\t\t\t\t},\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_absences',\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'absence_policy_id'\n\t\t\t} );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Absence Policy' ), form_item_input, tab_request_column1 );\n\n\t\t\t//Available Balance\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\tform_item_input.TText( { field: 'available_balance' } );\n\t\t\twidgetContainer = $( '<div class=\\'widget-h-box available-balance-h-box\\'></div>' );\n\t\t\tthis.available_balance_info = $( '<span class=\"available-balance-info tticon tticon-info_black_24dp\"></span>' );\n\t\t\twidgetContainer.append( form_item_input );\n\t\t\twidgetContainer.append( this.available_balance_info );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Available Balance' ), form_item_input, tab_request_column1, '', widgetContainer, true );\n\n\t\t\t//Start Date\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\t\tform_item_input.TDatePicker( { field: 'start_date' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Start Date' ), form_item_input, tab_request_column1, '' );\n\n\t\t\t//End  Date\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\t\tform_item_input.TDatePicker( { field: 'end_date' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'End Date' ), form_item_input, tab_request_column1, '' );\n\n\t\t\t// Effective Days\n\t\t\tvar form_item_sun_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_sun_checkbox.TCheckbox( { field: 'sun' } );\n\n\t\t\tvar form_item_mon_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_mon_checkbox.TCheckbox( { field: 'mon' } );\n\n\t\t\tvar form_item_tue_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_tue_checkbox.TCheckbox( { field: 'tue' } );\n\n\t\t\tvar form_item_wed_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_wed_checkbox.TCheckbox( { field: 'wed' } );\n\n\t\t\tvar form_item_thu_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_thu_checkbox.TCheckbox( { field: 'thu' } );\n\n\t\t\tvar form_item_fri_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_fri_checkbox.TCheckbox( { field: 'fri' } );\n\n\t\t\tvar form_item_sat_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_sat_checkbox.TCheckbox( { field: 'sat' } );\n\n\t\t\twidgetContainer = $( '<div></div>' );\n\n\t\t\tvar sun = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Sun' ) + ' <br> ' + ' </span>' );\n\t\t\tvar mon = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Mon' ) + ' <br> ' + ' </span>' );\n\t\t\tvar tue = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Tue' ) + ' <br> ' + ' </span>' );\n\t\t\tvar wed = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Wed' ) + ' <br> ' + ' </span>' );\n\t\t\tvar thu = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Thu' ) + ' <br> ' + ' </span>' );\n\t\t\tvar fri = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Fri' ) + ' <br> ' + ' </span>' );\n\t\t\tvar sat = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Sat' ) + ' <br> ' + ' </span>' );\n\n\t\t\tsun.append( form_item_sun_checkbox );\n\t\t\tmon.append( form_item_mon_checkbox );\n\t\t\ttue.append( form_item_tue_checkbox );\n\t\t\twed.append( form_item_wed_checkbox );\n\t\t\tthu.append( form_item_thu_checkbox );\n\t\t\tfri.append( form_item_fri_checkbox );\n\t\t\tsat.append( form_item_sat_checkbox );\n\n\t\t\twidgetContainer.append( sun );\n\t\t\twidgetContainer.append( mon );\n\t\t\twidgetContainer.append( tue );\n\t\t\twidgetContainer.append( wed );\n\t\t\twidgetContainer.append( thu );\n\t\t\twidgetContainer.append( fri );\n\t\t\twidgetContainer.append( sat );\n\n\t\t\twidgetContainer.addClass( 'request_edit_view_effective_days' );\n\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Effective Days' ), [form_item_sun_checkbox, form_item_mon_checkbox, form_item_tue_checkbox, form_item_wed_checkbox, form_item_thu_checkbox, form_item_fri_checkbox, form_item_sat_checkbox], tab_request_column1, '', widgetContainer, false, true );\n\n\t\t\t//Start time\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TIME_PICKER );\n\t\t\tform_item_input.TTimePicker( { field: 'start_time' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'In' ), form_item_input, tab_request_column1 );\n\n\t\t\t//End  time\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TIME_PICKER );\n\t\t\tform_item_input.TTimePicker( { field: 'end_time' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Out' ), form_item_input, tab_request_column1 );\n\n\t\t\t// Total\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\tform_item_input.TText( { field: 'total_time' } );\n\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\t\tlabel = $( '<span class=\\'widget-right-label\\' id=\\'total_info\\'></span>' );\n\t\t\twidgetContainer.append( form_item_input );\n\t\t\twidgetContainer.append( label );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Total' ), form_item_input, tab_request_column1, '', widgetContainer );\n\n\t\t\tif ( ( Global.getProductEdition() >= 15 ) && this.overlappingShiftUIValidate() == true ) {\n\t\t\t\t//Override / Split shift\n\t\t\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\t\t\tform_item_input.TComboBox( { field: 'overlap_type_id', set_empty: false } );\n\t\t\t\tform_item_input.setSourceData( this.overlap_type_array );\n\t\t\t\twidgetContainer = $( '<div class=\\'widget-h-box overlapping-shift-h-box\\'></div>' );\n\t\t\t\tthis.overlapping_shift_info = $( '<span style=\"position: relative; top: -3px; left: 3px;\" id=\"overlapping-shift-total\"></span><span id=\"overlapping-shift-icon\" class=\"overlapping-shift-info tticon tticon-info_black_24dp\"></span>' );\n\t\t\t\twidgetContainer.append( form_item_input );\n\t\t\t\twidgetContainer.append( this.overlapping_shift_info );\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Overlapping Shift(s)' ), form_item_input, tab_request_column1, '', widgetContainer, true );\n\t\t\t}\n\n\t\t\t//Schedule Policy\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APISchedulePolicy,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_schedule',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'schedule_policy_id'\n\t\t\t} );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Schedule Policy' ), form_item_input, tab_request_column1 );\n\n\t\t\t//branch\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIBranch,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_branch',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'branch_id'\n\t\t\t} );\n\t\t\tif ( this.show_branch_ui ) {\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Branch' ), form_item_input, tab_request_column1 );\n\t\t\t}\n\n\t\t\t//Dept\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIDepartment,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_department',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'department_id'\n\t\t\t} );\n\n\t\t\tif ( this.show_department_ui ) {\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Department' ), form_item_input, tab_request_column1 );\n\t\t\t}\n\n\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t//Job\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\t\t\tform_item_input.AComboBox( {\n\t\t\t\t\tapi_class: TTAPI.APIJob,\n\t\t\t\t\tallow_multiple_selection: false,\n\t\t\t\t\tlayout_name: 'global_job',\n\t\t\t\t\tshow_search_inputs: true,\n\t\t\t\t\tset_empty: true,\n\t\t\t\t\tsetRealValueCallBack: ( function( val ) {\n\n\t\t\t\t\t\tif ( val ) {\n\t\t\t\t\t\t\tjob_coder.setValue( val.manual_id );\n\t\t\t\t\t\t}\n\t\t\t\t\t} ),\n\t\t\t\t\tfield: 'job_id',\n\t\t\t\t\tadded_items: [\n\t\t\t\t\t\t{ value: '-1', label: Global.default_item },\n\t\t\t\t\t\t{ value: '-2', label: Global.selected_item }\n\t\t\t\t\t]\n\t\t\t\t} );\n\n\t\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\t\t\tvar job_coder = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tjob_coder.TTextInput( { field: 'job_quick_search', disable_keyup_event: true } );\n\t\t\t\tjob_coder.addClass( 'job-coder' );\n\n\t\t\t\twidgetContainer.append( job_coder );\n\t\t\t\twidgetContainer.append( form_item_input );\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Job' ), [form_item_input, job_coder], tab_request_column1, '', widgetContainer, true );\n\n\t\t\t\tif ( !this.show_job_ui ) {\n\t\t\t\t\t//invalid permissions\n\t\t\t\t\tthis.detachElement( 'job_id' );\n\t\t\t\t}\n\t\t\t\t//Job Item\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\t\t\tform_item_input.AComboBox( {\n\t\t\t\t\tapi_class: TTAPI.APIJobItem,\n\t\t\t\t\tallow_multiple_selection: false,\n\t\t\t\t\tlayout_name: 'global_job_item',\n\t\t\t\t\tshow_search_inputs: true,\n\t\t\t\t\tset_empty: true,\n\t\t\t\t\tsetRealValueCallBack: ( function( val ) {\n\n\t\t\t\t\t\tif ( val ) {\n\t\t\t\t\t\t\tjob_item_coder.setValue( val.manual_id );\n\t\t\t\t\t\t}\n\t\t\t\t\t} ),\n\t\t\t\t\tfield: 'job_item_id',\n\t\t\t\t\tadded_items: [\n\t\t\t\t\t\t{ value: '-1', label: Global.default_item },\n\t\t\t\t\t\t{ value: '-2', label: Global.selected_item }\n\t\t\t\t\t]\n\t\t\t\t} );\n\n\t\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\t\t\tvar job_item_coder = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tjob_item_coder.TTextInput( { field: 'job_item_quick_search', disable_keyup_event: true } );\n\t\t\t\tjob_item_coder.addClass( 'job-coder' );\n\n\t\t\t\twidgetContainer.append( job_item_coder );\n\t\t\t\twidgetContainer.append( form_item_input );\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Task' ), [form_item_input, job_item_coder], tab_request_column1, '', widgetContainer, true );\n\n\t\t\t\tif ( !this.show_job_item_ui ) {\n\t\t\t\t\t//invalid permissions\n\t\t\t\t\tthis.detachElement( 'job_item_id' );\n\t\t\t\t}\n\n\t\t\t\t//Punch Tag\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\t\t\tform_item_input.AComboBox( {\n\t\t\t\t\tapi_class: TTAPI.APIPunchTag,\n\t\t\t\t\tallow_multiple_selection: true,\n\t\t\t\t\tlayout_name: 'global_punch_tag',\n\t\t\t\t\tshow_search_inputs: true,\n\t\t\t\t\tset_empty: true,\n\t\t\t\t\tsetRealValueCallBack: ( ( punch_tags ) => {\n\t\t\t\t\t\tif ( punch_tags ) {\n\t\t\t\t\t\t\tthis.setPunchTagQuickSearchManualIds( punch_tags );\n\t\t\t\t\t\t}\n\t\t\t\t\t} ),\n\t\t\t\t\tfield: 'punch_tag_id'\n\t\t\t\t} );\n\n\t\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\t\t\tvar punch_tag_coder = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tpunch_tag_coder.TTextInput( { field: 'punch_tag_quick_search', disable_keyup_event: true } );\n\t\t\t\tpunch_tag_coder.addClass( 'job-coder' );\n\n\t\t\t\twidgetContainer.append( punch_tag_coder );\n\t\t\t\twidgetContainer.append( form_item_input );\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Tags' ), [form_item_input, punch_tag_coder], tab_request_column1, '', widgetContainer, true );\n\n\t\t\t\tif ( !this.show_punch_tag_ui ) {\n\t\t\t\t\t//invalid permissions\n\t\t\t\t\tthis.detachElement( 'punch_tag_id' );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Message\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\t\tform_item_input.TTextArea( { field: 'message', width: 400, height: 300 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Reason / Message' ), form_item_input, tab_request_column1, '', null, null, true );\n\n\t\t//hide initially hidden fields.\n\t\t//tab_request_column2.css( 'display', 'none' );\n\t\tif ( Global.getProductEdition() >= 15 && PermissionManager.validate( 'request', 'add_advanced' ) ) {\n\t\t\tthis.edit_view_ui_dic.available_balance.parents( '.edit-view-form-item-div' ).hide();\n\t\t\tthis.hideAdvancedFields();\n\t\t}\n\n\t\tthis.onTypeChanged();\n\t\tthis.onWorkingStatusChanged();\n\t}\n\n\tbuildSearchFields() {\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Employee' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'user_id',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Type' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'type_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Start Date' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'start_date',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.DATE_PICKER\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'End Date' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'end_date',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.DATE_PICKER\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Status' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'status_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Created By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'created_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Updated By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'updated_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\t\t];\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\texclude: ['default'],\n\t\t\tinclude: [\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'New' ),\n\t\t\t\t\tid: 'add',\n\t\t\t\t\tgroup: 'editor',\n\t\t\t\t\tvue_icon: 'tticon tticon-add_black_24dp',\n\t\t\t\t\tshow_on_right_click: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'View' ),\n\t\t\t\t\tid: 'view',\n\t\t\t\t\tgroup: 'editor',\n\t\t\t\t\tvue_icon: 'tticon tticon-visibility_black_24dp',\n\t\t\t\t\tshow_on_right_click: true,\n\t\t\t\t\tsort_order: 1010\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Reply' ),\n\t\t\t\t\tid: 'edit',\n\t\t\t\t\tvue_icon: 'tticon tticon-reply_black_24dp'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Send' ),\n\t\t\t\t\tid: 'send',\n\t\t\t\t\tgroup: 'editor',\n\t\t\t\t\tvue_icon: 'tticon tticon-send_black_24dp'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Delete' ),\n\t\t\t\t\tid: 'delete_icon',\n\t\t\t\t\taction_group: 'delete',\n\t\t\t\t\tgroup: 'editor',\n\t\t\t\t\tvue_icon: 'tticon tticon-delete_black_24dp',\n\t\t\t\t\tshow_on_right_click: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Delete & Next' ),\n\t\t\t\t\tid: 'delete_and_next',\n\t\t\t\t\taction_group: 'delete',\n\t\t\t\t\tgroup: 'editor',\n\t\t\t\t\tvue_icon: 'tticon tticon-delete_black_24dp'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Cancel' ),\n\t\t\t\t\tid: 'cancel',\n\t\t\t\t\tgroup: 'editor',\n\t\t\t\t\tsort_order: 1990\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Jump To' ),\n\t\t\t\t\tid: 'jump_to_header',\n\t\t\t\t\tmenu_align: 'right',\n\t\t\t\t\taction_group: 'jump_to',\n\t\t\t\t\taction_group_header: true,\n\t\t\t\t\tpermission_result: false // to hide it in legacy context menu and avoid errors in legacy parsers.\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'TimeSheet' ),\n\t\t\t\t\tid: 'timesheet',\n\t\t\t\t\tmenu_align: 'right',\n\t\t\t\t\taction_group: 'jump_to',\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Schedule' ),\n\t\t\t\t\tid: 'schedule',\n\t\t\t\t\tmenu_align: 'right',\n\t\t\t\t\taction_group: 'jump_to',\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Export' ),\n\t\t\t\t\tid: 'export_excel',\n\t\t\t\t\tmenu_align: 'right',\n\t\t\t\t\tvue_icon: 'tticon tticon-file_upload_black_24dp',\n\t\t\t\t\tsort_order: 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Edit Employee' ),\n\t\t\t\t\tid: 'edit_employee',\n\t\t\t\t\tmenu_align: 'right',\n\t\t\t\t\taction_group: 'jump_to',\n\t\t\t\t},\n\t\t\t]\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tsetCurrentEditRecordData( current_edit_record ) {\n\t\tvar $this = this;\n\t\tif ( current_edit_record ) {\n\t\t\tthis.current_edit_record = current_edit_record;\n\t\t}\n\n\t\tif ( !this.current_edit_record ) {\n\t\t\tthis.current_edit_record = {};\n\t\t}\n\t\t//Set current edit record data to all widgets\n\t\tfor ( var key in this.current_edit_record ) {\n\t\t\tif ( !this.current_edit_record.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\tif ( Global.isSet( widget ) ) {\n\t\t\t\tswitch ( key ) {\n\t\t\t\t\tcase 'full_name':\n\t\t\t\t\t\tif ( this.is_add ) {\n\t\t\t\t\t\t\twidget.setValue( LocalCacheData.loginUser.first_name + ' ' + LocalCacheData.loginUser.last_name );\n\t\t\t\t\t\t} else if ( this.is_viewing ) {\n\t\t\t\t\t\t\twidget.setValue( this.current_edit_record['first_name'] + ' ' + this.current_edit_record['last_name'] );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'subject':\n\t\t\t\t\t\t// Error: Uncaught TypeError: Cannot read property '0' of null in /interface/html5/#!m=Request&a=view&id=13185&tab=Request line 505\n\t\t\t\t\t\tif ( this.is_edit && this.messages ) {\n\t\t\t\t\t\t\twidget.setValue( 'Re: ' + this.messages[0].subject );\n\t\t\t\t\t\t} else if ( this.is_viewing ) {\n\t\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'punch_tag_id':\n\t\t\t\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\t\tthis.previous_punch_tag_selection = this.current_edit_record[key];\n\n\t\t\t\t\t\t\tvar punch_tag_widget = widget;\n\t\t\t\t\t\t\tTTPromise.wait( null, null, function() {\n\t\t\t\t\t\t\t\t//Update default args for punch tags AComboBox last as they rely on data from job, job item and related fields.\n\t\t\t\t\t\t\t\tvar args = {};\n\t\t\t\t\t\t\t\targs.filter_data = $this.getPunchTagFilterData();\n\t\t\t\t\t\t\t\tpunch_tag_widget.setDefaultArgs( args );\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tthis.collectUIDataToCurrentEditRecord();\n\n\t\t//a new request comes from the current user.\n\t\tif ( this.is_add ) {\n\t\t\tthis.current_edit_record.user_id = LocalCacheData.loginUser.id;\n\t\t}\n\n\t\tthis.setEditViewDataDone();\n\t}\n\n\tsetEditViewDataDone() {\n\t\tvar $this = this;\n\t\tsuper.setEditViewDataDone();\n\t\tif ( this.is_viewing ) {\n\n\t\t} else {\n\t\t\tif ( Global.isSet( $this.messages ) ) {\n\t\t\t\t$this.messages = null;\n\t\t\t}\n\t\t}\n\t\tif ( ( Global.getProductEdition() >= 15 ) ) {\n\t\t\t$this.getOverlappingShifts();\n\t\t}\n\t}\n\n\tinitViewingView() {\n\t\tsuper.initViewingView();\n\t\tif ( this.edit_view_ui_dic.message ) {\n\t\t\tthis.edit_view_ui_dic.message.parents( '.edit-view-form-item-div' ).hide();\n\t\t}\n\t\tif ( Global.getProductEdition() >= 15 && ( this.edit_view_ui_dic.type_id == 30 || this.edit_view_ui_dic.type_id == 40 ) ) {\n\t\t\tvar dow = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'];\n\t\t\tvar one_selected = false;\n\t\t\tfor ( var key in this.current_edit_record ) {\n\t\t\t\tif ( dow.indexOf( key ) > -1 ) {\n\t\t\t\t\tfor ( var i = 0; i < 7; i++ ) {\n\t\t\t\t\t\tif ( this.current_edit_record[key] !== 0 && this.current_edit_record[key] !== false ) {\n\t\t\t\t\t\t\tone_selected = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( one_selected ) {\n\t\t\t\t\t\tthis.edit_view_ui_dic['sun'].parents( '.edit-view-form-item-div' ).show();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.edit_view_ui_dic['sun'].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetURL() {\n\n\t\tif ( LocalCacheData.current_doing_context_action === 'edit' ) {\n\t\t\tLocalCacheData.current_doing_context_action = '';\n\t\t\treturn;\n\t\t}\n\n\t\tsuper.setURL();\n\t}\n\n\tsetCustomDefaultMenuIcon( id, context_btn, grid_selected_length ) {\n\t\tswitch ( id ) {\n\t\t\tcase 'send':\n\t\t\t\tthis.setDefaultMenuSendIcon( context_btn, grid_selected_length );\n\t\t\t\tbreak;\n\t\t\tcase 'timesheet':\n\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length, 'punch' );\n\t\t\t\tbreak;\n\t\t\tcase 'schedule':\n\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length, 'schedule' );\n\t\t\t\tbreak;\n\t\t\tcase 'edit_employee':\n\t\t\t\tthis.setDefaultMenuEditEmployeeIcon( context_btn, grid_selected_length, 'user' );\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsetCustomEditMenuIcon( id, context_btn ) {\n\t\tswitch ( id ) {\n\t\t\tcase 'send':\n\t\t\t\tthis.setEditMenuSaveIcon( context_btn );\n\t\t\t\tbreak;\n\t\t\tcase 'timesheet':\n\t\t\t\tthis.setEditMenuNavViewIcon( context_btn, 'punch' );\n\t\t\t\tbreak;\n\t\t\tcase 'schedule':\n\t\t\t\tthis.setEditMenuNavViewIcon( context_btn, 'schedule' );\n\t\t\t\tbreak;\n\t\t\tcase 'edit_employee':\n\t\t\t\tthis.setEditMenuNavEditIcon( context_btn, 'user' );\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsetDefaultMenuCancelIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.sub_view_mode && !this.is_viewing ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetDefaultMenuExportIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( this.edit_only_mode || this.is_viewing || this.is_edit || this.is_add ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t} else if ( grid_selected_length == 0 || this.grid == undefined ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuAddIcon( context_btn, pId ) {\n\t\tsuper.setEditMenuAddIcon( context_btn, pId );\n\n\t\tif ( this.is_edit || this.is_add ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuDeleteAndNextIcon( context_btn, pId ) {\n\t\tif ( this.is_edit || this.is_add ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuNavViewIcon( context_btn, pId ) {\n\t\tif ( this.is_edit || this.is_add ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetEditMenuDeleteIcon( context_btn, pId ) {\n\t\tif ( this.is_edit || this.is_add ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tonTypeChanged( arg ) {\n\t\tif ( this.current_edit_record && Global.getProductEdition() >= 15 && PermissionManager.validate( 'request', 'add_advanced' ) && ( this.current_edit_record.type_id == 30 || this.current_edit_record.type_id == 40 ) ) { //schedule adjustment || absence selected\n\n\t\t\tif ( this.edit_view_ui_dic.date_stamp ) {\n\t\t\t\tthis.edit_view_ui_dic.date_stamp.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t}\n\t\t\tif ( this.current_edit_record.date_stamp != undefined && this.current_edit_record.start_date == '' ) {\n\t\t\t\tthis.edit_view_ui_dic.start_date.setValue( this.current_edit_record.date_stamp );\n\t\t\t\tthis.current_edit_record.start_date = this.current_edit_record.date_stamp;\n\t\t\t}\n\t\t\tif ( this.current_edit_record.date_stamp != undefined && this.current_edit_record.end_date == '' ) {\n\t\t\t\tthis.edit_view_ui_dic.end_date.setValue( this.current_edit_record.date_stamp );\n\t\t\t\tthis.current_edit_record.end_date = this.current_edit_record.date_stamp;\n\t\t\t}\n\t\t\tthis.showAdvancedFields( false ); //Don't update schedule total time as it will be done lower down in setRequestFormDefaultData();\n\n\t\t\tif ( this.edit_view_ui_dic.type_id.getValue() == 30 ) {\n\t\t\t\tthis.edit_view_ui_dic.request_schedule_status_id.setValue( 20 );\n\t\t\t} else if ( this.edit_view_ui_dic.type_id.getValue() == 40 ) {\n\t\t\t\tthis.edit_view_ui_dic.request_schedule_status_id.setValue( 10 );\n\t\t\t}\n\n\t\t\tif ( arg ) {\n\t\t\t\targ.request_schedule_status_id = this.edit_view_ui_dic.request_schedule_status_id.getValue(); //arg is passed on setRequestFormDefaultData() below, so make sure it matches the UI here.\n\t\t\t}\n\n\t\t\tthis.onWorkingStatusChanged();\n\n\t\t\tvar $this = this;\n\t\t\tthis.setRequestFormDefaultData( arg, function() {\n\t\t\t\t$this.getAvailableBalance();\n\t\t\t\t$this.setCurrentEditRecordData( $this.current_edit_record );\n\t\t\t\t$this.getScheduleTotalTime();\n\t\t\t} );\n\t\t} else {\n\n\t\t\tthis.hideAdvancedFields();\n\t\t\tif ( this.edit_view_ui_dic.date_stamp ) {\n\t\t\t\tthis.edit_view_ui_dic.date_stamp.parents( '.edit-view-form-item-div' ).show();\n\t\t\t}\n\t\t\tthis.onWorkingStatusChanged();\n\t\t}\n\t}\n\n\tsetRequestFormDefaultData( data, callback_function ) {\n\t\tif ( Global.getProductEdition() >= 15 && PermissionManager.validate( 'request', 'add_advanced' ) && ( this.current_edit_record.type_id == 30 || this.current_edit_record.type_id == 40 ) ) {\n\t\t\tif ( data == undefined ) {\n\t\t\t\tvar $this = this;\n\t\t\t\tthis.enable_validation = false;\n\t\t\t\tthis.setUIWidgetFieldsToCurrentEditRecord();\n\t\t\t\tvar filter = this.uniformVariable( this.buildDataForAPI( this.current_edit_record ) );\n\n\t\t\t\tthis.api_request_schedule.getRequestScheduleDefaultData( filter, {\n\t\t\t\t\tonResult: function( res ) {\n\n\t\t\t\t\t\tdata = res.getResult();\n\t\t\t\t\t\tdata.request_schedule_status_id = data.status_id;\n\t\t\t\t\t\tdata.date_stamp = data.start_date;\n\n\t\t\t\t\t\t//force = true is required to set the current_edit_record and populate edit_view_ui_dic\n\t\t\t\t\t\t$this.setDefaultData( data, true );\n\t\t\t\t\t\tif ( callback_function ) {\n\t\t\t\t\t\t\tcallback_function();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tdata.date_stamp = data.start_date;\n\t\t\t\tdata = this.buildDataFromAPI( data );\n\t\t\t\t//force = true is required to set the current_edit_record and populate edit_view_ui_dic\n\t\t\t\tthis.setDefaultData( data, true );\n\t\t\t\tif ( callback_function ) {\n\t\t\t\t\tcallback_function();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonAvailableBalanceChange() {\n\t\tif ( Global.getProductEdition() >= 15 && PermissionManager.validate( 'request', 'add_advanced' ) ) {\n\t\t\tif ( this.edit_view_ui_dic && this.edit_view_ui_dic.absence_policy_id && this.edit_view_ui_dic.request_schedule_status_id.getValue() == 20 && this.edit_view_ui_dic.absence_policy_id.getValue() != TTUUID.zero_id ) {\n\t\t\t\tthis.getAvailableBalance();\n\t\t\t} else if ( this.edit_view_ui_dic && this.edit_view_ui_dic.available_balance ) {\n\t\t\t\tthis.edit_view_ui_dic.available_balance.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t}\n\t\t}\n\t}\n\n\t//post hook for onSaveResult\n\tonSaveDone( result ) {\n\t\tvar retval;\n\t\tif ( this.is_edit ) {\n\t\t\tthis.onViewClick( this.current_edit_record.id );\n\t\t\tretval = false;\n\t\t} else {\n\t\t\tretval = true;\n\t\t}\n\t\t$().TFeedback( {\n\t\t\tsource: 'Send'\n\t\t} );\n\t\t//If request was added from the TimeSheet view, refresh the TimeSheet.\n\t\tif ( LocalCacheData.current_open_primary_controller && LocalCacheData.current_open_primary_controller.viewId === 'TimeSheet' ) {\n\t\t\tLocalCacheData.current_open_primary_controller.search();\n\t\t}\n\t\treturn retval;\n\t}\n\n\tuniformVariable( records ) {\n\t\tif ( typeof records === 'object' ) {\n\t\t\trecords.user_id = LocalCacheData.loginUser.id;\n\t\t\trecords.first_name = LocalCacheData.loginUser.first_name;\n\t\t\trecords.last_name = LocalCacheData.loginUser.last_name;\n\t\t}\n\n\t\tif ( this.is_add ) {\n\t\t\trecords = this.buildDataForAPI( records );\n\t\t} else if ( this.is_edit ) {\n\t\t\tvar msg = this.uniformMessageVariable( records );\n\n\t\t\tif ( records && records.request_schedule ) {\n\t\t\t\tmsg.request_schedule = records.request_schedule;\n\t\t\t}\n\n\t\t\treturn msg;\n\t\t}\n\n\t\treturn records;\n\t}\n\n\tonSaveClick( ignoreWarning ) {\n\t\tvar $this = this;\n\t\tLocalCacheData.current_doing_context_action = 'save';\n\t\tif ( !Global.isSet( ignoreWarning ) ) {\n\t\t\tignoreWarning = false;\n\t\t}\n\n\t\tfor ( var key in $this.current_edit_record ) {\n\t\t\tif ( $this.edit_view_ui_dic[key] != undefined ) {\n\t\t\t\t$this.current_edit_record[key] = $this.edit_view_ui_dic[key].getValue();\n\t\t\t}\n\t\t}\n\n\t\tif ( this.is_add ) {\n\t\t\t// //format data as expected by API\n\t\t\trecord = this.uniformVariable( $this.current_edit_record );\n\n\t\t\tthis.api['set' + this.api.key_name]( record, false, ignoreWarning, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t$this.onSaveResult( result );\n\t\t\t\t}\n\t\t\t} );\n\t\t} else if ( this.is_edit ) {\n\t\t\tvar record = {};\n\t\t\tthis.is_add = false;\n\t\t\tthis.setCurrentEditRecordData();\n\t\t\trecord = this.uniformVariable( this.current_edit_record );\n\t\t\tEmbeddedMessage.reply( [record], ignoreWarning, function( result ) {\n\t\t\t\t\tif ( result && result.isValid() ) {\n\t\t\t\t\t\tvar id = $this.current_edit_record.id;\n\t\t\t\t\t\t//see #2224 - Unable to get property 'find' of undefined\n\t\t\t\t\t\t$this.removeEditView();\n\t\t\t\t\t\t$this.onViewClick( id );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.setErrorTips( result );\n\t\t\t\t\t\t$this.setErrorMenu();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tsearch( set_default_menu, page_action, page_number, callBack ) {\n\t\tthis.refresh_id = null;\n\t\tsuper.search( set_default_menu, page_action, page_number, callBack );\n\t}\n\n\tsetEditMenuEditIcon( context_btn ) {\n\t\tif ( !this.editPermissionValidate( 'request' ) || this.edit_only_mode || this.is_mass_editing ) {\n\t\t\t//Not shown in edit only mode or mass edit. Mass edit should only show mass edit (need to set that part in mass edit icon).\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\n\t\tif ( !this.is_viewing || !this.editOwnerOrChildPermissionValidate( 'request' ) ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetDefaultMenuEditIcon( context_btn, grid_selected_length ) {\n\t\tif ( !this.editPermissionValidate( 'request' ) || this.edit_only_mode || ( !this.is_edit || !this.is_viewing ) ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t}\n\n\tsetDefaultMenuScheduleIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !PermissionManager.checkTopLevelPermission( 'Schedule' ) || this.edit_only_mode ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tif ( grid_selected_length === 1 ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, true );\n\t\t} else {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tsetDefaultMenuSendIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.addPermissionValidate( pId ) || this.edit_only_mode || ( !this.is_edit || !this.is_viewing ) ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t}\n\n\tsetDefaultMenuEditEmployeeIcon( context_btn, grid_selected_length ) {\n\t\tif ( !this.editChildPermissionValidate( 'user' ) ) {\n\t\t\tContextMenuManager.hideMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false )\n\t\t}\n\n\t\tif ( grid_selected_length === 1 ) {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, true );\n\t\t} else {\n\t\t\tContextMenuManager.disableMenuItem( this.determineContextMenuMountAttributes().id, context_btn.id, false );\n\t\t}\n\t}\n\n\tonCustomContextClick( id ) {\n\t\tswitch ( id ) {\n\t\t\tcase 'timesheet':\n\t\t\tcase 'schedule':\n\t\t\tcase 'edit_employee':\n\t\t\t\tthis.onNavigationClick( id );\n\t\t\t\tbreak;\n\t\t\tcase 'send':\n\t\t\t\tthis.onSaveClick();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsetEditViewWidgetsMode() {\n\t\tvar did_clean = false;\n\t\tfor ( var key in this.edit_view_ui_dic ) {\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\twidget.css( 'opacity', 1 );\n\t\t\tvar column = widget.parent().parent().parent();\n\t\t\tif ( !column.hasClass( 'v-box' ) ) {\n\t\t\t\tif ( !did_clean ) {\n\t\t\t\t\tdid_clean = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( this.is_viewing ) {\n\t\t\t\tif ( Global.isSet( widget.setEnabled ) ) {\n\t\t\t\t\twidget.setEnabled( false );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif ( Global.isSet( widget.setEnabled ) ) {\n\t\t\t\t\twidget.setEnabled( true );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonFormItemChange( target, doNotValidate ) {\n\t\tvar $this = this;\n\t\tthis.collectUIDataToCurrentEditRecord();\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\t\tvar key = target.getField();\n\t\tvar c_value = target.getValue();\n\t\tthis.current_edit_record[key] = c_value;\n\t\tvar needs_callback = false;\n\n\t\tswitch ( key ) {\n\t\t\tcase 'job_id':\n\t\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tthis.edit_view_ui_dic['job_quick_search'].setValue( target.getValue( true ) ? ( target.getValue( true ).manual_id ? target.getValue( true ).manual_id : '' ) : '' );\n\t\t\t\t\tthis.setJobItemValueWhenJobChanged( target.getValue( true ), 'job_item_id' );\n\t\t\t\t\tthis.edit_view_ui_dic['job_quick_search'].setCheckBox( true );\n\t\t\t\t\tthis.setPunchTagValuesWhenCriteriaChanged( this.getPunchTagFilterData(), 'punch_tag_id' );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'job_item_id':\n\t\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tthis.edit_view_ui_dic['job_item_quick_search'].setValue( target.getValue( true ) ? ( target.getValue( true ).manual_id ? target.getValue( true ).manual_id : '' ) : '' );\n\t\t\t\t\tthis.edit_view_ui_dic['job_item_quick_search'].setCheckBox( true );\n\t\t\t\t\tthis.setPunchTagValuesWhenCriteriaChanged( this.getPunchTagFilterData(), 'punch_tag_id' );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'punch_tag_id':\n\t\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tif ( c_value !== TTUUID.zero_id && c_value !== false && c_value.length > 0 ) {\n\t\t\t\t\t\tthis.setPunchTagQuickSearchManualIds( target.getSelectItems() );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.edit_view_ui_dic['punch_tag_quick_search'].setValue( '' );\n\t\t\t\t\t}\n\t\t\t\t\t$this.previous_punch_tag_selection = c_value;\n\t\t\t\t\t//Reset source data to make sure correct punch tags are always shown.\n\t\t\t\t\tthis.edit_view_ui_dic['punch_tag_id'].setSourceData( null );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'user_id':\n\t\t\tcase 'branch_id':\n\t\t\tcase 'department_id':\n\t\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tthis.setPunchTagValuesWhenCriteriaChanged( this.getPunchTagFilterData(), 'punch_tag_id' );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'job_quick_search':\n\t\t\tcase 'job_item_quick_search':\n\t\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tthis.onJobQuickSearch( key, c_value, 'job_id', 'job_item_id' );\n\t\t\t\t\tTTPromise.wait( 'BaseViewController', 'onJobQuickSearch', function() {\n\t\t\t\t\t\t$this.setPunchTagValuesWhenCriteriaChanged( $this.getPunchTagFilterData(), 'punch_tag_id' );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'punch_tag_quick_search':\n\t\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tthis.onPunchTagQuickSearch( c_value, this.getPunchTagFilterData(), 'punch_tag_id' );\n\n\t\t\t\t\t//Don't validate immediately as onJobQuickSearch is doing async API calls, and it would cause a guaranteed validation failure.\n\t\t\t\t\tdoNotValidate = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'type_id':\n\t\t\t\t// Set absence_policy_id to zero id to prevent available balance field showing when switching to a none absence request type.\n\t\t\t\t// Also prevents available balance sometimes showing the wrong value due to mismatch in select menu and current_edit_record.\n\t\t\t\tif ( this.edit_view_ui_dic.absence_policy_id && ( this.current_edit_record.type_id === 30 || this.current_edit_record.type_id === 40 ) ) {\n\t\t\t\t\tthis.edit_view_ui_dic.absence_policy_id.setValue( TTUUID.zero_id );\n\t\t\t\t\tthis.current_edit_record.absence_policy_id = TTUUID.zero_id;\n\t\t\t\t}\n\t\t\t\tdoNotValidate = true;\n\t\t\t\tthis.onTypeChanged();\n\t\t\t\tbreak;\n\t\t\tcase 'overlap_type_id':\n\t\t\t\tif ( ( Global.getProductEdition() >= 15 ) ) {\n\t\t\t\t\tthis.getOverlappingShifts();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'date_stamp':\n\t\t\t\tthis.onDateStampChanged();\n\t\t\t\tbreak;\n\t\t\tcase 'request_schedule_status_id':\n\t\t\t\tthis.onWorkingStatusChanged();\n\t\t\t\tbreak;\n\t\t\tcase 'start_date':\n\t\t\t\tthis.current_edit_record.start_date = this.edit_view_ui_dic.start_date.getValue();\n\t\t\t\tthis.current_edit_record.date_stamp = this.edit_view_ui_dic.start_date.getValue();\n\t\t\t\tthis.onStartDateChanged();\n\t\t\t\tthis.setRequestFormDefaultData( null, function() {\n\t\t\t\t\tfinishFormItemChange();\n\t\t\t\t\tif ( ( Global.getProductEdition() >= 15 ) ) {\n\t\t\t\t\t\t$this.getOverlappingShifts();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\tneeds_callback = true;\n\t\t\t\tbreak;\n\t\t\tcase 'end_date':\n\t\t\t\tthis.current_edit_record.end_date = this.edit_view_ui_dic.end_date.getValue();\n\t\t\t\tthis.setRequestFormDefaultData( null, function() {\n\t\t\t\t\tfinishFormItemChange();\n\t\t\t\t\tif ( ( Global.getProductEdition() >= 15 ) ) {\n\t\t\t\t\t\t$this.getOverlappingShifts();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\tneeds_callback = true;\n\t\t\t\tbreak;\n\t\t\tcase 'start_time':\n\t\t\tcase 'end_time':\n\t\t\t\tif ( ( Global.getProductEdition() >= 15 ) ) {\n\t\t\t\t\tthis.getOverlappingShifts();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'sun':\n\t\t\tcase 'mon':\n\t\t\tcase 'tue':\n\t\t\tcase 'wed':\n\t\t\tcase 'thu':\n\t\t\tcase 'fri':\n\t\t\tcase 'sat':\n\t\t\t\tthis.getScheduleTotalTime();\n\t\t\t\tif ( ( Global.getProductEdition() >= 15 ) ) {\n\t\t\t\t\tthis.getOverlappingShifts();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'schedule_policy_id':\n\t\t\t\tif ( ( Global.getProductEdition() >= 15 ) ) {\n\t\t\t\t\t$this.getOverlappingShifts();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase'absence_policy_id':\n\t\t\t\tthis.selected_absence_policy_record = this.edit_view_ui_dic.absence_policy_id.getValue();\n\t\t\t\tbreak;\n\t\t\tcase 'is_replace_with_open_shift':\n\t\t\t\tif ( ( Global.getProductEdition() >= 15 ) ) {\n\t\t\t\t\tthis.getOverlappingShifts();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif ( !needs_callback ) {\n\t\t\tfinishFormItemChange();\n\t\t}\n\n\t\tfunction finishFormItemChange() {\n\t\t\tif ( key === 'date_stamp' ||\n\t\t\t\tkey === 'start_date_stamps' ||\n\t\t\t\tkey === 'start_date' ||\n\t\t\t\tkey === 'end_date' ||\n\t\t\t\tkey === 'start_date_stamp' ||\n\t\t\t\tkey === 'start_time' ||\n\t\t\t\tkey === 'end_time' ||\n\t\t\t\tkey === 'schedule_policy_id' ||\n\t\t\t\tkey === 'absence_policy_id' ) {\n\n\t\t\t\tif ( $this.current_edit_record['date_stamp'] !== '' &&\n\t\t\t\t\t$this.current_edit_record['start_time'] !== '' &&\n\t\t\t\t\t$this.current_edit_record['end_time'] !== '' ) {\n\n\t\t\t\t\t$this.getScheduleTotalTime();\n\t\t\t\t} else {\n\t\t\t\t\t$this.onAvailableBalanceChange();\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( !doNotValidate ) {\n\t\t\t\t$this.validate();\n\t\t\t}\n\t\t\t$this.setEditMenu();\n\t\t}\n\t}\n\n\tvalidate() {\n\t\tvar $this = this;\n\t\tvar record = this.current_edit_record;\n\t\trecord = this.uniformVariable( record );\n\t\tvar api = this.message_control_api;\n\t\tif ( this.is_add ) {\n\t\t\trecord = this.buildDataForAPI( record );\n\t\t\tapi = this.api;\n\t\t}\n\n\t\tapi['validate' + api.key_name]( record, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.validateResult( result );\n\t\t\t}\n\t\t} );\n\t}\n\n\tonAddClick( data ) {\n\t\tTTPromise.add( 'Request', 'add' );\n\t\tTTPromise.wait();\n\t\tvar $this = this;\n\t\tif ( this.edit_view ) {\n\t\t\tthis.removeEditView();\n\t\t}\n\t\tthis.setCurrentEditViewState( 'new' );\n\t\tthis.openEditView();\n\t\tthis.buildAddViewUI();\n\t\t//Error: Uncaught TypeError: undefined is not a function in /interface/html5/views/BaseViewController.js?v=8.0.0-20141117-111140 line 897\n\t\tif ( $this.api && typeof $this.api['get' + $this.api.key_name + 'DefaultData'] === 'function' ) {\n\t\t\t$this.api['get' + $this.api.key_name + 'DefaultData']( {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\tif ( data ) {\n\t\t\t\t\t\t//data passed should overwrite the default data from the API.\n\t\t\t\t\t\tresult = $.extend( {}, result.getResult(), data );\n\t\t\t\t\t}\n\t\t\t\t\t$this.onAddResult( result );\n\t\t\t\t\t$this.onDateStampChanged();\n\t\t\t\t\tif ( result.type_id ) {\n\t\t\t\t\t\t$this.onTypeChanged( result );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.getScheduleTotalTime(); //This is called as part of onTypeChanged(), so it doesn't need to be done twice.\n\t\t\t\t\t}\n\n\t\t\t\t\tTTPromise.resolve( 'Request', 'add' );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\t//To be called only by external scripts creating requests (timesheet and schedule at this time)\n\topenAddView( data_array ) {\n\t\tthis.sub_view_mode = true;\n\t\tthis.edit_only_mode = true;\n\t\tvar $this = this;\n\t\tthis.initOptions( function() {\n\t\t\t$this.onAddClick( data_array );\n\t\t} );\n\t}\n}"],"names":["RequestViewController","options","_","$","callBack","result","tab_model","tab_audit_label","tab_request","tab_request_column1","tab_request_column2","form_item_input","$this","widgetContainer","label","form_item_sun_checkbox","form_item_mon_checkbox","form_item_tue_checkbox","form_item_wed_checkbox","form_item_thu_checkbox","form_item_fri_checkbox","form_item_sat_checkbox","sun","mon","tue","wed","thu","fri","sat","val","job_coder","job_item_coder","punch_tags","punch_tag_coder","context_menu_model","current_edit_record","key","widget","punch_tag_widget","args","dow","one_selected","i","id","context_btn","grid_selected_length","pId","arg","data","callback_function","filter","res","retval","records","msg","ignoreWarning","record","set_default_menu","page_action","page_number","column","target","doNotValidate","c_value","needs_callback","finishFormItemChange","api","data_array"],"mappings":"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"}