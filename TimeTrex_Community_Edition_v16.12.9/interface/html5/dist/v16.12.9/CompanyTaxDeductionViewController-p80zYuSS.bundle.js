import{_ as T,j as n}from"./vendor-tTApdY0Y.bundle.js";import{G as _}from"./main_ui-z76rxVqJ.entry.bundle.js";class S extends BaseViewController{constructor(t={}){T.defaults(t,{el:"#company_tax_deduction_view_container",type_array:null,status_array:null,tax_formula_type_array:null,calculation_array:null,account_amount_type_array:null,yes_no_array:null,filter_data_type_array:null,apply_frequency_array:null,apply_payroll_run_type_array:null,length_of_service_unit_array:null,month_of_year_array:null,day_of_month_array:null,month_of_quarter_array:null,country_array:null,province_array:null,e_province_array:null,company_api:null,date_api:null,user_deduction_api:null,user_api:null,payroll_remittance_agency_api:null,employee_setting_grid:null,employee_setting_result:null,show_c:!1,show_p:!1,show_dc:!1,province_district_array:null,original_current_record:null,length_dates:null,start_dates:null,end_dates:null,grid_parent:".grid-div"}),super(t)}init(t){this.edit_view_tpl="CompanyTaxDeductionEditView.html",this.sub_view_mode?this.permission_id="user_tax_deduction":this.permission_id="company_tax_deduction",this.viewId="CompanyTaxDeduction",this.script_name="CompanyTaxDeductionView",this.table_name_key="company_deduction",this.context_menu_name=n.i18n._("Taxes & Deductions"),this.navigation_label=n.i18n._("Taxes & Deductions"),this.api=TTAPI.APICompanyDeduction,this.date_api=TTAPI.APITTDate,this.company_api=TTAPI.APICompany,this.user_deduction_api=TTAPI.APIUserDeduction,this.user_api=TTAPI.APIUser,this.payroll_remittance_agency_api=TTAPI.APIPayrollRemittanceAgency,this.month_of_quarter_array=_.buildRecordArray({1:1,2:2,3:3}),this.document_object_type_id=300,this.render(),_.getProductEdition()>=15&&_.loadScript("global/widgets/formula_builder/FormulaBuilder.js"),this.sub_view_mode?this.buildContextMenu(!0):this.buildContextMenu(),this.sub_view_mode||this.initData()}getCustomContextMenuModel(){var t={exclude:[],include:[]};return this.sub_view_mode&&t.exclude.push("view","save_and_new","save_and_copy","copy_as_new","copy"),t}initOptions(){var t=this,a=[{option_name:"type",api:this.api},{option_name:"status",api:this.api},{option_name:"calculation",api:this.api},{option_name:"filter_date_type",api:this.api},{option_name:"apply_frequency",api:this.api},{option_name:"apply_payroll_run_type",api:this.api},{option_name:"account_amount_type",api:this.api},{option_name:"length_of_service_unit",api:this.api},{option_name:"look_back_unit",api:this.api},{option_name:"country",field_name:"country",api:this.company_api},{option_name:"apply_payroll_run_type",api:this.api},{option_name:"yes_no",api:this.api},{option_name:"tax_formula_type",api:this.api}];this.initDropDownOptions(a),this.company_api.getOptions("district",{onResult:function(i){i=i.getResult(),t.district_array=i}}),this.date_api.getMonthOfYearArray(!1,{onResult:function(i){i=i.getResult(),t.month_of_year_array=_.buildRecordArray(i)}}),this.date_api.getDayOfMonthArray({onResult:function(i){i=i.getResult(),t.day_of_month_array=_.buildRecordArray(i)}})}setSelectLayout(){this.sub_view_mode?super.setSelectLayout(["legal_entity_legal_name","total_users"]):super.setSelectLayout()}setEditMenuSaveAndContinueIcon(t,a){this.saveAndContinueValidate(t,a),(this.is_mass_editing||this.is_viewing||this.sub_view_mode&&(!this.current_edit_record||!this.current_edit_record.id))&&ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,t.id,!1)}setEditMenuAddIcon(t,a){(!this.addPermissionValidate(a)||this.edit_only_mode)&&ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,t.id,!1),ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,t.id,!1)}disableIconOnEmployeeSettingsTab(t){this.getEditViewActiveTabName()==="tab_employee_setting"&&ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,t.id,!1)}setEditMenuDeleteIcon(t){this.disableIconOnEmployeeSettingsTab(t)}setEditMenuDeleteAndNextIcon(t){this.disableIconOnEmployeeSettingsTab(t)}setEditMenuCopyIcon(t){this.disableIconOnEmployeeSettingsTab(t)}setEditMenuCopyAndAddIcon(t){this.disableIconOnEmployeeSettingsTab(t)}setEditMenuSaveAndCopyIcon(t){this.disableIconOnEmployeeSettingsTab(t)}enableIconOnEmployeeSettingsTab(t){this.getEditViewActiveTabName()==="tab_employee_setting"&&(ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,t.id,!0),ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,t.id,!0))}setEditMenuExportIcon(t){this.enableIconOnEmployeeSettingsTab(t)}onExportClick(){this.is_edit==!0&&this.getEditViewActiveTabName()==="tab_employee_setting"?this.employee_setting_grid.grid2csv("export_user_deduction"):super.onExportClick("export"+this.api.key_name)}saveInsideEditorData(t){if(!this.current_edit_record||!this.current_edit_record.id){_.isSet(t)&&t();return}if(this.employee_setting_grid){for(var a=this.employee_setting_grid.getGridParam("data"),i=this.employee_setting_grid.getGridParam("colModel"),d=0;d<a.length;d++){var e=a[d];this.start_dates&&this.start_dates.length>0&&(e.start_date=this.start_dates[d].getValue()),this.length_dates&&this.length_dates.length>0&&(e.length_of_service_date=this.length_dates[d].getValue()),this.end_dates&&this.end_dates.length>0&&(e.end_date=this.end_dates[d].getValue());for(var r=1;r<i.length;r++){var l=i[r];e[l.name]===this.original_current_record[l.name]&&(e[l.name]=!1)}}if(a&&a.length>0){let s=this.getChangedRecords(a,this.employee_setting_result,[]);Array.isArray(s)&&s.length>0?this.user_deduction_api.setUserDeduction(s,{onResult:function(){_.isSet(t)&&t()}}):_.isSet(t)&&t()}else _.isSet(t)&&t()}}onContextMenuClick(t,a){return this.select_grid_last_row&&(this.employee_setting_grid.grid.jqGrid("saveRow",this.select_grid_last_row),this.setDateCellsEnabled(!1,this.select_grid_last_row),this.select_grid_last_row=null),super.onContextMenuClick(t,a)}getDeleteSelectedRecordId(){var l;if(this.sub_view_mode){var t=[];if(this.edit_view)t.push((l=this.employee_setting_result[0])==null?void 0:l.id);else{var a={filter_data:{}},i=this.getGridSelectIdArray().slice();a.filter_data.company_deduction_id=i,a.filter_data.user_id=this.parent_value;for(var d=this.user_deduction_api.getUserDeduction(a,!0,{async:!1}).getResult(),e=0;e<d.length;e++){var r=d[e];t.push(r.id)}}return t}else return super.getDeleteSelectedRecordId()}doDeleteAPICall(t,a){return this.sub_view_mode?(a||(a={onResult:(function(i){this.onDeleteResult(i,t)}).bind(this)}),this.user_deduction_api.deleteUserDeduction(t,a)):super.doDeleteAPICall(t,a)}onSaveClick(t,a=!1){var i=this,d;if(_.isSet(t)||(t=!1),this.employee_setting_grid){var e=this.employee_setting_grid.getGridParam("data");if(e&&e.length>0){let l=this.getChangedRecords(e,this.employee_setting_result,[]);Array.isArray(l)&&l.length>0&&(i.is_changed=!0)}}!a&&i.is_changed==!1&&(!LocalCacheData.current_open_primary_controller||LocalCacheData.current_open_primary_controller.edit_view&&LocalCacheData.current_open_primary_controller.is_changed==!1)&&(!LocalCacheData.current_open_report_controller||LocalCacheData.current_open_report_controller.is_changed==!1)&&(!LocalCacheData.current_open_edit_only_controller||LocalCacheData.current_open_edit_only_controller.is_changed==!1)&&(!LocalCacheData.current_open_sub_controller||LocalCacheData.current_open_sub_controller.edit_view&&LocalCacheData.current_open_sub_controller.is_changed==!1)?this.confirm_on_exit=!0:this.confirm_on_exit=!1,LocalCacheData.current_doing_context_action="save",this.confirm_on_exit==!0?TAlertManager.showConfirmAlert(_.not_modify_alert_message,null,function(l){l===!0&&r()}):r();function r(){if(i.is_mass_editing){var l=i.getChangedFields();d=i.buildMassEditSaveRecord(i.mass_edit_record_ids,l)}else d=i.current_edit_record;d=i.uniformVariable(d),i.sub_view_mode?i.current_edit_record.id?i.saveInsideEditorData(function(){i.refresh_id=i.current_edit_record.id,i.search(),i.removeEditView()}):i.user_deduction_api.setUserDeduction(d,!1,t,{onResult:function(s){i.onSaveResult(s)}}):i.api["set"+i.api.key_name](d,!1,t,{onResult:function(s){i.onSaveResult(s)}})}this.confirm_on_exit=!this.confirm_on_exit}onSaveAndContinue(t){var a=this;_.isSet(t)||(t=!1),this.is_changed=!1,this.is_add=!1,LocalCacheData.current_doing_context_action="save_and_continue";var i=this.current_edit_record;i=this.uniformVariable(i),this.sub_view_mode?a.saveInsideEditorData(function(){a.refresh_id=a.current_edit_record.id,a.search(!1),a.onEditClick(a.refresh_id,!0)}):this.api["set"+this.api.key_name](i,!1,t,{onResult:function(d){a.onSaveAndContinueResult(d)}})}onSaveAndNextClick(t){var a=this;_.isSet(t)||(t=!1),this.is_add=!1,this.is_changed=!1;var i=this.current_edit_record;LocalCacheData.current_doing_context_action="save_and_next",i=this.uniformVariable(i),this.sub_view_mode?a.saveInsideEditorData(function(){a.refresh_id=a.current_edit_record.id,a.onRightArrowClick(),a.search(!1)}):this.api["set"+this.api.key_name](i,!1,t,{onResult:function(d){a.onSaveAndNextResult(d)}})}validate(){var t=this,a={};if(this.is_mass_editing){for(var i in this.edit_view_ui_dic)if(this.edit_view_ui_dic.hasOwnProperty(i)){var d=this.edit_view_ui_dic[i];_.isSet(d.isChecked)&&d.isChecked()&&d.getEnabled()&&(a[i]=d.getValue())}}else a=this.current_edit_record;a=this.uniformVariable(a),this.sub_view_mode?this.user_deduction_api.validateUserDeduction(a,{onResult:function(e){t.validateResult(e)}}):this.api["validate"+this.api.key_name](a,{onResult:function(e){t.validateResult(e)}})}uniformVariable(t){if(this.sub_view_mode&&(!this.current_edit_record||!this.current_edit_record.id)){t=[];for(var a=this.edit_view_ui_dic.company_tax_deduction_ids.getValue(),i=0;i<a.length;i++){var d={};d.user_id=this.parent_value,d.company_deduction_id=a[i].id,t.push(d)}}return t}onSaveResult(t){var a=this;if(t&&t.isValid()){var i=t.getResult();this.sub_view_mode?(a.refresh_id=null,a.search(),a.onSaveDone(t),a.removeEditView()):(i===!0?a.refresh_id=a.current_edit_record.id:TTUUID.isUUID(i)&&i!=TTUUID.zero_id&&i!=TTUUID.not_exist_id&&(a.refresh_id=i),a.saveInsideEditorData(function(){a.search(),a.onSaveDone(t),a.removeEditView()}))}else a.setErrorMenu(),a.setErrorTips(t)}onSaveDone(t){_.clearCache("getOptions_columns"),super.onSaveDone(t)}onSaveAndCopyResult(t){var a=this;if(t&&t.isValid()){var i=t.getResult();i===!0?a.refresh_id=a.current_edit_record.id:TTUUID.isUUID(i)&&i!=TTUUID.zero_id&&i!=TTUUID.not_exist_id&&(a.refresh_id=i),a.saveInsideEditorData(function(){a.search(!1),a.onCopyAsNewClick()})}else a.setErrorTips(t),a.setErrorMenu()}_continueDoCopyAsNew(){this.setCurrentEditViewState("new"),LocalCacheData.current_doing_context_action="copy_as_new",_.isSet(this.edit_view)&&(this.employee_setting_grid&&this.employee_setting_grid.clearGridData(),this.edit_view_ui_dic.calculation_id.setEnabled(!0)),super._continueDoCopyAsNew()}clearEditViewData(){for(var t in this.edit_view_ui_dic)this.edit_view_ui_dic.hasOwnProperty(t)&&(this.edit_view_ui_dic[t].setValue(null),this.edit_view_ui_dic[t].clearErrorStyle());this.employee_setting_grid&&this.employee_setting_grid.clearGridData()}checkTabPermissions(t){var a=!1;switch(t){case"tab_attachment":this.subDocumentValidate()?a=!this.sub_view_mode:a=!1;break;case"tab_tax_deductions":case"tab_eligibility":case"tab_employee_setting":case"tab_audit":this.sub_view_mode?t=="tab_employee_setting"&&this.current_edit_record.id?a=!0:a=!1:a=!0;break;case"tab5":this.sub_view_mode&&(t=="tab5"&&this.current_edit_record.id?a=!1:a=!0);break;default:a=super.checkTabPermissions(t);break}return a}setProvince(t,a){var i=this;!t||t==="-1"||t==="0"?i.province_array=[]:this.company_api.getOptions("province",t,{onResult:function(d){d=d.getResult(),d||(d=[]),i.province_array=_.buildRecordArray(d)}})}eSetProvince(t,a){var i=this,d=i.edit_view_ui_dic.province;!t||t==="-1"||t==="0"?(i.e_province_array=[],d.setSourceData([])):this.company_api.getOptions("province",t,{onResult:function(e){e=e.getResult(),e||(e=[]),i.e_province_array=_.buildRecordArray(e),d.setSourceData(i.e_province_array),i.setProvinceVisibility()}})}onFormItemChange(t,a){this.setIsChanged(t),this.setMassEditingFieldsWhenFormChange(t);var i=t.getField(),d=t.getValue();switch(this.current_edit_record[i]=d,i){case"country":var e=this.edit_view_ui_dic.province,r=this.edit_view_ui_dic.district;e.setValue(null),r.setValue(null),this.current_edit_record.province=!1,this.current_edit_record.district=!1,this.setDynamicFields(null,!0);break;case"province":r=this.edit_view_ui_dic.district,this.setDistrict(this.current_edit_record.country),r.setValue(null),this.setDynamicFields(null,!0);break;case"calculation_id":this.setDynamicFields();break;case"apply_frequency_id":this.onApplyFrequencyChange();break;case"minimum_length_of_service_unit_id":case"maximum_length_of_service_unit_id":this.onLengthOfServiceChange();break;case"start_date":case"end_date":case"minimum_length_of_service":case"maximum_length_of_service":this.resetEmployeeSettingGridColumns();break;case"legal_entity_id":this.onLegalEntityChange(),this.updateEmployeeData();break;case"user_value10":this.onFormW4VersionChange();break}if(i==="country"){this.onCountryChange();return}a||this.validate()}setCurrentEditRecordData(){var t=this;this.original_current_record=_.clone(this.current_edit_record);for(var a in this.current_edit_record)if(this.current_edit_record.hasOwnProperty(a)){var i=this.edit_view_ui_dic[a];if(_.isSet(i))switch(a){case"country":this.eSetProvince(this.current_edit_record[a]),this.setDistrict(this.current_edit_record[a]),i.setValue(this.current_edit_record[a]);break;default:i.setValue(this.current_edit_record[a]);break}}t.current_edit_record.id?t.edit_view_ui_dic.calculation_id.setEnabled(!1):t.edit_view_ui_dic.calculation_id.setEnabled(!0),this.setDynamicFields(function(){t.collectUIDataToCurrentEditRecord(),t.onLengthOfServiceChange(),t.setEditViewDataDone(),t.edit_view_ui_dic.company_tax_deduction_ids.setGridColumnsWidths(),t.onLegalEntityChange(),t.is_mass_editing&&t.hideFieldsForMassEdit()}),this.sub_view_mode&&(!this.current_edit_record||!this.current_edit_record.id)&&this.initCompanyTaxDeductionData()}onLegalEntityChange(){var t=this.edit_view_ui_dic.payroll_remittance_agency_id.getValue(),a={};a.filter_data={legal_entity_id:this.edit_view_ui_dic.legal_entity_id.getValue()},a.filter_columns=this.edit_view_ui_dic.payroll_remittance_agency_id.getColumnFilter();var i=this;this.edit_view_ui_dic.legal_entity_id.getValue()!=TTUUID.zero_id?this.payroll_remittance_agency_api.getPayrollRemittanceAgency(a,{onResult:function(d){var e=d.getResult();if(i.edit_view_ui_dic.payroll_remittance_agency_id){if(e.length>0){i.edit_view_ui_dic.payroll_remittance_agency_id.setSourceData(e);var r=!1;for(var l in e)if(e[l].id==t){r=!0;break}r===!1&&(t=TTUUID.zero_id),i.current_edit_record.payroll_remittance_agency_id=t,i.edit_view_ui_dic.payroll_remittance_agency_id.setValue(t)}else i.edit_view_ui_dic.payroll_remittance_agency_id.setValue(TTUUID.zero_id);i.edit_view_ui_dic.payroll_remittance_agency_id.setEnabled(!0)}}}):(t=TTUUID.zero_id,i.edit_view_ui_dic.payroll_remittance_agency_id.setSourceData([TTUUID.zero_id]),i.edit_view_ui_dic.payroll_remittance_agency_id.setValue(t),i.edit_view_ui_dic.payroll_remittance_agency_id.setEnabled(!1))}updateEmployeeData(){var t={filter_data:{}};this.edit_view_ui_dic&&this.edit_view_ui_dic.legal_entity_id&&this.edit_view_ui_dic.legal_entity_id.getValue()&&this.edit_view_ui_dic.legal_entity_id.getValue()!=TTUUID.zero_id&&(t.filter_data.legal_entity_id=this.edit_view_ui_dic.legal_entity_id.getValue()),this.edit_view_ui_dic.user&&(this.edit_view_ui_dic.user.setDefaultArgs(t),this.edit_view_ui_dic.user.setSourceData(null))}onLengthOfServiceChange(){this.sub_view_mode||(this.current_edit_record.minimum_length_of_service_unit_id==50||this.current_edit_record.maximum_length_of_service_unit_id==50?this.attachElement("length_of_service_contributing_pay_code_policy_id"):this.detachElement("length_of_service_contributing_pay_code_policy_id"),this.editFieldResize())}initCompanyTaxDeductionData(){var t=this,a={filter_data:{legal_entity_id:[this.parent_edit_record.legal_entity_id,TTUUID.zero_id,TTUUID.not_exist_id],exclude_user_id:this.parent_edit_record.id},filter_columns:{id:!0,name:!0}};this.api.getCompanyDeduction(a,!0,{onResult:function(i){var d=i.getResult();t.edit_view_ui_dic.company_tax_deduction_ids.setUnselectedGridData(d)}})}setEditViewDataDone(){super.setEditViewDataDone(),this.onApplyFrequencyChange(),this.initEmployeeSetting(),this.updateEmployeeData()}setDistrict(t){var a=this,i=a.edit_view_ui_dic.district;if(a.province_district_array=[],i.setSourceData(a.province_district_array),t){var d=this.district_array[t];if(d){var e=d[a.current_edit_record.province];e&&(a.province_district_array=_.buildRecordArray(e),i.setSourceData(a.province_district_array))}}a.setDistrictVisibility()}hideFieldsForMassEdit(){this.hideAllDynamicFields(),this.detachElement("df_0"),this.detachElement("calculation_id"),this.detachElement("calculation_order"),this.detachElement("pay_stub_entry_account_id"),this.detachElement("include_account_amount_type_id"),this.detachElement("include_pay_stub_entry_account"),this.detachElement("exclude_account_amount_type_id"),this.detachElement("exclude_pay_stub_entry_account")}hideAllDynamicFields(t,a){this.edit_view&&(t||(this.show_c=!1,this.detachElement("country")),a||(this.show_p=!1,this.show_dc=!1,this.detachElement("province"),this.detachElement("district")),this.detachElement("df_0"),this.detachElement("df_1"),this.detachElement("df_2"),this.detachElement("df_3"),this.detachElement("df_4"),this.detachElement("df_5"),this.detachElement("df_6"),this.detachElement("df_7"),this.detachElement("df_8"),this.detachElement("df_9"),this.detachElement("df_10"),this.detachElement("df_11"),this.detachElement("df_12"),this.detachElement("df_14"),this.detachElement("df_15"),this.detachElement("df_20"),this.detachElement("df_21"),this.detachElement("df_22"),this.detachElement("df_23"),this.detachElement("df_24"),this.detachElement("df_25"),_.getProductEdition()>=15||this.detachElement("df_100"))}initEmployeeSetting(){var t=this;if(t.edit_view){if(!this.current_edit_record||!this.current_edit_record.id){t.employee_setting_result=[];return}this.buildContextMenu(!0),this.setEditMenu();for(var a=ContextMenuManager.getMenuModelByMenuId(this.determineContextMenuMountAttributes().id),i=a.length,d=0;d<i;d++){let r=a[d];if(a[d].id==="export_excel"){this.setEditMenuExportIcon(r);break}}var e={filter_data:{}};e.filter_data.company_deduction_id=this.current_edit_record.id,this.sub_view_mode&&(e.filter_data.user_id=this.parent_value),this.user_deduction_api.getUserDeduction(e,!0,{onResult:function(r){t.edit_view&&(t.employee_setting_result=r.getResult(),t.setEmployeeSettingGridData(t.buildEmployeeSettingGrid()))}})}}resetEmployeeSettingGridColumns(){if(this.employee_setting_grid){var t=this.employee_setting_grid.getGridParam("data");_.formatGridData(t,this.api.key_name),this.buildEmployeeSettingGrid(),this.employee_setting_grid.setData(t),this.removeEmployeeSettingNoResultCover(),this.setEmployeeGridDateColumns(),this.setEmployeeGridSize(),t.length<1&&this.current_edit_record.id&&this.showEmployeeSettingNoResultCover()}}getColumnOptionsString(t){for(var a="",i=0;i<t.length;i++)i!==t.length-1?a+=t[i].fullValue+":"+t[i].label+";":a+=t[i].fullValue+":"+t[i].label;return a}buildEmployeeSettingGrid(){var t=this,a=[],i={name:"employee_number",index:"employee_number",label:n.i18n._("Employee Number"),width:100,sortable:!1,title:!1};a.push(i);var i={name:"user_name",index:"user_name",label:n.i18n._("Employee"),width:100,sortable:!1,title:!1};return a.push(i),t.api.getOptions("calculation_type_column_meta_data",{calculation_id:t.current_edit_record.calculation_id,country:t.current_edit_record.country,province:t.current_edit_record.province},{async:!1,onResult:function(d){d=d.getResult();for(var e in d){let r=d[e];r.dynamic_field_id,r.type_id==2100?i={name:e,index:e,label:r.name,width:r.width,sortable:!1,formatter:"select",editable:!0,title:!1,edittype:"select",editoptions:{defaultValue:r.default_value,value:t.getColumnOptionsString(_.buildRecordArray(r.multi_select_items))}}:i={name:e,index:e,label:r.name,width:r.width,sortable:!1,title:!1,editable:!0,edittype:"text"},a.push(i)}}}),this.current_edit_record.minimum_length_of_service&&this.current_edit_record.minimum_length_of_service!=0||(this.current_edit_record.maximum_length_of_service&&this.current_edit_record.maximum_length_of_service)!=0?(i={name:"length_of_service_date",index:"length_of_service_date",label:n.i18n._("Length of Service Date"),width:110,sortable:!1,title:!1,editable:!1,formatter:this.onLengthDateCellFormat},a.push(i)):n(".row-date-picker-length-of-service-date").remove(),this.current_edit_record.start_date||this.current_edit_record.end_date?(i={name:"start_date",index:"start_date",label:n.i18n._("Start Date"),width:110,sortable:!1,title:!1,editable:!1,formatter:this.onStartDateCellFormat},a.push(i),i={name:"end_date",index:"end_date",label:n.i18n._("End Date"),width:110,sortable:!1,title:!1,editable:!1,formatter:this.onEndDateCellFormat},a.push(i)):(n(".row-date-picker-start-date").remove(),n(".row-date-picker-end-date").remove()),(this.current_edit_record.calculation_id==100||this.current_edit_record.calculation_id==200||this.current_edit_record.calculation_id==300)&&this.current_edit_record.country=="US"&&(i={name:"user_value10",index:"user_value10",label:n.i18n._("Exempt"),width:30,sortable:!1,formatter:"select",editable:!0,title:!1,edittype:"select",editoptions:{value:this.getColumnOptionsString(this.yes_no_array)}},a.push(i)),this.employee_setting_grid&&(this.employee_setting_grid.grid.jqGrid("GridUnload"),this.employee_setting_grid=null),this.employee_setting_grid=new TTGrid("employee_setting_grid",{container_selector:".edit-view-tab",multiselect:!1,winMultiSelect:!1,colModel:a,editurl:"clientArray",onSelectRow:function(d){d&&!t.is_viewing&&(t.select_grid_last_row&&(t.employee_setting_grid.grid.jqGrid("saveRow",t.select_grid_last_row),t.setDateCellsEnabled(!1,t.select_grid_last_row)),t.employee_setting_grid.grid.jqGrid("editRow",d,!0),t.setDateCellsEnabled(!0,d),t.select_grid_last_row=d)},onEndEditRow:function(d){t.setDateCellsEnabled(!1,d)},gridComplete:function(){t.setEmployeeGridSize()}},a),a}setEditViewTabSize(){super.setEditViewTabSize(),this.setEmployeeGridSize()}setDateCellsEnabled(t,a){this.length_dates_dic[a]&&this.length_dates_dic[a].setEnabled(t),this.start_dates_dic[a]&&this.start_dates_dic[a].setEnabled(t),this.end_dates_dic[a]&&this.end_dates_dic[a].setEnabled(t)}onLengthDateCellFormat(t,a,i){var d=_.loadWidgetByName(FormItemType.DATE_PICKER);return d.addClass("row-date-picker-length-of-service-date"),d.attr("widget-value",t),d.get(0).outerHTML}onStartDateCellFormat(t,a,i){var d=_.loadWidgetByName(FormItemType.DATE_PICKER);return d.addClass("row-date-picker-start-date"),d.attr("widget-value",t),d.get(0).outerHTML}onEndDateCellFormat(t,a,i){var d=_.loadWidgetByName(FormItemType.DATE_PICKER);return d.addClass("row-date-picker-end-date"),d.attr("widget-value",t),d.get(0).outerHTML}setEmployeeSettingGridData(t){var a=this,i=[];n.type(this.employee_setting_result)==="array"&&(i=this.employee_setting_result.slice());for(var d=i.length,e=0;e<d;e++){var r=i[e];r.user_name=(r.user_status_id!=10?"("+r.user_status+") ":"")+r.full_name;for(var l=1;l<t.length;l++){var s=t[l];r[s.name]||(r[s.name]=this.current_edit_record.hasOwnProperty(s.name)&&this.current_edit_record[s.name]!==!1?this.current_edit_record[s.name]:"")}}a.employee_setting_grid.setData(i),this.removeEmployeeSettingNoResultCover(),this.setEmployeeGridDateColumns(),this.setEmployeeGridSize(),i.length<1&&this.current_edit_record.id&&this.showEmployeeSettingNoResultCover()}setEmployeeGridDateColumns(){var t,a;this.length_dates=[],this.start_dates=[],this.end_dates=[],this.length_dates_dic={},this.start_dates_dic={},this.end_dates_dic={};for(var i=n(".row-date-picker-length-of-service-date"),t=0;t<i.length;t++)a=n(i[t]).TDatePicker({field:"length_of_service_date"+t}),a.setEnabled(!1),this.length_dates.push(a),this.length_dates_dic[a.parent().parent().attr("id")]=a;i=n(".row-date-picker-start-date");for(var t=0;t<i.length;t++)a=n(i[t]).TDatePicker({field:"start_date"+t}),a.setEnabled(!1),this.start_dates.push(a),this.start_dates_dic[a.parent().parent().attr("id")]=a;i=n(".row-date-picker-end-date");for(var t=0;t<i.length;t++)a=n(i[t]).TDatePicker({field:"end_date"+t}),a.setEnabled(!1),this.end_dates.push(a),this.end_dates_dic[a.parent().parent().attr("id")]=a}showEmployeeSettingNoResultCover(){this.removeEmployeeSettingNoResultCover(),this.employee_setting_no_result_box=_.loadWidgetByName(WidgetNamesDic.NO_RESULT_BOX),this.employee_setting_no_result_box.NoResultBox({related_view_controller:this,is_new:!1}),this.employee_setting_no_result_box.attr("id",this.ui_id+"employee_setting_no_result_box");var t=this.edit_view.find(".employee-setting-grid-div");t.append(this.employee_setting_no_result_box)}removeEmployeeSettingNoResultCover(){this.employee_setting_no_result_box&&this.employee_setting_no_result_box.length>0&&this.employee_setting_no_result_box.remove(),this.employee_setting_no_result_box=null}setEmployeeGridSize(){if(this.employee_setting_grid){var t=this.edit_view.find("#tab_employee_setting_content_div");this.employee_setting_grid.grid.setGridWidth(t.width()),this.employee_setting_grid.grid.setGridHeight(t.height())}}setCountryVisibility(){this.show_c?this.attachElement("country"):this.detachElement("country")}setProvinceVisibility(){this.show_p&&this.e_province_array&&this.e_province_array.length>1?this.attachElement("province"):this.detachElement("province")}setDistrictVisibility(){this.show_dc&&this.province_district_array&&this.province_district_array.length>0?this.attachElement("district"):(this.detachElement("district"),this.current_edit_record.district=!1)}setDynamicFields(t,a){var i=this;this.current_edit_record.calculation_id||(this.current_edit_record.calculation_id="10",this.edit_view_ui_dic.calculation_id.setValue(10));var d=this.current_edit_record.calculation_id;d==20?(this.detachElement("include_account_amount_type_id"),this.detachElement("exclude_account_amount_type_id")):(this.attachElement("include_account_amount_type_id"),this.attachElement("exclude_account_amount_type_id")),a?this.show_p?(i.hideAllDynamicFields(!0,!0),e()):(i.hideAllDynamicFields(!0,!1),e()):(this.hideAllDynamicFields(),this.api.isCountryCalculationID(d,{onResult:function(r){var l=r.getResult();l===!0?(i.show_c=!0,i.setCountryVisibility(),i.api.isProvinceCalculationID(d,{onResult:function(s){var u=s.getResult();u===!0?(i.show_p=!0,i.current_edit_record.country&&i.eSetProvince(i.current_edit_record.country),i.api.isDistrictCalculationID(d,{onResult:function(c){var m=c.getResult();m===!0&&(i.show_dc=!0,i.current_edit_record.country&&i.setDistrict(i.current_edit_record.country)),e()}})):i.current_edit_record&&e()}})):(i.hideAllDynamicFields(),e())}}));function e(){i.edit_view&&((i.current_edit_record.calculation_id=="100"||i.current_edit_record.calculation_id=="200"||i.current_edit_record.calculation_id=="300")&&(i.attachElement("df_15"),i.edit_view_form_item_dic.df_15.find(".edit-view-form-item-label").text(n.i18n._("Formula Type")),i.edit_view_ui_dic.df_15.setField("company_value1"),i.edit_view_ui_dic.df_15.setValue(i.current_edit_record.company_value1)),i.current_edit_record.calculation_id=="69"&&_.getProductEdition()==10?(i.attachElement("df_100"),i.edit_view_ui_dic.df_100.html(_.getUpgradeMessage())):i.api.getOptions("calculation_type_column_meta_data",{calculation_id:i.current_edit_record.calculation_id,country:i.current_edit_record.country,province:i.current_edit_record.province},{onResult:function(r){r=r.getResult();for(var l in r){let s=r[l],u=s.dynamic_field_id;i.attachElement(u),i.edit_view_form_item_dic[u].find(".edit-view-form-item-label").text(s.name.replace("<br>"," ")),s.type_id==2100&&i.edit_view_ui_dic[u].setSourceData(_.buildRecordArray(s.multi_select_items)),i.edit_view_ui_dic[u].setField(l),i.edit_view_ui_dic[u].setValue(i.current_edit_record[l])}i.current_edit_record.calculation_id=="69"&&(i.attachElement("df_11"),i.edit_view_form_item_dic.df_11.find(".edit-view-form-item-label").text(n.i18n._("Formula")),i.edit_view_ui_dic.df_11.setField("company_value1"),i.edit_view_ui_dic.df_11.setValue(i.current_edit_record.company_value1),i.attachElement("df_12"),i.edit_view_form_item_dic.df_12.find(".edit-view-form-item-label").text(n.i18n._("Look Back Period")),i.edit_view_ui_dic.df_12.setField("company_value2"),i.edit_view_ui_dic.df_12.setValue(i.current_edit_record.company_value2),i.edit_view_ui_dic.df_13.setField("company_value3"),i.edit_view_ui_dic.df_13.setValue(i.current_edit_record.company_value3)),i.editFieldResize(i.getEditViewTabIndex()),t&&t()}}))}}onFormW4VersionChange(){this.current_edit_record.calculation_id==100&&this.current_edit_record.country=="US"}onApplyFrequencyChange(){this.edit_view_ui_dic.apply_frequency_day_of_month1.parent().parent().css("display","none"),this.edit_view_ui_dic.apply_frequency_day_of_month2.parent().parent().css("display","none"),this.current_edit_record.apply_frequency_id==10||this.current_edit_record.apply_frequency_id==100||this.current_edit_record.apply_frequency_id==110||this.current_edit_record.apply_frequency_id==120||this.current_edit_record.apply_frequency_id==130||this.is_mass_editing&&this.current_edit_record.apply_frequency_id===!1?(this.edit_view_ui_dic.apply_frequency_month.parent().parent().css("display","none"),this.edit_view_ui_dic.apply_frequency_day_of_month.parent().parent().css("display","none"),this.edit_view_ui_dic.apply_frequency_quarter_month.parent().parent().css("display","none")):this.current_edit_record.apply_frequency_id==20?(this.edit_view_ui_dic.apply_frequency_month.parent().parent().css("display","block"),this.edit_view_ui_dic.apply_frequency_day_of_month.parent().parent().css("display","block"),this.edit_view_ui_dic.apply_frequency_quarter_month.parent().parent().css("display","none")):this.current_edit_record.apply_frequency_id==25?(this.edit_view_ui_dic.apply_frequency_month.parent().parent().css("display","none"),this.edit_view_ui_dic.apply_frequency_day_of_month.parent().parent().css("display","block"),this.edit_view_ui_dic.apply_frequency_quarter_month.parent().parent().css("display","block")):this.current_edit_record.apply_frequency_id==30?(this.edit_view_ui_dic.apply_frequency_month.parent().parent().css("display","none"),this.edit_view_ui_dic.apply_frequency_day_of_month.parent().parent().css("display","block"),this.edit_view_ui_dic.apply_frequency_quarter_month.parent().parent().css("display","none")):this.current_edit_record.apply_frequency_id==35&&(this.edit_view_ui_dic.apply_frequency_day_of_month1.parent().parent().css("display","block"),this.edit_view_ui_dic.apply_frequency_day_of_month2.parent().parent().css("display","block"),this.edit_view_ui_dic.apply_frequency_month.parent().parent().css("display","none"),this.edit_view_ui_dic.apply_frequency_day_of_month.parent().parent().css("display","none"),this.edit_view_ui_dic.apply_frequency_quarter_month.parent().parent().css("display","none")),this.editFieldResize()}onCalculationChange(){}buildEditViewUI(){TTPromise.add("CompanyTaxDeduction","buildEditViewUI"),super.buildEditViewUI();var t=this,a={tab_tax_deductions:{label:n.i18n._("Tax / Deductions")},tab_eligibility:{label:n.i18n._("Eligibility")},tab_employee_setting:{label:n.i18n._("Employee Settings"),init_callback:"initEmployeeSetting",display_on_mass_edit:!1,html_template:this.getCompanyTaxDeductionEmployeeSettingTabHtml()},tab5:{label:n.i18n._("Tax / Deductions"),display_on_mass_edit:!1},tab_attachment:!0,tab_audit:!0};this.setTabModel(a),this.edit_view.children().eq(0).css("min-width",1170),this.navigation.AComboBox({id:this.script_name+"_navigation",api_class:TTAPI.APICompanyDeduction,allow_multiple_selection:!1,layout_name:"global_deduction",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var i=this.edit_view_tab.find("#tab_tax_deductions"),d=i.find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(d);var e,r,l;e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"status_id",set_empty:!1}),e.setSourceData(t.status_array),this.addEditFieldToColumn(n.i18n._("Status"),e,d,""),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"type_id",set_empty:!1}),e.setSourceData(t.type_array),this.addEditFieldToColumn(n.i18n._("Type"),e,d),e=_.loadWidgetByName(FormItemType.AWESOME_BOX),e.TText({field:"legal_entity_id"}),e.AComboBox({api_class:TTAPI.APILegalEntity,allow_multiple_selection:!1,layout_name:"global_legal_entity",show_search_inputs:!1,set_empty:!0,field:"legal_entity_id"}),this.addEditFieldToColumn(n.i18n._("Legal Entity"),e,d),e=_.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIPayrollRemittanceAgency,allow_multiple_selection:!1,layout_name:"global_payroll_remittance_agency",set_empty:!0,field:"payroll_remittance_agency_id"}),this.addEditFieldToColumn(n.i18n._("Remittance Agency"),e,d),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn(n.i18n._("Name"),e,d),e.parent().width("45%"),e=_.loadWidgetByName(FormItemType.TEXT_AREA),e.TTextArea({field:"description",width:"100%"}),this.addEditFieldToColumn(n.i18n._("Description"),e,d,"",null,null,!0),e.parent().width("45%"),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"pay_stub_entry_description",width:300}),this.addEditFieldToColumn(n.i18n._("Pay Stub Note (Public)"),e,d),e=_.loadWidgetByName(FormItemType.SEPARATED_BOX),e.SeparatedBox({label:n.i18n._("Calculation Settings")}),this.addEditFieldToColumn(null,e,d,"",null,!0,!1,"separated_2"),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"calculation_id",set_empty:!1,width:400}),e.setSourceData(t.calculation_array),this.addEditFieldToColumn(n.i18n._("Calculation"),e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"df_15",set_empty:!1}),e.setSourceData(t.tax_formula_type_array),this.addEditFieldToColumn("df_15",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"country",set_empty:!0}),e.setSourceData(t.country_array),this.addEditFieldToColumn(n.i18n._("Country"),e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"province"}),e.setSourceData([]),this.addEditFieldToColumn(n.i18n._("Province/State"),e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"district",set_empty:!1}),e.setSourceData([]),this.addEditFieldToColumn(n.i18n._("District"),e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"df_0"}),r=n("<div class='widget-h-box'></div>"),l=n("<span class='widget-right-label'> %</span>"),r.append(e),r.append(l),this.addEditFieldToColumn("df_0",e,d,"",r,!0),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"df_20",set_empty:!1}),this.addEditFieldToColumn("df_20",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"df_14",set_empty:!1}),this.addEditFieldToColumn("df_14",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"df_1"}),this.addEditFieldToColumn("df_1",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"df_2"}),this.addEditFieldToColumn("df_2",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"df_3"}),this.addEditFieldToColumn("df_3",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"df_4"}),this.addEditFieldToColumn("df_4",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"df_5"}),this.addEditFieldToColumn("df_5",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"df_6"}),this.addEditFieldToColumn("df_6",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"df_7"}),this.addEditFieldToColumn("df_7",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"df_8"}),this.addEditFieldToColumn("df_8",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"df_9"}),this.addEditFieldToColumn("df_9",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"df_10"}),this.addEditFieldToColumn("df_10",e,d,"",null,!0),_.getProductEdition()>=15?(TTPromise.add("CompanyTaxDeduction","df_11"),_.loadScript("global/widgets/formula_builder/FormulaBuilder.js",function(){e=_.loadWidgetByName(FormItemType.FORMULA_BUILDER),e.FormulaBuilder({field:"df_11",width:"100%",onFormulaBtnClick:function(){var w=TTAPI.APIReportCustomColumn;w.getOptions("formula_functions",{onResult:function(C){var I=C.getResult();t.api.getOptions("formula_variables",{onResult:x});function x(D){var F=D.getResult(),h={};h.functions=_.buildRecordArray(I),h.variables=_.buildRecordArray(F),h.formula=t.current_edit_record.company_value1,h.current_edit_record=_.clone(t.current_edit_record),h.api=t.api,IndexViewController.openWizard("FormulaBuilderWizard",h,function(v){t.current_edit_record.company_value1=v,t.edit_view_ui_dic.df_11.setValue(v)})}}})}}),t.addEditFieldToColumn("df_11",e,d,"",null,!0),t.detachElement("df_11"),e.parent().width("45%"),TTPromise.resolve("CompanyTaxDeduction","df_11")})):(e=_.loadWidgetByName(FormItemType.TEXT_AREA),e.TTextInput({field:"df_11"}),this.addEditFieldToColumn("df_11",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.TEXT),e.TText({field:"df_100"}),this.addEditFieldToColumn("Warning",e,d,"",null,!0)),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"df_12",width:30}),r=n("<div class='widget-h-box'></div>"),l=n("<span class='widget-right-label'>   </span>");var s=_.loadWidgetByName(FormItemType.COMBO_BOX);if(s.TComboBox({field:"df_13"}),s.setSourceData(t.look_back_unit_array),r.append(e),r.append(l),r.append(s),this.addEditFieldToColumn("df_12",[e,s],d,"",r,!0),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"df_21",set_empty:!1}),this.addEditFieldToColumn("df_21",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"df_22"}),this.addEditFieldToColumn("df_22",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"df_23"}),this.addEditFieldToColumn("df_23",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"df_24"}),this.addEditFieldToColumn("df_24",e,d,"",null,!0),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"df_25"}),this.addEditFieldToColumn("df_25",e,d,"",null,!0),!this.sub_view_mode){var u={};u.filter_data={},u.filter_data.type_id=[10,20,30,50,80],e=_.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIPayStubEntryAccount,allow_multiple_selection:!1,layout_name:"global_PayStubAccount",show_search_inputs:!0,set_empty:!0,field:"pay_stub_entry_account_id"}),e.setDefaultArgs(u),this.addEditFieldToColumn(n.i18n._("Pay Stub Account"),e,d,"",null,!0)}e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"calculation_order",width:30}),this.addEditFieldToColumn(n.i18n._("Calculation Order"),e,d,"",null,!0);var c=n("<div class='v-box'></div>");e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"include_account_amount_type_id",set_empty:!1}),e.setSourceData(t.account_amount_type_array);var m=this.putInputToInsideFormItem(e,n.i18n._("Pay Stub Account Value"));if(c.append(m),c.append("<div class='clear-both-div'></div>"),!this.sub_view_mode){var p=_.loadWidgetByName(FormItemType.AWESOME_BOX);p.AComboBox({api_class:TTAPI.APIPayStubEntryAccount,allow_multiple_selection:!0,layout_name:"global_PayStubAccount",show_search_inputs:!0,set_empty:!0,field:"include_pay_stub_entry_account"}),m=this.putInputToInsideFormItem(p,n.i18n._("Selection")),c.append(m),this.addEditFieldToColumn(n.i18n._("Include Pay Stub Accounts"),[e,p],d,null,c,!0,!0)}c=n("<div class='v-box'></div>"),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"exclude_account_amount_type_id",set_empty:!1}),e.setSourceData(t.account_amount_type_array),m=this.putInputToInsideFormItem(e,n.i18n._("Pay Stub Account Value")),c.append(m),c.append("<div class='clear-both-div'></div>"),this.sub_view_mode||(p=_.loadWidgetByName(FormItemType.AWESOME_BOX),p.AComboBox({api_class:TTAPI.APIPayStubEntryAccount,allow_multiple_selection:!0,layout_name:"global_PayStubAccount",show_search_inputs:!0,set_empty:!0,field:"exclude_pay_stub_entry_account"}),m=this.putInputToInsideFormItem(p,n.i18n._("Selection")),c.append(m),this.addEditFieldToColumn(n.i18n._("Exclude Pay Stub Accounts"),[e,p],d,null,c,!0,!0)),this.sub_view_mode||(e=_.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIUser,allow_multiple_selection:!0,layout_name:"global_user",show_search_inputs:!0,set_empty:!0,field:"user"}),this.addEditFieldToColumn(n.i18n._("Employees"),e,d,""));var b=this.edit_view_tab.find("#tab_eligibility"),o=b.find(".first-column");this.edit_view_tabs[1]=[],this.edit_view_tabs[1].push(o),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"apply_frequency_id",set_empty:!1}),e.setSourceData(t.apply_frequency_array),this.addEditFieldToColumn(n.i18n._("Apply Frequency"),e,o,""),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"apply_frequency_month",set_empty:!1}),e.setSourceData(t.month_of_year_array),this.addEditFieldToColumn(n.i18n._("Month"),e,o,"",null,!0),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"apply_frequency_day_of_month",set_empty:!1}),e.setSourceData(t.day_of_month_array),this.addEditFieldToColumn(n.i18n._("Day of Month"),e,o,"",null,!0),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"apply_frequency_day_of_month1",set_empty:!1}),e.setSourceData(t.day_of_month_array),this.addEditFieldToColumn(n.i18n._("Primary Day of Month"),e,o,"",null,!0),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"apply_frequency_day_of_month2",set_empty:!1}),e.setSourceData(t.day_of_month_array),this.addEditFieldToColumn(n.i18n._("Secondary Day of Month"),e,o,"",null,!0),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"apply_frequency_quarter_month",set_empty:!1}),e.setSourceData(t.month_of_quarter_array),this.addEditFieldToColumn(n.i18n._("Month of Quarter"),e,o,"",null,!0),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"apply_payroll_run_type_id",set_empty:!0,customFirstItemLabel:_.any_item}),e.setSourceData(t.apply_payroll_run_type_array),this.addEditFieldToColumn(n.i18n._("Payroll Run Type"),e,o,""),e=_.loadWidgetByName(FormItemType.DATE_PICKER),e.TDatePicker({field:"start_date"}),r=n("<div class='widget-h-box'></div>"),l=n("<span class='widget-right-label'>"+n.i18n._("(Leave blank for no start date)")+"</span>"),r.append(e),r.append(l),this.addEditFieldToColumn(n.i18n._("Start Date"),e,o,"",r),e=_.loadWidgetByName(FormItemType.DATE_PICKER),e.TDatePicker({field:"end_date"}),r=n("<div class='widget-h-box'></div>"),l=n("<span class='widget-right-label'>"+n.i18n._("(Leave blank for no end date)")+"</span>"),r.append(e),r.append(l),this.addEditFieldToColumn(n.i18n._("End Date"),e,o,"",r),e=_.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"filter_date_type_id",set_empty:!1,customFirstItemLabel:_.any_item}),e.setSourceData(t.filter_date_type_array),this.addEditFieldToColumn(n.i18n._("Start/End Dates Based On"),e,o,""),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"minimum_length_of_service",width:30}),r=n("<div class='widget-h-box'></div>"),l=n("<span class='widget-right-label'>   </span>"),s=_.loadWidgetByName(FormItemType.COMBO_BOX),s.TComboBox({field:"minimum_length_of_service_unit_id"}),s.setSourceData(t.length_of_service_unit_array),r.append(e),r.append(l),r.append(s),this.addEditFieldToColumn(n.i18n._("Minimum Length Of Service"),[e,s],o,"",r),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"maximum_length_of_service",width:30}),r=n("<div class='widget-h-box'></div>"),l=n("<span class='widget-right-label'>   </span>"),s=_.loadWidgetByName(FormItemType.COMBO_BOX),s.TComboBox({field:"maximum_length_of_service_unit_id"}),s.setSourceData(t.length_of_service_unit_array),r.append(e),r.append(l),r.append(s),this.addEditFieldToColumn(n.i18n._("Maximum Length Of Service"),[e,s],o,"",r),this.sub_view_mode||(e=_.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIContributingPayCodePolicy,allow_multiple_selection:!1,layout_name:"global_contributing_pay_code_policy",show_search_inputs:!0,set_empty:!0,set_default:!0,field:"length_of_service_contributing_pay_code_policy_id"}),this.addEditFieldToColumn(n.i18n._("Length Of Service Hours Based On"),e,o,"",null,!0)),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"minimum_user_age",width:30}),r=n("<div class='widget-h-box'></div>"),l=n("<span class='widget-right-label'>"+n.i18n._("years")+"</span>"),r.append(e),r.append(l),this.addEditFieldToColumn(n.i18n._("Minimum Employee Age"),e,o,"",r),e=_.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"maximum_user_age",width:30}),r=n("<div class='widget-h-box'></div>"),l=n("<span class='widget-right-label'>"+n.i18n._("years")+"</span>"),r.append(e),r.append(l),this.addEditFieldToColumn(n.i18n._("Maximum Employee Age"),e,o,"",r);var E=this.edit_view_tab.find("#tab5"),g=E.find(".first-column");this.edit_view_tabs[5]=[],this.edit_view_tabs[5].push(g),e=_.loadWidgetByName(FormItemType.AWESOME_DROPDOWN);var f=ALayoutCache.getDefaultColumn("global_deduction");f=_.convertColumnsTojGridFormat(f,"global_deduction"),e.ADropDown({field:"company_tax_deduction_ids",display_show_all:!1,id:"company_tax_deduction_ids",key:"id",display_close_btn:!1,allow_drag_to_order:!1,display_column_settings:!1}),e.addClass("splayed-adropdown"),this.addEditFieldToColumn(n.i18n._("Taxes / Deductions"),e,g,"",null,!1,!0),e.setColumns(f),TTPromise.resolve("CompanyTaxDeduction","buildEditViewUI")}setEditViewTabHeight(){super.setEditViewTabHeight();var t=this.edit_view_ui_dic.company_tax_deduction_ids;t.setHeight(this.edit_view_tab.find(".context-border").height()-n(this.$el)[0].getBoundingClientRect().top-20)}putInputToInsideFormItem(t,a){var i=n(_.loadWidgetByName(WidgetNamesDic.EDIT_VIEW_SUB_FORM_ITEM)),d=i.find(".edit-view-form-item-label-div");d.attr("class","edit-view-form-item-sub-label-div");var e=i.find(".edit-view-form-item-label"),r=i.find(".edit-view-form-item-input-div");return i.addClass("remove-margin"),e.text(n.i18n._(a)),r.append(t),i}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:n.i18n._("Status"),in_column:1,field:"status_id",multiple:!0,basic_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:n.i18n._("Type"),in_column:1,field:"type_id",multiple:!0,basic_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:n.i18n._("Name"),in_column:1,field:"name",multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:n.i18n._("Legal Entity"),in_column:1,field:"legal_entity_id",layout_name:"global_legal_entity",api_class:TTAPI.APILegalEntity,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:n.i18n._("Pay Stub Account"),in_column:1,field:"pay_stub_entry_name_id",layout_name:"global_PayStubAccount",api_class:TTAPI.APIPayStubEntryAccount,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:n.i18n._("Remittance Agency"),in_column:2,field:"payroll_remittance_agency_id",layout_name:"global_payroll_remittance_agency",api_class:TTAPI.APIPayrollRemittanceAgency,multiple:!0,basic_search:!0,script_name:"PayrollRemittanceAgencyView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:n.i18n._("Calculation"),in_column:2,field:"calculation_id",multiple:!0,basic_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:n.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:n.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX})]}searchDone(){TTPromise.resolve("TaxView","init"),super.searchDone()}getCompanyTaxDeductionEmployeeSettingTabHtml(){return`<div id="tab_employee_setting" class="edit-view-tab-outside">
					<div class="edit-view-tab" id="tab_employee_setting_content_div">
						<div class="inside-editor-div full-width-column">
							<div class="grid-div employee-setting-grid-div">
								<table id="employee_setting_grid"></table>
							</div>
						</div>
						<div class="save-and-continue-div">
							<span class="message"></span>
							<div class="save-and-continue-button-div">
								<button class="tt-button p-button p-component" type="button">
									<span class="icon"></span>
									<span class="p-button-label"></span>
								</button>
							</div>
						</div>
					</div>
				</div>`}}S.loadSubView=function(y,t,a){_.loadViewSource("CompanyTaxDeduction","SubCompanyTaxDeductionView.html",function(i){var d={},e=T.template(i);_.isSet(t)&&t(),_.isSet(y)&&(y.html(e(d)),_.isSet(a)&&a(sub_company_tax_deduction_view_controller))})};export{S as CompanyTaxDeductionViewController};
//# sourceMappingURL=CompanyTaxDeductionViewController-p80zYuSS.bundle.js.map
