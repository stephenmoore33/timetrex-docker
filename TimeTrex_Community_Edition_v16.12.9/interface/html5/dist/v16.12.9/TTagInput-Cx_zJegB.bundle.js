import{j as B}from"./vendor-tTApdY0Y.bundle.js";(function(r){r.fn.TTagInput=function(S){var w=r.extend({},r.fn.TTagInput.defaults,S),e=this,k,n=null,i=[],I=!1,o=null,f=!0,T="",p,y,D=-1;return this.showErrorTip=function(t){Global.isSet(t)||(t=2),p||(p=Global.loadWidgetByName(WidgetNamesDic.ERROR_TOOLTIP),p=p.ErrorTipBox()),r(this).hasClass("warning-tip")?p.show(this,T,t,!0):p.show(this,T,t)},this.hideErrorTip=function(){Global.isSet(p)&&p.remove()},this.getEnabled=function(){return f},this.setEnabled=function(t){f=t,t===!1||t===""?(e.addClass("t-tag-input-readonly"),n.addClass("add-tag-input-readonly"),n.attr("disabled",!0)):(e.removeClass("t-tag-input-readonly"),n.removeClass("add-tag-input-readonly"),n.removeAttr("disabled"))},this.setCheckBox=function(t){o&&(o.children().eq(0)[0].checked=t)},this.isChecked=function(){return!!(o&&o.children().eq(0)[0].checked===!0)},this.setMassEditMode=function(t){I=t,I?(o=r(' <div class="mass-edit-checkbox-wrapper tag-mass-edit-checkbox-wrapper"><input type="checkbox" class="mass-edit-checkbox"></input><label for="checkbox-input-1" class="input-helper input-helper--checkbox"></label></div>'),o.insertBefore(r(this)),o.change(function(){e.trigger("formItemChange",[e])})):o&&(o.remove(),o=null)},this.clearErrorStyle=function(){},this.getField=function(){return k},Global.addCss("global/widgets/tag_input/TTagInput.css"),this.getValue=function(){var t="";for(var a in i)i[a]&&(t=t+i[a].find(".tag-span").text()+",");return t=t.substring(0,t.length-1),t},this.setValue=function(t){e.buildTagSpan(t)},this.buildTagSpan=function(t){t||(t="");for(var a in i)i[a]&&i[a].remove&&i[a].remove();i={};var s=t.split(",");s&&s.length===1&&s[0]===""||r.each(s,function(b,u){var h=!1;(u.indexOf("[search-deleted]")>0||u.indexOf("-")===0)&&(u=u.split("[search-deleted]")[0],h=!0);var l=r("<div class='tag-span-div'></div>"),g=r("<span  class='close-btn'>X</span>"),d=r("<span class='tag-span'></span>");h&&l.addClass("removed"),g.attr("data-value",u),d.text(u);var c=!1;g.dblclick(function(v){if(c=!0,!!f){var m=r(this).attr("data-value");Global.isSet(i[m])&&i[m].remove(),delete i[m],o&&e.setCheckBox(!0),e.trigger("formItemChange",[e]),setTimeout(function(){c=!1},200)}}),g.click(function(v){setTimeout(function(){c||E()},200);var m=this;function E(){if(f){var _=r(m).attr("data-value"),x=i[_],C="";x&&(_.indexOf("-")===0?(C=_.substr(1),x.removeClass("removed")):(C="-"+_,x.addClass("removed")),i[_].find(".tag-span").text(C),delete i[_],r(m).attr("data-value",C),i[C]=x,o&&e.setCheckBox(!0),e.trigger("formItemChange",[e]))}}}),l.append(d),l.append(g),r(e).prepend(l),i[u]=l})},this.createTag=function(t){var a=r("<div class='tag-span-div new'></div>"),s=r("<span class='close-btn'>X</span>"),b=r("<span class='tag-span'></span>");s.attr("data-value",t),b.text(t);var u=!1;s.dblclick(function(h){if(u=!0,!!f){var l=r(this).attr("data-value");Global.isSet(i[l])&&i[l].remove(),delete i[l],o&&e.setCheckBox(!0),e.trigger("formItemChange",[e]),setTimeout(function(){u=!1},200)}}),s.click(function(h){setTimeout(function(){u||g()},200);var l=this;function g(){if(f){var d=r(l).attr("data-value"),c=i[d],v="";d.indexOf("-")===0?(v=d.substr(1),c==null||c.removeClass("removed")):(v="-"+d,c==null||c.addClass("removed")),i[d].find(".tag-span").text(v),delete i[d],r(l).attr("data-value",v),i[v]=c,e.trigger("formItemChange",[e])}}}),!Global.isSet(i[s.attr("data-value")])&&(a.append(b),a.append(s),a.insertBefore(n),i[t]=a)},this.each(function(){var t=r.meta?r.extend({},w,r(this).data()):w;k=t.field,t.object_type_id&&(D=t.object_type_id),n=r("<input class='add-tag-input' autocomplete='On'></input>"),y=TTAPI.APICompanyGenericTag,n.autocomplete({source:[],select:function(a,s){e.createTag(s.item.value),o&&e.setCheckBox(!0),n.autocomplete("option",{source:[]}),e.trigger("formItemChange",[e]),e.isSelectedItem=!0},close:function(a,s){e.isSelectedItem&&n.val("")}}),r(this).append(n),r(this).click(function(){n.focus(),f||o||(LocalCacheData.current_open_sub_controller&&LocalCacheData.current_open_sub_controller.edit_view&&LocalCacheData.current_open_sub_controller.is_viewing?(T=LocalCacheData.current_open_sub_controller.getViewModeErrorMessage(),e.showErrorTip(10)):LocalCacheData.current_open_primary_controller&&LocalCacheData.current_open_primary_controller.edit_view&&LocalCacheData.current_open_primary_controller.is_viewing&&(T=LocalCacheData.current_open_primary_controller.getViewModeErrorMessage(),e.showErrorTip(10)))}),r(this).contextmenu(function(a){a.preventDefault(),a.stopImmediatePropagation()}),r(this).mouseout(function(){e.hideErrorTip()}),n.bind("focusout",function(a){if(r(a.relatedTarget).attr("id")!=="ui-active-menuitem"&&n.val().length>0){if(!f)return;e.createTag(n.val()),n.val(""),o&&e.setCheckBox(!0),e.trigger("formItemChange",[e])}}),n.bind("keyup",function(a){if(a.which===40||a.which===38)return a.preventDefault(),!1;a.preventDefault();var s={};return s.filter_data={},s.filter_data.object_type_id=[D],s.filter_data.name=n.val(),y.getCompanyGenericTag(s,{onResult:function(b){for(var u=b.getResult(),h=[],l=0;l<u.length;l++)h.push(u[l].name);n.autocomplete("option",{source:h})}}),!1}),n.bind("keydown",function(a){if(a.which===40||a.which===38)return a.preventDefault(),!1;if((a.which===13||a.which===44||a.which===32||a.which===9||a.which===188)&&n.val().length>0)return a.preventDefault(),f&&(e.createTag(n.val()),n.val(""),o&&e.setCheckBox(!0),e.trigger("formItemChange",[e])),!1})}),this},r.fn.TTagInput.defaults={},r.fn.TTagInput.html_template='<div class="t-tag-input"></div>'})(B);
//# sourceMappingURL=TTagInput-Cx_zJegB.bundle.js.map
