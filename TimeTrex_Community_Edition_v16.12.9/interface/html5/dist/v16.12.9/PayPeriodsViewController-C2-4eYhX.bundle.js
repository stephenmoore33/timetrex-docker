import{_ as o,j as s}from"./vendor-tTApdY0Y.bundle.js";class u extends BaseViewController{constructor(e={}){o.defaults(e,{el:"#pay_periods_view_container",status_array:null,type_array:null,pay_period_schedule_api:null}),super(e)}init(e){this.edit_view_tpl="PayPeriodsEditView.html",this.permission_id="pay_period_schedule",this.script_name="PayPeriodsView",this.viewId="PayPeriods",this.table_name_key="pay_period",this.context_menu_name=s.i18n._("Pay Period"),this.navigation_label=s.i18n._("Pay Period"),this.api=TTAPI.APIPayPeriod,this.pay_period_schedule_api=TTAPI.APIPayPeriodSchedule,this.render(),this.sub_view_mode?this.buildContextMenu(!0):this.buildContextMenu(),this.sub_view_mode||this.initData()}removeEditView(e){super.removeEditView(),this.parent_view_controller&&(this.parent_view_controller.viewId==="TimeSheet"||this.parent_view_controller.viewId==="PayStub")&&this.parent_view_controller.onSubViewRemoved(e)}initOptions(e){var t=[{option_name:"status",field_name:null,api:null},{option_name:"type",field_name:"type_id",api:this.pay_period_schedule_api}];this.initDropDownOptions(t,function(r){e&&e(r)})}getCustomContextMenuModel(){var e={exclude:["copy"],include:[{label:"",id:"other_header",menu_align:"right",action_group:"other",action_group_header:!0,vue_icon:"tticon tticon-more_vert_black_24dp"},{label:s.i18n._("Delete Data"),id:"delete_data",menu_align:"right",action_group:"other"},{label:s.i18n._("Import Data"),id:"import_icon",menu_align:"right",action_group:"other"}]};return this.edit_only_mode&&e.exclude.push("import_icon","delete_data"),e}onEditClick(e,t){if(this.getGridSelectIdArray().includes(TTUUID.zero_id)){ProgressBar.closeOverlay();return}super.onEditClick(e,t)}openEditView(e){var t=this;t.edit_only_mode?t.initOptions(function(r){t.edit_view||t.initEditViewUI(t.viewId,t.edit_view_tpl),t.getPayPeriodData(e,function(a){t.current_edit_record=a,t.initEditView()})}):this.edit_view||this.initEditViewUI(t.viewId,t.edit_view_tpl)}setCustomDefaultMenuIcon(e,t,r){switch(e){case"login":this.setDefaultMenuLoginIcon(t,r);break;case"cancel":this.setDefaultMenuCancelIcon(t,r);break;case"import_icon":this.setDefaultMenuImportIcon(t,r);break;case"delete_data":this.setDefaultMenuDeleteDataIcon(t,r);break}}setDefaultMenu(e){var t=ContextMenuManager.getMenuModelByMenuId(this.determineContextMenuMountAttributes().id);if(this.getSelectedItems().some(a=>a&&a.status_id==50)){for(var r=0;r<t.length;r++){let a=t[r];t[r].id==="add"?(ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,a.id,!0),ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,a.id,!0)):ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,a.id,!1)}this.setTotalDisplaySpan();return}super.setDefaultMenu(e)}setDefaultMenuImportIcon(e,t){this.importValidate()||ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,e.id,!1),t>=1?ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,e.id,!0):ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,e.id,!1)}importValidate(e){var t=this.permission_id;return Global.isSet(e)||(e=this.getSelectedItem()),!!(t==="report"||this.editPermissionValidate(t,e)||this.addPermissionValidate(t,e))}setDefaultMenuDeleteDataIcon(e,t){this.importValidate()||ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,e.id,!1),t>=1?ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,e.id,!0):ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,e.id,!1)}setCustomEditMenuIcon(e,t){switch(e){case"delete_data":this.setEditMenuImportIcon(t);break}}setEditMenuImportIcon(e,t){(!this.importValidate()||this.is_viewing||this.is_edit||this.is_add)&&(ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,e.id,!1),ContextMenuManager.disableMenuItem(this.determineContextMenuMountAttributes().id,e.id,!1))}onCustomContextClick(e){var t=this,r,a=[];if(t.edit_view&&t.current_edit_record.id?a.push(t.current_edit_record.id):(r=this.getGridSelectIdArray(),s.each(r,function(i,d){var l=t.getRecordFromGridById(d);a.push(l.id)})),a.length>0)switch(e){case"import_icon":TAlertManager.showConfirmAlert(s.i18n._("This will import employee attendance data from other pay periods into this pay period.Are you sure you wish to continue?"),null,function(i){i?(ProgressBar.showOverlay(),t.api.importData(a,{onResult:function(d){ProgressBar.closeOverlay(),d&&d.isValid()?t.search(!1):TAlertManager.showErrorAlert(d)}})):ProgressBar.closeOverlay()});break;case"delete_data":TAlertManager.showConfirmAlert(s.i18n._("This will delete all attendance data assigned to this pay period. Are you sure you wish to continue?"),null,function(i){i?(ProgressBar.showOverlay(),t.api.deleteData(a,{onResult:function(d){ProgressBar.closeOverlay(),d&&d.isValid()?t.search(!1):TAlertManager.showErrorAlert(d)}})):ProgressBar.closeOverlay()});break;case"export_excel":this.onExportClick("export"+this.api.key_name);break}}getPayPeriodData(e,t){var r={};r.filter_data={},r.filter_data.id=[e],this.api["get"+this.api.key_name](r,{onResult:function(a){var i=a.getResult();i||(i=[]),i=i[0],t(i)}})}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:s.i18n._("Pay Period Schedule"),in_column:1,field:"pay_period_schedule_id",layout_name:"global_pay_period_schedule",api_class:TTAPI.APIPayPeriodSchedule,multiple:!0,basic_search:!0,adv_search:!0,script_name:"PayPeriodScheduleView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:s.i18n._("Status"),in_column:1,field:"status_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:s.i18n._("Type"),in_column:1,field:"type_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:s.i18n._("Start Date"),in_column:1,field:"start_date",basic_search:!0,adv_search:!0,form_item_type:FormItemType.DATE_PICKER}),new SearchField({label:s.i18n._("End Date"),in_column:1,field:"end_date",basic_search:!0,adv_search:!0,form_item_type:FormItemType.DATE_PICKER}),new SearchField({label:s.i18n._("Transaction Start Date"),in_column:2,field:"transaction_start_date",basic_search:!0,adv_search:!0,form_item_type:FormItemType.DATE_PICKER}),new SearchField({label:s.i18n._("Transaction End Date"),in_column:2,field:"transaction_end_date",basic_search:!0,adv_search:!0,form_item_type:FormItemType.DATE_PICKER}),new SearchField({label:s.i18n._("Show Future Pay Periods"),in_column:2,field:"show_future_pay_periods",basic_search:!1,adv_search:!0,form_item_type:FormItemType.CHECKBOX}),new SearchField({label:s.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!0,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:s.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!0,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX})]}buildEditViewUI(){super.buildEditViewUI();var e=this,t={tab_pay_period:{label:s.i18n._("Pay Period")},tab_audit:!0};this.setTabModel(t),this.edit_only_mode||(this.navigation.AComboBox({id:this.script_name+"_navigation",api_class:TTAPI.APIPayPeriod,allow_multiple_selection:!1,layout_name:"global_Pay_period",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation());var r=this.edit_view_tab.find("#tab_pay_period"),a=r.find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(a);var i=Global.loadWidgetByName(FormItemType.COMBO_BOX);i.TComboBox({field:"status_id",set_empty:!1}),i.setSourceData(e.status_array),this.addEditFieldToColumn(s.i18n._("Status"),i,a,""),i=Global.loadWidgetByName(FormItemType.TEXT),i.TText({field:"pay_period_schedule"}),this.addEditFieldToColumn(s.i18n._("Pay Period Schedule"),i,a,"",null,!0),i=Global.loadWidgetByName(FormItemType.AWESOME_BOX),i.AComboBox({api_class:TTAPI.APIPayPeriodSchedule,allow_multiple_selection:!1,layout_name:"global_pay_period_schedule",show_search_inputs:!0,set_empty:!0,field:"pay_period_schedule_id"}),this.addEditFieldToColumn(s.i18n._("Pay Period Schedule"),i,a,"",null,!0),i=Global.loadWidgetByName(FormItemType.DATE_PICKER),i.TDatePicker({field:"start_date",mode:"date_time"}),this.addEditFieldToColumn(s.i18n._("Start Date"),i,a,"",null,!0),i=Global.loadWidgetByName(FormItemType.DATE_PICKER),i.TDatePicker({field:"end_date",mode:"date_time"}),this.addEditFieldToColumn(s.i18n._("End Date"),i,a,"",null,!0),i=Global.loadWidgetByName(FormItemType.DATE_PICKER),i.TDatePicker({field:"transaction_date",mode:"date_time"}),this.addEditFieldToColumn(s.i18n._("Transaction Date"),i,a,"",null,!0)}onFormItemChange(e,t){this.setIsChanged(e),this.setMassEditingFieldsWhenFormChange(e);var r=e.getField(),a=e.getValue();this.current_edit_record||(this.current_edit_record={}),this.current_edit_record[r]=a,r==="status_id"&&this.onStatusChange(),t||this.validate()}setDateColumnStatus(e,t){this.edit_view_ui_dic[e]&&(t?(this.edit_view_ui_dic[e].find("input").attr("disabled","disabled"),this.edit_view_ui_dic[e].find("img").unbind("click")):(this.edit_view_ui_dic[e].find("input").removeAttr("disabled"),this.edit_view_ui_dic[e].find("img").bind("click")))}onStatusChange(){this.current_edit_record&&this.current_edit_record.status_id==20?(this.setDateColumnStatus("start_date",!0),this.setDateColumnStatus("end_date",!0),this.setDateColumnStatus("transaction_date",!0)):(this.setDateColumnStatus("start_date",!1),this.setDateColumnStatus("end_date",!1),this.setDateColumnStatus("transaction_date",!1))}isEditChange(){this.current_edit_record&&this.current_edit_record.id?(this.attachElement("pay_period_schedule"),this.detachElement("pay_period_schedule_id")):this.is_mass_editing?(this.detachElement("pay_period_schedule"),this.detachElement("pay_period_schedule_id")):(this.detachElement("pay_period_schedule"),this.attachElement("pay_period_schedule_id")),this.editFieldResize()}setEditViewDataDone(){super.setEditViewDataDone(),this.onStatusChange(),this.isEditChange()}getValidSearchFilter(){var e=super.getValidSearchFilter();return Global.isSet(e.show_future_pay_periods)&&e.show_future_pay_periods.value===!1&&delete e.show_future_pay_periods,e}}u.loadSubView=function(n,e,t){Global.loadViewSource("PayPeriods","SubPayPeriodsView.html",function(r){var a={},i=o.template(r);Global.isSet(e)&&e(),Global.isSet(n)&&(n.html(i(a)),Global.isSet(t)&&TTPromise.wait("BaseViewController","initialize",function(){t(sub_pay_periods_view_controller)}))})};export{u as PayPeriodsViewController};
//# sourceMappingURL=PayPeriodsViewController-C2-4eYhX.bundle.js.map
