import{_ as c,j as e}from"./vendor-tTApdY0Y.bundle.js";class s extends BaseViewController{constructor(i={}){c.defaults(i,{el:"#pay_formula_policy_view_container",type_array:null,pay_type_array:null,wage_source_type_array:null}),super(i)}init(i){this.edit_view_tpl="PayFormulaPolicyEditView.html",this.permission_id="pay_formula_policy",this.viewId="PayFormulaPolicy",this.script_name="PayFormulaPolicyView",this.table_name_key="pay_formula_policy",this.context_menu_name=e.i18n._("Pay Formula Policy"),this.navigation_label=e.i18n._("Pay Formula Policy"),this.api=TTAPI.APIPayFormulaPolicy,this.render(),this.buildContextMenu(),this.initData()}initOptions(){this.initDropDownOption("pay_type"),this.initDropDownOption("wage_source_type")}buildEditViewUI(){super.buildEditViewUI();var i=this,l={tab_pay_formula_policy:{label:e.i18n._("Pay Formula Policy")},tab_audit:!0};this.setTabModel(l),this.navigation.AComboBox({api_class:TTAPI.APIPayFormulaPolicy,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_pay_code",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var o=this.edit_view_tab.find("#tab_pay_formula_policy"),a=o.find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(a);var t,_,r;t=Global.loadWidgetByName(FormItemType.TEXT_INPUT),t.TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn(e.i18n._("Name"),t,a,""),t.parent().width("45%"),t=Global.loadWidgetByName(FormItemType.TEXT_AREA),t.TTextArea({field:"description",width:"100%"}),this.addEditFieldToColumn(e.i18n._("Description"),t,a,"",null,null,!0),t.parent().width("45%"),t=Global.loadWidgetByName(FormItemType.COMBO_BOX),t.TComboBox({field:"pay_type_id",set_empty:!1}),t.setSourceData(i.pay_type_array),this.addEditFieldToColumn(e.i18n._("Pay Type"),t,a),t=Global.loadWidgetByName(FormItemType.COMBO_BOX),t.TComboBox({field:"wage_source_type_id",set_empty:!1}),t.setSourceData(i.wage_source_type_array),this.addEditFieldToColumn(e.i18n._("Wage Source"),t,a,"",null,!0),t=Global.loadWidgetByName(FormItemType.AWESOME_BOX),t.AComboBox({api_class:TTAPI.APIContributingShiftPolicy,allow_multiple_selection:!1,layout_name:"global_contributing_shift_policy",show_search_inputs:!0,set_empty:!0,field:"wage_source_contributing_shift_policy_id"}),this.addEditFieldToColumn(e.i18n._("Wage Source Contributing Shift Policy"),t,a,"",null,!0),t=Global.loadWidgetByName(FormItemType.AWESOME_BOX),t.AComboBox({api_class:TTAPI.APIContributingShiftPolicy,allow_multiple_selection:!1,layout_name:"global_contributing_shift_policy",show_search_inputs:!0,set_empty:!0,field:"time_source_contributing_shift_policy_id"}),this.addEditFieldToColumn(e.i18n._("Time Source Contributing Shift Policy"),t,a,"",null,!0),t=Global.loadWidgetByName(FormItemType.TEXT_INPUT),t.TTextInput({field:"average_days",width:65}),_=e("<div class='widget-h-box'></div>"),r=e("<span class='widget-right-label'> ("+e.i18n._("days")+")</span>"),_.append(t),_.append(r),this.addEditFieldToColumn(e.i18n._("Average Rate Over"),t,a,"",_,!0),t=Global.loadWidgetByName(FormItemType.TEXT_INPUT),t.TTextInput({field:"rate",width:65}),_=e("<div class='widget-h-box'></div>"),r=e("<span class='widget-right-label'> ("+e.i18n._("ie")+": "+e.i18n._("1.5 for time and a half")+")</span>"),_.append(t),_.append(r),this.addEditFieldToColumn(e.i18n._("Rate"),t,a,"",_,!0),t=Global.loadWidgetByName(FormItemType.AWESOME_BOX),t.AComboBox({api_class:TTAPI.APIWageGroup,allow_multiple_selection:!1,layout_name:"global_wage_group",show_search_inputs:!0,set_default:!0,field:"wage_group_id"}),this.addEditFieldToColumn(e.i18n._("Wage Group"),t,a,"",null,!0),t=Global.loadWidgetByName(FormItemType.AWESOME_BOX),t.AComboBox({api_class:TTAPI.APIAccrualPolicyAccount,allow_multiple_selection:!1,layout_name:"global_accrual_policy_account",show_search_inputs:!0,set_empty:!0,field:"accrual_policy_account_id"}),this.addEditFieldToColumn(e.i18n._("Accrual Account"),t,a,""),t=Global.loadWidgetByName(FormItemType.TEXT_INPUT),t.TTextInput({field:"accrual_rate",width:100}),this.addEditFieldToColumn(e.i18n._("Accrual Rate"),t,a,"",null,!0),Global.getProductEdition()>=15&&(t=Global.loadWidgetByName(FormItemType.TEXT_INPUT),t.TTextInput({field:"accrual_balance_threshold",mode:"time_unit",need_parser_sec:!0}),_=e("<div class='widget-h-box'></div>"),r=e("<span class='widget-right-label'> ("+e.i18n._("Maximum Balance")+")</span>"),_.append(t),_.append(r),this.addEditFieldToColumn(e.i18n._("Accrual Balance Threshold"),t,a,"",_,!0),t=Global.loadWidgetByName(FormItemType.AWESOME_BOX),t.AComboBox({api_class:TTAPI.APIAccrualPolicyAccount,allow_multiple_selection:!1,layout_name:"global_accrual_policy_account",show_search_inputs:!0,set_empty:!0,field:"accrual_balance_threshold_fallback_accrual_policy_account_id"}),this.addEditFieldToColumn(e.i18n._("Accrual Balance Threshold Fallback"),t,a,"",null,!0))}setCurrentEditRecordData(){this.setDefaultData({pay_type_id:10,wage_source_type_id:10});for(var i in this.current_edit_record)if(this.current_edit_record.hasOwnProperty(i)){var l=this.edit_view_ui_dic[i];if(Global.isSet(l))switch(i){default:l.setValue(this.current_edit_record[i]);break}}this.collectUIDataToCurrentEditRecord(),this.onAccrualRateChange(),this.onPayTypeChange(),this.onWageSourceTypeChange(),this.onAccrualAccountChange(),this.setEditViewDataDone()}onAccrualRateChange(){if(this.edit_view_form_item_dic.accrual_balance_threshold){var i;Math.sign(this.current_edit_record.accrual_rate)<0?i=e.i18n._("Minimum Balance"):i=e.i18n._("Maximum Balance"),this.edit_view_form_item_dic.accrual_balance_threshold.find(".widget-right-label").text("("+i+")")}}onPayTypeChange(){this.attachElement("rate"),this.detachElement("wage_group_id"),this.detachElement("wage_source_type_id"),this.detachElement("wage_source_contributing_shift_policy_id"),this.detachElement("time_source_contributing_shift_policy_id"),this.current_edit_record.pay_type_id==10?(this.edit_view_form_item_dic.rate.find(".edit-view-form-item-label").text(e.i18n._("Rate")),this.edit_view_form_item_dic.rate.find(".widget-right-label").text("("+e.i18n._("ie")+": "+e.i18n._("1.5 for time and a half")+")"),this.attachElement("wage_group_id"),this.attachElement("wage_source_type_id")):this.current_edit_record.pay_type_id==30||this.current_edit_record.pay_type_id==34||this.current_edit_record.pay_type_id==40?(this.edit_view_form_item_dic.rate.find(".edit-view-form-item-label").text(e.i18n._("Hourly Rate")),this.edit_view_form_item_dic.rate.find(".widget-right-label").text("("+e.i18n._("ie")+": "+e.i18n._("10.00/hr")+")"),this.attachElement("wage_group_id"),this.attachElement("wage_source_type_id")):this.current_edit_record.pay_type_id==50?(this.edit_view_form_item_dic.rate.find(".edit-view-form-item-label").text(e.i18n._("Premium")),this.edit_view_form_item_dic.rate.find(".widget-right-label").text("("+e.i18n._("ie")+": "+e.i18n._("0.75 for 75 cent/hr")+")"),this.attachElement("wage_group_id"),this.attachElement("wage_source_type_id")):this.current_edit_record.pay_type_id==32?(this.edit_view_form_item_dic.rate.find(".edit-view-form-item-label").text(e.i18n._("Hourly Rate")),this.edit_view_form_item_dic.rate.find(".widget-right-label").text("("+e.i18n._("ie")+": "+e.i18n._("10.00/hr")+")")):this.current_edit_record.pay_type_id==42?(this.edit_view_form_item_dic.rate.find(".edit-view-form-item-label").text(e.i18n._("Hourly Rate")),this.edit_view_form_item_dic.rate.find(".widget-right-label").text("("+e.i18n._("ie")+": "+e.i18n._("10.00/hr")+")"),this.attachElement("wage_group_id"),this.attachElement("wage_source_type_id")):this.current_edit_record.pay_type_id==60?(this.edit_view_form_item_dic.rate.find(".edit-view-form-item-label").text(e.i18n._("Daily Rate")),this.edit_view_form_item_dic.rate.find(".widget-right-label").text("("+e.i18n._("ie")+": "+e.i18n._("100.00/day")+")"),this.attachElement("wage_group_id")):this.current_edit_record.pay_type_id==70?this.detachElement("rate"):this.current_edit_record.pay_type_id==200&&(this.edit_view_form_item_dic.rate.find(".edit-view-form-item-label").text(e.i18n._("Piece Rate")),this.edit_view_form_item_dic.rate.find(".widget-right-label").text("("+e.i18n._("ie")+": "+e.i18n._("$1.00 per Good Quantity")+")")),this.editFieldResize(),this.onWageSourceTypeChange()}onWageSourceTypeChange(){this.detachElement("wage_source_contributing_shift_policy_id"),this.detachElement("time_source_contributing_shift_policy_id"),this.detachElement("wage_group_id"),this.detachElement("average_days"),this.edit_view_form_item_dic.wage_source_type_id.css("display")==="block"?this.current_edit_record.wage_source_type_id==10?this.attachElement("wage_group_id"):this.current_edit_record.wage_source_type_id==30&&(this.attachElement("wage_source_contributing_shift_policy_id"),this.attachElement("time_source_contributing_shift_policy_id")):this.current_edit_record.pay_type_id==60?this.attachElement("wage_group_id"):this.current_edit_record.pay_type_id==70&&(this.attachElement("wage_source_contributing_shift_policy_id"),this.attachElement("time_source_contributing_shift_policy_id"),this.attachElement("average_days")),this.editFieldResize()}onAccrualAccountChange(){this.current_edit_record.accrual_policy_account_id===!1||typeof this.current_edit_record.accrual_policy_account_id>"u"||this.current_edit_record.accrual_policy_account_id==TTUUID.zero_id?(this.detachElement("accrual_rate"),this.detachElement("accrual_balance_threshold"),this.detachElement("accrual_balance_threshold_fallback_accrual_policy_account_id")):(this.attachElement("accrual_rate"),this.attachElement("accrual_balance_threshold"),this.attachElement("accrual_balance_threshold_fallback_accrual_policy_account_id")),this.editFieldResize()}onFormItemChange(i){this.is_changed=!0,this.setMassEditingFieldsWhenFormChange(i);var l=i.getField(),o=i.getValue();this.current_edit_record[l]=o,l==="accrual_rate"&&this.onAccrualRateChange(),l==="pay_type_id"&&this.onPayTypeChange(),l==="wage_source_type_id"&&this.onWageSourceTypeChange(),l==="accrual_policy_account_id"&&this.onAccrualAccountChange(),this.validate()}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:e.i18n._("Name"),in_column:1,field:"name",multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:e.i18n._("Pay Type"),in_column:1,field:"pay_type_id",multiple:!0,basic_search:!0,adv_search:!1,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:e.i18n._("Deposit to Accrual Policy"),in_column:1,field:"accrual_policy_account_id",layout_name:"global_accrual_policy_account",api_class:TTAPI.APIAccrualPolicyAccount,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:e.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:e.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX})]}}export{s as PayFormulaPolicyViewController};
//# sourceMappingURL=PayFormulaPolicyViewController-B3_aqaij.bundle.js.map
