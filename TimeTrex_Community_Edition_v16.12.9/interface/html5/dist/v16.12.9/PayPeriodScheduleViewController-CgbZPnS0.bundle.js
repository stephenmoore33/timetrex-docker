import{_ as l,j as t}from"./vendor-tTApdY0Y.bundle.js";class c extends BaseViewController{constructor(i={}){l.defaults(i,{el:"#pay_period_schedule_view_container",user_preference_api:null,type_array:null,pay_period_starts_on_array:null,start_week_day_array:null,transaction_date_array:null,transaction_date_business_day_array:null,time_zone_array:null,shift_assigned_day_array:null,timesheet_verify_type_array:null,sub_pay_periods_view_controller:null}),super(i)}init(i){this.edit_view_tpl="PayPeriodScheduleEditView.html",this.permission_id="pay_period_schedule",this.viewId="PayPeriodSchedule",this.script_name="PayPeriodScheduleView",this.table_name_key="pay_period_schedule",this.context_menu_name=t.i18n._("Pay Period Schedule"),this.navigation_label=t.i18n._("Pay Period Schedule"),this.api=TTAPI.APIPayPeriodSchedule,this.user_preference_api=TTAPI.APIUserPreference,this.render(),this.buildContextMenu(),this.initData()}getCustomContextMenuModel(){var i={exclude:["copy","mass_edit"],include:[]};return i}openEditView(i){Global.setUINotready(),TTPromise.add("init","init"),TTPromise.wait();var r=this;r.edit_only_mode?r.initOptions(function(o){r.edit_view||r.initEditViewUI(r.viewId,r.edit_view_tpl),r.getPayPeriodScheduleData(i,function(d){r.current_edit_record=d,r.initEditView()})}):this.edit_view||this.initEditViewUI(r.viewId,r.edit_view_tpl)}getPayPeriodScheduleData(i,r){var o={};o.filter_data={},o.filter_data.id=[i],this.api["get"+this.api.key_name](o,{onResult:function(d){var e=d.getResult();e||(e=[]),e=e[0],r(e)}})}initOptions(i){var r=this,o=[{option_name:"type"},{option_name:"transaction_date"},{option_name:"transaction_date_business_day"},{option_name:"shift_assigned_day"},{option_name:"time_zone",field_name:"",api:this.user_preference_api},{option_name:"timesheet_verify_type"},{option_name:"start_week_day"}];this.initDropDownOptions(o,function(d){r.transaction_date_array=Global.addLastItemToArray(r.transaction_date_array,-1,t.i18n._("- Last Day Of Month -")),r.user_preference_api.getOptions("start_week_day",{onResult:function(e){var a=e.getResult();r.pay_period_starts_on_array=Global.buildRecordArray(a),i&&i(a)}})})}initSubPayPeriodsView(){var i=this;if(!this.current_edit_record.id){TTPromise.resolve("BaseViewController","onTabShow");return}if(this.sub_pay_periods_view_controller){this.sub_pay_periods_view_controller.buildContextMenu(!0),this.sub_pay_periods_view_controller.setDefaultMenu(),i.sub_pay_periods_view_controller.parent_value=i.current_edit_record.id,i.sub_pay_periods_view_controller.parent_edit_record=i.current_edit_record,i.sub_pay_periods_view_controller.initData();return}Global.loadScript("views/payroll/pay_periods/PayPeriodsViewController.js",function(){var d=i.edit_view_tab.find("#tab_pay_period"),e=d.find(".first-column-sub-view");Global.trackView("SubPayPeriodsView"),PayPeriodsViewController.loadSubView(e,r,o)});function r(){}function o(d){i.sub_pay_periods_view_controller=d,i.sub_pay_periods_view_controller.parent_key="pay_period_schedule_id",i.sub_pay_periods_view_controller.parent_value=i.current_edit_record.id,i.sub_pay_periods_view_controller.parent_edit_record=i.current_edit_record,i.sub_pay_periods_view_controller.parent_view_controller=i,i.sub_pay_periods_view_controller.initData()}}onFormItemChange(i,r){this.setIsChanged(i),this.setMassEditingFieldsWhenFormChange(i);var o=i.getField(),d=i.getValue();this.current_edit_record[o]=d,o=="type_id"?this.onTypeChange():o=="start_day_of_week"&&(!this.current_edit_record||!this.current_edit_record.id)?(this.edit_view_ui_dic.start_week_day_id.setValue(this.edit_view_ui_dic.start_day_of_week.getValue()),this.current_edit_record.start_week_day_id=this.edit_view_ui_dic.start_day_of_week.getValue()):o=="timesheet_verify_type_id"&&this.onVerifyTypeChange(),r||this.validate()}removeEditView(){super.removeEditView(),this.sub_pay_periods_view_controller=null}onVerifyTypeChange(){this.current_edit_record.timesheet_verify_type_id==10?(this.detachElement("timesheet_verify_before_end_date"),this.detachElement("timesheet_verify_before_transaction_date"),this.detachElement("timesheet_verify_agreement")):(this.attachElement("timesheet_verify_before_end_date"),this.attachElement("timesheet_verify_before_transaction_date"),this.attachElement("timesheet_verify_agreement")),this.editFieldResize()}onTypeChange(){this.current_edit_record.type_id==5?this.detachElement("anchor_date"):this.current_edit_record.id?this.detachElement("anchor_date"):this.attachElement("anchor_date"),this.current_edit_record.type_id==5?(this.detachElement("primary"),this.detachElement("primary_day_of_month"),this.detachElement("primary_transaction_day_of_month"),this.detachElement("secondary"),this.detachElement("secondary_day_of_month"),this.detachElement("secondary_transaction_day_of_month"),this.attachElement("annual_pay_periods"),this.detachElement("start_day_of_week"),this.detachElement("transaction_date"),this.detachElement("transaction_date_bd")):this.current_edit_record.type_id==10||this.current_edit_record.type_id==20||this.current_edit_record.type_id==100||this.current_edit_record.type_id==200?(this.detachElement("primary"),this.detachElement("primary_day_of_month"),this.detachElement("primary_transaction_day_of_month"),this.detachElement("secondary"),this.detachElement("secondary_day_of_month"),this.detachElement("secondary_transaction_day_of_month"),this.detachElement("annual_pay_periods"),this.attachElement("start_day_of_week"),this.attachElement("transaction_date"),this.attachElement("transaction_date_bd")):this.current_edit_record.type_id==30?(this.attachElement("primary"),this.attachElement("primary_day_of_month"),this.attachElement("primary_transaction_day_of_month"),this.attachElement("secondary"),this.attachElement("secondary_day_of_month"),this.attachElement("secondary_transaction_day_of_month"),this.detachElement("annual_pay_periods"),this.detachElement("start_day_of_week"),this.detachElement("transaction_date"),this.attachElement("transaction_date_bd")):this.current_edit_record.type_id==50&&(this.attachElement("primary"),this.attachElement("primary_day_of_month"),this.attachElement("primary_transaction_day_of_month"),this.detachElement("secondary"),this.detachElement("secondary_day_of_month"),this.detachElement("secondary_transaction_day_of_month"),this.detachElement("annual_pay_periods"),this.detachElement("start_day_of_week"),this.detachElement("transaction_date"),this.attachElement("transaction_date_bd")),this.editFieldResize()}setCurrentEditRecordData(){for(var i in this.current_edit_record){var r=this.edit_view_ui_dic[i];if(Global.isSet(r))switch(i){default:r.setValue(this.current_edit_record[i]);break}}this.onTypeChange(),this.onVerifyTypeChange(),this.collectUIDataToCurrentEditRecord(),this.setEditViewDataDone()}buildEditViewUI(){super.buildEditViewUI();var i=this,r={tab_pay_period_schedule:{label:t.i18n._("Pay Period Schedule")},tab_advanced:{label:t.i18n._("Advanced")},tab_pay_period:{label:t.i18n._("Pay Periods"),init_callback:"initSubPayPeriodsView",display_on_mass_edit:!1},tab_audit:!0};this.setTabModel(r),this.edit_only_mode||(this.navigation.AComboBox({id:this.script_name+"_navigation",api_class:TTAPI.APIPayPeriodSchedule,allow_multiple_selection:!1,layout_name:"global_pay_period_schedule",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation());var o=this.edit_view_tab.find("#tab_pay_period_schedule"),d=o.find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(d);var e,a,_;e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn(t.i18n._("Name"),e,d,""),e.parent().width("45%"),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"description",width:"100%"}),this.addEditFieldToColumn(t.i18n._("Description"),e,d),e.parent().width("45%"),e=Global.loadWidgetByName(FormItemType.SEPARATED_BOX),e.SeparatedBox({label:t.i18n._("Pay Period Dates")}),this.addEditFieldToColumn(null,e,d),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"type_id"}),e.setSourceData(i.type_array),this.addEditFieldToColumn(t.i18n._("Type"),e,d),e=Global.loadWidgetByName(FormItemType.SEPARATED_BOX),e.SeparatedBox({label:t.i18n._("Primary")}),this.addEditFieldToColumn(null,e,d,"",null,!0,!1,"primary"),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"primary_day_of_month"}),a=t("<div class='widget-h-box'></div>"),_=t("<span class='widget-right-label'> "+t.i18n._("at 00:00")+"</span>"),a.append(e),a.append(_),e.setSourceData(i.transaction_date_array),this.addEditFieldToColumn(t.i18n._("Pay Period Start Day of Month"),e,d,"",a,!0),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"primary_transaction_day_of_month"}),e.setSourceData(i.transaction_date_array),this.addEditFieldToColumn(t.i18n._("Transaction Day Of Month"),e,d,"",null,!0),e=Global.loadWidgetByName(FormItemType.SEPARATED_BOX),e.SeparatedBox({label:t.i18n._("Secondary")}),this.addEditFieldToColumn(null,e,d,"",null,!0,!1,"secondary"),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"secondary_day_of_month"}),a=t("<div class='widget-h-box'></div>"),_=t("<span class='widget-right-label'> "+t.i18n._("at 00:00")+"</span>"),a.append(e),a.append(_),e.setSourceData(i.transaction_date_array),this.addEditFieldToColumn(t.i18n._("Pay Period Start Day of Month"),e,d,"",a,!0),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"secondary_transaction_day_of_month"}),e.setSourceData(i.transaction_date_array),this.addEditFieldToColumn(t.i18n._("Transaction Day Of Month"),e,d,"",null,!0),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"annual_pay_periods"}),this.addEditFieldToColumn(t.i18n._("Annual Pay Periods"),e,d,"",null,!0),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"start_day_of_week"}),a=t("<div class='widget-h-box'></div>"),_=t("<span class='widget-right-label'> "+t.i18n._("at 00:00")+"</span>"),a.append(e),a.append(_),e.setSourceData(i.pay_period_starts_on_array),this.addEditFieldToColumn(t.i18n._("Pay Period Starts On"),e,d,"",a,!0),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"transaction_date"}),a=t("<div class='widget-h-box'></div>"),_=t("<span class='widget-right-label'> ( "+t.i18n._("days after end of pay period")+" )</span>"),a.append(e),a.append(_),e.setSourceData(i.transaction_date_array),this.addEditFieldToColumn(t.i18n._("Transaction Date"),e,d,"",a,!0),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"transaction_date_bd"}),e.setSourceData(i.transaction_date_business_day_array),this.addEditFieldToColumn(t.i18n._("Transaction Always on Business Day"),e,d,"",null,!0),e=Global.loadWidgetByName(FormItemType.DATE_PICKER),e.TDatePicker({field:"anchor_date"}),this.addEditFieldToColumn(t.i18n._("Create Initial Pay Periods From"),e,d,"",null,!0),e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIUser,allow_multiple_selection:!0,layout_name:"global_user",show_search_inputs:!0,set_empty:!0,field:"user"}),this.addEditFieldToColumn(t.i18n._("Employees"),e,d);var s=this.edit_view_tab.find("#tab_advanced"),n=s.find(".first-column");this.edit_view_tabs[1]=[],this.edit_view_tabs[1].push(n),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"start_week_day_id"}),e.setSourceData(i.start_week_day_array),this.addEditFieldToColumn(t.i18n._("Overtime Week"),e,n,""),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"time_zone",set_empty:!0}),e.setSourceData(i.time_zone_array),this.addEditFieldToColumn(t.i18n._("Time Zone"),e,n),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"new_day_trigger_time",mode:"time_unit",need_parser_sec:!0}),a=t("<div class='widget-h-box'></div>"),_=t("<span class='widget-right-label'>( "+t.i18n._("only for shifts that span midnight")+" )</span>"),a.append(e),a.append(_),this.addEditFieldToColumn(t.i18n._("Minimum Time-Off Between Shifts"),e,n,"",a),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"maximum_shift_time",mode:"time_unit",need_parser_sec:!0}),this.addEditFieldToColumn(t.i18n._("Maximum Shift Time"),e,n,"",null),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"shift_assigned_day_id"}),e.setSourceData(i.shift_assigned_day_array),this.addEditFieldToColumn(t.i18n._("Assign Shifts To"),e,n),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"create_days_in_advance",width:50}),a=t("<div class='widget-h-box'></div>"),_=t("<span class='widget-right-label'> "+t.i18n._("( days in advance )")+"</span>"),a.append(e),a.append(_),this.addEditFieldToColumn(t.i18n._("Create Pay Periods"),e,n,"",a),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"auto_close_after_days",width:50}),a=t("<div class='widget-h-box'></div>"),_=t("<span class='widget-right-label'> "+t.i18n._("( days after transaction date )")+"</span>"),a.append(e),a.append(_),this.addEditFieldToColumn(t.i18n._("Auto Close"),e,n,"",a),e=Global.loadWidgetByName(FormItemType.SEPARATED_BOX),e.SeparatedBox({label:t.i18n._("TimeSheet Verification")}),this.addEditFieldToColumn(null,e,n),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"timesheet_verify_type_id"}),e.setSourceData(i.timesheet_verify_type_array),this.addEditFieldToColumn(t.i18n._("TimeSheet Verification"),e,n),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"timesheet_verify_before_end_date",width:30}),a=t("<div class='widget-h-box'></div>"),_=t("<span class='widget-right-label'>"+t.i18n._("Day(s)")+" ("+t.i18n._("Before Pay Period End Date")+" )</span>"),a.append(e),a.append(_),this.addEditFieldToColumn(t.i18n._("Verification Window Starts"),e,n,"",a,!0),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"timesheet_verify_before_transaction_date",width:30}),a=t("<div class='widget-h-box'></div>"),_=t("<span class='widget-right-label'>"+t.i18n._("Day(s)")+" ("+t.i18n._("Before Pay Period Transaction Date")+" )</span>"),a.append(e),a.append(_),this.addEditFieldToColumn(t.i18n._("Verification Window Ends"),e,n,"",a,!0),Global.getProductEdition()>=15&&(e=Global.loadWidgetByName(FormItemType.TEXT_AREA),e.TTextArea({field:"timesheet_verify_agreement",width:"100%",rows:10}),this.addEditFieldToColumn(t.i18n._("Agreement"),e,n,"",null,!0,!0,!0),e.parent().width("45%"))}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:t.i18n._("Name"),in_column:1,field:"name",basic_search:!0,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:t.i18n._("Type"),in_column:1,field:"type_id",multiple:!0,basic_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:t.i18n._("Description"),in_column:1,field:"description",basic_search:!0,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:t.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:t.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX})]}}export{c as PayPeriodScheduleViewController};
//# sourceMappingURL=PayPeriodScheduleViewController-CgbZPnS0.bundle.js.map
