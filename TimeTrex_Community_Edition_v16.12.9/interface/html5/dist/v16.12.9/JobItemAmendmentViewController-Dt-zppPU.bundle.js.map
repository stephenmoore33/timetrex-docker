{"version":3,"file":"JobItemAmendmentViewController-Dt-zppPU.bundle.js","sources":["../../views/attendance/job_item_amendment/JobItemAmendmentViewController.js"],"sourcesContent":["export class JobItemAmendmentViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#job_item_amendment_view_container',\n\n\n\t\t\tcurrent_default_record: {}\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'JobItemAmendmentEditView.html';\n\t\tthis.permission_id = 'job_item';\n\t\tthis.viewId = 'JobItemAmendment';\n\t\tthis.script_name = 'JobItemAmendmentView';\n\t\tthis.table_name_key = 'job_item_amendment';\n\t\tthis.context_menu_name = $.i18n._( 'Task Amendments' );\n\t\tthis.navigation_label = $.i18n._( 'Task Amendment' );\n\n\t\tthis.api = TTAPI.APIJobItemAmendment;\n\n\t\tthis.job_api = TTAPI.APIJob;\n\t\tthis.job_item_api = TTAPI.APIJobItem;\n\n\t\tthis.render();\n\t\tthis.buildContextMenu();\n\n\t\t//Issue #3197 - Attendance -> Jobs, edit a job, go to \"Task Amendments\" would then show all task amendments on occasion.\n\t\t//This is because when loading the sub view (Task Amendments) an API call is made with the proper filter data, but also\n\t\t//when this view is loaded the same API call is made again with no filter data from initData(). This causes the API to return all task amendments.\n\t\t//In other words two API calls would be made and depending on which one finishes first, that data would be loaded.\n\t\tif ( !this.sub_view_mode ) {\n\t\t\tthis.initData();\n\t\t}\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\texclude: ['copy'],\n\t\t\tinclude: []\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_task_amendment': { 'label': $.i18n._( 'Task Amendment' ) },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIJobItemAmendment,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_job_item_amendment',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_task_amendment = this.edit_view_tab.find( '#tab_task_amendment' );\n\n\t\tvar tab_task_amendment_column1 = tab_task_amendment.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_task_amendment_column1 );\n\n\t\tvar form_item_input;\n\t\tvar widgetContainer;\n\t\tvar label;\n\n\t\t//Job\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIJob,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_job',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: false,\n\t\t\tsetRealValueCallBack: ( function( val ) {\n\n\t\t\t\tif ( val ) {\n\t\t\t\t\tjob_coder.setValue( val.manual_id );\n\t\t\t\t}\n\t\t\t} ),\n\t\t\tfield: 'job_id'\n\t\t} );\n\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\tvar job_coder = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tjob_coder.TTextInput( { field: 'job_quick_search', disable_keyup_event: true } );\n\t\tjob_coder.addClass( 'job-coder' );\n\n\t\twidgetContainer.append( job_coder );\n\t\twidgetContainer.append( form_item_input );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Job' ), [form_item_input, job_coder], tab_task_amendment_column1, '', widgetContainer );\n\n\t\t// Task\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIJobItem,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_job_item',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tsetRealValueCallBack: ( function( val ) {\n\n\t\t\t\tif ( val ) {\n\t\t\t\t\tjob_item_coder.setValue( val.manual_id );\n\t\t\t\t}\n\t\t\t} ),\n\t\t\tfield: 'item_id'\n\t\t} );\n\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\tvar job_item_coder = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tjob_item_coder.TTextInput( { field: 'job_item_quick_search', disable_keyup_event: true } );\n\t\tjob_item_coder.addClass( 'job-coder' );\n\n\t\twidgetContainer.append( job_item_coder );\n\t\twidgetContainer.append( form_item_input );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Task' ), [form_item_input, job_item_coder], tab_task_amendment_column1, '', widgetContainer );\n\n\t\t//Estimated Time\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'estimate_time', mode: 'time_unit', need_parser_sec: true } );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Estimated Time' ), form_item_input, tab_task_amendment_column1, '', null, true, true );\n\n\t\t//Billable Rate\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'billable_rate', width: 86 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Billable Rate' ), form_item_input, tab_task_amendment_column1 );\n\n\t\t//Minimum Time\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'minimum_time', mode: 'time_unit', need_parser_sec: true } );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Minimum Billable Time' ), form_item_input, tab_task_amendment_column1, '', null );\n\n\t\t//Estimated Quantity\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'estimate_quantity', width: 150 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Estimated Quantity' ), form_item_input, tab_task_amendment_column1 );\n\n\t\t//Estimated Bad Quantity\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'estimate_bad_quantity', width: 150 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Estimated Bad Quantity' ), form_item_input, tab_task_amendment_column1 );\n\n\t\t//Bad Quantity Rate\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'bad_quantity_rate', width: 150 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Bad Quantity Rate' ), form_item_input, tab_task_amendment_column1 );\n\t}\n\n\t/* jshint ignore:start */\n\tsetCurrentEditRecordData() {\n\t\t//Set current edit record data to all widgets\n\n\t\tif ( Global.isFalseOrNull( this.current_edit_record['user_id'] ) ) {\n\t\t\tthis.current_edit_record['user_id'] = LocalCacheData.getLoginUser().id;\n\t\t}\n\n\t\tfor ( var key in this.current_edit_record ) {\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\tif ( Global.isSet( widget ) ) {\n\t\t\t\tswitch ( key ) {\n\t\t\t\t\tcase 'item_id':\n\t\t\t\t\t\tvar args = {};\n\t\t\t\t\t\targs.filter_data = { job_id: this.current_edit_record.job_id };\n\t\t\t\t\t\twidget.setDefaultArgs( args );\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'job_quick_search':\n//\t\t\t\t\t\twidget.setValue( this.current_edit_record['job_id'] ? this.current_edit_record['job_id'] : 0 );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'job_item_quick_search':\n//\t\t\t\t\t\twidget.setValue( this.current_edit_record['item_id'] ? this.current_edit_record['item_id'] : 0 );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif ( Global.isSet( this.current_default_record[key] ) ) {\n\t\t\t\t\t\t\tthis.current_edit_record[key] = this.current_default_record[key];\n\t\t\t\t\t\t}\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tthis.collectUIDataToCurrentEditRecord();\n\t\tthis.setEditViewDataDone();\n\t}\n\n\tsetEditViewDataDone() {\n\t\tthis.current_default_record = {};\n\t\tsuper.setEditViewDataDone();\n\t}\n\n\t/* jshint ignore:start */\n\tonFormItemChange( target, doNotValidate ) {\n\t\tvar $this = this;\n\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\n\t\tvar key = target.getField();\n\t\tvar c_value = target.getValue();\n\n\t\tthis.current_edit_record[key] = c_value;\n\n\t\tvar amount_arr = false;\n\n\t\tswitch ( key ) {\n\t\t\tcase 'job_id':\n\t\t\t\tthis.edit_view_ui_dic['job_quick_search'].setValue( target.getValue( true ) ? ( target.getValue( true ).manual_id ? target.getValue( true ).manual_id : '' ) : '' );\n\t\t\t\tthis.setJobItemValueWhenJobChanged( target.getValue( true ), 'item_id', { job_id: $this.current_edit_record.job_id } );\n\t\t\t\tthis.edit_view_ui_dic['job_quick_search'].setCheckBox( true );\n\t\t\t\tbreak;\n\t\t\tcase 'item_id':\n\t\t\t\tthis.edit_view_ui_dic['job_item_quick_search'].setValue( target.getValue( true ) ? ( target.getValue( true ).manual_id ? target.getValue( true ).manual_id : '' ) : '' );\n\t\t\t\tthis.setJobItemAmendmentDefaultData();\n\t\t\t\tthis.edit_view_ui_dic['job_item_quick_search'].setCheckBox( true );\n\t\t\t\tbreak;\n\t\t\tcase 'job_quick_search':\n\t\t\tcase 'job_item_quick_search':\n\t\t\t\tthis.onJobQuickSearch( key, c_value, 'job_id', 'item_id' );\n\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'onJobQuickSearch', function() {\n\t\t\t\t\t$this.setJobItemAmendmentDefaultData();\n\t\t\t\t} );\n\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'setJobItemValueWhenJobChanged', function() {\n\t\t\t\t\t$this.setJobItemAmendmentDefaultData();\n\t\t\t\t} );\n\n\t\t\t\t//Don't validate immediately as onJobQuickSearch is doing async API calls, and it would cause a guaranteed validation failure.\n\t\t\t\tvar doNotValidate = true;\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( !doNotValidate ) {\n\t\t\tthis.validate();\n\t\t}\n\t}\n\n\tvalidate() {\n\n\t\tvar $this = this;\n\n\t\tvar record = {};\n\n\t\tif ( this.is_mass_editing ) {\n\n\t\t\tif ( $this.sub_view_mode && $this.parent_key ) {\n\t\t\t\trecord[$this.parent_key] = $this.parent_value;\n\t\t\t}\n\n\t\t\tfor ( var key in this.edit_view_ui_dic ) {\n\n\t\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tvar widget = this.edit_view_ui_dic[key];\n\n\t\t\t\tif ( Global.isSet( widget.isChecked ) ) {\n\t\t\t\t\tif ( widget.isChecked() && widget.getEnabled() ) {\n\t\t\t\t\t\trecord[key] = widget.getValue();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else {\n\t\t\trecord = this.current_edit_record;\n\t\t}\n\n\t\trecord = this.uniformVariable( record );\n\n\t\tthis.api['validate' + this.api.key_name]( record, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.validateResult( result );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tsetJobItemAmendmentDefaultData() {\n\t\tvar $this = this;\n\t\tvar job_item_id;\n\t\tif ( TTUUID.isUUID( this.current_edit_record.item_id ) && this.current_edit_record.item_id != TTUUID.zero_id && this.is_add ) {\n\t\t\tjob_item_id = this.current_edit_record.item_id;\n\t\t\tthis.api['get' + this.api.key_name + 'DefaultData']( job_item_id, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\tvar result_data = result.getResult();\n\t\t\t\t\tif ( !result_data ) {\n\t\t\t\t\t\tresult_data = [];\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.current_default_record = result_data;\n\t\t\t\t\t$this.setCurrentEditRecordData();\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\t/* jshint ignore:end */\n\n}\n\nJobItemAmendmentViewController.loadSubView = function( container, beforeViewLoadedFun, afterViewLoadedFun ) {\n\n\tGlobal.loadViewSource( 'JobItemAmendment', 'SubJobItemAmendmentView.html', function( result ) {\n\t\tvar args = {};\n\t\tvar template = _.template( result );\n\n\t\tif ( Global.isSet( beforeViewLoadedFun ) ) {\n\t\t\tbeforeViewLoadedFun();\n\t\t}\n\n\t\tif ( Global.isSet( container ) ) {\n\t\t\tcontainer.html( template( args ) );\n\t\t\tif ( Global.isSet( afterViewLoadedFun ) ) {\n\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'initialize', function() {\n\t\t\t\t\tafterViewLoadedFun( sub_job_item_amendment_view_controller );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t} );\n};\n"],"names":["JobItemAmendmentViewController","options","_","$","context_menu_model","tab_model","tab_task_amendment","tab_task_amendment_column1","form_item_input","widgetContainer","val","job_coder","job_item_coder","key","widget","args","target","doNotValidate","$this","c_value","record","result","job_item_id","result_data","container","beforeViewLoadedFun","afterViewLoadedFun","template"],"mappings":"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"}