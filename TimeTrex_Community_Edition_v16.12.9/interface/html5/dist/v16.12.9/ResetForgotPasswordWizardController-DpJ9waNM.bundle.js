import{_ as d,j as r}from"./vendor-tTApdY0Y.bundle.js";class c extends BaseWizardController{constructor(t={}){d.defaults(t,{el:".wizard"}),super(t)}init(){this.title=r.i18n._("Reset Password"),this.steps=1,this.current_step=1,this.default_data&&typeof this.default_data.api_class<"u"?this.api=this.default_data.api_class:this.api=TTAPI.APIAuthentication,this.render()}render(){super.render(),this.initCurrentStep()}buildCurrentStepUI(){var t=this;switch(this.content_div.empty(),this.stepsWidgetDic[this.current_step]={},this.current_step){case 1:var e=this.getLabel();e.text(r.i18n._("Please specify your new password")),this.content_div.append(e);var s=r(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html")),i=s.find(".form-item-label"),a=s.find(".form-item-input-div"),n=this.getPasswordInput("new_password");i.text(r.i18n._("New Password")),a.append(n),this.content_div.append(s),s=r(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html")),i=s.find(".form-item-label"),a=s.find(".form-item-input-div");var o=this.getPasswordInput("confirm_password");i.text(r.i18n._("New Password (Confirm)")),a.unbind("keydown").bind("keydown",function(l){l.keyCode===13&&t.onDoneClick()}),a.append(o),this.content_div.append(s),this.stepsWidgetDic[this.current_step][n.getField()]=n,this.stepsWidgetDic[this.current_step][o.getField()]=o;break}}saveCurrentStep(){this.stepsDataDic[this.current_step]={};var t=this.stepsDataDic[this.current_step],e=this.stepsWidgetDic[this.current_step];switch(this.current_step){default:for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s].getValue());break}}buildCurrentStepData(){}onCloseClick(){r(this.el).remove(),LocalCacheData.current_open_wizard_controllers=LocalCacheData.current_open_wizard_controllers.filter(s=>s.wizard_id!==this.wizard_id),LocalCacheData.extra_filter_for_next_open_view=null;var t=Global.getBaseURL();if(t=t+"#!m=Login",LocalCacheData.getAllURLArgs())for(var e in LocalCacheData.getAllURLArgs())e!=="m"&&e!=="sm"&&e!=="key"&&(t=t+"&"+e+"="+LocalCacheData.getAllURLArgs()[e]);Global.setURLToBrowser(t)}onDoneClick(){var t=this;super.onDoneClick(),this.saveCurrentStep();var e=this.stepsDataDic[1].new_password,s=this.stepsDataDic[1].confirm_password;this.stepsWidgetDic[1].new_password.clearErrorStyle(),this.stepsWidgetDic[1].confirm_password.clearErrorStyle(),typeof LocalCacheData.getAllURLArgs().key>"u"?this.stepsWidgetDic[1].confirm_password.setErrorStyle(r.i18n._("Password reset key is invalid, please try resetting your password again (u)"),!0):e?e!==s?this.stepsWidgetDic[1].confirm_password.setErrorStyle(r.i18n._("New password does not match"),!0):this.api.passwordReset(LocalCacheData.getAllURLArgs().key,e,s,{onResult:function(i){i.isValid()?(t.onCloseClick(),t.call_back&&t.call_back()):TAlertManager.showErrorAlert(i)}}):this.stepsWidgetDic[1].new_password.setErrorStyle(r.i18n._("New password can't be empty"),!0)}}c.type="";export{c as ResetForgotPasswordWizardController};
//# sourceMappingURL=ResetForgotPasswordWizardController-DpJ9waNM.bundle.js.map
