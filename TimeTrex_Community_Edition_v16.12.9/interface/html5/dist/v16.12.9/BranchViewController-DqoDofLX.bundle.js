import{_ as c,j as i}from"./vendor-tTApdY0Y.bundle.js";class m extends BaseViewController{constructor(t={}){c.defaults(t,{el:"#branch_view_container",status_array:null,country_array:null,province_array:null,e_province_array:null,user_group_selection_type_id_array:null,user_title_selection_type_id_array:null,user_default_branch_selection_type_id_array:null,user_default_department_selection_type_id_array:null,user_group_array:null,company_api:null}),super(t)}init(t){this.edit_view_tpl="BranchEditView.html",this.permission_id="branch",this.viewId="Branch",this.script_name="BranchView",this.table_name_key="branch",this.context_menu_name=i.i18n._("Branch"),this.navigation_label=i.i18n._("Branch"),this.api=TTAPI.APIBranch,this.company_api=TTAPI.APICompany,Global.getProductEdition()>=20&&(this.user_group_api=TTAPI.APIUserGroup),this.render(),this.buildContextMenu(),this.initData()}initOptions(){var t=this;let o=[{option_name:"status",api:this.api},{option_name:"country",field_name:"country",api:this.company_api}];Global.getProductEdition()>=20&&(o.push({option_name:"user_group_selection_type_id",api:this.api},{option_name:"user_title_selection_type_id",api:this.api},{option_name:"user_default_branch_selection_type_id",api:this.api},{option_name:"user_default_department_selection_type_id",api:this.api}),this.user_group_api.getUserGroup("",!1,!1,{onResult:function(e){e=e.getResult(),e=Global.buildTreeRecord(e),t.user_group_array=e}})),this.initDropDownOptions(o)}getCustomContextMenuModel(){var t={exclude:[],include:[{label:i.i18n._("Import"),id:"import_icon",menu_align:"right",action_group:"import_export",group:"other",vue_icon:"tticon tticon-file_download_black_24dp",permission_result:PermissionManager.checkTopLevelPermission("ImportCSVBranch"),permission:null,sort_order:9010}]};return t}setDefaultMenuImportIcon(t,o,e){PermissionManager.checkTopLevelPermission("ImportCSVBranch")===!0?ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,t.id,!0):ContextMenuManager.hideMenuItem(this.determineContextMenuMountAttributes().id,t.id,!1)}onSetSearchFilterFinished(){var t,o;this.search_panel.getSelectTabIndex()===0?(t=this.basic_search_field_ui_dic.country,o=t.getValue(),this.setProvince(o)):this.search_panel.getSelectTabIndex()===1&&(t=this.adv_search_field_ui_dic.country,o=t.getValue(),this.setProvince(o))}onCustomContextClick(t){switch(t){case"import_icon":this.onImportClick();break}}onImportClick(){var t=this;IndexViewController.openWizard("ImportCSVWizard","Branch",function(){t.search()})}onBuildAdvUIFinished(){this.adv_search_field_ui_dic.country.change(i.proxy(function(){var t=this.adv_search_field_ui_dic.country,o=t.getValue();this.setProvince(o),this.adv_search_field_ui_dic.province.setValue(null)},this))}onBuildBasicUIFinished(){this.basic_search_field_ui_dic.country.change(i.proxy(function(){var t=this.basic_search_field_ui_dic.country,o=t.getValue();this.setProvince(o),this.basic_search_field_ui_dic.province.setValue(null)},this))}onFormItemChange(t,o){this.setIsChanged(t),this.setMassEditingFieldsWhenFormChange(t);var e=t.getField();switch(e){case"country":var r=this.edit_view_ui_dic.province;r.setValue(null);break}if(this.current_edit_record[e]=t.getValue(),e==="country"){this.onCountryChange();return}Global.getProductEdition()>=20&&(e==="user_group_selection_type_id"&&this.onEmployeeGroupSelectionTypeChange(),e==="user_title_selection_type_id"&&this.onEmployeeTitleSelectionTypeChange(),e==="user_default_branch_selection_type_id"&&this.onEmployeeDefaultBranchSelectionTypeChange(),e==="user_default_department_selection_type_id"&&this.onEmployeeDefaultDepartmentSelectionTypeChange()),o||this.validate()}onEmployeeGroupSelectionTypeChange(){this.current_edit_record.user_group_selection_type_id==10?this.edit_view_ui_dic.user_group_ids.setEnabled(!1):this.edit_view_ui_dic.user_group_ids.setEnabled(!0)}onEmployeeTitleSelectionTypeChange(){this.current_edit_record.user_title_selection_type_id==10?this.edit_view_ui_dic.user_title_ids.setEnabled(!1):this.edit_view_ui_dic.user_title_ids.setEnabled(!0)}onEmployeeDefaultBranchSelectionTypeChange(){this.current_edit_record.user_default_branch_selection_type_id==10?this.edit_view_ui_dic.user_default_branch_ids.setEnabled(!1):this.edit_view_ui_dic.user_default_branch_ids.setEnabled(!0)}onEmployeeDefaultDepartmentSelectionTypeChange(){this.current_edit_record.user_default_department_selection_type_id==10?this.edit_view_ui_dic.user_default_department_ids.setEnabled(!1):this.edit_view_ui_dic.user_default_department_ids.setEnabled(!0)}buildEditViewUI(){super.buildEditViewUI();var t=this,o={tab_branch:{label:i.i18n._("Branch")},tab_employee_criteria:{label:i.i18n._("Employee Criteria"),init_callback:"initSubEmployeeCriteriaView",html_template:this.getBranchEmployeeCriteriaTabHtml()},tab_audit:!0};this.setTabModel(o);var e;this.navigation.AComboBox({api_class:TTAPI.APIBranch,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_branch",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var r=this.edit_view_tab.find("#tab_branch"),a=r.find(".first-column");if(this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(a),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"status_id"}),e.setSourceData(t.status_array),this.addEditFieldToColumn(i.i18n._("Status"),e,a,""),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn(i.i18n._("Name"),e,a),e.parent().width("45%"),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"manual_id",width:65}),this.addEditFieldToColumn(i.i18n._("Code"),e,a),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"address1",width:"100%"}),this.addEditFieldToColumn(i.i18n._("Address (Line 1)"),e,a),e.parent().width("45%"),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"address2",width:"100%"}),this.addEditFieldToColumn(i.i18n._("Address (Line 2)"),e,a),e.parent().width("45%"),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"city",width:149}),this.addEditFieldToColumn(i.i18n._("City"),e,a),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"country",set_empty:!0}),e.setSourceData(t.country_array),this.addEditFieldToColumn(i.i18n._("Country"),e,a),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"province"}),e.setSourceData([]),this.addEditFieldToColumn(i.i18n._("Province/State"),e,a),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"postal_code",width:149}),this.addEditFieldToColumn(i.i18n._("Postal/ZIP Code"),e,a),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"work_phone",width:149}),this.addEditFieldToColumn(i.i18n._("Phone"),e,a),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"fax_phone",width:149}),this.addEditFieldToColumn(i.i18n._("Fax"),e,a),Global.getProductEdition()>=20&&(e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIGEOFence,allow_multiple_selection:!0,layout_name:"global_geo_fence",show_search_inputs:!0,set_empty:!0,field:"geo_fence_ids"}),this.addEditFieldToColumn(i.i18n._("Allowed GEO Fences"),e,a)),e=Global.loadWidgetByName(FormItemType.TAG_INPUT),e.TTagInput({field:"tag",object_type_id:110}),this.addEditFieldToColumn(i.i18n._("Tags"),e,a,"",null,null,!0),Global.getProductEdition()>=20){var u=this.edit_view_tab.find("#tab_employee_criteria"),d=u.find(".first-column");this.edit_view_tabs[1]=[],this.edit_view_tabs[1].push(d);var l=i("<div class='v-box'></div>");e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"user_group_selection_type_id"}),e.setSourceData(t.user_group_selection_type_id_array);var s=this.putInputToInsideFormItem(e,i.i18n._("Selection Type"));l.append(s),l.append("<div class='clear-both-div'></div>");var n=Global.loadWidgetByName(FormItemType.AWESOME_BOX);n.AComboBox({tree_mode:!0,allow_multiple_selection:!0,layout_name:"global_tree_column",set_empty:!0,field:"user_group_ids"}),n.setSourceData(t.user_group_array),s=this.putInputToInsideFormItem(n,i.i18n._("Selection")),l.append(s),this.addEditFieldToColumn(i.i18n._("Employee Groups"),[e,n],d,"",l,!1,!0),l=i("<div class='v-box'></div>"),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"user_title_selection_type_id",set_empty:!1}),e.setSourceData(t.user_title_selection_type_id_array),s=this.putInputToInsideFormItem(e,i.i18n._("Selection Type")),l.append(s),l.append("<div class='clear-both-div'></div>"),n=Global.loadWidgetByName(FormItemType.AWESOME_BOX),n.AComboBox({api_class:TTAPI.UserTitle,allow_multiple_selection:!0,layout_name:"global_user_title",show_search_inputs:!0,set_empty:!0,field:"user_title_ids"}),s=this.putInputToInsideFormItem(n,i.i18n._("Selection")),l.append(s),this.addEditFieldToColumn(i.i18n._("Employee Titles"),[e,n],d,"",l,!1,!0),l=i("<div class='v-box'></div>"),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"user_default_branch_selection_type_id",set_empty:!1}),e.setSourceData(t.user_default_branch_selection_type_id_array),s=this.putInputToInsideFormItem(e,i.i18n._("Selection Type")),l.append(s),l.append("<div class='clear-both-div'></div>"),n=Global.loadWidgetByName(FormItemType.AWESOME_BOX),n.AComboBox({api_class:TTAPI.Branch,allow_multiple_selection:!0,layout_name:"global_user_default_branch",show_search_inputs:!0,set_empty:!0,field:"user_default_branch_ids"}),s=this.putInputToInsideFormItem(n,i.i18n._("Selection")),l.append(s);var _=Global.loadWidgetByName(FormItemType.CHECKBOX);_.TCheckbox({field:"include_user_default_branch_id"}),s=this.putInputToInsideFormItem(_,i.i18n._("Include This Branch")),l.append(s),this.addEditFieldToColumn(i.i18n._("Default Branch"),[e,n,_],d,"",l,!1,!0),l=i("<div class='v-box'></div>"),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"user_default_department_selection_type_id",set_empty:!1}),e.setSourceData(t.user_default_department_selection_type_id_array),s=this.putInputToInsideFormItem(e,i.i18n._("Selection Type")),l.append(s),l.append("<div class='clear-both-div'></div>"),n=Global.loadWidgetByName(FormItemType.AWESOME_BOX),n.AComboBox({api_class:TTAPI.Department,allow_multiple_selection:!0,layout_name:"global_user_default_department",show_search_inputs:!0,set_empty:!0,field:"user_default_department_ids"}),s=this.putInputToInsideFormItem(n,i.i18n._("Selection")),l.append(s),this.addEditFieldToColumn(i.i18n._("Default Department"),[e,n],d,"",l,!1,!0),e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIUser,allow_multiple_selection:!0,layout_name:"global_user",show_search_inputs:!0,set_empty:!0,field:"include_user_ids"}),this.addEditFieldToColumn(i.i18n._("Include Employees"),e,d),e=Global.loadWidgetByName(FormItemType.AWESOME_BOX),e.AComboBox({api_class:TTAPI.APIUser,allow_multiple_selection:!0,layout_name:"global_user",show_search_inputs:!0,set_empty:!0,field:"exclude_user_ids"}),this.addEditFieldToColumn(i.i18n._("Exclude Employees"),e,d,"")}}setProvince(t,o){var e=this;!t||t==="-1"||t==="0"?(e.province_array=[],this.adv_search_field_ui_dic.province.setSourceData([]),this.basic_search_field_ui_dic.province.setSourceData([])):this.company_api.getOptions("province",t,{onResult:function(r){r=r.getResult(),r||(r=[]),e.province_array=Global.buildRecordArray(r),e.adv_search_field_ui_dic.province.setSourceData(e.province_array),e.basic_search_field_ui_dic.province.setSourceData(e.province_array)}})}eSetProvince(t,o){var e=this,r=e.edit_view_ui_dic.province;!t||t==="-1"||t==="0"?(e.e_province_array=[],r.setSourceData([])):this.company_api.getOptions("province",t,{onResult:function(a){a=a.getResult(),a||(a=[]),e.e_province_array=Global.buildRecordArray(a),o&&e.e_province_array.length>0&&(e.current_edit_record.province=e.e_province_array[0].value,r.setValue(e.current_edit_record.province)),r.setSourceData(e.e_province_array)}})}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:i.i18n._("Status"),in_column:1,field:"status_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:i.i18n._("Name"),in_column:1,field:"name",multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:i.i18n._("Tags"),field:"tag",basic_search:!0,adv_search:!0,in_column:1,form_item_type:FormItemType.TAG_INPUT}),new SearchField({label:i.i18n._("Phone"),field:"work_phone",basic_search:!1,adv_search:!0,in_column:1,object_type_id:110,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:i.i18n._("Fax"),field:"fax_phone",basic_search:!1,adv_search:!0,in_column:1,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:i.i18n._("Address (Line1)"),field:"address1",basic_search:!1,adv_search:!0,in_column:2,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:i.i18n._("Address (Line2)"),field:"address2",basic_search:!1,adv_search:!0,in_column:2,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:i.i18n._("Postal/ZIP Code"),field:"postal_code",basic_search:!1,adv_search:!0,in_column:2,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:i.i18n._("Country"),in_column:2,field:"country",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.COMBO_BOX}),new SearchField({label:i.i18n._("Province/State"),in_column:2,field:"province",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:i.i18n._("City"),field:"city",basic_search:!0,adv_search:!0,in_column:3,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:i.i18n._("Code"),field:"manual_id",basic_search:!0,adv_search:!0,in_column:3,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:i.i18n._("Created By"),in_column:3,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:i.i18n._("Updated By"),in_column:3,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX})]}setEditViewDataDone(){super.setEditViewDataDone(),Global.getProductEdition()>=20&&(this.onEmployeeGroupSelectionTypeChange(),this.onEmployeeTitleSelectionTypeChange(),this.onEmployeeDefaultBranchSelectionTypeChange(),this.onEmployeeDefaultDepartmentSelectionTypeChange())}initSubEmployeeCriteriaView(){Global.getProductEdition()>=20?(this.edit_view_tab.find("#tab_employee_criteria").find(".first-column").css("display","block"),this.edit_view.find(".permission-defined-div").css("display","none")):(this.edit_view_tab.find("#tab_employee_criteria").find(".first-column").css("display","none"),this.edit_view.find(".permission-defined-div").css("display","block"),this.edit_view.find(".permission-message").html(Global.getUpgradeMessage()))}getBranchEmployeeCriteriaTabHtml(){return`
		<div id="tab_employee_criteria" class="edit-view-tab-outside">
			<div class="edit-view-tab" id="tab_employee_criteria_content_div">
				<div class="first-column full-width-column"></div>
				<div class="save-and-continue-div permission-defined-div">
					<span class="message permission-message"></span>
				</div>
			</div>
		</div>`}}export{m as BranchViewController};
//# sourceMappingURL=BranchViewController-DqoDofLX.bundle.js.map
