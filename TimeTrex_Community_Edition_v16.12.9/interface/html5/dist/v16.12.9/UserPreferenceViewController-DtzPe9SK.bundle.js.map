{"version":3,"file":"UserPreferenceViewController-DtzPe9SK.bundle.js","sources":["../../views/employees/user_preference/UserPreferenceViewController.js"],"sourcesContent":["export class UserPreferenceViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#user_preference_view_container',\n\n\t\t\tdate_format_array: null,\n\t\t\tother_date_format_array: null,\n\t\t\tjs_date_format_array: null,\n\t\t\tflex_date_format_array: null,\n\t\t\tjquery_date_format_array: null,\n\t\t\ttime_format_array: null,\n\t\t\tjs_time_format_array: null,\n\t\t\tflex_time_format_array: null,\n\t\t\tdate_time_format_array: null,\n\t\t\ttime_unit_format_array: null,\n\t\t\tdistance_format_array: null,\n\t\t\ttime_zone_array: null,\n\t\t\tlocation_timezone_array: null,\n\t\t\tarea_code_timezone_array: null,\n\t\t\ttimesheet_view_array: null,\n\t\t\tstart_week_day_array: null,\n\t\t\tschedule_icalendar_type_array: null,\n\t\t\tlanguage_array: null,\n\t\t\tuser_group_array: null,\n\t\t\tcountry_array: null,\n\t\t\tprovince_array: null,\n\n\t\t\tnotification_status_array: null,\n\t\t\tnotification_type_array: null,\n\t\t\tpriority_array: null,\n\t\t\toriginal_user_preference_notification_data: [],\n\n\t\t\te_province_array: null,\n\t\t\tuser_api: null,\n\t\t\tuser_group_api: null,\n\t\t\tcompany_api: null,\n\n\t\t\tapi_date: null,\n\n\t\t\tuser_preference_notification_api: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'UserPreferenceEditView.html';\n\t\tthis.permission_id = 'user_preference';\n\t\tthis.viewId = 'UserPreference';\n\t\tthis.script_name = 'UserPreferenceView';\n\t\tthis.table_name_key = 'user_preference';\n\t\tthis.context_menu_name = $.i18n._( 'Preferences' );\n\t\tthis.navigation_label = $.i18n._( 'Employees' );\n\t\tthis.api = TTAPI.APIUserPreference;\n\t\tthis.api_date = TTAPI.APITTDate;\n\t\tthis.user_api = TTAPI.APIUser;\n\t\tthis.user_group_api = TTAPI.APIUserGroup;\n\t\tthis.company_api = TTAPI.APICompany;\n\t\tthis.user_preference_notification_api = TTAPI.APIUserPreferenceNotification;\n\n\t\tthis.render();\n\n\t\tthis.buildContextMenu();\n\n\t\t//call init data in parent view\n\n\t\tthis.initData();\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\texclude: [\n\t\t\t\t'add',\n\t\t\t\t'copy',\n\t\t\t\t'copy_as_new',\n\t\t\t\t'save_and_copy',\n\t\t\t\t'save_and_new',\n\t\t\t\t'delete_icon',\n\t\t\t\t'delete_and_next'\n\t\t\t],\n\t\t\tinclude: []\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tinitOptions() {\n\n\t\tvar $this = this;\n\n\t\tvar options = [\n\t\t\t{ option_name: 'status', api: this.user_api },\n\t\t\t{ option_name: 'country', field_name: 'country', api: this.company_api },\n\t\t\t{ option_name: 'language', api: this.api },\n\t\t\t{ option_name: 'date_format', api: this.api },\n\t\t\t{ option_name: 'time_format', api: this.api },\n\t\t\t{ option_name: 'time_unit_format', api: this.api },\n\t\t\t{ option_name: 'distance_format', api: this.api },\n\t\t\t{ option_name: 'time_zone', api: this.api },\n\t\t\t{ option_name: 'start_week_day', api: this.api },\n\t\t\t{ option_name: 'schedule_icalendar_type', api: this.api },\n\t\t\t{ option_name: 'default_login_screen', api: this.api },\n\t\t\t{ option_name: 'notification_status', api: this.api },\n\t\t\t{ option_name: 'notification_type', api: this.user_preference_notification_api },\n\t\t\t{ option_name: 'priority', api: this.user_preference_notification_api },\n\t\t];\n\n\t\tthis.initDropDownOptions( options );\n\n\t\tthis.user_group_api.getUserGroup( '', false, false, {\n\t\t\tonResult: function( res ) {\n\t\t\t\tres = res.getResult();\n\t\t\t\tres = Global.buildTreeRecord( res );\n\t\t\t\t$this.user_group_array = res;\n\t\t\t\tif ( !$this.sub_view_mode && $this.basic_search_field_ui_dic['group_id'] ) {\n\t\t\t\t\t$this.basic_search_field_ui_dic['group_id'].setSourceData( res );\n\t\t\t\t\t$this.adv_search_field_ui_dic['group_id'].setSourceData( res );\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tinitInsideEditorData() {\n\t\tvar $this = this;\n\n\t\tvar filter = {};\n\t\tfilter.filter_data = {};\n\t\tfilter.filter_data.user_id = this.current_edit_record.user_id;\n\n\t\t$this.user_preference_notification_api.getUserPreferenceNotification( filter, true, {\n\t\t\tonResult: function( res ) {\n\n\t\t\t\tvar data = res.getResult();\n\t\t\t\tvar array_data = [];\n\t\t\t\tfor ( var key in data ) {\n\n\t\t\t\t\tif ( !data.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tarray_data.push( data[key] );\n\t\t\t\t}\n\t\t\t\tarray_data = array_data.sort( function( a, b ) {\n\t\t\t\t\treturn $this.notification_type_array.findIndex( p => p.id === a.type_id ) - $this.notification_type_array.findIndex( p => p.id === b.type_id );\n\t\t\t\t} );\n\n\t\t\t\t$this.original_user_preference_notification_data =  _.map(array_data, _.clone);\n\n\t\t\t\t$this.editor.setValue( array_data );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tsetProvince( val, m ) {\n\t\tvar $this = this;\n\n\t\tif ( !val || val === '-1' || val === '0' ) {\n\t\t\t$this.province_array = [];\n\t\t\tthis.adv_search_field_ui_dic['province'].setSourceData( [] );\n\t\t} else {\n\t\t\tthis.company_api.getOptions( 'province', val, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tres = res.getResult();\n\t\t\t\t\tif ( !res ) {\n\t\t\t\t\t\tres = [];\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.province_array = Global.buildRecordArray( res );\n\t\t\t\t\t$this.adv_search_field_ui_dic['province'].setSourceData( $this.province_array );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\teSetProvince( val, refresh ) {\n\t\tvar $this = this;\n\t\tvar province_widget = $this.edit_view_ui_dic['province'];\n\n\t\tif ( !val || val === '-1' || val === '0' ) {\n\t\t\t$this.e_province_array = [];\n\t\t\tprovince_widget.setSourceData( [] );\n\t\t} else {\n\t\t\tthis.company_api.getOptions( 'province', val, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tres = res.getResult();\n\t\t\t\t\tif ( !res ) {\n\t\t\t\t\t\tres = [];\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.e_province_array = Global.buildRecordArray( res );\n\n\t\t\t\t\tif ( refresh && $this.e_province_array.length > 0 ) {\n\t\t\t\t\t\t$this.current_edit_record.province = $this.e_province_array[0].value;\n\t\t\t\t\t\tprovince_widget.setValue( $this.current_edit_record.province );\n\t\t\t\t\t}\n\t\t\t\t\tprovince_widget.setSourceData( $this.e_province_array );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tonSetSearchFilterFinished() {\n\n\t\tif ( this.search_panel.getSelectTabIndex() === 1 ) {\n\t\t\tvar combo = this.adv_search_field_ui_dic['country'];\n\t\t\tvar select_value = combo.getValue();\n\t\t\tthis.setProvince( select_value );\n\t\t}\n\t}\n\n\tonBuildAdvUIFinished() {\n\n\t\tthis.adv_search_field_ui_dic['country'].change( $.proxy( function() {\n\t\t\tvar combo = this.adv_search_field_ui_dic['country'];\n\t\t\tvar selectVal = combo.getValue();\n\n\t\t\tthis.setProvince( selectVal );\n\n\t\t\tthis.adv_search_field_ui_dic['province'].setValue( null );\n\n\t\t}, this ) );\n\t}\n\n\tbuildSearchFields() {\n\n\t\tthis.search_fields = [\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Employee' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'user_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Status' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'status_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'First Name' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'first_name',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Last Name' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'last_name',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Employee Number' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'employee_number',\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Group' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tmultiple: true,\n\t\t\t\tfield: 'group_id',\n\t\t\t\tlayout_name: 'global_tree_column',\n\t\t\t\ttree_mode: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Default Branch' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'default_branch_id',\n\t\t\t\tlayout_name: 'global_branch',\n\t\t\t\tapi_class: TTAPI.APIBranch,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Default Department' ),\n\t\t\t\tfield: 'default_department_id',\n\t\t\t\tin_column: 2,\n\t\t\t\tlayout_name: 'global_department',\n\t\t\t\tapi_class: TTAPI.APIDepartment,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Title' ),\n\t\t\t\tfield: 'title_id',\n\t\t\t\tin_column: 2,\n\t\t\t\tlayout_name: 'global_job_title',\n\t\t\t\tapi_class: TTAPI.APIUserTitle,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Country' ),\n\t\t\t\tin_column: 3,\n\t\t\t\tfield: 'country',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.COMBO_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Province/State' ),\n\t\t\t\tin_column: 3,\n\t\t\t\tfield: 'province',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\n\t\t];\n\t}\n\n\tonFormItemChange( target, doNotValidate ) {\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\t\tvar key = target.getField();\n\t\tvar c_value = target.getValue();\n\t\tthis.current_edit_record[key] = c_value;\n\n\t\tif ( key === 'schedule_icalendar_type_id' ) {\n\n\t\t\tthis.onStatusChange();\n\t\t} else if ( key === 'notification_status_id' ) {\n\t\t\tthis.initSubNotificationView();\n\t\t}\n\n\t\tif ( !doNotValidate ) {\n\t\t\tthis.validate();\n\t\t}\n\t}\n\n\tbuildEditViewUI() {\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_preference': { 'label': $.i18n._( 'Preferences' ) },\n\t\t\t'tab_preferences_notification': {\n\t\t\t\t'label': $.i18n._( 'Notifications' ),\n\t\t\t\t'init_callback': 'initSubNotificationView',\n\t\t\t\t'html_template': this.getPreferencesNotificationTabHtml()\n\t\t\t},\n\t\t\t'tab_schedule_sync': {\n\t\t\t\t'label': $.i18n._( 'Schedule Synchronization' ),\n\t\t\t\t'init_callback': 'initSubScheduleSyncView',\n\t\t\t\t'html_template': this.getScheduleSyncronizationTabHtml()\n\t\t\t},\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tapi_class: TTAPI.APIUserPreference,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_user_preference',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_preference = this.edit_view_tab.find( '#tab_preference' );\n\n\t\tvar tab_preference_column1 = tab_preference.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_preference_column1 );\n\n\t\tvar form_item_input;\n\t\tvar widgetContainer;\n\t\tvar label;\n\n\t\tif ( !this.is_mass_editing ) {\n\t\t\t// Employee\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\tform_item_input.TText( { field: 'full_name' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Employee' ), form_item_input, tab_preference_column1, '' );\n\t\t}\n\n\t\t// Language\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'language', set_empty: true } );\n\t\tform_item_input.setSourceData( $this.language_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Language' ), form_item_input, tab_preference_column1 );\n\n\t\t// Date Format\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'date_format', set_empty: true } );\n\t\tform_item_input.setSourceData( $this.date_format_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Date Format' ), form_item_input, tab_preference_column1 );\n\n\t\t// Time Format\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'time_format', set_empty: true } );\n\t\tform_item_input.setSourceData( $this.time_format_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Time Format' ), form_item_input, tab_preference_column1 );\n\n\t\t// Time Units\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'time_unit_format', set_empty: true } );\n\t\tform_item_input.setSourceData( $this.time_unit_format_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Time Units' ), form_item_input, tab_preference_column1 );\n\n\t\t// Distance Units\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'distance_format', set_empty: true } );\n\t\tform_item_input.setSourceData( $this.distance_format_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Distance Units' ), form_item_input, tab_preference_column1 );\n\n\t\t// Time Zone\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'time_zone', set_empty: true } );\n\t\tform_item_input.setSourceData( $this.time_zone_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Time Zone' ), form_item_input, tab_preference_column1 );\n\n\t\t// Start Weeks on\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'start_week_day' } );\n\t\tform_item_input.setSourceData( $this.start_week_day_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Calendar Starts On' ), form_item_input, tab_preference_column1 );\n\n\t\t// Rows per page\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'items_per_page', width: 50 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Rows per page' ), form_item_input, tab_preference_column1 );\n\n\t\t// Default Login Screen\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'default_login_screen' } );\n\t\tform_item_input.setSourceData( $this.default_login_screen_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Default Screen' ), form_item_input, tab_preference_column1 );\n\n\t\t// Save TimeSheet State\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'enable_save_timesheet_state' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Save TimeSheet State' ), form_item_input, tab_preference_column1 );\n\n\n\t\t//Tab 1 start\n\t\tvar tab_preferences_notification = this.edit_view_tab.find( '#tab_preferences_notification' );\n\n\t\tvar tab_preferences_notification_column1 = tab_preferences_notification.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[1] = [];\n\n\t\tthis.edit_view_tabs[1].push( tab_preferences_notification_column1 );\n\n\t\t// Push Notifications Enabled\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'notification_status_id' } );\n\t\tform_item_input.setSourceData( Global.addFirstItemToArray( $this.notification_status_array ) );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Notification Status' ), form_item_input, tab_preferences_notification_column1 );\n\n\t\t// Notification duration\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'notification_duration', width: 50 } );\n\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\tlabel = $( '<span class=\\'widget-right-label\\'> ' + $.i18n._( 'Seconds (Use 0 for infinite)' ) + '</span>' );\n\n\t\twidgetContainer.append( form_item_input );\n\t\twidgetContainer.append( label );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Display Notifications For' ), form_item_input, tab_preferences_notification_column1, '', widgetContainer );\n\n\t\tif ( this.is_mass_editing == false ) {\n\t\t\tvar inside_editor_div = tab_preferences_notification.find( '.inside-editor-div' );\n\t\t\tvar args = {\n\t\t\t\tenabled: $.i18n._( 'Enabled' ),\n\t\t\t\tname: $.i18n._( 'Type' ),\n\t\t\t\tweb: $.i18n._( 'Browser' ),\n\t\t\t\temail_work: $.i18n._( 'Work Email' ),\n\t\t\t\temail_home: $.i18n._( 'Home Email' ),\n\t\t\t\tapp: $.i18n._( 'Mobile App' ),\n\t\t\t\tpriority: $.i18n._( 'Priority' ),\n\t\t\t\tsettings: $.i18n._( 'Settings' )\n\t\t\t};\n\n\t\t\tthis.editor = Global.loadWidgetByName( FormItemType.INSIDE_EDITOR );\n\n\t\t\tthis.editor.InsideEditor( {\n\t\t\t\ttitle: '',\n\t\t\t\taddRow: this.insideEditorAddRow,\n\t\t\t\tgetValue: this.insideEditorGetValue,\n\t\t\t\tsetValue: this.insideEditorSetValue,\n\t\t\t\tparent_controller: this,\n\t\t\t\trender: getRender(),\n\t\t\t\trender_args: args,\n\t\t\t\trender_inline_html: true,\n\t\t\t\trow_render: getRowRender()\n\t\t\t} );\n\n\t\t\tfunction getRender() {\n\t\t\t\treturn `\n\t\t\t<table class=\"inside-editor-render\">\n\t\t\t\t<tr class=\"title\">\n\t\t\t\t\t<td style=\"width: 50px\"><%= enabled %></td>\n\t\t\t\t\t<td style=\"width: 400px\"><%= name %></td>\n\t\t\t\t\t<td style=\"width: 150px\"><%= priority %></td>\n\t\t\t\t\t<td style=\"width: 110px\"><%= web %></td>\n\t\t\t\t\t<td style=\"width: 110px\"><%= email_work %></td>\n\t\t\t\t\t<td style=\"width: 110px\"><%= email_home %></td>\n\t\t\t\t\t<td style=\"width: 110px\"><%= app %></td>\n\t\t\t\t\t<td style=\"width: 200px\"><%= settings %></td>\n\t\t\t\t</tr>\n\t\t\t</table>`;\n\t\t\t}\n\n\t\t\tfunction getRowRender() {\n\t\t\t\treturn `\n\t\t\t<tr class=\"inside-editor-row data-row\">\n\t\t\t\t<td class=\"cell\"></td>\n\t\t\t\t<td class=\"cell\"></td>\n\t\t\t\t<td class=\"cell\"></td>\n\t\t\t\t<td class=\"cell\"></td>\n\t\t\t\t<td class=\"cell\"></td>\n\t\t\t\t<td class=\"cell\"></td>\n\t\t\t\t<td class=\"cell\"></td>\n\t\t\t\t<td class=\"cell\"></td>\n\t\t\t</tr>`;\n\t\t\t}\n\n\t\t\tinside_editor_div.append( this.editor );\n\t\t}\n\n\t\t//Tab 2 start\n\n\t\tvar tab_schedule_sync = this.edit_view_tab.find( '#tab_schedule_sync' );\n\n\t\tvar tab_schedule_sync_column1 = tab_schedule_sync.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[2] = [];\n\n\t\tthis.edit_view_tabs[2].push( tab_schedule_sync_column1 );\n\n\t\t//// schedule icalendar type\n\t\t//form_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\t//form_item_input.TComboBox( {field: 'schedule_icalendar_type_id' } );\n\t\t//form_item_input.setSourceData( $this.schedule_icalendar_type_array );\n\t\t//this.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_schedule_sync_column1, 'first-last' );\n\t\t//\n\t\t//// Calendar URL\n\t\t//form_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t//form_item_input.TText( {field: 'calendar_url' } );\n\t\t//form_item_input.addClass( 'link' );\n\t\t//this.addEditFieldToColumn( $.i18n._( 'Calendar URL' ), form_item_input, tab_schedule_sync_column1, '', null, true );\n\n\t\t// Shifts Scheduled to Work\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.SEPARATED_BOX );\n\t\tform_item_input.SeparatedBox( { label: $.i18n._( 'Shifts Scheduled to Work' ) } );\n\t\tthis.addEditFieldToColumn( null, form_item_input, tab_schedule_sync_column1, '', null, true, false, 'shifts_scheduled_to_work' );\n\n\t\t// Alarm 1\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'schedule_icalendar_alarm1_working', width: 90, need_parser_sec: true } );\n\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\tlabel = $( '<span class=\\'widget-right-label\\'>( ' + $.i18n._( 'before schedule start time' ) + ' )</span>' );\n\n\t\twidgetContainer.append( form_item_input );\n\t\twidgetContainer.append( label );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Alarm 1' ), form_item_input, tab_schedule_sync_column1, '', widgetContainer, true );\n\n\t\t// Alarm 2\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'schedule_icalendar_alarm2_working', width: 90, need_parser_sec: true } );\n\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\tlabel = $( '<span class=\\'widget-right-label\\'>( ' + $.i18n._( 'before schedule start time' ) + ' )</span>' );\n\n\t\twidgetContainer.append( form_item_input );\n\t\twidgetContainer.append( label );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Alarm 2' ), form_item_input, tab_schedule_sync_column1, '', widgetContainer, true );\n\n\t\t// Shifts Scheduled Absent\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.SEPARATED_BOX );\n\t\tform_item_input.SeparatedBox( { label: $.i18n._( 'Shifts Scheduled Absent' ) } );\n\t\tthis.addEditFieldToColumn( null, form_item_input, tab_schedule_sync_column1, '', null, true, false, 'shifts_scheduled_absent' );\n\n\t\t// Alarm 1\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'schedule_icalendar_alarm1_absence', width: 90, need_parser_sec: true } );\n\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\tlabel = $( '<span class=\\'widget-right-label\\'>( ' + $.i18n._( 'before schedule start time' ) + ' )</span>' );\n\n\t\twidgetContainer.append( form_item_input );\n\t\twidgetContainer.append( label );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Alarm 1' ), form_item_input, tab_schedule_sync_column1, '', widgetContainer, true );\n\n\t\t// Alarm 2\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'schedule_icalendar_alarm2_absence', width: 90, need_parser_sec: true } );\n\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\tlabel = $( '<span class=\\'widget-right-label\\'>( ' + $.i18n._( 'before schedule start time' ) + ' )</span>' );\n\n\t\twidgetContainer.append( form_item_input );\n\t\twidgetContainer.append( label );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Alarm 2' ), form_item_input, tab_schedule_sync_column1, '', widgetContainer, true );\n\n\t\t// Modified Shifts\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.SEPARATED_BOX );\n\t\tform_item_input.SeparatedBox( { label: $.i18n._( 'Modified Shifts' ) } );\n\t\tthis.addEditFieldToColumn( null, form_item_input, tab_schedule_sync_column1, '', null, true, false, 'modified_shifts' );\n\n\t\t// Alarm 1\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'schedule_icalendar_alarm1_modified', width: 90, need_parser_sec: true } );\n\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\tlabel = $( '<span class=\\'widget-right-label\\'>( ' + $.i18n._( 'before schedule start time' ) + ' )</span>' );\n\n\t\twidgetContainer.append( form_item_input );\n\t\twidgetContainer.append( label );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Alarm 1' ), form_item_input, tab_schedule_sync_column1, '', widgetContainer, true );\n\n\t\t// Alarm 2\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'schedule_icalendar_alarm2_modified', width: 90, need_parser_sec: true } );\n\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\tlabel = $( '<span class=\\'widget-right-label\\'>( ' + $.i18n._( 'before schedule start time' ) + ' )</span>' );\n\n\t\twidgetContainer.append( form_item_input );\n\t\twidgetContainer.append( label );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Alarm 2' ), form_item_input, tab_schedule_sync_column1, '', widgetContainer, true );\n\t}\n\n\tonMassEditClick() {\n\n\t\tvar $this = this;\n\t\t$this.is_add = false;\n\t\t$this.is_viewing = false;\n\t\t$this.is_mass_editing = true;\n\t\tLocalCacheData.current_doing_context_action = 'mass_edit';\n\t\t$this.openEditView();\n\t\tvar filter = {};\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\t\tthis.mass_edit_record_ids = [];\n\n\t\t$.each( grid_selected_id_array, function( index, value ) {\n\t\t\t$this.mass_edit_record_ids.push( value );\n\t\t} );\n\n\t\tfilter.filter_data = {};\n\t\tfilter.filter_data.id = this.mass_edit_record_ids;\n\n\t\tthis.api['getCommon' + this.api.key_name + 'Data']( filter, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\tif ( !result_data ) {\n\t\t\t\t\tresult_data = [];\n\t\t\t\t}\n\n\t\t\t\t$this.unique_columns = [];\n\t\t\t\t$this.linked_columns = [];\n\n\t\t\t\t$this.current_edit_record = result_data;\n\t\t\t\t$this.initEditView();\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tonStatusChange() {\n\n\t\tif ( this.current_edit_record.schedule_icalendar_type_id == 0 ) {\n\t\t\t//this.edit_view_form_item_dic['calendar_url'].css( 'display', 'none' );\n\t\t\tthis.detachElement( 'schedule_icalendar_alarm1_working' );\n\t\t\tthis.detachElement( 'schedule_icalendar_alarm2_working' );\n\t\t\tthis.detachElement( 'schedule_icalendar_alarm1_absence' );\n\t\t\tthis.detachElement( 'schedule_icalendar_alarm2_absence' );\n\t\t\tthis.detachElement( 'schedule_icalendar_alarm1_modified' );\n\t\t\tthis.detachElement( 'schedule_icalendar_alarm2_modified' );\n\t\t\tthis.detachElement( 'shifts_scheduled_to_work' );\n\t\t\tthis.detachElement( 'shifts_scheduled_absent' );\n\t\t\tthis.detachElement( 'modified_shifts' );\n\n\t\t} else {\n\t\t\t//this.setCalendarURL();\n\t\t\t//this.edit_view_form_item_dic['calendar_url'].css( 'display', 'block' );\n\t\t\tthis.attachElement( 'schedule_icalendar_alarm1_working' );\n\t\t\tthis.attachElement( 'schedule_icalendar_alarm2_working' );\n\t\t\tthis.attachElement( 'schedule_icalendar_alarm1_absence' );\n\t\t\tthis.attachElement( 'schedule_icalendar_alarm2_absence' );\n\t\t\tthis.attachElement( 'schedule_icalendar_alarm1_modified' );\n\t\t\tthis.attachElement( 'schedule_icalendar_alarm2_modified' );\n\t\t\tthis.attachElement( 'shifts_scheduled_to_work' );\n\t\t\tthis.attachElement( 'shifts_scheduled_absent' );\n\t\t\tthis.attachElement( 'modified_shifts' );\n\t\t}\n\n\t\tthis.editFieldResize();\n\t}\n\n\tsetCurrentEditRecordData() {\n\n\t\t//Set current edit record data to all widgets\n\n\t\tfor ( var key in this.current_edit_record ) {\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\tif ( Global.isSet( widget ) ) {\n\t\t\t\tswitch ( key ) {\n\t\t\t\t\tcase 'full_name':\n\t\t\t\t\t\twidget.setValue( this.current_edit_record['first_name'] + ' ' + this.current_edit_record['last_name'] );\n\t\t\t\t\t\tbreak;\n//\t\t\t\t\tcase 'schedule_icalendar_alarm1_working':\n//\t\t\t\t\tcase 'schedule_icalendar_alarm2_working':\n//\t\t\t\t\tcase 'schedule_icalendar_alarm1_absence':\n//\t\t\t\t\tcase 'schedule_icalendar_alarm2_absence':\n//\t\t\t\t\tcase 'schedule_icalendar_alarm1_modified':\n//\t\t\t\t\tcase 'schedule_icalendar_alarm2_modified':\n//\t\t\t\t\t\tvar result = Global.getTimeUnit( this.current_edit_record[key] )\n//\t\t\t\t\t\twidget.setValue( result );\n//\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tthis.collectUIDataToCurrentEditRecord();\n\n\t\tthis.setEditViewDataDone();\n\t}\n\n\tsetEditViewDataDone() {\n\t\tsuper.setEditViewDataDone();\n\t\tthis.onStatusChange();\n\t\tif ( this.is_mass_editing == false ) {\n\t\t\tthis.initInsideEditorData();\n\t\t}\n\t}\n\n\tsetCalendarURL( widget ) {\n\n\t\tif ( !Global.isSet( widget ) ) {\n\t\t\twidget = this.edit_view_ui_dic['calendar_url'];\n\t\t}\n\n\t\tif ( this.is_mass_editing ) {\n\t\t\twidget.setValue( 'Not available when mass editing' );\n\t\t\treturn;\n\t\t}\n\n\t\tthis.api['getScheduleIcalendarURL']( this.current_edit_record.user_name, this.current_edit_record.schedule_icalendar_type_id, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar result_data = result.getResult();\n\t\t\t\twidget.setValue( ServiceCaller.root_url + result_data, true );\n\n\t\t\t\twidget.unbind( 'click' ); // First unbind all click events, otherwise, when we change the schedule icalendar type this will trigger several times click events.\n\n\t\t\t\twidget.click( function() {\n\t\t\t\t\twindow.open( widget.text() );\n\t\t\t\t} );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tinitSubScheduleSyncView() {\n\t\tif ( Global.getProductEdition() >= 15 ) {\n\t\t\tthis.edit_view_tab.find( '#tab_schedule_sync' ).find( '.first-column' ).css( 'display', 'block' );\n\t\t\tthis.edit_view.find( '.permission-defined-div' ).css( 'display', 'none' );\n\t\t\tthis.buildContextMenu( true );\n\t\t\tthis.setEditMenu();\n\t\t} else {\n\t\t\tthis.edit_view_tab.find( '#tab_schedule_sync' ).find( '.first-column' ).css( 'display', 'none' );\n\t\t\tthis.edit_view.find( '.permission-defined-div' ).css( 'display', 'block' );\n\t\t\tthis.edit_view.find( '.permission-message' ).html( Global.getUpgradeMessage() );\n\t\t}\n\t}\n\n\tinitSubNotificationView() {\n\t\tif ( this.current_edit_record.notification_status_id == 0 ) {\n\t\t\tthis.edit_view_tab.find( '#tab_preferences_notification' ).find( '.inside-editor-div' ).css( 'display', 'none' );\n\t\t\tthis.edit_view_ui_dic['notification_duration'].parent().parent().parent().css( 'display', 'none' );\n\t\t} else {\n\t\t\tthis.edit_view_tab.find( '#tab_preferences_notification' ).find( '.inside-editor-div' ).css( 'display', 'block' );\n\t\t\tthis.edit_view_ui_dic['notification_duration'].parent().parent().parent().css( 'display', 'block' );\n\t\t}\n\t}\n\n\tinsideEditorSetValue( val ) {\n\t\tvar len = val.length;\n\n\t\tif ( len === 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.removeAllRows();\n\t\tfor ( var i = 0; i < val.length; i++ ) {\n\t\t\tif ( Global.isSet( val[i] ) ) {\n\t\t\t\tvar row = val[i];\n\t\t\t\t//converting status_id and device_id into boolean values to be used for checkboxes\n\t\t\t\trow.enabled = row.status_id == 10;\n\t\t\t\trow.web_push_enabled = row.device_id.includes( 4 );\n\t\t\t\trow.email_work_enabled = row.device_id.includes( 256 );\n\t\t\t\trow.email_home_enabled = row.device_id.includes( 512 );\n\t\t\t\trow.app_push_enabled = row.device_id.includes( 32768 );\n\t\t\t\tif ( row.type_id.startsWith( 'reminder_' ) ) {\n\t\t\t\t\trow.reminder_delay = row.reminder_delay;\n\t\t\t\t}\n\t\t\t\tthis.addRow( row );\n\t\t\t}\n\t\t}\n\t}\n\n\tinsideEditorAddRow( data, index ) {\n\t\tif ( !data ) {\n\t\t\tdata = {};\n\t\t}\n\n\t\tvar row = this.getRowRender(); //Get Row render\n\t\tvar render = this.getRender(); //get render, should be a table\n\t\tvar widgets = {}; //Save each row's widgets\n\n\t\t//Build row widgets\n\n\t\t//Enabled\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'enabled' } );\n\t\tform_item_input.setValue( data.enabled );\n\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\trow.children().eq( 0 ).append( form_item_input );\n\t\tthis.setWidgetEnableBaseOnParentController( form_item_input );\n\n\t\t//Type\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'type_id' } );\n\t\tform_item_input.setSourceData( Global.addFirstItemToArray( this.parent_controller.notification_type_array ) );\n\t\tform_item_input.setValue( data.type_id );\n\t\tform_item_input.setEnabled( false );\n\t\tform_item_input.css( 'text-align-last', 'center' );\n\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\trow.children().eq( 1 ).append( form_item_input );\n\n\t\t//Priority\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'priority_id', set_empty: false } );\n\t\tform_item_input.setSourceData( this.parent_controller.priority_array );\n\t\tform_item_input.setValue( data.priority_id );\n\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\trow.children().eq( 2 ).append( form_item_input );\n\n\t\t//Web Push\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'web_push_enabled' } );\n\t\tform_item_input.setValue( data.web_push_enabled );\n\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\trow.children().eq( 3 ).append( form_item_input );\n\n\t\t//Work Email\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'email_work_enabled' } );\n\t\tform_item_input.setValue( data.email_work_enabled );\n\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\trow.children().eq( 4 ).append( form_item_input );\n\n\t\t//Home Email\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'email_home_enabled' } );\n\t\tform_item_input.setValue( data.email_home_enabled );\n\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\trow.children().eq( 5 ).append( form_item_input );\n\n\t\t//App Push\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'app_push_enabled' } );\n\t\tform_item_input.setValue( data.app_push_enabled );\n\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\trow.children().eq( 6 ).append( form_item_input );\n\n\t\t//Settings\n\t\tif ( data.type_id.startsWith( 'reminder_' ) ) {\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\tform_item_input.TTextInput( { field: 'reminder_delay', need_parser_sec: true, mode: 'time_unit' } );\n\t\t\tform_item_input.setValue( data.reminder_delay );\n\t\t\twidgets[form_item_input.getField()] = form_item_input;\n\n\t\t\tvar widgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\t\tvar label = $( '<span class=\\'widget-left-label\\'> ' + $.i18n._( 'Delay' ) + ': </span>' );\n\n\t\t\twidgetContainer.append( label );\n\t\t\twidgetContainer.append( form_item_input );\n\n\t\t\trow.children().eq( 7 ).append( widgetContainer );\n\t\t}\n\n\t\t//Save current set item\n\t\twidgets.current_edit_item = data;\n\n\t\tif ( typeof index != 'undefined' ) {\n\n\t\t\trow.insertAfter( $( render ).find( 'tr' ).eq( index ) );\n\t\t\tthis.rows_widgets_array.splice( ( index ), 0, widgets );\n\n\t\t} else {\n\t\t\t$( render ).append( row );\n\t\t\tthis.rows_widgets_array.push( widgets );\n\t\t}\n\n\t\tif ( this.parent_controller.is_viewing ) {\n\t\t\trow.find( '.control-icon' ).hide();\n\t\t}\n\n\t\tthis.removeLastRowLine();\n\t}\n\n\tinsideEditorGetValue( current_edit_item_id ) {\n\n\t\tvar len = this.rows_widgets_array.length;\n\n\t\tvar result = [];\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar row = this.rows_widgets_array[i];\n\t\t\tvar data = row.current_edit_item;\n\t\t\tdata.priority_id = row.priority_id.getValue();\n\t\t\tdata.status_id = row.enabled.getValue() === true ? 10 : 20;\n\t\t\tdata.device_id = [];\n\t\t\tif ( row.web_push_enabled.getValue() === true )\n\t\t\t\tdata.device_id.push( 4 );\n\t\t\tif ( row.email_work_enabled.getValue() === true )\n\t\t\t\tdata.device_id.push( 256 );\n\t\t\tif ( row.email_home_enabled.getValue() === true )\n\t\t\t\tdata.device_id.push( 512 );\n\t\t\tif ( row.app_push_enabled.getValue() === true )\n\t\t\t\tdata.device_id.push( 32768 );\n\n\t\t\tif ( data.type_id.startsWith( 'reminder_' ) && row.reminder_delay ) {\n\t\t\t\tdata.reminder_delay = row.reminder_delay.getValue();\n\t\t\t}\n\n\t\t\tresult.push( data );\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tonSaveResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result && result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\n\t\t\tif ( this.is_mass_editing == false ) {\n\t\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t\tvar on_save_done_result = $this.onSaveDone( result );\n\t\t\t\t\tif ( on_save_done_result == undefined || on_save_done_result == true ) {\n\t\t\t\t\t\t$this.removeEditView();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\t$this.removeEditView();\n\t\t\t}\n\n\t\t} else {\n\t\t\t$this.setErrorMenu();\n\t\t\t$this.setErrorTips( result );\n\t\t}\n\t}\n\n\tsaveInsideEditorData( callBack ) {\n\t\tvar data = this.editor.getValue( this.refresh_id );\n\n\t\tlet changed_data = this.getChangedRecords( data, this.original_user_preference_notification_data, ['enabled', 'web_push_enabled', 'email_work_enabled', 'email_home_enabled', 'app_push_enabled'] );\n\n\t\tif ( Array.isArray( changed_data ) && changed_data.length > 0 ) {\n\t\t\tthis.user_preference_notification_api.setUserPreferenceNotification( changed_data, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tif ( Global.isSet( callBack ) ) {\n\t\t\t\t\t\tcallBack();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\tif ( Global.isSet( callBack ) ) {\n\t\t\t\tcallBack();\n\t\t\t}\n\t\t}\n\t}\n\n\tonSaveDone( result ) {\n\t\t// #2224 - Don't use current_edit_record here, use getSelectedItem() instead, or it causes:\n\t\t// Uncaught Error From: UserPreferenceView Error: Unable to get property 'id' of undefined or null reference\n\t\tvar user_id = this.getSelectedItem().id;\n\n\t\tif ( user_id === LocalCacheData.getLoginUser().id ) {\n\t\t\tGlobal.updateUserPreference();\n\t\t}\n\t}\n\n\tonSaveAndContinueDone( result ) {\n\t\tthis.onSaveDone( result );\n\t\tthis.initInsideEditorData();\n\t}\n\n\tonSaveAndNextDone( result ) {\n\t\tthis.onSaveDone( result );\n\t}\n\n\tvalidate() {\n\t\tvar $this = this;\n\n\t\tvar record = {};\n\n\t\tif ( this.is_mass_editing ) {\n\t\t\tfor ( var key in this.edit_view_ui_dic ) {\n\t\t\t\tvar widget = this.edit_view_ui_dic[key];\n\n\t\t\t\tif ( Global.isSet( widget.isChecked ) ) {\n\t\t\t\t\tif ( widget.isChecked() && widget.getEnabled() ) {\n\t\t\t\t\t\trecord[key] = widget.getValue();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( this.mass_edit_record_ids.length > 0 ) {\n\t\t\t\trecord.id = this.mass_edit_record_ids[0];\n\t\t\t}\n\t\t} else {\n\t\t\trecord = this.current_edit_record;\n\t\t}\n\t\tthis.api['validate' + this.api.key_name]( record, {\n\t\t\tonResult: function( result ) {\n\n\t\t\t\t$this.validateResult( result );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tgetPreferencesNotificationTabHtml() {\n\t\treturn `<div id=\"tab_preferences_notification\" class=\"edit-view-tab-outside\">\n\t\t\t\t\t<div class=\"edit-view-tab\" id=\"tab_preferences_notification_content_div\">\n\t\t\t\t\t\t<div class=\"first-column full-width-column\"></div>\n\t\t\t\t\t\t<div class=\"inside-editor-div full-width-column\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`;\n\t}\n\n\tgetScheduleSyncronizationTabHtml() {\n\t\treturn `<div id=\"tab_schedule_sync\" class=\"edit-view-tab-outside\">\n\t\t\t\t\t<div class=\"edit-view-tab\" id=\"tab_schedule_sync_content_div\">\n\t\t\t\t\t\t<div class=\"first-column full-width-column\"></div>\n\t\t\t\t\t\t<div class=\"save-and-continue-div permission-defined-div\">\n\t\t\t\t\t\t\t<span class=\"message permission-message\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`;\n\t}\n\n\tsetSubLogViewFilter() {\n\t\tif ( !this.sub_log_view_controller ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.sub_log_view_controller.getSubViewFilter = function( filter ) {\n\t\t\tfilter['table_name_object_id'] = {\n\t\t\t\t'user_preference': [this.parent_edit_record.id],\n\t\t\t\t'user_preference_notification': this.parent_view_controller.editor.getValue( this.refresh_id ).map( preference => preference.id )\n\t\t\t};\n\n\t\t\treturn filter;\n\t\t};\n\n\t\treturn true;\n\t}\n\n}\n\nUserPreferenceViewController.loadView = function() {\n\tGlobal.loadViewSource( 'UserPreference', 'UserPreferenceView.html', function( result ) {\n\t\tvar args = {};\n\t\t//var template = _.template( result, args );\n\n\t\tGlobal.contentContainer().html( result );\n\t} );\n};"],"names":["UserPreferenceViewController","options","_","$","context_menu_model","$this","res","filter","data","array_data","key","a","b","p","val","m","refresh","province_widget","combo","select_value","selectVal","target","doNotValidate","c_value","tab_model","tab_preference","tab_preference_column1","form_item_input","widgetContainer","label","tab_preferences_notification","tab_preferences_notification_column1","getRender","getRowRender","inside_editor_div","args","tab_schedule_sync","tab_schedule_sync_column1","grid_selected_id_array","index","value","result","result_data","widget","len","i","row","render","widgets","current_edit_item_id","on_save_done_result","callBack","changed_data","user_id","record","preference"],"mappings":"uDAAO,MAAMA,UAAqC,kBAAmB,CACpE,YAAaC,EAAU,GAAK,CAC3BC,EAAE,SAAUD,EAAS,CACpB,GAAI,kCAEJ,kBAAmB,KACnB,wBAAyB,KACzB,qBAAsB,KACtB,uBAAwB,KACxB,yBAA0B,KAC1B,kBAAmB,KACnB,qBAAsB,KACtB,uBAAwB,KACxB,uBAAwB,KACxB,uBAAwB,KACxB,sBAAuB,KACvB,gBAAiB,KACjB,wBAAyB,KACzB,yBAA0B,KAC1B,qBAAsB,KACtB,qBAAsB,KACtB,8BAA+B,KAC/B,eAAgB,KAChB,iBAAkB,KAClB,cAAe,KACf,eAAgB,KAEhB,0BAA2B,KAC3B,wBAAyB,KACzB,eAAgB,KAChB,2CAA4C,CAAE,EAE9C,iBAAkB,KAClB,SAAU,KACV,eAAgB,KAChB,YAAa,KAEb,SAAU,KAEV,iCAAkC,IACrC,GAEE,MAAOA,CAAO,CACd,CAED,KAAMA,EAAU,CAGf,KAAK,cAAgB,8BACrB,KAAK,cAAgB,kBACrB,KAAK,OAAS,iBACd,KAAK,YAAc,qBACnB,KAAK,eAAiB,kBACtB,KAAK,kBAAoBE,EAAE,KAAK,EAAG,aAAa,EAChD,KAAK,iBAAmBA,EAAE,KAAK,EAAG,WAAW,EAC7C,KAAK,IAAM,MAAM,kBACjB,KAAK,SAAW,MAAM,UACtB,KAAK,SAAW,MAAM,QACtB,KAAK,eAAiB,MAAM,aAC5B,KAAK,YAAc,MAAM,WACzB,KAAK,iCAAmC,MAAM,8BAE9C,KAAK,OAAM,EAEX,KAAK,iBAAgB,EAIrB,KAAK,SAAQ,CACb,CAED,2BAA4B,CAC3B,IAAIC,EAAqB,CACxB,QAAS,CACR,MACA,OACA,cACA,gBACA,eACA,cACA,iBACA,EACD,QAAS,CAAE,CACd,EAEE,OAAOA,CACP,CAED,aAAc,CAEb,IAAIC,EAAQ,KAERJ,EAAU,CACb,CAAE,YAAa,SAAU,IAAK,KAAK,QAAU,EAC7C,CAAE,YAAa,UAAW,WAAY,UAAW,IAAK,KAAK,WAAa,EACxE,CAAE,YAAa,WAAY,IAAK,KAAK,GAAK,EAC1C,CAAE,YAAa,cAAe,IAAK,KAAK,GAAK,EAC7C,CAAE,YAAa,cAAe,IAAK,KAAK,GAAK,EAC7C,CAAE,YAAa,mBAAoB,IAAK,KAAK,GAAK,EAClD,CAAE,YAAa,kBAAmB,IAAK,KAAK,GAAK,EACjD,CAAE,YAAa,YAAa,IAAK,KAAK,GAAK,EAC3C,CAAE,YAAa,iBAAkB,IAAK,KAAK,GAAK,EAChD,CAAE,YAAa,0BAA2B,IAAK,KAAK,GAAK,EACzD,CAAE,YAAa,uBAAwB,IAAK,KAAK,GAAK,EACtD,CAAE,YAAa,sBAAuB,IAAK,KAAK,GAAK,EACrD,CAAE,YAAa,oBAAqB,IAAK,KAAK,gCAAkC,EAChF,CAAE,YAAa,WAAY,IAAK,KAAK,gCAAkC,CAC1E,EAEE,KAAK,oBAAqBA,GAE1B,KAAK,eAAe,aAAc,GAAI,GAAO,GAAO,CACnD,SAAU,SAAUK,EAAM,CACzBA,EAAMA,EAAI,YACVA,EAAM,OAAO,gBAAiBA,GAC9BD,EAAM,iBAAmBC,EACpB,CAACD,EAAM,eAAiBA,EAAM,0BAA0B,WAC5DA,EAAM,0BAA0B,SAAY,cAAeC,CAAG,EAC9DD,EAAM,wBAAwB,SAAY,cAAeC,CAAG,EAG7D,CACJ,EACE,CAED,sBAAuB,CACtB,IAAID,EAAQ,KAERE,EAAS,CAAA,EACbA,EAAO,YAAc,GACrBA,EAAO,YAAY,QAAU,KAAK,oBAAoB,QAEtDF,EAAM,iCAAiC,8BAA+BE,EAAQ,GAAM,CACnF,SAAU,SAAUD,EAAM,CAEzB,IAAIE,EAAOF,EAAI,YACXG,EAAa,CAAA,EACjB,QAAUC,KAAOF,EAEVA,EAAK,eAAgBE,IAI3BD,EAAW,KAAMD,EAAKE,CAAG,CAAC,EAE3BD,EAAaA,EAAW,KAAM,SAAUE,EAAGC,EAAI,CAC9C,OAAOP,EAAM,wBAAwB,UAAWQ,GAAKA,EAAE,KAAOF,EAAE,OAAO,EAAKN,EAAM,wBAAwB,UAAWQ,GAAKA,EAAE,KAAOD,EAAE,QAC1I,GAEIP,EAAM,2CAA8CH,EAAE,IAAIO,EAAYP,EAAE,KAAK,EAE7EG,EAAM,OAAO,SAAUI,EAEvB,CACJ,EACE,CAED,YAAaK,EAAKC,EAAI,CACrB,IAAIV,EAAQ,KAEP,CAACS,GAAOA,IAAQ,MAAQA,IAAQ,KACpCT,EAAM,eAAiB,GACvB,KAAK,wBAAwB,SAAY,cAAe,CAAE,CAAA,GAE1D,KAAK,YAAY,WAAY,WAAYS,EAAK,CAC7C,SAAU,SAAUR,EAAM,CACzBA,EAAMA,EAAI,YACJA,IACLA,EAAM,CAAA,GAGPD,EAAM,eAAiB,OAAO,iBAAkBC,CAAG,EACnDD,EAAM,wBAAwB,SAAY,cAAeA,EAAM,eAE/D,CACL,EAEE,CAED,aAAcS,EAAKE,EAAU,CAC5B,IAAIX,EAAQ,KACRY,EAAkBZ,EAAM,iBAAiB,SAExC,CAACS,GAAOA,IAAQ,MAAQA,IAAQ,KACpCT,EAAM,iBAAmB,GACzBY,EAAgB,cAAe,CAAA,IAE/B,KAAK,YAAY,WAAY,WAAYH,EAAK,CAC7C,SAAU,SAAUR,EAAM,CACzBA,EAAMA,EAAI,YACJA,IACLA,EAAM,CAAA,GAGPD,EAAM,iBAAmB,OAAO,iBAAkBC,CAAG,EAEhDU,GAAWX,EAAM,iBAAiB,OAAS,IAC/CA,EAAM,oBAAoB,SAAWA,EAAM,iBAAiB,CAAC,EAAE,MAC/DY,EAAgB,SAAUZ,EAAM,oBAAoB,QAAQ,GAE7DY,EAAgB,cAAeZ,EAAM,iBAErC,CACL,EAEE,CAED,2BAA4B,CAE3B,GAAK,KAAK,aAAa,kBAAiB,IAAO,EAAI,CAClD,IAAIa,EAAQ,KAAK,wBAAwB,QACrCC,EAAeD,EAAM,WACzB,KAAK,YAAaC,EAClB,CACD,CAED,sBAAuB,CAEtB,KAAK,wBAAwB,QAAW,OAAQhB,EAAE,MAAO,UAAW,CACnE,IAAIe,EAAQ,KAAK,wBAAwB,QACrCE,EAAYF,EAAM,WAEtB,KAAK,YAAaE,GAElB,KAAK,wBAAwB,SAAY,SAAU,IAAI,CAE1D,EAAK,IAAM,CAAA,CACT,CAED,mBAAoB,CAEnB,KAAK,cAAgB,CACpB,IAAI,YAAa,CAChB,MAAOjB,EAAE,KAAK,EAAG,UAAY,EAC7B,UAAW,EACX,MAAO,UACP,SAAU,GACV,aAAc,GACd,WAAY,GACZ,YAAa,cACb,UAAW,MAAM,QACjB,eAAgB,aAAa,WACjC,CAAM,EACH,IAAI,YAAa,CAChB,MAAOA,EAAE,KAAK,EAAG,QAAU,EAC3B,UAAW,EACX,MAAO,YACP,SAAU,GACV,aAAc,GACd,WAAY,GACZ,YAAa,uBACb,eAAgB,aAAa,WACjC,CAAM,EACH,IAAI,YAAa,CAChB,MAAOA,EAAE,KAAK,EAAG,YAAc,EAC/B,UAAW,EACX,MAAO,aACP,aAAc,GACd,WAAY,GACZ,eAAgB,aAAa,UACjC,CAAM,EACH,IAAI,YAAa,CAChB,MAAOA,EAAE,KAAK,EAAG,WAAa,EAC9B,UAAW,EACX,MAAO,YACP,aAAc,GACd,WAAY,GACZ,eAAgB,aAAa,UACjC,CAAM,EACH,IAAI,YAAa,CAChB,MAAOA,EAAE,KAAK,EAAG,iBAAmB,EACpC,UAAW,EACX,MAAO,kBACP,aAAc,GACd,WAAY,GACZ,eAAgB,aAAa,UACjC,CAAM,EACH,IAAI,YAAa,CAChB,MAAOA,EAAE,KAAK,EAAG,OAAS,EAC1B,UAAW,EACX,SAAU,GACV,MAAO,WACP,YAAa,qBACb,UAAW,GACX,aAAc,GACd,WAAY,GACZ,eAAgB,aAAa,WACjC,CAAM,EACH,IAAI,YAAa,CAChB,MAAOA,EAAE,KAAK,EAAG,gBAAkB,EACnC,UAAW,EACX,MAAO,oBACP,YAAa,gBACb,UAAW,MAAM,UACjB,SAAU,GACV,aAAc,GACd,WAAY,GACZ,eAAgB,aAAa,WACjC,CAAM,EACH,IAAI,YAAa,CAChB,MAAOA,EAAE,KAAK,EAAG,oBAAsB,EACvC,MAAO,wBACP,UAAW,EACX,YAAa,oBACb,UAAW,MAAM,cACjB,SAAU,GACV,aAAc,GACd,WAAY,GACZ,eAAgB,aAAa,WACjC,CAAM,EAEH,IAAI,YAAa,CAChB,MAAOA,EAAE,KAAK,EAAG,OAAS,EAC1B,MAAO,WACP,UAAW,EACX,YAAa,mBACb,UAAW,MAAM,aACjB,SAAU,GACV,aAAc,GACd,WAAY,GACZ,eAAgB,aAAa,WACjC,CAAM,EACH,IAAI,YAAa,CAChB,MAAOA,EAAE,KAAK,EAAG,SAAW,EAC5B,UAAW,EACX,MAAO,UACP,SAAU,GACV,aAAc,GACd,WAAY,GACZ,YAAa,uBACb,eAAgB,aAAa,SACjC,CAAM,EACH,IAAI,YAAa,CAChB,MAAOA,EAAE,KAAK,EAAG,gBAAkB,EACnC,UAAW,EACX,MAAO,WACP,SAAU,GACV,aAAc,GACd,WAAY,GACZ,YAAa,uBACb,eAAgB,aAAa,WACjC,CAAM,CAEN,CACE,CAED,iBAAkBkB,EAAQC,EAAgB,CACzC,KAAK,aAAcD,GACnB,KAAK,mCAAoCA,GACzC,IAAIX,EAAMW,EAAO,WACbE,EAAUF,EAAO,WACrB,KAAK,oBAAoBX,CAAG,EAAIa,EAE3Bb,IAAQ,6BAEZ,KAAK,eAAc,EACRA,IAAQ,0BACnB,KAAK,wBAAuB,EAGvBY,GACL,KAAK,SAAQ,CAEd,CAED,iBAAkB,CACjB,MAAM,gBAAe,EAErB,IAAIjB,EAAQ,KAERmB,EAAY,CACf,eAAkB,CAAE,MAASrB,EAAE,KAAK,EAAG,cAAiB,EACxD,6BAAgC,CAC/B,MAASA,EAAE,KAAK,EAAG,eAAiB,EACpC,cAAiB,0BACjB,cAAiB,KAAK,kCAAmC,CACzD,EACD,kBAAqB,CACpB,MAASA,EAAE,KAAK,EAAG,0BAA4B,EAC/C,cAAiB,0BACjB,cAAiB,KAAK,iCAAkC,CACxD,EACD,UAAa,EAChB,EACE,KAAK,YAAaqB,GAElB,KAAK,WAAW,UAAW,CAC1B,GAAI,KAAK,YAAc,cACvB,UAAW,MAAM,kBACjB,yBAA0B,GAC1B,YAAa,yBACb,gBAAiB,GACjB,mBAAoB,EACvB,GAEE,KAAK,cAAa,EAIlB,IAAIC,EAAiB,KAAK,cAAc,KAAM,iBAAiB,EAE3DC,EAAyBD,EAAe,KAAM,eAAe,EAEjE,KAAK,eAAe,CAAC,EAAI,GAEzB,KAAK,eAAe,CAAC,EAAE,KAAMC,CAAsB,EAEnD,IAAIC,EACAC,EACAC,EAEE,KAAK,kBAEVF,EAAkB,OAAO,iBAAkB,aAAa,IAAI,EAC5DA,EAAgB,MAAO,CAAE,MAAO,WAAa,CAAA,EAC7C,KAAK,qBAAsBxB,EAAE,KAAK,EAAG,UAAU,EAAIwB,EAAiBD,EAAwB,KAI7FC,EAAkB,OAAO,iBAAkB,aAAa,SAAS,EACjEA,EAAgB,UAAW,CAAE,MAAO,WAAY,UAAW,EAAI,GAC/DA,EAAgB,cAAetB,EAAM,gBACrC,KAAK,qBAAsBF,EAAE,KAAK,EAAG,UAAY,EAAEwB,EAAiBD,GAGpEC,EAAkB,OAAO,iBAAkB,aAAa,SAAS,EACjEA,EAAgB,UAAW,CAAE,MAAO,cAAe,UAAW,EAAI,GAClEA,EAAgB,cAAetB,EAAM,mBACrC,KAAK,qBAAsBF,EAAE,KAAK,EAAG,aAAe,EAAEwB,EAAiBD,GAGvEC,EAAkB,OAAO,iBAAkB,aAAa,SAAS,EACjEA,EAAgB,UAAW,CAAE,MAAO,cAAe,UAAW,EAAI,GAClEA,EAAgB,cAAetB,EAAM,mBACrC,KAAK,qBAAsBF,EAAE,KAAK,EAAG,aAAe,EAAEwB,EAAiBD,GAGvEC,EAAkB,OAAO,iBAAkB,aAAa,SAAS,EACjEA,EAAgB,UAAW,CAAE,MAAO,mBAAoB,UAAW,EAAI,GACvEA,EAAgB,cAAetB,EAAM,wBACrC,KAAK,qBAAsBF,EAAE,KAAK,EAAG,YAAc,EAAEwB,EAAiBD,GAGtEC,EAAkB,OAAO,iBAAkB,aAAa,SAAS,EACjEA,EAAgB,UAAW,CAAE,MAAO,kBAAmB,UAAW,EAAI,GACtEA,EAAgB,cAAetB,EAAM,uBACrC,KAAK,qBAAsBF,EAAE,KAAK,EAAG,gBAAkB,EAAEwB,EAAiBD,GAG1EC,EAAkB,OAAO,iBAAkB,aAAa,SAAS,EACjEA,EAAgB,UAAW,CAAE,MAAO,YAAa,UAAW,EAAI,GAChEA,EAAgB,cAAetB,EAAM,iBACrC,KAAK,qBAAsBF,EAAE,KAAK,EAAG,WAAa,EAAEwB,EAAiBD,GAGrEC,EAAkB,OAAO,iBAAkB,aAAa,SAAS,EACjEA,EAAgB,UAAW,CAAE,MAAO,gBAAkB,CAAA,EACtDA,EAAgB,cAAetB,EAAM,sBACrC,KAAK,qBAAsBF,EAAE,KAAK,EAAG,oBAAsB,EAAEwB,EAAiBD,GAG9EC,EAAkB,OAAO,iBAAkB,aAAa,UAAU,EAClEA,EAAgB,WAAY,CAAE,MAAO,iBAAkB,MAAO,EAAE,GAChE,KAAK,qBAAsBxB,EAAE,KAAK,EAAG,eAAiB,EAAEwB,EAAiBD,GAGzEC,EAAkB,OAAO,iBAAkB,aAAa,SAAS,EACjEA,EAAgB,UAAW,CAAE,MAAO,sBAAwB,CAAA,EAC5DA,EAAgB,cAAetB,EAAM,4BACrC,KAAK,qBAAsBF,EAAE,KAAK,EAAG,gBAAkB,EAAEwB,EAAiBD,GAG1EC,EAAkB,OAAO,iBAAkB,aAAa,QAAQ,EAChEA,EAAgB,UAAW,CAAE,MAAO,6BAA+B,CAAA,EACnE,KAAK,qBAAsBxB,EAAE,KAAK,EAAG,sBAAwB,EAAEwB,EAAiBD,GAIhF,IAAII,EAA+B,KAAK,cAAc,KAAM,+BAA+B,EAEvFC,EAAuCD,EAA6B,KAAM,eAAe,EAwB7F,GAtBA,KAAK,eAAe,CAAC,EAAI,GAEzB,KAAK,eAAe,CAAC,EAAE,KAAMC,CAAoC,EAGjEJ,EAAkB,OAAO,iBAAkB,aAAa,SAAS,EACjEA,EAAgB,UAAW,CAAE,MAAO,wBAA0B,CAAA,EAC9DA,EAAgB,cAAe,OAAO,oBAAqBtB,EAAM,yBAAyB,GAC1F,KAAK,qBAAsBF,EAAE,KAAK,EAAG,qBAAuB,EAAEwB,EAAiBI,GAG/EJ,EAAkB,OAAO,iBAAkB,aAAa,UAAU,EAClEA,EAAgB,WAAY,CAAE,MAAO,wBAAyB,MAAO,EAAE,GAEvEC,EAAkBzB,EAAG,oCACrB0B,EAAQ1B,EAAG,qCAAyCA,EAAE,KAAK,EAAG,gCAAmC,WAEjGyB,EAAgB,OAAQD,GACxBC,EAAgB,OAAQC,GAExB,KAAK,qBAAsB1B,EAAE,KAAK,EAAG,2BAA6B,EAAEwB,EAAiBI,EAAsC,GAAIH,CAAe,EAEzI,KAAK,iBAAmB,GAAQ,CA2BpC,IAASI,EAAT,UAAqB,CACpB,MAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAaP,EAEQC,EAAT,UAAwB,CACvB,MAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAWP,EAtDD,IAAIC,EAAoBJ,EAA6B,KAAM,oBAAoB,EAC3EK,EAAO,CACV,QAAShC,EAAE,KAAK,EAAG,SAAW,EAC9B,KAAMA,EAAE,KAAK,EAAG,MAAQ,EACxB,IAAKA,EAAE,KAAK,EAAG,SAAW,EAC1B,WAAYA,EAAE,KAAK,EAAG,YAAc,EACpC,WAAYA,EAAE,KAAK,EAAG,YAAc,EACpC,IAAKA,EAAE,KAAK,EAAG,YAAc,EAC7B,SAAUA,EAAE,KAAK,EAAG,UAAY,EAChC,SAAUA,EAAE,KAAK,EAAG,UAAY,CACpC,EAEG,KAAK,OAAS,OAAO,iBAAkB,aAAa,aAAa,EAEjE,KAAK,OAAO,aAAc,CACzB,MAAO,GACP,OAAQ,KAAK,mBACb,SAAU,KAAK,qBACf,SAAU,KAAK,qBACf,kBAAmB,KACnB,OAAQ6B,EAAW,EACnB,YAAaG,EACb,mBAAoB,GACpB,WAAYF,EAAc,CAC9B,GAgCGC,EAAkB,OAAQ,KAAK,OAC/B,CAID,IAAIE,EAAoB,KAAK,cAAc,KAAM,oBAAoB,EAEjEC,EAA4BD,EAAkB,KAAM,eAAe,EAEvE,KAAK,eAAe,CAAC,EAAI,GAEzB,KAAK,eAAe,CAAC,EAAE,KAAMC,CAAyB,EAetDV,EAAkB,OAAO,iBAAkB,aAAa,aAAa,EACrEA,EAAgB,aAAc,CAAE,MAAOxB,EAAE,KAAK,EAAG,0BAA4B,CAAA,GAC7E,KAAK,qBAAsB,KAAMwB,EAAiBU,EAA2B,GAAI,KAAM,GAAM,GAAO,4BAGpGV,EAAkB,OAAO,iBAAkB,aAAa,UAAU,EAClEA,EAAgB,WAAY,CAAE,MAAO,oCAAqC,MAAO,GAAI,gBAAiB,EAAI,GAE1GC,EAAkBzB,EAAG,oCACrB0B,EAAQ1B,EAAG,sCAA0CA,EAAE,KAAK,EAAG,8BAAiC,aAEhGyB,EAAgB,OAAQD,GACxBC,EAAgB,OAAQC,GAExB,KAAK,qBAAsB1B,EAAE,KAAK,EAAG,WAAawB,EAAiBU,EAA2B,GAAIT,EAAiB,EAAI,EAIvHD,EAAkB,OAAO,iBAAkB,aAAa,UAAU,EAClEA,EAAgB,WAAY,CAAE,MAAO,oCAAqC,MAAO,GAAI,gBAAiB,EAAI,GAE1GC,EAAkBzB,EAAG,oCACrB0B,EAAQ1B,EAAG,sCAA0CA,EAAE,KAAK,EAAG,8BAAiC,aAEhGyB,EAAgB,OAAQD,GACxBC,EAAgB,OAAQC,GAExB,KAAK,qBAAsB1B,EAAE,KAAK,EAAG,WAAawB,EAAiBU,EAA2B,GAAIT,EAAiB,EAAI,EAIvHD,EAAkB,OAAO,iBAAkB,aAAa,aAAa,EACrEA,EAAgB,aAAc,CAAE,MAAOxB,EAAE,KAAK,EAAG,yBAA2B,CAAA,GAC5E,KAAK,qBAAsB,KAAMwB,EAAiBU,EAA2B,GAAI,KAAM,GAAM,GAAO,2BAGpGV,EAAkB,OAAO,iBAAkB,aAAa,UAAU,EAClEA,EAAgB,WAAY,CAAE,MAAO,oCAAqC,MAAO,GAAI,gBAAiB,EAAI,GAE1GC,EAAkBzB,EAAG,oCACrB0B,EAAQ1B,EAAG,sCAA0CA,EAAE,KAAK,EAAG,8BAAiC,aAEhGyB,EAAgB,OAAQD,GACxBC,EAAgB,OAAQC,GAExB,KAAK,qBAAsB1B,EAAE,KAAK,EAAG,WAAawB,EAAiBU,EAA2B,GAAIT,EAAiB,EAAI,EAIvHD,EAAkB,OAAO,iBAAkB,aAAa,UAAU,EAClEA,EAAgB,WAAY,CAAE,MAAO,oCAAqC,MAAO,GAAI,gBAAiB,EAAI,GAE1GC,EAAkBzB,EAAG,oCACrB0B,EAAQ1B,EAAG,sCAA0CA,EAAE,KAAK,EAAG,8BAAiC,aAEhGyB,EAAgB,OAAQD,GACxBC,EAAgB,OAAQC,GAExB,KAAK,qBAAsB1B,EAAE,KAAK,EAAG,WAAawB,EAAiBU,EAA2B,GAAIT,EAAiB,EAAI,EAIvHD,EAAkB,OAAO,iBAAkB,aAAa,aAAa,EACrEA,EAAgB,aAAc,CAAE,MAAOxB,EAAE,KAAK,EAAG,iBAAmB,CAAA,GACpE,KAAK,qBAAsB,KAAMwB,EAAiBU,EAA2B,GAAI,KAAM,GAAM,GAAO,mBAGpGV,EAAkB,OAAO,iBAAkB,aAAa,UAAU,EAClEA,EAAgB,WAAY,CAAE,MAAO,qCAAsC,MAAO,GAAI,gBAAiB,EAAI,GAE3GC,EAAkBzB,EAAG,oCACrB0B,EAAQ1B,EAAG,sCAA0CA,EAAE,KAAK,EAAG,8BAAiC,aAEhGyB,EAAgB,OAAQD,GACxBC,EAAgB,OAAQC,GAExB,KAAK,qBAAsB1B,EAAE,KAAK,EAAG,WAAawB,EAAiBU,EAA2B,GAAIT,EAAiB,EAAI,EAIvHD,EAAkB,OAAO,iBAAkB,aAAa,UAAU,EAClEA,EAAgB,WAAY,CAAE,MAAO,qCAAsC,MAAO,GAAI,gBAAiB,EAAI,GAE3GC,EAAkBzB,EAAG,oCACrB0B,EAAQ1B,EAAG,sCAA0CA,EAAE,KAAK,EAAG,8BAAiC,aAEhGyB,EAAgB,OAAQD,GACxBC,EAAgB,OAAQC,GAExB,KAAK,qBAAsB1B,EAAE,KAAK,EAAG,WAAawB,EAAiBU,EAA2B,GAAIT,EAAiB,EAAI,CACvH,CAED,iBAAkB,CAEjB,IAAIvB,EAAQ,KACZA,EAAM,OAAS,GACfA,EAAM,WAAa,GACnBA,EAAM,gBAAkB,GACxB,eAAe,6BAA+B,YAC9CA,EAAM,aAAY,EAClB,IAAIE,EAAS,CAAA,EACT+B,EAAyB,KAAK,uBACPA,EAAuB,OAClD,KAAK,qBAAuB,GAE5BnC,EAAE,KAAMmC,EAAwB,SAAUC,EAAOC,EAAQ,CACxDnC,EAAM,qBAAqB,KAAMmC,EACpC,GAEEjC,EAAO,YAAc,GACrBA,EAAO,YAAY,GAAK,KAAK,qBAE7B,KAAK,IAAI,YAAc,KAAK,IAAI,SAAW,MAAM,EAAGA,EAAQ,CAC3D,SAAU,SAAUkC,EAAS,CAC5B,IAAIC,EAAcD,EAAO,YAEnBC,IACLA,EAAc,CAAA,GAGfrC,EAAM,eAAiB,GACvBA,EAAM,eAAiB,GAEvBA,EAAM,oBAAsBqC,EAC5BrC,EAAM,aAAY,CAElB,CACJ,EACE,CAED,gBAAiB,CAEX,KAAK,oBAAoB,4BAA8B,GAE3D,KAAK,cAAe,qCACpB,KAAK,cAAe,qCACpB,KAAK,cAAe,qCACpB,KAAK,cAAe,qCACpB,KAAK,cAAe,sCACpB,KAAK,cAAe,sCACpB,KAAK,cAAe,4BACpB,KAAK,cAAe,2BACpB,KAAK,cAAe,qBAKpB,KAAK,cAAe,qCACpB,KAAK,cAAe,qCACpB,KAAK,cAAe,qCACpB,KAAK,cAAe,qCACpB,KAAK,cAAe,sCACpB,KAAK,cAAe,sCACpB,KAAK,cAAe,4BACpB,KAAK,cAAe,2BACpB,KAAK,cAAe,oBAGrB,KAAK,gBAAe,CACpB,CAED,0BAA2B,CAI1B,QAAUK,KAAO,KAAK,oBAAsB,CAC3C,IAAIiC,EAAS,KAAK,iBAAiBjC,CAAG,EACtC,GAAK,OAAO,MAAOiC,GAClB,OAASjC,EAAG,CACX,IAAK,YACJiC,EAAO,SAAU,KAAK,oBAAoB,WAAgB,IAAM,KAAK,oBAAoB,WACzF,MAUD,QACCA,EAAO,SAAU,KAAK,oBAAoBjC,CAAG,CAAC,EAC9C,KACD,CAGF,CAED,KAAK,iCAAgC,EAErC,KAAK,oBAAmB,CACxB,CAED,qBAAsB,CACrB,MAAM,oBAAmB,EACzB,KAAK,eAAc,EACd,KAAK,iBAAmB,IAC5B,KAAK,qBAAoB,CAE1B,CAED,eAAgBiC,EAAS,CAMxB,GAJM,OAAO,MAAOA,KACnBA,EAAS,KAAK,iBAAiB,cAG3B,KAAK,gBAAkB,CAC3BA,EAAO,SAAU,mCACjB,MACA,CAED,KAAK,IAAI,wBAA4B,KAAK,oBAAoB,UAAW,KAAK,oBAAoB,2BAA4B,CAC7H,SAAU,SAAUF,EAAS,CAC5B,IAAIC,EAAcD,EAAO,YACzBE,EAAO,SAAU,cAAc,SAAWD,EAAa,EAAI,EAE3DC,EAAO,OAAQ,SAEfA,EAAO,MAAO,UAAW,CACxB,OAAO,KAAMA,EAAO,KAAM,CAAA,CAC/B,EAEI,CACJ,EACE,CAED,yBAA0B,CACpB,OAAO,kBAAmB,GAAI,IAClC,KAAK,cAAc,KAAM,sBAAuB,KAAM,eAAe,EAAG,IAAK,UAAW,SACxF,KAAK,UAAU,KAAM,yBAA2B,EAAC,IAAK,UAAW,QACjE,KAAK,iBAAkB,IACvB,KAAK,YAAW,IAEhB,KAAK,cAAc,KAAM,sBAAuB,KAAM,eAAe,EAAG,IAAK,UAAW,QACxF,KAAK,UAAU,KAAM,yBAA2B,EAAC,IAAK,UAAW,SACjE,KAAK,UAAU,KAAM,qBAAqB,EAAG,KAAM,OAAO,kBAAiB,GAE5E,CAED,yBAA0B,CACpB,KAAK,oBAAoB,wBAA0B,GACvD,KAAK,cAAc,KAAM,iCAAkC,KAAM,oBAAoB,EAAG,IAAK,UAAW,QACxG,KAAK,iBAAiB,sBAAyB,OAAM,EAAG,SAAS,SAAS,IAAK,UAAW,MAAM,IAEhG,KAAK,cAAc,KAAM,iCAAkC,KAAM,oBAAoB,EAAG,IAAK,UAAW,SACxG,KAAK,iBAAiB,sBAAyB,OAAM,EAAG,SAAS,SAAS,IAAK,UAAW,OAAO,EAElG,CAED,qBAAsB7B,EAAM,CAC3B,IAAI8B,EAAM9B,EAAI,OAEd,GAAK8B,IAAQ,EAIb,MAAK,cAAa,EAClB,QAAUC,EAAI,EAAGA,EAAI/B,EAAI,OAAQ+B,IAChC,GAAK,OAAO,MAAO/B,EAAI+B,CAAC,CAAC,EAAK,CAC7B,IAAIC,EAAMhC,EAAI+B,CAAC,EAEfC,EAAI,QAAUA,EAAI,WAAa,GAC/BA,EAAI,iBAAmBA,EAAI,UAAU,SAAU,CAAC,EAChDA,EAAI,mBAAqBA,EAAI,UAAU,SAAU,GAAG,EACpDA,EAAI,mBAAqBA,EAAI,UAAU,SAAU,GAAG,EACpDA,EAAI,iBAAmBA,EAAI,UAAU,SAAU,KAAK,EAC/CA,EAAI,QAAQ,WAAY,WAAW,IACvCA,EAAI,eAAiBA,EAAI,gBAE1B,KAAK,OAAQA,EACb,EAEF,CAED,mBAAoBtC,EAAM+B,EAAQ,CAC3B/B,IACLA,EAAO,CAAA,GAGR,IAAIsC,EAAM,KAAK,eACXC,EAAS,KAAK,YACdC,EAAU,CAAA,EAKdrB,EAAkB,OAAO,iBAAkB,aAAa,QAAQ,EAChEA,EAAgB,UAAW,CAAE,MAAO,SAAW,CAAA,EAC/CA,EAAgB,SAAUnB,EAAK,SAC/BwC,EAAQrB,EAAgB,SAAU,CAAA,EAAIA,EACtCmB,EAAI,SAAQ,EAAG,GAAI,CAAC,EAAG,OAAQnB,GAC/B,KAAK,sCAAuCA,GAG5C,IAAIA,EAAkB,OAAO,iBAAkB,aAAa,SAAS,EA8CrE,GA7CAA,EAAgB,UAAW,CAAE,MAAO,SAAW,CAAA,EAC/CA,EAAgB,cAAe,OAAO,oBAAqB,KAAK,kBAAkB,uBAAuB,GACzGA,EAAgB,SAAUnB,EAAK,SAC/BmB,EAAgB,WAAY,IAC5BA,EAAgB,IAAK,kBAAmB,UACxCqB,EAAQrB,EAAgB,SAAU,CAAA,EAAIA,EACtCmB,EAAI,SAAQ,EAAG,GAAI,CAAC,EAAG,OAAQnB,GAG/BA,EAAkB,OAAO,iBAAkB,aAAa,SAAS,EACjEA,EAAgB,UAAW,CAAE,MAAO,cAAe,UAAW,EAAK,GACnEA,EAAgB,cAAe,KAAK,kBAAkB,cAAc,EACpEA,EAAgB,SAAUnB,EAAK,aAC/BwC,EAAQrB,EAAgB,SAAU,CAAA,EAAIA,EACtCmB,EAAI,SAAQ,EAAG,GAAI,CAAC,EAAG,OAAQnB,GAG/BA,EAAkB,OAAO,iBAAkB,aAAa,QAAQ,EAChEA,EAAgB,UAAW,CAAE,MAAO,kBAAoB,CAAA,EACxDA,EAAgB,SAAUnB,EAAK,kBAC/BwC,EAAQrB,EAAgB,SAAU,CAAA,EAAIA,EACtCmB,EAAI,SAAQ,EAAG,GAAI,CAAC,EAAG,OAAQnB,GAG/BA,EAAkB,OAAO,iBAAkB,aAAa,QAAQ,EAChEA,EAAgB,UAAW,CAAE,MAAO,oBAAsB,CAAA,EAC1DA,EAAgB,SAAUnB,EAAK,oBAC/BwC,EAAQrB,EAAgB,SAAU,CAAA,EAAIA,EACtCmB,EAAI,SAAQ,EAAG,GAAI,CAAC,EAAG,OAAQnB,GAG/BA,EAAkB,OAAO,iBAAkB,aAAa,QAAQ,EAChEA,EAAgB,UAAW,CAAE,MAAO,oBAAsB,CAAA,EAC1DA,EAAgB,SAAUnB,EAAK,oBAC/BwC,EAAQrB,EAAgB,SAAU,CAAA,EAAIA,EACtCmB,EAAI,SAAQ,EAAG,GAAI,CAAC,EAAG,OAAQnB,GAG/BA,EAAkB,OAAO,iBAAkB,aAAa,QAAQ,EAChEA,EAAgB,UAAW,CAAE,MAAO,kBAAoB,CAAA,EACxDA,EAAgB,SAAUnB,EAAK,kBAC/BwC,EAAQrB,EAAgB,SAAU,CAAA,EAAIA,EACtCmB,EAAI,SAAQ,EAAG,GAAI,CAAC,EAAG,OAAQnB,GAG1BnB,EAAK,QAAQ,WAAY,WAAW,EAAK,CAC7CmB,EAAkB,OAAO,iBAAkB,aAAa,UAAU,EAClEA,EAAgB,WAAY,CAAE,MAAO,iBAAkB,gBAAiB,GAAM,KAAM,WAAW,GAC/FA,EAAgB,SAAUnB,EAAK,gBAC/BwC,EAAQrB,EAAgB,SAAU,CAAA,EAAIA,EAEtC,IAAIC,EAAkBzB,EAAG,oCACrB0B,EAAQ1B,EAAG,oCAAwCA,EAAE,KAAK,EAAG,SAAY,aAE7EyB,EAAgB,OAAQC,GACxBD,EAAgB,OAAQD,GAExBmB,EAAI,SAAQ,EAAG,GAAI,CAAC,EAAG,OAAQlB,EAC/B,CAGDoB,EAAQ,kBAAoBxC,EAEvB,OAAO+B,EAAS,KAEpBO,EAAI,YAAa3C,EAAG4C,CAAQ,EAAC,KAAM,MAAO,GAAIR,CAAK,GACnD,KAAK,mBAAmB,OAAUA,EAAS,EAAGS,CAAO,IAGrD7C,EAAG4C,CAAM,EAAG,OAAQD,CAAG,EACvB,KAAK,mBAAmB,KAAME,IAG1B,KAAK,kBAAkB,YAC3BF,EAAI,KAAM,eAAiB,EAAC,KAAI,EAGjC,KAAK,kBAAiB,CACtB,CAED,qBAAsBG,EAAuB,CAM5C,QAJIL,EAAM,KAAK,mBAAmB,OAE9BH,EAAS,CAAA,EAEHI,EAAI,EAAGA,EAAID,EAAKC,IAAM,CAC/B,IAAIC,EAAM,KAAK,mBAAmBD,CAAC,EAC/BrC,EAAOsC,EAAI,kBACftC,EAAK,YAAcsC,EAAI,YAAY,SAAQ,EAC3CtC,EAAK,UAAYsC,EAAI,QAAQ,SAAQ,IAAO,GAAO,GAAK,GACxDtC,EAAK,UAAY,GACZsC,EAAI,iBAAiB,SAAQ,IAAO,IACxCtC,EAAK,UAAU,KAAM,GACjBsC,EAAI,mBAAmB,SAAQ,IAAO,IAC1CtC,EAAK,UAAU,KAAM,KACjBsC,EAAI,mBAAmB,SAAQ,IAAO,IAC1CtC,EAAK,UAAU,KAAM,KACjBsC,EAAI,iBAAiB,SAAQ,IAAO,IACxCtC,EAAK,UAAU,KAAM,OAEjBA,EAAK,QAAQ,WAAY,WAAa,GAAIsC,EAAI,iBAClDtC,EAAK,eAAiBsC,EAAI,eAAe,SAAQ,GAGlDL,EAAO,KAAMjC,EACb,CAED,OAAOiC,CACP,CAED,aAAcA,EAAS,CACtB,IAAIpC,EAAQ,KACZ,GAAKoC,GAAUA,EAAO,UAAY,CACjC,IAAIC,EAAcD,EAAO,YACpBC,IAAgB,GACpBrC,EAAM,WAAaA,EAAM,oBAAoB,GAElC,OAAO,OAAQqC,IAAiBA,GAAe,OAAO,SAAWA,GAAe,OAAO,eAClGrC,EAAM,WAAaqC,GAGf,KAAK,iBAAmB,GAC5BrC,EAAM,qBAAsB,UAAW,CACtC,IAAI6C,EAAsB7C,EAAM,WAAYoC,CAAM,GAC7CS,GAAuB,MAAaA,GAAuB,KAC/D7C,EAAM,eAAc,CAE1B,GAEIA,EAAM,eAAc,CAGxB,MACGA,EAAM,aAAY,EAClBA,EAAM,aAAcoC,EAErB,CAED,qBAAsBU,EAAW,CAChC,IAAI3C,EAAO,KAAK,OAAO,SAAU,KAAK,YAEtC,IAAI4C,EAAe,KAAK,kBAAmB5C,EAAM,KAAK,2CAA4C,CAAC,UAAW,mBAAoB,qBAAsB,qBAAsB,kBAAkB,CAAC,EAE5L,MAAM,QAAS4C,CAAc,GAAIA,EAAa,OAAS,EAC3D,KAAK,iCAAiC,8BAA+BA,EAAc,CAClF,SAAU,SAAU9C,EAAM,CACpB,OAAO,MAAO6C,IAClBA,GAED,CACL,GAEQ,OAAO,MAAOA,IAClBA,GAGF,CAED,WAAYV,EAAS,CAGpB,IAAIY,EAAU,KAAK,gBAAe,EAAG,GAEhCA,IAAY,eAAe,aAAY,EAAG,IAC9C,OAAO,qBAAoB,CAE5B,CAED,sBAAuBZ,EAAS,CAC/B,KAAK,WAAYA,GACjB,KAAK,qBAAoB,CACzB,CAED,kBAAmBA,EAAS,CAC3B,KAAK,WAAYA,EACjB,CAED,UAAW,CACV,IAAIpC,EAAQ,KAERiD,EAAS,CAAA,EAEb,GAAK,KAAK,gBAAkB,CAC3B,QAAU5C,KAAO,KAAK,iBAAmB,CACxC,IAAIiC,EAAS,KAAK,iBAAiBjC,CAAG,EAEjC,OAAO,MAAOiC,EAAO,SAAS,GAC7BA,EAAO,UAAS,GAAMA,EAAO,WAAU,IAC3CW,EAAO5C,CAAG,EAAIiC,EAAO,SAAQ,EAG/B,CACI,KAAK,qBAAqB,OAAS,IACvCW,EAAO,GAAK,KAAK,qBAAqB,CAAC,EAE3C,MACGA,EAAS,KAAK,oBAEf,KAAK,IAAI,WAAa,KAAK,IAAI,QAAQ,EAAGA,EAAQ,CACjD,SAAU,SAAUb,EAAS,CAE5BpC,EAAM,eAAgBoC,EAEtB,CACJ,EACE,CAED,mCAAoC,CACnC,MAAO;AAAA;AAAA;AAAA;AAAA;AAAA,WAMP,CAED,kCAAmC,CAClC,MAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAQP,CAED,qBAAsB,CACrB,OAAM,KAAK,yBAIX,KAAK,wBAAwB,iBAAmB,SAAUlC,EAAS,CAClE,OAAAA,EAAO,qBAA0B,CAChC,gBAAmB,CAAC,KAAK,mBAAmB,EAAE,EAC9C,6BAAgC,KAAK,uBAAuB,OAAO,SAAU,KAAK,UAAU,EAAG,IAAKgD,GAAcA,EAAW,EAAI,CACrI,EAEUhD,CACV,EAES,IAZC,EAaR,CAEF,CAEAP,EAA6B,SAAW,UAAW,CAClD,OAAO,eAAgB,iBAAkB,0BAA2B,SAAUyC,EAAS,CAItF,OAAO,iBAAgB,EAAG,KAAMA,CAAM,CACxC,EACA"}