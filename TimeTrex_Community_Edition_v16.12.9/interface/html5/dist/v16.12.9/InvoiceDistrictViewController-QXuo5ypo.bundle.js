import{_ as o,j as a}from"./vendor-tTApdY0Y.bundle.js";class _ extends BaseViewController{constructor(i={}){o.defaults(i,{el:"#invoice_district_view_container",status_array:null,country_array:null,province_array:null,e_province_array:null,company_api:null}),super(i)}init(i){this.edit_view_tpl="InvoiceDistrictEditView.html",this.permission_id="client",this.viewId="InvoiceDistrict",this.script_name="InvoiceDistrictView",this.table_name_key="invoice_district",this.context_menu_name=a.i18n._("Districts"),this.navigation_label=a.i18n._("District"),this.api=TTAPI.APIInvoiceDistrict,this.company_api=TTAPI.APICompany,this.render(),this.buildContextMenu(),this.initData()}initOptions(){this.initDropDownOption("status"),this.initDropDownOption("country","country",this.company_api)}onSetSearchFilterFinished(){var i,r;this.search_panel.getSelectTabIndex()===0&&(i=this.basic_search_field_ui_dic.country,r=i.getValue(),this.setProvince(r))}onBuildBasicUIFinished(){this.basic_search_field_ui_dic.country.change(a.proxy(function(){var i=this.basic_search_field_ui_dic.country,r=i.getValue();this.setProvince(r),this.basic_search_field_ui_dic.province.setValue(null)},this))}onFormItemChange(i,r){this.setIsChanged(i),this.setMassEditingFieldsWhenFormChange(i);var e=i.getField();switch(e){case"country":var t=this.edit_view_ui_dic.province;t.setValue(null);break}if(this.current_edit_record[e]=i.getValue(),e==="country"){this.onCountryChange();return}r||this.validate()}buildEditViewUI(){super.buildEditViewUI();var i=this,r={tab_district:{label:a.i18n._("District")},tab_audit:!0};this.setTabModel(r);var e;this.navigation.AComboBox({api_class:TTAPI.APIInvoiceDistrict,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_invoice_district",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var t=this.edit_view_tab.find("#tab_district"),n=t.find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(n),e=Global.loadWidgetByName(FormItemType.TEXT_INPUT),e.TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn(a.i18n._("Name"),e,n,""),e.parent().width("45%"),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"country",set_empty:!0}),e.setSourceData(i.country_array),this.addEditFieldToColumn(a.i18n._("Country"),e,n),e=Global.loadWidgetByName(FormItemType.COMBO_BOX),e.TComboBox({field:"province"}),e.setSourceData([]),this.addEditFieldToColumn(a.i18n._("Province / State"),e,n,"")}setProvince(i,r){var e=this;!i||i==="-1"||i==="0"?(e.province_array=[],this.basic_search_field_ui_dic.province.setSourceData([])):this.company_api.getOptions("province",i,{onResult:function(t){t=t.getResult(),t||(t=[]),e.province_array=Global.buildRecordArray(t),e.basic_search_field_ui_dic.province.setSourceData(e.province_array)}})}eSetProvince(i,r){var e=this,t=e.edit_view_ui_dic.province;!i||i==="-1"||i==="0"?(e.e_province_array=[],t.setSourceData([])):this.company_api.getOptions("province",i,{onResult:function(n){n=n.getResult(),n||(n=[]),e.e_province_array=Global.buildRecordArray(n),r&&e.e_province_array.length>0&&(e.current_edit_record.province=e.e_province_array[0].value,t.setValue(e.current_edit_record.province)),t.setSourceData(e.e_province_array)}})}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:a.i18n._("Name"),in_column:1,field:"name",multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:a.i18n._("Country"),in_column:1,field:"country",multiple:!0,basic_search:!0,adv_search:!1,layout_name:"global_option_column",form_item_type:FormItemType.COMBO_BOX}),new SearchField({label:a.i18n._("Province/State"),in_column:1,field:"province",multiple:!0,basic_search:!0,adv_search:!1,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:a.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:a.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX})]}}export{_ as InvoiceDistrictViewController};
//# sourceMappingURL=InvoiceDistrictViewController-QXuo5ypo.bundle.js.map
