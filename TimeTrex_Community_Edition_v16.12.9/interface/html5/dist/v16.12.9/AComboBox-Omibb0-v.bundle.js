import{_ as Ke,j as Xe}from"./vendor-tTApdY0Y.bundle.js";(function(o){o.fn.AComboBox=function(je){var Fe=o.extend({},o.fn.AComboBox.defaults,je),F=null,l=null,h="",M=null,ye=null,v=null,C=!1,Se=!1,Le=!1,T=!1,j=!1,N=!1,H=!1,Q=!1,z=!1,b=null,u=null,de="",Be,q=null,s=null,U=null,A=null,Re=null,J=null,c=null,ie="",oe=!1,he=!1,a=null,p=null,_e=!1,R=0,Te=!1;Global.addCss("global/widgets/awesomebox/AComboBox.css");var Ee=!0,se=!1,Ve=!1,D="id",X="",Y;a=this;var ke=!1,I=null,ne=!0,Oe=!1,B=!1,G=null,P=null,ge=null,me=null,le=null,pe=null,Ge="",fe=null,we=!1,$=null,E=null,V=null,ee=null,ue=null,Ie="columns",xe=!1,W,be=!1,K,Me=!1,Z={},ce="",Ue,re=1,Ae,ve=!1;this.customSearchFilter=null,this.getCurrentOpenPage=function(){return re},this.getPagerData=function(){return M},this.getHeaderWidth=function(){return W},this.setKey=function(e){D=e},this.getDisplayColumns=function(){return s},this.getLayout=function(){return ALayoutCache.layout_dic[h]},this.getAPI=function(){return v},this.getScriptName=function(){return Ge=Global.getScriptNameByAPI(ye),Ge},this.setCachedSortFilter=function(e){le=e},this.setCachedSelectedGridSortFilter=function(e){pe=e},this.setCachedSearchInputsFilter=function(e){ge=e},this.setCachedSelectGridSearchInputsFilter=function(e){me=e},this.setAllowMultipleSelection=function(e){C=e,e==!0?b&&(u=[b]):u&&u.length>0&&(b=u[0])},this.getEnabled=function(){return ne},this.setEnabled=function(e){ne=e,e===!1||e===""?(a.addClass("a-combobox-readonly"),I&&I.hide()):(a.removeClass("a-combobox-readonly"),I&&I.show())},this.setCheckBox=function(e){I&&(I.children().eq(0)[0].checked=e)},this.isChecked=function(){return!!(I&&I.children().eq(0)[0].checked===!0)},this.setMassEditMode=function(e){ke=e,ke?(I=o(' <div class="mass-edit-checkbox-wrapper"><input type="checkbox" class="mass-edit-checkbox"></input><label for="checkbox-input-1" class="input-helper input-helper--checkbox"></label></div>'),I.insertBefore(o(this)),I.change(function(){a.trigger("formItemChange",[a])})):I&&(I.remove(),I=null)},this.getItemByIndex=function(e){var i;if(B&&!c?i=fe:(i=c,K&&K.length>0&&(i=K)),!i)return null;var t=null;return t=i[e],t},this.getSelectIndex=function(){var e;if(B&&!c?e=fe:(e=c,K&&K.length>0&&(e=K)),!b||!e)return 0;for(var i=e.length,t=0;t<i;t++){var r=e[t];if(b[D]===r[D])return t}return 0},this.getNextSelectItemId=function(){var e=null,i=this.getSelectIndex()+1,t=this.getSourceData();return t&&i<t.length?e=this.getItemByIndex(i):e=null,e},this.setErrorStyle=function(e,i,t){t?o(this).addClass("a-warning-tip"):o(this).addClass("a-error-tip"),X=e,i&&this.showErrorTip()},this.showErrorTip=function(e){Global.isSet(e)||(e=2),Y||(Y=Global.loadWidgetByName(WidgetNamesDic.ERROR_TOOLTIP),Y=Y.ErrorTipBox()),o(this).hasClass("a-warning-tip")?Y.show(this,X,e,!0):Y.show(this,X,e)},this.hideErrorTip=function(){Global.isSet(Y)&&Y.remove()},this.clearErrorStyle=function(){o(this).removeClass("a-error-tip"),o(this).removeClass("a-warning-tip"),X="",this.hideErrorTip()},this.setField=function(e){de=e},this.getField=function(){return de},this.getValidationField=function(){return Be},this.highlightSelectItem=function(){var e,i;if(!C){let t;if(b&&b[D]?t=b[D]:b&&(t=b),t&&l){(i=(e=l==null?void 0:l.getUnSelectGrid())==null?void 0:e.grid)==null||i.jqGrid("setSelection",t,!1);let r=document.getElementById(t);r&&r.scrollIntoView()}}},this.getValue=function(e){var i=null;if(C)e?i=u:(i=[],Global.isArray(u)?(o.each(u,function(t,r){r&&(Global.isString(r)||o.type(r)==="number"?i.push(r):i.push(r[D]))}),u.length===0&&T&&i.push(TTUUID.not_exist_id)):T&&i.push(TTUUID.not_exist_id),i.length===0&&(T?i=TTUUID.not_exist_id:j?i=TTUUID.zero_id:N?i=TTUUID.not_exist_id:(H||Q)&&(i=TTUUID.zero_id)));else if(e)i=b;else if(b)Global.isSet(b[D])?i=b[D]:i=b;else{if(T)return TTUUID.not_exist_id;if(j)return TTUUID.zero_id;if(N)return TTUUID.not_exist_id;if(H)return TTUUID.zero_id;if(Q)return TTUUID.zero_id}return i},this.setSourceData=function(e){c=e,C?e&&e.length>0&&z&&a.createFirstItem():e&&e.length>0&&(j||T||Q||H||z||N?a.createFirstItem():b||this.setValue(e[0])),he&&c&&(C?this.setValue(u):this.setValue(b))},this.getSourceData=function(){return B&&fe?fe:K||c},this.getStaticSourceData=function(){return c},this.getRowPerPage=function(){return R},this.setAllColumns=function(e){J=e},this.setDisplayColumnsForEditor=function(e){Re=e},this.getAllColumns=function(){return U||J},this.getDisplayColumnsForEditor=function(){return Re},this.setEmptyValueAndShowLoading=function(){var e=a.find(".a-combobox-label").width();this.setValue(null),F.text(Global.loading_label),a.find(".a-combobox-label").width(e+"px")},this.setValue=function(e){Ke.isArray(e)&&e.length===1&&e[0]===null&&(e=null),C?!e||o.type(e)==="array"?this.setSelectItems(e):(o.type(e)==="string"||o.type(e)==="number")&&this.setSelectItems([e]):(o.type(e)==="array"&&e.length>0&&(e=e[0]),!e||e==TTUUID.zero_id?!j&&!T&&!Q&&!H&&!z&&!N&&c&&c.length>0?this.setValue(c[0]):this.setSelectItem(null):this.setSelectItem(e))},this.getAllowMultipleSelection=function(){return C},this.getRealData=function(e){if(Global.isSet(ye)){if(!TTUUID.isUUID(e)&&parseInt(e)<=0||e==TTUUID.zero_id||e==TTUUID.not_exist_id){C?a.setValue([this.getLocalSelectItem(e)]):a.setValue(this.getLocalSelectItem(e));return}var i={};i.filter_data={id:e},P&&Global.isSet(P.permission_section)&&(i.permission_section=P.permission_section),this.customSearchFilter&&(i=this.customSearchFilter(i)),F.text(Global.loading_label),v["get"+E](i,{onResult:function(t){var r=t.getResult();if(r&&r.length>0){var n;C?(n=r,a.setValue(r)):(n=r[0],a.setValue(r[0]))}V&&V(n)}})}else c&&c.length>0?o.each(c,function(t,r){if(r[D]==e)return a.setValue(r),!1}):he=!0},this.getColumnFilter=function(){if(Me)return{};var e={};return e.is_owner=!0,e.id=!0,e.is_child=!0,e.user_id=!0,e.first_name=!0,e.last_name=!0,e.object_type_id=!0,e.manual_id=!0,e.default_item_id=!0,e.accrual_policy_id=!0,e.pay_code_id=!0,e.start_date=!0,e.end_date=!0,e.pay_period_id=!0,v&&v.className==="APIUser"&&(e.pay_period_schedule_id=!0,e.policy_group_id=!0,e.hire_date=!0,e.termination_date=!0),o.each(s,function(i,t){e[t.name]=!0}),ve&&ve.length>0&&o.each(ve,function(i,t){e[t]=!0}),e},this.cleanDropDownValues=function(){l&&l.setSelectGridData([])},this.setSelectItem=function(e){if(u=null,b=e,e===!1||e===""){this.setLabel(e),V&&V(!1);return}o.type(e)==="string"||o.type(e)==="number"?this.getRealData(e):this.setLabel()},this.setSelectItems=function(e){if(b=null,!e||e.length<1){this.setEmptyLabel(),u=null,V&&V(!1),this.cleanDropDownValues();return}else if(e==TTUUID.not_exist_id&&T){u=e,this.setEmptyLabel(),V&&V(!1),this.cleanDropDownValues();return}u=e;var i=e.length;if(i>1){var t=e[0];(o.type(t)==="string"||o.type(t)==="number")&&(Se||(oe=!0),Le&&V&&V(e,!0)),this.setLabel()}else for(var r=0;r<i;r++)if(t=e[r],o.type(t)==="string"||o.type(t)==="number")if(!Se)this.getRealData(t);else{if(!c){he=!0;return}this.setSelectItems(this.getRealSelectItemsFromSourceData())}else{for(var n in t)if(t[n]==="asc"||t[n]==="desc"){if(c)break;he=!0;return}this.setLabel()}},this.getSelectItems=function(){return l.getSelectItems()},this.getRealSelectItemsFromSourceData=function(){for(var e=c.length,i=u?u.length:0,t=[],r=0;r<i;r++)for(var n=u[r],f=0;f<e;f++){var d=c[f];if(n==d[D]){t.push(d);break}}return t},this.setLabel=function(){var e=Array();if(C){if(!u){this.setEmptyLabel();return}var i=u.length;if(i===1){var t=s.length;for(m=0;m<t;m++)if(s[m].hidden!==!0){if(h==="global_sort_columns"&&u[0][s[m].name]===void 0){var r=u[0];for(var n in r)var f=n+" | "+r[n];if(c)for(var d=0;d<c.length;d++){var _=c[d];if(_.value===n)var f=_.label+" | "+r[n]}f!==0&&f==""&&(f="--"),e.push(f);break}else var f=u[0][s[m].name];f!==0&&f==""&&(f="--"),(f===0||f)&&e.push(f)}e.length>0?F.text(e.join(" | ")):this.setEmptyLabel()}else F.text(i+" "+o.i18n._("items selected"))}else{if(!b||!s){this.setEmptyLabel();return}t=s.length;for(var m=0;m<t;m++)s[m].hidden!==!0&&(f=b[s[m].name],f!==0&&f==""&&(f="--"),(f===0||f)&&e.push(f));e.length>0?F.text(e.join(" | ")):this.setEmptyLabel()}a.find(".a-combobox-label").width("auto")},this.setEmptyLabel=function(){if(T)F.text(Global.any_item);else if(j||N)h==="global_tree_column"?F.text(Global.root_item):F.text(Global.empty_item);else if(Q)F.text(Global.default_item);else if(H)F.text(Global.open_item);else if(c&&c.length>0){var e=c[0];e.hasOwnProperty("label")&&F.text(e.label)}ee&&F.text(ee)},this.onColumnSettingSaveFromLayout=function(e){var i={};i.script="global_awesomebox_columns",i.name=h,i.is_default="false",i.data=e.data,i.data.type=10,i.data.layout_id=e.id,ALayoutCache.layout_dic[h]&&(i.id=ALayoutCache.layout_dic[h].id),q.setUserGenericData(i,{onResult:function(t){ALayoutCache.layout_dic[h]=null,a.initColumns(),c=null}})},this.onColumnSettingSave=function(e,i,t,r){var n={};n.script="global_awesomebox_columns",n.name=h,n.is_default="false",n.type=1,ALayoutCache.layout_dic[h]&&(n.id=ALayoutCache.layout_dic[h].id);for(var f=[],d=e.length,_=0;_<d;_++){var m={label:e[_].label,value:e[_].value,orderValue:e[_].orderValue};f.push(m)}n.data={display_columns:f,row_per_page:i,layout_id:t,filter_data:r},q||(q=TTAPI.APIUserGenericData),q.setUserGenericData(n,{onResult:function(x){ALayoutCache.layout_dic[h]=null,a.initColumns(),c=null,o.type(u)==="array"&&(u=u.map(function(w){if(w.hasOwnProperty("id"))return w.id})),u&&a.getRealData(u)}})},this.initColumns=function(){if(q=TTAPI.APIUserGenericData,!(!q||!q.getUserGenericData||typeof q.getUserGenericData!="function"))if(Global.isSet(ALayoutCache.layout_dic[h]))ALayoutCache.layout_dic[h].pending?(TTPromise.add("AComboBox",h),TTPromise.wait("AComboBox",h,function(){Ne(h)})):Ne(h);else{ALayoutCache.layout_dic[h]={pending:!0};var e={};e.filter_data={script:"global_awesomebox_columns",name:h},q.getUserGenericData(e,{onResult:function(i){var t=i.getResult();if(t&&t.length>0){var r=t[0].data;if(r.type===10){var n=v.getOptions(Ie,{async:!1}).getResult();J=Global.buildColumnArray(n);var f=q.getUserGenericData({filter_data:{id:r.layout_id,deleted:!1}},{async:!1}).getResult();if(f&&f.length>0){var d=f.slice()[0],_=d.data;_.display_columns=a.buildDisplayColumns(_.display_columns),_.filter_data=Global.convertLayoutFilterToAPIFilter(d),t[0].data.display_columns=_.display_columns,t[0].data.filter_data=_.filter_data,r=t[0].data}else r.filter_data=[]}ALayoutCache.layout_dic[h]=t[0],ALayoutCache.layout_dic[a.getScriptName()]=h,Global.isSet(r.type)&&r.type===10?(s=r.display_columns,s.length>0?(U&&(s=k(s)),s=Global.convertColumnsTojGridFormat(s,h,function(m){W=m})):A&&(s=A,s=k(s),s=Global.convertColumnsTojGridFormat(s,h,function(m){W=m})),G={},G.filter_data=r.filter_data,G.filter_sort=r.filter_sort):(s=r.display_columns,s.length>0?(U&&(s=k(s)),s=Global.convertColumnsTojGridFormat(s,h,function(m){W=m})):A&&(s=A,s=k(s),s=Global.convertColumnsTojGridFormat(s,h,function(m){W=m})),R=r.row_per_page,G=null)}else A&&(s=A,s=k(s),s=Global.convertColumnsTojGridFormat(s,h,function(m){W=m})),ALayoutCache.layout_dic[h]=!1,R=0;be&&a.initSourceData(),TTPromise.resolve("AComboBox",h)}})}};var Ne=function(e){if(Global.isSet(ALayoutCache.layout_dic[e].data)){var i=ALayoutCache.layout_dic[e].data;Global.isSet(i.type)&&i.type===10?(s=i.display_columns,s.length>0?(U&&(s=k(s)),s=Global.convertColumnsTojGridFormat(s,e,function(t){W=t})):A&&(s=A,s=k(s),s=Global.convertColumnsTojGridFormat(s,e,function(t){W=t})),G={},G.filter_data=i.filter_data,G.filter_sort=i.filter_sort):(s=i.display_columns,s.length>0?(U&&(s=k(s)),s=Global.convertColumnsTojGridFormat(s,e,function(t){W=t})):U&&(s=U),R=i.row_per_page,!B&&!we&&(P=null))}else A&&(s=A,s=k(s),s=Global.convertColumnsTojGridFormat(s,e,function(t){W=t})),R=0;be&&a.initSourceData()},k=function(e){if(!U)return e;for(var i=U.length,t=[],r=0;r<e.length;r++){for(var n=e[r],f=!1,d=0;d<i;d++){var _=U[d];if(_.value===n.value){f=!0;break}}f&&t.push(n)}return t.length===0&&(t=U),t};this.getId=function(){return ie},this.updateSelectItem=function(e){if(b=e,c)for(var i=0;i<c.length;i++){var t=c[i];if(t&&e&&t.id===e.id){c[i]=e;return}}},this.getADropDown=function(){return p},this.onClose=function(e,i){l==null&&Debug.Text("ERROR: Unable to close AComboBox check to make sure it wasn't instantiated twice.","ACombobox.js","ACombobox","onClose",10);var t=TTPromise.isPendingPromises("AComboBox","init");if(t==!1)if(C){var r=l.getSelectItems();a.setValue(r)}else{var n=l.getSelectItem();n&&(se?n._id_&&a.setValue(n._id_):a.setValue(n))}else Debug.Text("WARNING: AComboBox::Init promise still pending, cant call setValue()...","ACombobox.js","ACombobox","onClose",10);p.remove(),_e=!1,LocalCacheData.openAwesomeBox=null,(l.isChanged()||h==="global_sort_columns")&&(I&&a.setCheckBox(!0),a.trigger("formItemChange",[a])),a.trigger("onClose",[a]),xe=!0,setTimeout(function(){xe=!1},200),a.find(".focus-input").focus()},this.selectNextItem=function(e){var i=this.getSelectIndex(),t,r;if(e.keyCode===40){if(e.preventDefault(),!C){i===0?t=1:t=i+1;var n=this.getItemByIndex(t);n||(t=t-1,n=this.getItemByIndex(t)),b=n,l.setSelectItem(n),l.setIsChanged(!0)}}else if(e.keyCode===38)e.preventDefault(),C||(i===0?t=0:t=i-1,n=this.getItemByIndex(t),b=n,l.setSelectItem(n),l.setIsChanged(!0));else if(e.keyCode===39)C&&!o(e.target).hasClass("search-input")&&(e.preventDefault(),l.onUnSelectGridDoubleClick(),l.setIsChanged(!0));else if(e.keyCode===37)C&&!o(e.target).hasClass("search-input")&&(e.preventDefault(),l.onSelectGridDoubleClick(),l.setIsChanged(!0));else{Ue&&clearTimeout(Ue);var f=o(":focus");if(f.length>0&&o(f[0]).hasClass("search-input"))return;Ue=setTimeout(function(){ce=""},750),e.preventDefault(),ce=ce+String.fromCharCode(e.which).toLowerCase(),Debug.Text("Quick search typed keys: "+ce,"AComboBox.js","AComboBox","selectNextItem",10);var d=ce.trim();if(C||se){if(d){r=l.getFocusInSeletGrid()?l.getSelectGrid():l.getUnSelectGrid();var _=Z[d]?Z[d]:0,m=o(r.grid.find("tr").find("td:eq(1)").filter(function(){return o.text([this]).toLowerCase().indexOf(d)==0})),x;_>0&&_<m.length||(_=0),x=o(m[_]),l.unSelectAll(r.grid,!0);for(var n=!1,w=r.getData(),O=0;O<w.length;O++)if(w[O].id==x.parents("tr").attr("id")){n=w[O];break}b=n,l.setSelectItem(n,r),l.setIsChanged(!0),Z={},Z[d]=_+1}}else d&&(_=Z[d]?Z[d]:0,m=o(l.getUnSelectGrid().grid.find("tr").find("td:first").filter(function(){return o.text([this]).toLowerCase().indexOf(d)==0})),_>0&&_<m.length||(_=0),x=o(m[_]),t=x.parent().index()-1,n=this.getItemByIndex(t),b=n,l.setSelectItem(n),Z={},Z[d]=_+1)}},this.gridScrollTop=function(){l&&l.gridScrollTop()},this.gridScrollDown=function(){l&&l.gridScrollDown()},this.selectAll=function(){!l||se||!C||l.selectAll()},this.getIsMouseOver=function(){return _e},this.onShowAll=function(e){Te=e;var i=this.buildUnSelectGridFilter();i=this.addExcludeIDsToFilter(i,l.getSelectItems()),v["get"+E](i,{onResult:function(t){var r=t.getResult();r||(r=[]),M=t.getPagerData(),c=r,Global.isSet(v)&&(c=Global.formatGridData(c,v.key_name)),l.setUnselectedGridData(c),l.setPagerData(M)}})},this.buildUnSelectGridFilter=function(e=null){var i={};if(i.filter_data={},i.filter_columns=a.getColumnFilter(),i.filter_items_per_page=R,l&&(i.filter_data=Global.clone(l.getUnSelectGridMap()),i.filter_sort=Global.clone(l.getUnSelectGridSortMap())),G){if(Global.isSet(G.filter_data))for(var t in G.filter_data)i.filter_data.hasOwnProperty(t)||(i.filter_data[t]=G.filter_data[t]);G&&Global.isSet(G.permission_section)&&(i.permission_section=G.permission_section),Global.isSet(G.filter_sort)&&!i.filter_sort&&(i.filter_sort=G.filter_sort)}if(P){if(Global.isSet(P.filter_data))for(var t in P.filter_data)i.filter_data.hasOwnProperty(t)||(i.filter_data[t]=P.filter_data[t]);P&&Global.isSet(P.permission_section)&&(i.permission_section=P.permission_section),Global.isSet(P.filter_sort)&&!i.filter_sort&&(i.filter_sort=P.filter_sort)}return this.customSearchFilter&&(i=this.customSearchFilter(i)),Te&&(i.second_parameter=!0),e&&(i=this.addExcludeIDsToFilter(i,e)),i},this.addExcludeIDsToFilter=function(e,i){if(l&&e&&i){var t=i;if(t&&Global.isArray(t)&&t.length>0&&t[0]!=TTUUID.zero_id){e.filter_data.exclude_id=[];for(var r in t)t[r]&&t[r].id?e.filter_data.exclude_id.push(t[r].id):e.filter_data.exclude_id.push(t[r])}}return e},this.buildSelectGridFilter=function(){var e={};return e.filter_columns=a.getColumnFilter(),e.filter_items_per_page=R,e.filter_data=l.getSelectGridMap(),e.filter_sort=l.getSelectGridSortMap(),e.second_parameter=!0,e},this.searchIsEmpty=function(e){for(var i=e.find("input.search-input"),t=0;t<i.length;t++)if(o(i[t]).val()!=o.i18n._("click to search"))return!1;return!0},this.onADropDownSearch=function(e,i,t,r,n=!0){var _,m,x,w,O;var f=this.getValue();if(!(e=="select_grid"&&f.length==0||e=="select_grid"&&f.length==1&&f[0]==TTUUID.not_exist_id)){var d={};if(d.filter_columns=a.getColumnFilter(),d.filter_items_per_page=R,e==="unselect_grid"){if(d=a.buildUnSelectGridFilter(l?l.getSelectItems():null),l&&l.getPagerData())if(LocalCacheData.paging_type===0)i==="next"?d.filter_page=(_=l.getPagerData())==null?void 0:_.next_page:d.filter_page=1;else switch(i){case"next":d.filter_page=(m=l.getPagerData())==null?void 0:m.next_page;break;case"last":d.filter_page=(x=l.getPagerData())==null?void 0:x.previous_page;break;case"start":d.filter_page=1;break;case"end":d.filter_page=(w=l.getPagerData())==null?void 0:w.last_page_number;break;default:d.filter_page=(O=l.getPagerData())==null?void 0:O.current_page;break}parseInt(i)>=1&&(d.filter_page=i),v["get"+E](d,{onResult:function(S){var y=o(":focus"),g=S.getResult();if(Global.isArray(g)||(g=[]),$&&(g=$(a,g)),LocalCacheData.paging_type===0&&i==="next"){var L=l.getUnSelectGridData();g=L.concat(g)}B?(c=g,M=S.getPagerData()):(K=g,re=S.getPagerData().current_page),o.type(g)!="array"&&(g=[]),C||a.createFirstItem(g),g=Global.formatGridData(g,v.key_name),Ae&&(g=Ae(g)),l&&l.setUnselectedGridData(g),C?l&&l.setSelectGridData(l.getSelectItems(),!0):(l&&l.setSelectItem(l.getSelectItem()),a.highlightSelectItem(),t=="first"?(a.setValue(g[0]),n==!0&&a.trigger("formItemChange",[a]),r&&r(g[0])):t=="last"?(a.setValue(g[g.length-1]),n==!0&&a.trigger("formItemChange",[a]),r&&r(g[g.length-1])):r&&r()),l&&l.setPagerData(S.getPagerData()),g.length<1&&l.getSelectItems().length<1?l&&l.showNoResultCover("unselect_grid"):l&&l.removeNoResultCover("unselect_grid"),l&&l.getUnSelectGrid().grid.show(),y.length&&y.focus()}})}else d=this.buildSelectGridFilter(),d.filter_data.id&&d.filter_data.id!==!1&&v["get"+E](d,{onResult:function(S){var y=S.getResult(),g=o(":focus");o.type(y)!="array"&&(y=[]),y=Global.formatGridData(y,v.key_name),l.setSelectGridSearchResult(y),y.length<1?(l.getSelectGrid().grid.clearGridData(),l.showNoResultCover("select_grid")):l.removeNoResultCover("select_grid"),l.setSelectGridDragAble(),l.getSelectGrid().grid.show(),g.length>0&&g.focus()}})}},this.buildDisplayColumns=function(e){for(var i=J.length,t=e.length,r=[],n=0;n<t;n++)for(var f=0;f<i;f++)e[n]===J[f].value&&r.push(J[f]);return r},this.buildDisplayColumnsForEditor=function(){for(var e=J.length,i=s.length,t=[],r=0;r<i;r++)for(var n=0;n<e;n++)if(s[r]){if(Global.isSet(s[r].name))var f=s[r].name;else Global.isSet(s[r].value)&&(f=s[r].value);f===J[n].value&&t.push(J[n])}return t},this.getLocalSelectItem=function(e){if(ue){for(var i=0;i<ue.length;i++)if(e==ue[i].value){var t={};return t[D]=e,o.each(s,function(r,n){return t[n.name]=ue[i].label,!1}),t}return this.getFirstItem()}else return this.getFirstItem()},this.getFirstItem=function(){var e={};return e[D]=TTUUID.zero_id,T||z?e[D]=TTUUID.not_exist_id:e[D]=TTUUID.zero_id,o.each(s,function(i,t){return D!=="id"&&(e.id=TTUUID.not_exist_id),z?e[t.name]=Global.all_item:T?e[t.name]=Global.any_item:j||N?e[t.name]=Global.empty_item:H?e[t.name]=Global.open_item:Q&&(e[t.name]=Global.default_item),ee&&(e[t.name]=ee),!1}),e},this.createFirstItem=function(e){var i=!1;if(e||(e=c),e.hasOwnProperty(0)){if(T||z){if(e[0][D]===TTUUID.not_exist_id)return}else if(e[0][D]===TTUUID.zero_id)return}var t={};t[D]=TTUUID.zero_id,T||z||N?t[D]=TTUUID.not_exist_id:t[D]=TTUUID.zero_id,o.each(s,function(r,n){return D!=="id"&&(t.id=TTUUID.not_exist_id),z?t[n.name]=Global.all_item:T?t[n.name]=Global.any_item:j||N?t[n.name]=Global.empty_item:H?t[n.name]=Global.open_item:Q?t[n.name]=Global.default_item:i=!0,ee&&(t[n.name]=ee),!1}),i||e.unshift(t)},this.checkIfLayoutChanged=function(e){if(!s||!e||s.length!==e.length)return!0;for(var i=s.length,t=0;t<i;t++){for(var r=s[t],n=!1,f=0;f<i;f++){var d=e[f];if(d.name===r.name){n=!0;break}}if(!n)return!0}return!1},this.setDefaultArgs=function(e){a.default_args=e,we=!0,P=e},this.setDisPlayColumns=function(e){s=Global.convertColumnsTojGridFormat(e,h)},this.setPossibleDisplayColumns=function(e,i){U=e,i?A=i:A=e,h!=="global_option_column"&&h!=="global_tree_column"&&h!=="global_sort_columns"&&h!=="global_timesheet"&&h!=="global_absence"&&this.initColumns()},this.setRowPerPage=function(e){R=e},this.setPagerData=function(e){M=e},this.shouldInitColumns=function(){return!(h==="global_option_column"||h==="global_tree_column"||h==="global_sort_columns"||h==="global_timesheet"||h==="global_absence"||h==="global_simple_name"||h==="global_simple_name_navigation")},this.createItem=function(e,i){var t={};return t[D]=e,o.each(s,function(r,n){return D!=="id"&&(t.id=2e4),t[n.name]=i,!1}),t},this.initSourceData=function(){var e=a.buildUnSelectGridFilter();v["get"+E](e,{onResult:function(i){var t=i.getResult();Global.isArray(t)||(t=[]),c=t,M=i.getPagerData(),a.trigger("initSourceComplete",[a])}}),be=!1},this.addHideIdColumn=function(e){var i={name:"id",index:"id",label:"",width:0,hidden:!0};return e.push(i),e};var He=function(e){var i=e,t=[],r=c;return i&&o.each(i,function(n,f){for(var d in f){if(d==="label"||d==="value"||d==="fullValue")return t=i,!1;o.each(r,function(_,m){if(m.value===d)return m.sort=f[d],t.push(m),!1})}}),t};return this.each(function(){var e=o.meta?o.extend({},Fe,o(this).data()):Fe;F=o(this).find(".a-combobox-label");var i=o(this).find(".focus-input");e.always_include_columns&&(ve=e.always_include_columns),e.extendDataProcessWhenSearch&&(Ae=e.extendDataProcessWhenSearch),e.always_search_full_columns&&(Me=e.always_search_full_columns),e.added_items&&(ue=e.added_items),e.init_data_immediately&&(be=e.init_data_immediately),e.custom_first_label&&(ee=e.custom_first_label),e.script_name&&(Ge=e.script_name),e.get_real_data_on_multi&&(Le=e.get_real_data_on_multi),e.setRealValueCallBack&&(V=e.setRealValueCallBack),e.navigation_mode&&(B=e.navigation_mode,o(this).children().eq(1).css("max-width",132),o(this).children().eq(1).css("min-width",132)),e.search_panel_model&&(o(this).children().eq(1).css("max-width",132),o(this).children().eq(1).css("min-width",132)),e.width?(o(this).children().eq(1).css("max-width",e.width),e.is_static_width&&o(this).children().eq(1).css("min-width",e.width)):o(this).children().eq(1).css("min-width",132),e.api_class&&(ye=e.api_class,v=e.api_class),e.custom_key_name?E=e.custom_key_name:v&&(E=v.key_name),e.allow_multiple_selection&&(C=e.allow_multiple_selection),e.set_any&&(T=e.set_any),e.set_empty&&(j=e.set_empty),e.set_special_empty&&(N=e.set_special_empty),e.set_open&&(H=e.set_open),e.set_default&&(Q=e.set_default),e.set_all&&(z=e.set_all),e.addition_source_function&&($=e.addition_source_function),e.column_option_key&&(Ie=e.column_option_key),de=e.field,e.validation_field&&(Be=e.validation_field),e.layout_name&&(B?h=e.layout_name+"_navigation":h=e.layout_name),e.hasOwnProperty("show_search_inputs")&&(Ee=e.show_search_inputs),e.tree_mode&&(se=e.tree_mode),e.on_tree_grid_row_select&&(Ve=e.on_tree_grid_row_select),Oe=!0,e.key&&(D=e.key),e.args&&(a.args=e.args),e.customSearchFilter&&(a.customSearchFilter=e.customSearchFilter),e.default_args&&a.setDefaultArgs(e.default_args);var t=this;i.unbind("keydown").bind("keydown",function(f){(f.keyCode===13||f.keyCode===32)&&(f.stopPropagation(),f.preventDefault(),TTPromise.add("AComboBox","init"),n())}),i.bind("focusin",function(){o(t).addClass("focus")}),i.bind("focusout",function(){o(t).removeClass("focus")}),o(this).click(function(f){if(f.stopPropagation(),!ne)LocalCacheData.current_open_sub_controller&&LocalCacheData.current_open_sub_controller.edit_view&&LocalCacheData.current_open_sub_controller.is_viewing?(X=LocalCacheData.current_open_sub_controller.getViewModeErrorMessage(),a.showErrorTip(10)):LocalCacheData.current_open_primary_controller&&LocalCacheData.current_open_primary_controller.edit_view&&LocalCacheData.current_open_primary_controller.is_viewing&&(X=LocalCacheData.current_open_primary_controller.getViewModeErrorMessage(),a.showErrorTip(10));else{if(xe===!0)return;TTPromise.add("AComboBox","init"),n()}}),o(this).mouseover(function(){ne&&X&&X.length>0&&a.showErrorTip(1e3)}),o(this).mouseout(function(){a.hideErrorTip()}),e.width?o(this).css("min-width",e.width+33+"px"):o(this).css("min-width","169px"),a.shouldInitColumns()||(Se=!0),s=ALayoutCache.getDefaultColumn(h),s=Global.convertColumnsTojGridFormat(s,h),a.shouldInitColumns()&&!B&&a.initColumns(),e.id?(o(this).attr("id",e.id+"_AComboBox"),ie=e.id):(o(this).attr("id",de+"_AComboBox"),ie=e.field),a.setEmptyLabel();function r(f){T&&f==TTUUID.not_exist_id||l.setSelectGridData(f)}function n(){if(ne){if(LocalCacheData.openAwesomeBox)if(LocalCacheData.openAwesomeBox.getId()===ie){LocalCacheData.openAwesomeBox.onClose();return}else LocalCacheData.openAwesomeBox.onClose();LocalCacheData.openAwesomeBox=a,l=Global.loadWidgetByName(FormItemType.AWESOME_DROPDOWN);var f=!1;a.shouldInitColumns()&&!B&&(f=!0),B&&x&&x.filter_sort&&!le&&(le=x.filter_sort),l=l.ADropDown({display_show_all:f,allow_drag_to_order:Oe,allow_multiple_selection:C,show_all:Te,key:D,id:ie,comboBox:a,show_search_inputs:Ee,search_input_filter:ge,select_grid_search_input_filter:me,default_sort_filter:le,default_select_grid_sort_filter:pe,tree_mode:se,column_option_key:Ie,api:v,display_column_settings:a.shouldInitColumns(),on_tree_grid_row_select:Ve}),p=o("<div id='"+ie+"a_dropdown_div' class='a-dropdown-div'></div>"),p.append(l),p.mouseenter(function(){_e=!0}),p.mouseleave(function(){_e=!1}),o("body").append(p),TTPromise.wait("AComboBox","init",function(){if(l.setGridColumnsWidths(),C==!0&&(a.getValue().length>1||a.getValue().length==1&&a.getValue()[0]&&a.getValue()[0]!=TTUUID.zero_id&&a.getValue()[0]!=TTUUID.not_exist_id)&&v){var S={};S.filter_data={id:a.getValue()},S.filter_columns=a.getColumnFilter(),S.filter_items_per_page=1e4,v["get"+E](S,{onResult:function(g){y(g)}})}else y();function y(g){g&&l.setRealSelectItems(g.getResult(),a.getValue()),p.css("opacity","1");var L=a.find(".ui-jqgrid").find("table");if(L.length>0)for(var te=0;te<L.length;te++){var De=o(L[0]).parents(".ui-jqgrid").find(".ui-jqgrid-bdiv").width()-11;o(L[0]).parents(".ui-jqgrid").find(".ui-jqgrid-view").width(De),o(L[te]).width(De)}a.highlightSelectItem(),l.setUnSelectGridDragAble(),l.setSelectGridDragAble()}}),l.bind("close",a.onClose);var d=ALayoutCache.layout_dic[h];if(h&&d&&Global.isSet(d.data)){var _=d.data.display_columns;_.length>0?U&&(_=k(_)):A&&(_=A,_=k(_)),_=Global.convertColumnsTojGridFormat(_,h);var m=d.data.row_per_page;if((a.checkIfLayoutChanged(_)||R!==m&&!B)&&(s=_,c=null),!B&&(R=m,!we))if(Global.isSet(d.data.type)&&d.data.type===10){var x={};x.filter_data=d.data.filter_data,x.filter_sort=d.data.filter_sort}else x=null}if(l.setColumns(s),TTPromise.wait("AComboBox","init",()=>{p.css("left",o(a).offset().left+"px");let S=o(window).width(),y=p[0].getBoundingClientRect(),g=y.right,L=y.left;if(Math.abs(g-S)<=2&&p[0].querySelector(".select-grid-div")&&(g=p[0].querySelector(".select-grid-div").getBoundingClientRect().right+10),g>S){let ae=g-S,Pe=o(p).offset().left;p.css("left",Pe-ae+"px")}else L<0&&p.css("left","0px");o(a).offset().top+25+275<Global.bodyHeight()?p.css("top",o(a).offset().top+25):p.css("top",o(a).offset().top-275);let te=p[0].getBoundingClientRect().bottom,De=p[0].getBoundingClientRect().height,Qe=o(window).height();if(te>Qe){let ae=a[0].getBoundingClientRect().top-5;p.css("top",ae-De)}let ze=Math.max(0,p[0].getBoundingClientRect().right-o(window).width()),qe=Math.max(0,p[0].getBoundingClientRect().bottom-o(window).height()),We=Math.max(0,-p[0].getBoundingClientRect().left),Ce=Math.max(0,-p[0].getBoundingClientRect().top);if(ze>0||We>0){let ae=p.outerWidth()-ze-We;p.css("width",ae+"px")}if(qe>0||Ce>0){let Pe=p.outerHeight()-qe-Ce;if(p.css("height",Pe+"px"),Ce>0){let Je=p.offset().top+Ce;p.css("top",Je+"px")}}}),c){if(Global.isSet(v)&&(c=Global.formatGridData(c,v.key_name)),C)if(h==="global_sort_columns"&&(u=He(u)),oe)if(oe=!1,l.setUnselectedGridData(c),!u||u&&u.length==1&&(u[0]==TTUUID.zero_id||u[0]==TTUUID.not_exist_id))TTPromise.resolve("AComboBox","init");else{var w={};w.filter_data={id:u},w.filter_columns=a.getColumnFilter(),w.filter_items_per_page=1e4;var O=!1;u&&u.length>0&&(u[0]==TTUUID.zero_id||u[0]==TTUUID.not_exist_id)&&(O=a.getLocalSelectItem(u[0])),v["get"+E](w,{onResult:function(y){u=y.getResult(),O&&u.unshift(O),l.setUnselectedGridData(c),r(u),TTPromise.resolve("AComboBox","init")}})}else l.setUnselectedGridData(c),r(u),TTPromise.resolve("AComboBox","init");else l.setUnselectedGridData(c),l.setSelectItem(b),TTPromise.resolve("AComboBox","init");l.setPagerData(M),!Global.isEmpty(ge)||!Global.isEmpty(le)?(l.getUnSelectGrid().grid.hide(),a.onADropDownSearch("unselect_grid"),re=1):re>1&&re<=M.last_page_number&&(l.getUnSelectGrid().grid.hide(),a.onADropDownSearch("unselect_grid",re)),(!Global.isEmpty(me)||!Global.isEmpty(pe))&&a.onADropDownSearch("select_grid")}else{var w=a.buildUnSelectGridFilter(a.getValue());if(!v){$&&(c=$(a,c),l.setUnselectedGridData(c)),TTPromise.resolve("AComboBox","init");return}v["get"+E](w,{onResult:function(S){var y=S.getResult();if(Global.isArray(y)||(y=[]),c=y,$&&(c=$(a,c)),fe=null,Global.isSet(v)&&(c=Global.formatGridData(c,v.key_name)),C)if(z&&a.createFirstItem(),oe)if(oe=!1,l.setUnselectedGridData(c),!u||u&&u.length==1&&(u[0]==TTUUID.zero_id||u[0]==TTUUID.not_exist_id))TTPromise.resolve("AComboBox","init");else{var g={};g.filter_data={id:u},g.filter_columns=a.getColumnFilter(),g.filter_items_per_page=1e4;var L=!1;u&&u.length>0&&(u[0]==TTUUID.zero_id||u[0]==TTUUID.not_exist_id)&&(L=a.getLocalSelectItem(u[0])),v["get"+E](g,{onResult:function(te){u=te.getResult(),c=c.concat(u),L&&u.unshift(L),r(u),TTPromise.resolve("AComboBox","init")}})}else l.setUnselectedGridData(c),Array.isArray(u)&&u.length>0&&u[0].id&&(c=c.concat(u)),r(u),TTPromise.resolve("AComboBox","init");else(j||T||Q||H||N)&&a.createFirstItem(),l.setUnselectedGridData(c),l.setSelectItem(b),TTPromise.resolve("AComboBox","init");M=S.getPagerData(),l.setPagerData(M),(!Global.isEmpty(ge)||!Global.isEmpty(le))&&(l.getUnSelectGrid().grid.hide(),a.onADropDownSearch("unselect_grid")),(!Global.isEmpty(me)||!Global.isEmpty(pe))&&(l.getSelectGrid().grid.hide(),a.onADropDownSearch("select_grid"))}})}}}}),this},o.fn.AComboBox.defaults={},o.fn.AComboBox.html_template=`
	<div class="a-combobox">
		<div class="a-combobox-left-bg"></div>
		<span class="a-combobox-label openADropDown a-combobox-mid-bg"></span>
		<input class="focus-input">
		<div class="clickable-space openADropDown"></div>
	</div>
	`})(Xe);
//# sourceMappingURL=AComboBox-Omibb0-v.bundle.js.map
