{"version":3,"file":"InsideEditor-DH8GiQf2.bundle.js","sources":["../../global/widgets/inside_editor/InsideEditor.js"],"sourcesContent":["( function( $ ) {\n\n\t$.fn.InsideEditor = function( options ) {\n\n\t\tGlobal.addCss( 'global/widgets/inside_editor/InsideEditor.css' );\n\t\tvar opts = $.extend( {}, $.fn.InsideEditor.defaults, options );\n\n\t\tvar $this = this;\n\t\tvar field;\n\t\tvar row_render;\n\t\tvar render;\n\n\t\tthis.rows_widgets_array = null;\n\t\tthis.delete_ids = null;\n\t\tthis.addRow = null;\n\t\tthis.setValue = null;\n\t\tthis.getValue = null; // set outside\n\t\tthis.removeRow = null;\n\t\tthis.updateAllRows = null;\n\t\tthis.render_inline_html = false;\n\t\tthis.editor_data = null;\n\t\tthis.onFormItemChange = null;\n\n\t\tthis.parent_controller = null;\n//\t\tthis.parent_id = null;\n\n\t\tthis.api = null;\n\n\t\tthis.setValue = function( val ) {\n\t\t\tif ( val && val.length > 0 ) {\n\t\t\t\tthis.setValue( val );\n\t\t\t} else {\n\t\t\t\tthis.addRow();\n\t\t\t}\n\t\t};\n\n\t\tthis.getRender = function() {\n\t\t\treturn render;\n\t\t};\n\n\t\tthis.getRowRender = function() {\n\t\t\treturn row_render.clone();\n\t\t};\n\n\t\tthis.clearErrorStyle = function() {\n\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tthis.setTitle = function( val ) {\n\t\t\tvar title = $this.children().eq( 0 );\n\n\t\t\ttitle.text( val );\n\n\t\t};\n\n\t\tthis.removeLastRowLine = function() {\n\t\t\tvar table = this.find( '.inside-editor-render' );\n\t\t\tvar trs = table.find( 'tr' );\n\t\t\ttable.find( 'td' ).removeClass( 'no-line' );\n\n\t\t\tvar last_tr = trs.eq( trs.length - 1 );\n\n\t\t\tlast_tr.find( 'td' ).addClass( 'no-line' );\n\t\t};\n\n\t\tthis.removeAllRows = function( include_header ) {\n\t\t\tvar table = this.find( '.inside-editor-render' );\n\t\t\tvar trs = table.find( 'tr' );\n\t\t\tif ( include_header ) {\n\n\t\t\t\ttable.find( 'tr' ).each( function() {\n\t\t\t\t\t$( this ).remove();\n\t\t\t\t} );\n\n\t\t\t} else {\n\t\t\t\ttable.find( 'tr.inside-editor-row' ).remove();\n\t\t\t}\n\n\t\t\tthis.rows_widgets_array = [];\n\t\t};\n\n\t\tthis.setWidgetEnableBaseOnParentController = function( form_item_input ) {\n\t\t\tif ( this.parent_controller.is_viewing ) {\n\t\t\t\tform_item_input.setEnabled( false );\n\t\t\t} else {\n\t\t\t\tform_item_input.setEnabled( true );\n\t\t\t}\n\t\t};\n\n\t\tthis.addIconsEvent = function( row ) {\n\t\t\tvar plus_icon = row.find( '.plus-icon' );\n\t\t\tvar minus_icon = row.find( '.minus-icon' );\n\n\t\t\tplus_icon.click( function() {\n\t\t\t\t$this.addRow( null, $( this ).parents( 'tr' ).index(), row );\n\t\t\t} );\n\n\t\t\tminus_icon.click( function() {\n\t\t\t\t$this.removeRow( row );\n\n\t\t\t\tif ( render.find( 'tr' ).length === 1 ) {\n\t\t\t\t\t$this.addRow();\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t};\n\n\t\tthis.getDefaultData = function( index, callback ) {\n\n\t\t\tif ( Global.isSet( this.api ) ) {\n\t\t\t\tthis.api['get' + this.api.key_name + 'DefaultData']( {\n\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\tvar result_data = result.getResult();\n\t\t\t\t\t\tresult_data.id = false;\n\n\t\t\t\t\t\tif ( !result_data ) {\n\t\t\t\t\t\t\tresult_data = [];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$this.addRow( result_data, index );\n\n\t\t\t\t\t\tif ( callback && typeof callback === 'function' ) {\n\t\t\t\t\t\t\tcallback();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\n\t\tthis.each( function() {\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\t\t\tif ( o.title ) {\n\t\t\t\t$this.setTitle( o.title );\n\t\t\t}\n\t\t\tif ( o.onFormItemChange ) {\n\t\t\t\t$this.onFormItemChange = o.onFormItemChange;\n\t\t\t}\n\t\t\t$this.rows_widgets_array = [];\n\t\t\t$this.delete_ids = [];\n\t\t\t$this.addRow = o.addRow;\n\t\t\t$this.removeRow = o.removeRow;\n\t\t\t$this.getValue = o.getValue;\n\t\t\t$this.setValue = o.setValue;\n\t\t\t$this.parent_controller = o.parent_controller;\n\t\t\t$this.api = o.api;\n\t\t\t$this.updateAllRows = o.updateAllRows;\n\t\t\t$this.render_inline_html = o.render_inline_html;\n\t\t\trender = $this.render_inline_html ? o.render : Global.loadWidget( o.render );\n\t\t\trow_render = $this.render_inline_html ? $( o.row_render ) : $( Global.loadWidget( o.row_render ) );\n\t\t\tvar args = o.render_args;\n\t\t\tvar template = _.template( render );\n\t\t\tvar render_div = $this.children().eq( 1 );\n\t\t\trender_div.append( template( args ) );\n\t\t\trender = $( render_div.find( '.inside-editor-render' ) );\n\n\t\t} );\n\n\t\t// Sets data as modified when a widget triggers onFormItemChange.\n\t\t// Some inside editor widgets bind their own formItemChange and to prevent unintended interactions we only set data changed.\n\t\t$this.bind( 'formItemChange', function( e, target ) {\n\t\t\t// Fix issue #2885: Error: Uncaught TypeError: o.parent_controller.setIsChanged is not a function.\n\t\t\t// This was happening in TimeSheet -> New Punch and opening the inside editor for dates and changing a date.\n\t\t\tif ( $this.parent_controller && typeof $this.parent_controller.setIsChanged === 'function' ) {\n\t\t\t\t$this.parent_controller.setIsChanged( target );\n\t\t\t}\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.InsideEditor.defaults = {};\n\t$.fn.InsideEditor.html_template = `\n\t<div class=\"inside-editor\">\n\t\t<span class=\"title\"></span>\n\t\t<div class=\"render-div\"></div>\n\t</div>\n\t`;\n\n} )( jQuery );"],"names":["$","options","opts","$this","field","row_render","render","val","title","table","trs","last_tr","include_header","form_item_input","row","plus_icon","minus_icon","index","callback","result","result_data","o","args","template","_","render_div","target","jQuery"],"mappings":"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"}