import{_,j as g}from"./vendor-tTApdY0Y.bundle.js";import{Q as V,G as f,T as b,f as E,S as N,g as x}from"./main_ui-z76rxVqJ.entry.bundle.js";function w(i,r,e,t){return new(e||(e=Promise))(function(n,o){function a(d){try{l(t.next(d))}catch(c){o(c)}}function s(d){try{l(t.throw(d))}catch(c){o(c)}}function l(d){var c;d.done?n(d.value):(c=d.value,c instanceof e?c:new e(function(p){p(c)})).then(a,s)}l((t=t.apply(i,[])).next())})}function P(i,r){var e,t,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(d){return function(c){if(e)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(a=0)),a;)try{if(e=1,t&&(n=2&c[0]?t.return:c[0]?t.throw||((n=t.return)&&n.call(t),0):t.next)&&!(n=n.call(t,c[1])).done)return n;switch(t=0,n&&(c=[2&c[0],n.value]),c[0]){case 0:case 1:n=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,t=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(n=a.trys,!((n=n.length>0&&n[n.length-1])||c[0]!==6&&c[0]!==2)){a=0;continue}if(c[0]===3&&(!n||c[1]>n[0]&&c[1]<n[3])){a.label=c[1];break}if(c[0]===6&&a.label<n[1]){a.label=n[1],n=c;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(c);break}n[2]&&a.ops.pop(),a.trys.pop();continue}c=r.call(i,a)}catch(p){c=[6,p],t=0}finally{e=n=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([l,d])}}}var v={exclude:[]};function Q(i,r){if(!["exclude","permissions_to_check","retries","timeout"].includes(i))throw new Error("Unknown option "+i);if(["exclude","permissions_to_check"].includes(i)&&(!Array.isArray(r)||!r.every(function(e){return typeof e=="string"})))throw new Error("The value of the exclude and permissions_to_check must be an array of strings");if(["retries","timeout"].includes(i)&&typeof r!="number")throw new Error("The value of retries must be a number");v[i]=r}var B={},$={timeout:"true"},m=function(i,r){typeof window<"u"&&(B[i]=r)},W=function(){return Object.fromEntries(Object.entries(B).filter(function(i){var r,e=i[0];return!(!((r=v==null?void 0:v.exclude)===null||r===void 0)&&r.includes(e))}).map(function(i){return[i[0],(0,i[1])()]}))},M=3432918353,I=461845907,j=3864292196,q=2246822507,H=3266489909;function y(i,r){return i<<r|i>>>32-r}function T(i,r){r===void 0&&(r=0);for(var e=r,t=0,n=3&i.length,o=i.length-n,a=0;a<o;)t=255&i.charCodeAt(a)|(255&i.charCodeAt(++a))<<8|(255&i.charCodeAt(++a))<<16|(255&i.charCodeAt(++a))<<24,++a,t=y(t=Math.imul(t,M),15),e=y(e^=t=Math.imul(t,I),13),e=Math.imul(e,5)+j;switch(t=0,n){case 3:t^=(255&i.charCodeAt(a+2))<<16;case 2:t^=(255&i.charCodeAt(a+1))<<8;case 1:t^=255&i.charCodeAt(a),t=y(t=Math.imul(t,M),15),e^=t=Math.imul(t,I)}return((e=function(s){return s^=s>>>16,s=Math.imul(s,q),s^=s>>>13,s=Math.imul(s,H),s^s>>>16}(e^=i.length))>>>0).toString(36)}function z(i,r){return new Promise(function(e){setTimeout(function(){return e(r)},i)})}function K(i,r,e){return Promise.all(i.map(function(t){return Promise.race([t,z(r,e)])}))}function Y(){return w(this,void 0,void 0,function(){var i,r,e,t,n;return P(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),i=W(),r=Object.keys(i),[4,K(Object.values(i),(v==null?void 0:v.timeout)||1e3,$)];case 1:return e=o.sent(),t=e.filter(function(a){return a!==void 0}),n={},t.forEach(function(a,s){n[r[s]]=a}),[2,O(n,v.exclude||[])];case 2:throw o.sent();case 3:return[2]}})})}function O(i,r){var e={},t=function(o){if(i.hasOwnProperty(o)){var a=i[o];if(typeof a!="object"||Array.isArray(a))r.includes(o)||(e[o]=a);else{var s=O(a,r.map(function(l){return l.startsWith(o+".")?l.slice(o.length+1):l}));Object.keys(s).length>0&&(e[o]=s)}}};for(var n in i)t(n);return e}function J(i){return w(this,void 0,void 0,function(){var r,e;return P(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Y()];case 1:return r=t.sent(),e=T(JSON.stringify(r)),[2,{hash:e.toString(),data:r}];case 2:throw t.sent();case 3:return[2]}})})}function Z(i){for(var r=0,e=0;e<i.length;++e)r+=Math.abs(i[e]);return r}function F(i,r,e){for(var t=[],n=0;n<i[0].data.length;n++){for(var o=[],a=0;a<i.length;a++)o.push(i[a].data[n]);t.push(X(o))}var s=new Uint8ClampedArray(t);return new ImageData(s,r,e)}function X(i){if(i.length===0)return 0;for(var r={},e=0,t=i;e<t.length;e++)r[o=t[e]]=(r[o]||0)+1;var n=i[0];for(var o in r)r[o]>r[n]&&(n=parseInt(o,10));return n}function C(){if(typeof navigator>"u")return{name:"unknown",version:"unknown"};for(var i=navigator.userAgent,r={Edg:"Edge",OPR:"Opera"},e=0,t=[/(?<name>Edge|Edg)\/(?<version>\d+(?:\.\d+)?)/,/(?<name>(?:Chrome|Chromium|OPR|Opera|Vivaldi|Brave))\/(?<version>\d+(?:\.\d+)?)/,/(?<name>(?:Firefox|Waterfox|Iceweasel|IceCat))\/(?<version>\d+(?:\.\d+)?)/,/(?<name>Safari)\/(?<version>\d+(?:\.\d+)?)/,/(?<name>MSIE|Trident|IEMobile).+?(?<version>\d+(?:\.\d+)?)/,/(?<name>[A-Za-z]+)\/(?<version>\d+(?:\.\d+)?)/,/(?<name>SamsungBrowser)\/(?<version>\d+(?:\.\d+)?)/];e<t.length;e++){var n=t[e],o=i.match(n);if(o&&o.groups)return{name:r[o.groups.name]||o.groups.name,version:o.groups.version}}return{name:"unknown",version:"unknown"}}m("audio",function(){return w(this,void 0,void 0,function(){return P(this,function(i){return[2,new Promise(function(r,e){try{var t=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,5e3,44100),n=t.createBufferSource(),o=t.createOscillator();o.frequency.value=1e3;var a,s=t.createDynamicsCompressor();s.threshold.value=-50,s.knee.value=40,s.ratio.value=12,s.attack.value=0,s.release.value=.2,o.connect(s),s.connect(t.destination),o.start(),t.oncomplete=function(l){a=l.renderedBuffer.getChannelData(0),r({sampleHash:Z(a),oscillator:o.type,maxChannels:t.destination.maxChannelCount,channelCountMode:n.channelCountMode})},t.startRendering()}catch(l){console.error("Error creating audio fingerprint:",l),e(l)}})]})})});var ee=C().name!=="SamsungBrowser"?1:3,R=280,k=20;C().name!="Firefox"&&m("canvas",function(){return document.createElement("canvas").getContext("2d"),new Promise(function(i){var r=Array.from({length:ee},function(){return function(){var e=document.createElement("canvas"),t=e.getContext("2d");if(!t)return new ImageData(1,1);e.width=R,e.height=k;var n=t.createLinearGradient(0,0,e.width,e.height);n.addColorStop(0,"red"),n.addColorStop(.16666666666666666,"orange"),n.addColorStop(.3333333333333333,"yellow"),n.addColorStop(.5,"green"),n.addColorStop(.6666666666666666,"blue"),n.addColorStop(.8333333333333334,"indigo"),n.addColorStop(1,"violet"),t.fillStyle=n,t.fillRect(0,0,e.width,e.height);var o="Random Text WMwmil10Oo";t.font="23.123px Arial",t.fillStyle="black",t.fillText(o,-5,15),t.fillStyle="rgba(0, 0, 255, 0.5)",t.fillText(o,-3.3,17.7),t.beginPath(),t.moveTo(0,0),t.lineTo(2*e.width/7,e.height),t.strokeStyle="white",t.lineWidth=2,t.stroke();var a=t.getImageData(0,0,e.width,e.height);return a}()});i({commonImageDataHash:T(F(r,R,k).data.toString()).toString()})})});var L,te=["Arial","Arial Black","Arial Narrow","Arial Rounded MT","Arimo","Archivo","Barlow","Bebas Neue","Bitter","Bookman","Calibri","Cabin","Candara","Century","Century Gothic","Comic Sans MS","Constantia","Courier","Courier New","Crimson Text","DM Mono","DM Sans","DM Serif Display","DM Serif Text","Dosis","Droid Sans","Exo","Fira Code","Fira Sans","Franklin Gothic Medium","Garamond","Geneva","Georgia","Gill Sans","Helvetica","Impact","Inconsolata","Indie Flower","Inter","Josefin Sans","Karla","Lato","Lexend","Lucida Bright","Lucida Console","Lucida Sans Unicode","Manrope","Merriweather","Merriweather Sans","Montserrat","Myriad","Noto Sans","Nunito","Nunito Sans","Open Sans","Optima","Orbitron","Oswald","Pacifico","Palatino","Perpetua","PT Sans","PT Serif","Poppins","Prompt","Public Sans","Quicksand","Rajdhani","Recursive","Roboto","Roboto Condensed","Rockwell","Rubik","Segoe Print","Segoe Script","Segoe UI","Sora","Source Sans Pro","Space Mono","Tahoma","Taviraj","Times","Times New Roman","Titillium Web","Trebuchet MS","Ubuntu","Varela Round","Verdana","Work Sans"],re=["monospace","sans-serif","serif"];function U(i,r){if(!i)throw new Error("Canvas context not supported");return i.font,i.font="72px ".concat(r),i.measureText("WwMmLli0Oo").width}function ne(){var i,r=document.createElement("canvas"),e=(i=r.getContext("webgl"))!==null&&i!==void 0?i:r.getContext("experimental-webgl");if(e&&"getParameter"in e){var t=e.getExtension("WEBGL_debug_renderer_info");return{vendor:(e.getParameter(e.VENDOR)||"").toString(),vendorUnmasked:t?(e.getParameter(t.UNMASKED_VENDOR_WEBGL)||"").toString():"",renderer:(e.getParameter(e.RENDERER)||"").toString(),rendererUnmasked:t?(e.getParameter(t.UNMASKED_RENDERER_WEBGL)||"").toString():"",version:(e.getParameter(e.VERSION)||"").toString(),shadingLanguageVersion:(e.getParameter(e.SHADING_LANGUAGE_VERSION)||"").toString()}}return"undefined"}function oe(){var i=new Float32Array(1),r=new Uint8Array(i.buffer);return i[0]=1/0,i[0]=i[0]-i[0],r[3]}function ie(i,r){var e={};return r.forEach(function(t){var n=function(o){if(o.length===0)return null;var a={};o.forEach(function(d){var c=String(d);a[c]=(a[c]||0)+1});var s=o[0],l=1;return Object.keys(a).forEach(function(d){a[d]>l&&(s=d,l=a[d])}),s}(i.map(function(o){return t in o?o[t]:void 0}).filter(function(o){return o!==void 0}));n&&(e[t]=n)}),e}function ae(){var i=[],r={"prefers-contrast":["high","more","low","less","forced","no-preference"],"any-hover":["hover","none"],"any-pointer":["none","coarse","fine"],pointer:["none","coarse","fine"],hover:["hover","none"],update:["fast","slow"],"inverted-colors":["inverted","none"],"prefers-reduced-motion":["reduce","no-preference"],"prefers-reduced-transparency":["reduce","no-preference"],scripting:["none","initial-only","enabled"],"forced-colors":["active","none"]};return Object.keys(r).forEach(function(e){r[e].forEach(function(t){matchMedia("(".concat(e,": ").concat(t,")")).matches&&i.push("".concat(e,": ").concat(t))})}),i}function se(){if(window.location.protocol==="https:"&&typeof window.ApplePaySession=="function")try{for(var i=window.ApplePaySession.supportsVersion,r=15;r>0;r--)if(i(r))return r}catch{return 0}return 0}C().name!="Firefox"&&m("fonts",function(){var i=this;return new Promise(function(r,e){try{(function(t){var n;w(this,void 0,void 0,function(){var o,a,s;return P(this,function(l){switch(l.label){case 0:return document.body?[3,2]:[4,(d=50,new Promise(function(p){return setTimeout(p,d,c)}))];case 1:return l.sent(),[3,0];case 2:if((o=document.createElement("iframe")).setAttribute("frameBorder","0"),(a=o.style).setProperty("position","fixed"),a.setProperty("display","block","important"),a.setProperty("visibility","visible"),a.setProperty("border","0"),a.setProperty("opacity","0"),o.src="about:blank",document.body.appendChild(o),!(s=o.contentDocument||((n=o.contentWindow)===null||n===void 0?void 0:n.document)))throw new Error("Iframe document is not accessible");return t({iframe:s}),setTimeout(function(){document.body.removeChild(o)},0),[2]}var d,c})})})(function(t){var n=t.iframe;return w(i,void 0,void 0,function(){var o,a,s,l;return P(this,function(d){return o=n.createElement("canvas"),a=o.getContext("2d"),s=re.map(function(c){return U(a,c)}),l={},te.forEach(function(c){var p=U(a,c);s.includes(p)||(l[c]=p)}),r(l),[2]})})})}catch{e({error:"unsupported"})}})}),m("hardware",function(){return new Promise(function(i,r){var e=navigator.deviceMemory!==void 0?navigator.deviceMemory:0,t=window.performance&&window.performance.memory?window.performance.memory:0;i({videocard:ne(),architecture:oe(),deviceMemory:e.toString()||"undefined",jsHeapSizeLimit:t.jsHeapSizeLimit||0})})}),m("locales",function(){return new Promise(function(i){i({languages:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone})})}),m("permissions",function(){return w(this,void 0,void 0,function(){var i;return P(this,function(r){return L=(v==null?void 0:v.permissions_to_check)||["accelerometer","accessibility","accessibility-events","ambient-light-sensor","background-fetch","background-sync","bluetooth","camera","clipboard-read","clipboard-write","device-info","display-capture","gyroscope","geolocation","local-fonts","magnetometer","microphone","midi","nfc","notifications","payment-handler","persistent-storage","push","speaker","storage-access","top-level-storage-access","window-management","query"],i=Array.from({length:(v==null?void 0:v.retries)||3},function(){return function(){return w(this,void 0,void 0,function(){var e,t,n,o,a;return P(this,function(s){switch(s.label){case 0:e={},t=0,n=L,s.label=1;case 1:if(!(t<n.length))return[3,6];o=n[t],s.label=2;case 2:return s.trys.push([2,4,,5]),[4,navigator.permissions.query({name:o})];case 3:return a=s.sent(),e[o]=a.state.toString(),[3,5];case 4:return s.sent(),[3,5];case 5:return t++,[3,1];case 6:return[2,e]}})})}()}),[2,Promise.all(i).then(function(e){return ie(e,L)})]})})}),m("plugins",function(){var i=[];if(navigator.plugins)for(var r=0;r<navigator.plugins.length;r++){var e=navigator.plugins[r];i.push([e.name,e.filename,e.description].join("|"))}return new Promise(function(t){t({plugins:i})})}),m("screen",function(){return new Promise(function(i){i({is_touchscreen:navigator.maxTouchPoints>0,maxTouchPoints:navigator.maxTouchPoints,colorDepth:screen.colorDepth,mediaMatches:ae()})})}),m("system",function(){return new Promise(function(i){var r=C();i({platform:window.navigator.platform,cookieEnabled:window.navigator.cookieEnabled,productSub:navigator.productSub,product:navigator.product,useragent:navigator.userAgent,browser:{name:r.name,version:r.version},applePayVersion:se()})})});var h,ce=C().name!=="SamsungBrowser"?1:3,u=null;typeof document<"u"&&((h=document.createElement("canvas")).width=200,h.height=100,u=h.getContext("webgl")),m("webgl",function(){return w(this,void 0,void 0,function(){var i;return P(this,function(r){try{if(!u)throw new Error("WebGL not supported");return i=Array.from({length:ce},function(){return function(){try{if(!u)throw new Error("WebGL not supported");var e=`
          attribute vec2 position;
          void main() {
              gl_Position = vec4(position, 0.0, 1.0);
          }
      `,t=`
          precision mediump float;
          void main() {
              gl_FragColor = vec4(0.812, 0.195, 0.553, 0.921); // Set line color
          }
      `,n=u.createShader(u.VERTEX_SHADER),o=u.createShader(u.FRAGMENT_SHADER);if(!n||!o)throw new Error("Failed to create shaders");if(u.shaderSource(n,e),u.shaderSource(o,t),u.compileShader(n),!u.getShaderParameter(n,u.COMPILE_STATUS))throw new Error("Vertex shader compilation failed: "+u.getShaderInfoLog(n));if(u.compileShader(o),!u.getShaderParameter(o,u.COMPILE_STATUS))throw new Error("Fragment shader compilation failed: "+u.getShaderInfoLog(o));var a=u.createProgram();if(!a)throw new Error("Failed to create shader program");if(u.attachShader(a,n),u.attachShader(a,o),u.linkProgram(a),!u.getProgramParameter(a,u.LINK_STATUS))throw new Error("Shader program linking failed: "+u.getProgramInfoLog(a));u.useProgram(a);for(var s=137,l=new Float32Array(4*s),d=2*Math.PI/s,c=0;c<s;c++){var p=c*d;l[4*c]=0,l[4*c+1]=0,l[4*c+2]=Math.cos(p)*(h.width/2),l[4*c+3]=Math.sin(p)*(h.height/2)}var G=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,G),u.bufferData(u.ARRAY_BUFFER,l,u.STATIC_DRAW);var A=u.getAttribLocation(a,"position");u.enableVertexAttribArray(A),u.vertexAttribPointer(A,2,u.FLOAT,!1,0,0),u.viewport(0,0,h.width,h.height),u.clearColor(0,0,0,1),u.clear(u.COLOR_BUFFER_BIT),u.drawArrays(u.LINES,0,2*s);var D=new Uint8ClampedArray(h.width*h.height*4);return u.readPixels(0,0,h.width,h.height,u.RGBA,u.UNSIGNED_BYTE,D),new ImageData(D,h.width,h.height)}catch{return new ImageData(1,1)}finally{u&&(u.bindBuffer(u.ARRAY_BUFFER,null),u.useProgram(null),u.viewport(0,0,u.drawingBufferWidth,u.drawingBufferHeight),u.clearColor(0,0,0,0))}}()}),[2,{commonImageHash:T(F(i,h.width,h.height).data.toString()).toString()}]}catch{return[2,{webgl:"unsupported"}]}return[2]})})});var S=function(i,r,e,t){for(var n=(e-r)/t,o=0,a=0;a<t;a++)o+=i(r+(a+.5)*n);return o*n};m("math",function(){return w(void 0,void 0,void 0,function(){return P(this,function(i){return[2,{acos:Math.acos(.5),asin:S(Math.asin,-1,1,97),atan:S(Math.atan,-1,1,97),cos:S(Math.cos,0,Math.PI,97),cosh:Math.cosh(9/7),e:Math.E,largeCos:Math.cos(1e20),largeSin:Math.sin(1e20),largeTan:Math.tan(1e20),log:Math.log(1e3),pi:Math.PI,sin:S(Math.sin,-Math.PI,Math.PI,97),sinh:S(Math.sinh,-9/7,7/9,97),sqrt:Math.sqrt(2),tan:S(Math.tan,0,2*Math.PI,97),tanh:S(Math.tanh,-9/7,7/9,97)}]})})});class ue extends V{constructor(r={}){_.defaults(r,{events:{"change #language":"onLanguageChange"},authentication_api:null}),super(r)}initialize(r){super.initialize(r);var e=f.loadWidget("views/quick_punch/login/QuickPunchLoginView.html");this.template=_.template(e),this.setElement(this.template({})),f.contentContainer().html(this.$el),this.checkForWebkitTextSecuritySupport(),this.api=b.APIPunch,this.authentication_api=b.APIAuthentication,this.currentUser_api=b.APIAuthentication,this.user_preference_api=b.APIUserPreference,this.date_api=b.APITTDate,this.permission_api=b.APIPermission,this.edit_view_error_ui_dic={},LocalCacheData.setAllURLArgs({}),this.render()}render(){var r=this;return this.login_btn=this.$("button#punch_login"),this.login_btn.on("click",function(e){e.preventDefault(),e.stopPropagation(),r.onLogin(e)}),this.$('input[name="quick_punch_id"]').focus(),this.setLanguageSourceData("language"),g(document).off("keydown").on("keydown",function(e){var t=e.target.attributes;if(e.keyCode===13){if(r.login_btn.attr("disabled")=="disabled")return;r.onLogin(),e.preventDefault()}e.keyCode===9&&e.shiftKey&&t["tab-start"]&&(r.$("button[tabindex=0]",r.$el)[0].focus(),e.preventDefault()),t["tab-end"]&&e.shiftKey===!1&&(r.$("input[tabindex=1]",r.$el)[0].focus(),e.preventDefault())}),this}onLogin(r){var e=this,t=this.$("#quick_punch_id").val(),n=this.$("#quick_punch_password").val();this.login_btn.attr("disabled","disabled"),this.clearErrorTips(!0,!0),f.refreshCSRFToken(function(o){APIGlobal.pre_login_data.product_edition>10&&APIGlobal.pre_login_data.product_edition_match==!0?e.authentication_api.PunchLogin(t,n,{onResult:function(a){if(a&&a.isValid()){var s=a.getResult();TTPromise.add("QPLogin","init"),TTPromise.add("QPLogin","CurrentStation"),e.getCurrentStation(),TTPromise.add("QPLogin","CurrentUser"),e.getCurrentUser(),setCookie("SessionID-QP",s.SessionID,{expires:30,path:LocalCacheData.cookie_path}),TTPromise.add("QPLogin","Permissions"),e.permission_api.getPermissions({onResult:function(l){var d=l.getResult();d!=!1?(LocalCacheData.setPermissionData(d),TTPromise.resolve("QPLogin","Permissions")):(Debug.Text("User does not have any permissions!","QuickPunchLoginController.js","QuickPunchViewController","getPermission",10),E.showAlert(g.i18n._("Unable to login due to permissions, please try again and if the problem persists contact customer support."),"",function(){f.Logout(),window.location.reload()}))}}),TTPromise.add("QPLogin","CurrentCompany"),e.authentication_api.getCurrentCompany({onResult:function(l){var d=l.getResult();d!=!1?(d.is_setup_complete==1?d.is_setup_complete=!0:d.is_setup_complete=!1,LocalCacheData.setCurrentCompany(d),Debug.Text("Version: Client: "+APIGlobal.pre_login_data.application_build+" Server: "+d.application_build,"LoginViewController.js","LoginViewController","onUserPreference:next",10),APIGlobal.pre_login_data.production==!0&&APIGlobal.pre_login_data.application_build!=d.application_build&&(Debug.Text("Version mismatch on login: Reloading...","LoginViewController.js","LoginViewController","onUserPreference:next",10),window.location.reload(!0)),TTPromise.resolve("QPLogin","CurrentCompany")):(Debug.Text("Unable to get company information!","QuickPunchLoginController.js","QuickPunchViewController","getPermission",10),E.showAlert(g.i18n._("Unable to download required information, please check your network connection and try again. If the problem persists contact customer support."),"",function(){f.Logout(),window.location.reload()}))}}),TTPromise.add("QPLogin","Locale"),e.getLocale(),TTPromise.wait("QPLogin",null,function(){e.goToView()}),TTPromise.resolve("QPLogin","init")}else e.setErrorTips(a)}}):f.sendErrorReport("Product edition mismatch: "+APIGlobal.pre_login_data.product_edition+" Remote Version: "+APIGlobal.pre_login_data.application_build+" URL: "+window.location.href,N.root_url,"","","")})}checkForWebkitTextSecuritySupport(){if(typeof CSS!="function"||!CSS.supports("-webkit-text-security","disc")){var r=g("input#quick_punch_password"),e=r.clone(!0);e.attr("type","password"),r.replaceWith(e)}}getLocale(){this.authentication_api.getLocale(g('select[name="language"]').val(),{onResult:function(r){var e="en_US";r&&(e=r.getResult());var t=x.generateUUID();LocalCacheData.getLoginData().locale!=null&&e!==LocalCacheData.getLoginData().locale&&(ProgressBar.showProgressBar(t),ProgressBar.changeProgressBarMessage(g.i18n._("Language changed, reloading")+"..."),f.setLanguageCookie(e),LocalCacheData.setI18nDic(null),setTimeout(function(){window.location.reload(!0)},5e3)),TTPromise.resolve("QPLogin","Locale")}})}getCurrentUser(){this.currentUser_api.getCurrentUser({onResult:this.onGetCurrentUser,delegate:this})}getCurrentStation(r){var e=f.getStationID(),t=b.APIStation;e?t.getCurrentStation(e,"10",{onResult:function(o){n(o)}}):(Q("exclude",["audio","canvas","webgl","system.browser.version"]),J().then(o=>{Debug.Text("Browser Fingerprint: "+o.hash,"InOutViewController.js","InOutViewController","getUserPunch",10),o&&o.hash!=""&&(e="BFP-"+o.hash),t.getCurrentStation(e,"10",{onResult:function(a){n(a)}})}).catch(o=>{t.getCurrentStation("","10",{onResult:function(a){n(a)}})}));function n(o){var a=o.getResult();f.setStationID(a),TTPromise.resolve("QPLogin","CurrentStation")}}onGetCurrentUser(r){LocalCacheData.setPunchLoginUser(r.getResult()),TTPromise.resolve("QPLogin","CurrentUser")}goToView(){this.doing_login=!1,LocalCacheData.currentShownContextMenuName=null,f.setURLToBrowser(f.getBaseURL()+"#!m=QuickPunch");var r=LocalCacheData.getCurrentCompany();LocalCacheData&&r&&f.setAnalyticDimensions(LocalCacheData.getPunchLoginUser().first_name+" ("+LocalCacheData.getPunchLoginUser().id+")",r.name)}setErrorTips(r){this.clearErrorTips(!0);var e=r.getDetails()?r.getDetails()[0]:{};e&&e.hasOwnProperty("error")&&(e=e.error);for(var t in e)if(e.hasOwnProperty(t)){var n;if(this.$('input[name="'+t+'"]')[0]?n=this.$('input[name="'+t+'"]'):this.$('select[name="'+t+'"]')[0]&&(n=this.$('select[name="'+t+'"]')),n){n.addClass("is-invalid");var o;_.isArray(e[t])?o=e[t][0]:o=e[t],n.attr("data-bs-toggle","tooltip"),n.attr("data-bs-placement","top"),n.attr("title",o);var a=new bootstrap.Tooltip(n);a.show(),this.edit_view_error_ui_dic[t]=n}}_.size(this.edit_view_error_ui_dic)>0&&(this.login_btn.removeAttr("disabled"),_.min(this.edit_view_error_ui_dic,function(s){if(s.attr("tabindex"))return parseInt(s.attr("tabindex"))}).focus())}clearErrorTips(r,e){for(var t in this.edit_view_error_ui_dic)if((this.edit_view_error_ui_dic[t].val()!==""||r)&&(this.edit_view_error_ui_dic[t].removeClass("is-invalid"),this.edit_view_error_ui_dic[t].removeAttr("data-bs-toggle"),this.edit_view_error_ui_dic[t].removeAttr("data-bs-placement"),this.edit_view_error_ui_dic[t].removeAttr("data-bs-original-title"),this.edit_view_error_ui_dic[t].removeAttr("aria-label"),this.edit_view_error_ui_dic[t].removeAttr("title")),e){let n=document.querySelectorAll(".tooltip");for(let o=0;o<n.length;o++)n[o].remove()}}setLanguageSourceData(r,e,t){var n=this,o='select[name="'+r+'"]';if(this.$(o)&&this.$(o)[0])this.$(o).empty();else return;e||(e=LocalCacheData.getLoginData().language_options,e=f.removeSortPrefixFromArray(LocalCacheData.getLoginData().language_options)),_.size(e)==0&&(t=!0),t===!0&&this.$(o).append(g("<option></option>").prop("value","0").text("-- "+g.i18n._("None")+" --")).attr("selected","selected"),_.size(e)>0&&g.each(e,function(a,s){n.$(o).append(g("<option></option>").attr("value",a).text(s)),LocalCacheData.getLoginData().language==a&&n.$(o).val(a)})}onLanguageChange(r){f.setLanguageCookie(g(r.target).val()),LocalCacheData.setI18nDic(null);var e=x.generateUUID();ProgressBar.showProgressBar(e),ProgressBar.changeProgressBarMessage(g.i18n._("Language changed, reloading")+"..."),setTimeout(function(){window.location.reload(!0)},2e3)}}const fe=Object.freeze(Object.defineProperty({__proto__:null,QuickPunchLoginViewController:ue},Symbol.toStringTag,{value:"Module"}));export{ue as Q,fe as a,Q as t,J as y};
//# sourceMappingURL=QuickPunchLoginViewController-DZo_BDAl.bundle.js.map
