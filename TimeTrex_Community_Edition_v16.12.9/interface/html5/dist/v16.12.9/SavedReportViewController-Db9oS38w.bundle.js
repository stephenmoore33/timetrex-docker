import{_ as n,j as o}from"./vendor-tTApdY0Y.bundle.js";class d extends BaseViewController{constructor(e={}){n.defaults(e,{el:"#saved_report_view_container",sub_report_schedule_view_controller:null,edit_view_tpl:"SavedReportEditView.html",permission_id:"report",viewId:"SavedReport",script_name:"UserReportDataView",table_name_key:"user_report_data",context_menu_name:o.i18n._("Reports"),navigation_label:o.i18n._("Saved Report"),api:TTAPI.APIUserReportData}),super(e)}init(e){this.render(),this.sub_view_mode?this.buildContextMenu(!0):(this.buildContextMenu(),this.sub_view_mode||this.initData())}onDeleteResult(e,i){var r=this;ProgressBar.closeOverlay(),e&&e.isValid()?(r.search(),r.onDeleteDone(e),r.edit_view?r.removeEditView():r.setCurrentEditViewState(""),this.sub_view_mode&&this.parent_view_controller&&this.parent_view_controller.onSavedReportDelete()):(r.revertEditViewState(),TAlertManager.showErrorAlert(e))}onCustomContextClick(e){switch(e){case"share_report":if(Global.getProductEdition()>=15){var i=[];this.edit_view&&this.current_edit_record.id?i.push(this.current_edit_record.id):this.edit_view||(i=this.getGridSelectIdArray()),IndexViewController.openWizard("ShareReportWizard",i)}else TAlertManager.showAlert(Global.getUpgradeMessage());break}}onGridDblClickRow(){ProgressBar.showOverlay(),this.sub_view_mode?this.onEditClick():this.onViewClick()}getCustomContextMenuModel(){var e={groups:{share:{label:o.i18n._("Share"),id:this.viewId+"Share"}},exclude:["default"],include:["edit","delete_icon","delete_and_next","save","save_and_continue","save_and_next","cancel",{label:o.i18n._("Share Report"),id:"share_report",menu_align:"right",vue_icon:"tticon tticon-share_black_24dp"}]};return this.sub_view_mode||e.include.unshift({label:o.i18n._("Report"),id:"view",group:"editor",vue_icon:"tticon tticon-visibility_black_24dp"}),e}removeEditView(){super.removeEditView(),this.sub_report_schedule_view_controller=null}getGridSetup(){var e=this,i={container_selector:this.sub_view_mode?"#tab_saved_reports":".view",sub_grid_mode:this.sub_view_mode,onSelectRow:function(){e.onGridSelectRow()},onCellSelect:function(){e.onGridSelectRow()},onSelectAll:function(){e.onGridSelectAll()},ondblClickRow:function(r){e.onGridDblClickRow(r)},onRightClickRow:function(r){var t=e.getGridSelectIdArray();t.indexOf(r)<0&&(e.grid.grid.resetSelection(),e.grid.grid.setSelection(r),e.onGridSelectRow())}};return this.sub_view_mode&&(i.setGridSize=function(){e.sub_view_mode&&e.baseViewSubTabGridResize("#tab_saved_reports")},i.onResizeGrid=function(){e.sub_view_mode&&e.baseViewSubTabGridResize("#tab_saved_reports")}),i}onViewClick(e,i){var r=this.getGridSelectIdArray(),t=r[0],l=this.getRecordFromGridById(t);if(l&&l.script){var a=l.script;switch(LocalCacheData.current_doing_context_action="view",LocalCacheData.default_edit_id_for_next_open_edit_view=t,a){case"UserExpenseReport":a="ExpenseSummaryReport";break;case"ExceptionReport":a="ExceptionSummaryReport";break;case"JobDetailReport":a="JobAnalysisReport";break;case"AffordableCareReport":Global.getProductEdition()==10&&(TAlertManager.showAlert(Global.getUpgradeMessage()),a=null);break}Global.isSet(a)&&a&&IndexViewController.openReport(this,a)}}buildEditViewUI(){super.buildEditViewUI();var e={tab_report:{label:o.i18n._("Report")},tab_schedule:{label:o.i18n._("Schedule"),init_callback:"initSubReportScheduleView",show_permission_div:!0},tab_audit:!0};this.setTabModel(e),this.edit_only_mode||(this.navigation.AComboBox({api_class:TTAPI.APIUserReportData,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_user_report_data",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation());var i=this.edit_view_tab.find("#tab_report"),r=i.find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(r);var t=Global.loadWidgetByName(FormItemType.TEXT_INPUT);t.TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn(o.i18n._("Name"),t,r,""),t.parent().width("45%"),t=Global.loadWidgetByName(FormItemType.CHECKBOX),t.TCheckbox({field:"is_default"}),this.addEditFieldToColumn(o.i18n._("Default"),t,r),t=Global.loadWidgetByName(FormItemType.TEXT_AREA),t.TTextInput({field:"description",width:"100%"}),this.addEditFieldToColumn(o.i18n._("Description"),t,r,"",null,null,!0),t.parent().width("45%")}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:o.i18n._("Name"),in_column:1,field:"name",multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:o.i18n._("Description"),field:"description",basic_search:!0,adv_search:!1,in_column:1,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:o.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:o.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX})]}initSubReportScheduleView(){var e=this;if(!this.current_edit_record.id){TTPromise.resolve("BaseViewController","onTabShow");return}if(Global.getProductEdition()>=15){if(this.sub_report_schedule_view_controller){this.sub_report_schedule_view_controller.buildContextMenu(!0),this.sub_report_schedule_view_controller.setDefaultMenu(),e.sub_report_schedule_view_controller.parent_value=e.current_edit_record.id,e.sub_report_schedule_view_controller.parent_edit_record=e.current_edit_record,e.sub_report_schedule_view_controller.initData();return}Global.loadViewSource("ReportSchedule","ReportScheduleViewController.js",function(){var t=e.edit_view_tab.find("#tab_schedule"),l=t.find(".first-column-sub-view");TTPromise.add("initSubReportScheduleView","init"),TTPromise.wait("initSubReportScheduleView","init",function(){l.css("opacity","1")}),l.css("opacity","0"),Global.trackView("SubReportScheduleView"),ReportScheduleViewController.loadSubView(l,i,r)})}else this.edit_view_tab.find("#tab_schedule").find(".first-column-sub-view").css("display","none"),this.edit_view.find(".permission-defined-div").css("display","block"),this.edit_view.find(".permission-message").html(Global.getUpgradeMessage()),this.edit_view.find(".save-and-continue-button-div").css("display","none");function i(){}function r(t){e.sub_report_schedule_view_controller=t,e.sub_report_schedule_view_controller.parent_key="user_report_data_id",e.sub_report_schedule_view_controller.parent_value=e.current_edit_record.id,e.sub_report_schedule_view_controller.parent_edit_record=e.current_edit_record,e.sub_report_schedule_view_controller.parent_view_controller=e,e.sub_report_schedule_view_controller.sub_view_mode=!0,e.sub_report_schedule_view_controller.initData()}}uniformVariable(e){return e}onSaveClick(e,i=!1){super.onSaveClick(e,!0)}onSaveDone(e){this.parent_view_controller&&this.parent_view_controller.onSaveDoneCallback&&this.parent_view_controller.onSaveDoneCallback(e,this.current_edit_record)}onSaveAndContinueDone(e){this.onSaveDone(e)}onSaveAndNextDone(e){this.onSaveDone(e)}getFilterColumnsFromDisplayColumns(){var e={};e.id=!0,e.is_owner=!0,e.is_child=!0,e.script=!0;var i=[];if(this.grid&&(i=this.grid.getGridParam("colModel")),i)for(var r=i.length,t=0;t<r;t++){var l=i[t];e[l.name]=!0}return e}onAddClick(e){ProgressBar.closeOverlay();var i=this;this.setCurrentEditViewState("new"),i.openEditView(),i.current_edit_record=e,i.initEditView()}searchDone(){o("window").trigger("resize"),this.sub_view_mode&&TTPromise.resolve("SubSavedReportView","init"),super.searchDone()}}d.loadSubView=function(s,e,i){Global.loadViewSource("SavedReport","SubSavedReportView.html",function(r){var t={},l=n.template(r);Global.isSet(e)&&e(),Global.isSet(s)&&(s.html(l(t)),Global.isSet(i)&&TTPromise.wait("BaseViewController","initialize",function(){i(window.sub_saved_report_view_controller)}))})};export{d as SavedReportViewController};
//# sourceMappingURL=SavedReportViewController-Db9oS38w.bundle.js.map
